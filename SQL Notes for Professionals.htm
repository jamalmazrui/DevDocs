<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=Generator content="Microsoft Word 15 (filtered)">
<title>SQL Notes for Professionals</title>
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Helvetica;
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:Courier;
	panose-1:2 7 4 9 2 2 5 2 4 4;}
@font-face
	{font-family:"Tms Rmn";
	panose-1:2 2 6 3 4 5 5 2 3 4;}
@font-face
	{font-family:Helv;
	panose-1:2 11 6 4 2 2 2 3 2 4;}
@font-face
	{font-family:"New York";
	panose-1:2 4 5 3 6 5 6 2 3 4;}
@font-face
	{font-family:System;
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"MS Mincho";
	panose-1:2 2 6 9 4 2 5 8 3 4;}
@font-face
	{font-family:Batang;
	panose-1:2 3 6 0 0 1 1 1 1 1;}
@font-face
	{font-family:SimSun;
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:PMingLiU;
	panose-1:2 1 6 1 0 1 1 1 1 1;}
@font-face
	{font-family:"MS Gothic";
	panose-1:2 11 6 9 7 2 5 8 2 4;}
@font-face
	{font-family:Dotum;
	panose-1:2 11 6 0 0 1 1 1 1 1;}
@font-face
	{font-family:SimHei;
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:MingLiU;
	panose-1:2 1 6 9 0 1 1 1 1 1;}
@font-face
	{font-family:Mincho;
	panose-1:2 2 6 9 4 3 5 8 3 5;}
@font-face
	{font-family:Gulim;
	panose-1:2 11 6 0 0 1 1 1 1 1;}
@font-face
	{font-family:Century;
	panose-1:2 4 6 4 5 5 5 2 3 4;}
@font-face
	{font-family:"Angsana New";
	panose-1:2 2 6 3 5 4 5 2 3 4;}
@font-face
	{font-family:"Cordia New";
	panose-1:2 11 3 4 2 2 2 2 2 4;}
@font-face
	{font-family:Mangal;
	panose-1:0 0 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:Latha;
	panose-1:2 0 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:Sylfaen;
	panose-1:1 10 5 2 5 3 6 3 3 3;}
@font-face
	{font-family:Vrinda;
	panose-1:0 0 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:Raavi;
	panose-1:2 0 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:Shruti;
	panose-1:2 0 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:Sendnya;
	panose-1:0 0 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:Gautami;
	panose-1:2 0 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:Tunga;
	panose-1:0 0 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Estrangelo Edessa";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:"Yu Gothic";
	panose-1:2 11 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:DengXian;
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:"Calibri Light";
	panose-1:2 15 3 2 2 2 4 3 2 4;}
@font-face
	{font-family:"Palatino Linotype";
	panose-1:2 4 5 2 5 5 5 3 3 4;}
@font-face
	{font-family:Verdana;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
	{font-family:"Arial Unicode MS";
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:"Aptos Display";}
@font-face
	{font-family:Aptos;}
@font-face
	{font-family:"Segoe UI Emoji";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"DejaVu Sans Mono";
	panose-1:2 11 6 9 3 8 4 2 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:.2pt;
	margin-left:0in;
	text-indent:.5pt;
	line-height:110%;
	font-size:10.0pt;
	font-family:"Calibri",sans-serif;
	color:black;}
h1
	{mso-style-link:"Heading 1 Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:.15pt;
	margin-left:.5pt;
	text-indent:-.5pt;
	line-height:110%;
	page-break-after:avoid;
	font-size:26.0pt;
	font-family:"Calibri",sans-serif;
	color:#F31D19;}
h2
	{mso-style-link:"Heading 2 Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:2.75pt;
	margin-left:.5pt;
	text-indent:-.5pt;
	line-height:107%;
	page-break-after:avoid;
	font-size:18.0pt;
	font-family:"Calibri",sans-serif;
	color:#F31D19;}
p.MsoToc1, li.MsoToc1, div.MsoToc1
	{margin-top:0in;
	margin-right:.75pt;
	margin-bottom:1.45pt;
	margin-left:.75pt;
	text-indent:.5pt;
	line-height:110%;
	font-size:10.0pt;
	font-family:"Calibri",sans-serif;
	color:black;}
p.MsoToc2, li.MsoToc2, div.MsoToc2
	{margin-top:0in;
	margin-right:1.15pt;
	margin-bottom:3.05pt;
	margin-left:20.75pt;
	text-indent:.5pt;
	line-height:110%;
	font-size:10.0pt;
	font-family:"Calibri",sans-serif;
	color:black;}
span.Heading2Char
	{mso-style-name:"Heading 2 Char";
	mso-style-link:"Heading 2";
	font-family:"Calibri",sans-serif;
	color:#F31D19;
	font-weight:bold;}
span.Heading1Char
	{mso-style-name:"Heading 1 Char";
	mso-style-link:"Heading 1";
	font-family:"Calibri",sans-serif;
	color:#F31D19;
	font-weight:bold;}
span.msoIns
	{mso-style-name:"";
	text-decoration:underline;
	color:#65B4B4;}
span.msoDel
	{mso-style-name:"";
	text-decoration:line-through;
	color:#FF4B4B;}
.MsoChpDefault
	{font-size:12.0pt;}
.MsoPapDefault
	{margin-bottom:8.0pt;
	line-height:115%;}
 /* Page Definitions */
 @page WordSection1
	{size:595.3pt 841.9pt;
	margin:23.8pt 41.95pt 43.95pt 28.35pt;}
div.WordSection1
	{page:WordSection1;}
@page WordSection2
	{size:595.3pt 841.9pt;
	margin:23.8pt 28.55pt 42.5pt 28.35pt;}
div.WordSection2
	{page:WordSection2;}
@page WordSection3
	{size:595.3pt 841.9pt;
	margin:30.9pt 30.2pt 42.5pt 28.35pt;}
div.WordSection3
	{page:WordSection3;}
@page WordSection4
	{size:595.3pt 841.9pt;
	margin:23.8pt 28.45pt 42.5pt 28.35pt;}
div.WordSection4
	{page:WordSection4;}
@page WordSection5
	{size:595.3pt 841.9pt;
	margin:63.75pt 1.0in 34.15pt 1.0in;}
div.WordSection5
	{page:WordSection5;}
 /* List Definitions */
 ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>

</head>

<body lang=EN-US style='word-wrap:break-word'>

<div class=WordSection1>

<p class=MsoNormal style='margin-top:0in;margin-right:553.35pt;margin-bottom:
0in;margin-left:-28.35pt;text-indent:0in;line-height:107%'><img width=792
height=1120 src="SQL%20Notes%20for%20Professionals_files/image001.jpg"><br
clear=ALL>
<br clear=all style='page-break-before:always'>
</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:2.0pt;
margin-left:-.25pt;text-indent:-.5pt'><b><span style='font-size:26.0pt;
line-height:110%;color:#F31D19'>Contents</span></b></p>

<p class=MsoToc1><a href="#_Toc228481"><b><span style='font-size:12.0pt;
line-height:110%;color:#F31D19'>About</span></b><span style='color:black;
text-decoration:none'>........................................................................................................................................................................................................................ </span><span style='color:black;text-decoration:none'>1</span></a></p>

<p class=MsoToc1><a href="#_Toc228482"><b><span style='font-size:12.0pt;
line-height:110%;color:#F31D19'>Chapter 1: Getting started with SQL</span></b><span
style='color:black;text-decoration:none'>....................................................................................................................................................... </span><span style='color:black;text-decoration:none'>2</span></a></p>

<p class=MsoToc2><a href="#_Toc228483"><span style='color:#F31D19'>Section 1.1:
Overview</span><span style='color:black;text-decoration:none'>..................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>2</span></a></p>

<p class=MsoToc1><a href="#_Toc228484"><b><span style='font-size:12.0pt;
line-height:110%;color:#F31D19'>Chapter 2: Identifier</span></b><span
style='color:black;text-decoration:none'>......................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>3</span></a></p>

<p class=MsoToc2><a href="#_Toc228485"><span style='color:#F31D19'>Section 2.1:
Unquoted identifiers</span><span style='color:black;text-decoration:none'>................................................................................................................................................................. </span><span style='color:black;text-decoration:none'>3</span></a></p>

<p class=MsoToc1><a href="#_Toc228486"><b><span style='font-size:12.0pt;
line-height:110%;color:#F31D19'>Chapter 3: Data Types</span></b><span
style='color:black;text-decoration:none'>..................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>4</span></a></p>

<p class=MsoToc2><a href="#_Toc228487"><span style='color:#F31D19'>Section 3.1:
DECIMAL and NUMERIC</span><span style='color:black;text-decoration:none'>............................................................................................................................................................ </span><span style='color:black;text-decoration:none'>4</span></a></p>

<p class=MsoToc2><a href="#_Toc228488"><span style='color:#F31D19'>Section 3.2:
FLOAT and REAL</span><span style='color:black;text-decoration:none'>.......................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>4</span></a></p>

<p class=MsoToc2><a href="#_Toc228489"><span style='color:#F31D19'>Section 3.3:
Integers</span><span style='color:black;text-decoration:none'>........................................................................................................................................................................................ </span><span style='color:black;text-decoration:none'>4</span></a></p>

<p class=MsoToc2><a href="#_Toc228490"><span style='color:#F31D19'>Section 3.4:
MONEY and SMALLMONEY</span><span style='color:black;text-decoration:none'>...................................................................................................................................................... </span><span style='color:black;text-decoration:none'>4</span></a></p>

<p class=MsoToc2><a href="#_Toc228491"><span style='color:#F31D19'>Section 3.5:
BINARY and VARBINARY</span><span style='color:black;text-decoration:none'>........................................................................................................................................................... </span><span style='color:black;text-decoration:none'>4</span></a></p>

<p class=MsoToc2><a href="#_Toc228492"><span style='color:#F31D19'>Section 3.6:
CHAR and VARCHAR</span><span style='color:black;text-decoration:none'>.................................................................................................................................................................. </span><span style='color:black;text-decoration:none'>5</span></a></p>

<p class=MsoToc2><a href="#_Toc228493"><span style='color:#F31D19'>Section 3.7:
NCHAR and NVARCHAR</span><span style='color:black;text-decoration:none'>............................................................................................................................................................ </span><span style='color:black;text-decoration:none'>5</span></a></p>

<p class=MsoToc2><a href="#_Toc228494"><span style='color:#F31D19'>Section 3.8:
UNIQUEIDENTIFIER</span><span style='color:black;text-decoration:none'>.................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>5</span></a></p>

<p class=MsoToc1><a href="#_Toc228495"><b><span style='font-size:12.0pt;
line-height:110%;color:#F31D19'>Chapter 4: NULL</span></b><span
style='color:black;text-decoration:none'>.................................................................................................................................................................................................. </span><span style='color:black;text-decoration:none'>6</span></a></p>

<p class=MsoToc2><a href="#_Toc228496"><span style='color:#F31D19'>Section 4.1:
Filtering for NULL in queries</span><span style='color:black;text-decoration:
none'>.................................................................................................................................................... </span><span style='color:black;text-decoration:none'>6</span></a></p>

<p class=MsoToc2><a href="#_Toc228497"><span style='color:#F31D19'>Section 4.2:
Nullable columns in tables</span><span style='color:black;text-decoration:none'>....................................................................................................................................................... </span><span style='color:black;text-decoration:none'>6</span></a></p>

<p class=MsoToc2><a href="#_Toc228498"><span style='color:#F31D19'>Section 4.3:
Updating fields to NULL</span><span style='color:black;text-decoration:none'>............................................................................................................................................................ </span><span style='color:black;text-decoration:none'>6</span></a></p>

<p class=MsoToc2><a href="#_Toc228499"><span style='color:#F31D19'>Section 4.4:
Inserting rows with NULL fields</span><span style='color:black;text-decoration:
none'>............................................................................................................................................... </span><span style='color:black;text-decoration:none'>7</span></a></p>

<p class=MsoToc1><a href="#_Toc228500"><b><span style='font-size:12.0pt;
line-height:110%;color:#F31D19'>Chapter 5: Example Databases and Tables</span></b><span
style='color:black;text-decoration:none'>.......................................................................................................................................... </span><span style='color:black;text-decoration:none'>8</span></a></p>

<p class=MsoToc2><a href="#_Toc228501"><span style='color:#F31D19'>Section 5.1:
Auto Shop Database</span><span style='color:black;text-decoration:none'>.................................................................................................................................................................. </span><span style='color:black;text-decoration:none'>8</span></a></p>

<p class=MsoToc2><a href="#_Toc228502"><span style='color:#F31D19'>Section 5.2:
Library Database</span><span style='color:black;text-decoration:none'>...................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>10</span></a></p>

<p class=MsoToc2><a href="#_Toc228503"><span style='color:#F31D19'>Section 5.3:
Countries Table</span><span style='color:black;text-decoration:none'>........................................................................................................................................................................ </span><span style='color:black;text-decoration:none'>13</span></a></p>

<p class=MsoToc1><a href="#_Toc228504"><b><span style='font-size:12.0pt;
line-height:110%;color:#F31D19'>Chapter 6: SELECT</span></b><span
style='color:black;text-decoration:none'>............................................................................................................................................................................................ </span><span style='color:black;text-decoration:none'>14</span></a></p>

<p class=MsoToc2><a href="#_Toc228505"><span style='color:#F31D19'>Section 6.1:
Using the wildcard character to select all columns in a query</span><span
style='color:black;text-decoration:none'>........................................................................................ </span><span style='color:black;text-decoration:none'>14</span></a></p>

<p class=MsoToc2><a href="#_Toc228506"><span style='color:#F31D19'>Section 6.2:
SELECT Using Column Aliases</span><span style='color:black;text-decoration:
none'>................................................................................................................................................ </span><span style='color:black;text-decoration:none'>15</span></a></p>

<p class=MsoToc2><a href="#_Toc228507"><span style='color:#F31D19'>Section 6.3:
Select Individual Columns</span><span style='color:black;text-decoration:none'>...................................................................................................................................................... </span><span style='color:black;text-decoration:none'>18</span></a></p>

<p class=MsoToc2><a href="#_Toc228508"><span style='color:#F31D19'>Section 6.4:
Selecting specified number of records</span><span style='color:black;
text-decoration:none'>................................................................................................................................ </span><span style='color:black;text-decoration:none'>19</span></a></p>

<p class=MsoToc2><a href="#_Toc228509"><span style='color:#F31D19'>Section 6.5:
Selecting with Condition</span><span style='color:black;text-decoration:none'>........................................................................................................................................................ </span><span style='color:black;text-decoration:none'>20</span></a></p>

<p class=MsoToc2><a href="#_Toc228510"><span style='color:#F31D19'>Section 6.6:
Selecting with CASE</span><span style='color:black;text-decoration:none'>................................................................................................................................................................. </span><span style='color:black;text-decoration:none'>20</span></a></p>

<p class=MsoToc2><a href="#_Toc228511"><span style='color:#F31D19'>Section 6.7:
Select columns which are named after reserved keywords</span><span
style='color:black;text-decoration:none'>............................................................................................. </span><span style='color:black;text-decoration:none'>21</span></a></p>

<p class=MsoToc2><a href="#_Toc228512"><span style='color:#F31D19'>Section 6.8:
Selecting with table alias</span><span style='color:black;text-decoration:none'>........................................................................................................................................................ </span><span style='color:black;text-decoration:none'>21</span></a></p>

<p class=MsoToc2><a href="#_Toc228513"><span style='color:#F31D19'>Section 6.9:
Selecting with more than 1 condition</span><span style='color:black;text-decoration:
none'>.................................................................................................................................. </span><span style='color:black;text-decoration:none'>22</span></a></p>

<p class=MsoToc2><a href="#_Toc228514"><span style='color:#F31D19'>Section
6.10: Selecting without Locking the table</span><span style='color:black;
text-decoration:none'>................................................................................................................................... </span><span style='color:black;text-decoration:none'>23</span></a></p>

<p class=MsoToc2><a href="#_Toc228515"><span style='color:#F31D19'>Section
6.11: Selecting with Aggregate functions</span><span style='color:black;
text-decoration:none'>.................................................................................................................................... </span><span style='color:black;text-decoration:none'>23</span></a></p>

<p class=MsoToc2><a href="#_Toc228516"><span style='color:#F31D19'>Section
6.12: Select with condition of multiple values from column</span><span
style='color:black;text-decoration:none'>................................................................................................... </span><span style='color:black;text-decoration:none'>24</span></a></p>

<p class=MsoToc2><a href="#_Toc228517"><span style='color:#F31D19'>Section
6.13: Get aggregated result for row groups</span><span style='color:black;
text-decoration:none'>................................................................................................................................ </span><span style='color:black;text-decoration:none'>24</span></a></p>

<p class=MsoToc2><a href="#_Toc228518"><span style='color:#F31D19'>Section
6.14: Selection with sorted Results</span><span style='color:black;text-decoration:
none'>.............................................................................................................................................. </span><span style='color:black;text-decoration:none'>25</span></a></p>

<p class=MsoToc2><a href="#_Toc228519"><span style='color:#F31D19'>Section
6.15: Selecting with null</span><span style='color:black;text-decoration:none'>................................................................................................................................................................. </span><span style='color:black;text-decoration:none'>25</span></a></p>

<p class=MsoToc2><a href="#_Toc228520"><span style='color:#F31D19'>Section
6.16: Select distinct (unique values only)</span><span style='color:black;
text-decoration:none'>.................................................................................................................................... </span><span style='color:black;text-decoration:none'>25</span></a></p>

<p class=MsoToc2><a href="#_Toc228521"><span style='color:#F31D19'>Section
6.17: Select rows from multiple tables</span><span style='color:black;
text-decoration:none'>........................................................................................................................................ </span><span style='color:black;text-decoration:none'>26</span></a></p>

<p class=MsoToc1><a href="#_Toc228522"><b><span style='font-size:12.0pt;
line-height:110%;color:#F31D19'>Chapter 7: GROUP BY</span></b><span
style='color:black;text-decoration:none'>.................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>27</span></a></p>

<p class=MsoToc2><a href="#_Toc228523"><span style='color:#F31D19'>Section 7.1:
Basic GROUP BY example</span><span style='color:black;text-decoration:none'>....................................................................................................................................................... </span><span style='color:black;text-decoration:none'>27</span></a></p>

<p class=MsoToc2><a href="#_Toc228524"><span style='color:#F31D19'>Section 7.2:
Filter GROUP BY results using a HAVING clause</span><span style='color:black;
text-decoration:none'>................................................................................................................. </span><span style='color:black;text-decoration:none'>28</span></a></p>

<p class=MsoToc2><a href="#_Toc228525"><span style='color:#F31D19'>Section 7.3:
USE GROUP BY to COUNT the number of rows for each unique entry in a given
column</span><span style='color:black;text-decoration:none'> ........................................ </span><span style='color:black;text-decoration:none'>28</span></a></p>

<p class=MsoToc2><a href="#_Toc228526"><span style='color:#F31D19'>Section 7.4:
ROLAP aggregation (Data Mining)</span><span style='color:black;text-decoration:
none'>........................................................................................................................................ </span><span style='color:black;text-decoration:none'>29</span></a></p>

<p class=MsoToc1><a href="#_Toc228527"><b><span style='font-size:12.0pt;
line-height:110%;color:#F31D19'>Chapter 8: ORDER BY</span></b><span
style='color:black;text-decoration:none'>..................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>31</span></a></p>

<p class=MsoToc2><a href="#_Toc228528"><span style='color:#F31D19'>Section 8.1:
Sorting by column number (instead of name)</span><span style='color:black;
text-decoration:none'>.................................................................................................................... </span><span style='color:black;text-decoration:none'>31</span></a></p>

<p class=MsoToc2><a href="#_Toc228529"><span style='color:#F31D19'>Section 8.2:
Use ORDER BY with TOP to return the top x rows based on a column's value</span><span
style='color:black;text-decoration:none'>............................................................. </span><span style='color:black;text-decoration:none'>31</span></a></p>

<p class=MsoToc2><a href="#_Toc228530"><span style='color:#F31D19'>Section 8.3:
Customizeed sorting order</span><span style='color:black;text-decoration:none'>..................................................................................................................................................... </span><span style='color:black;text-decoration:none'>32</span></a></p>

<p class=MsoToc2><a href="#_Toc228531"><span style='color:#F31D19'>Section 8.4:
Order by Alias</span><span style='color:black;text-decoration:none'>........................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>32</span></a></p>

<p class=MsoToc2><a href="#_Toc228532"><span style='color:#F31D19'>Section 8.5:
Sorting by multiple columns</span><span style='color:black;text-decoration:
none'>.................................................................................................................................................. </span><span style='color:black;text-decoration:none'>33</span></a></p>

<p class=MsoToc1><a href="#_Toc228533"><b><span style='font-size:12.0pt;
line-height:110%;color:#F31D19'>Chapter 9: AND &amp; OR Operators</span></b><span
style='color:black;text-decoration:none'>............................................................................................................................................................. </span><span style='color:black;text-decoration:none'>34</span></a></p>

<p class=MsoToc2><a href="#_Toc228534"><span style='color:#F31D19'>Section 9.1:
AND OR Example</span><span style='color:black;text-decoration:none'>..................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>34</span></a></p>

<p class=MsoToc1><a href="#_Toc228535"><b><span style='font-size:12.0pt;
line-height:110%;color:#F31D19'>Chapter 10: CASE</span></b><span
style='color:black;text-decoration:none'>............................................................................................................................................................................................. </span><span style='color:black;text-decoration:none'>35</span></a></p>

<p class=MsoToc2><a href="#_Toc228536"><span style='color:#F31D19'>Section
10.1: Use CASE to COUNT the number of rows in a column match a condition</span><span
style='color:black;text-decoration:none'>.................................................................. </span><span style='color:black;text-decoration:none'>35</span></a></p>

<p class=MsoToc2><a href="#_Toc228537"><span style='color:#F31D19'>Section
10.2: Searched CASE in SELECT (Matches a boolean expression)</span><span
style='color:black;text-decoration:none'>........................................................................................... </span><span style='color:black;text-decoration:none'>36</span></a></p>

<p class=MsoToc2><a href="#_Toc228538"><span style='color:#F31D19'>Section
10.3: CASE in a clause ORDER BY</span><span style='color:black;text-decoration:
none'>.................................................................................................................................................. </span><span style='color:black;text-decoration:none'>36</span></a></p>

<p class=MsoToc2><a href="#_Toc228539"><span style='color:#F31D19'>Section
10.4: Shorthand CASE in SELECT</span><span style='color:black;text-decoration:
none'>................................................................................................................................................... </span><span style='color:black;text-decoration:none'>36</span></a></p>

<p class=MsoToc2><a href="#_Toc228540"><span style='color:#F31D19'>Section
10.5: Using CASE in UPDATE</span><span style='color:black;text-decoration:none'>.......................................................................................................................................................... </span><span style='color:black;text-decoration:none'>37</span></a></p>

<p class=MsoToc2><a href="#_Toc228541"><span style='color:#F31D19'>Section
10.6: CASE use for NULL values ordered last</span><span style='color:black;
text-decoration:none'>.............................................................................................................................. </span><span style='color:black;text-decoration:none'>37</span></a></p>

<p class=MsoToc2><a href="#_Toc228542"><span style='color:#F31D19'>Section
10.7: CASE in ORDER BY clause to sort records by lowest value of 2 columns</span><span
style='color:black;text-decoration:none'>..................................................................... </span><span style='color:black;text-decoration:none'>38</span></a></p>

<p class=MsoToc1><a href="#_Toc228543"><b><span style='font-size:12.0pt;
line-height:110%;color:#F31D19'>Chapter 11: LIKE operator</span></b><span
style='color:black;text-decoration:none'>.......................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>39</span></a></p>

<p class=MsoToc2><a href="#_Toc228544"><span style='color:#F31D19'>Section
11.1: Match open-ended pattern</span><span style='color:black;text-decoration:
none'>................................................................................................................................................. </span><span style='color:black;text-decoration:none'>39</span></a></p>

<p class=MsoToc2><a href="#_Toc228545"><span style='color:#F31D19'>Section
11.2: Single character match</span><span style='color:black;text-decoration:
none'>......................................................................................................................................................... </span><span style='color:black;text-decoration:none'>40</span></a></p>

<p class=MsoToc2><a href="#_Toc228546"><span style='color:#F31D19'>Section
11.3: ESCAPE statement in the LIKE-query</span><span style='color:black;
text-decoration:none'>................................................................................................................................. </span><span style='color:black;text-decoration:none'>40</span></a></p>

<p class=MsoToc2><a href="#_Toc228547"><span style='color:#F31D19'>Section
11.4: Search for a range of characters</span><span style='color:black;
text-decoration:none'>......................................................................................................................................... </span><span style='color:black;text-decoration:none'>41</span></a></p>

<p class=MsoToc2><a href="#_Toc228548"><span style='color:#F31D19'>Section
11.5: Match by range or set</span><span style='color:black;text-decoration:
none'>........................................................................................................................................................... </span><span style='color:black;text-decoration:none'>41</span></a></p>

<p class=MsoToc2><a href="#_Toc228549"><span style='color:#F31D19'>Section
11.6: Wildcard characters</span><span style='color:black;text-decoration:none'>.............................................................................................................................................................. </span><span style='color:black;text-decoration:none'>41</span></a></p>

<p class=MsoToc1><a href="#_Toc228550"><b><span style='font-size:12.0pt;
line-height:110%;color:#F31D19'>Chapter 12: IN clause</span></b><span
style='color:black;text-decoration:none'>.................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>43</span></a></p>

<p class=MsoToc2><a href="#_Toc228551"><span style='color:#F31D19'>Section
12.1: Simple IN clause</span><span style='color:black;text-decoration:none'>.................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>43</span></a></p>

<p class=MsoToc2><a href="#_Toc228552"><span style='color:#F31D19'>Section
12.2: Using IN clause with a subquery</span><span style='color:black;
text-decoration:none'>......................................................................................................................................... </span><span style='color:black;text-decoration:none'>43</span></a></p>

<p class=MsoToc1><a href="#_Toc228553"><b><span style='font-size:12.0pt;
line-height:110%;color:#F31D19'>Chapter 13: Filter results using WHERE and
HAVING</span></b><span style='color:black;text-decoration:none'>.................................................................................................................. </span><span style='color:black;text-decoration:none'>44</span></a></p>

<p class=MsoToc2><a href="#_Toc228554"><span style='color:#F31D19'>Section
13.1: Use BETWEEN to Filter Results</span><span style='color:black;text-decoration:
none'>........................................................................................................................................... </span><span style='color:black;text-decoration:none'>44</span></a></p>

<p class=MsoToc2><a href="#_Toc228555"><span style='color:#F31D19'>Section
13.2: Use HAVING with Aggregate Functions</span><span style='color:black;
text-decoration:none'>............................................................................................................................. </span><span style='color:black;text-decoration:none'>45</span></a></p>

<p class=MsoToc2><a href="#_Toc228556"><span style='color:#F31D19'>Section
13.3: WHERE clause with NULL/NOT NULL values</span><span style='color:black;
text-decoration:none'>.................................................................................................................... </span><span style='color:black;text-decoration:none'>45</span></a></p>

<p class=MsoToc2><a href="#_Toc228557"><span style='color:#F31D19'>Section
13.4: Equality</span><span style='color:black;text-decoration:none'>.................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>46</span></a></p>

<p class=MsoToc2><a href="#_Toc228558"><span style='color:#F31D19'>Section
13.5: The WHERE clause only returns rows that match its criteria</span><span
style='color:black;text-decoration:none'>........................................................................................ </span><span style='color:black;text-decoration:none'>46</span></a></p>

<p class=MsoToc2><a href="#_Toc228559"><span style='color:#F31D19'>Section
13.6: AND and OR</span><span style='color:black;text-decoration:none'>............................................................................................................................................................................ </span><span style='color:black;text-decoration:none'>46</span></a></p>

<p class=MsoToc2><a href="#_Toc228560"><span style='color:#F31D19'>Section
13.7: Use IN to return rows with a value contained in a list</span><span
style='color:black;text-decoration:none'>.................................................................................................... </span><span style='color:black;text-decoration:none'>47</span></a></p>

<p class=MsoToc2><a href="#_Toc228561"><span style='color:#F31D19'>Section
13.8: Use LIKE to find matching strings and substrings</span><span
style='color:black;text-decoration:none'>............................................................................................................ </span><span style='color:black;text-decoration:none'>47</span></a></p>

<p class=MsoToc2><a href="#_Toc228562"><span style='color:#F31D19'>Section
13.9: Where EXISTS</span><span style='color:black;text-decoration:none'>......................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>48</span></a></p>

<p class=MsoToc2><a href="#_Toc228563"><span style='color:#F31D19'>Section
13.10: Use HAVING to check for multiple conditions in a group</span><span
style='color:black;text-decoration:none'>............................................................................................ </span><span style='color:black;text-decoration:none'>48</span></a></p>

<p class=MsoToc1><a href="#_Toc228564"><b><span style='font-size:12.0pt;
line-height:110%;color:#F31D19'>Chapter 14: SKIP TAKE (Pagination)</span></b><span
style='color:black;text-decoration:none'>...................................................................................................................................................... </span><span style='color:black;text-decoration:none'>50</span></a></p>

<p class=MsoToc2><a href="#_Toc228565"><span style='color:#F31D19'>Section
14.1: Limiting amount of results</span><span style='color:black;text-decoration:
none'>................................................................................................................................................... </span><span style='color:black;text-decoration:none'>50</span></a></p>

<p class=MsoToc2><a href="#_Toc228566"><span style='color:#F31D19'>Section
14.2: Skipping then taking some results (Pagination)</span><span
style='color:black;text-decoration:none'>............................................................................................................... </span><span style='color:black;text-decoration:none'>50</span></a></p>

<p class=MsoToc2><a href="#_Toc228567"><span style='color:#F31D19'>Section
14.3: Skipping some rows from result</span><span style='color:black;text-decoration:
none'>......................................................................................................................................... </span><span style='color:black;text-decoration:none'>51</span></a></p>

<p class=MsoToc1><a href="#_Toc228568"><b><span style='font-size:12.0pt;
line-height:110%;color:#F31D19'>Chapter 15: EXCEPT</span></b><span
style='color:black;text-decoration:none'>........................................................................................................................................................................................ </span><span style='color:black;text-decoration:none'>52</span></a></p>

<p class=MsoToc2><a href="#_Toc228569"><span style='color:#F31D19'>Section
15.1: Select dataset except where values are in this other dataset</span><span
style='color:black;text-decoration:none'>....................................................................................... </span><span style='color:black;text-decoration:none'>52</span></a></p>

<p class=MsoToc1><a href="#_Toc228570"><b><span style='font-size:12.0pt;
line-height:110%;color:#F31D19'>Chapter 16: EXPLAIN and DESCRIBE</span></b><span
style='color:black;text-decoration:none'>..................................................................................................................................................... </span><span style='color:black;text-decoration:none'>53</span></a></p>

<p class=MsoToc2><a href="#_Toc228571"><span style='color:#F31D19'>Section
16.1: EXPLAIN Select query</span><span style='color:black;text-decoration:none'>........................................................................................................................................................... </span><span style='color:black;text-decoration:none'>53</span></a></p>

<p class=MsoToc2><a href="#_Toc228572"><span style='color:#F31D19'>Section
16.2: DESCRIBE tablename;</span><span style='color:black;text-decoration:none'>........................................................................................................................................................... </span><span style='color:black;text-decoration:none'>53</span></a></p>

<p class=MsoToc1><a href="#_Toc228573"><b><span style='font-size:12.0pt;
line-height:110%;color:#F31D19'>Chapter 17: EXISTS CLAUSE</span></b><span
style='color:black;text-decoration:none'>........................................................................................................................................................................ </span><span style='color:black;text-decoration:none'>54</span></a></p>

<p class=MsoToc2><a href="#_Toc228574"><span style='color:#F31D19'>Section
17.1: EXISTS CLAUSE</span><span style='color:black;text-decoration:none'>....................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>54</span></a></p>

<p class=MsoToc1><a href="#_Toc228575"><b><span style='font-size:12.0pt;
line-height:110%;color:#F31D19'>Chapter 18: JOIN</span></b><span
style='color:black;text-decoration:none'>.............................................................................................................................................................................................. </span><span style='color:black;text-decoration:none'>55</span></a></p>

<p class=MsoToc2><a href="#_Toc228576"><span style='color:#F31D19'>Section
18.1: Self Join</span><span style='color:black;text-decoration:none'>................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>55</span></a></p>

<p class=MsoToc2><a href="#_Toc228577"><span style='color:#F31D19'>Section
18.2: Di&#57379;erences between inner/outer joins</span><span style='color:
black;text-decoration:none'>............................................................................................................................. </span><span style='color:black;text-decoration:none'>56</span></a></p>

<p class=MsoToc2><a href="#_Toc228578"><span style='color:#F31D19'>Section
18.3: JOIN Terminology: Inner, Outer, Semi, Anti</span><span style='color:black;
text-decoration:none'>...................................................................................................................... </span><span style='color:black;text-decoration:none'>59</span></a></p>

<p class=MsoToc2><a href="#_Toc228579"><span style='color:#F31D19'>Section
18.4: Left Outer Join</span><span style='color:black;text-decoration:none'>........................................................................................................................................................................ </span><span style='color:black;text-decoration:none'>69</span></a></p>

<p class=MsoToc2><a href="#_Toc228580"><span style='color:#F31D19'>Section
18.5: Implicit Join</span><span style='color:black;text-decoration:none'>............................................................................................................................................................................ </span><span style='color:black;text-decoration:none'>70</span></a></p>

<p class=MsoToc2><a href="#_Toc228581"><span style='color:#F31D19'>Section
18.6: CROSS JOIN</span><span style='color:black;text-decoration:none'>............................................................................................................................................................................. </span><span style='color:black;text-decoration:none'>71</span></a></p>

<p class=MsoToc2><a href="#_Toc228582"><span style='color:#F31D19'>Section
18.7: CROSS APPLY &amp; LATERAL JOIN</span><span style='color:black;text-decoration:
none'>............................................................................................................................................. </span><span style='color:black;text-decoration:none'>72</span></a></p>

<p class=MsoToc2><a href="#_Toc228583"><span style='color:#F31D19'>Section
18.8: FULL JOIN</span><span style='color:black;text-decoration:none'>................................................................................................................................................................................ </span><span style='color:black;text-decoration:none'>73</span></a></p>

<p class=MsoToc2><a href="#_Toc228584"><span style='color:#F31D19'>Section
18.9: Recursive JOINs</span><span style='color:black;text-decoration:none'>...................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>74</span></a></p>

<p class=MsoToc2><a href="#_Toc228585"><span style='color:#F31D19'>Section
18.10: Basic explicit inner join</span><span style='color:black;text-decoration:
none'>...................................................................................................................................................... </span><span style='color:black;text-decoration:none'>74</span></a></p>

<p class=MsoToc2><a href="#_Toc228586"><span style='color:#F31D19'>Section
18.11: Joining on a Subquery</span><span style='color:black;text-decoration:
none'>........................................................................................................................................................ </span><span style='color:black;text-decoration:none'>75</span></a></p>

<p class=MsoToc1><a href="#_Toc228587"><b><span style='font-size:12.0pt;
line-height:110%;color:#F31D19'>Chapter 19: UPDATE</span></b><span
style='color:black;text-decoration:none'>....................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>76</span></a></p>

<p class=MsoToc2><a href="#_Toc228588"><span style='color:#F31D19'>Section
19.1: UPDATE with data from another table</span><span style='color:black;
text-decoration:none'>.............................................................................................................................. </span><span style='color:black;text-decoration:none'>76</span></a></p>

<p class=MsoToc2><a href="#_Toc228589"><span style='color:#F31D19'>Section
19.2: Modifying existing values</span><span style='color:black;text-decoration:
none'>..................................................................................................................................................... </span><span style='color:black;text-decoration:none'>77</span></a></p>

<p class=MsoToc2><a href="#_Toc228590"><span style='color:#F31D19'>Section
19.3: Updating Specified Rows</span><span style='color:black;text-decoration:
none'>...................................................................................................................................................... </span><span style='color:black;text-decoration:none'>77</span></a></p>

<p class=MsoToc2><a href="#_Toc228591"><span style='color:#F31D19'>Section
19.4: Updating All Rows</span><span style='color:black;text-decoration:none'>................................................................................................................................................................. </span><span style='color:black;text-decoration:none'>77</span></a></p>

<p class=MsoToc2><a href="#_Toc228592"><span style='color:#F31D19'>Section
19.5: Capturing Updated records</span><span style='color:black;text-decoration:
none'>................................................................................................................................................. </span><span style='color:black;text-decoration:none'>77</span></a></p>

<p class=MsoToc1><a href="#_Toc228593"><b><span style='font-size:12.0pt;
line-height:110%;color:#F31D19'>Chapter 20: CREATE Database</span></b><span
style='color:black;text-decoration:none'>.................................................................................................................................................................. </span><span style='color:black;text-decoration:none'>78</span></a></p>

<p class=MsoToc2><a href="#_Toc228594"><span style='color:#F31D19'>Section
20.1: CREATE Database</span><span style='color:black;text-decoration:none'>................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>78</span></a></p>

<p class=MsoToc1><a href="#_Toc228595"><b><span style='font-size:12.0pt;
line-height:110%;color:#F31D19'>Chapter 21: CREATE TABLE</span></b><span
style='color:black;text-decoration:none'>......................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>79</span></a></p>

<p class=MsoToc2><a href="#_Toc228596"><span style='color:#F31D19'>Section
21.1: Create Table From Select</span><span style='color:black;text-decoration:
none'>..................................................................................................................................................... </span><span style='color:black;text-decoration:none'>79</span></a></p>

<p class=MsoToc2><a href="#_Toc228597"><span style='color:#F31D19'>Section
21.2: Create a New Table</span><span style='color:black;text-decoration:none'>............................................................................................................................................................... </span><span style='color:black;text-decoration:none'>79</span></a></p>

<p class=MsoToc2><a href="#_Toc228598"><span style='color:#F31D19'>Section
21.3: CREATE TABLE With FOREIGN KEY</span><span style='color:black;text-decoration:
none'>...................................................................................................................................... </span><span style='color:black;text-decoration:none'>79</span></a></p>

<p class=MsoToc2><a href="#_Toc228599"><span style='color:#F31D19'>Section
21.4: Duplicate a table</span><span style='color:black;text-decoration:none'>.................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>80</span></a></p>

<p class=MsoToc2><a href="#_Toc228600"><span style='color:#F31D19'>Section
21.5: Create a Temporary or In-Memory Table</span><span style='color:black;
text-decoration:none'>.......................................................................................................................... </span><span style='color:black;text-decoration:none'>80</span></a></p>

<p class=MsoToc1><a href="#_Toc228601"><b><span style='font-size:12.0pt;
line-height:110%;color:#F31D19'>Chapter 22: CREATE FUNCTION</span></b><span
style='color:black;text-decoration:none'>............................................................................................................................................................... </span><span style='color:black;text-decoration:none'>82</span></a></p>

<p class=MsoToc2><a href="#_Toc228602"><span style='color:#F31D19'>Section
22.1: Create a new Function</span><span style='color:black;text-decoration:
none'>.......................................................................................................................................................... </span><span style='color:black;text-decoration:none'>82</span></a></p>

<p class=MsoToc1><a href="#_Toc228603"><b><span style='font-size:12.0pt;
line-height:110%;color:#F31D19'>Chapter 23: TRY/CATCH</span></b><span
style='color:black;text-decoration:none'>................................................................................................................................................................................ </span><span style='color:black;text-decoration:none'>83</span></a></p>

<p class=MsoToc2><a href="#_Toc228604"><span style='color:#F31D19'>Section
23.1: Transaction In a TRY/CATCH</span><span style='color:black;text-decoration:
none'>................................................................................................................................................. </span><span style='color:black;text-decoration:none'>83</span></a></p>

<p class=MsoToc1><a href="#_Toc228605"><b><span style='font-size:12.0pt;
line-height:110%;color:#F31D19'>Chapter 24: UNION / UNION ALL</span></b><span
style='color:black;text-decoration:none'>............................................................................................................................................................ </span><span style='color:black;text-decoration:none'>84</span></a></p>

<p class=MsoToc2><a href="#_Toc228606"><span style='color:#F31D19'>Section
24.1: Basic UNION ALL query</span><span style='color:black;text-decoration:
none'>........................................................................................................................................................ </span><span style='color:black;text-decoration:none'>84</span></a></p>

<p class=MsoToc2><a href="#_Toc228607"><span style='color:#F31D19'>Section
24.2: Simple explanation and Example</span><span style='color:black;text-decoration:
none'>........................................................................................................................................ </span><span style='color:black;text-decoration:none'>85</span></a></p>

<p class=MsoToc1><a href="#_Toc228608"><b><span style='font-size:12.0pt;
line-height:110%;color:#F31D19'>Chapter 25: ALTER TABLE</span></b><span
style='color:black;text-decoration:none'>............................................................................................................................................................................ </span><span style='color:black;text-decoration:none'>86</span></a></p>

<p class=MsoToc2><a href="#_Toc228609"><span style='color:#F31D19'>Section
25.1: Add Column(s)</span><span style='color:black;text-decoration:none'>....................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>86</span></a></p>

<p class=MsoToc2><a href="#_Toc228610"><span style='color:#F31D19'>Section
25.2: Drop Column</span><span style='color:black;text-decoration:none'>.......................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>86</span></a></p>

<p class=MsoToc2><a href="#_Toc228611"><span style='color:#F31D19'>Section
25.3: Add Primary Key</span><span style='color:black;text-decoration:none'>.................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>86</span></a></p>

<p class=MsoToc2><a href="#_Toc228612"><span style='color:#F31D19'>Section
25.4: Alter Column</span><span style='color:black;text-decoration:none'>.......................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>86</span></a></p>

<p class=MsoToc2><a href="#_Toc228613"><span style='color:#F31D19'>Section
25.5: Drop Constraint</span><span style='color:black;text-decoration:none'>..................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>86</span></a></p>

<p class=MsoToc1><a href="#_Toc228614"><b><span style='font-size:12.0pt;
line-height:110%;color:#F31D19'>Chapter 26: INSERT</span></b><span
style='color:black;text-decoration:none'>......................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>87</span></a></p>

<p class=MsoToc2><a href="#_Toc228615"><span style='color:#F31D19'>Section
26.1: INSERT data from another table using SELECT</span><span style='color:
black;text-decoration:none'>................................................................................................................. </span><span style='color:black;text-decoration:none'>87</span></a></p>

<p class=MsoToc2><a href="#_Toc228616"><span style='color:#F31D19'>Section
26.2: Insert New Row</span><span style='color:black;text-decoration:none'>..................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>87</span></a></p>

<p class=MsoToc2><a href="#_Toc228617"><span style='color:#F31D19'>Section
26.3: Insert Only Specified Columns</span><span style='color:black;text-decoration:
none'>............................................................................................................................................ </span><span style='color:black;text-decoration:none'>87</span></a></p>

<p class=MsoToc2><a href="#_Toc228618"><span style='color:#F31D19'>Section
26.4: Insert multiple rows at once</span><span style='color:black;text-decoration:
none'>................................................................................................................................................ </span><span style='color:black;text-decoration:none'>87</span></a></p>

<p class=MsoToc1><a href="#_Toc228619"><b><span style='font-size:12.0pt;
line-height:110%;color:#F31D19'>Chapter 27: MERGE</span></b><span
style='color:black;text-decoration:none'>........................................................................................................................................................................................ </span><span style='color:black;text-decoration:none'>88</span></a></p>

<p class=MsoToc2><a href="#_Toc228620"><span style='color:#F31D19'>Section
27.1: MERGE to make Target match Source</span><span style='color:black;
text-decoration:none'>............................................................................................................................... </span><span style='color:black;text-decoration:none'>88</span></a></p>

<p class=MsoToc2><a href="#_Toc228621"><span style='color:#F31D19'>Section
27.2: MySQL: counting users by name</span><span style='color:black;text-decoration:
none'>........................................................................................................................................ </span><span style='color:black;text-decoration:none'>88</span></a></p>

<p class=MsoToc2><a href="#_Toc228622"><span style='color:#F31D19'>Section
27.3: PostgreSQL: counting users by name</span><span style='color:black;
text-decoration:none'>................................................................................................................................. </span><span style='color:black;text-decoration:none'>88</span></a></p>

<p class=MsoToc1><a href="#_Toc228623"><b><span style='font-size:12.0pt;
line-height:110%;color:#F31D19'>Chapter 28: cross apply, outer apply</span></b><span
style='color:black;text-decoration:none'>.................................................................................................................................................... </span><span style='color:black;text-decoration:none'>90</span></a></p>

<p class=MsoToc2><a href="#_Toc228624"><span style='color:#F31D19'>Section
28.1: CROSS APPLY and OUTER APPLY basics</span><span style='color:black;
text-decoration:none'>............................................................................................................................. </span><span style='color:black;text-decoration:none'>90</span></a></p>

<p class=MsoToc1><a href="#_Toc228625"><b><span style='font-size:12.0pt;
line-height:110%;color:#F31D19'>Chapter 29: DELETE</span></b><span
style='color:black;text-decoration:none'>........................................................................................................................................................................................ </span><span style='color:black;text-decoration:none'>92</span></a></p>

<p class=MsoToc2><a href="#_Toc228626"><span style='color:#F31D19'>Section
29.1: DELETE all rows</span><span style='color:black;text-decoration:none'>...................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>92</span></a></p>

<p class=MsoToc2><a href="#_Toc228627"><span style='color:#F31D19'>Section
29.2: DELETE certain rows with WHERE</span><span style='color:black;text-decoration:
none'>...................................................................................................................................... </span><span style='color:black;text-decoration:none'>92</span></a></p>

<p class=MsoToc2><a href="#_Toc228628"><span style='color:#F31D19'>Section
29.3: TRUNCATE clause</span><span style='color:black;text-decoration:none'>.................................................................................................................................................................. </span><span style='color:black;text-decoration:none'>92</span></a></p>

<p class=MsoToc2><a href="#_Toc228629"><span style='color:#F31D19'>Section
29.4: DELETE certain rows based upon comparisons with other tables</span><span
style='color:black;text-decoration:none'>................................................................................ </span><span style='color:black;text-decoration:none'>92</span></a></p>

<p class=MsoToc1><a href="#_Toc228630"><b><span style='font-size:12.0pt;
line-height:110%;color:#F31D19'>Chapter 30: TRUNCATE</span></b><span
style='color:black;text-decoration:none'>................................................................................................................................................................................. </span><span style='color:black;text-decoration:none'>94</span></a></p>

<p class=MsoToc2><a href="#_Toc228631"><span style='color:#F31D19'>Section
30.1: Removing all rows from the Employee table</span><span style='color:black;
text-decoration:none'>.................................................................................................................... </span><span style='color:black;text-decoration:none'>94</span></a></p>

<p class=MsoToc1><a href="#_Toc228632"><b><span style='font-size:12.0pt;
line-height:110%;color:#F31D19'>Chapter 31: DROP Table</span></b><span
style='color:black;text-decoration:none'>............................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>95</span></a></p>

<p class=MsoToc2><a href="#_Toc228633"><span style='color:#F31D19'>Section
31.1: Check for existence before dropping</span><span style='color:black;
text-decoration:none'>................................................................................................................................. </span><span style='color:black;text-decoration:none'>95</span></a></p>

<p class=MsoToc2><a href="#_Toc228634"><span style='color:#F31D19'>Section
31.2: Simple drop</span><span style='color:black;text-decoration:none'>............................................................................................................................................................................ </span><span style='color:black;text-decoration:none'>95</span></a></p>

<p class=MsoToc1><a href="#_Toc228635"><b><span style='font-size:12.0pt;
line-height:110%;color:#F31D19'>Chapter 32: DROP or DELETE Database</span></b><span
style='color:black;text-decoration:none'>.............................................................................................................................................. </span><span style='color:black;text-decoration:none'>96</span></a></p>

<p class=MsoToc2><a href="#_Toc228636"><span style='color:#F31D19'>Section
32.1: DROP Database</span><span style='color:black;text-decoration:none'>...................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>96</span></a></p>

<p class=MsoToc1><a href="#_Toc228637"><b><span style='font-size:12.0pt;
line-height:110%;color:#F31D19'>Chapter 33: Cascading Delete</span></b><span
style='color:black;text-decoration:none'>................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>97</span></a></p>

<p class=MsoToc2><a href="#_Toc228638"><span style='color:#F31D19'>Section
33.1: ON DELETE CASCADE</span><span style='color:black;text-decoration:none'>............................................................................................................................................................ </span><span style='color:black;text-decoration:none'>97</span></a></p>

<p class=MsoToc1><a href="#_Toc228639"><b><span style='font-size:12.0pt;
line-height:110%;color:#F31D19'>Chapter 34: GRANT and REVOKE</span></b><span
style='color:black;text-decoration:none'>............................................................................................................................................................ </span><span style='color:black;text-decoration:none'>99</span></a></p>

<p class=MsoToc2><a href="#_Toc228640"><span style='color:#F31D19'>Section
34.1: Grant/revoke privileges</span><span style='color:black;text-decoration:
none'>........................................................................................................................................................ </span><span style='color:black;text-decoration:none'>99</span></a></p>

<p class=MsoToc1><a href="#_Toc228641"><b><span style='font-size:12.0pt;
line-height:110%;color:#F31D19'>Chapter 35: XML</span></b><span
style='color:black;text-decoration:none'>............................................................................................................................................................................................ </span><span style='color:black;text-decoration:none'>100</span></a></p>

<p class=MsoToc2><a href="#_Toc228642"><span style='color:#F31D19'>Section
35.1: Query from XML Data Type</span><span style='color:black;text-decoration:
none'>............................................................................................................................................... </span><span style='color:black;text-decoration:none'>100</span></a></p>

<p class=MsoToc1><a href="#_Toc228643"><b><span style='font-size:12.0pt;
line-height:110%;color:#F31D19'>Chapter 36: Primary Keys</span></b><span
style='color:black;text-decoration:none'>......................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>101</span></a></p>

<p class=MsoToc2><a href="#_Toc228644"><span style='color:#F31D19'>Section
36.1: Creating a Primary Key</span><span style='color:black;text-decoration:
none'>....................................................................................................................................................... </span><span style='color:black;text-decoration:none'>101</span></a></p>

<p class=MsoToc2><a href="#_Toc228645"><span style='color:#F31D19'>Section
36.2: Using Auto Increment</span><span style='color:black;text-decoration:none'>........................................................................................................................................................ </span><span style='color:black;text-decoration:none'>101</span></a></p>

<p class=MsoToc1><a href="#_Toc228646"><b><span style='font-size:12.0pt;
line-height:110%;color:#F31D19'>Chapter 37: Indexes</span></b><span
style='color:black;text-decoration:none'>..................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>102</span></a></p>

<p class=MsoToc2><a href="#_Toc228647"><span style='color:#F31D19'>Section
37.1: Sorted Index</span><span style='color:black;text-decoration:none'>......................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>102</span></a></p>

<p class=MsoToc2><a href="#_Toc228648"><span style='color:#F31D19'>Section
37.2: Partial or Filtered Index</span><span style='color:black;text-decoration:
none'>...................................................................................................................................................... </span><span style='color:black;text-decoration:none'>102</span></a></p>

<p class=MsoToc2><a href="#_Toc228649"><span style='color:#F31D19'>Section
37.3: Creating an Index</span><span style='color:black;text-decoration:none'>................................................................................................................................................................ </span><span style='color:black;text-decoration:none'>102</span></a></p>

<p class=MsoToc2><a href="#_Toc228650"><span style='color:#F31D19'>Section
37.4: Dropping an Index, or Disabling and Rebuilding it</span><span
style='color:black;text-decoration:none'>........................................................................................................ </span><span style='color:black;text-decoration:none'>103</span></a></p>

<p class=MsoToc2><a href="#_Toc228651"><span style='color:#F31D19'>Section
37.5: Clustered, Unique, and Sorted Indexes</span><span style='color:black;
text-decoration:none'>........................................................................................................................... </span><span style='color:black;text-decoration:none'>103</span></a></p>

<p class=MsoToc2><a href="#_Toc228652"><span style='color:#F31D19'>Section
37.6: Rebuild index</span><span style='color:black;text-decoration:none'>....................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>104</span></a></p>

<p class=MsoToc2><a href="#_Toc228653"><span style='color:#F31D19'>Section
37.7: Inserting with a Unique Index</span><span style='color:black;text-decoration:
none'>........................................................................................................................................... </span><span style='color:black;text-decoration:none'>104</span></a></p>

<p class=MsoToc1><a href="#_Toc228654"><b><span style='font-size:12.0pt;
line-height:110%;color:#F31D19'>Chapter 38: Row number</span></b><span
style='color:black;text-decoration:none'>......................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>105</span></a></p>

<p class=MsoToc2><a href="#_Toc228655"><span style='color:#F31D19'>Section
38.1: Delete All But Last Record (1 to Many Table)</span><span
style='color:black;text-decoration:none'>................................................................................................................. </span><span style='color:black;text-decoration:none'>105</span></a></p>

<p class=MsoToc2><a href="#_Toc228656"><span style='color:#F31D19'>Section
38.2: Row numbers without partitions</span><span style='color:black;text-decoration:
none'>..................................................................................................................................... </span><span style='color:black;text-decoration:none'>105</span></a></p>

<p class=MsoToc2><a href="#_Toc228657"><span style='color:#F31D19'>Section
38.3: Row numbers with partitions</span><span style='color:black;text-decoration:
none'>........................................................................................................................................... </span><span style='color:black;text-decoration:none'>105</span></a></p>

<p class=MsoToc1><a href="#_Toc228658"><b><span style='font-size:12.0pt;
line-height:110%;color:#F31D19'>Chapter 39: SQL Group By vs Distinct</span></b><span
style='color:black;text-decoration:none'>................................................................................................................................................ </span><span style='color:black;text-decoration:none'>106</span></a></p>

<p class=MsoToc2><a href="#_Toc228659"><span style='color:#F31D19'>Section
39.1: Di&#57379;erence between GROUP BY and DISTINCT</span><span
style='color:black;text-decoration:none'>............................................................................................................... </span><span style='color:black;text-decoration:none'>106</span></a></p>

<p class=MsoToc1><a href="#_Toc228660"><b><span style='font-size:12.0pt;
line-height:110%;color:#F31D19'>Chapter 40: Finding Duplicates on a Column
Subset with Detail</span></b><span style='color:black;text-decoration:none'>....................................................................................... </span><span style='color:black;text-decoration:none'>107</span></a></p>

<p class=MsoToc2><a href="#_Toc228661"><span style='color:#F31D19'>Section
40.1: Students with same name and date of birth</span><span style='color:black;
text-decoration:none'>.................................................................................................................. </span><span style='color:black;text-decoration:none'>107</span></a></p>

<p class=MsoToc1><a href="#_Toc228662"><b><span style='font-size:12.0pt;
line-height:110%;color:#F31D19'>Chapter 41: String Functions</span></b><span
style='color:black;text-decoration:none'>.................................................................................................................................................................. </span><span style='color:black;text-decoration:none'>108</span></a></p>

<p class=MsoToc2><a href="#_Toc228663"><span style='color:#F31D19'>Section
41.1: Concatenate</span><span style='color:black;text-decoration:none'>......................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>108</span></a></p>

<p class=MsoToc2><a href="#_Toc228664"><span style='color:#F31D19'>Section
41.2: Length</span><span style='color:black;text-decoration:none'>................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>108</span></a></p>

<p class=MsoToc2><a href="#_Toc228665"><span style='color:#F31D19'>Section
41.3: Trim empty spaces</span><span style='color:black;text-decoration:none'>.............................................................................................................................................................. </span><span style='color:black;text-decoration:none'>109</span></a></p>

<p class=MsoToc2><a href="#_Toc228666"><span style='color:#F31D19'>Section
41.4: Upper &amp; lower case</span><span style='color:black;text-decoration:
none'>............................................................................................................................................................ </span><span style='color:black;text-decoration:none'>109</span></a></p>

<p class=MsoToc2><a href="#_Toc228667"><span style='color:#F31D19'>Section
41.5: Split</span><span style='color:black;text-decoration:none'>........................................................................................................................................................................................ </span><span style='color:black;text-decoration:none'>109</span></a></p>

<p class=MsoToc2><a href="#_Toc228668"><span style='color:#F31D19'>Section
41.6: Replace</span><span style='color:black;text-decoration:none'>.................................................................................................................................................................................. </span><span style='color:black;text-decoration:none'>110</span></a></p>

<p class=MsoToc2><a href="#_Toc228669"><span style='color:#F31D19'>Section
41.7: REGEXP</span><span style='color:black;text-decoration:none'>.................................................................................................................................................................................. </span><span style='color:black;text-decoration:none'>110</span></a></p>

<p class=MsoToc2><a href="#_Toc228670"><span style='color:#F31D19'>Section
41.8: Substring</span><span style='color:black;text-decoration:none'>............................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>110</span></a></p>

<p class=MsoToc2><a href="#_Toc228671"><span style='color:#F31D19'>Section
41.9: Stu&#57379;</span><span style='color:black;text-decoration:none'>........................................................................................................................................................................................ </span><span style='color:black;text-decoration:none'>110</span></a></p>

<p class=MsoToc2><a href="#_Toc228672"><span style='color:#F31D19'>Section
41.10: LEFT - RIGHT</span><span style='color:black;text-decoration:none'>....................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>110</span></a></p>

<p class=MsoToc2><a href="#_Toc228673"><span style='color:#F31D19'>Section
41.11: REVERSE</span><span style='color:black;text-decoration:none'>.............................................................................................................................................................................. </span><span style='color:black;text-decoration:none'>111</span></a></p>

<p class=MsoToc2><a href="#_Toc228674"><span style='color:#F31D19'>Section
41.12: REPLICATE</span><span style='color:black;text-decoration:none'>........................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>111</span></a></p>

<p class=MsoToc2><a href="#_Toc228675"><span style='color:#F31D19'>Section
41.13: Replace function in sql Select and Update query</span><span
style='color:black;text-decoration:none'>....................................................................................................... </span><span style='color:black;text-decoration:none'>111</span></a></p>

<p class=MsoToc2><a href="#_Toc228676"><span style='color:#F31D19'>Section
41.14: INSTR</span><span style='color:black;text-decoration:none'>................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>112</span></a></p>

<p class=MsoToc2><a href="#_Toc228677"><span style='color:#F31D19'>Section
41.15: PARSENAME</span><span style='color:black;text-decoration:none'>....................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>112</span></a></p>

<p class=MsoToc1><a href="#_Toc228678"><b><span style='font-size:12.0pt;
line-height:110%;color:#F31D19'>Chapter 42: Functions (Aggregate)</span></b><span
style='color:black;text-decoration:none'>...................................................................................................................................................... </span><span style='color:black;text-decoration:none'>114</span></a></p>

<p class=MsoToc2><a href="#_Toc228679"><span style='color:#F31D19'>Section
42.1: Conditional aggregation</span><span style='color:black;text-decoration:
none'>..................................................................................................................................................... </span><span style='color:black;text-decoration:none'>114</span></a></p>

<p class=MsoToc2><a href="#_Toc228680"><span style='color:#F31D19'>Section
42.2: List Concatenation</span><span style='color:black;text-decoration:none'>.............................................................................................................................................................. </span><span style='color:black;text-decoration:none'>114</span></a></p>

<p class=MsoToc2><a href="#_Toc228681"><span style='color:#F31D19'>Section
42.3: SUM</span><span style='color:black;text-decoration:none'>....................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>116</span></a></p>

<p class=MsoToc2><a href="#_Toc228682"><span style='color:#F31D19'>Section
42.4: AVG()</span><span style='color:black;text-decoration:none'>..................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>116</span></a></p>

<p class=MsoToc2><a href="#_Toc228683"><span style='color:#F31D19'>Section
42.5: Count</span><span style='color:black;text-decoration:none'>..................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>116</span></a></p>

<p class=MsoToc2><a href="#_Toc228684"><span style='color:#F31D19'>Section
42.6: Min</span><span style='color:black;text-decoration:none'>......................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>117</span></a></p>

<p class=MsoToc2><a href="#_Toc228685"><span style='color:#F31D19'>Section
42.7: Max</span><span style='color:black;text-decoration:none'>........................................................................................................................................................................................ </span><span style='color:black;text-decoration:none'>118</span></a></p>

<p class=MsoToc1><a href="#_Toc228686"><b><span style='font-size:12.0pt;
line-height:110%;color:#F31D19'>Chapter 43: Functions (Scalar/Single Row)</span></b><span
style='color:black;text-decoration:none'>.................................................................................................................................... </span><span style='color:black;text-decoration:none'>119</span></a></p>

<p class=MsoToc2><a href="#_Toc228687"><span style='color:#F31D19'>Section
43.1: Date And Time</span><span style='color:black;text-decoration:none'>..................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>119</span></a></p>

<p class=MsoToc2><a href="#_Toc228688"><span style='color:#F31D19'>Section
43.2: Character modifications</span><span style='color:black;text-decoration:
none'>..................................................................................................................................................... </span><span style='color:black;text-decoration:none'>120</span></a></p>

<p class=MsoToc2><a href="#_Toc228689"><span style='color:#F31D19'>Section
43.3: Configuration and Conversion Function</span><span style='color:black;
text-decoration:none'>.......................................................................................................................... </span><span style='color:black;text-decoration:none'>120</span></a></p>

<p class=MsoToc2><a href="#_Toc228690"><span style='color:#F31D19'>Section
43.4: Logical and Mathmetical Function</span><span style='color:black;
text-decoration:none'>................................................................................................................................... </span><span style='color:black;text-decoration:none'>121</span></a></p>

<p class=MsoToc1><a href="#_Toc228691"><b><span style='font-size:12.0pt;
line-height:110%;color:#F31D19'>Chapter 44: Functions (Analytic)</span></b><span
style='color:black;text-decoration:none'>.......................................................................................................................................................... </span><span style='color:black;text-decoration:none'>123</span></a></p>

<p class=MsoToc2><a href="#_Toc228692"><span style='color:#F31D19'>Section
44.1: LAG and LEAD</span><span style='color:black;text-decoration:none'>...................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>123</span></a></p>

<p class=MsoToc2><a href="#_Toc228693"><span style='color:#F31D19'>Section
44.2: PERCENTILE_DISC and PERCENTILE_CONT</span><span style='color:black;
text-decoration:none'>..................................................................................................................... </span><span style='color:black;text-decoration:none'>123</span></a></p>

<p class=MsoToc2><a href="#_Toc228694"><span style='color:#F31D19'>Section
44.3: FIRST_VALUE</span><span style='color:black;text-decoration:none'>........................................................................................................................................................................ </span><span style='color:black;text-decoration:none'>124</span></a></p>

<p class=MsoToc2><a href="#_Toc228695"><span style='color:#F31D19'>Section
44.4: LAST_VALUE</span><span style='color:black;text-decoration:none'>......................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>125</span></a></p>

<p class=MsoToc2><a href="#_Toc228696"><span style='color:#F31D19'>Section
44.5: PERCENT_RANK and CUME_DIST</span><span style='color:black;text-decoration:
none'>..................................................................................................................................... </span><span style='color:black;text-decoration:none'>125</span></a></p>

<p class=MsoToc1><a href="#_Toc228697"><b><span style='font-size:12.0pt;
line-height:110%;color:#F31D19'>Chapter 45: Window Functions</span></b><span
style='color:black;text-decoration:none'>............................................................................................................................................................. </span><span style='color:black;text-decoration:none'>127</span></a></p>

<p class=MsoToc2><a href="#_Toc228698"><span style='color:#F31D19'>Section
45.1: Setting up a flag if other rows have a common property</span><span
style='color:black;text-decoration:none'>............................................................................................ </span><span style='color:black;text-decoration:none'>127</span></a></p>

<p class=MsoToc2><a href="#_Toc228699"><span style='color:#F31D19'>Section
45.2: Finding &quot;out-of-sequence&quot; records using the LAG() function</span><span
style='color:black;text-decoration:none'>..................................................................................... </span><span style='color:black;text-decoration:none'>127</span></a></p>

<p class=MsoToc2><a href="#_Toc228700"><span style='color:#F31D19'>Section
45.3: Getting a running total</span><span style='color:black;text-decoration:
none'>....................................................................................................................................................... </span><span style='color:black;text-decoration:none'>128</span></a></p>

<p class=MsoToc2><a href="#_Toc228701"><span style='color:#F31D19'>Section
45.4: Adding the total rows selected to every row</span><span style='color:
black;text-decoration:none'>................................................................................................................. </span><span style='color:black;text-decoration:none'>128</span></a></p>

<p class=MsoToc2><a href="#_Toc228702"><span style='color:#F31D19'>Section
45.5: Getting the N most recent rows over multiple grouping</span><span
style='color:black;text-decoration:none'>............................................................................................. </span><span style='color:black;text-decoration:none'>129</span></a></p>

<p class=MsoToc1><a href="#_Toc228703"><b><span style='font-size:12.0pt;
line-height:110%;color:#F31D19'>Chapter 46: Common Table Expressions</span></b><span
style='color:black;text-decoration:none'>.......................................................................................................................................... </span><span style='color:black;text-decoration:none'>130</span></a></p>

<p class=MsoToc2><a href="#_Toc228704"><span style='color:#F31D19'>Section
46.1: generating values</span><span style='color:black;text-decoration:none'>................................................................................................................................................................ </span><span style='color:black;text-decoration:none'>130</span></a></p>

<p class=MsoToc2><a href="#_Toc228705"><span style='color:#F31D19'>Section
46.2: recursively enumerating a subtree</span><span style='color:black;
text-decoration:none'>.................................................................................................................................. </span><span style='color:black;text-decoration:none'>130</span></a></p>

<p class=MsoToc2><a href="#_Toc228706"><span style='color:#F31D19'>Section
46.3: Temporary query</span><span style='color:black;text-decoration:none'>................................................................................................................................................................. </span><span style='color:black;text-decoration:none'>131</span></a></p>

<p class=MsoToc2><a href="#_Toc228707"><span style='color:#F31D19'>Section
46.4: recursively going up in a tree</span><span style='color:black;text-decoration:
none'>............................................................................................................................................ </span><span style='color:black;text-decoration:none'>131</span></a></p>

<p class=MsoToc2><a href="#_Toc228708"><span style='color:#F31D19'>Section
46.5: Recursively generate dates, extended to include team rostering as example</span><span
style='color:black;text-decoration:none'>......................................................... </span><span style='color:black;text-decoration:none'>132</span></a></p>

<p class=MsoToc2><a href="#_Toc228709"><span style='color:#F31D19'>Section
46.6: Oracle CONNECT BY functionality with recursive CTEs</span><span
style='color:black;text-decoration:none'>................................................................................................ </span><span style='color:black;text-decoration:none'>132</span></a></p>

<p class=MsoToc1><a href="#_Toc228710"><b><span style='font-size:12.0pt;
line-height:110%;color:#F31D19'>Chapter 47: Views</span></b><span
style='color:black;text-decoration:none'>......................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>134</span></a></p>

<p class=MsoToc2><a href="#_Toc228711"><span style='color:#F31D19'>Section
47.1: Simple views</span><span style='color:black;text-decoration:none'>........................................................................................................................................................................ </span><span style='color:black;text-decoration:none'>134</span></a></p>

<p class=MsoToc2><a href="#_Toc228712"><span style='color:#F31D19'>Section
47.2: Complex views</span><span style='color:black;text-decoration:none'>..................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>134</span></a></p>

<p class=MsoToc1><a href="#_Toc228713"><b><span style='font-size:12.0pt;
line-height:110%;color:#F31D19'>Chapter 48: Materialized Views</span></b><span
style='color:black;text-decoration:none'>............................................................................................................................................................ </span><span style='color:black;text-decoration:none'>135</span></a></p>

<p class=MsoToc2><a href="#_Toc228714"><span style='color:#F31D19'>Section
48.1: PostgreSQL example</span><span style='color:black;text-decoration:none'>........................................................................................................................................................... </span><span style='color:black;text-decoration:none'>135</span></a></p>

<p class=MsoToc1><a href="#_Toc228715"><b><span style='font-size:12.0pt;
line-height:110%;color:#F31D19'>Chapter 49: Comments</span></b><span
style='color:black;text-decoration:none'>.............................................................................................................................................................................. </span><span style='color:black;text-decoration:none'>136</span></a></p>

<p class=MsoToc2><a href="#_Toc228716"><span style='color:#F31D19'>Section
49.1: Single-line comments</span><span style='color:black;text-decoration:none'>......................................................................................................................................................... </span><span style='color:black;text-decoration:none'>136</span></a></p>

<p class=MsoToc2><a href="#_Toc228717"><span style='color:#F31D19'>Section
49.2: Multi-line comments</span><span style='color:black;text-decoration:none'>.......................................................................................................................................................... </span><span style='color:black;text-decoration:none'>136</span></a></p>

<p class=MsoToc1><a href="#_Toc228718"><b><span style='font-size:12.0pt;
line-height:110%;color:#F31D19'>Chapter 50: Foreign Keys</span></b><span
style='color:black;text-decoration:none'>.......................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>137</span></a></p>

<p class=MsoToc2><a href="#_Toc228719"><span style='color:#F31D19'>Section
50.1: Foreign Keys explained</span><span style='color:black;text-decoration:
none'>....................................................................................................................................................... </span><span style='color:black;text-decoration:none'>137</span></a></p>

<p class=MsoToc2><a href="#_Toc228720"><span style='color:#F31D19'>Section
50.2: Creating a table with a foreign key</span><span style='color:black;
text-decoration:none'>.................................................................................................................................. </span><span style='color:black;text-decoration:none'>137</span></a></p>

<p class=MsoToc1><a href="#_Toc228721"><b><span style='font-size:12.0pt;
line-height:110%;color:#F31D19'>Chapter 51: Sequence</span></b><span
style='color:black;text-decoration:none'>................................................................................................................................................................................ </span><span style='color:black;text-decoration:none'>139</span></a></p>

<p class=MsoToc2><a href="#_Toc228722"><span style='color:#F31D19'>Section
51.1: Create Sequence</span><span style='color:black;text-decoration:none'>................................................................................................................................................................. </span><span style='color:black;text-decoration:none'>139</span></a></p>

<p class=MsoToc2><a href="#_Toc228723"><span style='color:#F31D19'>Section
51.2: Using Sequences</span><span style='color:black;text-decoration:none'>................................................................................................................................................................. </span><span style='color:black;text-decoration:none'>139</span></a></p>

<p class=MsoToc1><a href="#_Toc228724"><b><span style='font-size:12.0pt;
line-height:110%;color:#F31D19'>Chapter 52: Subqueries</span></b><span
style='color:black;text-decoration:none'>............................................................................................................................................................................. </span><span style='color:black;text-decoration:none'>140</span></a></p>

<p class=MsoToc2><a href="#_Toc228725"><span style='color:#F31D19'>Section
52.1: Subquery in FROM clause</span><span style='color:black;text-decoration:
none'>.................................................................................................................................................. </span><span style='color:black;text-decoration:none'>140</span></a></p>

<p class=MsoToc2><a href="#_Toc228726"><span style='color:#F31D19'>Section
52.2: Subquery in SELECT clause</span><span style='color:black;text-decoration:
none'>................................................................................................................................................ </span><span style='color:black;text-decoration:none'>140</span></a></p>

<p class=MsoToc2><a href="#_Toc228727"><span style='color:#F31D19'>Section
52.3: Subquery in WHERE clause</span><span style='color:black;text-decoration:
none'>............................................................................................................................................... </span><span style='color:black;text-decoration:none'>140</span></a></p>

<p class=MsoToc2><a href="#_Toc228728"><span style='color:#F31D19'>Section
52.4: Correlated Subqueries</span><span style='color:black;text-decoration:
none'>....................................................................................................................................................... </span><span style='color:black;text-decoration:none'>140</span></a></p>

<p class=MsoToc2><a href="#_Toc228729"><span style='color:#F31D19'>Section
52.5: Filter query results using query on di&#57379;erent table</span><span
style='color:black;text-decoration:none'>........................................................................................................ </span><span style='color:black;text-decoration:none'>140</span></a></p>

<p class=MsoToc2><a href="#_Toc228730"><span style='color:#F31D19'>Section
52.6: Subqueries in FROM clause</span><span style='color:black;text-decoration:
none'>............................................................................................................................................... </span><span style='color:black;text-decoration:none'>141</span></a></p>

<p class=MsoToc2><a href="#_Toc228731"><span style='color:#F31D19'>Section
52.7: Subqueries in WHERE clause</span><span style='color:black;text-decoration:
none'>............................................................................................................................................ </span><span style='color:black;text-decoration:none'>141</span></a></p>

<p class=MsoToc1><a href="#_Toc228732"><b><span style='font-size:12.0pt;
line-height:110%;color:#F31D19'>Chapter 53: Execution blocks</span></b><span
style='color:black;text-decoration:none'>................................................................................................................................................................. </span><span style='color:black;text-decoration:none'>142</span></a></p>

<p class=MsoToc2><a href="#_Toc228733"><span style='color:#F31D19'>Section
53.1: Using BEGIN ... END</span><span style='color:black;text-decoration:none'>............................................................................................................................................................ </span><span style='color:black;text-decoration:none'>142</span></a></p>

<p class=MsoToc1><a href="#_Toc228734"><b><span style='font-size:12.0pt;
line-height:110%;color:#F31D19'>Chapter 54: Stored Procedures</span></b><span
style='color:black;text-decoration:none'>............................................................................................................................................................. </span><span style='color:black;text-decoration:none'>143</span></a></p>

<p class=MsoToc2><a href="#_Toc228735"><span style='color:#F31D19'>Section
54.1: Create and call a stored procedure</span><span style='color:black;
text-decoration:none'>.................................................................................................................................. </span><span style='color:black;text-decoration:none'>143</span></a></p>

<p class=MsoToc1><a href="#_Toc228736"><b><span style='font-size:12.0pt;
line-height:110%;color:#F31D19'>Chapter 55: Triggers</span></b><span
style='color:black;text-decoration:none'>..................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>144</span></a></p>

<p class=MsoToc2><a href="#_Toc228737"><span style='color:#F31D19'>Section
55.1: CREATE TRIGGER</span><span style='color:black;text-decoration:none'>................................................................................................................................................................. </span><span style='color:black;text-decoration:none'>144</span></a></p>

<p class=MsoToc2><a href="#_Toc228738"><span style='color:#F31D19'>Section
55.2: Use Trigger to manage a &quot;Recycle Bin&quot; for deleted items</span><span
style='color:black;text-decoration:none'>........................................................................................... </span><span style='color:black;text-decoration:none'>144</span></a></p>

<p class=MsoToc1><a href="#_Toc228739"><b><span style='font-size:12.0pt;
line-height:110%;color:#F31D19'>Chapter 56: Transactions</span></b><span
style='color:black;text-decoration:none'>.......................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>145</span></a></p>

<p class=MsoToc2><a href="#_Toc228740"><span style='color:#F31D19'>Section
56.1: Simple Transaction</span><span style='color:black;text-decoration:none'>.............................................................................................................................................................. </span><span style='color:black;text-decoration:none'>145</span></a></p>

<p class=MsoToc2><a href="#_Toc228741"><span style='color:#F31D19'>Section
56.2: Rollback Transaction</span><span style='color:black;text-decoration:none'>........................................................................................................................................................... </span><span style='color:black;text-decoration:none'>145</span></a></p>

<p class=MsoToc1><a href="#_Toc228742"><b><span style='font-size:12.0pt;
line-height:110%;color:#F31D19'>Chapter 57: Table Design</span></b><span
style='color:black;text-decoration:none'>.......................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>146</span></a></p>

<p class=MsoToc2><a href="#_Toc228743"><span style='color:#F31D19'>Section
57.1: Properties of a well designed table</span><span style='color:black;
text-decoration:none'>................................................................................................................................. </span><span style='color:black;text-decoration:none'>146</span></a></p>

<p class=MsoToc1><a href="#_Toc228744"><b><span style='font-size:12.0pt;
line-height:110%;color:#F31D19'>Chapter 58: Synonyms</span></b><span
style='color:black;text-decoration:none'>............................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>147</span></a></p>

<p class=MsoToc2><a href="#_Toc228745"><span style='color:#F31D19'>Section
58.1: Create Synonym</span><span style='color:black;text-decoration:none'>.................................................................................................................................................................. </span><span style='color:black;text-decoration:none'>147</span></a></p>

<p class=MsoToc1><a href="#_Toc228746"><b><span style='font-size:12.0pt;
line-height:110%;color:#F31D19'>Chapter 59: Information Schema</span></b><span
style='color:black;text-decoration:none'>......................................................................................................................................................... </span><span style='color:black;text-decoration:none'>148</span></a></p>

<p class=MsoToc2><a href="#_Toc228747"><span style='color:#F31D19'>Section
59.1: Basic Information Schema Search</span><span style='color:black;
text-decoration:none'>.................................................................................................................................... </span><span style='color:black;text-decoration:none'>148</span></a></p>

<p class=MsoToc1><a href="#_Toc228748"><b><span style='font-size:12.0pt;
line-height:110%;color:#F31D19'>Chapter 60: Order of Execution</span></b><span
style='color:black;text-decoration:none'>............................................................................................................................................................ </span><span style='color:black;text-decoration:none'>149</span></a></p>

<p class=MsoToc2><a href="#_Toc228749"><span style='color:#F31D19'>Section
60.1: Logical Order of Query Processing in SQL</span><span style='color:black;
text-decoration:none'>....................................................................................................................... </span><span style='color:black;text-decoration:none'>149</span></a></p>

<p class=MsoToc1><a href="#_Toc228750"><b><span style='font-size:12.0pt;
line-height:110%;color:#F31D19'>Chapter 61: Clean Code in SQL</span></b><span
style='color:black;text-decoration:none'>.............................................................................................................................................................. </span><span style='color:black;text-decoration:none'>150</span></a></p>

<p class=MsoToc2><a href="#_Toc228751"><span style='color:#F31D19'>Section
61.1: Formatting and Spelling of Keywords and Names</span><span
style='color:black;text-decoration:none'>......................................................................................................... </span><span style='color:black;text-decoration:none'>150</span></a></p>

<p class=MsoToc2><a href="#_Toc228752"><span style='color:#F31D19'>Section
61.2: Indenting</span><span style='color:black;text-decoration:none'>.............................................................................................................................................................................. </span><span style='color:black;text-decoration:none'>150</span></a></p>

<p class=MsoToc2><a href="#_Toc228753"><span style='color:#F31D19'>Section
61.3: SELECT *</span><span style='color:black;text-decoration:none'>................................................................................................................................................................................ </span><span style='color:black;text-decoration:none'>151</span></a></p>

<p class=MsoToc2><a href="#_Toc228754"><span style='color:#F31D19'>Section
61.4: Joins</span><span style='color:black;text-decoration:none'>....................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>152</span></a></p>

<p class=MsoToc1><a href="#_Toc228755"><b><span style='font-size:12.0pt;
line-height:110%;color:#F31D19'>Chapter 62: SQL Injection</span></b><span
style='color:black;text-decoration:none'>......................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>153</span></a></p>

<p class=MsoToc2><a href="#_Toc228756"><span style='color:#F31D19'>Section
62.1: SQL injection sample</span><span style='color:black;text-decoration:none'>.......................................................................................................................................................... </span><span style='color:black;text-decoration:none'>153</span></a></p>

<p class=MsoToc2><a href="#_Toc228757"><span style='color:#F31D19'>Section
62.2: simple injection sample</span><span style='color:black;text-decoration:
none'>..................................................................................................................................................... </span><span style='color:black;text-decoration:none'>154</span></a></p>

<p class=MsoToc1><a href="#_Toc228758"><b><span style='font-size:12.0pt;
line-height:110%;color:#F31D19'>Credits</span></b><span style='color:black;
text-decoration:none'>................................................................................................................................................................................................................. </span><span style='color:black;text-decoration:none'>155</span></a></p>

<p class=MsoToc1><a href="#_Toc228759"><b><span style='font-size:12.0pt;
line-height:110%;color:#F31D19'>You may also like</span></b><span
style='color:black;text-decoration:none'>........................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>159</span></a></p>

<p class=MsoNormal>&nbsp;</p>

</div>

<span style='font-size:10.0pt;line-height:110%;font-family:"Calibri",sans-serif;
color:black'><br clear=all style='page-break-before:always'>
</span>

<div class=WordSection2>

<h1 style='margin-top:0in;margin-right:0in;margin-bottom:105.15pt;margin-left:
-.25pt'><a name="_Toc228481">About</a></h1>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:116.3pt;
margin-bottom:29.9pt;margin-left:116.5pt;text-align:center;text-indent:0in;
line-height:123%'><span style='font-size:11.0pt;line-height:123%'>Please feel
free to share this PDF with anyone for free, latest version of this book can be
downloaded from: </span><a href="https://goalkicker.com/SQLBook"><span
style='font-size:11.0pt;line-height:123%;color:#F31D19'>https://goalkicker.com/SQLBook</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.6pt;
margin-left:108.6pt'>This <i>SQL Notes for Professionals</i> book is compiled
from <a href="https://archive.org/details/documentation-dump.7z"><span
style='color:#F31D19'>Stack Overflow</span></a></p>

<p class=MsoNormal align=right style='margin-top:0in;margin-right:82.15pt;
margin-bottom:1.9pt;margin-left:.5pt;text-align:right;text-indent:-.5pt;
line-height:107%'><a href="https://archive.org/details/documentation-dump.7z"><span
style='color:#F31D19'>Documentation</span></a>, the content is written by the
beautiful people at Stack Overflow.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:80.1pt;
margin-bottom:11.2pt;margin-left:80.8pt;text-align:center;text-indent:-.5pt;
line-height:123%'>Text content is released under Creative Commons BY-SA, see
credits at the end of this book whom contributed to the various chapters.
Images may be copyright of their respective owners unless otherwise specified</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:80.1pt;
margin-bottom:11.2pt;margin-left:80.8pt;text-align:center;text-indent:-.5pt;
line-height:123%'><span style='position:relative;z-index:-1895824384'><span
style='left:0px;position:absolute;left:87px;top:-274px;width:545px;height:476px'><img
width=545 height=476 src="SQL%20Notes%20for%20Professionals_files/image002.gif"></span></span>This
is an unofficial free book created for educational purposes and is not
affiliated with official SQL group(s) or company(s) nor Stack Overflow. All
trademarks and registered trademarks are the property of their respective
company owners</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:80.1pt;
margin-bottom:11.2pt;margin-left:80.8pt;text-align:center;text-indent:-.5pt;
line-height:123%'>The information presented in this book is not guaranteed to
be correct nor accurate, use at your own risk</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:131.05pt'>Please send feedback and corrections to <u><span
style='color:#F31D19'>web@petercv.com</span></u></p>

<h1 style='margin-left:-.25pt'><a name="_Toc228482">Chapter 1: Getting started
with SQL</a></h1>

<p class=MsoNormal style='margin-bottom:.95pt;text-indent:0in;line-height:111%'><b>Version
Short Name Standard Release
Date</b></p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'>1986 SQL-86 ANSI
X3.135-1986, ISO 9075:1987 1986-01-01</p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'>1989 SQL-89 ANSI
X3.135-1989, ISO/IEC 9075:1989 1989-01-01</p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'><a
href="https://en.wikipedia.org/wiki/SQL-92"><span style='color:#F31D19'>1992</span></a><u><span
style='color:#F31D19'> </span></u>SQL-92 ISO/IEC
9075:1992 1992-01-01</p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'><a
href="https://en.wikipedia.org/wiki/SQL:1999"><span style='color:#F31D19'>1999</span></a><u><span
style='color:#F31D19'> </span></u>SQL:1999 ISO/IEC
9075:1999 1999-12-16</p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'><a
href="https://en.wikipedia.org/wiki/SQL:2003"><span style='color:#F31D19'>2003</span></a><u><span
style='color:#F31D19'> </span></u>SQL:2003 ISO/IEC
9075:2003 2003-12-15</p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'><a
href="https://en.wikipedia.org/wiki/SQL:2006"><span style='color:#F31D19'>2006</span></a><u><span
style='color:#F31D19'> </span></u>SQL:2006 ISO/IEC
9075:2006 2006-06-01</p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'><a
href="https://en.wikipedia.org/wiki/SQL:2008"><span style='color:#F31D19'>2008</span></a><u><span
style='color:#F31D19'> </span></u>SQL:2008 ISO/IEC
9075:2008 2008-07-15</p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'><a
href="https://en.wikipedia.org/wiki/SQL:2011"><span style='color:#F31D19'>2011</span></a><u><span
style='color:#F31D19'> </span></u>SQL:2011 ISO/IEC
9075:2011 2011-12-15</p>

<p class=MsoNormal style='text-indent:0in;line-height:155%'><a
href="https://en.wikipedia.org/wiki/SQL:2016"><span style='color:#F31D19'>2016</span></a><u><span
style='color:#F31D19'> </span></u>SQL:2016 ISO/IEC
9075:2016 2016-12-01</p>

<h2 style='margin-top:0in;margin-right:144.05pt;margin-bottom:.2pt;margin-left:
.25pt;text-indent:.5pt;line-height:155%'><a name="_Toc228483">Section 1.1:
Overview</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.45pt;
margin-left:.25pt'>Structured Query Language (SQL) is a special-purpose
programming language designed for managing data held in a Relational Database
Management System (RDBMS). SQL-like languages can also be used in Relational
Data Stream Management Systems (RDSMS), or in &quot;not-only SQL&quot; (NoSQL)
databases.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:13.3pt;
margin-left:.25pt'>SQL comprises of 3 major sub-languages:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:2.1pt;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:110%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Data
Definition Language (DDL): to create and modify the structure of the database;</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.8pt;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:110%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Data
Manipulation Language (DML): to perform Read, Insert, Update and Delete
operations on the data of the database;</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:110%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Data
Control Language (DCL): to control the access of the data stored in the
database.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.05pt;
margin-left:-.25pt;text-indent:-.5pt;line-height:107%'><a
href="https://en.wikipedia.org/wiki/SQL"><span style='color:#F31D19'>SQL
article on Wikipedia</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.7pt;
margin-left:.25pt'>The core DML operations are Create, Read, Update and Delete
(CRUD for short) which are performed by the statements <span style='font-size:
9.0pt;line-height:110%;color:blue;background:#FAFAFA'>INSERT</span>, <span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>SELECT</span>,
<span style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>UPDATE</span>
and <span style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>DELETE</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.45pt;
margin-left:.25pt'>There is also a (recently added) <span style='font-size:
9.0pt;line-height:110%;color:blue;background:#FAFAFA'>MERGE</span> statement
which can perform all 3 write operations (INSERT, UPDATE, DELETE).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.05pt;
margin-left:-.25pt;text-indent:-.5pt;line-height:107%'><a
href="https://en.wikipedia.org/wiki/Create,_read,_update_and_delete"><span
style='color:#F31D19'>CRUD article on Wikipedia</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.6pt;
margin-left:.25pt'>Many SQL databases are implemented as client/server systems;
the term &quot;SQL server&quot; describes such a database.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.6pt;
margin-left:.25pt'>At the same time, Microsoft makes a database that is named
&quot;SQL Server&quot;. While that database speaks a dialect of</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>SQL, information specific to that database is not on topic
in this tag but belongs into the SQL Server documentation.</p>

<h1 style='margin-left:-.25pt'><a name="_Toc228484">Chapter 2: Identifier</a></h1>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>This topic is about identifiers, i.e. syntax rules for names
of tables, columns, and other database objects.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:15.7pt;margin-bottom:
.2pt;margin-left:.25pt;text-align:justify;text-justify:inter-ideograph;
line-height:135%'>Where appropriate, the examples should cover variations used
by different SQL implementations, or identify the SQL implementation of the
example.</p>

<h2 style='margin-top:0in;margin-right:15.7pt;margin-bottom:.2pt;margin-left:
.25pt;text-align:justify;text-justify:inter-ideograph;text-indent:.5pt;
line-height:135%'><a name="_Toc228485">Section 2.1: Unquoted identifiers</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.9pt;
margin-left:.25pt'>Unquoted identifiers can use letters (<span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>a</span>-<span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>z</span>), digits (<span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>0</span>-<span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>9</span>), and
underscore (<span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>_</span>),
and must start with a letter.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.55pt;
margin-left:.25pt'>Depending on SQL implementation, and/or database settings,
other characters may be allowed, some even as the first character, e.g.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.7pt;
margin-left:20.9pt'><img width=5 height=65
src="SQL%20Notes%20for%20Professionals_files/image003.gif" align=left
hspace=12>MS SQL: <span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>@</span>, <span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>$</span>, <span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>#</span>, and other Unicode letters <a
href="https://docs.microsoft.com/en-us/sql/relational-databases/databases/database-identifiers"><i><span
style='color:black;text-decoration:none'>(</span></i></a><a
href="https://docs.microsoft.com/en-us/sql/relational-databases/databases/database-identifiers"><i><span
style='color:#F31D19'>source</span></i></a><i>)</i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.7pt;
margin-left:20.9pt'>MySQL: <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>$</span> <i>(</i><a
href="https://dev.mysql.com/doc/refman/5.7/en/identifiers.html"><i><span
style='color:#F31D19'>source</span></i></a><i>)</i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:145.75pt;margin-bottom:
12.5pt;margin-left:20.9pt'>Oracle: <span style='font-size:9.0pt;line-height:
110%;background:#FAFAFA'>$</span>, <span style='font-size:9.0pt;line-height:
110%;background:#FAFAFA'>#</span>, and other letters from database character
set <i>(</i><a
href="https://docs.oracle.com/database/121/SQLRF/sql_elements008.htm#SQLRF00223"><i><span
style='color:#F31D19'>source</span></i></a><i>) </i>PostgreSQL: <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>$</span>, and other
Unicode letters <i>(</i><a
href="https://www.postgresql.org/docs/current/static/sql-syntax-lexical.html"><i><span
style='color:#F31D19'>source</span></i></a><i>)</i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>Unquoted identifiers are case-insensitive. How this is
handled depends greatly on SQL implementation:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:9.1pt;
margin-left:20.9pt'><img width=5 height=125
src="SQL%20Notes%20for%20Professionals_files/image004.gif" align=left
hspace=12>MS SQL: Case-preserving, sensitivity defined by database character
set, so can be case-sensitive.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:9.1pt;
margin-left:20.9pt'>MySQL: Case-preserving, sensitivity depends on database
setting and underlying file system.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:9.1pt;
margin-left:20.9pt'>Oracle: Converted to uppercase, then handled like quoted
identifier.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:9.1pt;
margin-left:20.9pt'>PostgreSQL: Converted to lowercase, then handled like
quoted identifier.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:20.9pt'>SQLite: Case-preserving; case insensitivity only for ASCII
characters.</p>

<h1 style='margin-left:-.25pt'><a name="_Toc228486">Chapter 3: Data Types</a></h1>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228487">Section 3.1: DECIMAL and NUMERIC</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.9pt;
margin-left:.25pt'>Fixed precision and scale decimal numbers. <span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>DECIMAL</span>
and <span style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>NUMERIC</span>
are functionally equivalent.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Syntax:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src="SQL%20Notes%20for%20Professionals_files/image005.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:14.45pt;
margin-left:.25pt'>Examples:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%;color:blue'>SELECT</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:blue'>CAST</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>(</span><span
style='font-size:9.0pt;line-height:110%'>123 </span><span style='font-size:
9.0pt;line-height:110%;color:blue'>AS</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:blue'>DECIMAL</span><span style='font-size:9.0pt;line-height:110%;
color:gray'>(</span><span style='font-size:9.0pt;line-height:110%'>5</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>,</span><span
style='font-size:9.0pt;line-height:110%'>2</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>))</span><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:green'>--returns
123.00</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:23.0pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='position:relative;z-index:
-1895821312'><span style='left:0px;position:absolute;left:0px;top:-25px;
width:718px;height:43px'><img width=718 height=43
src="SQL%20Notes%20for%20Professionals_files/image006.gif"></span></span><span
style='font-size:9.0pt;line-height:110%;color:blue'>SELECT</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>CAST</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>(</span><span style='font-size:9.0pt;line-height:
110%'>12345.12 </span><span style='font-size:9.0pt;line-height:110%;color:blue'>AS</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>NUMERIC</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>(</span><span style='font-size:9.0pt;line-height:
110%'>10</span><span style='font-size:9.0pt;line-height:110%;color:gray'>,</span><span
style='font-size:9.0pt;line-height:110%'>5</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>))</span><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:green'>--returns
12345.12000</span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228488">Section 3.2: FLOAT and REAL</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Approximate-number data types for use with floating point
numeric data.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src="SQL%20Notes%20for%20Professionals_files/image007.gif"></span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228489">Section 3.3: Integers</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>Exact-number data types that use integer data.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:79.8pt;margin-bottom:
.2pt;margin-left:.25pt'><b>Data type Range Storage </b>bigint -2^63
(-9,223,372,036,854,775,808) to 2^63-1 (9,223,372,036,854,775,807) 8 Bytes</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=569
 style='width:426.8pt;margin-left:1.0pt;border-collapse:collapse'>
 <tr style='height:13.65pt'>
  <td width=68 valign=top style='width:50.7pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>int</p>
  </td>
  <td width=456 valign=top style='width:342.35pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>-2^31
  (-2,147,483,648) to 2^31-1 (2,147,483,647)</p>
  </td>
  <td width=45 valign=top style='width:33.75pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>4 Bytes</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=68 valign=top style='width:50.7pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>smallint</p>
  </td>
  <td width=456 valign=top style='width:342.35pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>-2^15
  (-32,768) to 2^15-1 (32,767)</p>
  </td>
  <td width=45 valign=top style='width:33.75pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>2 Bytes</p>
  </td>
 </tr>
 <tr style='height:13.65pt'>
  <td width=68 valign=top style='width:50.7pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>tinyint</p>
  </td>
  <td width=456 valign=top style='width:342.35pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>0
  to 255</p>
  </td>
  <td width=45 valign=top style='width:33.75pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>1 Byte</p>
  </td>
 </tr>
</table>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228490">Section 3.4: MONEY and SMALLMONEY</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>Data types that represent monetary or currency values.</p>

<p class=MsoNormal style='margin-bottom:.95pt;text-indent:0in;line-height:111%'><b>Data
type Range Storage</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:180.4pt;margin-bottom:
1.3pt;margin-left:.25pt;text-align:justify;text-justify:inter-ideograph;
line-height:135%'>money -922,337,203,685,477.5808 to 922,337,203,685,477.5807 8
bytes smallmoney -214,748.3648 to 214,748.3647 4 bytes</p>

<h2 style='margin-top:0in;margin-right:180.4pt;margin-bottom:1.3pt;margin-left:
.25pt;text-align:justify;text-justify:inter-ideograph;text-indent:.5pt;
line-height:135%'><a name="_Toc228491">Section 3.5: BINARY and VARBINARY</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>Binary data types of either fixed length or variable length.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Syntax:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:15.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src="SQL%20Notes%20for%20Professionals_files/image008.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'><span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>n_bytes</span> can be any number from 1 to 8000 bytes. <span
style='font-size:9.0pt;line-height:110%;color:fuchsia;background:#FAFAFA'>max</span>
indicates that the maximum storage space is 2^31-1.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:14.45pt;
margin-left:.25pt'>Examples:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='position:relative;z-index:
-1895820288'><span style='left:0px;position:absolute;left:0px;top:-9px;
width:718px;height:43px'><img width=718 height=43
src="SQL%20Notes%20for%20Professionals_files/image006.gif"></span></span><span
style='font-size:9.0pt;line-height:110%;color:blue'>SELECT</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>CAST</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>(</span><span style='font-size:9.0pt;line-height:
110%'>12345 </span><span style='font-size:9.0pt;line-height:110%;color:blue'>AS</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>BINARY</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>(</span><span style='font-size:9.0pt;line-height:
110%'>10</span><span style='font-size:9.0pt;line-height:110%;color:gray'>))</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:green'>-- 0x00000000000000003039</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:23.0pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%;color:blue'>SELECT</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:blue'>CAST</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>(</span><span
style='font-size:9.0pt;line-height:110%'>12345 </span><span style='font-size:
9.0pt;line-height:110%;color:blue'>AS</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:blue'>VARBINARY</span><span style='font-size:9.0pt;line-height:110%;
color:gray'>(</span><span style='font-size:9.0pt;line-height:110%'>10</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>))</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:green'>-- 0x00003039</span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228492">Section 3.6: CHAR and VARCHAR</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>String data types of either fixed length or variable length.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Syntax:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src="SQL%20Notes%20for%20Professionals_files/image009.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:14.45pt;
margin-left:.25pt'>Examples:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%;color:blue'>SELECT</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:blue'>CAST</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>(</span><span
style='font-size:9.0pt;line-height:110%;color:red'>'ABC'</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>AS</span><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:blue'>CHAR</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>(</span><span
style='font-size:9.0pt;line-height:110%'>10</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>))</span><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:green'>--
'ABC ' (padded with spaces on the right)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%;color:blue'>SELECT</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:blue'>CAST</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>(</span><span
style='font-size:9.0pt;line-height:110%;color:red'>'ABC'</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>AS</span><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:blue'>VARCHAR</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>(</span><span
style='font-size:9.0pt;line-height:110%'>10</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>))</span><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:green'>--
'ABC' (no padding due to variable character)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:23.0pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='position:relative;z-index:
-1895819264'><span style='left:0px;position:absolute;left:0px;top:-41px;
width:718px;height:59px'><img width=718 height=59
src="SQL%20Notes%20for%20Professionals_files/image010.gif"></span></span><span
style='font-size:9.0pt;line-height:110%;color:blue'>SELECT</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>CAST</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>(</span><span style='font-size:9.0pt;line-height:
110%;color:red'>'ABCDEFGHIJKLMNOPQRSTUVWXYZ'</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:blue'>AS</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:blue'>CHAR</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>(</span><span
style='font-size:9.0pt;line-height:110%'>10</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>))</span><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:green'>--
'ABCDEFGHIJ' (truncated to 10 characters)</span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228493">Section 3.7: NCHAR and NVARCHAR</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>UNICODE string data types of either fixed length or variable
length.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Syntax:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:15.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src="SQL%20Notes%20for%20Professionals_files/image011.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:183.9pt;margin-bottom:
.2pt;margin-left:.25pt;line-height:145%'>Use <span style='font-size:9.0pt;
line-height:145%;color:fuchsia;background:#FAFAFA'>MAX</span> for very long
strings that may exceed 8000 characters.</p>

<h2 style='margin-top:0in;margin-right:183.9pt;margin-bottom:.2pt;margin-left:
.25pt;text-indent:.5pt;line-height:145%'><a name="_Toc228494">Section 3.8:
UNIQUEIDENTIFIER</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:14.45pt;
margin-left:.25pt'>A 16-byte GUID / UUID.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%;color:blue'>DECLARE</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:#CC3333'>@GUID</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>UNIQUEIDENTIFIER</span><span style='font-size:
9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:gray'>=</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:fuchsia'>NEWID</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>();</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%;color:blue'>SELECT</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:#CC3333'>@GUID</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:green'>-- 'E28B3BD9-9174-41A9-8508-899A78A33540'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:26.95pt;margin-bottom:
.1pt;margin-left:3.5pt;text-indent:-.5pt'><span style='position:relative;
z-index:-1895818240'><span style='left:0px;position:absolute;left:0px;
top:-41px;width:718px;height:108px'><img width=718 height=108
src="SQL%20Notes%20for%20Professionals_files/image012.gif"></span></span><span
style='font-size:9.0pt;line-height:110%;color:blue'>DECLARE</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#CC3333'>@bad_GUID_string</span><span style='font-size:
9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:blue'>VARCHAR</span><span style='font-size:9.0pt;line-height:110%;
color:gray'>(</span><span style='font-size:9.0pt;line-height:110%'>100</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>)</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:gray'>=</span><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:red'>'E28B3BD9-9174-41A9-8508-899A78A33540_foobarbaz'
</span><span style='font-size:9.0pt;line-height:110%;color:blue'>SELECT</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:#CC3333'>@bad_GUID_string</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>,</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:green'>--
'E28B3BD9-9174-41A9-8508-899A78A33540_foobarbaz'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:fuchsia'>CONVERT</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>(</span><span
style='font-size:9.0pt;line-height:110%;color:blue'>UNIQUEIDENTIFIER</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>,</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#CC3333'>@bad_GUID_string</span><span style='font-size:
9.0pt;line-height:110%;color:gray'>)</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:green'>-- 'E28B3BD9-9174-41A9-8508-899A78A33540'</span></p>

<h1 style='margin-left:-.25pt'><a name="_Toc228495">Chapter 4: NULL</a></h1>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.35pt;
margin-left:.25pt'><span style='font-size:9.0pt;line-height:110%;color:#333399;
background:#FAFAFA'>NULL</span> in SQL, as well as programming in general,
means literally &quot;nothing&quot;. In SQL, it is easier to understand as
&quot;the absence of any value&quot;.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.6pt;
margin-left:.25pt'>It is important to distinguish it from seemingly empty
values, such as the empty string <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>''</span> or the number <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>0</span>, neither of which are actually <span
style='font-size:9.0pt;line-height:110%;color:#333399;background:#FAFAFA'>NULL</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:6.3pt;margin-bottom:.2pt;
margin-left:.25pt;text-align:justify;text-justify:inter-ideograph;line-height:
135%'>It is also important to be careful not to enclose <span style='font-size:
9.0pt;line-height:135%;color:#333399;background:#FAFAFA'>NULL</span> in quotes,
like <span style='font-size:9.0pt;line-height:135%;color:red;background:#FAFAFA'>'NULL'</span>,
which is allowed in columns that accept text, but is not <span
style='font-size:9.0pt;line-height:135%;color:#333399;background:#FAFAFA'>NULL</span>
and can cause errors and incorrect data sets.</p>

<h2 style='margin-top:0in;margin-right:6.3pt;margin-bottom:.2pt;margin-left:
.25pt;text-align:justify;text-justify:inter-ideograph;text-indent:.5pt;
line-height:135%'><a name="_Toc228496">Section 4.1: Filtering for NULL in
queries</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.3pt;
margin-left:.25pt'>The syntax for filtering for <span style='font-size:9.0pt;
line-height:110%;color:#333399;background:#FAFAFA'>NULL</span> (i.e. the
absence of a value) in <span style='font-size:9.0pt;line-height:110%;
color:blue;background:#FAFAFA'>WHERE</span> blocks is slightly different than
filtering for specific values.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:15.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src="SQL%20Notes%20for%20Professionals_files/image013.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=107 style='width:80.1pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=36 valign=top style='width:27.0pt;background:#FAFAFA;padding:1.25pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'></span><span style='font-size:9.0pt;line-height:
  107%;color:#333399'>NULL</span></p>
  </td>
  <td width=35 valign=top style='width:26.1pt;padding:1.25pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>or <span style='font-size:
  9.0pt;line-height:107%;color:#666666;background:#FAFAFA'>&lt;</span><b><span
  style='font-size:9.0pt;line-height:107%;background:#FAFAFA'>&gt;</span></b></p>
  </td>
  <td width=36 valign=top style='width:27.0pt;background:#FAFAFA;padding:1.25pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>NULL</span></p>
  </td>
 </tr>
</table>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=50 style='width:37.8pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=50 valign=top style='width:37.8pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:gray'>!=</span><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:#333399'>NULL</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:8.95pt;margin-bottom:
12.75pt;margin-left:38.05pt;text-indent:-37.8pt'>Note that because <span
style='font-size:9.0pt;line-height:110%;color:#333399;background:#FAFAFA'>NULL</span>
is not equal to anything, not even to itself, using equality operators <span
style='font-size:9.0pt;line-height:110%;color:gray;background:#FAFAFA'>=</span>
(or ) will always yield the truth value of <span style='font-size:9.0pt;
line-height:110%;color:blue;background:#FAFAFA'>UNKNOWN</span> which will be
rejected by <span style='font-size:9.0pt;line-height:110%;color:blue;
background:#FAFAFA'>WHERE</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt;line-height:146%'><span style='font-size:9.0pt;line-height:
146%;color:blue;background:#FAFAFA'>WHERE</span> filters all rows that the
condition is <span style='font-size:9.0pt;line-height:146%;color:blue;
background:#FAFAFA'>FALSE</span> or <span style='font-size:9.0pt;line-height:
146%;background:#FAFAFA'>UKNOWN</span> and keeps only rows that the condition
is <span style='font-size:9.0pt;line-height:146%;color:blue;background:#FAFAFA'>TRUE</span>.</p>

<h2 style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;margin-left:
.25pt;text-indent:.5pt;line-height:146%'><a name="_Toc228497">Section 4.2:
Nullable columns in tables</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>When creating tables it is possible to declare a column as
nullable or non-nullable.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=92
src="SQL%20Notes%20for%20Professionals_files/image014.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=58 style='width:.6in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:#333399'>NOT</span><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:#333399'>NULL</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:35.5pt;margin-bottom:
12.5pt;margin-left:.25pt'>By default every column (except those in primary key
constraint) is nullable unless we explicitly set constraint.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Attempting to assign <span style='font-size:9.0pt;
line-height:110%;color:#333399;background:#FAFAFA'>NULL</span> to a
non-nullable column will result in an error.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=109
src="SQL%20Notes%20for%20Professionals_files/image015.gif"></span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228498">Section 4.3: Updating fields to NULL</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Setting a field to <span style='font-size:9.0pt;line-height:
110%;color:#333399;background:#FAFAFA'>NULL</span> works exactly like with any
other value:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:0in;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="SQL%20Notes%20for%20Professionals_files/image016.gif"></span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228499">Section 4.4: Inserting rows with NULL fields</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>For example inserting an employee with no phone number and
no manager into the Employees example table:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:0in;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=76
src="SQL%20Notes%20for%20Professionals_files/image017.gif"></span><br
clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc228500">Chapter 5: Example
Databases and Tables</a></h1>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228501">Section 5.1: Auto Shop Database</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:19.35pt;margin-bottom:
20.9pt;margin-left:.25pt;line-height:169%'>In the following example - Database
for an auto shop business, we have a list of departments, employees, customers
and customer cars. We are using foreign keys to create relationships between
the various tables. Live example: <a href="http://sqlfiddle.com/#!9/faf2f/1"><span
style='color:#F31D19'>SQL fiddle</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.05pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Relationships between
tables</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.6pt;
margin-left:20.9pt'><img width=5 height=45
src="SQL%20Notes%20for%20Professionals_files/image018.gif" align=left
hspace=12>Each Department may have 0 or more Employees</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.6pt;
margin-left:20.9pt'>Each Employee may have 0 or 1 Manager</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.35in;
margin-left:20.9pt'>Each Customer may have 0 or more Cars</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Departments</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:490.1pt;margin-bottom:
3.5pt;margin-left:.25pt;text-indent:0in;line-height:111%'><b>Id Name </b>1 HR</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:11.9pt;text-indent:-11.65pt'><span style='line-height:110%'>2<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Sales</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:15.05pt;
margin-left:11.9pt;text-indent:-11.65pt'><span style='line-height:110%'>3<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Tech</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>SQL statements to create the table:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:19.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=223
src="SQL%20Notes%20for%20Professionals_files/image019.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Employees</b></p>

<p class=MsoNormal style='margin-bottom:.95pt;text-indent:0in;line-height:111%'><b>Id
FName LName PhoneNumber ManagerId DepartmentId Salary
HireDate</b></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=525
 style='width:394.1pt;margin-left:1.0pt;border-collapse:collapse'>
 <tr style='height:13.65pt'>
  <td width=240 valign=top style='width:180.35pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>1
  James Smith 1234567890</p>
  </td>
  <td width=74 valign=top style='width:55.8pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>NULL</p>
  </td>
  <td width=141 valign=top style='width:105.7pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>1 1000</p>
  </td>
  <td width=70 valign=top style='width:52.2pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>01-01-2002</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=240 valign=top style='width:180.35pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>2
  John Johnson 2468101214</p>
  </td>
  <td width=74 valign=top style='width:55.8pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>1</p>
  </td>
  <td width=141 valign=top style='width:105.7pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>1 400</p>
  </td>
  <td width=70 valign=top style='width:52.2pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>23-03-2005</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=240 valign=top style='width:180.35pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>3
  Michael Williams 1357911131</p>
  </td>
  <td width=74 valign=top style='width:55.8pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>1</p>
  </td>
  <td width=141 valign=top style='width:105.7pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>2 600</p>
  </td>
  <td width=70 valign=top style='width:52.2pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>12-05-2009</p>
  </td>
 </tr>
 <tr style='height:13.65pt'>
  <td width=240 valign=top style='width:180.35pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>4
  Johnathon Smith 1212121212</p>
  </td>
  <td width=74 valign=top style='width:55.8pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>2</p>
  </td>
  <td width=141 valign=top style='width:105.7pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>1 500</p>
  </td>
  <td width=70 valign=top style='width:52.2pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>24-07-2016</p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>SQL statements to create the table:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:0in;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=123
src="SQL%20Notes%20for%20Professionals_files/image020.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.25pt;margin-bottom:
19.0pt;margin-left:-.45pt;text-indent:0in;line-height:107%'><img border=0
width=719 height=252 id="Picture 218684"
src="SQL%20Notes%20for%20Professionals_files/image021.gif"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Customers</b></p>

<p class=MsoNormal style='margin-bottom:.95pt;text-indent:0in;line-height:111%'><b>Id
FName LName Email PhoneNumber
PreferredContact</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:11.9pt;text-indent:-11.65pt'><span style='line-height:110%'>1<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>William
Jones william.jones@example.com 3347927472 PHONE</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:11.9pt;text-indent:-11.65pt'><span style='line-height:110%'>2<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>David Miller dmiller@example.net 2137921892 EMAIL</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:15.05pt;
margin-left:11.9pt;text-indent:-11.65pt'><span style='line-height:110%'>3<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Richard
Davis richard0123@example.com NULL EMAIL</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>SQL statements to create the table:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:19.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=289
src="SQL%20Notes%20for%20Professionals_files/image022.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Cars</b></p>

<p class=MsoNormal style='margin-bottom:.95pt;text-indent:0in;line-height:111%'><b>Id
CustomerId EmployeeId Model Status Total
Cost</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:.25pt'><span style='line-height:110%'>1<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>1 2 Ford F-150 READY 230</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:.25pt'><span style='line-height:110%'>2<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>1 2 Ford F-150 READY 200</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:11.2pt;
margin-left:.25pt;line-height:141%'><span style='line-height:141%'>3<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>2 1 Ford Mustang WAITING 100 4 3 3 Toyota Prius WORKING 1254</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>SQL statements to create the table:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:0in;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=113
src="SQL%20Notes%20for%20Professionals_files/image023.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=235
src="SQL%20Notes%20for%20Professionals_files/image024.gif"></span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228502">Section 5.2: Library Database</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>In this example database for a library, we have <i>Authors</i>,
<i>Books</i> and <i>BooksAuthors</i> tables.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:13.05pt;
margin-left:.25pt'>Live example: <a href="http://sqlfiddle.com/#!9/7c06f/1"><span
style='color:#F31D19'>SQL fiddle</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:27.7pt;
margin-left:.25pt'><i>Authors</i> and <i>Books</i> are known as <b>base tables</b>,
since they contain column definition and data for the actual entities in the
relational model. <i>BooksAuthors</i> is known as the <b>relationship table</b>,
since this table defines the relationship between the <i>Books</i> and <i>Authors</i>
table.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.05pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Relationships between
tables</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.6pt;
margin-left:20.9pt'><img width=5 height=25
src="SQL%20Notes%20for%20Professionals_files/image025.gif" align=left
hspace=12>Each author can have 1 or more books</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.35in;
margin-left:20.9pt'>Each book can have 1 or more authors</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Authors</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.05pt;
margin-left:-.25pt;text-indent:-.5pt;line-height:107%'>(<a
href="http://sqlfiddle.com/#!9/7c06f/2"><i><span style='color:#F31D19'>view
table</span></i></a>)</p>

<p class=MsoNormal style='margin-bottom:.95pt;text-indent:0in;line-height:111%'><b>Id
Name Country</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:11.9pt;text-indent:-11.65pt'><span style='line-height:110%'>1<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>J.D.
Salinger USA</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:11.9pt;text-indent:-11.65pt'><span style='line-height:110%'>2<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>F.
Scott. Fitzgerald USA</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=163
 style='width:122.35pt;margin-left:1.0pt;border-collapse:collapse'>
 <tr style='height:13.65pt'>
  <td width=132 valign=top style='width:99.2pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>3
  Jane Austen</p>
  </td>
  <td width=31 valign=top style='width:23.15pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>UK</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=132 valign=top style='width:99.2pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>4
  Scott Hanselman</p>
  </td>
  <td width=31 valign=top style='width:23.15pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>USA</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=132 valign=top style='width:99.2pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>5
  Jason N. Gaylord</p>
  </td>
  <td width=31 valign=top style='width:23.15pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>USA</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=132 valign=top style='width:99.2pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>6
  Pranav Rastogi</p>
  </td>
  <td width=31 valign=top style='width:23.15pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>India</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=132 valign=top style='width:99.2pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>7
  Todd Miranda</p>
  </td>
  <td width=31 valign=top style='width:23.15pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>USA</p>
  </td>
 </tr>
 <tr style='height:13.65pt'>
  <td width=132 valign=top style='width:99.2pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>8
  Christian Wenz</p>
  </td>
  <td width=31 valign=top style='width:23.15pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>USA</p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>SQL to create the table:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:0in;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=149
src="SQL%20Notes%20for%20Professionals_files/image026.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:19.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=186
src="SQL%20Notes%20for%20Professionals_files/image027.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Books</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.05pt;
margin-left:-.25pt;text-indent:-.5pt;line-height:107%'>(<a
href="http://sqlfiddle.com/#!9/7c06f/3"><i><span style='color:#F31D19'>view
table</span></i></a>)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Id Title</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:.25pt'><span style='line-height:110%'>1<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>The Catcher in the Rye</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:.25pt'><span style='line-height:110%'>2<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Nine Stories</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:.25pt'><span style='line-height:110%'>3<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Franny and Zooey</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:.25pt'><span style='line-height:110%'>4<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>The Great Gatsby</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt;line-height:141%'><span style='line-height:141%'>5<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Tender id the Night 6 Pride and Prejudice</p>

<p class=MsoNormal style='margin-top:0in;margin-right:329.25pt;margin-bottom:
.2pt;margin-left:.25pt;line-height:233%'>7 Professional ASP.NET 4.5 in C# and
VB SQL to create the table:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:19.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=289
src="SQL%20Notes%20for%20Professionals_files/image028.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>BooksAuthors</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.05pt;
margin-left:-.25pt;text-indent:-.5pt;line-height:107%'>(<a
href="http://sqlfiddle.com/#!9/7c06f/4"><i><span style='color:#F31D19'>view
table</span></i></a>)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>BookId AuthorId</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:37.2pt;text-indent:-36.95pt'><span style='line-height:110%'>1<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>1</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:37.2pt;text-indent:-36.95pt'><span style='line-height:110%'>2<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>1</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:37.2pt;text-indent:-36.95pt'><span style='line-height:110%'>3<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>1</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:37.2pt;text-indent:-36.95pt'><span style='line-height:110%'>4<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>2</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:37.2pt;text-indent:-36.95pt'><span style='line-height:110%'>5<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>2</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:37.2pt;text-indent:-36.95pt'><span style='line-height:110%'>6<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>3</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:37.2pt;text-indent:-36.95pt'><span style='line-height:110%'>7<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>4</p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'>7 5</p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'>7 6</p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'>7 7</p>

<p class=MsoNormal style='margin-bottom:15.05pt;text-indent:0in'>7 8</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>SQL to create the table:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:19.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=371
src="SQL%20Notes%20for%20Professionals_files/image029.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Examples</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>View all authors (<a href="http://sqlfiddle.com/#!9/7c06f/2"><span
style='color:#F31D19'>view live example</span></a>):</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image030.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>View all book titles (<a
href="http://sqlfiddle.com/#!9/7c06f/3"><span style='color:#F31D19'>view live
example</span></a>):</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image031.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>View all books and their authors (<a
href="http://sqlfiddle.com/#!9/7c06f/5"><span style='color:#F31D19'>view live
example</span></a>):</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:0in;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=158
src="SQL%20Notes%20for%20Professionals_files/image032.gif"></span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228503">Section 5.3: Countries Table</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.4pt;
margin-left:.25pt'>In this example, we have a <b>Countries</b> table. A table
for countries has many uses, especially in Financial applications involving
currencies and exchange rates.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>Live example: <a href="http://sqlfiddle.com/#!9/14cfc6"><span
style='color:#F31D19'>SQL fiddle</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:27.8pt;
margin-left:.25pt'>Some Market data software applications like Bloomberg and
Reuters require you to give their API either a 2 or 3 character country code
along with the currency code. Hence this example table has both the 2-character
<span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>ISO</span>
code column and the 3 character <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>ISO3</span> code columns.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Countries</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:1.95pt;
margin-left:-.25pt;text-indent:-.5pt;line-height:107%'>(<a
href="http://sqlfiddle.com/#!9/14cfc6/1"><i><span style='color:#F31D19'>view
table</span></i></a>)</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=526
 style='width:394.7pt;margin-left:1.0pt;border-collapse:collapse'>
 <tr style='height:14.0pt'>
  <td width=526 colspan=4 valign=top style='width:394.7pt;padding:0in 0in 0in 0in;
  height:14.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><b>Id
  ISO ISO3 ISONumeric CountryName Capital ContinentCode
  CurrencyCode</b></p>
  </td>
 </tr>
 <tr style='height:13.65pt'>
  <td width=156 valign=top style='width:116.85pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>1
  AU AUS 36</p>
  </td>
  <td width=96 valign=top style='width:72.15pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Australia</p>
  </td>
  <td width=181 valign=top style='width:135.55pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Canberra OC</p>
  </td>
  <td width=94 valign=top style='width:70.15pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>AUD</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=156 valign=top style='width:116.85pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>2
  DE DEU 276</p>
  </td>
  <td width=96 valign=top style='width:72.15pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Germany</p>
  </td>
  <td width=181 valign=top style='width:135.55pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Berlin EU</p>
  </td>
  <td width=94 valign=top style='width:70.15pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>EUR</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=156 valign=top style='width:116.85pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>2
  IN IND 356</p>
  </td>
  <td width=96 valign=top style='width:72.15pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>India</p>
  </td>
  <td width=181 valign=top style='width:135.55pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>New
  Delhi AS</p>
  </td>
  <td width=94 valign=top style='width:70.15pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>INR</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=156 valign=top style='width:116.85pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>3
  LA LAO 418</p>
  </td>
  <td width=96 valign=top style='width:72.15pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Laos</p>
  </td>
  <td width=181 valign=top style='width:135.55pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Vientiane AS</p>
  </td>
  <td width=94 valign=top style='width:70.15pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>LAK</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=156 valign=top style='width:116.85pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>4
  US USA 840</p>
  </td>
  <td width=96 valign=top style='width:72.15pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>United
  States</p>
  </td>
  <td width=181 valign=top style='width:135.55pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Washington
  NA</p>
  </td>
  <td width=94 valign=top style='width:70.15pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>USD</p>
  </td>
 </tr>
 <tr style='height:13.65pt'>
  <td width=156 valign=top style='width:116.85pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>5
  ZW ZWE 716</p>
  </td>
  <td width=96 valign=top style='width:72.15pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Zimbabwe</p>
  </td>
  <td width=181 valign=top style='width:135.55pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Harare AF</p>
  </td>
  <td width=94 valign=top style='width:70.15pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>ZWL</p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>SQL to create the table:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.25pt;margin-bottom:
0in;margin-left:-.45pt;text-indent:0in;line-height:107%'><img border=0
width=719 height=388 id="Picture 218686"
src="SQL%20Notes%20for%20Professionals_files/image033.gif"></p>

<h1 style='margin-left:-.25pt'><a name="_Toc228504">Chapter 6: SELECT</a></h1>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:18.2pt;
margin-left:.25pt'>The SELECT statement is at the heart of most SQL queries. It
defines what result set should be returned by the query, and is almost always
used in conjunction with the FROM clause, which defines what part(s) of the
database should be queried.</p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228505">Section 6.1: Using the wildcard character to
select all columns in a query</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:13.05pt;
margin-left:.25pt'>Consider a database with the following two tables.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Employees table:</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:407.8pt;margin-bottom:
3.5pt;margin-left:.25pt;text-indent:0in;line-height:111%'><b>Id FName LName
DeptId </b>1 James Smith 3</p>

<p class=MsoNormal style='margin-bottom:15.25pt;text-indent:0in'>2 John Johnson
4</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Departments table:</b></p>

<p class=MsoNormal style='margin-bottom:.95pt;text-indent:0in;line-height:111%'><b>Id Name</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:11.9pt;text-indent:-11.65pt'><span style='line-height:110%'>1<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Sales</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:11.9pt;text-indent:-11.65pt'><span style='line-height:110%'>2<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Marketing</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:11.9pt;text-indent:-11.65pt'><span style='line-height:110%'>3<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Finance</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:4.1pt;
margin-left:11.9pt;text-indent:-11.65pt'><span style='line-height:110%'>4<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>IT</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.2pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Simple select statement</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:13.05pt;
margin-left:.25pt'><span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>*</span> is the <b>wildcard character</b> used to select all available
columns in a table.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.75pt;
margin-left:.25pt'>When used as a substitute for explicit column names, it
returns all columns in all tables that a query is selecting <span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>FROM</span>.
This effect applies to <b>all tables</b> the query accesses through its <span
style='font-size:9.0pt;line-height:110%;color:#333399;background:#FAFAFA'>JOIN</span>
clauses.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Consider the following query:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:15.1pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image034.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.9pt;
margin-left:.25pt'>It will return all fields of all rows of the <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Employees</span>
table:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:407.8pt;margin-bottom:
3.5pt;margin-left:.25pt;text-indent:0in;line-height:111%'><b>Id FName LName
DeptId </b>1 James Smith 3</p>

<p class=MsoNormal style='margin-bottom:19.1pt;text-indent:0in'>2 John Johnson
4</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Dot notation</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>To select all values from a specific table, the wildcard
character can be applied to the table with <i>dot notation</i>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Consider the following query:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:0in;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=115
src="SQL%20Notes%20for%20Professionals_files/image035.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:15.15pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=38
src="SQL%20Notes%20for%20Professionals_files/image036.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.4pt;
margin-left:.25pt'>This will return a data set with all fields on the <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Employee</span>
table, followed by just the <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>Name</span> field in the <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>Departments </span>table:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Id FName LName DeptId
Name</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:11.9pt;text-indent:-11.65pt'><span style='line-height:110%'>1<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>James Smith 3 Finance</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:15.25pt;
margin-left:11.9pt;text-indent:-11.65pt'><span style='line-height:110%'>2<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>John Johnson
4 IT</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.0pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Warnings Against Use</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:13.0pt;
margin-left:.25pt'>It is generally advised that using <span style='font-size:
9.0pt;line-height:110%;background:#FAFAFA'>*</span> is avoided in production
code where possible, as it can cause a number of potential problems including:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.8pt;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:110%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Excess
IO, network load, memory use, and so on, due to the database engine reading
data that is not needed and transmitting it to the front-end code. This is
particularly a concern where there might be large fields such as those used to
store long notes or attached files.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=202 style='width:2.1in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=50 valign=top style='width:37.8pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:blue'>SELECT</span><span style='font-size:9.0pt;
  line-height:107%'> </span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:gray;background:#FAFAFA'>&lt;</span>&nbsp;</p>
  </td>
  <td width=50 valign=top style='width:37.8pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>columns</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:gray;background:#FAFAFA'>&gt;</span>&nbsp;</p>
  </td>
  <td width=43 valign=top style='width:.45in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'></span><span style='font-size:9.0pt;line-height:
  107%;color:blue'>FROM</span><span style='font-size:9.0pt;line-height:107%'> </span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:gray;background:#FAFAFA'>&lt;</span>&nbsp;</p>
  </td>
  <td width=36 valign=top style='width:27.0pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>table</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.8pt;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:110%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Further
excess IO load if the database needs to spool internal results to disk as part
of the processing for a query more complex than <span style='font-size:9.0pt;
line-height:110%;color:gray;background:#FAFAFA'>&gt;</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.8pt;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:110%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><img
width=5 height=25 src="SQL%20Notes%20for%20Professionals_files/image037.gif"
align=left hspace=12>Extra processing (and/or even more IO) if some of the
unneeded columns are: computed columns in databases that support them in the
case of selecting from a view, columns from a table/view that the query
optimiser could otherwise optimise out</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=497 style='width:372.6pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=50 valign=top style='width:37.8pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:blue'>SELECT</span><span style='font-size:9.0pt;
  line-height:107%'> </span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:gray;background:#FAFAFA'>*</span></p>
  </td>
  <td width=245 valign=top style='width:2.55in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'></span><span style='font-size:9.0pt;line-height:
  107%;color:blue'>FROM</span><span style='font-size:9.0pt;line-height:107%'>
  orders </span><span style='font-size:9.0pt;line-height:107%;color:#333399'>JOIN</span><span
  style='font-size:9.0pt;line-height:107%'> people </span><span
  style='font-size:9.0pt;line-height:107%;color:blue'>ON</span><span
  style='font-size:9.0pt;line-height:107%'> people</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:gray;background:#FAFAFA'>.</span></p>
  </td>
  <td width=22 valign=top style='width:16.2pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:#25256F'>id</span><span style='font-size:9.0pt;
  line-height:107%'> </span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:gray;background:#FAFAFA'>=</span></p>
  </td>
  <td width=50 valign=top style='width:37.8pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>orders</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:gray;background:#FAFAFA'>.</span></p>
  </td>
  <td width=101 valign=top style='width:1.05in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:#25256F'>personid</span><span style='font-size:
  9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;line-height:
  107%;color:blue'>ORDER</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.4pt;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:110%'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>The
potential for unexpected errors if columns are added to tables and views later
that results ambiguous column names. For example </p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=101 style='width:1.05in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=101 valign=top style='width:1.05in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:blue'>BY</span><span style='font-size:9.0pt;
  line-height:107%'> displayname</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal align=right style='margin-top:0in;margin-right:.15in;
margin-bottom:1.9pt;margin-left:.5pt;text-align:right;text-indent:-.5pt;
line-height:107%'>- if a column column called <span style='font-size:9.0pt;
line-height:107%;background:#FAFAFA'>displayname</span> is added to the orders
table to allow users to give</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=58 style='width:.6in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:blue'>ORDER</span><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:blue'>BY</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:9.85pt;
margin-left:30.0pt'>their orders meaningful names for future reference then the
column name will appear twice in the output so the clause will be ambiguous
which may cause errors (&quot;ambiguous column name&quot; in recent MS SQL
Server versions), and if not in this example your application code might start
displaying the order name where the person name is intended because the new
column is the first of that name returned, and so on.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.0pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>When Can You Use </b><b><span
style='font-size:9.0pt;line-height:111%;background:#FAFAFA'>*</span>, Bearing
The Above Warning In Mind?</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.6pt;
margin-left:.25pt'>While best avoided in production code, using <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>*</span> is fine as
a shorthand when performing manual queries against the database for
investigation or prototype work.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.7pt;
margin-left:.25pt'>Sometimes design decisions in your application make it
unavoidable (in such circumstances, prefer <span style='font-size:9.0pt;
line-height:110%'>tablealias</span><span style='font-size:9.0pt;line-height:
110%;color:gray'>.* </span>over just <span style='font-size:9.0pt;line-height:
110%;background:#FAFAFA'>*</span> where possible).</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=504 style='width:5.25in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:blue'>SELECT</span><span style='font-size:9.0pt;
  line-height:107%'> A</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:gray;background:#FAFAFA'>.</span></p>
  </td>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:#25256F'>col1</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:gray;background:#FAFAFA'>,</span></p>
  </td>
  <td width=14 valign=top style='width:.15in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>A</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:gray;background:#FAFAFA'>.</span></p>
  </td>
  <td width=180 valign=top style='width:135.0pt;background:#FAFAFA;padding:
  1.8pt 0in 0in 0in;height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:#25256F'>Col2</span><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:blue'>FROM</span><span style='font-size:9.0pt;line-height:107%'> A </span><span
  style='font-size:9.0pt;line-height:107%;color:blue'>WHERE</span><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:#333399'>EXISTS</span><span style='font-size:9.0pt;
  line-height:107%'> </span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:gray;background:#FAFAFA'>(</span></p>
  </td>
  <td width=50 valign=top style='width:37.8pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:blue'>SELECT</span><span style='font-size:9.0pt;
  line-height:107%'> </span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:gray;background:#FAFAFA'>*</span></p>
  </td>
  <td width=108 valign=top style='width:81.0pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'></span><span style='font-size:9.0pt;line-height:
  107%;color:blue'>FROM</span><span style='font-size:9.0pt;line-height:107%'> B
  </span><span style='font-size:9.0pt;line-height:107%;color:blue'>where</span><span
  style='font-size:9.0pt;line-height:107%'> A</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:gray;background:#FAFAFA'>.</span></p>
  </td>
  <td width=22 valign=top style='width:16.2pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:#25256F'>ID</span><span style='font-size:9.0pt;
  line-height:107%'> </span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.8pt;
margin-left:.25pt'>When using <span style='font-size:9.0pt;line-height:110%;
color:#333399;background:#FAFAFA'>EXISTS</span>, such as <span
style='font-size:9.0pt;line-height:110%;color:gray;background:#FAFAFA'>=</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=29 style='width:.3in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:#25256F'>A_ID</span></p>
  </td>
 </tr>
</table>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=36 style='width:27.0pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=36 valign=top style='width:27.0pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:fuchsia'>COUNT</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:6.55pt;margin-bottom:
.2pt;margin-left:.25pt;text-align:justify;text-justify:inter-ideograph;
line-height:135%'><span style='font-size:9.0pt;line-height:135%;background:
#FAFAFA'>B</span><span style='font-size:9.0pt;line-height:135%;color:gray;
background:#FAFAFA'>.)</span>, we are not returning any data from B. Thus a
join is unnecessary, and the engine knows no values from B are to be returned,
thus no performance hit for using <span style='font-size:9.0pt;line-height:
135%;background:#FAFAFA'>*</span>. Similarly <span style='font-size:9.0pt;
line-height:135%;color:gray;background:#FAFAFA'>(*)</span> is fine as it also
doesn't actually return any of the columns, so only needs to read and process
those that are used for filtering purposes.</p>

<h2 style='margin-top:0in;margin-right:6.55pt;margin-bottom:.2pt;margin-left:
.25pt;text-align:justify;text-justify:inter-ideograph;text-indent:.5pt;
line-height:135%'><a name="_Toc228506">Section 6.2: SELECT Using Column Aliases</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>Column aliases are used mainly to shorten code and make
column names more readable.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.45pt;
margin-left:.25pt'>Code becomes shorter as long table names and unnecessary
identification of columns <i>(e.g., there may be 2 IDs in the table, but only
one is used in the statement)</i> can be avoided. Along with table aliases this
allows you to use longer descriptive names in your database structure while
keeping queries upon that structure concise.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Furthermore they are sometimes <i>required</i>, for instance
in views, in order to name computed outputs.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.0pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>All versions of SQL</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Aliases can be created in all versions of SQL using double
quotes (<span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>&quot;</span>).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:15.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=112
src="SQL%20Notes%20for%20Professionals_files/image038.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>You can use single quotes (<span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>'</span>), double quotes (<span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>&quot;</span>) and
square brackets (<span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>[]</span>)
to create an alias in Microsoft SQL Server.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=92
src="SQL%20Notes%20for%20Professionals_files/image039.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>Both will result in:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>First Name Middle Name
Last Name</b></p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'>James John Smith</p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'>John James Johnson</p>

<p class=MsoNormal style='margin-bottom:15.15pt;text-indent:0in'>Michael Marcus Williams</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.3pt;
margin-left:.25pt'>This statement will return <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>FName</span> and <span style='font-size:
9.0pt;line-height:110%;background:#FAFAFA'>LName</span> columns with a given
name (an alias). This is achieved using the <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>AS </span>operator followed by the alias,
or simply writing alias directly after the column name. This means that the
following query has the same outcome as the above.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:3.25pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=92
src="SQL%20Notes%20for%20Professionals_files/image040.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>First Name Middle Name
Last Name</b></p>

<p class=MsoNormal style='margin-bottom:3.8pt;text-indent:0in'>James John Smith</p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'>John James Johnson</p>

<p class=MsoNormal style='margin-bottom:15.05pt;text-indent:0in'>Michael Marcus Williams</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>However, the explicit version (i.e., using the <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>AS</span> operator)
is more readable.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.25pt;
margin-left:.25pt'>If the alias has a single word that is not a reserved word,
we can write it without single quotes, double quotes or brackets:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:6.15pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=135
src="SQL%20Notes%20for%20Professionals_files/image041.gif"></span></p>

<p class=MsoNormal style='text-indent:0in'>Michael Williams</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=230 style='width:2.4in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=43 valign=top style='width:.45in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%'>&lt;alias</span></b></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;background:#FAFAFA'>&gt;</span></b>&nbsp;</p>
  </td>
  <td width=180 valign=top style='width:135.0pt;background:#FAFAFA;padding:
  1.8pt 0in 0in 0in;height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>= <b>&lt;column-or-calculation</b></span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.3pt;
margin-left:.25pt'>A further variation available in MS SQL Server amongst
others is <b><span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>&gt;</span></b>,
for instance:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=76
src="SQL%20Notes%20for%20Professionals_files/image042.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>which is equivalent to:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=76
src="SQL%20Notes%20for%20Professionals_files/image043.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>Both will result in:</p>

<p class=MsoNormal style='margin-bottom:.95pt;text-indent:0in;line-height:111%'><span
style='font-size:11.0pt;line-height:111%'> </span><b>FullName Addr1 Addr2</b></p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'>James Smith 123
AnyStreet TownVille</p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'>John Johnson 668
MyRoad Anytown</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:15.05pt;
margin-left:.25pt'>Michael Williams 999 High End Dr Williamsburgh</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.7pt;
margin-left:.25pt'>Some find using <span style='font-size:9.0pt;line-height:
110%;background:#FAFAFA'>=</span> instead of <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>As</span> easier to read, though many
recommend against this format, mainly because it is not standard so not widely
supported by all databases. It may cause confusion with other uses of the <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>=</span> character.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>All Versions of SQL</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Also, if you <i>need</i> to use reserved words, you can use
brackets or quotes to escape:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:19.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=92
src="SQL%20Notes%20for%20Professionals_files/image044.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Different Versions of
SQL</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Likewise, you can escape keywords in MSSQL with all
different approaches:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:6.15pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=152
src="SQL%20Notes%20for%20Professionals_files/image045.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:15.05pt;
margin-left:.25pt'>Michael Marcus Williams</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=58 style='width:.6in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:blue'>ORDER</span><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:blue'>BY</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Also, a column alias may be used any of the final clauses of
the same query, such as an :</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:0in;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=85
src="SQL%20Notes%20for%20Professionals_files/image046.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=54
src="SQL%20Notes%20for%20Professionals_files/image047.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>However, you may <i>not</i> use</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:15.1pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=125
src="SQL%20Notes%20for%20Professionals_files/image048.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.95pt;
margin-left:.25pt'>To create an alias from these reserved words (<span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>SELECT</span>
and <span style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>FROM</span>).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:215.45pt;margin-bottom:
.2pt;margin-left:.25pt;line-height:145%'>This will cause numerous errors on
execution.</p>

<h2 style='margin-top:0in;margin-right:215.45pt;margin-bottom:.2pt;margin-left:
.25pt;text-indent:.5pt;line-height:145%'><a name="_Toc228507">Section 6.3:
Select Individual Columns</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:15.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=92
src="SQL%20Notes%20for%20Professionals_files/image049.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.45pt;
margin-left:.25pt'>This statement will return the columns <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>PhoneNumber</span>,
<span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Email</span>,
and <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>PreferredContact</span>
from all rows of the <span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>Customers </span>table. Also the columns will be returned in the
sequence in which they appear in the <span style='font-size:9.0pt;line-height:
110%;color:blue;background:#FAFAFA'>SELECT</span> clause.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>The result will be:</p>

<p class=MsoNormal style='margin-bottom:.95pt;text-indent:0in;line-height:111%'><b>PhoneNumber Email PreferredContact</b></p>

<p class=MsoNormal style='margin-bottom:3.8pt;text-indent:0in'>3347927472 william.jones@example.com
PHONE</p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'>2137921892 dmiller@example.net EMAIL</p>

<p class=MsoNormal style='margin-bottom:15.05pt;text-indent:0in'>NULL richard0123@example.com
EMAIL</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.7pt;
margin-left:.25pt'>If multiple tables are joined together, you can select
columns from specific tables by specifying the table name</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=173 style='width:1.8in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=72 valign=top style='width:.75in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>table_name</span></p>
  </td>
  <td width=22 valign=top style='width:16.2pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:gray;background:#FAFAFA'>].[</span></p>
  </td>
  <td width=79 valign=top style='width:59.4pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>column_name</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>before the column name: <span style='font-size:9.0pt;
line-height:110%;color:gray;background:#FAFAFA'>[]</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:15.1pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=158
src="SQL%20Notes%20for%20Professionals_files/image050.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=72 style='width:.75in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=72 valign=top style='width:.75in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:blue'>AS</span><span style='font-size:9.0pt;
  line-height:107%'> OrderId</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.45pt;
margin-left:.25pt'>* means that the <span style='font-size:9.0pt;line-height:
110%;background:#FAFAFA'>Id</span> field of <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>Orders</span> table will be returned as a
column named <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>OrderId</span>.
See selecting with column alias for further information.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.35pt;
margin-left:.25pt'>To avoid using long table names, you can use table aliases.
This mitigates the pain of writing long table names for each field that you
select in the joins. If you are performing a self join (a join between two
instances of the <i>same </i>table), then you must use table aliases to
distinguish your tables. We can write a table alias like <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Customers c</span>
or</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=660 style='width:495.0pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=101 valign=top style='width:1.05in;background:#FAFAFA;padding:1.1pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>Customers </span><span style='font-size:9.0pt;
  line-height:107%;color:blue'>AS</span><span style='font-size:9.0pt;
  line-height:107%'> c</span></p>
  </td>
  <td width=523 valign=top style='width:5.45in;padding:1.1pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>. Here <span
  style='font-size:9.0pt;line-height:107%;background:#FAFAFA'>c</span> works as
  an alias for <span style='font-size:9.0pt;line-height:107%;background:#FAFAFA'>Customers</span>
  and we can select let's say <span style='font-size:9.0pt;line-height:107%;
  background:#FAFAFA'>Email</span> like this: <span style='font-size:9.0pt;
  line-height:107%;background:#FAFAFA'>c</span><span style='font-size:9.0pt;
  line-height:107%;color:gray;background:#FAFAFA'>.</span></p>
  </td>
  <td width=36 valign=top style='width:27.0pt;background:#FAFAFA;padding:1.1pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:#25256F'>Email</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal align=right style='margin-top:0in;margin-right:40.7pt;
margin-bottom:1.9pt;margin-left:.5pt;text-align:right;text-indent:-.5pt;
line-height:107%'>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=158
src="SQL%20Notes%20for%20Professionals_files/image051.gif"></span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228508">Section 6.4: Selecting specified number of records</a></h2>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=79 style='width:59.4pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=79 valign=top style='width:59.4pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:blue'>FETCH</span><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:blue'>FIRST</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>The <a href="https://en.wikipedia.org/wiki/SQL:2008"><span
style='color:#F31D19'>SQL 2008 standard</span></a> defines the clause to limit
the number of records returned.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=76
src="SQL%20Notes%20for%20Professionals_files/image052.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=180 style='width:135.0pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=86 valign=top style='width:.9in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:blue'>FETCH</span><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:blue'>FIRST</span><span style='font-size:9.0pt;line-height:107%'> </span></p>
  </td>
  <td width=22 valign=top style='width:16.2pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:gray;background:#FAFAFA'>&lt;</span><span
  style='font-size:9.0pt;line-height:107%;background:#FAFAFA'>n</span><span
  style='font-size:9.0pt;line-height:107%;color:gray;background:#FAFAFA'>&gt;</span></p>
  </td>
  <td width=72 valign=top style='width:.75in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'></span><span style='font-size:9.0pt;line-height:
  107%;color:blue'>ROWS</span><span style='font-size:9.0pt;line-height:107%'> </span><span
  style='font-size:9.0pt;line-height:107%;color:blue'>ONLY</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.45pt;
margin-left:.25pt'>This standard is only supported in recent versions of some
RDMSs. Vendor-specific non-standard syntax is provided in other systems.
Progress OpenEdge 11.x also supports the syntax.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=336 style='width:252.05pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=50 valign=top style='width:37.8pt;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:blue'>OFFSET</span><span style='font-size:9.0pt;
  line-height:107%'> </span></p>
  </td>
  <td width=22 valign=top style='width:16.2pt;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:gray;background:#FAFAFA'>&lt;</span><span
  style='font-size:9.0pt;line-height:107%;background:#FAFAFA'>m</span><span
  style='font-size:9.0pt;line-height:107%;color:gray;background:#FAFAFA'>&gt;</span></p>
  </td>
  <td width=36 valign=top style='width:27.0pt;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'></span><span style='font-size:9.0pt;line-height:
  107%;color:blue'>ROWS</span></p>
  </td>
  <td width=48 valign=top style='width:36.05pt;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>before </p>
  </td>
  <td width=86 valign=top style='width:.9in;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:blue'>FETCH</span><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:blue'>FIRST</span><span style='font-size:9.0pt;line-height:107%'> </span></p>
  </td>
  <td width=22 valign=top style='width:16.2pt;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:gray;background:#FAFAFA'>&lt;</span><span
  style='font-size:9.0pt;line-height:107%;background:#FAFAFA'>n</span><span
  style='font-size:9.0pt;line-height:107%;color:gray;background:#FAFAFA'>&gt;</span></p>
  </td>
  <td width=72 valign=top style='width:.75in;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'></span><span style='font-size:9.0pt;line-height:
  107%;color:blue'>ROWS</span><span style='font-size:9.0pt;line-height:107%'> </span><span
  style='font-size:9.0pt;line-height:107%;color:blue'>ONLY</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Additionally, allows skipping rows before fetching rows.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=92
src="SQL%20Notes%20for%20Professionals_files/image053.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>The following query is supported in SQL Server and MS
Access:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:15.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="SQL%20Notes%20for%20Professionals_files/image054.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>To do the same in MySQL or PostgreSQL the <span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>LIMIT</span>
keyword must be used:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:11.9pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=110
src="SQL%20Notes%20for%20Professionals_files/image055.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=76
src="SQL%20Notes%20for%20Professionals_files/image056.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:21.95pt;
margin-left:.25pt'><b>Results</b>: <b>10</b> records.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.9pt;margin-bottom:1.75pt;
margin-left:3.5pt;text-indent:-.5pt;line-height:110%'><span style='font-size:
9.0pt;line-height:110%;font-family:"DejaVu Sans Mono"'>Id
ProductName UnitPrice Package</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.9pt;margin-bottom:2.5pt;
margin-left:3.5pt;text-indent:-.5pt;line-height:110%'><span style='font-size:
9.0pt;line-height:110%;font-family:"DejaVu Sans Mono"'>38 C</span><span
style='font-size:9.0pt;line-height:110%;font-family:"Arial",sans-serif'></span><span
style='font-size:9.0pt;line-height:110%;font-family:"DejaVu Sans Mono"'>te de
Blaye 263.50 12 - 75 cl bottles</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:128.7pt;margin-bottom:
.3pt;margin-left:3.5pt;text-indent:-.5pt;line-height:110%'><span
style='position:relative;z-index:-1895814144'><span style='left:0px;position:
absolute;left:0px;top:-54px;width:718px;height:94px'><img width=718 height=94
src="SQL%20Notes%20for%20Professionals_files/image057.gif"></span></span><span
style='font-size:9.0pt;line-height:110%;font-family:"DejaVu Sans Mono"'>29
Th</span><span style='font-size:9.0pt;line-height:110%;font-family:"Arial",sans-serif'></span><span
style='font-size:9.0pt;line-height:110%;font-family:"DejaVu Sans Mono"'>ringer
Rostbratwurst 123.79 50 bags x 30 sausgs. 9 Mishi Kobe
Niku 97.00 18 - 500 g pkgs.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:160.8pt;margin-bottom:
.3pt;margin-left:3.5pt;text-indent:-.5pt;line-height:110%'><span
style='font-size:9.0pt;line-height:110%;font-family:"DejaVu Sans Mono"'>20
Sir Rodney's Marmalade 81.00 30 gift boxes 18 Carnarvon
Tigers 62.50 16 kg pkg.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.9pt;margin-bottom:.3pt;
margin-left:3.5pt;text-indent:-.5pt;line-height:110%'><span style='font-size:
9.0pt;line-height:110%;font-family:"DejaVu Sans Mono"'>59 Raclette
Courdavault 55.00 5 kg pkg.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.9pt;margin-bottom:.3pt;
margin-left:3.5pt;text-indent:-.5pt;line-height:110%'><span style='font-size:
9.0pt;line-height:110%;font-family:"DejaVu Sans Mono"'>51 Manjimup Dried
Apples 53.00 50 - 300 g pkgs.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.9pt;margin-bottom:.3pt;
margin-left:3.5pt;text-indent:-.5pt;line-height:110%'><span style='font-size:
9.0pt;line-height:110%;font-family:"DejaVu Sans Mono"'>62 Tarte au
sucre 49.30 48 pies</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:149.95pt;margin-bottom:
25.8pt;margin-left:3.5pt;text-indent:-.5pt;line-height:110%'><span
style='position:relative;z-index:-1895813120'><span style='left:0px;position:
absolute;left:0px;top:-82px;width:718px;height:129px'><img width=718
height=129 src="SQL%20Notes%20for%20Professionals_files/image058.gif"></span></span><span
style='font-size:9.0pt;line-height:110%;font-family:"DejaVu Sans Mono"'>43
Ipoh Coffee 46.00 16 - 500 g tins 28 R</span><span
style='font-size:9.0pt;line-height:110%;font-family:"Arial",sans-serif'></span><span
style='font-size:9.0pt;line-height:110%;font-family:"DejaVu Sans Mono"'>ssle
Sauerkraut 45.60 25 - 825 g cans</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.05pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Vendor Nuances:</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:4.9pt;margin-bottom:.2pt;
margin-left:.25pt;text-align:justify;text-justify:inter-ideograph;line-height:
135%'>It is important to note that the <span style='font-size:9.0pt;line-height:
135%;color:blue;background:#FAFAFA'>TOP</span> in Microsoft SQL operates after
the <span style='font-size:9.0pt;line-height:135%;color:blue;background:#FAFAFA'>WHERE</span>
clause and will return the specified number of results if they exist anywhere
in the table, while <span style='font-size:9.0pt;line-height:135%;background:
#FAFAFA'>ROWNUM</span> works as part of the <span style='font-size:9.0pt;
line-height:135%;color:blue;background:#FAFAFA'>WHERE</span> clause so if other
conditions do not exist in the specified number of rows at the beginning of the
table, you will get zero results when there could be others to be found.</p>

<h2 style='margin-top:0in;margin-right:4.9pt;margin-bottom:.2pt;margin-left:
.25pt;text-align:justify;text-justify:inter-ideograph;text-indent:.5pt;
line-height:135%'><a name="_Toc228509">Section 6.5: Selecting with Condition</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>The basic syntax of SELECT with WHERE clause is:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="SQL%20Notes%20for%20Professionals_files/image059.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.45pt;
margin-left:.25pt'>The <i>[condition]</i> can be any SQL expression, specified
using comparison or logical operators like &gt;, &lt;, =, &lt;&gt;, &gt;=,
&lt;=, LIKE, NOT, IN, BETWEEN etc.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>The following statement returns all columns from the table
'Cars' where the status column is 'READY':</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image060.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:265.95pt;margin-bottom:
.2pt;margin-left:.25pt;line-height:145%'>See WHERE and HAVING for more
examples.</p>

<h2 style='margin-top:0in;margin-right:265.95pt;margin-bottom:.2pt;margin-left:
.25pt;text-indent:.5pt;line-height:145%'><a name="_Toc228510">Section 6.6:
Selecting with CASE</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>When results need to have some logic applied 'on the fly'
one can use CASE statement to implement it.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src="SQL%20Notes%20for%20Professionals_files/image061.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>also can be chained</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:11.9pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=143
src="SQL%20Notes%20for%20Professionals_files/image062.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:0in;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=107
src="SQL%20Notes%20for%20Professionals_files/image063.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=21
src="SQL%20Notes%20for%20Professionals_files/image064.gif"></span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228511">Section 6.7: Select columns which are named after
reserved keywords</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.25pt;
margin-left:.25pt'>When a column name matches a reserved keyword, standard SQL
requires that you enclose it in double quotation marks:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=76
src="SQL%20Notes%20for%20Professionals_files/image065.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>Note that it makes the column name case-sensitive.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.25pt;
margin-left:.25pt'>Some DBMSes have proprietary ways of quoting names. For
example, SQL Server uses square brackets for this purpose:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=76
src="SQL%20Notes%20for%20Professionals_files/image066.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>while MySQL (and MariaDB) by default use backticks:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=76
src="SQL%20Notes%20for%20Professionals_files/image067.gif"></span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:0in;margin-left:-.25pt'><a
name="_Toc228512">Section 6.8: Selecting with table alias</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src="SQL%20Notes%20for%20Professionals_files/image068.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.25pt;
margin-left:.25pt'>The Employees table is given the alias 'e' directly after
the table name. This helps remove ambiguity in scenarios where multiple tables
have the same field name and you need to be specific as to which table you want
to return data from.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="SQL%20Notes%20for%20Professionals_files/image069.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Note that once you define an alias, you can't use the
canonical table name anymore. i.e.,</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="SQL%20Notes%20for%20Professionals_files/image070.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>would throw an error.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=72 style='width:.75in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=72 valign=top style='width:.75in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:#333399'>INNER</span><span style='font-size:
  9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;line-height:
  107%;color:#333399'>JOIN</span></p>
  </td>
 </tr>
</table>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=86 style='width:.9in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=86 valign=top style='width:.9in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:blue'>NATURAL</span><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:#333399'>JOIN</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.25pt;
margin-left:.25pt'>It is worth noting table aliases -- more formally 'range
variables' -- were introduced into the SQL language to solve the problem of
duplicate columns caused by . The 1992 SQL standard corrected this earlier
design flaw by introducing (implemented in mySQL, PostgreSQL and Oracle but
not yet in SQL Server), the result of which never has duplicate column names.
The above example is interesting in that the tables are joined on columns with
different names (<span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Id</span>
and <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>ManagerId</span>)
but are not supposed to be joined on the columns with the same name (<span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>LName</span>, <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>FName</span>),
requiring the renaming of the columns to be performed <i>before</i> the join:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=92
src="SQL%20Notes%20for%20Professionals_files/image071.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:25.65pt;margin-bottom:
.2pt;margin-left:.25pt;text-align:justify;text-justify:inter-ideograph;
line-height:135%'>Note that although an alias/range variable must be declared
for the dervied table (otherwise SQL will throw an error), it never makes sense
to actually use it in the query.</p>

<h2 style='margin-top:0in;margin-right:25.65pt;margin-bottom:.2pt;margin-left:
.25pt;text-align:justify;text-justify:inter-ideograph;text-indent:.5pt;
line-height:135%'><a name="_Toc228513">Section 6.9: Selecting with more than 1
condition</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.85pt;
margin-left:.25pt'>The <span style='font-size:9.0pt;line-height:110%;
color:#333399;background:#FAFAFA'>AND</span> keyword is used to add more
conditions to the query.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Name Age Gender</b></p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'>Sam 18 M</p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'>John 21 M</p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'>Bob 22 M</p>

<p class=MsoNormal style='text-indent:0in'>Mary 23 F</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image072.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.3pt;
margin-left:.25pt'>This will return:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Name</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:497.75pt;margin-bottom:
11.85pt;margin-left:.25pt;line-height:137%'>John Bob</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>using <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>OR</span> keyword</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image073.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.3pt;
margin-left:.25pt'>This will return:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:488.7pt;margin-bottom:
3.1pt;margin-left:.25pt;text-indent:0in;line-height:111%'><b>name </b>Sam</p>

<p class=MsoNormal style='margin-top:0in;margin-right:497.75pt;margin-bottom:
11.7pt;margin-left:.25pt;line-height:137%'>John Bob</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>These keywords can be combined to allow for more complex
criteria combinations:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=76
src="SQL%20Notes%20for%20Professionals_files/image074.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.3pt;
margin-left:.25pt'>This will return:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:488.7pt;margin-bottom:
3.1pt;margin-left:.25pt;text-indent:0in;line-height:111%'><b>name </b>Sam</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Mary</p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228514">Section 6.10: Selecting without Locking the table</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.45pt;
margin-left:.25pt'>Sometimes when tables are used mostly (or only) for reads,
indexing does not help anymore and every little bit counts, one might use
selects without LOCK to improve performance.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>SQL Server</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image075.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>MySQL</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="SQL%20Notes%20for%20Professionals_files/image076.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Oracle</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src="SQL%20Notes%20for%20Professionals_files/image077.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>DB2</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:15.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image078.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.85pt;
margin-left:.25pt'>where <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>UR</span> stands for &quot;uncommitted read&quot;.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:61.05pt;margin-bottom:
.2pt;margin-left:.25pt;line-height:145%'>If used on table that has record
modifications going on might have unpredictable results.</p>

<h2 style='margin-top:0in;margin-right:61.05pt;margin-bottom:.2pt;margin-left:
.25pt;text-indent:.5pt;line-height:145%'><a name="_Toc228515">Section 6.11:
Selecting with Aggregate functions</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Average</b></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=22 style='width:16.2pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=22 valign=top style='width:16.2pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:fuchsia'>AVG</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>The <span style='font-size:9.0pt;line-height:110%;
color:gray;background:#FAFAFA'>()</span> aggregate function will return the
average of values selected.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:1.55pt;
margin-left:.5pt;text-indent:-.5pt'><span style='font-size:11.0pt;line-height:
110%'><img border=0 width=718 height=26 id="Group 178778"
src="SQL%20Notes%20for%20Professionals_files/image079.gif"></span><span
style='font-size:9.0pt;line-height:110%;color:blue'>SELECT</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:fuchsia'>AVG</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>(</span><span style='font-size:9.0pt;line-height:
110%'>Salary</span><span style='font-size:9.0pt;line-height:110%;color:gray'>)</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>FROM</span><span style='font-size:9.0pt;
line-height:110%'> Employees</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.25pt;
margin-left:.25pt'>Aggregate functions can also be combined with the where
clause.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:185.05pt;margin-bottom:
8.1pt;margin-left:.25pt;text-indent:3.75pt;line-height:148%'><span
style='position:relative;z-index:-1895812096'><span style='left:0px;position:
absolute;left:0px;top:-8px;width:718px;height:26px'><img width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image080.gif"></span></span><span
style='font-size:9.0pt;line-height:148%;color:blue'>SELECT</span><span
style='font-size:9.0pt;line-height:148%'> </span><span style='font-size:9.0pt;
line-height:148%;color:fuchsia'>AVG</span><span style='font-size:9.0pt;
line-height:148%;color:gray'>(</span><span style='font-size:9.0pt;line-height:
148%'>Salary</span><span style='font-size:9.0pt;line-height:148%;color:gray'>)</span><span
style='font-size:9.0pt;line-height:148%'> </span><span style='font-size:9.0pt;
line-height:148%;color:blue'>FROM</span><span style='font-size:9.0pt;
line-height:148%'> Employees </span><span style='font-size:9.0pt;line-height:
148%;color:blue'>where</span><span style='font-size:9.0pt;line-height:148%'>
DepartmentId </span><span style='font-size:9.0pt;line-height:148%;color:gray'>=</span><span
style='font-size:9.0pt;line-height:148%'> 1 </span>Aggregate functions can also
be combined with group by clause.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.25pt;
margin-left:.25pt'>If employee is categorized with multiple department and we
want to find avg salary for every department then we can use following query.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:4.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image081.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Minimum</b></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=22 style='width:16.2pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=22 valign=top style='width:16.2pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:fuchsia'>MIN</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>The <span style='font-size:9.0pt;line-height:110%;
color:gray;background:#FAFAFA'>()</span> aggregate function will return the
minimum of values selected.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:1.8pt;
margin-left:.5pt;text-indent:-.5pt'><span style='font-size:11.0pt;line-height:
110%'><img border=0 width=718 height=26 id="Group 178781"
src="SQL%20Notes%20for%20Professionals_files/image080.gif"></span><span
style='font-size:9.0pt;line-height:110%;color:blue'>SELECT</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:fuchsia'>MIN</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>(</span><span style='font-size:9.0pt;line-height:
110%'>Salary</span><span style='font-size:9.0pt;line-height:110%;color:gray'>)</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>FROM</span><span style='font-size:9.0pt;
line-height:110%'> Employees</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Maximum</b></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=22 style='width:16.2pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=22 valign=top style='width:16.2pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:fuchsia'>MAX</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>The <span style='font-size:9.0pt;line-height:110%;
color:gray;background:#FAFAFA'>()</span> aggregate function will return the
maximum of values selected.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:1.8pt;
margin-left:.5pt;text-indent:-.5pt'><span style='font-size:11.0pt;line-height:
110%'><img border=0 width=718 height=26 id="Group 178782"
src="SQL%20Notes%20for%20Professionals_files/image082.gif"></span><span
style='font-size:9.0pt;line-height:110%;color:blue'>SELECT</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:fuchsia'>MAX</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>(</span><span style='font-size:9.0pt;line-height:
110%'>Salary</span><span style='font-size:9.0pt;line-height:110%;color:gray'>)</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>FROM</span><span style='font-size:9.0pt;
line-height:110%'> Employees</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Count</b></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=36 style='width:27.0pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=36 valign=top style='width:27.0pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:fuchsia'>COUNT</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>The <span style='font-size:9.0pt;line-height:110%;
color:gray;background:#FAFAFA'>()</span> aggregate function will return the
count of values selected.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:3.75pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image083.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>It can also be combined with where conditions to get the
count of rows that satisfy specific conditions.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.1pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='position:relative;z-index:
-1895811072'><span style='left:0px;position:absolute;left:0px;top:-8px;
width:718px;height:26px'><img width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image082.gif"></span></span><span
style='font-size:9.0pt;line-height:110%;color:blue'>SELECT</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:fuchsia'>Count</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>(*)</span><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:blue'>FROM</span><span
style='font-size:9.0pt;line-height:110%'> Employees </span><span
style='font-size:9.0pt;line-height:110%;color:blue'>where</span><span
style='font-size:9.0pt;line-height:110%'> ManagerId </span><span
style='font-size:9.0pt;line-height:110%;color:blue'>IS</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#333399'>NOT</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:#333399'>NULL</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:2.9pt;
margin-left:.25pt'>Specific columns can also be specified to get the number of
values in the column. Note that <span style='font-size:9.0pt;line-height:110%;
color:#333399;background:#FAFAFA'>NULL</span> values are not counted.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.05pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='position:relative;z-index:
-1895810048'><span style='left:0px;position:absolute;left:0px;top:-8px;
width:718px;height:26px'><img width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image079.gif"></span></span><span
style='font-size:9.0pt;line-height:110%;color:blue'>Select</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:fuchsia'>Count</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>(</span><span style='font-size:9.0pt;line-height:
110%'>ManagerId</span><span style='font-size:9.0pt;line-height:110%;color:gray'>)</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>from</span><span style='font-size:9.0pt;
line-height:110%'> Employees</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.25pt;
margin-left:.25pt'>Count can also be combined with the distinct keyword for a
distinct count.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.3pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='position:relative;z-index:
-1895809024'><span style='left:0px;position:absolute;left:0px;top:-8px;
width:718px;height:26px'><img width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image082.gif"></span></span><span
style='font-size:9.0pt;line-height:110%;color:blue'>Select</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:fuchsia'>Count</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>(</span><span style='font-size:9.0pt;line-height:
110%;color:blue'>DISTINCT</span><span style='font-size:9.0pt;line-height:110%'>
DepartmentId</span><span style='font-size:9.0pt;line-height:110%;color:gray'>)</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>from</span><span style='font-size:9.0pt;
line-height:110%'> Employees</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Sum</b></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=22 style='width:16.2pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=22 valign=top style='width:16.2pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:fuchsia'>SUM</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>The <span style='font-size:9.0pt;line-height:110%;
color:gray;background:#FAFAFA'>()</span> aggregate function returns the sum of
the values selected for all rows.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:18.5pt;
margin-left:.5pt;text-indent:-.5pt'><span style='font-size:11.0pt;line-height:
110%'><img border=0 width=718 height=26 id="Group 177387"
src="SQL%20Notes%20for%20Professionals_files/image082.gif"></span><span
style='font-size:9.0pt;line-height:110%;color:blue'>SELECT</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:fuchsia'>SUM</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>(</span><span style='font-size:9.0pt;line-height:
110%'>Salary</span><span style='font-size:9.0pt;line-height:110%;color:gray'>)</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>FROM</span><span style='font-size:9.0pt;
line-height:110%'> Employees</span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:0in;margin-left:-.25pt'><a
name="_Toc228516">Section 6.12: Select with condition of multiple values from
column</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image084.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>This is semantically equivalent to</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:11.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=61
src="SQL%20Notes%20for%20Professionals_files/image085.gif"></span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228517">Section 6.13: Get aggregated result for row groups</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Counting rows based on a specific column value:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="SQL%20Notes%20for%20Professionals_files/image086.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Getting average income by department:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="SQL%20Notes%20for%20Professionals_files/image087.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=58 style='width:.6in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:blue'>GROUP</span><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:blue'>BY</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.9pt;
margin-left:.25pt'>The important thing is to select only columns specified in
the clause or used with aggregate functions.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=58 style='width:.6in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:blue'>GROUP</span><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:blue'>BY</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>There <span style='font-size:9.0pt;line-height:110%;
color:blue;background:#FAFAFA'>WHERE</span> clause can also be used with , but <span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>WHERE</span>
filters out records <i>before</i> any grouping is done:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=76
src="SQL%20Notes%20for%20Professionals_files/image088.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.35pt;
margin-left:.25pt'>If you need to filter the results after the grouping has
been done, e.g, to see only departments whose average income is larger than
1000, you need to use the <span style='font-size:9.0pt;line-height:110%;
color:blue;background:#FAFAFA'>HAVING</span> clause:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:0in;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=92
src="SQL%20Notes%20for%20Professionals_files/image089.gif"></span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:0in;margin-left:-.25pt'><a
name="_Toc228518">Section 6.14: Selection with sorted Results</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:15.1pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image090.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.9pt;
margin-left:.25pt'>This statement will return all the columns from the table <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Employees</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:365.5pt;margin-bottom:
3.5pt;margin-left:.25pt;text-indent:0in;line-height:111%'><b>Id FName LName
PhoneNumber </b>2 John Johnson 2468101214</p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'>1 James Smith 1234567890</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>3 Michael Williams 1357911131</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image091.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Or</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image092.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>This statement changes the sorting direction.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>One may also specify multiple sorting columns. For example:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:15.1pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image093.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.45pt;
margin-left:.25pt'>This example will sort the results first by <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>LName</span> and
then, for records that have the same <span style='font-size:9.0pt;line-height:
110%;background:#FAFAFA'>LName</span>, sort by <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>FName</span>. This will give you a result
similar to what you would find in a telephone book.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=58 style='width:.6in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:blue'>ORDER</span><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:blue'>BY</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.25pt;
margin-left:.25pt'>In order to save retyping the column name in the clause, it
is possible to use instead the column's number. Note that column numbers start
from 1.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:15.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image094.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=58 style='width:.6in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:blue'>ORDER</span><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:blue'>BY</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>You may also embed a <span style='font-size:9.0pt;
line-height:110%;color:blue;background:#FAFAFA'>CASE</span> statement in the
clause.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:15.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src="SQL%20Notes%20for%20Professionals_files/image095.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:101.8pt;margin-bottom:
.2pt;margin-left:.25pt;line-height:145%'>This will sort your results to have
all records with the <span style='font-size:9.0pt;line-height:145%;background:
#FAFAFA'>LName</span> of &quot;Jones&quot; at the top.</p>

<h2 style='margin-top:0in;margin-right:101.8pt;margin-bottom:.2pt;margin-left:
.25pt;text-indent:.5pt;line-height:145%'><a name="_Toc228519">Section 6.15:
Selecting with null</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image096.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=150 style='width:112.5pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=50 valign=top style='width:37.8pt;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:blue'>IS</span><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:#333399'>NULL</span></p>
  </td>
  <td width=20 valign=top style='width:15.3pt;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>or </p>
  </td>
  <td width=79 valign=top style='width:59.4pt;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:blue'>IS</span><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:#333399'>NOT</span><span style='font-size:9.0pt;line-height:107%'> </span><span
  style='font-size:9.0pt;line-height:107%;color:#333399'>NULL</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:44.6pt;margin-bottom:
.2pt;margin-left:.25pt;line-height:145%'>Selection with nulls take a different
syntax. Don't use <span style='font-size:9.0pt;line-height:145%;background:
#FAFAFA'>=</span>, use instead.</p>

<h2 style='margin-top:0in;margin-right:44.6pt;margin-bottom:.2pt;margin-left:
.25pt;text-indent:.5pt;line-height:145%'><a name="_Toc228520">Section 6.16:
Select distinct (unique values only)</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:15.25pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src="SQL%20Notes%20for%20Professionals_files/image097.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.5pt;
margin-left:.25pt'>This query will return all <span style='font-size:9.0pt;
line-height:110%;color:blue;background:#FAFAFA'>DISTINCT</span> (unique,
different) values from <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>ContinentCode</span> column from <span style='font-size:
9.0pt;line-height:110%;background:#FAFAFA'>Countries</span> table</p>

<p class=MsoNormal style='margin-top:0in;margin-right:448.55pt;margin-bottom:
3.1pt;margin-left:.25pt;text-indent:0in;line-height:111%'><b>ContinentCode </b>OC</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>EU</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.3pt;
margin-left:.25pt'>AS</p>

<p class=MsoNormal style='margin-top:0in;margin-right:512.0pt;margin-bottom:
11.7pt;margin-left:.25pt;line-height:137%'>NA AF</p>

<p class=MsoNormal style='margin-top:0in;margin-right:146.85pt;margin-bottom:
0in;margin-left:-.25pt;text-indent:-.5pt;line-height:145%'><a
href="http://sqlfiddle.com/#!9/14cfc6/2/0"><span style='color:#F31D19'>SQLFiddle
Demo</span></a></p>

<h2 style='margin-top:0in;margin-right:146.85pt;margin-bottom:0in;margin-left:
-.25pt;line-height:145%'><a name="_Toc228521">Section 6.17: Select rows from
multiple tables</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=201
src="SQL%20Notes%20for%20Professionals_files/image098.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>This is called cross product in SQL it is same as cross
product in sets</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>These statements return the selected columns from multiple
tables in one query.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>There is no specific relationship between the columns
returned from each table.<br clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc228522">Chapter 7: GROUP BY</a></h1>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=58 style='width:.6in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:blue'>GROUP</span><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:blue'>BY</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.55pt;margin-bottom:.2pt;
margin-left:.25pt;text-align:justify;text-justify:inter-ideograph;line-height:
135%'>Results of a SELECT query can be grouped by one or more columns using
the statement: all results with the same value in the grouped columns are
aggregated together. This generates a table of partial results, instead of one
result. GROUP BY can be used in conjunction with aggregation functions using
the <span style='font-size:9.0pt;line-height:135%;color:blue;background:#FAFAFA'>HAVING</span>
statement to define how non-grouped columns are aggregated.</p>

<h2 style='margin-top:0in;margin-right:.55pt;margin-bottom:.2pt;margin-left:
.25pt;text-align:justify;text-justify:inter-ideograph;text-indent:.5pt;
line-height:135%'><a name="_Toc228523">Section 7.1: Basic GROUP BY example</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>It might be easier if you think of GROUP BY as &quot;for
each&quot; for the sake of explanation. The query below:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="SQL%20Notes%20for%20Professionals_files/image099.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:13.05pt;
margin-left:.25pt'>is saying:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:274.75pt;margin-bottom:
.2pt;margin-left:.25pt;line-height:217%'>&quot;Give me the sum of
MonthlySalary's <b>for each</b> EmpID&quot; So if your table looked like this:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=142
src="SQL%20Notes%20for%20Professionals_files/image100.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Result:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=110
src="SQL%20Notes%20for%20Professionals_files/image101.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.25pt;
margin-left:.25pt'>Sum wouldn't appear to do anything because the sum of one
number is that number. On the other hand if it looked like this:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=174
src="SQL%20Notes%20for%20Professionals_files/image102.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Result:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:0in;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=27 id="Group 171635"
src="SQL%20Notes%20for%20Professionals_files/image103.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=95
src="SQL%20Notes%20for%20Professionals_files/image104.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:32.8pt;margin-bottom:
.2pt;margin-left:.25pt;line-height:145%'>Then it would because there are two
EmpID 1's to sum together.</p>

<h2 style='margin-top:0in;margin-right:32.8pt;margin-bottom:.2pt;margin-left:
.25pt;text-indent:.5pt;line-height:145%'><a name="_Toc228524">Section 7.2:
Filter GROUP BY results using a HAVING clause</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.7pt;
margin-left:.25pt'>A HAVING clause filters the results of a GROUP BY
expression. Note: The following examples are using the Library example
database.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Examples:</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Return all authors that wrote more than one book (<a
href="http://sqlfiddle.com/#!9/7c06f/7"><span style='color:#F31D19'>live
example</span></a>).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=191
src="SQL%20Notes%20for%20Professionals_files/image105.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Return all books that have more than three authors (<a
href="http://sqlfiddle.com/#!9/7c06f/9"><span style='color:#F31D19'>live
example</span></a>).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=191
src="SQL%20Notes%20for%20Professionals_files/image106.gif"></span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228525">Section 7.3: USE GROUP BY to COUNT the number of
rows for each unique entry in a given column</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>Let's say you want to generate counts or subtotals for a
given value in a column.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>Given this table, &quot;Westerosians&quot;:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:363.45pt;margin-bottom:
3.5pt;margin-left:.25pt;text-indent:5.25pt;line-height:111%'><b>Name
GreatHouseAllegience </b>Arya Stark</p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'>Cercei Lannister</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:.25pt'>Myrcella Lannister</p>

<p class=MsoNormal style='margin-bottom:3.8pt;text-indent:0in'>Yara Greyjoy</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Catelyn Stark</p>

<p class=MsoNormal style='margin-bottom:15.05pt;text-indent:0in'>Sansa Stark</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Without GROUP BY, COUNT will simply return a total number of
rows:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src="SQL%20Notes%20for%20Professionals_files/image107.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.3pt;
margin-left:.25pt'>returns...</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Number_of_Westerosians</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:15.05pt;
margin-left:.25pt'>6</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.25pt;
margin-left:.25pt'>But by adding GROUP BY, we can COUNT the users for each
value in a given column, to return the number of people in a given Great House,
say:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="SQL%20Notes%20for%20Professionals_files/image108.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>returns...</p>

<p class=MsoNormal style='margin-bottom:.95pt;text-indent:0in;line-height:111%'><b>House Number_of_Westerosians</b></p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'>Stark 3</p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'>Greyjoy 1</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:15.05pt;
margin-left:.25pt'>Lannister 2</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>It's common to combine GROUP BY with ORDER BY to sort
results by largest or smallest category:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=76
src="SQL%20Notes%20for%20Professionals_files/image109.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>returns...</p>

<p class=MsoNormal style='margin-bottom:.95pt;text-indent:0in;line-height:111%'><b>House Number_of_Westerosians</b></p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'>Stark 3</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:.25pt'>Lannister 2</p>

<p class=MsoNormal style='margin-bottom:20.8pt;text-indent:0in'>Greyjoy 1</p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228526">Section 7.4: ROLAP aggregation (Data Mining)</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Description</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.45pt;
margin-left:.25pt'>The SQL standard provides two additional aggregate
operators. These use the polymorphic value &quot;ALL&quot; to denote the set of
all values that an attribute can take. The two operators are:</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=101 style='width:1.05in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=101 valign=top style='width:1.05in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:blue'>with</span><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:blue'>data</span><span style='font-size:9.0pt;line-height:107%'> </span><span
  style='font-size:9.0pt;line-height:107%;color:blue'>cube</span></p>
  </td>
 </tr>
</table>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=86 style='width:.9in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=86 valign=top style='width:.9in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:blue'>with</span><span style='font-size:9.0pt;
  line-height:107%'> roll up</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:23.2pt;
margin-bottom:.2pt;margin-left:30.5pt;text-align:center;text-indent:-.5pt;
line-height:123%'><img width=5 height=1
src="SQL%20Notes%20for%20Professionals_files/image110.gif" align=left
hspace=12>that it provides all possible combinations than the argument
attributes of the clause. that it provides the aggregates obtained by
considering the attributes in order from left to</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:30.0pt'>right compared how they are listed in the argument of the
clause.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:13.05pt;
margin-left:.25pt'>SQL standard versions that support these features:
1999,2003,2006,2008,2011.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Examples</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>Consider this table:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Food Brand Total_amount</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:.25pt'>Pasta Brand1 100</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:.25pt'>Pasta Brand2 250</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:4.05pt;
margin-left:.25pt'>Pizza Brand2 300</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:1.75pt;
margin-left:.5pt;text-indent:-.5pt'><b>With cube </b><span style='font-size:
11.0pt;line-height:110%'><img border=0 width=718 height=60
src="SQL%20Notes%20for%20Professionals_files/image111.gif"></span><span
style='font-size:9.0pt;line-height:110%;color:blue'>group</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>by</span><span style='font-size:9.0pt;line-height:
110%'> Food</span><span style='font-size:9.0pt;line-height:110%;color:gray'>,</span><span
style='font-size:9.0pt;line-height:110%'>Brand</span><span style='font-size:
9.0pt;line-height:110%;color:gray'>,</span><span style='font-size:9.0pt;
line-height:110%'>Total_amount </span><span style='font-size:9.0pt;line-height:
110%;color:blue'>with</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:blue'>cube</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Food Brand Total_amount</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:.25pt'>Pasta Brand1 100</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:.25pt'>Pasta Brand2 250</p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'>Pasta ALL 350</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:.25pt'>Pizza Brand2 300</p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'>Pizza ALL 300</p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'>ALL Brand1
100</p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'>ALL Brand2
550</p>

<p class=MsoNormal style='margin-bottom:4.05pt;text-indent:0in'>ALL ALL 650</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:1.75pt;
margin-left:.5pt;text-indent:-.5pt'><b>With roll up </b><span style='font-size:
11.0pt;line-height:110%'><img border=0 width=718 height=60
src="SQL%20Notes%20for%20Professionals_files/image112.gif"></span><span
style='font-size:9.0pt;line-height:110%;color:blue'>group</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>by</span><span style='font-size:9.0pt;line-height:
110%'> Food</span><span style='font-size:9.0pt;line-height:110%;color:gray'>,</span><span
style='font-size:9.0pt;line-height:110%'>Brand</span><span style='font-size:
9.0pt;line-height:110%;color:gray'>,</span><span style='font-size:9.0pt;
line-height:110%'>Total_amount </span><span style='font-size:9.0pt;line-height:
110%;color:blue'>with</span><span style='font-size:9.0pt;line-height:110%'>
roll up</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Food Brand Total_amount</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:.25pt'>Pasta Brand1 100</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:.25pt'>Pasta Brand2 250</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Pizza Brand2 300</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=111
 style='width:83.2pt;margin-left:1.0pt;border-collapse:collapse'>
 <tr style='height:13.65pt'>
  <td width=88 valign=top style='width:66.05pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Pasta
  ALL</p>
  </td>
  <td width=23 valign=top style='width:17.15pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>350</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=88 valign=top style='width:66.05pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Pizza
  ALL</p>
  </td>
  <td width=23 valign=top style='width:17.15pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>300</p>
  </td>
 </tr>
 <tr style='height:13.65pt'>
  <td width=88 valign=top style='width:66.05pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>ALL ALL</p>
  </td>
  <td width=23 valign=top style='width:17.15pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>650</p>
  </td>
 </tr>
</table>

<h1 style='margin-left:-.25pt'><a name="_Toc228527">Chapter 8: ORDER BY</a></h1>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228528">Section 8.1: Sorting by column number (instead of
name)</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.7pt;
margin-left:.25pt'>You can use a column's number (where the leftmost column is
'1') to indicate which column to base the sort on, instead of describing the
column by its name.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:13.3pt;
margin-left:.25pt'><b>Pro:</b> If you think it's likely you might change column
names later, doing so won't break this code.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.85pt;
margin-left:.25pt'><b>Con:</b> This will generally reduce readability of the
query (It's instantly clear what 'ORDER BY Reputation' means, while</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>'ORDER BY 14' requires some counting, probably with a finger
on the screen.)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.95pt;
margin-left:.25pt'>This query sorts result by the info in relative column
position <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>3</span>
from select statement instead of column name <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>Reputation</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.6pt;
margin-left:.25pt'>SELECT DisplayName, JoinDate, Reputation FROM Users ORDER BY
3</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>DisplayName JoinDate
Reputation</b></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=203
 style='width:152.45pt;margin-left:1.0pt;border-collapse:collapse'>
 <tr style='height:13.65pt'>
  <td width=91 valign=top style='width:68.45pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Community</p>
  </td>
  <td width=112 valign=top style='width:84.0pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>2008-09-15
  <b>1</b></p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=91 valign=top style='width:68.45pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Jarrod
  Dixon</p>
  </td>
  <td width=112 valign=top style='width:84.0pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>2008-10-03 <b>11739</b></p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=91 valign=top style='width:68.45pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Geoff
  Dalgas</p>
  </td>
  <td width=112 valign=top style='width:84.0pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>2008-10-03 <b>12567</b></p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=91 valign=top style='width:68.45pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Joel
  Spolsky</p>
  </td>
  <td width=112 valign=top style='width:84.0pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>2008-09-16 <b>25784</b></p>
  </td>
 </tr>
 <tr style='height:13.65pt'>
  <td width=91 valign=top style='width:68.45pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Jeff
  Atwood</p>
  </td>
  <td width=112 valign=top style='width:84.0pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>2008-09-16 <b>37628</b></p>
  </td>
 </tr>
</table>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228529">Section 8.2: Use ORDER BY with TOP to return the
top x rows based on a column's value</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.45pt;
margin-left:.25pt'>In this example, we can use GROUP BY not only determined the
<i>sort</i> of the rows returned, but also what rows <i>are </i>returned, since
we're using TOP to limit the result set.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:13.05pt;
margin-left:.25pt'>Let's say we want to return the top 5 highest reputation
users from an unnamed popular Q&amp;A site.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Without ORDER BY</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.25pt;
margin-left:.25pt'>This query returns the Top 5 rows ordered by the default,
which in this case is &quot;Id&quot;, the first column in the table (even
though it's not a column shown in the results).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src="SQL%20Notes%20for%20Professionals_files/image113.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>returns...</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>DisplayName Reputation</b></p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'>Community 1</p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'>Geoff Dalgas 12567</p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'>Jarrod Dixon 11739</p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'>Jeff Atwood 37628</p>

<p class=MsoNormal style='margin-bottom:15.25pt;text-indent:0in'>Joel Spolsky 25784</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>With ORDER BY</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:0in;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=49
src="SQL%20Notes%20for%20Professionals_files/image114.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=21
src="SQL%20Notes%20for%20Professionals_files/image115.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>returns...</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>DisplayName Reputation</b></p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'>JonSkeet <b>865023</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.8pt;
margin-left:.25pt'>Darin Dimitrov <b>661741</b></p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'>BalusC <b>650237</b></p>

<p class=MsoNormal style='margin-bottom:3.8pt;text-indent:0in'>Hans Passant <b>625870</b></p>

<p class=MsoNormal style='margin-bottom:15.3pt;text-indent:0in'>Marc Gravell <b>601636</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.1pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Remarks</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.35pt;
margin-left:.25pt'>Some versions of SQL (such as MySQL) use a <span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>LIMIT</span>
clause at the end of a <span style='font-size:9.0pt;line-height:110%;
color:blue;background:#FAFAFA'>SELECT</span>, instead of <span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>TOP</span>
at the beginning, for example:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=76
src="SQL%20Notes%20for%20Professionals_files/image116.gif"></span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228530">Section 8.3: Customizeed sorting order</a></h2>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=137 style='width:102.6pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=137 valign=top style='width:102.6pt;background:#FAFAFA;padding:
  1.8pt 0in 0in 0in;height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:blue'>ORDER</span><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:blue'>BY</span><span style='font-size:9.0pt;line-height:107%'>
  Department</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.45pt;
margin-left:.25pt'>To sort this table <span style='font-size:9.0pt;line-height:
110%;background:#FAFAFA'>Employee</span> by department, you would use .
However, if you want a different sort order that is not alphabetical, you have
to map the <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Department</span>
values into different values that sort correctly; this can be done with a CASE
expression:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:413.85pt;margin-bottom:
3.5pt;margin-left:.25pt;text-indent:0in;line-height:111%'><b>Name Department </b>Hasan
IT</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:.25pt'>Yusuf HR</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:.25pt'>Hillary HR</p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'>Joe IT</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.8pt;
margin-left:.25pt'>Merry HR</p>

<p class=MsoNormal style='margin-bottom:30.1pt;text-indent:0in'>Ken Accountant</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><img width=718 height=1
src="SQL%20Notes%20for%20Professionals_files/image117.gif" align=left
hspace=12><span style='font-size:9.0pt;line-height:110%;color:blue'>ORDER</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>BY</span><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:blue'>CASE</span><span
style='font-size:9.0pt;line-height:110%'> Department</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:blue'>WHEN</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:red'>'HR'</span><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:blue'>THEN</span><span
style='font-size:9.0pt;line-height:110%'> 1</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:26.95pt;margin-bottom:
.1pt;margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:
110%;color:blue'>WHEN</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:red'>'Accountant'</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>THEN</span><span style='font-size:9.0pt;
line-height:110%'> 2</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:18.35pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:blue'>ELSE</span><span
style='font-size:9.0pt;line-height:110%'> 3</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:417.25pt;margin-bottom:
3.5pt;margin-left:.25pt;text-indent:0in;line-height:111%'><b>Name Department </b>Yusuf
<b>HR</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.8pt;
margin-left:.25pt'>Hillary <b>HR</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.8pt;
margin-left:.25pt'>Merry <b>HR</b></p>

<p class=MsoNormal style='margin-bottom:3.75pt;text-indent:0in;line-height:
111%'>Ken <b>Accountant</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.8pt;
margin-left:.25pt'>Hasan <b>IT</b></p>

<p class=MsoNormal style='margin-bottom:20.8pt;text-indent:0in'>Joe <b>IT</b></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228531">Section 8.4: Order by Alias</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Due to logical query processing order, alias can be used in
order by.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="SQL%20Notes%20for%20Professionals_files/image118.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.25pt;
margin-left:.25pt'>And can use relative order of the columns in the select
statement .Consider the same example as above and instead of using alias use
the relative order like for display name it is 1 , for Jd it is 2 and so on</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="SQL%20Notes%20for%20Professionals_files/image119.gif"></span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228532">Section 8.5: Sorting by multiple columns</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.6pt;
margin-left:.25pt'>SELECT DisplayName, JoinDate, Reputation FROM Users ORDER BY
JoinDate, Reputation</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>DisplayName JoinDate
Reputation</b></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=203
 style='width:152.45pt;margin-left:1.0pt;border-collapse:collapse'>
 <tr style='height:13.65pt'>
  <td width=91 valign=top style='width:68.45pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Community</p>
  </td>
  <td width=112 valign=top style='width:84.0pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><b>2008-09-15
  1</b></p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=91 valign=top style='width:68.45pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Jeff
  Atwood</p>
  </td>
  <td width=112 valign=top style='width:84.0pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><b>2008-09-16 25784</b></p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=91 valign=top style='width:68.45pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Joel
  Spolsky</p>
  </td>
  <td width=112 valign=top style='width:84.0pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>2008-09-16 <b>37628</b></p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=91 valign=top style='width:68.45pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Jarrod
  Dixon</p>
  </td>
  <td width=112 valign=top style='width:84.0pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><b>2008-10-03 11739</b></p>
  </td>
 </tr>
 <tr style='height:13.65pt'>
  <td width=91 valign=top style='width:68.45pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Geoff
  Dalgas</p>
  </td>
  <td width=112 valign=top style='width:84.0pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>2008-10-03 <b>12567</b></p>
  </td>
 </tr>
</table>

<span style='font-size:10.0pt;line-height:110%;font-family:"Calibri",sans-serif;
color:black'><br clear=all style='page-break-before:always'>
</span>

<p class=MsoNormal>&nbsp;</p>

<h1 style='margin-left:-.25pt'><a name="_Toc228533">Chapter 9: AND &amp; OR
Operators</a></h1>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228534">Section 9.1: AND OR Example</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>Have a table</p>

<p class=MsoNormal style='margin-bottom:.95pt;text-indent:0in;line-height:111%'><b>Name
Age City</b></p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'>Bob 10 Paris</p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'>Mat 20 Berlin</p>

<p class=MsoNormal style='text-indent:0in'>Mary 24 Prague</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image120.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.3pt;
margin-left:.25pt'>Gives</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Name</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:4.55pt;
margin-left:.25pt'>Mary</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image121.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.3pt;
margin-left:.25pt'>Gives</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Name</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.3pt;
margin-left:.25pt'>Bob</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Mary<br clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc228535">Chapter 10: CASE</a></h1>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:18.55pt;
margin-left:.25pt'>The CASE expression is used to implement if-then logic.</p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228536">Section 10.1: Use CASE to COUNT the number of rows
in a column match a condition</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.05pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Use Case</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.6pt;
margin-left:.25pt'><span style='font-size:9.0pt;line-height:110%;color:blue;
background:#FAFAFA'>CASE</span> can be used in conjunction with <span
style='font-size:9.0pt;line-height:110%;color:fuchsia;background:#FAFAFA'>SUM</span>
to return a count of only those items matching a pre-defined condition. (This
is similar to <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>COUNTIF</span>
in Excel.)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.55pt;
margin-left:.25pt'>The trick is to return binary results indicating matches, so
the &quot;1&quot;s returned for matching entries can be summed for a count of
the total number of matches.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.45pt;
margin-left:.25pt'>Given this table <span style='font-size:9.0pt;line-height:
110%;background:#FAFAFA'>ItemSales</span>, let's say you want to learn the
total number of items that have been categorized as &quot;Expensive&quot;:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Id ItemId Price
PriceRating</b></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=180
 style='width:135.05pt;margin-left:1.0pt;border-collapse:collapse'>
 <tr style='height:13.65pt'>
  <td width=62 valign=top style='width:46.65pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>1
  100</p>
  </td>
  <td width=118 valign=top style='width:88.4pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>34.5
  EXPENSIVE</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=62 valign=top style='width:46.65pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>2
  145</p>
  </td>
  <td width=118 valign=top style='width:88.4pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>2.3 CHEAP</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=62 valign=top style='width:46.65pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>3
  100</p>
  </td>
  <td width=118 valign=top style='width:88.4pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>34.5
  EXPENSIVE</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=62 valign=top style='width:46.65pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>4
  100</p>
  </td>
  <td width=118 valign=top style='width:88.4pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>34.5
  EXPENSIVE</p>
  </td>
 </tr>
 <tr style='height:13.65pt'>
  <td width=62 valign=top style='width:46.65pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>5
  145</p>
  </td>
  <td width=118 valign=top style='width:88.4pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>10 AFFORDABLE</p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Query</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=142
src="SQL%20Notes%20for%20Professionals_files/image122.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Results:</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>ItemsCount
ExpensiveItemsCount</b></p>

<p class=MsoNormal style='margin-bottom:15.05pt;text-indent:0in'>5 3</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Alternative:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:0in;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=158
src="SQL%20Notes%20for%20Professionals_files/image123.gif"></span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228537">Section 10.2: Searched CASE in SELECT (Matches a
boolean expression)</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>The <i>searched</i> CASE returns results when a <i>boolean</i>
expression is TRUE.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>(This differs from the simple case, which can only check for
equivalency with an input.)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:6.15pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=168
src="SQL%20Notes%20for%20Professionals_files/image124.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=180
 style='width:135.05pt;margin-left:1.0pt;border-collapse:collapse'>
 <tr style='height:13.65pt'>
  <td width=62 valign=top style='width:46.65pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>3
  100</p>
  </td>
  <td width=118 valign=top style='width:88.4pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>34.5
  EXPENSIVE</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=62 valign=top style='width:46.65pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>4
  100</p>
  </td>
  <td width=118 valign=top style='width:88.4pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>34.5
  EXPENSIVE</p>
  </td>
 </tr>
 <tr style='height:13.65pt'>
  <td width=62 valign=top style='width:46.65pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>5
  145</p>
  </td>
  <td width=118 valign=top style='width:88.4pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>10 AFFORDABLE</p>
  </td>
 </tr>
</table>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228538">Section 10.3: CASE in a clause ORDER BY</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>We can use 1,2,3.. to determine the type of order:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:3.4pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=193
src="SQL%20Notes%20for%20Professionals_files/image125.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=342
 style='width:256.55pt;margin-left:1.0pt;border-collapse:collapse'>
 <tr style='height:13.65pt'>
  <td width=327 colspan=2 valign=top style='width:245.1pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>12
  New England Boston MARKETING</p>
  </td>
  <td width=15 valign=top style='width:11.45pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>9</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=105 valign=top style='width:79.0pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>15
  West</p>
  </td>
  <td width=221 valign=top style='width:166.1pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>San
  Francisco MARKETING</p>
  </td>
  <td width=15 valign=top style='width:11.45pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>12</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=105 valign=top style='width:79.0pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>9 Midwest</p>
  </td>
  <td width=221 valign=top style='width:166.1pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chicago SALES</p>
  </td>
  <td width=15 valign=top style='width:11.45pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>8</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=105 valign=top style='width:79.0pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>14
  Mid-Atlantic</p>
  </td>
  <td width=221 valign=top style='width:166.1pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>New
  York SALES</p>
  </td>
  <td width=15 valign=top style='width:11.45pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>12</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=105 valign=top style='width:79.0pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>5 West</p>
  </td>
  <td width=221 valign=top style='width:166.1pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Los
  Angeles RESEARCH</p>
  </td>
  <td width=15 valign=top style='width:11.45pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>11</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=105 valign=top style='width:79.0pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>10
  Mid-Atlantic</p>
  </td>
  <td width=221 valign=top style='width:166.1pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Philadelphia RESEARCH</p>
  </td>
  <td width=15 valign=top style='width:11.45pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>13</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=105 valign=top style='width:79.0pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>4 Midwest</p>
  </td>
  <td width=221 valign=top style='width:166.1pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chicago INNOVATION</p>
  </td>
  <td width=15 valign=top style='width:11.45pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>11</p>
  </td>
 </tr>
 <tr style='height:13.65pt'>
  <td width=105 valign=top style='width:79.0pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>2 Midwest</p>
  </td>
  <td width=237 colspan=2 valign=top style='width:177.55pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Detroit HUMAN
  RESOURCES 9</p>
  </td>
 </tr>
</table>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228539">Section 10.4: Shorthand CASE in SELECT</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.3pt;
margin-left:.25pt'><span style='font-size:9.0pt;line-height:110%;color:blue;
background:#FAFAFA'>CASE</span>'s shorthand variant evaluates an expression
(usually a column) against a series of values. This variant is a bit shorter,
and saves repeating the evaluated expression over and over again. The <span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>ELSE</span>
clause can still be used, though:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:0in;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=62
src="SQL%20Notes%20for%20Professionals_files/image126.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=54
src="SQL%20Notes%20for%20Professionals_files/image127.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.35pt;
margin-left:.25pt'>A word of caution. It's important to realize that when using
the short variant the entire statement is evaluated at each <span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>WHEN</span>.
Therefore the following statement:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:15.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=125
src="SQL%20Notes%20for%20Professionals_files/image128.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=36 style='width:27.0pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=36 valign=top style='width:27.0pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:fuchsia'>NEWID</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.35pt;
margin-left:.25pt'>may produce a <span style='font-size:9.0pt;line-height:110%;
color:#333399;background:#FAFAFA'>NULL</span> result. That is because at each <span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>WHEN</span>
<span style='font-size:9.0pt;line-height:110%;color:gray;background:#FAFAFA'>()</span>
is being called again with a new result. Equivalent to:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:15.1pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=125
src="SQL%20Notes%20for%20Professionals_files/image129.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:203.9pt;margin-bottom:
.2pt;margin-left:.25pt;line-height:146%'>Therefore it can miss all the <span
style='font-size:9.0pt;line-height:146%;color:blue;background:#FAFAFA'>WHEN</span>
cases and result as <span style='font-size:9.0pt;line-height:146%;color:#333399;
background:#FAFAFA'>NULL</span>.</p>

<h2 style='margin-top:0in;margin-right:203.9pt;margin-bottom:.2pt;margin-left:
.25pt;text-indent:.5pt;line-height:146%'><a name="_Toc228540">Section 10.5:
Using CASE in UPDATE</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>sample on price increases:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=142
src="SQL%20Notes%20for%20Professionals_files/image130.gif"></span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228541">Section 10.6: CASE use for NULL values ordered
last</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.25pt;
margin-left:.25pt'>in this way '0' representing the known values are ranked
first, '1' representing the NULL values are sorted by the last:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:0in;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=191
src="SQL%20Notes%20for%20Professionals_files/image131.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=468
 style='width:351.1pt;margin-left:1.0pt;border-collapse:collapse'>
 <tr style='height:12.3pt'>
  <td width=327 valign=top style='width:245.1pt;padding:0in 0in 0in 0in;
  height:12.3pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><b>ID REGION CITY DEPARTMENT</b></p>
  </td>
  <td width=141 valign=top style='width:106.0pt;padding:0in 0in 0in 0in;
  height:12.3pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><b>EMPLOYEES_NUMBER</b></p>
  </td>
 </tr>
 <tr style='height:15.4pt'>
  <td width=327 valign=top style='width:245.1pt;padding:0in 0in 0in 0in;
  height:15.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>10
  Mid-Atlantic Philadelphia RESEARCH</p>
  </td>
  <td width=141 valign=top style='width:106.0pt;padding:0in 0in 0in 0in;
  height:15.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>13</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=327 valign=top style='width:245.1pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>14
  Mid-Atlantic New York SALES</p>
  </td>
  <td width=141 valign=top style='width:106.0pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>12</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=327 valign=top style='width:245.1pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>9 Midwest Chicago SALES</p>
  </td>
  <td width=141 valign=top style='width:106.0pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>8</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=327 valign=top style='width:245.1pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>12
  New England Boston MARKETING</p>
  </td>
  <td width=141 valign=top style='width:106.0pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>9</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=327 valign=top style='width:245.1pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>5 West Los
  Angeles RESEARCH</p>
  </td>
  <td width=141 valign=top style='width:106.0pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>11</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=327 valign=top style='width:245.1pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>15
  NULL San Francisco MARKETING</p>
  </td>
  <td width=141 valign=top style='width:106.0pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>12</p>
  </td>
 </tr>
 <tr style='height:13.65pt'>
  <td width=327 valign=top style='width:245.1pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>4 NULL Chicago INNOVATION</p>
  </td>
  <td width=141 valign=top style='width:106.0pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>11</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=468 colspan=2 valign=bottom style='width:351.1pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>2 NULL Detroit HUMAN
  RESOURCES 9</p>
  </td>
 </tr>
</table>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228542">Section 10.7: CASE in ORDER BY clause to sort
records by lowest value of 2 columns</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.65pt;
margin-left:.25pt'>Imagine that you need sort records by lowest value of either
one of two columns. Some databases could use a non-</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=426 style='width:319.25pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=22 valign=top style='width:16.2pt;background:#FAFAFA;padding:1.0pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:fuchsia'>MIN</span></p>
  </td>
  <td width=35 valign=top style='width:26.1pt;padding:1.0pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:gray;background:#FAFAFA'>()</span> or </p>
  </td>
  <td width=36 valign=top style='width:27.0pt;background:#FAFAFA;padding:1.0pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>LEAST</span></p>
  </td>
  <td width=124 valign=top style='width:93.3pt;padding:1.0pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:gray;background:#FAFAFA'>()</span> function for
  this (</p>
  </td>
  <td width=115 valign=top style='width:1.2in;background:#FAFAFA;padding:1.0pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:gray'>...</span><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:blue'>ORDER</span><span style='font-size:9.0pt;line-height:107%'> </span><span
  style='font-size:9.0pt;line-height:107%;color:blue'>BY</span><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:fuchsia'>MIN</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.0pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:gray;background:#FAFAFA'>(</span></p>
  </td>
  <td width=36 valign=top style='width:27.0pt;background:#FAFAFA;padding:1.0pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>Date1</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.0pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:gray;background:#FAFAFA'>,</span></p>
  </td>
  <td width=43 valign=top style='width:.45in;background:#FAFAFA;padding:1.0pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>Date2</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.7pt;
margin-left:.25pt'>aggregated <span style='font-size:9.0pt;line-height:110%;
color:gray;background:#FAFAFA'>)</span>), but in standard SQL, you have to use
a <span style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>CASE</span>
expression.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.7pt;
margin-left:.25pt'>The <span style='font-size:9.0pt;line-height:110%;
color:blue;background:#FAFAFA'>CASE</span> expression in the query below looks
at the <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Date1</span>
and <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Date2</span>
columns, checks which column has the lower value, and sorts the records
depending on this value.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Sample data</b></p>

<p class=MsoNormal style='margin-bottom:.95pt;text-indent:0in;line-height:111%'><b>Id Date1 Date2</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:.25pt'><span style='line-height:110%'>1<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>2017-01-01 2017-01-31</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:.25pt'><span style='line-height:110%'>2<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>2017-01-31 2017-01-03</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:.25pt'><span style='line-height:110%'>3<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>2017-01-31 2017-01-02</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:.25pt'><span style='line-height:110%'>4<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>2017-01-06 2017-01-31</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:.25pt'><span style='line-height:110%'>5<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>2017-01-31 2017-01-05</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:11.75pt;
margin-left:.25pt;line-height:143%'><span style='line-height:143%'>6<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>2017-01-04 2017-01-31 <b>Query</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><img width=718 height=1
src="SQL%20Notes%20for%20Professionals_files/image117.gif" align=left
hspace=12><span style='font-size:9.0pt;line-height:110%;color:blue'>FROM</span><span
style='font-size:9.0pt;line-height:110%'> YourTable</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:43.25pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%;color:blue'>ORDER</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:blue'>BY</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>CASE</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Results</b></p>

<p class=MsoNormal style='margin-bottom:.95pt;text-indent:0in;line-height:111%'><b>Id Date1 Date2</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:412.4pt;margin-bottom:
.2pt;margin-left:.25pt;line-height:141%'><span style='line-height:141%'>1<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><b>2017-01-01 </b>2017-01-31 3 2017-01-31 <b>2017-01-02</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:412.4pt;margin-bottom:
.2pt;margin-left:.25pt;line-height:141%'><span style='line-height:141%'>2<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>2017-01-31 <b>2017-01-03 </b>6 <b>2017-01-04 </b>2017-01-31 5
2017-01-31 <b>2017-01-05</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:4.1pt;
margin-left:.25pt'>4 <b>2017-01-06 </b>2017-01-31</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.05pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Explanation</b></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=22 style='width:16.2pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=22 valign=top style='width:16.2pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>Id </span></p>
  </td>
 </tr>
</table>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=72 style='width:.75in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>2017</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:gray;background:#FAFAFA'>-</span></p>
  </td>
  <td width=14 valign=top style='width:.15in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>01</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:gray;background:#FAFAFA'>-</span></p>
  </td>
  <td width=14 valign=top style='width:.15in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>01</span></p>
  </td>
 </tr>
</table>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=22 style='width:16.2pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=22 valign=top style='width:16.2pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>Id </span></p>
  </td>
 </tr>
</table>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=72 style='width:.75in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>2017</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:gray;background:#FAFAFA'>-</span></p>
  </td>
  <td width=14 valign=top style='width:.15in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>01</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:gray;background:#FAFAFA'>-</span></p>
  </td>
  <td width=14 valign=top style='width:.15in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>02</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.55pt;
margin-left:16.45pt;text-indent:-16.2pt'><span style='position:relative;
z-index:-1895804928'><span style='left:0px;position:absolute;left:156px;
top:-8890px;width:7px;height:1px'><img width=7 height=1
src="SQL%20Notes%20for%20Professionals_files/image132.gif"></span></span><span
style='position:relative;z-index:-1895803904'><span style='left:0px;position:
absolute;left:29px;top:-8890px;width:7px;height:1px'><img width=7 height=1
src="SQL%20Notes%20for%20Professionals_files/image133.gif"></span></span>As you
see row with <span style='font-size:9.0pt;line-height:110%;color:gray;
background:#FAFAFA'>=</span><span style='font-size:9.0pt;line-height:110%'> <span
style='background:#FAFAFA'>1</span></span> is first, that because <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Date1</span> have
lowest record from entire table , row where <span style='font-size:9.0pt;
line-height:110%;color:gray;background:#FAFAFA'>=</span><span style='font-size:
9.0pt;line-height:110%'> <span style='background:#FAFAFA'>3</span></span> is
second that because <span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>Date2</span> equals to that is second lowest value from table and so
on.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=164 style='width:122.8pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>2017</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:gray;background:#FAFAFA'>-</span></p>
  </td>
  <td width=14 valign=top style='width:.15in;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>01</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:gray;background:#FAFAFA'>-</span></p>
  </td>
  <td width=14 valign=top style='width:.15in;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>01</span></p>
  </td>
  <td width=20 valign=top style='width:14.75pt;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>to </p>
  </td>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>2017</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:gray;background:#FAFAFA'>-</span></p>
  </td>
  <td width=14 valign=top style='width:.15in;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>01</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:gray;background:#FAFAFA'>-</span></p>
  </td>
  <td width=14 valign=top style='width:.15in;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>06</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.85pt;
margin-left:.25pt'>So we have sorted records from ascending and no care on
which one column <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Date1</span>
or</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'><span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>Date2</span> are those values.</p>

<h1 style='margin-left:-.25pt'><a name="_Toc228543">Chapter 11: LIKE operator</a></h1>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228544">Section 11.1: Match open-ended pattern</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.45pt;
margin-left:.25pt'>The <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>%</span> wildcard appended to the beginning or end (or
both) of a string will allow 0 or more of any character before the beginning or
after the end of the pattern to match.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>Using '%' in the middle will allow 0 or more characters
between the two parts of the pattern to match.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>We are going to use this Employees Table:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Id FName LName
PhoneNumber ManagerId DepartmentId Salary Hire_date</b></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=514
 style='width:385.25pt;margin-left:1.0pt;border-collapse:collapse'>
 <tr style='height:13.65pt'>
  <td width=229 valign=top style='width:171.5pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>1
  John Johnson 2468101214</p>
  </td>
  <td width=172 valign=top style='width:128.65pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>1 1</p>
  </td>
  <td width=44 valign=top style='width:32.85pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>400</p>
  </td>
  <td width=70 valign=top style='width:52.2pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>23-03-2005</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=229 valign=top style='width:171.5pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>2
  Sophie Amudsen 2479100211</p>
  </td>
  <td width=172 valign=top style='width:128.65pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>1 1</p>
  </td>
  <td width=44 valign=top style='width:32.85pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>400</p>
  </td>
  <td width=70 valign=top style='width:52.2pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>11-01-2010</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=229 valign=top style='width:171.5pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>3
  Ronny Smith 2462544026</p>
  </td>
  <td width=172 valign=top style='width:128.65pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>2 1</p>
  </td>
  <td width=44 valign=top style='width:32.85pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>600</p>
  </td>
  <td width=70 valign=top style='width:52.2pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>06-08-2015</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=229 valign=top style='width:171.5pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>4
  Jon Sanchez 2454124602</p>
  </td>
  <td width=172 valign=top style='width:128.65pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>1 1</p>
  </td>
  <td width=44 valign=top style='width:32.85pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>400</p>
  </td>
  <td width=70 valign=top style='width:52.2pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>23-03-2005</p>
  </td>
 </tr>
 <tr style='height:13.65pt'>
  <td width=229 valign=top style='width:171.5pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>5
  Hilde Knag 2468021911</p>
  </td>
  <td width=172 valign=top style='width:128.65pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>2 1</p>
  </td>
  <td width=44 valign=top style='width:32.85pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>800</p>
  </td>
  <td width=70 valign=top style='width:52.2pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>01-01-2000</p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:14.7pt;
margin-left:.25pt'>Following statement matches for all records having FName <b>containing</b>
string 'on' from Employees Table.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.05pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='position:relative;z-index:
-1895802880'><span style='left:0px;position:absolute;left:0px;top:-9381px;
width:718px;height:1px'><img width=718 height=1
src="SQL%20Notes%20for%20Professionals_files/image134.gif"></span></span><span
style='font-size:9.0pt;line-height:110%;color:blue'>SELECT</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:gray'>*</span><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:blue'>FROM</span><span
style='font-size:9.0pt;line-height:110%'> Employees </span><span
style='font-size:9.0pt;line-height:110%;color:blue'>WHERE</span><span
style='font-size:9.0pt;line-height:110%'> FName </span><span style='font-size:
9.0pt;line-height:110%;color:#333399'>LIKE</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:red'>'%on%'</span><span style='font-size:9.0pt;line-height:110%;
color:gray'>;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Id FName LName
PhoneNumber ManagerId DepartmentId Salary Hire_date</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:11.9pt;text-indent:-11.65pt'><span style='line-height:110%'>3<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>R<b>on</b>ny
Smith 2462544026 2 1 600 06-08-2015</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:15.3pt;
margin-left:11.9pt;text-indent:-11.65pt'><span style='line-height:110%'>4<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>J<b>on </b>Sanchez
2454124602 1 1 400 23-03-2005</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:14.7pt;
margin-left:.25pt'>Following statement matches all records having PhoneNumber <b>starting
with</b> string '246' from Employees.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.05pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='position:relative;z-index:
-1895801856'><span style='left:0px;position:absolute;left:0px;top:-9529px;
width:718px;height:1px'><img width=718 height=1
src="SQL%20Notes%20for%20Professionals_files/image135.gif"></span></span><span
style='font-size:9.0pt;line-height:110%;color:blue'>SELECT</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:gray'>*</span><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:blue'>FROM</span><span
style='font-size:9.0pt;line-height:110%'> Employees </span><span
style='font-size:9.0pt;line-height:110%;color:blue'>WHERE</span><span
style='font-size:9.0pt;line-height:110%'> PhoneNumber </span><span
style='font-size:9.0pt;line-height:110%;color:#333399'>LIKE</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:red'>'246%'</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Id FName LName
PhoneNumber ManagerId DepartmentId Salary Hire_date</b></p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'>1 John Johnson
<b>246</b>8101214 1 1 400 23-03-2005</p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'>3 Ronny Smith <b>246</b>2544026 2 1 600 06-08-2015</p>

<p class=MsoNormal style='margin-bottom:15.3pt;text-indent:0in'>5 Hilde Knag <b>246</b>8021911 2 1 800 01-01-2000</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:14.7pt;
margin-left:.25pt'>Following statement matches all records having PhoneNumber <b>ending
with</b> string '11' from Employees.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.05pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='position:relative;z-index:
-1895800832'><span style='left:0px;position:absolute;left:0px;top:-9702px;
width:718px;height:1px'><img width=718 height=1
src="SQL%20Notes%20for%20Professionals_files/image134.gif"></span></span><span
style='font-size:9.0pt;line-height:110%;color:blue'>SELECT</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:gray'>*</span><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:blue'>FROM</span><span
style='font-size:9.0pt;line-height:110%'> Employees </span><span
style='font-size:9.0pt;line-height:110%;color:blue'>WHERE</span><span
style='font-size:9.0pt;line-height:110%'> PhoneNumber </span><span
style='font-size:9.0pt;line-height:110%;color:#333399'>LIKE</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:red'>'%11'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Id FName LName
PhoneNumber ManagerId DepartmentId Salary Hire_date</b></p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'>2 Sophie
Amudsen 24791002<b>11 </b>1 1 400 11-01-2010</p>

<p class=MsoNormal style='margin-bottom:15.3pt;text-indent:0in'>5 Hilde Knag 24680219<b>11 </b>2 1 800 01-01-2000</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>All records where Fname <b>3rd character</b> is 'n' from
Employees.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image136.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>(two underscores are used before 'n' to skip first 2
characters)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Id FName LName
PhoneNumber ManagerId DepartmentId Salary Hire_date</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:11.9pt;text-indent:-11.65pt'><span style='line-height:110%'>3<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Ronny Smith 2462544026 2 1 600 06-08-2015</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:11.9pt;text-indent:-11.65pt'><span style='line-height:110%'>4<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Jon Sanchez
2454124602 1 1 400 23-03-2005</p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228545">Section 11.2: Single character match</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.5pt;
margin-left:.25pt'>To broaden the selections of a structured query language
(SQL-SELECT) statement, wildcard characters, the percent sign (%) and the
underscore (_), can be used.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>The <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>_</span> (underscore) character can be used as a wildcard
for any single character in a pattern match.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Find all employees whose Fname start with 'j' and end with
'n' and has exactly 3 characters in Fname.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image137.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'><span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>_</span> (underscore) character can also be used more than once as a
wild card to match patterns.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>For example, this pattern would match &quot;jon&quot;,
&quot;jan&quot;, &quot;jen&quot;, etc.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.45pt;
margin-left:.25pt'>These names will not be shown
&quot;jn&quot;,&quot;john&quot;,&quot;jordan&quot;, &quot;justin&quot;,
&quot;jason&quot;, &quot;julian&quot;, &quot;jillian&quot;, &quot;joann&quot;
because in our query one underscore is used and it can skip exactly one character,
so result must be of 3 character Fname.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>For example, this pattern would match &quot;LaSt&quot;,
&quot;LoSt&quot;, &quot;HaLt&quot;, etc.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image138.gif"></span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228546">Section 11.3: ESCAPE statement in the LIKE-query</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>If you implement a text-search as <span style='font-size:
9.0pt;line-height:110%;color:#333399;background:#FAFAFA'>LIKE</span>-query, you
usually do it like this:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:15.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="SQL%20Notes%20for%20Professionals_files/image139.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.5pt;
margin-left:.25pt'>However, (apart from the fact that you shouldn't necessarely
use <span style='font-size:9.0pt;line-height:110%;color:#333399;background:
#FAFAFA'>LIKE</span> when you can use fulltext-search) this creates a problem
when somebody inputs text like &quot;50%&quot; or &quot;a_b&quot;.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>So (instead of switching to fulltext-search), you can solve
that problem using the <span style='font-size:9.0pt;line-height:110%;
color:#333399;background:#FAFAFA'>LIKE</span>-escape statement:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="SQL%20Notes%20for%20Professionals_files/image140.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.6pt;
margin-left:.25pt'>That means <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>\</span> will now be treated as ESCAPE character. This
means, you can now just prepend <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>\</span> to every character in the string you search, and
the results will start to be correct, even when the user enters a special
character like <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>%
</span>or <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>_</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>e.g.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=125
src="SQL%20Notes%20for%20Professionals_files/image141.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.6pt;
margin-left:.25pt'>Note: The above algorithm is for demonstration purposes
only. It will not work in cases where 1 grapheme consists</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=331 style='width:3.45in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=158 valign=top style='width:1.65in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>string stringToSearch </span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:gray;background:#FAFAFA'>=</span></p>
  </td>
  <td width=166 valign=top style='width:124.2pt;background:#FAFAFA;padding:
  1.8pt 0in 0in 0in;height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>&quot;Les Mise\u0301rables&quot;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.6pt;
margin-left:.25pt'>out of several characters (utf-8). e.g. <span
style='font-size:9.0pt;line-height:110%;color:gray;background:#FAFAFA'>;</span>
You'll need to do this for each grapheme, not for each character. You should
not use the above algorithm if you're dealing with</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.45pt;
margin-left:.25pt'>Asian/East-Asian/South-Asian languages. Or rather, if you
want correct code to begin with, you should just do that for each
graphemeCluster.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:142.6pt;margin-bottom:
0in;margin-left:-.25pt;text-indent:-.5pt;line-height:145%'>See also <a
href="https://stackoverflow.com/questions/1009689/reversestring-a-c-sharp-interview-question/36312251#36312251"><span
style='color:#F31D19'>ReverseString, a C# interview-question</span></a></p>

<h2 style='margin-top:0in;margin-right:142.6pt;margin-bottom:0in;margin-left:
-.25pt;line-height:145%'><a name="_Toc228547">Section 11.4: Search for a range
of characters</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Following statement matches all records having FName that
starts with a letter from A to F from Employees Table.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image142.gif"></span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228548">Section 11.5: Match by range or set</a></h2>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=43 style='width:.45in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=43 valign=top style='width:.45in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>abcdef</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.85pt;
margin-left:.25pt'>Match any single character within the specified range (e.g.:
<span style='font-size:9.0pt;line-height:110%;color:gray;background:#FAFAFA'>[</span><span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>a</span><span
style='font-size:9.0pt;line-height:110%;color:gray;background:#FAFAFA'>-</span><span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>f</span><span
style='font-size:9.0pt;line-height:110%;color:gray;background:#FAFAFA'>]</span>)
or set (e.g.: <span style='font-size:9.0pt;line-height:110%;color:gray;
background:#FAFAFA'>[]</span>).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>This range pattern would match &quot;gary&quot; but not
&quot;mary&quot;:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image143.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>This set pattern would match &quot;mary&quot; but not
&quot;gary&quot;:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image144.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>The range or set can also be negated by appending the <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>^</span> caret
before the range or set:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>This range pattern would <i>not</i> match &quot;gary&quot;
but will match &quot;mary&quot;:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image145.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>This set pattern would <i>not</i> match &quot;mary&quot; but
will match&quot;gary&quot;:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image146.gif"></span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228549">Section 11.6: Wildcard characters</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt;line-height:215%'>wildcard characters are used with the SQL
LIKE operator. SQL wildcards are used to search for data within a table.
Wildcards in SQL are:%, _, [charlist], [^charlist]</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'><b>%</b> - A substitute for zero or more characters</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=125
src="SQL%20Notes%20for%20Professionals_files/image147.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'><b>_</b> - A substitute for a single character</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:0in;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=57
src="SQL%20Notes%20for%20Professionals_files/image148.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=21
src="SQL%20Notes%20for%20Professionals_files/image149.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'><b>[charlist]</b> - Sets and ranges of characters to match</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=125
src="SQL%20Notes%20for%20Professionals_files/image150.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'><b>[^charlist]</b> - Matches only a character NOT specified
within the brackets</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:0in;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=142
src="SQL%20Notes%20for%20Professionals_files/image151.gif"></span><br
clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc228550">Chapter 12: IN clause</a></h1>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228551">Section 12.1: Simple IN clause</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>To get records having <b>any</b> of the given <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>id</span>s</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="SQL%20Notes%20for%20Professionals_files/image152.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>The query above is equal to</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=92
src="SQL%20Notes%20for%20Professionals_files/image153.gif"></span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:0in;margin-left:-.25pt'><a
name="_Toc228552">Section 12.2: Using IN clause with a subquery</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=109
src="SQL%20Notes%20for%20Professionals_files/image154.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>The above will give you all the customers that have orders
in the system.</p>

<h1 style='margin-left:-.25pt'><a name="_Toc228553">Chapter 13: Filter results
using WHERE and HAVING</a></h1>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228554">Section 13.1: Use BETWEEN to Filter Results</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:9.55pt;
margin-left:.25pt'>The following examples use the Item Sales and Customers
sample databases.</p>

<p class=MsoNormal style='margin-bottom:12.35pt;text-indent:0in'><span
style='font-size:11.0pt;line-height:110%'> <img border=0 width=3
height=51 id="Group 183163"
src="SQL%20Notes%20for%20Professionals_files/image155.gif"></span> Note:
The BETWEEN operator <i>is</i> inclusive.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Using the BETWEEN
operator with Numbers:</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:15.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src="SQL%20Notes%20for%20Professionals_files/image156.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.45pt;
margin-left:.25pt'>This query will return all <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>ItemSales</span> records that have a
quantity that is greater or equal to 10 and less than or equal to 17. The
results will look like:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Id SaleDate ItemId
Quantity Price</b></p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'>1 2013-07-01
100 10 34.5</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:11.9pt;text-indent:-11.65pt'><span style='line-height:110%'>4<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>2013-07-23
100 15 34.5</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:15.25pt;
margin-left:11.9pt;text-indent:-11.65pt'><span style='line-height:110%'>5<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>2013-07-24
145 10 34.5</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Using the BETWEEN
operator with Date Values:</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:15.1pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src="SQL%20Notes%20for%20Professionals_files/image157.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.45pt;
margin-left:.25pt'>This query will return all <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>ItemSales</span> records with a <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>SaleDate</span>
that is greater than or equal to July 11, 2013 and less than or equal to May
24, 2013.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Id SaleDate ItemId
Quantity Price</b></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=225
 style='width:168.5pt;margin-left:1.0pt;border-collapse:collapse'>
 <tr style='height:13.65pt'>
  <td width=136 valign=top style='width:102.1pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>3
  2013-07-11 100</p>
  </td>
  <td width=62 valign=top style='width:46.55pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>20</p>
  </td>
  <td width=26 valign=top style='width:19.8pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>34.5</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=136 valign=top style='width:102.1pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>4
  2013-07-23 100</p>
  </td>
  <td width=62 valign=top style='width:46.55pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>15</p>
  </td>
  <td width=26 valign=top style='width:19.8pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>34.5</p>
  </td>
 </tr>
 <tr style='height:13.65pt'>
  <td width=136 valign=top style='width:102.1pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>5
  2013-07-24 145</p>
  </td>
  <td width=62 valign=top style='width:46.55pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>10</p>
  </td>
  <td width=26 valign=top style='width:19.8pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>34.5</p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:15.75pt;margin-bottom:
23.9pt;margin-left:24.0pt'><img width=3 height=1
src="SQL%20Notes%20for%20Professionals_files/image158.gif" align=left
hspace=12>When comparing datetime values instead of dates, you may need to
convert the datetime values into a date values, or add or subtract 24 hours to
get the correct results.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Using the BETWEEN
operator with Text Values:</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src="SQL%20Notes%20for%20Professionals_files/image159.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>Live example: <a href="http://sqlfiddle.com/#!9/76b9b/2"><span
style='color:#F31D19'>SQL fiddle</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.45pt;
margin-left:.25pt'>This query will return all customers whose name
alphabetically falls between the letters 'D' and 'L'. In this case, Customer #1
and #3 will be returned. Customer #2, whose name begins with a 'M' will not be
included.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Id FName LName</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:456.15pt;margin-bottom:
16.95pt;margin-left:.25pt;line-height:141%'>1 William Jones 3 Richard Davis</p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228555">Section 13.2: Use HAVING with Aggregate Functions</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:24.15pt;
margin-left:.25pt'>Unlike the <span style='font-size:9.0pt;line-height:110%;
color:blue;background:#FAFAFA'>WHERE</span> clause, <span style='font-size:
9.0pt;line-height:110%;color:blue;background:#FAFAFA'>HAVING</span> can be used
with aggregate functions.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:23.7pt;
margin-left:24.0pt'><img width=3 height=1
src="SQL%20Notes%20for%20Professionals_files/image158.gif" align=left
hspace=12>An aggregate function is a function where the values of multiple rows
are grouped together as input on certain criteria to form a single value of
more significant meaning or measurement (<a
href="https://en.wikipedia.org/wiki/Aggregate_function"><span style='color:
#F31D19'>Wikipedia</span></a>).</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=191 style='width:143.6pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=36 valign=top style='width:27.0pt;background:#FAFAFA;padding:1.15pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:fuchsia'>COUNT</span></p>
  </td>
  <td width=21 valign=top style='width:15.85pt;padding:1.15pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:gray;background:#FAFAFA'>()</span>, </p>
  </td>
  <td width=22 valign=top style='width:16.2pt;background:#FAFAFA;padding:1.15pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:fuchsia'>SUM</span></p>
  </td>
  <td width=21 valign=top style='width:15.85pt;padding:1.15pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:gray;background:#FAFAFA'>()</span>, </p>
  </td>
  <td width=22 valign=top style='width:16.2pt;background:#FAFAFA;padding:1.15pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:fuchsia'>MIN</span></p>
  </td>
  <td width=48 valign=top style='width:36.3pt;padding:1.15pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:gray;background:#FAFAFA'>()</span>, and </p>
  </td>
  <td width=22 valign=top style='width:16.2pt;background:#FAFAFA;padding:1.15pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:fuchsia'>MAX</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.85pt;
margin-left:.25pt'>Common aggregate functions include <span style='font-size:
9.0pt;line-height:110%;color:gray;background:#FAFAFA'>()</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>This example uses the Car Table from the Example Databases.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:15.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=76
src="SQL%20Notes%20for%20Professionals_files/image160.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=101 style='width:1.05in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=101 valign=top style='width:1.05in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>Number </span><span style='font-size:9.0pt;
  line-height:107%;color:blue'>of</span><span style='font-size:9.0pt;
  line-height:107%'> Cars</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.45pt;
margin-left:.25pt'>This query will return the <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>CustomerId</span> and count of any
customer who has more than one car. In this case, the only customer who has
more than one car is Customer #1.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>The results will look like:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>CustomerId Number of
Cars</b></p>

<p class=MsoNormal style='margin-bottom:20.8pt;text-indent:0in'>1 2</p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:0in;margin-left:-.25pt'><a
name="_Toc228556">Section 13.3: WHERE clause with NULL/NOT NULL values</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:15.1pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="SQL%20Notes%20for%20Professionals_files/image161.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.9pt;
margin-left:.25pt'>This statement will return all Employee records where the
value of the <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>ManagerId</span>
column is <span style='font-size:9.0pt;line-height:110%;color:#333399;
background:#FAFAFA'>NULL</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>The result will be:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:15.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=62
src="SQL%20Notes%20for%20Professionals_files/image162.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:15.1pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="SQL%20Notes%20for%20Professionals_files/image163.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.9pt;
margin-left:.25pt'>This statement will return all Employee records where the
value of the <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>ManagerId</span>
is <i>not</i> <span style='font-size:9.0pt;line-height:110%;color:#333399;
background:#FAFAFA'>NULL</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:21.7pt;
margin-left:.25pt'>The result will be:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.9pt;margin-bottom:.3pt;
margin-left:3.5pt;text-indent:-.5pt;line-height:110%'><span style='position:
relative;z-index:-1895797760'><span style='left:0px;position:absolute;
left:0px;top:-14687px;width:718px;height:1px'><img width=718 height=1
src="SQL%20Notes%20for%20Professionals_files/image164.gif"></span></span><span
style='font-size:9.0pt;line-height:110%;font-family:"DejaVu Sans Mono"'>Id
FName LName PhoneNumber ManagerId DepartmentId</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.9pt;margin-bottom:.3pt;
margin-left:35.5pt;text-indent:-32.5pt;line-height:110%'><span
style='font-size:9.0pt;line-height:110%;font-family:"DejaVu Sans Mono"'>2<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-size:9.0pt;line-height:110%;font-family:"DejaVu Sans Mono"'>John
Johnson 2468101214 1 1</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.9pt;margin-bottom:.3pt;
margin-left:35.5pt;text-indent:-32.5pt;line-height:110%'><span
style='font-size:9.0pt;line-height:110%;font-family:"DejaVu Sans Mono"'>3<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-size:9.0pt;line-height:110%;font-family:"DejaVu Sans Mono"'>Michael
Williams 1357911131 1 2</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.9pt;margin-bottom:.3pt;
margin-left:35.5pt;text-indent:-32.5pt;line-height:110%'><span
style='font-size:9.0pt;line-height:110%;font-family:"DejaVu Sans Mono"'>4<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-size:9.0pt;line-height:110%;font-family:"DejaVu Sans Mono"'>Johnathon
Smith 1212121212 2 1</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:15.25pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=5 id="Group 185300"
src="SQL%20Notes%20for%20Professionals_files/image165.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=158 style='width:1.65in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=115 valign=top style='width:1.2in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:blue'>WHERE</span><span style='font-size:9.0pt;
  line-height:107%'> ManagerId </span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:gray;background:#FAFAFA'>=</span></p>
  </td>
  <td width=36 valign=top style='width:27.0pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'></span><span style='font-size:9.0pt;line-height:
  107%;color:#333399'>NULL</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.9pt;
margin-left:.25pt'><b>Note:</b> The same query will not return results if you
change the WHERE clause to or <span style='font-size:9.0pt;line-height:110%;
color:blue;background:#FAFAFA'>WHERE</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=122 style='width:91.8pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=122 valign=top style='width:91.8pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>ManagerId </span><span style='font-size:9.0pt;
  line-height:107%;color:gray'>&lt;&gt;</span><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:#333399'>NULL</span></p>
  </td>
 </tr>
</table>

<h2 style='margin-top:0in;margin-right:356.05pt;margin-bottom:0in;margin-left:
-.25pt;line-height:145%'><a name="_Toc228557"><span style='font-size:10.0pt;
line-height:145%;color:black;font-weight:normal'>. </span>Section 13.4:
Equality</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:15.1pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image166.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:21.8pt;
margin-left:.25pt'>This statement will return all the rows from the table <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Employees</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.9pt;margin-bottom:.3pt;
margin-left:3.5pt;text-indent:-.5pt;line-height:110%'><span style='font-size:
9.0pt;line-height:110%;font-family:"DejaVu Sans Mono"'>Id FName LName
PhoneNumber ManagerId DepartmentId Salary Hire_date</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.9pt;margin-bottom:.3pt;
margin-left:3.5pt;text-indent:-.5pt;line-height:110%'><span style='font-size:
9.0pt;line-height:110%;font-family:"DejaVu Sans Mono"'>CreatedDate
ModifiedDate</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.9pt;margin-bottom:.3pt;
margin-left:30.1pt;text-indent:-27.1pt;line-height:110%'><span
style='font-size:9.0pt;line-height:110%;font-family:"DejaVu Sans Mono"'>1<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
style='position:relative;z-index:-1895796736'><span style='left:0px;position:
absolute;left:0px;top:-15022px;width:718px;height:1px'><img width=718 height=1
src="SQL%20Notes%20for%20Professionals_files/image167.gif"></span></span><span
style='font-size:9.0pt;line-height:110%;font-family:"DejaVu Sans Mono"'>James
Smith 1234567890 NULL 1 1000 01-01-2002
01-01-2002</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.9pt;margin-bottom:.3pt;
margin-left:3.5pt;text-indent:-.5pt;line-height:110%'><span style='font-size:
9.0pt;line-height:110%;font-family:"DejaVu Sans Mono"'>01-01-2002</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.9pt;margin-bottom:.3pt;
margin-left:30.1pt;text-indent:-27.1pt;line-height:110%'><span
style='font-size:9.0pt;line-height:110%;font-family:"DejaVu Sans Mono"'>2<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
style='font-size:9.0pt;line-height:110%;font-family:"DejaVu Sans Mono"'>John
Johnson 2468101214 1 1 400 23-03-2005
23-03-2005</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.9pt;margin-bottom:.3pt;
margin-left:3.5pt;text-indent:-.5pt;line-height:110%'><span style='font-size:
9.0pt;line-height:110%;font-family:"DejaVu Sans Mono"'>01-01-2002</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.9pt;margin-bottom:.3pt;
margin-left:30.1pt;text-indent:-27.1pt;line-height:110%'><span
style='font-size:9.0pt;line-height:110%;font-family:"DejaVu Sans Mono"'>3<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
style='font-size:9.0pt;line-height:110%;font-family:"DejaVu Sans Mono"'>Michael
Williams 1357911131 1 2 600 12-05-2009
12-05-2009</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.9pt;margin-bottom:.3pt;
margin-left:3.5pt;text-indent:-.5pt;line-height:110%'><span style='font-size:
9.0pt;line-height:110%;font-family:"DejaVu Sans Mono"'>NULL</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.9pt;margin-bottom:.3pt;
margin-left:30.1pt;text-indent:-27.1pt;line-height:110%'><span
style='font-size:9.0pt;line-height:110%;font-family:"DejaVu Sans Mono"'>4<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
style='font-size:9.0pt;line-height:110%;font-family:"DejaVu Sans Mono"'>Johnathon
Smith 1212121212 2 1 500 24-07-2016
24-07-2016</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.9pt;margin-bottom:.35in;
margin-left:3.5pt;text-indent:-.5pt;line-height:110%'><span style='font-size:
9.0pt;line-height:110%;font-family:"DejaVu Sans Mono"'>01-01-2002</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.35pt;
margin-left:.25pt'>Using a <span style='font-size:9.0pt;line-height:110%;
color:blue;background:#FAFAFA'>WHERE</span> at the end of your <span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>SELECT</span>
statement allows you to limit the returned rows to a condition. In this case,
where there is an exact match using the <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>=</span> sign:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:15.15pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image168.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:21.85pt;
margin-left:.25pt'>Will only return the rows where the <span style='font-size:
9.0pt;line-height:110%;background:#FAFAFA'>DepartmentId</span> is equal to <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>1</span>:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.9pt;margin-bottom:.3pt;
margin-left:3.5pt;text-indent:-.5pt;line-height:110%'><span style='font-size:
9.0pt;line-height:110%;font-family:"DejaVu Sans Mono"'>Id FName LName
PhoneNumber ManagerId DepartmentId Salary Hire_date</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.9pt;margin-bottom:.3pt;
margin-left:3.5pt;text-indent:-.5pt;line-height:110%'><span style='font-size:
9.0pt;line-height:110%;font-family:"DejaVu Sans Mono"'>CreatedDate
ModifiedDate</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.9pt;margin-bottom:.3pt;
margin-left:30.1pt;text-indent:-27.1pt;line-height:110%'><span
style='font-size:9.0pt;line-height:110%;font-family:"DejaVu Sans Mono"'>1<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
style='font-size:9.0pt;line-height:110%;font-family:"DejaVu Sans Mono"'>James
Smith 1234567890 NULL 1 1000 01-01-2002
01-01-2002</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.9pt;margin-bottom:.3pt;
margin-left:3.5pt;text-indent:-.5pt;line-height:110%'><span style='font-size:
9.0pt;line-height:110%;font-family:"DejaVu Sans Mono"'>01-01-2002</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.9pt;margin-bottom:.3pt;
margin-left:30.1pt;text-indent:-27.1pt;line-height:110%'><span
style='font-size:9.0pt;line-height:110%;font-family:"DejaVu Sans Mono"'>2<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
style='font-size:9.0pt;line-height:110%;font-family:"DejaVu Sans Mono"'>John
Johnson 2468101214 1 1 400 23-03-2005
23-03-2005</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.9pt;margin-bottom:.3pt;
margin-left:3.5pt;text-indent:-.5pt;line-height:110%'><span style='font-size:
9.0pt;line-height:110%;font-family:"DejaVu Sans Mono"'>01-01-2002</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.9pt;margin-bottom:.3pt;
margin-left:3.5pt;text-indent:-.5pt;line-height:110%'><span style='position:
relative;z-index:-1895795712'><span style='left:0px;position:absolute;
left:0px;top:-15529px;width:718px;height:1px'><img width=718 height=1
src="SQL%20Notes%20for%20Professionals_files/image169.gif"></span></span><span
style='font-size:9.0pt;line-height:110%;font-family:"DejaVu Sans Mono"'>4
Johnathon Smith 1212121212 2 1 500
24-07-2016 24-07-2016</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.9pt;margin-bottom:30.85pt;
margin-left:3.5pt;text-indent:-.5pt;line-height:110%'><span style='font-size:
9.0pt;line-height:110%;font-family:"DejaVu Sans Mono"'>01-01-2002</span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228558">Section 13.5: The WHERE clause only returns rows
that match its criteria</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.25pt;
margin-left:.25pt'>Steam has a games under $10 section of their store page.
Somewhere deep in the heart of their systems, there's probably a query that
looks something like:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="SQL%20Notes%20for%20Professionals_files/image170.gif"></span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228559">Section 13.6: AND and OR</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.6pt;
margin-left:.25pt'>You can also combine several operators together to create
more complex <span style='font-size:9.0pt;line-height:110%;color:blue;
background:#FAFAFA'>WHERE</span> conditions. The following examples use the <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Employees</span>
table:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:0in;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=720 height=35
src="SQL%20Notes%20for%20Professionals_files/image171.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.9pt;margin-bottom:.3pt;
margin-left:3.5pt;text-indent:-.5pt;line-height:110%'><span style='font-size:
9.0pt;line-height:110%;font-family:"DejaVu Sans Mono"'>CreatedDate
ModifiedDate</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.9pt;margin-bottom:.3pt;
margin-left:30.1pt;text-indent:-27.1pt;line-height:110%'><span
style='font-size:9.0pt;line-height:110%;font-family:"DejaVu Sans Mono"'>1<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
style='position:relative;z-index:-1895794688'><span style='left:0px;position:
absolute;left:0px;top:-15934px;width:718px;height:1px'><img width=718 height=1
src="SQL%20Notes%20for%20Professionals_files/image172.gif"></span></span><span
style='font-size:9.0pt;line-height:110%;font-family:"DejaVu Sans Mono"'>James
Smith 1234567890 NULL 1 1000 01-01-2002
01-01-2002</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.9pt;margin-bottom:.3pt;
margin-left:3.5pt;text-indent:-.5pt;line-height:110%'><span style='font-size:
9.0pt;line-height:110%;font-family:"DejaVu Sans Mono"'>01-01-2002</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.9pt;margin-bottom:.3pt;
margin-left:30.1pt;text-indent:-27.1pt;line-height:110%'><span
style='font-size:9.0pt;line-height:110%;font-family:"DejaVu Sans Mono"'>2<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
style='font-size:9.0pt;line-height:110%;font-family:"DejaVu Sans Mono"'>John
Johnson 2468101214 1 1 400 23-03-2005
23-03-2005</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.9pt;margin-bottom:.3pt;
margin-left:3.5pt;text-indent:-.5pt;line-height:110%'><span style='font-size:
9.0pt;line-height:110%;font-family:"DejaVu Sans Mono"'>01-01-2002</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.9pt;margin-bottom:.3pt;
margin-left:30.1pt;text-indent:-27.1pt;line-height:110%'><span
style='font-size:9.0pt;line-height:110%;font-family:"DejaVu Sans Mono"'>3<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
style='font-size:9.0pt;line-height:110%;font-family:"DejaVu Sans Mono"'>Michael
Williams 1357911131 1 2 600 12-05-2009
12-05-2009</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.9pt;margin-bottom:.3pt;
margin-left:3.5pt;text-indent:-.5pt;line-height:110%'><span style='font-size:
9.0pt;line-height:110%;font-family:"DejaVu Sans Mono"'>NULL</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.9pt;margin-bottom:.3pt;
margin-left:30.1pt;text-indent:-27.1pt;line-height:110%'><span
style='font-size:9.0pt;line-height:110%;font-family:"DejaVu Sans Mono"'>4<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
style='font-size:9.0pt;line-height:110%;font-family:"DejaVu Sans Mono"'>Johnathon
Smith 1212121212 2 1 500 24-07-2016
24-07-2016</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.9pt;margin-bottom:25.35pt;
margin-left:3.5pt;text-indent:-.5pt;line-height:110%'><span style='font-size:
9.0pt;line-height:110%;font-family:"DejaVu Sans Mono"'>01-01-2002</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>AND</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image173.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Will return:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=720 height=94
src="SQL%20Notes%20for%20Professionals_files/image174.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>OR</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image175.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:21.7pt;
margin-left:.25pt'>Will return:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.9pt;margin-bottom:.3pt;
margin-left:3.5pt;text-indent:-.5pt;line-height:110%'><span style='font-size:
9.0pt;line-height:110%;font-family:"DejaVu Sans Mono"'>Id FName LName
PhoneNumber ManagerId DepartmentId Salary Hire_date</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.9pt;margin-bottom:.3pt;
margin-left:3.5pt;text-indent:-.5pt;line-height:110%'><span style='font-size:
9.0pt;line-height:110%;font-family:"DejaVu Sans Mono"'>CreatedDate
ModifiedDate</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.9pt;margin-bottom:.3pt;
margin-left:30.1pt;text-indent:-27.1pt;line-height:110%'><span
style='font-size:9.0pt;line-height:110%;font-family:"DejaVu Sans Mono"'>3<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
style='position:relative;z-index:-1895793664'><span style='left:0px;position:
absolute;left:0px;top:-16524px;width:718px;height:1px'><img width=718 height=1
src="SQL%20Notes%20for%20Professionals_files/image176.gif"></span></span><span
style='font-size:9.0pt;line-height:110%;font-family:"DejaVu Sans Mono"'>Michael
Williams 1357911131 1 2 600 12-05-2009
12-05-2009</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.9pt;margin-bottom:.3pt;
margin-left:3.5pt;text-indent:-.5pt;line-height:110%'><span style='font-size:
9.0pt;line-height:110%;font-family:"DejaVu Sans Mono"'>NULL</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.9pt;margin-bottom:.3pt;
margin-left:30.1pt;text-indent:-27.1pt;line-height:110%'><span
style='font-size:9.0pt;line-height:110%;font-family:"DejaVu Sans Mono"'>4<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
style='font-size:9.0pt;line-height:110%;font-family:"DejaVu Sans Mono"'>Johnathon
Smith 1212121212 2 1 500 24-07-2016
24-07-2016</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.9pt;margin-bottom:30.85pt;
margin-left:3.5pt;text-indent:-.5pt;line-height:110%'><span style='font-size:
9.0pt;line-height:110%;font-family:"DejaVu Sans Mono"'>01-01-2002</span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228560">Section 13.7: Use IN to return rows with a value
contained in a list</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>This example uses the Car Table from the Example Databases.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="SQL%20Notes%20for%20Professionals_files/image177.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.35pt;
margin-left:.25pt'>This query will return Car #2 which costs 200 and Car #3
which costs 100. Note that this is equivalent to using multiple clauses with <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>OR</span>, e.g.:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="SQL%20Notes%20for%20Professionals_files/image178.gif"></span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228561">Section 13.8: Use LIKE to find matching strings
and substrings</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>See full documentation on LIKE operator.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>This example uses the Employees Table from the Example
Databases.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="SQL%20Notes%20for%20Professionals_files/image179.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>This query will only return Employee #1 whose first name
matches 'John' exactly.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="SQL%20Notes%20for%20Professionals_files/image180.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.85pt;
margin-left:.25pt'>Adding <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>%</span> allows you to search for a substring:</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=29 style='width:.3in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>John</span></p>
  </td>
 </tr>
</table>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=29 style='width:.3in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>John</span></p>
  </td>
 </tr>
</table>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=29 style='width:.3in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>John</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.6pt;
margin-left:20.9pt'><img width=5 height=1
src="SQL%20Notes%20for%20Professionals_files/image110.gif" align=left
hspace=12><span style='font-size:9.0pt;line-height:110%;color:gray;background:
#FAFAFA'>%</span> - will return any Employee whose name begins with 'John',
followed by any amount of characters</p>

<p class=MsoNormal align=center style='margin-left:21.4pt;text-align:center;
text-indent:-.5pt;line-height:123%'><span style='font-size:9.0pt;line-height:
123%;color:gray;background:#FAFAFA'>%</span> - will return any Employee whose
name ends with 'John', proceeded by any amount of characters</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:20.9pt'><span style='font-size:9.0pt;line-height:110%;color:gray;
background:#FAFAFA'>%%</span> - will return any Employee whose name contains
'John' anywhere within the value</p>

<p class=MsoNormal style='margin-top:0in;margin-right:41.05pt;margin-bottom:
.2pt;margin-left:.25pt;text-align:justify;text-justify:inter-ideograph;
line-height:135%'>In this case, the query will return Employee #2 whose name is
'John' as well as Employee #4 whose name is 'Johnathon'.</p>

<h2 style='margin-top:0in;margin-right:41.05pt;margin-bottom:.2pt;margin-left:
.25pt;text-align:justify;text-justify:inter-ideograph;text-indent:.5pt;
line-height:135%'><a name="_Toc228562">Section 13.9: Where EXISTS</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Will select records in <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>TableName</span> that have records
matching in <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>TableName1</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src="SQL%20Notes%20for%20Professionals_files/image181.gif"></span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228563">Section 13.10: Use HAVING to check for multiple
conditions in a group</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>Orders Table</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>CustomerId ProductId
Quantity Price</b></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=233
 style='width:175.1pt;margin-left:1.0pt;border-collapse:collapse'>
 <tr style='height:13.65pt'>
  <td width=211 valign=top style='width:157.95pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>1 2 5</p>
  </td>
  <td width=23 valign=top style='width:17.15pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>100</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=211 valign=top style='width:157.95pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>1 3 2</p>
  </td>
  <td width=23 valign=top style='width:17.15pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>200</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=211 valign=top style='width:157.95pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>1 4 1</p>
  </td>
  <td width=23 valign=top style='width:17.15pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>500</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=211 valign=top style='width:157.95pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>2 1 4</p>
  </td>
  <td width=23 valign=top style='width:17.15pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>50</p>
  </td>
 </tr>
 <tr style='height:13.65pt'>
  <td width=211 valign=top style='width:157.95pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>3 5 6</p>
  </td>
  <td width=23 valign=top style='width:17.15pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>700</p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>To check for customers who have ordered both - ProductID 2
and 3, HAVING can be used</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=92
src="SQL%20Notes%20for%20Professionals_files/image182.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.3pt;
margin-left:.25pt'>Return value:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>customerId</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:15.05pt;
margin-left:.25pt'>1</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt;line-height:215%'>The query selects only records with the
productIDs in questions and with the HAVING clause checks for groups having 2
productIds and not just one. Another possibility would be</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=92
src="SQL%20Notes%20for%20Professionals_files/image183.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>This query selects only groups having at least one record
with productID 2 and at least one with productID 3.<br clear=all
style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc228564">Chapter 14: SKIP TAKE
(Pagination)</a></h1>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228565">Section 14.1: Limiting amount of results</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>ISO/ANSI SQL:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image184.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>MySQL; PostgreSQL; SQLite:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image185.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Oracle:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=125
src="SQL%20Notes%20for%20Professionals_files/image186.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>SQL Server:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src="SQL%20Notes%20for%20Professionals_files/image187.gif"></span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228566">Section 14.2: Skipping then taking some results
(Pagination)</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>ISO/ANSI SQL:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=76
src="SQL%20Notes%20for%20Professionals_files/image188.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>MySQL:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image189.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Oracle; SQL Server:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=125
src="SQL%20Notes%20for%20Professionals_files/image190.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>PostgreSQL; SQLite:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:0in;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image191.gif"></span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228567">Section 14.3: Skipping some rows from result</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>ISO/ANSI SQL:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=76
src="SQL%20Notes%20for%20Professionals_files/image192.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:14.45pt;
margin-left:.25pt'>MySQL:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%;color:blue'>SELECT</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:gray'>*</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>FROM</span><span style='font-size:9.0pt;
line-height:110%'> TableName </span><span style='font-size:9.0pt;line-height:
110%;color:blue'>LIMIT</span><span style='font-size:9.0pt;line-height:110%'> 20</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>,</span><span
style='font-size:9.0pt;line-height:110%'> 42424242424242</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:102.0pt;margin-bottom:
.15pt;margin-left:0in;text-indent:3.75pt;line-height:240%'><span
style='position:relative;z-index:-1895791616'><span style='left:0px;position:
absolute;left:0px;top:-19190px;width:718px;height:1px'><img width=718 height=1
src="SQL%20Notes%20for%20Professionals_files/image193.gif"></span></span><span
style='font-size:9.0pt;line-height:240%;color:green'>-- skips 20 for take use
very large number that is more than rows in table </span>Oracle:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=125
src="SQL%20Notes%20for%20Professionals_files/image194.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>PostgreSQL:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image195.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>SQLite:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:0in;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image196.gif"></span></p>

<h1 style='margin-left:-.25pt'><a name="_Toc228568">Chapter 15: EXCEPT</a></h1>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:0in;margin-left:-.25pt'><a
name="_Toc228569">Section 15.1: Select dataset except where values are in this
other dataset</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:0in;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=158
src="SQL%20Notes%20for%20Professionals_files/image197.gif"></span><br
clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc228570">Chapter 16: EXPLAIN and
DESCRIBE</a></h1>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228571">Section 16.1: EXPLAIN Select query</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.45pt;
margin-left:.25pt'>An <span style='font-size:9.0pt;line-height:110%;color:#333399;
background:#FAFAFA'>Explain</span> infront of a <span style='font-size:9.0pt;
line-height:110%;color:blue;background:#FAFAFA'>select</span> query shows you
how the query will be executed. This way you to see if the query uses an index
or if you could optimize your query by adding an index.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Example query:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image198.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:21.7pt;
margin-left:.25pt'>Example result:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.9pt;margin-bottom:25.15pt;
margin-left:3.5pt;text-indent:-.5pt;line-height:110%'><span style='position:
relative;z-index:-1895790592'><span style='left:0px;position:absolute;
left:0px;top:-20039px;width:718px;height:1px'><img width=718 height=1
src="SQL%20Notes%20for%20Professionals_files/image199.gif"></span></span><span
style='font-size:9.0pt;line-height:110%;font-family:"DejaVu Sans Mono"'>id
select_type table type possible_keys key key_len ref rows
Extra 1 SIMPLE user index test test 5 (null)
1 Using where; Using index 1 SIMPLE data ref fk_user
fk_user 5 user.test 1 (null)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:7.75pt;margin-bottom:
.2pt;margin-left:.25pt;text-align:justify;text-justify:inter-ideograph;
line-height:135%'>on <span style='font-size:9.0pt;line-height:135%;color:blue;
background:#FAFAFA'>type</span> you see if an index was used. In the column <span
style='font-size:9.0pt;line-height:135%;background:#FAFAFA'>possible_keys</span>
you see if the execution plan can choose from different indexes of if none
exists. <span style='font-size:9.0pt;line-height:135%;color:blue;background:
#FAFAFA'>key</span> tells you the acutal used index. <span style='font-size:
9.0pt;line-height:135%;background:#FAFAFA'>key_len</span> shows you the size in
bytes for one index item. The lower this value is the more index items fit into
the same memory size an they can be faster processed. <span style='font-size:
9.0pt;line-height:135%;color:blue;background:#FAFAFA'>rows</span> shows you the
expected number of rows the query needs to scan, the lower the better.</p>

<h2 style='margin-top:0in;margin-right:7.75pt;margin-bottom:.2pt;margin-left:
.25pt;text-align:justify;text-justify:inter-ideograph;text-indent:.5pt;
line-height:135%'><a name="_Toc228572">Section 16.2: DESCRIBE tablename;</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'><span style='font-size:9.0pt;line-height:110%;color:blue;
background:#FAFAFA'>DESCRIBE</span> and <span style='font-size:9.0pt;
line-height:110%;color:#333399;background:#FAFAFA'>EXPLAIN</span> are synonyms.
<span style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>DESCRIBE</span>
on a tablename returns the definition of the columns.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image200.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:14.45pt;
margin-left:.25pt'>Exmple Result:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.3in;margin-bottom:17.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='position:relative;z-index:
-1895789568'><span style='left:0px;position:absolute;left:0px;top:-20364px;
width:718px;height:1px'><img width=718 height=1
src="SQL%20Notes%20for%20Professionals_files/image201.gif"></span></span><span
style='font-size:9.0pt;line-height:110%'>COLUMN_NAME COLUMN_TYPE
IS_NULLABLE COLUMN_KEY COLUMN_DEFAULT EXTRA id </span><span
style='font-size:9.0pt;line-height:110%;color:blue'>int</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>(</span><span
style='font-size:9.0pt;line-height:110%'>11</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>)</span><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:blue'>NO</span><span
style='font-size:9.0pt;line-height:110%'> PRI
0 auto_increment test </span><span style='font-size:
9.0pt;line-height:110%;color:blue'>varchar</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>(</span><span style='font-size:9.0pt;line-height:
110%'>255</span><span style='font-size:9.0pt;line-height:110%;color:gray'>)</span><span
style='font-size:9.0pt;line-height:110%'> YES </span><span
style='font-size:9.0pt;line-height:110%;color:gray'>(</span><span
style='font-size:9.0pt;line-height:110%;color:#333399'>null</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>)</span><span
style='font-size:9.0pt;line-height:110%'> </span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.65pt;
margin-left:.25pt'>Here you see the column names, followed by the columns type.
It shows if <span style='font-size:9.0pt;line-height:110%;color:#333399;
background:#FAFAFA'>null</span> is allowed in the column and if the column uses
an Index. the default value is also displayed and if the table contains any
special behavior like an <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>auto_increment</span>.</p>

<h1 style='margin-left:-.25pt'><a name="_Toc228573">Chapter 17: EXISTS CLAUSE</a></h1>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228574">Section 17.1: EXISTS CLAUSE</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>Customer Table</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Id FirstName LastName</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:11.9pt;text-indent:-11.65pt'><span style='line-height:110%'>1<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Ozgur Ozturk</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:11.9pt;text-indent:-11.65pt'><span style='line-height:110%'>2<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Youssef Medi</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:15.05pt;
margin-left:11.9pt;text-indent:-11.65pt'><span style='line-height:110%'>3<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Henry Tai</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>Order Table</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Id CustomerId Amount</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:11.9pt;text-indent:-11.65pt'><span style='line-height:110%'>1<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>2 123.50</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:4.05pt;
margin-left:11.9pt;text-indent:-11.65pt'><span style='line-height:110%'>2<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>3 14.80</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Get all customers with a
least one order</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:12.75pt;
margin-left:.5pt;text-indent:-.5pt'><span style='font-size:11.0pt;line-height:
110%'><img border=0 width=718 height=60
src="SQL%20Notes%20for%20Professionals_files/image202.gif"></span><span
style='font-size:9.0pt;line-height:110%;color:blue'>SELECT</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:gray'>*</span><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:blue'>FROM</span><span
style='font-size:9.0pt;line-height:110%'> Customer </span><span
style='font-size:9.0pt;line-height:110%;color:blue'>WHERE</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#333399'>EXISTS</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:gray'>(</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>Result</p>

<p class=MsoNormal style='margin-top:0in;margin-right:420.55pt;margin-bottom:
1.95pt;margin-left:.25pt'><b>Id FirstName LastName </b>2 Youssef Medi 3 Henry Tai</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=75
src="SQL%20Notes%20for%20Professionals_files/image203.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>Result</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Id FirstName LastName</b></p>

<p class=MsoNormal style='margin-bottom:4.1pt;text-indent:0in'>1 Ozgur Ozturk</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.1pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Purpose</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:13.0pt;
margin-left:.25pt'><span style='font-size:9.0pt;line-height:110%;color:#333399;
background:#FAFAFA'>EXISTS</span>, <span style='font-size:9.0pt;line-height:
110%;background:#FAFAFA'>IN</span> and <span style='font-size:9.0pt;line-height:
110%;color:#333399;background:#FAFAFA'>JOIN</span> could sometime be used for
the same result, however, they are not equals :</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.75pt;
margin-left:20.9pt'><img width=5 height=1
src="SQL%20Notes%20for%20Professionals_files/image110.gif" align=left
hspace=12><span style='font-size:9.0pt;line-height:110%;color:#333399;
background:#FAFAFA'>EXISTS</span> should be used to check if a value exist in
another table</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.75pt;
margin-left:20.9pt'><span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>IN</span> should be used for static list</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:20.9pt'><span style='font-size:9.0pt;line-height:110%;color:#333399;
background:#FAFAFA'>JOIN</span> should be used to retrieve data from other(s)
table(s)</p>

<h1 style='margin-left:-.25pt'><a name="_Toc228575">Chapter 18: JOIN</a></h1>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.45pt;
margin-left:.25pt'>JOIN is a method of combining (joining) information from two
tables. The result is a stitched set of columns from both tables, defined by
the join type (INNER/OUTER/CROSS and LEFT/RIGHT/FULL, explained below) and join
criteria (how rows from both tables relate).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.55pt;margin-bottom:.2pt;
margin-left:.25pt;text-align:justify;text-justify:inter-ideograph;line-height:
135%'>A table may be joined to itself or to any other table. If information
from more than two tables needs to be accessed, multiple joins can be specified
in a FROM clause.</p>

<h2 style='margin-top:0in;margin-right:.55pt;margin-bottom:.2pt;margin-left:
.25pt;text-align:justify;text-justify:inter-ideograph;text-indent:.5pt;
line-height:135%'><a name="_Toc228576">Section 18.1: Self Join</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.45pt;
margin-left:.25pt'>A table may be joined to itself, with different rows
matching each other by some condition. In this use case, aliases must be used
in order to distinguish the two occurrences of the table.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.25pt;
margin-left:.25pt'>In the below example, for each Employee in the example
database Employees table, a record is returned containing the employee's first
name together with the corresponding first name of the employee's manager.
Since managers are also employees, the table is joined with itself:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=142
src="SQL%20Notes%20for%20Professionals_files/image204.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>This query will return the following data:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Employee Manager</b></p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'>John James</p>

<p class=MsoNormal style='margin-top:0in;margin-right:409.4pt;margin-bottom:
15.3pt;margin-left:.25pt;line-height:141%'>Michael James Johnathon John</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>So how does this work?</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>The original table contains these records:</p>

<p class=MsoNormal style='margin-bottom:.95pt;text-indent:0in;line-height:111%'><b>Id
FName LName PhoneNumber ManagerId DepartmentId Salary
HireDate</b></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=525
 style='width:394.1pt;margin-left:1.0pt;border-collapse:collapse'>
 <tr style='height:13.65pt'>
  <td width=240 valign=top style='width:180.35pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>1
  James Smith 1234567890</p>
  </td>
  <td width=74 valign=top style='width:55.8pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>NULL</p>
  </td>
  <td width=141 valign=top style='width:105.7pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>1 1000</p>
  </td>
  <td width=70 valign=top style='width:52.2pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>01-01-2002</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=240 valign=top style='width:180.35pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>2
  John Johnson 2468101214</p>
  </td>
  <td width=74 valign=top style='width:55.8pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>1</p>
  </td>
  <td width=141 valign=top style='width:105.7pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>1 400</p>
  </td>
  <td width=70 valign=top style='width:52.2pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>23-03-2005</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=240 valign=top style='width:180.35pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>3
  Michael Williams 1357911131</p>
  </td>
  <td width=74 valign=top style='width:55.8pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>1</p>
  </td>
  <td width=141 valign=top style='width:105.7pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>2 600</p>
  </td>
  <td width=70 valign=top style='width:52.2pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>12-05-2009</p>
  </td>
 </tr>
 <tr style='height:13.65pt'>
  <td width=240 valign=top style='width:180.35pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>4
  Johnathon Smith 1212121212</p>
  </td>
  <td width=74 valign=top style='width:55.8pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>2</p>
  </td>
  <td width=141 valign=top style='width:105.7pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>1 500</p>
  </td>
  <td width=70 valign=top style='width:52.2pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>24-07-2016</p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.45pt;
margin-left:.25pt'>The first action is to create a <i>Cartesian</i> product of
all records in the tables used in the <b>FROM</b> clause. In this case it's the
Employees table twice, so the intermediate table will look like this (I've
removed any fields not used in this example):</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>e.Id e.FName e.ManagerId
m.Id m.FName m.ManagerId</b></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=317
 style='width:237.8pt;margin-left:1.0pt;border-collapse:collapse'>
 <tr style='height:13.65pt'>
  <td width=27 valign=top style='width:20.4pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>1</p>
  </td>
  <td width=69 valign=top style='width:51.65pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>James</p>
  </td>
  <td width=86 valign=top style='width:64.6pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>NULL</p>
  </td>
  <td width=32 valign=top style='width:24.3pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>1</p>
  </td>
  <td width=69 valign=top style='width:51.65pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>James</p>
  </td>
  <td width=34 valign=top style='width:.35in;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>NULL</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=27 valign=top style='width:20.4pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>1</p>
  </td>
  <td width=69 valign=top style='width:51.65pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>James</p>
  </td>
  <td width=86 valign=top style='width:64.6pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>NULL</p>
  </td>
  <td width=32 valign=top style='width:24.3pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>2</p>
  </td>
  <td width=69 valign=top style='width:51.65pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>John</p>
  </td>
  <td width=34 valign=top style='width:.35in;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>1</p>
  </td>
 </tr>
 <tr style='height:13.65pt'>
  <td width=27 valign=top style='width:20.4pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>1</p>
  </td>
  <td width=69 valign=top style='width:51.65pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>James</p>
  </td>
  <td width=86 valign=top style='width:64.6pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>NULL</p>
  </td>
  <td width=32 valign=top style='width:24.3pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>3</p>
  </td>
  <td width=69 valign=top style='width:51.65pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Michael</p>
  </td>
  <td width=34 valign=top style='width:.35in;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>1</p>
  </td>
 </tr>
 <tr style='height:13.65pt'>
  <td width=27 valign=top style='width:20.4pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>1</p>
  </td>
  <td width=155 colspan=2 valign=top style='width:116.25pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>James NULL</p>
  </td>
  <td width=32 valign=top style='width:24.3pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>4</p>
  </td>
  <td width=102 colspan=2 valign=top style='width:76.85pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Johnathon
  2</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=27 valign=top style='width:20.4pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>2</p>
  </td>
  <td width=155 colspan=2 valign=top style='width:116.25pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>John 1</p>
  </td>
  <td width=32 valign=top style='width:24.3pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>1</p>
  </td>
  <td width=102 colspan=2 valign=top style='width:76.85pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>James NULL</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=27 valign=top style='width:20.4pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>2</p>
  </td>
  <td width=155 colspan=2 valign=top style='width:116.25pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>John 1</p>
  </td>
  <td width=32 valign=top style='width:24.3pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>2</p>
  </td>
  <td width=102 colspan=2 valign=top style='width:76.85pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>John 1</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=27 valign=top style='width:20.4pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>2</p>
  </td>
  <td width=155 colspan=2 valign=top style='width:116.25pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>John 1</p>
  </td>
  <td width=32 valign=top style='width:24.3pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>3</p>
  </td>
  <td width=102 colspan=2 valign=top style='width:76.85pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Michael 1</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=27 valign=top style='width:20.4pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>2</p>
  </td>
  <td width=155 colspan=2 valign=top style='width:116.25pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>John 1</p>
  </td>
  <td width=32 valign=top style='width:24.3pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>4</p>
  </td>
  <td width=102 colspan=2 valign=top style='width:76.85pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Johnathon
  2</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=27 valign=top style='width:20.4pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>3</p>
  </td>
  <td width=155 colspan=2 valign=top style='width:116.25pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Michael 1</p>
  </td>
  <td width=32 valign=top style='width:24.3pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>1</p>
  </td>
  <td width=102 colspan=2 valign=top style='width:76.85pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>James NULL</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=27 valign=top style='width:20.4pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>3</p>
  </td>
  <td width=155 colspan=2 valign=top style='width:116.25pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Michael 1</p>
  </td>
  <td width=32 valign=top style='width:24.3pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>2</p>
  </td>
  <td width=102 colspan=2 valign=top style='width:76.85pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>John 1</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=27 valign=top style='width:20.4pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>3</p>
  </td>
  <td width=155 colspan=2 valign=top style='width:116.25pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Michael 1</p>
  </td>
  <td width=32 valign=top style='width:24.3pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>3</p>
  </td>
  <td width=102 colspan=2 valign=top style='width:76.85pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Michael 1</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=27 valign=top style='width:20.4pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>3</p>
  </td>
  <td width=155 colspan=2 valign=top style='width:116.25pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Michael 1</p>
  </td>
  <td width=32 valign=top style='width:24.3pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>4</p>
  </td>
  <td width=102 colspan=2 valign=top style='width:76.85pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Johnathon
  2</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=27 valign=top style='width:20.4pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>4</p>
  </td>
  <td width=155 colspan=2 valign=top style='width:116.25pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Johnathon
  2</p>
  </td>
  <td width=32 valign=top style='width:24.3pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>1</p>
  </td>
  <td width=102 colspan=2 valign=top style='width:76.85pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>James NULL</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=27 valign=top style='width:20.4pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>4</p>
  </td>
  <td width=155 colspan=2 valign=top style='width:116.25pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Johnathon
  2</p>
  </td>
  <td width=32 valign=top style='width:24.3pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>2</p>
  </td>
  <td width=102 colspan=2 valign=top style='width:76.85pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>John 1</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=27 valign=top style='width:20.4pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>4</p>
  </td>
  <td width=155 colspan=2 valign=top style='width:116.25pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Johnathon
  2</p>
  </td>
  <td width=32 valign=top style='width:24.3pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>3</p>
  </td>
  <td width=102 colspan=2 valign=top style='width:76.85pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Michael 1</p>
  </td>
 </tr>
 <tr style='height:13.65pt'>
  <td width=27 valign=top style='width:20.4pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>4</p>
  </td>
  <td width=155 colspan=2 valign=top style='width:116.25pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Johnathon
  2</p>
  </td>
  <td width=32 valign=top style='width:24.3pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>4</p>
  </td>
  <td width=102 colspan=2 valign=top style='width:76.85pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Johnathon
  2</p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.6pt;
margin-left:.25pt'>The next action is to only keep the records that meet the <b>JOIN</b>
criteria, so any records where the aliased <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>e</span> table <span style='font-size:
9.0pt;line-height:110%;background:#FAFAFA'>ManagerId</span> equals the aliased <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>m</span> table <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Id</span>:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>e.Id e.FName e.ManagerId
m.Id m.FName m.ManagerId</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:20.65pt;text-indent:-20.4pt'><span style='line-height:110%'>2<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>John 1 1 James NULL</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:20.65pt;text-indent:-20.4pt'><span style='line-height:110%'>3<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Michael 1 1 James NULL</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:15.25pt;
margin-left:20.65pt;text-indent:-20.4pt'><span style='line-height:110%'>4<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Johnathon 2 2 John 1</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:13.05pt;
margin-left:.25pt'>Then, each expression used within the <b>SELECT</b> clause
is evaluated to return this table:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:416.65pt;margin-bottom:
3.5pt;margin-left:.25pt;text-indent:0in;line-height:111%'><b>e.FName m.FName </b>John James</p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'>Michael James</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:15.05pt;
margin-left:.25pt'>Johnathon John</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=117 style='width:87.85pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=36 valign=top style='width:27.0pt;background:#FAFAFA;padding:1.2pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:#25256F'>FName</span></p>
  </td>
  <td width=45 valign=top style='width:33.85pt;padding:1.2pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>and <span
  style='font-size:9.0pt;line-height:107%;background:#FAFAFA'>m</span><span
  style='font-size:9.0pt;line-height:107%;color:gray;background:#FAFAFA'>.</span></p>
  </td>
  <td width=36 valign=top style='width:27.0pt;background:#FAFAFA;padding:1.2pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:#25256F'>FName</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.45pt;
margin-left:.25pt'>Finally, column names <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>e</span><span style='font-size:9.0pt;
line-height:110%;color:gray;background:#FAFAFA'>.</span> are replaced by their
alias column names, assigned with the AS operator:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Employee Manager</b></p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'>John James</p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'>Michael James</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:20.8pt;
margin-left:.25pt'>Johnathon John</p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228577">Section 18.2: Di&#57379;erences between
inner/outer joins</a></h2>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=72 style='width:.75in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=72 valign=top style='width:.75in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:#333399'>INNER</span><span style='font-size:
  9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;line-height:
  107%;color:#333399'>JOIN</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.8pt;
margin-left:.25pt'>SQL has various join types to specify whether (non-)matching
rows are included in the result: , <span style='font-size:9.0pt;line-height:
110%;color:fuchsia;background:#FAFAFA'>LEFT</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=336 style='width:251.95pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=72 valign=top style='width:.75in;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:#333399'>OUTER</span><span style='font-size:
  9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;line-height:
  107%;color:#333399'>JOIN</span></p>
  </td>
  <td width=7 valign=top style='width:5.05pt;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>, </p>
  </td>
  <td width=115 valign=top style='width:1.2in;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:fuchsia'>RIGHT</span><span style='font-size:
  9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;line-height:
  107%;color:#333399'>OUTER</span><span style='font-size:9.0pt;line-height:
  107%'> </span><span style='font-size:9.0pt;line-height:107%;color:#333399'>JOIN</span></p>
  </td>
  <td width=34 valign=top style='width:25.5pt;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>, and </p>
  </td>
  <td width=108 valign=top style='width:81.0pt;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:#333399'>FULL</span><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:#333399'>OUTER</span><span style='font-size:9.0pt;line-height:107%'> </span><span
  style='font-size:9.0pt;line-height:107%;color:#333399'>JOIN</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal align=right style='margin-top:0in;margin-right:24.4pt;
margin-bottom:1.9pt;margin-left:.5pt;text-align:right;text-indent:-.5pt;
line-height:107%'>(the <span style='font-size:9.0pt;line-height:107%;
color:#333399;background:#FAFAFA'>INNER</span> and <span style='font-size:9.0pt;
line-height:107%;color:#333399;background:#FAFAFA'>OUTER</span> keywords are
optional). The figure</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.25pt;
margin-left:.25pt'>below underlines the differences between these types of
joins: the blue area represents the results returned by the join, and the white
area represents the results that the join will not return.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><img border=0 width=718
height=508 id="Picture 12386"
src="SQL%20Notes%20for%20Professionals_files/image205.gif"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Cross Join SQL Pictorial Presentation (<a
href="http://www.w3resource.com/sql/joins/cross-join.php"><span
style='color:#F31D19'>reference</span></a>) :</p>

<p class=MsoNormal style='margin-bottom:14.95pt;text-indent:0in;line-height:
107%'><img border=0 width=489 height=365 id="Picture 12392"
src="SQL%20Notes%20for%20Professionals_files/image206.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>Below are examples from <a
href="http://stackoverflow.com/a/38578/3709746"><span style='color:#F31D19'>this</span></a>
answer.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>For instance there are two tables as below :</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=109
src="SQL%20Notes%20for%20Professionals_files/image207.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:13.05pt;
margin-left:.25pt'>Note that (1,2) are unique to A, (3,4) are common, and (5,6)
are unique to B.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Inner Join</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.25pt;
margin-left:.25pt'>An inner join using either of the equivalent queries gives
the intersection of the two tables, i.e. the two rows they have in common:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:4.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=143
src="SQL%20Notes%20for%20Professionals_files/image208.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Left outer join</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>A left outer join will give all rows in A, plus any common
rows in B:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:4.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=158
src="SQL%20Notes%20for%20Professionals_files/image209.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Right outer join</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Similarly, a right outer join will give all rows in B, plus
any common rows in A:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:4.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=158
src="SQL%20Notes%20for%20Professionals_files/image210.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Full outer join</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.25pt;
margin-left:.25pt'>A full outer join will give you the union of A and B, i.e.,
all the rows in A and all the rows in B. If something in A doesn't have a
corresponding datum in B, then the B portion is null, and vice versa.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:0in;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=89
src="SQL%20Notes%20for%20Professionals_files/image211.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=111
src="SQL%20Notes%20for%20Professionals_files/image212.gif"></span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228578">Section 18.3: JOIN Terminology: Inner, Outer,
Semi, Anti..</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.25pt;
margin-left:.25pt'>Let's say we have two tables (A and B) and some of their
rows match (relative to the given JOIN condition, whatever it may be in the
particular case):<br clear=all style='page-break-before:always'>
</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><img border=0 width=718
height=869 id="Picture 12651"
src="SQL%20Notes%20for%20Professionals_files/image213.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.45pt;
margin-left:.25pt'>We can use various join types to include or exclude matching
or non-matching rows from either side, and correctly name the join by picking
the corresponding terms from the diagram above.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>The examples below use the following test data:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:0in;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=53
src="SQL%20Notes%20for%20Professionals_files/image214.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:19.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=317
src="SQL%20Notes%20for%20Professionals_files/image215.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Inner Join</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Combines left and right rows that match.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:19.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=408
src="SQL%20Notes%20for%20Professionals_files/image216.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Left Outer Join</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.25pt;
margin-left:.25pt'>Sometimes abbreviated to &quot;left join&quot;. Combines
left and right rows that match, and includes non-matching left rows.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:19.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=581
src="SQL%20Notes%20for%20Professionals_files/image217.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Right Outer Join</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.25pt;
margin-left:.25pt'>Sometimes abbreviated to &quot;right join&quot;. Combines
left and right rows that match, and includes non-matching right rows.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:19.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=580
src="SQL%20Notes%20for%20Professionals_files/image218.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Full Outer Join</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Sometimes abbreviated to &quot;full join&quot;. Union of
left and right outer join.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:19.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=642
src="SQL%20Notes%20for%20Professionals_files/image219.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Left Semi Join</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Includes left rows that match right rows.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:19.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=547
src="SQL%20Notes%20for%20Professionals_files/image220.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Right Semi Join</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Includes right rows that match left rows.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=548
src="SQL%20Notes%20for%20Professionals_files/image221.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:27.75pt;
margin-left:.25pt'>As you can see, there is no dedicated IN syntax for left vs.
right semi join - we achieve the effect simply by switching the table positions
within SQL text.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.2pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Left Anti Semi Join</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Includes left rows that do <b>not</b> match right rows.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=531
src="SQL%20Notes%20for%20Professionals_files/image222.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:28.35pt;
margin-left:.25pt'><b>WARNING:</b> Be careful if you happen to be using NOT IN
on a NULL-able column! More details <a
href="http://stackoverflow.com/a/132402/533120"><span style='color:#F31D19'>here</span></a>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.2pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Right Anti Semi Join</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Includes right rows that do <b>not</b> match left rows.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=531
src="SQL%20Notes%20for%20Professionals_files/image223.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:27.75pt;
margin-left:.25pt'>As you can see, there is no dedicated NOT IN syntax for left
vs. right anti semi join - we achieve the effect simply by switching the table
positions within SQL text.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Cross Join</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>A Cartesian product of all left with all right rows.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:0in;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=337
src="SQL%20Notes%20for%20Professionals_files/image224.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=153
src="SQL%20Notes%20for%20Professionals_files/image225.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.25pt;
margin-left:.25pt'>Cross join is equivalent to an inner join with join
condition which always matches, so the following query would have returned the
same result:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:19.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image226.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Self-Join</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.25pt;
margin-left:.25pt'>This simply denotes a table joining with itself. A self-join
can be any of the join types discussed above. For example, this is a an inner
self-join:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=191
src="SQL%20Notes%20for%20Professionals_files/image227.gif"></span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228579">Section 18.4: Left Outer Join</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.5pt;
margin-left:.25pt'>A Left Outer Join (also known as a Left Join or Outer Join)
is a Join that ensures all rows from the left table are represented; if no
matching row from the right table exists, its corresponding fields are <span
style='font-size:9.0pt;line-height:110%;color:#333399;background:#FAFAFA'>NULL</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.25pt;
margin-left:.25pt'>The following example will select all departments and the
first name of employees that work in that department. Departments with no
employees are still returned in the results, but will have NULL for the
employee name:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=76
src="SQL%20Notes%20for%20Professionals_files/image228.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>This would return the following from the example database:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Departments.Name
Employees.FName</b></p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'>HR James</p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'>HR John</p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'>HR Johnathon</p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'>Sales Michael</p>

<p class=MsoNormal style='margin-bottom:19.1pt;text-indent:0in'>Tech NULL</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>So how does this work?</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>There are two tables in the FROM clause:</p>

<p class=MsoNormal style='margin-bottom:.95pt;text-indent:0in;line-height:111%'><b>Id
FName LName PhoneNumber ManagerId DepartmentId Salary
HireDate</b></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=525
 style='width:394.1pt;margin-left:1.0pt;border-collapse:collapse'>
 <tr style='height:13.65pt'>
  <td width=240 valign=top style='width:180.35pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>1
  James Smith 1234567890</p>
  </td>
  <td width=74 valign=top style='width:55.8pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>NULL</p>
  </td>
  <td width=141 valign=top style='width:105.7pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>1 1000</p>
  </td>
  <td width=70 valign=top style='width:52.2pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>01-01-2002</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=240 valign=top style='width:180.35pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>2
  John Johnson 2468101214</p>
  </td>
  <td width=74 valign=top style='width:55.8pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>1</p>
  </td>
  <td width=141 valign=top style='width:105.7pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>1 400</p>
  </td>
  <td width=70 valign=top style='width:52.2pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>23-03-2005</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=240 valign=top style='width:180.35pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>3
  Michael Williams 1357911131</p>
  </td>
  <td width=74 valign=top style='width:55.8pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>1</p>
  </td>
  <td width=141 valign=top style='width:105.7pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>2 600</p>
  </td>
  <td width=70 valign=top style='width:52.2pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>12-05-2009</p>
  </td>
 </tr>
 <tr style='height:13.65pt'>
  <td width=240 valign=top style='width:180.35pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>4
  Johnathon Smith 1212121212</p>
  </td>
  <td width=74 valign=top style='width:55.8pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>2</p>
  </td>
  <td width=141 valign=top style='width:105.7pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>1 500</p>
  </td>
  <td width=70 valign=top style='width:52.2pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>24-07-2016</p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>and</p>

<p class=MsoNormal style='margin-top:0in;margin-right:490.1pt;margin-bottom:
3.5pt;margin-left:.25pt;text-indent:0in;line-height:111%'><b>Id Name </b>1 HR</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:11.9pt;text-indent:-11.65pt'><span style='line-height:110%'>2<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Sales</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:15.05pt;
margin-left:11.9pt;text-indent:-11.65pt'><span style='line-height:110%'>3<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Tech</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.6pt;
margin-left:.25pt'>First a <i>Cartesian</i> product is created from the two
tables giving an intermediate table.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.45pt;
margin-left:.25pt'>The records that meet the join criteria (<i>Departments.Id =
Employees.DepartmentId</i>) are highlighted in bold; these are passed to the
next stage of the query.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:2.1pt;
margin-left:.25pt'>As this is a LEFT OUTER JOIN all records are returned from
the LEFT side of the join (Departments), while any records on the RIGHT side
are given a NULL marker if they do not match the join criteria. In the table
below this will return <b>Tech</b> with <span style='font-size:9.0pt;
line-height:110%;color:#333399;background:#FAFAFA'>NULL</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=594
 style='width:445.3pt;margin-left:1.0pt;border-collapse:collapse'>
 <tr style='height:14.0pt'>
  <td width=594 colspan=5 valign=top style='width:445.3pt;padding:0in 0in 0in 0in;
  height:14.0pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><b>Id
  Name Id FName LName PhoneNumber
  ManagerId DepartmentId Salary HireDate</b></p>
  </td>
 </tr>
 <tr style='height:13.65pt'>
  <td width=309 valign=top style='width:231.55pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><b>1
  HR 1 James Smith 1234567890</b></p>
  </td>
  <td width=74 valign=top style='width:55.8pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><b>NULL</b></p>
  </td>
  <td width=97 valign=top style='width:72.85pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><b>1</b></p>
  </td>
  <td width=44 valign=top style='width:32.85pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><b>1000</b></p>
  </td>
  <td width=70 valign=top style='width:52.2pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><b>01-01-2002</b></p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=309 valign=top style='width:231.55pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><b>1
  HR 2 John Johnson 2468101214</b></p>
  </td>
  <td width=74 valign=top style='width:55.8pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><b>1</b></p>
  </td>
  <td width=97 valign=top style='width:72.85pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><b>1</b></p>
  </td>
  <td width=44 valign=top style='width:32.85pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><b>400</b></p>
  </td>
  <td width=70 valign=top style='width:52.2pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><b>23-03-2005</b></p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=309 valign=top style='width:231.55pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>1
  HR 3 Michael Williams 1357911131</p>
  </td>
  <td width=74 valign=top style='width:55.8pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>1</p>
  </td>
  <td width=97 valign=top style='width:72.85pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>2</p>
  </td>
  <td width=44 valign=top style='width:32.85pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>600</p>
  </td>
  <td width=70 valign=top style='width:52.2pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>12-05-2009</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=309 valign=top style='width:231.55pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><b>1
  HR 4 Johnathon Smith 1212121212</b></p>
  </td>
  <td width=74 valign=top style='width:55.8pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><b>2</b></p>
  </td>
  <td width=97 valign=top style='width:72.85pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><b>1</b></p>
  </td>
  <td width=44 valign=top style='width:32.85pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><b>500</b></p>
  </td>
  <td width=70 valign=top style='width:52.2pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><b>24-07-2016</b></p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=309 valign=top style='width:231.55pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>2
  Sales 1 James Smith 1234567890</p>
  </td>
  <td width=74 valign=top style='width:55.8pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>NULL</p>
  </td>
  <td width=97 valign=top style='width:72.85pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>1</p>
  </td>
  <td width=44 valign=top style='width:32.85pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>1000</p>
  </td>
  <td width=70 valign=top style='width:52.2pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>01-01-2002</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=309 valign=top style='width:231.55pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>2
  Sales 2 John Johnson 2468101214</p>
  </td>
  <td width=74 valign=top style='width:55.8pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>1</p>
  </td>
  <td width=97 valign=top style='width:72.85pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>1</p>
  </td>
  <td width=44 valign=top style='width:32.85pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>400</p>
  </td>
  <td width=70 valign=top style='width:52.2pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>23-03-2005</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=309 valign=top style='width:231.55pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><b>2
  Sales 3 Michael Williams 1357911131</b></p>
  </td>
  <td width=74 valign=top style='width:55.8pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><b>1</b></p>
  </td>
  <td width=97 valign=top style='width:72.85pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><b>2</b></p>
  </td>
  <td width=44 valign=top style='width:32.85pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><b>600</b></p>
  </td>
  <td width=70 valign=top style='width:52.2pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><b>12-05-2009</b></p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=309 valign=top style='width:231.55pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>2
  Sales 4 Johnathon Smith 1212121212</p>
  </td>
  <td width=74 valign=top style='width:55.8pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>2</p>
  </td>
  <td width=97 valign=top style='width:72.85pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>1</p>
  </td>
  <td width=44 valign=top style='width:32.85pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>500</p>
  </td>
  <td width=70 valign=top style='width:52.2pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>24-07-2016</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=309 valign=top style='width:231.55pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>3
  Tech 1 James Smith 1234567890</p>
  </td>
  <td width=74 valign=top style='width:55.8pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>NULL</p>
  </td>
  <td width=97 valign=top style='width:72.85pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>1</p>
  </td>
  <td width=44 valign=top style='width:32.85pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>1000</p>
  </td>
  <td width=70 valign=top style='width:52.2pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>01-01-2002</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=309 valign=top style='width:231.55pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>3
  Tech 2 John Johnson 2468101214</p>
  </td>
  <td width=74 valign=top style='width:55.8pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>1</p>
  </td>
  <td width=97 valign=top style='width:72.85pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>1</p>
  </td>
  <td width=44 valign=top style='width:32.85pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>400</p>
  </td>
  <td width=70 valign=top style='width:52.2pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>23-03-2005</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=309 valign=top style='width:231.55pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>3
  Tech 3 Michael Williams 1357911131</p>
  </td>
  <td width=74 valign=top style='width:55.8pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>1</p>
  </td>
  <td width=97 valign=top style='width:72.85pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>2</p>
  </td>
  <td width=44 valign=top style='width:32.85pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>600</p>
  </td>
  <td width=70 valign=top style='width:52.2pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>12-05-2009</p>
  </td>
 </tr>
 <tr style='height:13.65pt'>
  <td width=309 valign=top style='width:231.55pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>3
  Tech 4 Johnathon Smith 1212121212</p>
  </td>
  <td width=74 valign=top style='width:55.8pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>2</p>
  </td>
  <td width=97 valign=top style='width:72.85pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>1</p>
  </td>
  <td width=44 valign=top style='width:32.85pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>500</p>
  </td>
  <td width=70 valign=top style='width:52.2pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>24-07-2016</p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:13.05pt;
margin-left:.25pt'>Finally each expression used within the <b>SELECT</b> clause
is evaluated to return our final table:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Departments.Name
Employees.FName</b></p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'>HR James</p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'>HR John</p>

<p class=MsoNormal style='margin-bottom:3.8pt;text-indent:0in'>Sales Richard</p>

<p class=MsoNormal style='margin-bottom:20.8pt;text-indent:0in'>Tech NULL</p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228580">Section 18.5: Implicit Join</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.4pt;
margin-left:.25pt'>Joins can also be performed by having several tables in the <span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>from</span>
clause, separated with commas <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>,</span> and defining the relationship between them in the <span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>where</span>
clause. This technique is called an Implicit Join (since it doesn't actually
contain a <span style='font-size:9.0pt;line-height:110%;color:#333399;
background:#FAFAFA'>join</span> clause).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.45pt;
margin-left:.25pt'>All RDBMSs support it, but the syntax is usually advised
against. The reasons why it is a bad idea to use this syntax are:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.25pt;
margin-left:20.9pt'><img width=5 height=1
src="SQL%20Notes%20for%20Professionals_files/image229.gif" align=left
hspace=12>It is possible to get accidental cross joins which then return
incorrect results, especially if you have a lot of joins in the query.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.45pt;
margin-left:20.9pt'>If you intended a cross join, then it is not clear from the
syntax (write out CROSS JOIN instead), and someone is likely to change it
during maintenance.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>The following example will select employee's first names and
the name of the departments they work for:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="SQL%20Notes%20for%20Professionals_files/image230.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>This would return the following from the example database:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:424.25pt;margin-bottom:
3.5pt;margin-left:.25pt;text-indent:0in;line-height:111%'><b>e.FName d.Name </b>James HR</p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'>John HR</p>

<p class=MsoNormal style='margin-bottom:20.8pt;text-indent:0in'>Richard Sales</p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228581">Section 18.6: CROSS JOIN</a></h2>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=79 style='width:59.4pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=14 valign=top style='width:.15in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>20</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:gray;background:#FAFAFA'>*</span></p>
  </td>
  <td width=22 valign=top style='width:16.2pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>20 </span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:gray;background:#FAFAFA'>=</span></p>
  </td>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>400</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.45pt;
margin-left:.25pt'>Cross join does a Cartesian product of the two members, A
Cartesian product means each row of one table is combined with each row of the
second table in the join. For example, if <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>TABLEA</span> has 20 rows and <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>TABLEB</span> has
20 rows, the result would be output rows.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Using example database</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="SQL%20Notes%20for%20Professionals_files/image231.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>Which returns:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>d.Name e.FName</b></p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'>HR James</p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'>HR John</p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'>HR Michael</p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'>HR Johnathon</p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'>Sales James</p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'>Sales John</p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'>Sales Michael</p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'>Sales Johnathon</p>

<p class=MsoNormal style='margin-bottom:3.8pt;text-indent:0in'>Tech James</p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'>Tech John</p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'>Tech Michael</p>

<p class=MsoNormal style='margin-bottom:15.05pt;text-indent:0in'>Tech Johnathon</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.25pt;
margin-left:.25pt'>It is recommended to write an explicit CROSS JOIN if you
want to do a cartesian join, to highlight that this is what you want.</p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228582">Section 18.7: CROSS APPLY &amp; LATERAL JOIN</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:156.6pt;margin-bottom:
12.45pt;margin-left:.25pt'>A very interesting type of JOIN is the LATERAL JOIN
(new in PostgreSQL 9.3+), which is also known as CROSS APPLY/OUTER APPLY in
SQL-Server &amp; Oracle.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>The basic idea is that a table-valued function (or inline
subquery) gets applied for every row you join.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.6pt;
margin-left:.25pt'>This makes it possible to, for example, only join the first
matching entry in another table.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.65pt;
margin-left:.25pt'>The difference between a normal and a lateral join lies in
the fact that you can use a column that you previously joined <b>in the
subquery</b> that you &quot;CROSS APPLY&quot;.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>Syntax:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:9.55pt;
margin-left:.25pt'>PostgreSQL 9.3+</p>

<p class=MsoNormal style='margin-bottom:12.1pt;text-indent:0in'><span
style='font-size:11.0pt;line-height:110%'> <img border=0 width=3
height=52 id="Group 207779"
src="SQL%20Notes%20for%20Professionals_files/image232.gif"></span> left |
right | inner JOIN <b>LATERAL</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:9.55pt;
margin-left:.25pt'>SQL-Server:</p>

<p class=MsoNormal style='text-indent:0in'><span style='font-size:11.0pt;
line-height:110%'> <img border=0 width=3 height=52 id="Group 207780"
src="SQL%20Notes%20for%20Professionals_files/image232.gif"></span> CROSS |
OUTER <b>APPLY</b></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=304
 style='width:227.75pt;border-collapse:collapse'>
 <tr style='height:.15in'>
  <td width=130 valign=top style='width:1.35in;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:#333399'>INNER</span><span style='font-size:
  9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;line-height:
  107%;color:#333399'>JOIN</span><span style='font-size:9.0pt;line-height:107%'>
  </span><span style='font-size:9.0pt;line-height:107%;color:blue'>LATERAL</span></p>
  </td>
  <td width=95 valign=top style='width:71.15pt;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>is the same as </p>
  </td>
  <td width=79 valign=top style='width:59.4pt;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:#333399'>CROSS</span><span style='font-size:
  9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;line-height:
  107%;color:#333399'>APPLY</span></p>
  </td>
 </tr>
</table>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=296 style='width:222.35pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=122 valign=top style='width:91.8pt;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:fuchsia'>LEFT</span><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:#333399'>JOIN</span><span style='font-size:9.0pt;line-height:107%'> </span><span
  style='font-size:9.0pt;line-height:107%;color:blue'>LATERAL</span></p>
  </td>
  <td width=95 valign=top style='width:71.15pt;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>is the same as </p>
  </td>
  <td width=79 valign=top style='width:59.4pt;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:#333399'>OUTER</span><span style='font-size:
  9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;line-height:
  107%;color:#333399'>APPLY</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:295.6pt;margin-bottom:
12.8pt;margin-left:.25pt'>and </p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Example usage (PostgreSQL 9.3+):</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.2pt;margin-bottom:0in;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=720 height=497
src="SQL%20Notes%20for%20Professionals_files/image233.gif"></span></p>

</div>

<span style='font-size:10.0pt;line-height:110%;font-family:"Calibri",sans-serif;
color:black'><br clear=all style='page-break-before:always'>
</span>

<div class=WordSection3>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:17.25pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%;color:gray'>)</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:blue'>AS</span><span
style='font-size:9.0pt;line-height:110%'> FirstOE</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>And for SQL-Server</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-1.9pt;margin-bottom:
10.35pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=720 height=486
src="SQL%20Notes%20for%20Professionals_files/image234.gif"></span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228583">Section 18.8: FULL JOIN</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.6pt;
margin-left:.25pt'>One type of JOIN that is less known, is the FULL JOIN.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>(Note: FULL JOIN is not supported by MySQL as per 2016)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>A FULL OUTER JOIN returns all rows from the left table, and
all rows from the right table.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.45pt;
margin-left:.25pt'>If there are rows in the left table that do not have matches
in the right table, or if there are rows in right table that do not have
matches in the left table, then those rows will be listed, too.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Example 1 :</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-1.9pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=76
src="SQL%20Notes%20for%20Professionals_files/image235.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Example 2:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-1.9pt;margin-bottom:
0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=718 height=108
src="SQL%20Notes%20for%20Professionals_files/image236.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:17.25pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:blue'>ON</span><span
style='font-size:9.0pt;line-height:110%'> tYear</span><span style='font-size:
9.0pt;line-height:110%;color:gray'>.</span><span style='font-size:9.0pt;
line-height:110%;color:fuchsia'>Year</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:gray'>=</span><span style='font-size:9.0pt;line-height:110%'> T_Budget</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>.</span><span
style='font-size:9.0pt;line-height:110%;color:fuchsia'>Year</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.25pt;
margin-left:.25pt'>Note that if you're using soft-deletes, you'll have to check
the soft-delete status again in the WHERE-clause (because FULL JOIN behaves
kind-of like a UNION);</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>It's easy to overlook this little fact, since you put
AP_SoftDeleteStatus = 1 in the join clause.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.45pt;
margin-left:.25pt'>Also, if you are doing a FULL JOIN, you'll usually have to
allow NULL in the WHERE-clause; forgetting to allow NULL on a value will have
the same effects as an INNER join, which is something you don't want if you're
doing a FULL JOIN.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>

<table cellpadding=0 cellspacing=0>
 <tr>
  <td width=38 height=0></td>
 </tr>
 <tr>
  <td></td>
  <td><img width=718 height=1
  src="SQL%20Notes%20for%20Professionals_files/image117.gif"></td>
 </tr>
</table>

<br clear=ALL>
Example:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-1.9pt;margin-bottom:
10.35pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=273
src="SQL%20Notes%20for%20Professionals_files/image237.gif"></span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228584">Section 18.9: Recursive JOINs</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.25pt;
margin-left:.25pt'>Recursive joins are often used to obtain parent-child data.
In SQL, they are implemented with recursive common table expressions, for
example:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-1.9pt;margin-bottom:
10.35pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=207
src="SQL%20Notes%20for%20Professionals_files/image238.gif"></span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228585">Section 18.10: Basic explicit inner join</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.85pt;
margin-left:.25pt'>A basic join (also called &quot;inner join&quot;) queries
data from two tables, with their relationship defined in a <span
style='font-size:9.0pt;line-height:110%;color:#333399;background:#FAFAFA'>join</span>
clause.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.25pt;
margin-left:.25pt'>The following example will select employees' first names
(FName) from the Employees table and the name of the department they work for
(Name) from the Departments table:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:17.25pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%;color:blue'>ON</span><span style='font-size:9.0pt;line-height:110%'>
Employees</span><span style='font-size:9.0pt;line-height:110%;color:gray'>.</span><span
style='font-size:9.0pt;line-height:110%;color:#25256F'>DepartmentId</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:gray'>=</span><span style='font-size:9.0pt;line-height:
110%'> Departments</span><span style='font-size:9.0pt;line-height:110%;
color:gray'>.</span><span style='font-size:9.0pt;line-height:110%;color:#25256F'>Id</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>This would return the following from the example database:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Employees.FName
Departments.Name</b></p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'>James HR</p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'>John HR</p>

<p class=MsoNormal style='margin-bottom:20.8pt;text-indent:0in'>Richard Sales</p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228586">Section 18.11: Joining on a Subquery</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.25pt;
margin-left:.25pt'>Joining a subquery is often used when you want to get
aggregate data from a child/details table and display that along with records
from the parent/header table. For example, you might want to get a count of
child records, an average of some numeric column in child records, or the top
or bottom row based on a date or numeric field. This example uses aliases,
which arguable makes queries easier to read when you have multiple tables
involved. Here's what a fairly typical subquery join looks like. In this case
we are retrieving all rows from the parent table Purchase Orders and retrieving
only the first row for each parent record of the child table
PurchaseOrderLineItems.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-1.9pt;margin-bottom:
0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=718 height=158
src="SQL%20Notes%20for%20Professionals_files/image239.gif"></span></p>

</div>

<span style='font-size:10.0pt;line-height:110%;font-family:"Calibri",sans-serif;
color:black'><br clear=all style='page-break-before:always'>
</span>

<div class=WordSection4>

<h1 style='margin-left:-.25pt'><a name="_Toc228587">Chapter 19: UPDATE</a></h1>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228588">Section 19.1: UPDATE with data from another table</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.55pt;
margin-left:.25pt'>The examples below fill in a <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>PhoneNumber</span> for any Employee who is
also a <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Customer</span>
and currently does not have a phone number set in the <span style='font-size:
9.0pt;line-height:110%;background:#FAFAFA'>Employees</span> Table.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:77.5pt;margin-bottom:
.2pt;margin-left:.25pt;line-height:217%'>(These examples use the Employees and
Customers tables from the Example Databases.) <b>Standard SQL</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Update using a correlated subquery:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:4.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=191
src="SQL%20Notes%20for%20Professionals_files/image240.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:2.4pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>SQL:2003</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:15.9pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=240
src="SQL%20Notes%20for%20Professionals_files/image241.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=72 style='width:.75in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=72 valign=top style='width:.75in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:#333399'>INNER</span><span style='font-size:
  9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;line-height:
  107%;color:#333399'>JOIN</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Update using :</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:0in;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=191
src="SQL%20Notes%20for%20Professionals_files/image242.gif"></span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228589">Section 19.2: Modifying existing values</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>This example uses the Cars Table from the Example Databases.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:15.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="SQL%20Notes%20for%20Professionals_files/image243.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.95pt;
margin-left:.25pt'>Update operations can include current values in the updated
row. In this simple example the <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>TotalCost</span> is incremented by 100 for two rows:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:20.9pt'><span style='font-size:11.0pt;line-height:110%'><img
border=0 width=5 height=25 id="Group 185685"
src="SQL%20Notes%20for%20Professionals_files/image025.gif"></span>The
TotalCost of Car #3 is increased from 100 to 200</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:20.9pt'>The TotalCost of Car #4 is increased from 1254 to 1354</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.55pt;margin-bottom:.2pt;
margin-left:.25pt;text-align:justify;text-justify:inter-ideograph;line-height:
135%'>A column's new value may be derived from its previous value or from any
other column's value in the same table or a joined table.</p>

<h2 style='margin-top:0in;margin-right:.55pt;margin-bottom:.2pt;margin-left:
.25pt;text-align:justify;text-justify:inter-ideograph;text-indent:.5pt;
line-height:135%'><a name="_Toc228590">Section 19.3: Updating Specified Rows</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>This example uses the Cars Table from the Example Databases.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=109
src="SQL%20Notes%20for%20Professionals_files/image244.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.85pt;
margin-left:.25pt'>This statement will set the status of the row of 'Cars' with
id 4 to &quot;READY&quot;.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:17.45pt;margin-bottom:
.2pt;margin-left:.25pt;text-align:justify;text-justify:inter-ideograph;
line-height:135%'><span style='font-size:9.0pt;line-height:135%;color:blue;
background:#FAFAFA'>WHERE</span> clause contains a logical expression which is
evaluated for each row. If a row fulfills the criteria, its value is updated.
Otherwise, a row remains unchanged.</p>

<h2 style='margin-top:0in;margin-right:17.45pt;margin-bottom:.2pt;margin-left:
.25pt;text-align:justify;text-justify:inter-ideograph;text-indent:.5pt;
line-height:135%'><a name="_Toc228591">Section 19.4: Updating All Rows</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>This example uses the Cars Table from the Example Databases.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:15.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src="SQL%20Notes%20for%20Professionals_files/image245.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.55pt;margin-bottom:.2pt;
margin-left:.25pt;text-align:justify;text-justify:inter-ideograph;line-height:
135%'>This statement will set the 'status' column of all rows of the 'Cars'
table to &quot;READY&quot; because it does not have a <span style='font-size:
9.0pt;line-height:135%;color:blue;background:#FAFAFA'>WHERE </span>clause to
filter the set of rows.</p>

<h2 style='margin-top:0in;margin-right:.55pt;margin-bottom:.2pt;margin-left:
.25pt;text-align:justify;text-justify:inter-ideograph;text-indent:.5pt;
line-height:135%'><a name="_Toc228592">Section 19.5: Capturing Updated records</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Sometimes one wants to capture the records that have just
been updated.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:0in;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=92
src="SQL%20Notes%20for%20Professionals_files/image246.gif"></span></p>

<h1 style='margin-left:-.25pt'><a name="_Toc228593">Chapter 20: CREATE Database</a></h1>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228594">Section 20.1: CREATE Database</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>A database is created with the following SQL command:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image247.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>This would create an empty database named myDatabase where
you can create tables.<br clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc228595">Chapter 21: CREATE TABLE</a></h1>

<p class=MsoNormal style='margin-top:0in;margin-right:172.75pt;margin-bottom:
3.1pt;margin-left:.25pt'><b>Parameter Details </b>tableName The
name of the table</p>

<p class=MsoNormal style='margin-top:0in;margin-right:18.55pt;margin-bottom:
6.3pt;margin-left:.25pt;text-align:justify;text-justify:inter-ideograph;
text-indent:55.4pt;line-height:90%'>Contains an 'enumeration' of all the
columns that the table have. See <b>Create a New Table</b> for more columns
details.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.7pt;margin-bottom:
.2pt;margin-left:.25pt;text-align:justify;text-justify:inter-ideograph;
line-height:135%'>The CREATE TABLE statement is used create a new table in the
database. A table definition consists of a list of columns, their types, and
any integrity constraints.</p>

<h2 style='margin-top:0in;margin-right:30.7pt;margin-bottom:.2pt;margin-left:
.25pt;text-align:justify;text-justify:inter-ideograph;text-indent:.5pt;
line-height:135%'><a name="_Toc228596">Section 21.1: Create Table From Select</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>You may want to create a duplicate of a table:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image248.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.25pt;
margin-left:.25pt'>You can use any of the other features of a SELECT statement
to modify the data before passing it to the new table. The columns of the new
table are automatically created according to the selected rows.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="SQL%20Notes%20for%20Professionals_files/image249.gif"></span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228597">Section 21.2: Create a New Table</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.3pt;
margin-left:.25pt'>A basic <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>Employees</span> table, containing an ID, and the
employee's first and last name along with their phone number can be created
using</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=109
src="SQL%20Notes%20for%20Professionals_files/image250.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.95pt;
margin-left:.25pt'>This example is specific to <a
href="https://en.wikipedia.org/wiki/Transact-SQL"><span style='color:#F31D19'>Transact-SQL</span></a></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=86 style='width:.9in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=86 valign=top style='width:.9in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:blue'>CREATE</span><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:blue'>TABLE</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.9pt;
margin-left:.9in'>creates a new table in the database, followed by the table
name, <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Employees</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>This is then followed by the list of column names and their
properties, such as the ID</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:3.25pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image251.gif"></span></p>

<p class=MsoNormal style='margin-bottom:.95pt;text-indent:0in;line-height:111%'><span
style='font-size:11.0pt;line-height:111%'> </span><b>Value Meaning</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:356.2pt;margin-bottom:
.2pt;margin-left:.25pt;line-height:142%'><span style='font-size:9.0pt;
line-height:142%;background:#FAFAFA'>Id </span>the column's name. <span
style='font-size:9.0pt;line-height:142%;color:blue;background:#FAFAFA'>int </span>is
the data type.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=58 style='width:.6in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:blue'>identity</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:22.1pt;margin-bottom:
5.75pt;margin-left:44.2pt;text-align:justify;text-justify:inter-ideograph;
text-indent:30.25pt;line-height:90%'>states that column will have auto
generated values starting at 1 and incrementing by 1 for each <span
style='font-size:9.0pt;line-height:90%;color:gray;background:#FAFAFA'>(</span><span
style='font-size:9.0pt;line-height:90%;background:#FAFAFA'>1</span><span
style='font-size:9.0pt;line-height:90%;color:gray;background:#FAFAFA'>,</span><span
style='font-size:9.0pt;line-height:90%;background:#FAFAFA'>1</span><span
style='font-size:9.0pt;line-height:90%;color:gray;background:#FAFAFA'>) </span>new
row.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=79 style='width:59.4pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=79 valign=top style='width:59.4pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:blue'>primary</span><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:blue'>key</span></p>
  </td>
 </tr>
</table>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=58 style='width:.6in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:#333399'>not</span><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:#333399'>null</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:162.95pt;margin-bottom:
17.45pt;margin-left:.25pt;line-height:137%'>states that all values in this
column will have unique values states that this column cannot have null values</p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228598">Section 21.3: CREATE TABLE With FOREIGN KEY</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Below you could find the table <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>Employees</span> with a reference to the
table <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Cities</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=223
src="SQL%20Notes%20for%20Professionals_files/image252.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Here could you find a database diagram.</p>

<p class=MsoNormal style='margin-bottom:15.2pt;text-indent:0in;line-height:
107%'><img border=0 width=560 height=241 id="Picture 14913"
src="SQL%20Notes%20for%20Professionals_files/image253.gif"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.4pt;
margin-left:.25pt'>The column <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>CityID</span> of table <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>Employees</span> will reference to the
column <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>CityID</span>
of table <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Cities</span>.
Below you could find the syntax to make this.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:3.25pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image254.gif"></span></p>

<p class=MsoNormal style='margin-bottom:.95pt;text-indent:0in;line-height:111%'><span
style='font-size:11.0pt;line-height:111%'> </span><b>Value Meaning</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:347.0pt;margin-bottom:
.2pt;margin-left:.25pt;line-height:143%'><span style='font-size:9.0pt;
line-height:143%;background:#FAFAFA'>CityID </span>Name of the column <span
style='font-size:9.0pt;line-height:143%;color:blue;background:#FAFAFA'>int </span>type
of the column</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=79 style='width:59.4pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=79 valign=top style='width:59.4pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:blue'>FOREIGN</span><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:blue'>KEY</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.3pt;
margin-left:.25pt'>Makes the foreign key <i>(optional)</i></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=94 style='width:70.2pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=72 valign=top style='width:.75in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:blue'>REFERENCES</span></p>
  </td>
  <td width=22 valign=top style='width:16.2pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:8.0pt;text-indent:0in;line-height:
  107%'>&nbsp;</p>
  </td>
 </tr>
 <tr style='height:.15in'>
  <td width=94 colspan=2 valign=top style='width:70.2pt;background:#FAFAFA;
  padding:1.8pt 0in 0in 0in;height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>Cities</span><span style='font-size:9.0pt;line-height:
  107%;color:gray'>(</span><span style='font-size:9.0pt;line-height:107%'>CityID</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Makes the reference</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:16.15pt;
margin-left:71.2pt'><span style='font-size:9.0pt;line-height:110%;color:gray;
background:#FAFAFA'>) </span>to the table <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>Cities</span> column <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>CityID</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:19.5pt;margin-bottom:
.2pt;margin-left:.25pt;text-align:justify;text-justify:inter-ideograph;
line-height:135%'><b>Important:</b> You couldn't make a reference to a table
that not exists in the database. Be source to make first the table <span
style='font-size:9.0pt;line-height:135%;background:#FAFAFA'>Cities</span> and
second the table <span style='font-size:9.0pt;line-height:135%;background:#FAFAFA'>Employees</span>.
If you do it vise versa, it will throw an error.</p>

<h2 style='margin-top:0in;margin-right:19.5pt;margin-bottom:.2pt;margin-left:
.25pt;text-align:justify;text-justify:inter-ideograph;text-indent:.5pt;
line-height:135%'><a name="_Toc228599">Section 21.4: Duplicate a table</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>To duplicate a table, simply do the following:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src="SQL%20Notes%20for%20Professionals_files/image255.gif"></span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228600">Section 21.5: Create a Temporary or In-Memory
Table</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>PostgreSQL and SQLite</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>To create a temporary table local to the session:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:4.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image256.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>SQL Server</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>To create a temporary table local to the session:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image257.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>To create a temporary table visible to everyone:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image258.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>To create an in-memory table:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:0in;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image259.gif"></span><br
clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc228601">Chapter 22: CREATE FUNCTION</a></h1>

<p class=MsoNormal style='margin-bottom:.95pt;text-indent:0in;line-height:111%'><span
style='font-size:11.0pt;line-height:111%'> </span><b>Argument Description</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:229.3pt;margin-bottom:
.2pt;margin-left:.25pt;line-height:141%'>function_name the name of function
list_of_paramenters parameters that function accepts return_data_type type
that function returs. Some SQL <a
href="http://www.w3schools.com/sql/sql_datatypes_general.asp"><span
style='color:#F31D19'>data type </span></a>function_body the code of function</p>

<p class=MsoNormal style='margin-bottom:20.8pt;text-indent:0in'>scalar_expression scalar
value returned by function</p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:0in;margin-left:-.25pt'><a
name="_Toc228602">Section 22.1: Create a new Function</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=207
src="SQL%20Notes%20for%20Professionals_files/image260.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.45pt;
margin-left:.25pt'>This example creates a function named <b>FirstWord</b>, that
accepts a varchar parameter and returns another varchar value.<br clear=all
style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc228603">Chapter 23: TRY/CATCH</a></h1>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228604">Section 23.1: Transaction In a TRY/CATCH</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>This will rollback both inserts due to an invalid datetime:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=207
src="SQL%20Notes%20for%20Professionals_files/image261.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>This will commit both inserts:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:0in;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=207
src="SQL%20Notes%20for%20Professionals_files/image262.gif"></span></p>

<h1 style='margin-left:-.25pt'><a name="_Toc228605">Chapter 24: UNION / UNION
ALL</a></h1>

<p class=MsoNormal style='margin-top:0in;margin-right:12.5pt;margin-bottom:
.2pt;margin-left:.25pt;text-align:justify;text-justify:inter-ideograph;
line-height:135%'><b><i>UNION</i></b> keyword in SQL is used to combine to <b><i>SELECT</i></b>
statement results with out any duplicate. In order to use UNION and combine
results both SELECT statement should have same number of column with same data
type in same order, but the length of column can be different.</p>

<h2 style='margin-top:0in;margin-right:12.5pt;margin-bottom:.2pt;margin-left:
.25pt;text-align:justify;text-justify:inter-ideograph;text-indent:.5pt;
line-height:135%'><a name="_Toc228606">Section 24.1: Basic UNION ALL query</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:15.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=256
src="SQL%20Notes%20for%20Professionals_files/image263.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:13.0pt;
margin-left:.25pt'>Let's say we want to extract the names of all the <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>managers</span>
from our departments.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Using a <span style='font-size:9.0pt;line-height:110%;
color:blue;background:#FAFAFA'>UNION</span> we can get all the employees from
both HR and Finance departments, which hold the <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>position</span> of a</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:15.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=252
src="SQL%20Notes%20for%20Professionals_files/image264.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=65 style='width:48.6pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=65 valign=top style='width:48.6pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:blue'>UNION</span><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:#333399'>ALL</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.45pt;
margin-left:.25pt'>The <span style='font-size:9.0pt;line-height:110%;
color:blue;background:#FAFAFA'>UNION</span> statement removes duplicate rows
from the query results. Since it is possible to have people having the same
Name and position in both departments we are using , in order not to remove
duplicates.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>If you want to use an alias for each output column, you can
just put them in the first select statement, as follows:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:0in;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=170
src="SQL%20Notes%20for%20Professionals_files/image265.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=54
src="SQL%20Notes%20for%20Professionals_files/image266.gif"></span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228607">Section 24.2: Simple explanation and Example</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.9pt;
margin-left:.25pt'>In simple terms:</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=65 style='width:48.6pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=65 valign=top style='width:48.6pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:blue'>UNION</span><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:#333399'>ALL</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:162.7pt;margin-bottom:
23.7pt;margin-left:64.35pt;text-indent:-48.6pt'><img width=13 height=1
src="SQL%20Notes%20for%20Professionals_files/image267.gif" align=left
hspace=12><span style='font-size:9.0pt;line-height:110%;color:blue;background:
#FAFAFA'>UNION</span> joins 2 result sets while removing duplicates from the
result set joins 2 result sets without attempting to remove duplicates</p>

<p class=MsoNormal style='margin-top:0in;margin-right:5.3pt;margin-bottom:24.1pt;
margin-left:24.0pt'>One mistake many people make is to use a <span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>UNION</span>
when they do not need to have the duplicates removed. The additional
performance cost against large results sets can be very significant.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.1pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>When you might need </b><b><span
style='font-size:9.0pt;line-height:111%;color:blue;background:#FAFAFA'>UNION</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.3pt;
margin-left:.25pt'>Suppose you need to filter a table against 2 different
attributes, and you have created separate non-clustered indexes for each
column. A <span style='font-size:9.0pt;line-height:110%;color:blue;background:
#FAFAFA'>UNION</span> enables you to leverage both indexes while still
preventing duplicates.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="SQL%20Notes%20for%20Professionals_files/image268.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:13.0pt;
margin-left:.25pt'>This simplifies your performance tuning since only simple
indexes are needed to perform these queries optimally. You may even be able to
get by with quite a bit fewer non-clustered indexes improving overall write
performance against the source table as well.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.15pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>When you might need </b><b><span
style='font-size:9.0pt;line-height:111%;color:blue'>UNION</span></b><b><span
style='font-size:9.0pt;line-height:111%'> </span></b><b><span style='font-size:
9.0pt;line-height:111%;color:#333399'>ALL</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.25pt;
margin-left:.25pt'>Suppose you still need to filter a table against 2
attributes, but you do not need to filter duplicate records (either because it
doesn't matter or your data wouldn't produce any duplicates during the union
due to your data model design).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="SQL%20Notes%20for%20Professionals_files/image269.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.25pt;
margin-left:.25pt'>This is especially useful when creating Views that join data
that is designed to be physically partitioned across multiple tables (maybe for
performance reasons, but still wants to roll-up records). Since the data is
already split, having the database engine remove duplicates adds no value and
just adds additional processing time to the queries.</p>

<h1 style='margin-left:-.25pt'><a name="_Toc228608">Chapter 25: ALTER TABLE</a></h1>

<p class=MsoNormal style='margin-top:0in;margin-right:147.7pt;margin-bottom:
.2pt;margin-left:.25pt;line-height:145%'>ALTER command in SQL is used to modify
column/constraint in a table</p>

<h2 style='margin-top:0in;margin-right:147.7pt;margin-bottom:.2pt;margin-left:
.25pt;text-indent:.5pt;line-height:145%'><a name="_Toc228609">Section 25.1: Add
Column(s)</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:15.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="SQL%20Notes%20for%20Professionals_files/image270.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.55pt;margin-bottom:.2pt;
margin-left:.25pt;text-align:justify;text-justify:inter-ideograph;line-height:
135%'>The above statement would add columns named <span style='font-size:9.0pt;
line-height:135%;background:#FAFAFA'>StartingDate</span> which cannot be NULL
with default value as current date and <span style='font-size:9.0pt;line-height:
135%;background:#FAFAFA'>DateOfBirth</span> which can be NULL in Employees
table.</p>

<h2 style='margin-top:0in;margin-right:.55pt;margin-bottom:.2pt;margin-left:
.25pt;text-align:justify;text-justify:inter-ideograph;text-indent:.5pt;
line-height:135%'><a name="_Toc228610">Section 25.2: Drop Column</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src="SQL%20Notes%20for%20Professionals_files/image271.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:14.95pt;margin-bottom:
.2pt;margin-left:.25pt;text-align:justify;text-justify:inter-ideograph;
line-height:135%'>This will not only delete information from that column, but
will drop the column salary from table employees(the column will no more
exist).</p>

<h2 style='margin-top:0in;margin-right:14.95pt;margin-bottom:.2pt;margin-left:
.25pt;text-align:justify;text-justify:inter-ideograph;text-indent:.5pt;
line-height:135%'><a name="_Toc228611">Section 25.3: Add Primary Key</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image272.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.25pt;
margin-left:.25pt'>This will add a Primary key to the table Employees on the
field <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>ID</span>.
Including more than one column name in the parentheses along with ID will
create a Composite Primary Key. When adding more than one column, the column
names must be separated by commas.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image273.gif"></span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:0in;margin-left:-.25pt'><a
name="_Toc228612">Section 25.4: Alter Column</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src="SQL%20Notes%20for%20Professionals_files/image274.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:26.15pt;margin-bottom:
.2pt;margin-left:.25pt;text-align:justify;text-justify:inter-ideograph;
line-height:135%'>This query will alter the column datatype of <span
style='font-size:9.0pt;line-height:135%;background:#FAFAFA'>StartingDate</span>
and change it from simple <span style='font-size:9.0pt;line-height:135%;
color:blue;background:#FAFAFA'>date</span> to <span style='font-size:9.0pt;
line-height:135%;color:blue;background:#FAFAFA'>datetime</span> and set default
to current date.</p>

<h2 style='margin-top:0in;margin-right:26.15pt;margin-bottom:.2pt;margin-left:
.25pt;text-align:justify;text-justify:inter-ideograph;text-indent:.5pt;
line-height:135%'><a name="_Toc228613">Section 25.5: Drop Constraint</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src="SQL%20Notes%20for%20Professionals_files/image275.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:13.05pt;
margin-left:.25pt'>This Drops a constraint called DefaultSalary from the
employees table definition.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'><b>Note:</b> Ensure that constraints of the column are
dropped before dropping a column.</p>

<h1 style='margin-left:-.25pt'><a name="_Toc228614">Chapter 26: INSERT</a></h1>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:0in;margin-left:-.25pt'><a
name="_Toc228615">Section 26.1: INSERT data from another table using SELECT</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src="SQL%20Notes%20for%20Professionals_files/image276.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.45pt;
margin-left:.25pt'>This example will insert all Employees into the Customers
table. Since the two tables have different fields and you don't want to move
all the fields over, you need to set which fields to insert into and which
fields to select. The correlating field names don't need to be called the same
thing, but then need to be the same data type. This example is assuming that
the Id field has an Identity Specification set and will auto increment.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.25pt;
margin-left:.25pt'>If you have two tables that have exactly the same field
names and just want to move all the records over you can use:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src="SQL%20Notes%20for%20Professionals_files/image277.gif"></span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:0in;margin-left:-.25pt'><a
name="_Toc228616">Section 26.2: Insert New Row</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:15.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src="SQL%20Notes%20for%20Professionals_files/image278.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:18.2pt;
margin-left:.25pt'>This statement will insert a new row into the <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Customers</span>
table. Note that a value was not specified for the <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>Id</span> column, as it will be added
automatically. However, all other column values must be specified.</p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:4.2pt;margin-left:
-.25pt'><a name="_Toc228617">Section 26.3: Insert Only Specified Columns</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='position:relative;z-index:
-1895784448'><span style='left:0px;position:absolute;left:0px;top:-47078px;
width:718px;height:1px'><img width=718 height=1
src="SQL%20Notes%20for%20Professionals_files/image193.gif"></span></span><span
style='font-size:9.0pt;line-height:110%;color:blue'>INSERT</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>INTO</span><span style='font-size:9.0pt;
line-height:110%'> Customers </span><span style='font-size:9.0pt;line-height:
110%;color:gray'>(</span><span style='font-size:9.0pt;line-height:110%'>FName</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>,</span><span
style='font-size:9.0pt;line-height:110%'> LName</span><span style='font-size:
9.0pt;line-height:110%;color:gray'>,</span><span style='font-size:9.0pt;
line-height:110%'> Email</span><span style='font-size:9.0pt;line-height:110%;
color:gray'>,</span><span style='font-size:9.0pt;line-height:110%'>
PreferredContact</span><span style='font-size:9.0pt;line-height:110%;
color:gray'>)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:26.95pt;margin-bottom:
17.35pt;margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;
line-height:110%;color:blue'>VALUES</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:gray'>(</span><span style='font-size:9.0pt;line-height:110%;color:red'>'Zack'</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>,</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:red'>'Smith'</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>,</span><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:red'>'zack@example.com'</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>,</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:red'>'EMAIL'</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>);</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=58 style='width:.6in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:#333399'>not</span><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:#333399'>null</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.55pt;margin-bottom:.2pt;
margin-left:.25pt;text-align:justify;text-justify:inter-ideograph;line-height:
135%'>This statement will insert a new row into the <span style='font-size:
9.0pt;line-height:135%;background:#FAFAFA'>Customers</span> table. Data will
only be inserted into the columns specified note that no value was provided for
the <span style='font-size:9.0pt;line-height:135%;background:#FAFAFA'>PhoneNumber</span>
column. Note, however, that all columns marked as must be included.</p>

<h2 style='margin-top:0in;margin-right:.55pt;margin-bottom:.2pt;margin-left:
.25pt;text-align:justify;text-justify:inter-ideograph;text-indent:.5pt;
line-height:135%'><a name="_Toc228618">Section 26.4: Insert multiple rows at
once</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:10.7pt;
margin-left:.25pt'>Multiple rows can be inserted with a single insert command:</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=317 style='width:237.65pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=151 valign=top style='width:113.4pt;background:#FAFAFA;padding:
  1.8pt 0in 0in 0in;height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:blue'>INSERT</span><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:blue'>INTO</span><span style='font-size:9.0pt;line-height:107%'>
  tbl_name </span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:gray;background:#FAFAFA'>(</span></p>
  </td>
  <td width=43 valign=top style='width:.45in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>field1</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:gray;background:#FAFAFA'>,</span></p>
  </td>
  <td width=50 valign=top style='width:37.8pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>field2</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:gray;background:#FAFAFA'>,</span></p>
  </td>
  <td width=50 valign=top style='width:37.8pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>field3</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:57.85pt;
margin-bottom:11.65pt;margin-left:0in;text-align:center;text-indent:0in;
line-height:107%'><span style='font-size:9.0pt;line-height:107%;color:gray;
background:#FAFAFA'>)</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=50 style='width:37.8pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=50 valign=top style='width:37.8pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:blue'>VALUES</span><span style='font-size:9.0pt;
  line-height:107%'> </span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.75pt;
margin-left:37.8pt;text-indent:0in;line-height:107%'><span style='position:
relative;z-index:-1895783424'><span style='left:0px;position:absolute;
left:108px;top:-47290px;width:7px;height:1px'><img width=7 height=1
src="SQL%20Notes%20for%20Professionals_files/image132.gif"></span></span><span
style='position:relative;z-index:-1895782400'><span style='left:0px;position:
absolute;left:173px;top:-47290px;width:7px;height:1px'><img width=7 height=1
src="SQL%20Notes%20for%20Professionals_files/image133.gif"></span></span><span
style='font-size:9.0pt;line-height:107%;color:gray;background:#FAFAFA'>(</span><span
style='font-size:9.0pt;line-height:107%;background:#FAFAFA'>1</span><span
style='font-size:9.0pt;line-height:107%;color:gray;background:#FAFAFA'>,</span><span
style='font-size:9.0pt;line-height:107%;background:#FAFAFA'>2</span><span
style='font-size:9.0pt;line-height:107%;color:gray;background:#FAFAFA'>,</span><span
style='font-size:9.0pt;line-height:107%;background:#FAFAFA'>3</span><span
style='font-size:9.0pt;line-height:107%;color:gray;background:#FAFAFA'>),</span><span
style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
line-height:107%;color:gray;background:#FAFAFA'>(</span><span style='font-size:
9.0pt;line-height:107%;background:#FAFAFA'>4</span><span style='font-size:9.0pt;
line-height:107%;color:gray;background:#FAFAFA'>,</span><span style='font-size:
9.0pt;line-height:107%;background:#FAFAFA'>5</span><span style='font-size:9.0pt;
line-height:107%;color:gray;background:#FAFAFA'>,</span><span style='font-size:
9.0pt;line-height:107%;background:#FAFAFA'>6</span><span style='font-size:9.0pt;
line-height:107%;color:gray;background:#FAFAFA'>),</span><span
style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
line-height:107%;color:gray;background:#FAFAFA'>(</span><span style='font-size:
9.0pt;line-height:107%;background:#FAFAFA'>7</span><span style='font-size:9.0pt;
line-height:107%;color:gray;background:#FAFAFA'>,</span><span style='font-size:
9.0pt;line-height:107%;background:#FAFAFA'>8</span><span style='font-size:9.0pt;
line-height:107%;color:gray;background:#FAFAFA'>,</span><span style='font-size:
9.0pt;line-height:107%;background:#FAFAFA'>9</span><span style='font-size:9.0pt;
line-height:107%;color:gray;background:#FAFAFA'>);</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.45pt;
margin-left:.25pt'>For inserting large quantities of data (bulk insert) at the
same time, DBMS-specific features and recommendations exist.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.05pt;
margin-left:-.25pt;text-indent:-.5pt;line-height:107%'>MySQL - <a
href="http://dev.mysql.com/doc/refman/5.7/en/load-data.html"><span
style='color:#F31D19'>LOAD DATA INFILE</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.05pt;
margin-left:-.25pt;text-indent:-.5pt;line-height:107%'>MSSQL - <a
href="https://msdn.microsoft.com/en-us/library/ms188365.aspx"><span
style='color:#F31D19'>BULK INSERT</span></a></p>

<h1 style='margin-left:-.25pt'><a name="_Toc228619">Chapter 27: MERGE</a></h1>

<p class=MsoNormal style='margin-top:0in;margin-right:4.7pt;margin-bottom:.2pt;
margin-left:.25pt;text-align:justify;text-justify:inter-ideograph;line-height:
135%'>MERGE (often also called UPSERT for &quot;update or insert&quot;) allows
to insert new rows or, if a row already exists, to update the existing row. The
point is to perform the whole set of operations atomically (to guarantee that
the data remain consistent), and to prevent communication overhead for multiple
SQL statements in a client/server system.</p>

<h2 style='margin-top:0in;margin-right:4.7pt;margin-bottom:.2pt;margin-left:
.25pt;text-align:justify;text-justify:inter-ideograph;text-indent:.5pt;
line-height:135%'><a name="_Toc228620">Section 27.1: MERGE to make Target match
Source</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:15.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=306
src="SQL%20Notes%20for%20Professionals_files/image279.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=101 style='width:1.05in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=101 valign=top style='width:1.05in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:#333399'>AND</span><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:#333399'>NOT</span><span style='font-size:9.0pt;line-height:107%'> </span><span
  style='font-size:9.0pt;line-height:107%;color:#333399'>EXISTS</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:4.7pt;margin-bottom:.2pt;
margin-left:.25pt;text-align:justify;text-justify:inter-ideograph;line-height:
135%'>Note: The portion prevents updating records that haven't changed. Using
the <span style='font-size:9.0pt;line-height:135%;color:blue;background:#FAFAFA'>INTERSECT</span>
construct allows nullable columns to be compared without special handling.</p>

<h2 style='margin-top:0in;margin-right:4.7pt;margin-bottom:.2pt;margin-left:
.25pt;text-align:justify;text-justify:inter-ideograph;text-indent:.5pt;
line-height:135%'><a name="_Toc228621">Section 27.2: MySQL: counting users by
name</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Suppose we want to know how many users have the same name.
Let us create table <span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>users</span> as follows:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=109
src="SQL%20Notes%20for%20Professionals_files/image280.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.7pt;
margin-left:.25pt'>Now, we just discovered a new user named Joe and would like
to take him into account. To achieve that, we need to determine whether there
is an existing row with his name, and if so, update it to increment count; on
the other hand, if there is no existing row, we should create it.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>MySQL uses the following syntax : <a
href="https://dev.mysql.com/doc/refman/5.7/en/insert-on-duplicate.html"><span
style='color:#F31D19'>insert </span></a><a
href="https://dev.mysql.com/doc/refman/5.7/en/insert-on-duplicate.html"><span
style='font-family:"Arial",sans-serif;color:#F31D19'></span></a><a
href="https://dev.mysql.com/doc/refman/5.7/en/insert-on-duplicate.html"><span
style='color:#F31D19'> on duplicate key update </span></a><a
href="https://dev.mysql.com/doc/refman/5.7/en/insert-on-duplicate.html"><span
style='font-family:"Arial",sans-serif;color:#F31D19'></span></a>. In this
case:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="SQL%20Notes%20for%20Professionals_files/image281.gif"></span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228622">Section 27.3: PostgreSQL: counting users by name</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Suppose we want to know how many users have the same name.
Let us create table <span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>users</span> as follows:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=92
src="SQL%20Notes%20for%20Professionals_files/image282.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.7pt;
margin-left:.25pt'>Now, we just discovered a new user named Joe and would like
to take him into account. To achieve that, we need to determine whether there
is an existing row with his name, and if so, update it to increment count; on
the other hand, if there is no existing row, we should create it.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>PostgreSQL uses the following syntax : <a
href="https://www.postgresql.org/docs/current/static/sql-insert.html"><span
style='color:#F31D19'>insert </span></a><a
href="https://www.postgresql.org/docs/current/static/sql-insert.html"><span
style='font-family:"Arial",sans-serif;color:#F31D19'></span></a><a
href="https://www.postgresql.org/docs/current/static/sql-insert.html"><span
style='color:#F31D19'> on conflict </span></a><a
href="https://www.postgresql.org/docs/current/static/sql-insert.html"><span
style='font-family:"Arial",sans-serif;color:#F31D19'></span></a><a
href="https://www.postgresql.org/docs/current/static/sql-insert.html"><span
style='color:#F31D19'> do update </span></a><a
href="https://www.postgresql.org/docs/current/static/sql-insert.html"><span
style='font-family:"Arial",sans-serif;color:#F31D19'></span></a>. In this
case:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:0in;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="SQL%20Notes%20for%20Professionals_files/image283.gif"></span><br
clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc228623">Chapter 28: cross apply,
outer apply</a></h1>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228624">Section 28.1: CROSS APPLY and OUTER APPLY basics</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>Apply will be used when when table valued function in the
right expression.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.45pt;
margin-left:.25pt'>create a Department table to hold information about
departments. Then create an Employee table which hold information about the
employees. Please note, each employee belongs to a department, hence the
Employee table has referential integrity with the Department table.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.25pt;
margin-left:.25pt'>First query selects data from Department table and uses
CROSS APPLY to evaluate the Employee table for each record of the Department
table. Second query simply joins the Department table with the Employee table
and all the matching records are produced.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=207
src="SQL%20Notes%20for%20Professionals_files/image284.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.45pt;
margin-left:.25pt'>If you look at the results they produced, it is the exact
same result-set; How does it differ from a JOIN and how does it help in writing
more efficient queries.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.25pt;
margin-left:.25pt'>The first query in Script #2 selects data from Department
table and uses OUTER APPLY to evaluate the Employee table for each record of
the Department table. For those rows for which there is not a match in Employee
table, those rows contains NULL values as you can see in case of row 5 and 6.
The second query simply uses a LEFT OUTER JOIN between the Department table and
the Employee table. As expected the query returns all rows from Department
table; even for those rows for which there is no match in the Employee table.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=223
src="SQL%20Notes%20for%20Professionals_files/image285.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.45pt;
margin-left:.25pt'>Even though the above two queries return the same
information, the execution plan will be bit different. But cost wise there will
be not much difference.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.25pt;
margin-left:.25pt'>Now comes the time to see where the APPLY operator is really
required. In Script #3, I am creating a table-valued function which accepts
DepartmentID as its parameter and returns all the employees who belong to this
department. The next query selects data from Department table and uses CROSS
APPLY to join with the function we created. It passes the DepartmentID for each
row from the outer table expression (in our case Department table) and
evaluates the function for each row similar to a correlated subquery. The next
query uses the OUTER APPLY in place of CROSS APPLY and hence unlike CROSS APPLY
which returned only correlated data, the OUTER APPLY returns non-correlated
data as well, placing NULLs into the missing columns.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=355
src="SQL%20Notes%20for%20Professionals_files/image286.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.25pt;
margin-left:.25pt'>So now if you are wondering, can we use a simple join in
place of the above queries? Then the answer is NO, if you replace CROSS/OUTER
APPLY in the above queries with INNER JOIN/LEFT OUTER JOIN, specify ON clause
(something as 1=1) and run the query, you will get &quot;The multi-part
identifier &quot;D.DepartmentID&quot; could not be bound.&quot; error. This is
because with JOINs the execution context of outer query is different from the
execution context of the function (or a derived table), and you can not bind a
value/variable from the outer query to the function as a parameter. Hence the
APPLY operator is required for such queries.</p>

<h1 style='margin-left:-.25pt'><a name="_Toc228625">Chapter 29: DELETE</a></h1>

<p class=MsoNormal style='margin-top:0in;margin-right:190.7pt;margin-bottom:
.2pt;margin-left:.25pt;line-height:145%'>The DELETE statement is used to delete
records from a table.</p>

<h2 style='margin-top:0in;margin-right:190.7pt;margin-bottom:.2pt;margin-left:
.25pt;text-indent:.5pt;line-height:145%'><a name="_Toc228626">Section 29.1:
DELETE all rows</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Omitting a <span style='font-size:9.0pt;line-height:110%;
color:blue;background:#FAFAFA'>WHERE</span> clause will delete all rows from a
table.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image287.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.55pt;margin-bottom:.2pt;
margin-left:.25pt;text-align:justify;text-justify:inter-ideograph;line-height:
135%'>See TRUNCATE documentation for details on how TRUNCATE performance can be
better because it ignores triggers and indexes and logs to just delete the
data.</p>

<h2 style='margin-top:0in;margin-right:.55pt;margin-bottom:.2pt;margin-left:
.25pt;text-align:justify;text-justify:inter-ideograph;text-indent:.5pt;
line-height:135%'><a name="_Toc228627">Section 29.2: DELETE certain rows with
WHERE</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>This will delete all rows that match the <span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>WHERE</span>
criteria.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src="SQL%20Notes%20for%20Professionals_files/image288.gif"></span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228628">Section 29.3: TRUNCATE clause</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.25pt;
margin-left:.25pt'>Use this to reset the table to the condition at which it was
created. This deletes all rows and resets values such as auto-increment. It
also doesn't log each individual row deletion.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image289.gif"></span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228629">Section 29.4: DELETE certain rows based upon
comparisons with other tables</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.95pt;
margin-left:.25pt'>It is possible to <span style='font-size:9.0pt;line-height:
110%;color:blue;background:#FAFAFA'>DELETE</span> data from a table if it
matches (or mismatches) certain data in other tables.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Let's assume we want to <span style='font-size:9.0pt;
line-height:110%;color:blue;background:#FAFAFA'>DELETE</span>data from Source
once its loaded into Target.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=76
src="SQL%20Notes%20for%20Professionals_files/image290.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.5pt;
margin-left:.25pt'>Most common RDBMS implementations (e.g. MySQL, Oracle,
PostgresSQL, Teradata) allow tables to be joined during <span style='font-size:
9.0pt;line-height:110%;color:blue;background:#FAFAFA'>DELETE</span> allowing
more complex comparison in a compact syntax.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.45pt;
margin-left:.25pt'>Adding complexity to original scenario, let's assume
Aggregate is built from Target once a day and does not contain the same ID but
contains the same date. Let us also assume that we want to delete data from
Source <i>only</i> after the aggregate is populated for the day.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>On MySQL, Oracle and Teradata this can be done using:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="SQL%20Notes%20for%20Professionals_files/image291.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>In PostgreSQL use:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=76
src="SQL%20Notes%20for%20Professionals_files/image292.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.45pt;
margin-left:.25pt'>This essentially results in INNER JOINs between Source,
Target and Aggregate. The deletion is performed on Source when the same IDs
exist in Target AND date present in Target for those IDs also exists in
Aggregate.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:14.45pt;
margin-left:.25pt'>Same query may also be written (on MySQL, Oracle, Teradata)
as:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%;color:blue'>DELETE</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:blue'>Source</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%;color:blue'>FROM</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:blue'>Source</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>,</span><span
style='font-size:9.0pt;line-height:110%'> TargetSchema</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>.</span><span
style='font-size:9.0pt;line-height:110%;color:blue'>Target</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>,</span><span
style='font-size:9.0pt;line-height:110%'> AggregateSchema</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>.</span><span
style='font-size:9.0pt;line-height:110%;color:blue'>Aggregate</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%;color:blue'>WHERE</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:blue'>Source</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>.</span><span
style='font-size:9.0pt;line-height:110%;color:#25256F'>ID</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:gray'>=</span><span style='font-size:9.0pt;line-height:
110%'> TargetSchema</span><span style='font-size:9.0pt;line-height:110%;
color:gray'>.</span><span style='font-size:9.0pt;line-height:110%;color:blue'>Target</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>.</span><span
style='font-size:9.0pt;line-height:110%;color:#25256F'>ID</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:17.35pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='position:relative;z-index:
-1895781376'><span style='left:0px;position:absolute;left:0px;top:-51379px;
width:718px;height:1px'><img width=718 height=1
src="SQL%20Notes%20for%20Professionals_files/image293.gif"></span></span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:
9.0pt;line-height:110%;color:#333399'>AND</span><span style='font-size:9.0pt;
line-height:110%'> TargetSchema</span><span style='font-size:9.0pt;line-height:
110%;color:gray'>.</span><span style='font-size:9.0pt;line-height:110%;
color:blue'>Target</span><span style='font-size:9.0pt;line-height:110%;
color:gray'>.</span><span style='font-size:9.0pt;line-height:110%;color:#25256F'>DataDate</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:gray'>=</span><span style='font-size:9.0pt;line-height:
110%'> AggregateSchema</span><span style='font-size:9.0pt;line-height:110%;
color:gray'>.</span><span style='font-size:9.0pt;line-height:110%;color:blue'>Aggregate</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>.</span><span
style='font-size:9.0pt;line-height:110%;color:#25256F'>AggDate</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.45pt;
margin-left:.25pt'>Explicit joins may be mentioned in <span style='font-size:
9.0pt;line-height:110%;color:blue;background:#FAFAFA'>Delete</span> statements
on some RDBMS implementations (e.g. Oracle, MySQL) but not supported on all
platforms (e.g. Teradata does not support them)</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=72 style='width:.75in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=72 valign=top style='width:.75in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:#333399'>NOT</span><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:#333399'>EXISTS</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.25pt;
margin-left:54.25pt;text-indent:-.75in'>Comparisons can be designed to check
mismatch scenarios instead of matching ones with all syntax styles (observe
below)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:0in;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=76
src="SQL%20Notes%20for%20Professionals_files/image294.gif"></span><br
clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc228630">Chapter 30: TRUNCATE</a></h1>

<p class=MsoNormal style='margin-top:0in;margin-right:15.95pt;margin-bottom:
.2pt;margin-left:.25pt;text-align:justify;text-justify:inter-ideograph;
line-height:135%'>The TRUNCATE statement deletes all data from a table. This is
similar to DELETE with no filter, but, depending on the database software, has
certain restrictions and optimizations.</p>

<h2 style='margin-top:0in;margin-right:15.95pt;margin-bottom:.2pt;margin-left:
.25pt;text-align:justify;text-justify:inter-ideograph;text-indent:.5pt;
line-height:135%'><a name="_Toc228631">Section 30.1: Removing all rows from the
Employee table</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image295.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.45pt;
margin-left:.25pt'>Using truncate table is often better then using DELETE TABLE
as it ignores all the indexes and triggers and just removes everything.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.45pt;
margin-left:.25pt'>Delete table is a row based operation this means that each
row is deleted. Truncate table is a data page operation the entire data page is
reallocated. If you have a table with a million rows it will be much faster to
truncate the table than it would be to use a delete table statement.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.7pt;
margin-left:.25pt'>Though we can delete specific Rows with DELETE, we cannot
TRUNCATE specific rows, we can only TRUNCATE all the records at once. Deleting
All rows and then inserting a new record will continue to add the Auto
incremented Primary key value from the previously inserted value, where as in
Truncate, the Auto Incremental primary key value will also get reset and starts
from 1.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Note that when truncating table, <b>no foreign keys must be
present</b>, otherwise you will get an error.<br clear=all style='page-break-before:
always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc228632">Chapter 31: DROP Table</a></h1>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228633">Section 31.1: Check for existence before dropping</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:-.25pt;text-indent:-.5pt;line-height:107%'>MySQL <span
style='font-size:8.0pt;line-height:107%;font-family:"DejaVu Sans Mono";
color:#666666'>Version &#8805; 3.19</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:2.4pt;
margin-left:.5pt;text-indent:-.5pt'><span style='font-size:11.0pt;line-height:
110%'><img border=0 width=718 height=26 id="Group 189964"
src="SQL%20Notes%20for%20Professionals_files/image296.gif"></span><span
style='font-size:9.0pt;line-height:110%;color:blue'>DROP</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>TABLE</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:blue'>IF</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:#333399'>EXISTS</span><span
style='font-size:9.0pt;line-height:110%'> MyTable</span><span style='font-size:
9.0pt;line-height:110%;color:gray'>;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:-.25pt;text-indent:-.5pt;line-height:107%'>PostgreSQL <span
style='font-size:8.0pt;line-height:107%;font-family:"DejaVu Sans Mono";
color:#666666'>Version &#8805; 8.x</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:2.45pt;
margin-left:.5pt;text-indent:-.5pt'><span style='font-size:11.0pt;line-height:
110%'><img border=0 width=718 height=26 id="Group 189965"
src="SQL%20Notes%20for%20Professionals_files/image296.gif"></span><span
style='font-size:9.0pt;line-height:110%;color:blue'>DROP</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>TABLE</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:blue'>IF</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:#333399'>EXISTS</span><span
style='font-size:9.0pt;line-height:110%'> MyTable</span><span style='font-size:
9.0pt;line-height:110%;color:gray'>;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:-.25pt;text-indent:-.5pt;line-height:107%'>SQL Server <span
style='font-size:8.0pt;line-height:107%;font-family:"DejaVu Sans Mono";
color:#666666'>Version &#8805; 2005</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:3.75pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=76
src="SQL%20Notes%20for%20Professionals_files/image297.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=42
src="SQL%20Notes%20for%20Professionals_files/image298.gif"></span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:0in;margin-left:-.25pt'><a
name="_Toc228634">Section 31.2: Simple drop</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:0in;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image299.gif"></span><br
clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc228635">Chapter 32: DROP or DELETE
Database</a></h1>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228636">Section 32.1: DROP Database</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:30.8pt;margin-bottom:
.2pt;margin-left:.25pt;line-height:169%'>Dropping the database is a simple
one-liner statement. Drop database will delete the database, hence always
ensure to have a backup of the database if required. Below is the command to
drop Employees Database</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:0in;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image300.gif"></span><br
clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc228637">Chapter 33: Cascading
Delete</a></h1>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228638">Section 33.1: ON DELETE CASCADE</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.6pt;
margin-left:.25pt'>Assume you have a application that administers rooms.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.6pt;
margin-left:.25pt'>Assume further that your application operates on a per
client basis (tenant).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.6pt;
margin-left:.25pt'>You have several clients.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>So your database will contain one table for clients, and one
for rooms.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>Now, every client has N rooms.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>This should mean that you have a foreign key on your room
table, referencing the client table.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="SQL%20Notes%20for%20Professionals_files/image301.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Assuming a client moves on to some other software, you'll
have to delete his data in your software. But if you do</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image302.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>Then you'll get a foreign key violation, because you can't
delete the client when he still has rooms.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.45pt;
margin-left:.25pt'>Now you'd have write code in your application that deletes
the client's rooms before it deletes the client. Assume further that in the
future, many more foreign key dependencies will be added in your database,
because your application's functionality expands. Horrible. For every
modification in your database, you'll have to adapt your application's code in
N places. Possibly you'll have to adapt code in other applications as well
(e.g. interfaces to other systems).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.6pt;
margin-left:.25pt'>There is a better solution than doing it in your code.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=122 style='width:91.8pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=122 valign=top style='width:91.8pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:blue'>ON</span><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:blue'>DELETE</span><span style='font-size:9.0pt;line-height:107%'> </span><span
  style='font-size:9.0pt;line-height:107%;color:blue'>CASCADE</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:14.45pt;
margin-left:.25pt'>You can just add to your foreign key.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='position:relative;z-index:
-1895780352'><span style='left:0px;position:absolute;left:0px;top:-53242px;
width:718px;height:1px'><img width=718 height=1
src="SQL%20Notes%20for%20Professionals_files/image293.gif"></span></span><span
style='font-size:9.0pt;line-height:110%;color:blue'>ALTER</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>TABLE</span><span style='font-size:9.0pt;
line-height:110%'> dbo</span><span style='font-size:9.0pt;line-height:110%;
color:gray'>.</span><span style='font-size:9.0pt;line-height:110%;color:#25256F'>T_Room</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:green'>-- WITH CHECK -- SQL-Server can specify WITH
CHECK/WITH NOCHECK</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%;color:blue'>ADD</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:blue'>CONSTRAINT</span><span
style='font-size:9.0pt;line-height:110%'> FK_T_Room_T_Client </span><span
style='font-size:9.0pt;line-height:110%;color:blue'>FOREIGN</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>KEY</span><span style='font-size:9.0pt;line-height:
110%;color:gray'>(</span><span style='font-size:9.0pt;line-height:110%'>RM_CLI_ID</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%;color:blue'>REFERENCES</span><span style='font-size:9.0pt;line-height:
110%'> dbo</span><span style='font-size:9.0pt;line-height:110%;color:gray'>.</span><span
style='font-size:9.0pt;line-height:110%;color:#25256F'>T_Client</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:gray'>(</span><span style='font-size:9.0pt;line-height:
110%'>CLI_ID</span><span style='font-size:9.0pt;line-height:110%;color:gray'>)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:421.6pt;margin-bottom:
.15pt;margin-left:0in;text-indent:3.75pt;line-height:240%'><span
style='font-size:9.0pt;line-height:240%;color:blue'>ON</span><span
style='font-size:9.0pt;line-height:240%'> </span><span style='font-size:9.0pt;
line-height:240%;color:blue'>DELETE</span><span style='font-size:9.0pt;
line-height:240%'> </span><span style='font-size:9.0pt;line-height:240%;
color:blue'>CASCADE </span>Now you can say</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image303.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:183.35pt;margin-bottom:
12.45pt;margin-left:.25pt'>and the rooms are automagically deleted when the
client is deleted. Problem solved - with no application code changes.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:14.1pt;
margin-left:.25pt'>One word of caution: In Microsoft SQL-Server, this won't
work if you have a table that references itselfs. So if you try to define a
delete cascade on a recursive tree structure, like this:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
margin-left:3.75pt;text-indent:0in;line-height:107%'><span style='font-size:
9.0pt;line-height:107%;color:blue'>IF</span><span style='font-size:9.0pt;
line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
color:#333399'>NOT</span><span style='font-size:9.0pt;line-height:107%'> </span><span
style='font-size:9.0pt;line-height:107%;color:#333399'>EXISTS</span><span
style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
line-height:107%;color:gray'>(</span><span style='font-size:9.0pt;line-height:
107%;color:blue'>SELECT</span><span style='font-size:9.0pt;line-height:107%'> </span><span
style='font-size:9.0pt;line-height:107%;color:gray'>*</span><span
style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
line-height:107%;color:blue'>FROM</span><span style='font-size:9.0pt;
line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
color:#333399'>sys</span><span style='font-size:9.0pt;line-height:107%;
color:gray'>.</span><span style='font-size:9.0pt;line-height:107%;color:#333399'>foreign_keys</span><span
style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
line-height:107%;color:blue'>WHERE</span><span style='font-size:9.0pt;
line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
color:fuchsia'>object_id</span><span style='font-size:9.0pt;line-height:107%'> </span><span
style='font-size:9.0pt;line-height:107%;color:gray'>=</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:26.95pt;margin-bottom:
.1pt;margin-left:3.5pt;text-indent:-.5pt'><span style='position:relative;
z-index:-1895779328'><span style='left:0px;position:absolute;left:0px;
top:-53555px;width:718px;height:1px'><img width=718 height=1
src="SQL%20Notes%20for%20Professionals_files/image304.gif"></span></span><span
style='font-size:9.0pt;line-height:110%;color:fuchsia'>OBJECT_ID</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>(</span><span
style='font-size:9.0pt;line-height:110%;color:red'>N'[dbo].[FK_T_FMS_Navigation_T_FMS_Navigation]'</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>)</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#333399'>AND</span><span style='font-size:9.0pt;
line-height:110%'> parent_object_id </span><span style='font-size:9.0pt;
line-height:110%;color:gray'>=</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:26.95pt;margin-bottom:
.1pt;margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;
line-height:110%;color:fuchsia'>OBJECT_ID</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>(</span><span style='font-size:9.0pt;line-height:
110%;color:red'>N'[dbo].[T_FMS_Navigation]'</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>))</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%;color:blue'>ALTER</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:blue'>TABLE</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:gray'>[</span><span style='font-size:9.0pt;line-height:
110%'>dbo</span><span style='font-size:9.0pt;line-height:110%;color:gray'>].[</span><span
style='font-size:9.0pt;line-height:110%'>T_FMS_Navigation</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>]</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>WITH</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:blue'>CHECK</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:blue'>ADD</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>CONSTRAINT</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%;color:gray'>[</span><span style='font-size:9.0pt;line-height:110%'>FK_T_FMS_Navigation_T_FMS_Navigation</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>]</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>FOREIGN</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:blue'>KEY</span><span style='font-size:9.0pt;line-height:110%;color:gray'>([</span><span
style='font-size:9.0pt;line-height:110%'>NA_NA_UID</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>])</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%;color:blue'>REFERENCES</span><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:gray'>[</span><span
style='font-size:9.0pt;line-height:110%'>dbo</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>].[</span><span style='font-size:9.0pt;line-height:
110%'>T_FMS_Navigation</span><span style='font-size:9.0pt;line-height:110%;
color:gray'>]</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:gray'>([</span><span
style='font-size:9.0pt;line-height:110%'>NA_UID</span><span style='font-size:
9.0pt;line-height:110%;color:gray'>])</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%;color:blue'>ON</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:blue'>DELETE</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>CASCADE</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=719 height=120
src="SQL%20Notes%20for%20Professionals_files/image305.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=122 style='width:91.8pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=122 valign=top style='width:91.8pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:blue'>ON</span><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:blue'>DELETE</span><span style='font-size:9.0pt;line-height:107%'> </span><span
  style='font-size:9.0pt;line-height:107%;color:blue'>CASCADE</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.6pt;
margin-left:.25pt'>it won't work, because Microsoft-SQL-server doesn't allow
you to set a foreign key with on a</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.45pt;
margin-left:.25pt'>recursive tree structure. One reason for this is, that the
tree is possibly cyclic, and that would possibly lead to a deadlock.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:325.95pt;margin-bottom:
1.25pt;margin-left:.25pt'>PostgreSQL on the other hand can do this; the
requirement is that the tree is non-cyclic.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.6pt;
margin-left:.25pt'>If the tree is cyclic, you'll get a runtime error.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:13.05pt;
margin-left:.25pt'>In that case, you'll just have to implement the delete
function yourselfs.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>A word of caution:</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.25pt;
margin-left:.25pt'>This means you can't simply delete and re-insert the client
table anymore, because if you do this, it will delete all entries in
&quot;T_Room&quot;... (no non-delta updates anymore)<br clear=all
style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc228639">Chapter 34: GRANT and
REVOKE</a></h1>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:0in;margin-left:-.25pt'><a
name="_Toc228640">Section 34.1: Grant/revoke privileges</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:15.3pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="SQL%20Notes%20for%20Professionals_files/image306.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:13.75pt;
margin-left:.25pt'>Grant <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>User1</span> and <span style='font-size:9.0pt;line-height:
110%;background:#FAFAFA'>User2</span> permission to perform <span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>SELECT</span>
and <span style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>UPDATE</span>
operations on table <span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>Employees</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:15.15pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="SQL%20Notes%20for%20Professionals_files/image307.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Revoke from <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>User1</span> and <span style='font-size:9.0pt;line-height:
110%;background:#FAFAFA'>User2</span> the permission to perform <span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>SELECT</span>
and <span style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>UPDATE</span>
operations on table Employees.<br clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc228641">Chapter 35: XML</a></h1>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:0in;margin-left:-.25pt'><a
name="_Toc228642">Section 35.1: Query from XML Data Type</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=371
src="SQL%20Notes%20for%20Professionals_files/image308.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Results</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:0in;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=190
src="SQL%20Notes%20for%20Professionals_files/image309.gif"></span></p>

<h1 style='margin-left:-.25pt'><a name="_Toc228643">Chapter 36: Primary Keys</a></h1>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:0in;margin-left:-.25pt'><a
name="_Toc228644">Section 36.1: Creating a Primary Key</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=92
src="SQL%20Notes%20for%20Professionals_files/image310.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.45pt;
margin-left:.25pt'>This will create the Employees table with 'Id' as its
primary key. The primary key can be used to uniquely identify the rows of a
table. Only one primary key is allowed per table.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>A key can also be composed by one or more fields, so called
composite key, with the following syntax:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=92
src="SQL%20Notes%20for%20Professionals_files/image311.gif"></span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228645">Section 36.2: Using Auto Increment</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.7pt;
margin-left:.25pt'>Many databases allow to make the primary key value
automatically increment when a new key is added. This ensures that every key is
different.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:-.25pt;text-indent:-.5pt;line-height:107%'><a
href="https://dev.mysql.com/doc/refman/5.7/en/create-table.html#create-table-types-attributes"><b><span
style='color:#F31D19'>MySQL</span></b></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=76
src="SQL%20Notes%20for%20Professionals_files/image312.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:-.25pt;text-indent:-.5pt;line-height:107%'><a
href="https://www.postgresql.org/docs/current/static/datatype-numeric.html#DATATYPE-SERIAL"><b><span
style='color:#F31D19'>PostgreSQL</span></b></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="SQL%20Notes%20for%20Professionals_files/image313.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:-.25pt;text-indent:-.5pt;line-height:107%'><a
href="https://msdn.microsoft.com/en-us/library/ms186775.aspx"><b><span
style='color:#F31D19'>SQL Server</span></b></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=76
src="SQL%20Notes%20for%20Professionals_files/image314.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:-.25pt;text-indent:-.5pt;line-height:107%'><a
href="http://www.sqlite.org/autoinc.html"><b><span style='color:#F31D19'>SQLite</span></b></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:0in;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="SQL%20Notes%20for%20Professionals_files/image315.gif"></span></p>

<h1 style='margin-left:-.25pt'><a name="_Toc228646">Chapter 37: Indexes</a></h1>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.45pt;
margin-left:.25pt'>Indexes are a data structure that contains pointers to the
contents of a table arranged in a specific order, to help the database optimize
queries. They are similar to the index of book, where the pages (rows of the
table) are indexed by their page number.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:35.3pt;margin-bottom:
.2pt;margin-left:.25pt;text-align:justify;text-justify:inter-ideograph;
line-height:135%'>Several types of indexes exist, and can be created on a
table. When an index exists on the columns used in a query's WHERE clause, JOIN
clause, or ORDER BY clause, it can substantially improve query performance.</p>

<h2 style='margin-top:0in;margin-right:35.3pt;margin-bottom:.2pt;margin-left:
.25pt;text-align:justify;text-justify:inter-ideograph;text-indent:.5pt;
line-height:135%'><a name="_Toc228647">Section 37.1: Sorted Index</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.3pt;
margin-left:.25pt'>If you use an index that is sorted the way you would
retrieve it, the <span style='font-size:9.0pt;line-height:110%;color:blue;
background:#FAFAFA'>SELECT</span> statement would not do additional sorting
when in retrieval.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image316.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>When you execute the query</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image317.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:14.45pt;margin-bottom:
.2pt;margin-left:.25pt;line-height:145%'>The database system would not do
additional sorting, since it can do an index-lookup in that order.</p>

<h2 style='margin-top:0in;margin-right:14.45pt;margin-bottom:.2pt;margin-left:
.25pt;text-indent:.5pt;line-height:145%'><a name="_Toc228648">Section 37.2:
Partial or Filtered Index</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.95pt;
margin-left:.25pt'>SQL Server and SQLite allow to create indexes that contain
not only a subset of columns, but also a subset of rows.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.7pt;
margin-left:.25pt'>Consider a constant growing amount of orders with <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>order_state_id</span>
equal to finished (2), and a stable amount of orders with <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>order_state_id
equal</span> to started (1).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>If your business make use of queries like this:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=76
src="SQL%20Notes%20for%20Professionals_files/image318.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Partial indexing allows you to limit the index, including
only the unfinished orders:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="SQL%20Notes%20for%20Professionals_files/image319.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt;line-height:145%'>This index will be smaller than an
unfiltered index, which saves space and reduces the cost of updating the index.</p>

<h2 style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;margin-left:
.25pt;text-indent:.5pt;line-height:145%'><a name="_Toc228649">Section 37.3:
Creating an Index</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image320.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.25pt;
margin-left:.25pt'>This will create an index for the column <i>EmployeeId</i>
in the table <i>Cars</i>. This index will improve the speed of queries asking
the server to sort or select by values in <i>EmployeeId</i>, such as the
following:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:0in;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image321.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:14.45pt;
margin-left:.25pt'>The index can contain more than 1 column, as in the
following;</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:17.25pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='position:relative;z-index:
-1895778304'><span style='left:0px;position:absolute;left:0px;top:-56870px;
width:718px;height:1px'><img width=718 height=1
src="SQL%20Notes%20for%20Professionals_files/image134.gif"></span></span><span
style='font-size:9.0pt;line-height:110%;color:blue'>CREATE</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>INDEX</span><span style='font-size:9.0pt;
line-height:110%'> ix_cars_e_c_o_ids </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>ON</span><span style='font-size:9.0pt;line-height:
110%'> Cars </span><span style='font-size:9.0pt;line-height:110%;color:gray'>(</span><span
style='font-size:9.0pt;line-height:110%'>EmployeeId</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>,</span><span
style='font-size:9.0pt;line-height:110%'> CarId</span><span style='font-size:
9.0pt;line-height:110%;color:gray'>,</span><span style='font-size:9.0pt;
line-height:110%'> OwnerId</span><span style='font-size:9.0pt;line-height:110%;
color:gray'>);</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.45pt;
margin-left:.25pt'>In this case, the index would be useful for queries asking
to sort or select by all included columns, if the set of conditions is ordered
in the same way. That means that when retrieving the data, it can find the rows
to retrieve using the index, instead of looking through the full table.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>For example, the following case would utilize the second
index;</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image322.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>If the order differs, however, the index does not have the
same advantages, as in the following;</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image323.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=86 style='width:.9in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>OwnerId </span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:gray;background:#FAFAFA'>=</span></p>
  </td>
  <td width=22 valign=top style='width:16.2pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>17</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.45pt;
margin-left:.25pt'>The index is not as helpful because the database must
retrieve the entire index, across all values of EmployeeId and CarID, in order
to find which items have .</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:18.2pt;
margin-left:.25pt'>(The index may still be used; it may be the case that the
query optimizer finds that retrieving the index and filtering on the <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>OwnerId</span>,
then retrieving only the needed rows is faster than retrieving the full table,
especially if the table is large.)</p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:0in;margin-left:-.25pt'><a
name="_Toc228650">Section 37.4: Dropping an Index, or Disabling and Rebuilding
it</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:15.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image324.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.45pt;
margin-left:.25pt'>We can use command <span style='font-size:9.0pt;line-height:
110%;color:blue;background:#FAFAFA'>DROP</span> to delete our index. In this
example we will <span style='font-size:9.0pt;line-height:110%;color:blue;
background:#FAFAFA'>DROP</span> the index called <i>ix_cars_employee_id</i> on
the table <i>Cars</i>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.25pt;
margin-left:.25pt'>This deletes the index entirely, and if the index is
clustered, will remove any clustering. It cannot be rebuilt without recreating
the index, which can be slow and computationally expensive. As an alternative,
the index can be disabled:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image325.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>This allows the table to retain the structure, along with
the metadata about the index.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.25pt;
margin-left:.25pt'>Critically, this retains the index statistics, so that it is
possible to easily evaluate the change. If warranted, the index can then later
be rebuilt, instead of being recreated completely;</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image326.gif"></span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228651">Section 37.5: Clustered, Unique, and Sorted
Indexes</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:14.45pt;
margin-left:.25pt'>Indexes can have several characteristics that can be set
either at creation, or by altering existing indexes.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:17.25pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='position:relative;z-index:
-1895777280'><span style='left:0px;position:absolute;left:0px;top:-57652px;
width:718px;height:1px'><img width=718 height=1
src="SQL%20Notes%20for%20Professionals_files/image135.gif"></span></span><span
style='font-size:9.0pt;line-height:110%;color:blue'>CREATE</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>CLUSTERED</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:blue'>INDEX</span><span style='font-size:9.0pt;line-height:110%'>
ix_clust_employee_id </span><span style='font-size:9.0pt;line-height:110%;
color:blue'>ON</span><span style='font-size:9.0pt;line-height:110%'> Employees</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>(</span><span
style='font-size:9.0pt;line-height:110%'>EmployeeId</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>,</span><span
style='font-size:9.0pt;line-height:110%'> Email</span><span style='font-size:
9.0pt;line-height:110%;color:gray'>);</span><span style='font-size:9.0pt;
line-height:110%'> </span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.25pt;
margin-left:.25pt'>The above SQL statement creates a new clustered index on
Employees. Clustered indexes are indexes that dictate the actual structure of
the table; the table itself is sorted to match the structure of the index. That
means there can be at most one clustered index on a table. If a clustered index
already exists on the table, the above statement will fail. (Tables with no
clustered indexes are also called heaps.)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image327.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.25pt;
margin-left:.25pt'>This will create an unique index for the column <i>Email</i>
in the table <i>Customers</i>. This index, along with speeding up queries like
a normal index, will also force every email address in that column to be
unique. If a row is inserted or updated with a non-unique <i>Email</i> value,
the insertion or update will, by default, fail.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image328.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.6pt;
margin-left:.25pt'>This creates an index on Customers which also creates a
table constraint that the EmployeeID must be unique.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>(This will fail if the column is not currently unique - in
this case, if there are employees who share an ID.)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image329.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:46.25pt;margin-bottom:
.2pt;margin-left:.25pt;text-align:justify;text-justify:inter-ideograph;
line-height:135%'>This creates an index that is sorted in descending order. By
default, indexes (in MSSQL server, at least) are ascending, but that can be
changed.</p>

<h2 style='margin-top:0in;margin-right:46.25pt;margin-bottom:.2pt;margin-left:
.25pt;text-align:justify;text-justify:inter-ideograph;text-indent:.5pt;
line-height:135%'><a name="_Toc228652">Section 37.6: Rebuild index</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.45pt;
margin-left:.25pt'>Over the course of time B-Tree indexes may become fragmented
because of updating/deleting/inserting data. In SQLServer terminology we can
have internal (index page which is half empty ) and external (logical page
order doesn't correspond physical order). Rebuilding index is very similar to
dropping and re-creating it.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>We can re-build an index with</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image330.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.6pt;
margin-left:.25pt'>By default rebuilding index is offline operation which locks
the table and prevents DML against it , but many RDBMS allow online rebuilding.
Also, some DB vendors offer alternatives to index rebuilding such as <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>REORGANIZE</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=86 style='width:.9in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=86 valign=top style='width:.9in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>SHRINK </span><span style='font-size:9.0pt;
  line-height:107%;color:blue'>SPACE</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:18.75pt;
margin-left:.25pt'>(SQLServer) or <span style='font-size:9.0pt;line-height:
110%;color:fuchsia;background:#FAFAFA'>COALESCE</span>/(Oracle).</p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:4.2pt;margin-left:
-.25pt'><a name="_Toc228653">Section 37.7: Inserting with a Unique Index</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:17.25pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='position:relative;z-index:
-1895776256'><span style='left:0px;position:absolute;left:0px;top:-58367px;
width:718px;height:1px'><img width=718 height=1
src="SQL%20Notes%20for%20Professionals_files/image134.gif"></span></span><span
style='font-size:9.0pt;line-height:110%;color:blue'>UPDATE</span><span
style='font-size:9.0pt;line-height:110%'> Customers </span><span
style='font-size:9.0pt;line-height:110%;color:blue'>SET</span><span
style='font-size:9.0pt;line-height:110%'> Email </span><span style='font-size:
9.0pt;line-height:110%;color:gray'>=</span><span style='font-size:9.0pt;
line-height:110%'> &quot;richard0123</span><span style='font-size:9.0pt;
line-height:110%;color:#CC3333'>@example</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>.</span><span style='font-size:9.0pt;line-height:
110%;color:#25256F'>com</span><span style='font-size:9.0pt;line-height:110%'>&quot;
</span><span style='font-size:9.0pt;line-height:110%;color:blue'>WHERE</span><span
style='font-size:9.0pt;line-height:110%'> id </span><span style='font-size:
9.0pt;line-height:110%;color:gray'>=</span><span style='font-size:9.0pt;
line-height:110%'> 1</span><span style='font-size:9.0pt;line-height:110%;
color:gray'>;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:14.1pt;
margin-left:.25pt'>This will fail if an unique index is set on the <i>Email</i>
column of <i>Customers</i>. However, alternate behavior can be defined for this
case:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='position:relative;z-index:
-1895775232'><span style='left:0px;position:absolute;left:0px;top:-58446px;
width:718px;height:1px'><img width=718 height=1
src="SQL%20Notes%20for%20Professionals_files/image134.gif"></span></span><span
style='font-size:9.0pt;line-height:110%;color:blue'>UPDATE</span><span
style='font-size:9.0pt;line-height:110%'> Customers </span><span
style='font-size:9.0pt;line-height:110%;color:blue'>SET</span><span
style='font-size:9.0pt;line-height:110%'> Email </span><span style='font-size:
9.0pt;line-height:110%;color:gray'>=</span><span style='font-size:9.0pt;
line-height:110%'> &quot;richard0123</span><span style='font-size:9.0pt;
line-height:110%;color:#CC3333'>@example</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>.</span><span style='font-size:9.0pt;line-height:
110%;color:#25256F'>com</span><span style='font-size:9.0pt;line-height:110%'>&quot;
</span><span style='font-size:9.0pt;line-height:110%;color:blue'>WHERE</span><span
style='font-size:9.0pt;line-height:110%'> id </span><span style='font-size:
9.0pt;line-height:110%;color:gray'>=</span><span style='font-size:9.0pt;
line-height:110%'> 1 </span><span style='font-size:9.0pt;line-height:110%;
color:blue'>ON</span><span style='font-size:9.0pt;line-height:110%'> DUPLICATE </span><span
style='font-size:9.0pt;line-height:110%;color:blue'>KEY</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>;</span></p>

<h1 style='margin-left:-.25pt'><a name="_Toc228654">Chapter 38: Row number</a></h1>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:0in;margin-left:-.25pt'><a
name="_Toc228655">Section 38.1: Delete All But Last Record (1 to Many Table)</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=109
src="SQL%20Notes%20for%20Professionals_files/image331.gif"></span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228656">Section 38.2: Row numbers without partitions</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Include a row number according to the order specified.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=92
src="SQL%20Notes%20for%20Professionals_files/image332.gif"></span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228657">Section 38.3: Row numbers with partitions</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Uses a partition criteria to group the row numbering
according to it.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:0in;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=76
src="SQL%20Notes%20for%20Professionals_files/image333.gif"></span></p>

<h1 style='margin-left:-.25pt'><a name="_Toc228658">Chapter 39: SQL Group By vs
Distinct</a></h1>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228659">Section 39.1: Di&#57379;erence between GROUP BY
and DISTINCT</a></h2>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=58 style='width:.6in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:blue'>GROUP</span><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:blue'>BY</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.6in'>is used in combination with aggregation functions. Consider
the following table:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>orderId userId storeName
orderValue orderDate</b></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=321
 style='width:240.4pt;margin-left:1.0pt;border-collapse:collapse'>
 <tr style='height:13.65pt'>
  <td width=52 valign=top style='width:39.15pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>1</p>
  </td>
  <td width=45 valign=top style='width:33.65pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>43</p>
  </td>
  <td width=77 valign=top style='width:57.85pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Store
  A</p>
  </td>
  <td width=77 valign=top style='width:.8in;padding:0in 0in 0in 0in;height:
  13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>25</p>
  </td>
  <td width=70 valign=top style='width:52.2pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>20-03-2016</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=52 valign=top style='width:39.15pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>2</p>
  </td>
  <td width=45 valign=top style='width:33.65pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>57</p>
  </td>
  <td width=77 valign=top style='width:57.85pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Store
  B</p>
  </td>
  <td width=77 valign=top style='width:.8in;padding:0in 0in 0in 0in;height:
  16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>50</p>
  </td>
  <td width=70 valign=top style='width:52.2pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>22-03-2016</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=52 valign=top style='width:39.15pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>3</p>
  </td>
  <td width=45 valign=top style='width:33.65pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>43</p>
  </td>
  <td width=77 valign=top style='width:57.85pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Store
  A</p>
  </td>
  <td width=77 valign=top style='width:.8in;padding:0in 0in 0in 0in;height:
  16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>30</p>
  </td>
  <td width=70 valign=top style='width:52.2pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>25-03-2016</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=52 valign=top style='width:39.15pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>4</p>
  </td>
  <td width=45 valign=top style='width:33.65pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>82</p>
  </td>
  <td width=77 valign=top style='width:57.85pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Store
  C</p>
  </td>
  <td width=77 valign=top style='width:.8in;padding:0in 0in 0in 0in;height:
  16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>10</p>
  </td>
  <td width=70 valign=top style='width:52.2pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>26-03-2016</p>
  </td>
 </tr>
 <tr style='height:13.65pt'>
  <td width=52 valign=top style='width:39.15pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>5</p>
  </td>
  <td width=45 valign=top style='width:33.65pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>21</p>
  </td>
  <td width=77 valign=top style='width:57.85pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Store
  A</p>
  </td>
  <td width=77 valign=top style='width:.8in;padding:0in 0in 0in 0in;height:
  13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>45</p>
  </td>
  <td width=70 valign=top style='width:52.2pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>29-03-2016</p>
  </td>
 </tr>
</table>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=58 style='width:.6in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:blue'>GROUP</span><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:blue'>BY</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>The query below uses to perform aggregated calculations.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=191
src="SQL%20Notes%20for%20Professionals_files/image334.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>and will return the following information</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>storeName
total_nr_orders nr_unique_customers average_order_value first_order lastOrder</b></p>

<p class=MsoNormal style='margin-bottom:3.8pt;text-indent:0in'>Store A 3 2 33.3 20-03-2016
29-03-2016</p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'>Store B 1 1 50 22-03-2016
22-03-2016</p>

<p class=MsoNormal style='margin-bottom:15.1pt;text-indent:0in'>Store C 1 1 10 26-03-2016
26-03-2016</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>While <span style='font-size:9.0pt;line-height:110%;
color:blue;background:#FAFAFA'>DISTINCT</span> is used to list a unique
combination of distinct values for the specified columns.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:3.25pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=92
src="SQL%20Notes%20for%20Professionals_files/image335.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>storeName userId</b></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=92
 style='width:69.3pt;margin-left:1.0pt;border-collapse:collapse'>
 <tr style='height:13.65pt'>
  <td width=77 valign=top style='width:57.85pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Store
  A</p>
  </td>
  <td width=15 valign=top style='width:11.45pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>43</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=77 valign=top style='width:57.85pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Store
  B</p>
  </td>
  <td width=15 valign=top style='width:11.45pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>57</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=77 valign=top style='width:57.85pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Store
  C</p>
  </td>
  <td width=15 valign=top style='width:11.45pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>82</p>
  </td>
 </tr>
 <tr style='height:13.65pt'>
  <td width=77 valign=top style='width:57.85pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Store
  A</p>
  </td>
  <td width=15 valign=top style='width:11.45pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>21</p>
  </td>
 </tr>
</table>

<h1 style='margin-left:-.25pt'><a name="_Toc228660">Chapter 40: Finding
Duplicates on a Column Subset with Detail</a></h1>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:0in;margin-left:-.25pt'><a
name="_Toc228661">Section 40.1: Students with same name and date of birth</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=142
src="SQL%20Notes%20for%20Professionals_files/image336.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.25pt;
margin-left:.25pt'>This example uses a Common Table Expression and a Window
Function to show all duplicate rows (on a subset of columns) side by side.<br
clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc228662">Chapter 41: String
Functions</a></h1>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>String functions perform operations on string values and
return either numeric or string values.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.55pt;margin-bottom:.2pt;
margin-left:.25pt;text-align:justify;text-justify:inter-ideograph;line-height:
135%'>Using string functions, you can, for example, combine data, extract a
substring, compare strings, or convert a string to all uppercase or lowercase
characters.</p>

<h2 style='margin-top:0in;margin-right:.55pt;margin-bottom:.2pt;margin-left:
.25pt;text-align:justify;text-justify:inter-ideograph;text-indent:.5pt;
line-height:135%'><a name="_Toc228663">Section 41.1: Concatenate</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.3pt;
margin-left:.25pt'>In (standard ANSI/ISO) SQL, the operator for string
concatenation is <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>||</span>.
This syntax is supported by all major databases except SQL Server:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:15.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image337.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Many databases support a <span style='font-size:9.0pt;
line-height:110%;color:fuchsia;background:#FAFAFA'>CONCAT</span> function to
join strings:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:15.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image338.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Some databases support using <span style='font-size:9.0pt;
line-height:110%;color:fuchsia;background:#FAFAFA'>CONCAT</span> to join more
than two strings (Oracle does not):</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image339.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:14.45pt;
margin-left:.25pt'>In some databases, non-string types must be cast or
converted:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:17.4pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='position:relative;z-index:
-1895774208'><span style='left:0px;position:absolute;left:0px;top:-60591px;
width:718px;height:1px'><img width=718 height=1
src="SQL%20Notes%20for%20Professionals_files/image134.gif"></span></span><span
style='font-size:9.0pt;line-height:110%;color:blue'>SELECT</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:fuchsia'>CONCAT</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>(</span><span style='font-size:9.0pt;line-height:
110%;color:red'>'Foo'</span><span style='font-size:9.0pt;line-height:110%;
color:gray'>,</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:blue'>CAST</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>(</span><span
style='font-size:9.0pt;line-height:110%'>42 </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>AS</span><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:blue'>VARCHAR</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>(</span><span
style='font-size:9.0pt;line-height:110%'>5</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>)),</span><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:red'>'Bar'</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>);</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:green'>--returns 'Foo42Bar'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:14.3pt;
margin-left:.25pt'>Some databases (e.g., Oracle) perform implicit lossless
conversions. For example, a <span style='font-size:9.0pt;line-height:110%;
color:fuchsia;background:#FAFAFA'>CONCAT</span> on a <span style='font-size:
9.0pt;line-height:110%;color:blue;background:#FAFAFA'>CLOB</span> and <span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>NCLOB </span>yields
a <span style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>NCLOB</span>.
A <span style='font-size:9.0pt;line-height:110%;color:fuchsia;background:#FAFAFA'>CONCAT</span>
on a number and a <span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>varchar2</span> results in a <span style='font-size:9.0pt;line-height:
110%;background:#FAFAFA'>varchar2</span>, etc.:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:17.3pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='position:relative;z-index:
-1895773184'><span style='left:0px;position:absolute;left:0px;top:-60689px;
width:718px;height:1px'><img width=718 height=1
src="SQL%20Notes%20for%20Professionals_files/image134.gif"></span></span><span
style='font-size:9.0pt;line-height:110%;color:blue'>SELECT</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:fuchsia'>CONCAT</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>(</span><span style='font-size:9.0pt;line-height:
110%;color:fuchsia'>CONCAT</span><span style='font-size:9.0pt;line-height:110%;
color:gray'>(</span><span style='font-size:9.0pt;line-height:110%;color:red'>'Foo'</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>,</span><span
style='font-size:9.0pt;line-height:110%'> 42</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>),</span><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:red'>'Bar'</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>)</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>FROM</span><span style='font-size:9.0pt;
line-height:110%'> dual</span><span style='font-size:9.0pt;line-height:110%;
color:gray'>;</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:green'>--returns Foo42Bar</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Some databases can use the non-standard <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>+</span> operator
(but in most, <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>+</span>
works only for numbers):</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:15.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image340.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:74.6pt;margin-bottom:
.2pt;margin-left:.25pt;line-height:145%'>On SQL Server &lt; 2012, where <span
style='font-size:9.0pt;line-height:145%;color:fuchsia;background:#FAFAFA'>CONCAT</span>
is not supported, <span style='font-size:9.0pt;line-height:145%;background:
#FAFAFA'>+</span> is the only way to join strings.</p>

<h2 style='margin-top:0in;margin-right:74.6pt;margin-bottom:.2pt;margin-left:
.25pt;text-indent:.5pt;line-height:145%'><a name="_Toc228664">Section 41.2:
Length</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.3pt;
margin-left:-.25pt;text-indent:-.5pt;line-height:107%'><b><i>SQL Server</i></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>The LEN doesn't count the trailing space.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="SQL%20Notes%20for%20Professionals_files/image341.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>The DATALENGTH counts the trailing space.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:0in;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="SQL%20Notes%20for%20Professionals_files/image342.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.25pt;
margin-left:.25pt'>It should be noted though, that DATALENGTH returns the
length of the underlying byte representation of the string, which depends,
i.a., on the charset used to store the string.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=720 height=109
src="SQL%20Notes%20for%20Professionals_files/image343.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.3pt;
margin-left:-.25pt;text-indent:-.5pt;line-height:107%'><b><i>Oracle</i></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:388.55pt;margin-bottom:
.2pt;margin-left:.25pt;line-height:215%'>Syntax: Length ( char ) Examples:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="SQL%20Notes%20for%20Professionals_files/image344.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:260.8pt;margin-bottom:
.2pt;margin-left:.25pt;line-height:145%'>See Also: LengthB, LengthC, Length2,
Length4</p>

<h2 style='margin-top:0in;margin-right:260.8pt;margin-bottom:.2pt;margin-left:
.25pt;text-indent:.5pt;line-height:145%'><a name="_Toc228665">Section 41.3:
Trim empty spaces</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.85pt;
margin-left:.25pt'>Trim is used to remove write-space at the beginning or end
of selection</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=29 style='width:.3in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>TRIM</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>In MSSQL there is no single <span style='font-size:9.0pt;
line-height:110%;color:gray;background:#FAFAFA'>()</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="SQL%20Notes%20for%20Professionals_files/image345.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>MySql and Oracle</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image346.gif"></span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:0in;margin-left:-.25pt'><a
name="_Toc228666">Section 41.4: Upper &amp; lower case</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src="SQL%20Notes%20for%20Professionals_files/image347.gif"></span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228667">Section 41.5: Split</a></h2>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=86 style='width:.9in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=86 valign=top style='width:.9in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>STRING_SPLIT</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:14.45pt;
margin-left:.25pt'>Splits a string expression using a character separator. Note
that <span style='font-size:9.0pt;line-height:110%;color:gray;background:#FAFAFA'>()</span>
is a table-valued function.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:141.55pt;margin-bottom:
.1pt;margin-left:0in;text-indent:3.75pt;line-height:240%'><span
style='position:relative;z-index:-1895772160'><span style='left:0px;position:
absolute;left:0px;top:-61843px;width:718px;height:1px'><img width=718 height=1
src="SQL%20Notes%20for%20Professionals_files/image134.gif"></span></span><span
style='font-size:9.0pt;line-height:240%;color:blue'>SELECT</span><span
style='font-size:9.0pt;line-height:240%'> </span><span style='font-size:9.0pt;
line-height:240%;color:blue'>value</span><span style='font-size:9.0pt;
line-height:240%'> </span><span style='font-size:9.0pt;line-height:240%;
color:blue'>FROM</span><span style='font-size:9.0pt;line-height:240%'>
STRING_SPLIT</span><span style='font-size:9.0pt;line-height:240%;color:gray'>(</span><span
style='font-size:9.0pt;line-height:240%;color:red'>'Lorem ipsum dolor sit
amet.'</span><span style='font-size:9.0pt;line-height:240%;color:gray'>,</span><span
style='font-size:9.0pt;line-height:240%'> </span><span style='font-size:9.0pt;
line-height:240%;color:red'>' '</span><span style='font-size:9.0pt;line-height:
240%;color:gray'>); </span>Result:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:0in;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=117
src="SQL%20Notes%20for%20Professionals_files/image348.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=31
src="SQL%20Notes%20for%20Professionals_files/image349.gif"></span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228668">Section 41.6: Replace</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.85pt;
margin-left:.25pt'>Syntax:</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=50 style='width:37.8pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=50 valign=top style='width:37.8pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:fuchsia'>REPLACE</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.85pt;
margin-left:.25pt'><span style='font-size:9.0pt;line-height:110%;color:gray;
background:#FAFAFA'>(</span> String to search <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>,</span> String to search for and replace <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>,</span> String to
place into the original string <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:14.45pt;
margin-left:.25pt'>Example:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:23.0pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='position:relative;z-index:
-1895771136'><span style='left:0px;position:absolute;left:0px;top:-62197px;
width:718px;height:1px'><img width=718 height=1
src="SQL%20Notes%20for%20Professionals_files/image134.gif"></span></span><span
style='font-size:9.0pt;line-height:110%;color:blue'>SELECT</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:fuchsia'>REPLACE</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>(</span><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:red'>'Peter
Steve Tom'</span><span style='font-size:9.0pt;line-height:110%;color:gray'>,</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:red'>'Steve'</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>,</span><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:red'>'Billy'</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:gray'>)</span><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:green'>--Return
Values: Peter Billy Tom</span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228669">Section 41.7: REGEXP</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.75pt;
margin-left:-.25pt;text-indent:-.5pt;line-height:107%'>MySQL <span
style='font-size:8.0pt;line-height:107%;font-family:"DejaVu Sans Mono";
color:#666666'>Version &#8805; 3.19</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Checks if a string matches a regular expression (defined by
another string).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="SQL%20Notes%20for%20Professionals_files/image350.gif"></span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228670">Section 41.8: Substring</a></h2>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=324 style='width:243.0pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=72 valign=top style='width:.75in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:fuchsia'>SUBSTRING</span><span style='font-size:
  9.0pt;line-height:107%'> </span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:gray;background:#FAFAFA'>(</span></p>
  </td>
  <td width=130 valign=top style='width:1.35in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>string_expression</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:gray;background:#FAFAFA'>,</span></p>
  </td>
  <td width=43 valign=top style='width:.45in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'></span><span style='font-size:9.0pt;line-height:
  107%;color:blue'>start</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:gray;background:#FAFAFA'>,</span></p>
  </td>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>length </span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Syntax is: <span style='font-size:9.0pt;line-height:110%;
color:gray;background:#FAFAFA'>)</span>. Note that SQL strings are 1-indexed.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:15.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src="SQL%20Notes%20for%20Professionals_files/image351.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=22 style='width:16.2pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=22 valign=top style='width:16.2pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:fuchsia'>LEN</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:14.5pt;
margin-left:.25pt'>This is often used in conjunction with the <span
style='font-size:9.0pt;line-height:110%;color:gray;background:#FAFAFA'>()</span>
function to get the last <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>n</span> characters of a string of unknown length.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='position:relative;z-index:
-1895770112'><span style='left:0px;position:absolute;left:0px;top:-62571px;
width:718px;height:1px'><img width=718 height=1
src="SQL%20Notes%20for%20Professionals_files/image201.gif"></span></span><span
style='font-size:9.0pt;line-height:110%;color:blue'>DECLARE</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#CC3333'>@str1</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:blue'>VARCHAR</span><span style='font-size:9.0pt;line-height:110%;
color:gray'>(</span><span style='font-size:9.0pt;line-height:110%'>10</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>)</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:gray'>=</span><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:red'>'Hello'</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>,</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#CC3333'>@str2</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:blue'>VARCHAR</span><span style='font-size:9.0pt;line-height:110%;
color:gray'>(</span><span style='font-size:9.0pt;line-height:110%'>10</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>)</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:gray'>=</span><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:red'>'FooBarBaz'</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%;color:blue'>SELECT</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:fuchsia'>SUBSTRING</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>(</span><span
style='font-size:9.0pt;line-height:110%;color:#CC3333'>@str1</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>,</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:fuchsia'>LEN</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>(</span><span style='font-size:9.0pt;line-height:
110%;color:#CC3333'>@str1</span><span style='font-size:9.0pt;line-height:110%;
color:gray'>)</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:gray'>-</span><span
style='font-size:9.0pt;line-height:110%'> 2</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>,</span><span style='font-size:9.0pt;line-height:
110%'> 3</span><span style='font-size:9.0pt;line-height:110%;color:gray'>)</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:green'>--returns 'llo'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:23.0pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%;color:blue'>SELECT</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:fuchsia'>SUBSTRING</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>(</span><span
style='font-size:9.0pt;line-height:110%;color:#CC3333'>@str2</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>,</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:fuchsia'>LEN</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>(</span><span style='font-size:9.0pt;line-height:
110%;color:#CC3333'>@str2</span><span style='font-size:9.0pt;line-height:110%;
color:gray'>)</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:gray'>-</span><span
style='font-size:9.0pt;line-height:110%'> 2</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>,</span><span style='font-size:9.0pt;line-height:
110%'> 3</span><span style='font-size:9.0pt;line-height:110%;color:gray'>)</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:green'>--returns 'Baz'</span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228671">Section 41.9: Stu&#57379;</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.9pt;
margin-left:.25pt'>Stuff a string into another, replacing 0 or more characters
at a certain position.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.85pt;
margin-left:.25pt'>Note: <span style='font-size:9.0pt;line-height:110%;
color:blue;background:#FAFAFA'>start</span> position is 1-indexed (you start
indexing at 1, not 0).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:14.45pt;
margin-left:.25pt'>Syntax:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:92.55pt;margin-bottom:
.15pt;margin-left:0in;text-indent:3.75pt;line-height:240%'><span
style='position:relative;z-index:-1895769088'><span style='left:0px;position:
absolute;left:0px;top:-62802px;width:718px;height:1px'><img width=718 height=1
src="SQL%20Notes%20for%20Professionals_files/image134.gif"></span></span><span
style='font-size:9.0pt;line-height:240%;color:fuchsia'>STUFF</span><span
style='font-size:9.0pt;line-height:240%'> </span><span style='font-size:9.0pt;
line-height:240%;color:gray'>(</span><span style='font-size:9.0pt;line-height:
240%'> character_expression </span><span style='font-size:9.0pt;line-height:
240%;color:gray'>,</span><span style='font-size:9.0pt;line-height:240%'> </span><span
style='font-size:9.0pt;line-height:240%;color:blue'>start</span><span
style='font-size:9.0pt;line-height:240%'> </span><span style='font-size:9.0pt;
line-height:240%;color:gray'>,</span><span style='font-size:9.0pt;line-height:
240%'> length </span><span style='font-size:9.0pt;line-height:240%;color:gray'>,</span><span
style='font-size:9.0pt;line-height:240%'> replaceWith_expression </span><span
style='font-size:9.0pt;line-height:240%;color:gray'>)</span><span
style='font-size:9.0pt;line-height:240%'> </span>Example:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image352.gif"></span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228672">Section 41.10: LEFT - RIGHT</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.6pt;
margin-left:.25pt'>Syntax is:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>LEFT ( string-expression , integer )</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>RIGHT ( string-expression , integer )</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src="SQL%20Notes%20for%20Professionals_files/image353.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.6pt;
margin-left:.25pt'>Oracle SQL doesn't have LEFT and RIGHT functions. They can
be emulated with SUBSTR and LENGTH.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.6pt;
margin-left:.25pt'>SUBSTR ( string-expression, 1, integer )</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>SUBSTR ( string-expression,
length(string-expression)-integer+1, integer)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src="SQL%20Notes%20for%20Professionals_files/image354.gif"></span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228673">Section 41.11: REVERSE</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Syntax is: REVERSE ( string-expression )</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image355.gif"></span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228674">Section 41.12: REPLICATE</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.9pt;
margin-left:.25pt'>The <span style='font-size:9.0pt;line-height:110%;
color:fuchsia;background:#FAFAFA'>REPLICATE</span> function concatenates a
string with itself a specified number of times.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Syntax is: REPLICATE ( string-expression , integer )</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image356.gif"></span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228675">Section 41.13: Replace function in sql Select and
Update query</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:16.3pt;
margin-left:.25pt'>The Replace function in SQL is used to update the content of
a string. The function call is REPLACE( ) for MySQL, Oracle, and SQL Server.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>The syntax of the Replace function is:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:15.1pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image357.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.9pt;
margin-left:.25pt'>The following example replaces occurrences of <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>South</span> with <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Southern</span> in
Employees table:</p>

<p class=MsoNormal style='margin-bottom:.95pt;text-indent:0in;line-height:111%'><b>FirstName Address</b></p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'>James South
New York</p>

<p class=MsoNormal style='margin-top:0in;margin-right:384.1pt;margin-bottom:
11.45pt;margin-left:.25pt;line-height:141%'>John South Boston Michael South
San Diego</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Select Statement :</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>If we apply the following Replace function:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=92
src="SQL%20Notes%20for%20Professionals_files/image358.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Result:</p>

<p class=MsoNormal style='margin-bottom:.95pt;text-indent:0in;line-height:111%'><b>FirstName Address</b></p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'>James Southern
New York</p>

<p class=MsoNormal style='margin-top:0in;margin-right:368.3pt;margin-bottom:
11.45pt;margin-left:.25pt;line-height:141%'>John Southern Boston Michael Southern
San Diego</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Update Statement :</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>We can use a replace function to make permanent changes in
our table through following approach.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src="SQL%20Notes%20for%20Professionals_files/image359.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>A more common approach is to use this in conjunction with a
WHERE clause like this:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="SQL%20Notes%20for%20Professionals_files/image360.gif"></span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228676">Section 41.14: INSTR</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>Return the index of the first occurrence of a substring
(zero if not found)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Syntax: INSTR ( string, substring )</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src="SQL%20Notes%20for%20Professionals_files/image361.gif"></span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228677">Section 41.15: PARSENAME</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:13.3pt;
margin-left:.25pt'><b>DATABASE</b> : SQL Server</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.5pt;
margin-left:.25pt'><b>PARSENAME</b> function returns the specific part of given
string(object name). object name may contains string like object name,owner
name, database name and server name.</p>

<p class=MsoNormal style='margin-bottom:13.55pt;text-indent:0in;line-height:
107%'><span style='position:relative;z-index:-1895768064'><span
style='position:absolute;left:90px;top:-64498px;width:121px;height:1px'><img
width=121 height=1 src="SQL%20Notes%20for%20Professionals_files/image362.gif"></span></span>More
details <span style='border:solid black 1.5pt;padding:0in'></span><a
href="https://msdn.microsoft.com/en-us/library/ms188006.aspx"><span
style='color:#F31D19;border:solid black 1.5pt;padding:0in'>MSDN:PARSENAME</span></a><span
style='border:solid black 1.5pt;padding:0in'> </span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Syntax</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image352.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.0pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Example</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:14.5pt;
margin-left:.25pt'>To get object name use part index <span style='font-size:
9.0pt;line-height:110%;background:#FAFAFA'>1</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:26.95pt;margin-bottom:
.1pt;margin-left:3.5pt;text-indent:-.5pt'><span style='position:relative;
z-index:-1895767040'><span style='left:0px;position:absolute;left:0px;
top:-64683px;width:718px;height:1px'><img width=718 height=1
src="SQL%20Notes%20for%20Professionals_files/image193.gif"></span></span><span
style='font-size:9.0pt;line-height:110%;color:blue'>SELECT</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:fuchsia'>PARSENAME</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>(</span><span style='font-size:9.0pt;line-height:
110%;color:red'>'ServerName.DatabaseName.SchemaName.ObjectName'</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>,</span><span
style='font-size:9.0pt;line-height:110%'>1</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>)</span><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:gray'>//</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>returns</span><span style='font-size:9.0pt;
line-height:110%'> `ObjectName`</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:26.95pt;margin-bottom:
17.3pt;margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;
line-height:110%;color:blue'>SELECT</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:fuchsia'>PARSENAME</span><span style='font-size:9.0pt;line-height:110%;
color:gray'>(</span><span style='font-size:9.0pt;line-height:110%;color:red'>'[1012-1111].SchoolDatabase.school.Student'</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>,</span><span
style='font-size:9.0pt;line-height:110%'>1</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>)</span><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:gray'>//</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>returns</span><span style='font-size:9.0pt;
line-height:110%'> `Student`</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:14.5pt;
margin-left:.25pt'>To get schema name use part index <span style='font-size:
9.0pt;line-height:110%;background:#FAFAFA'>2</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:26.95pt;margin-bottom:
.1pt;margin-left:3.5pt;text-indent:-.5pt'><span style='position:relative;
z-index:-1895766016'><span style='left:0px;position:absolute;left:0px;
top:-64779px;width:718px;height:1px'><img width=718 height=1
src="SQL%20Notes%20for%20Professionals_files/image193.gif"></span></span><span
style='font-size:9.0pt;line-height:110%;color:blue'>SELECT</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:fuchsia'>PARSENAME</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>(</span><span style='font-size:9.0pt;line-height:
110%;color:red'>'ServerName.DatabaseName.SchemaName.ObjectName'</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>,</span><span
style='font-size:9.0pt;line-height:110%'>2</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>)</span><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:gray'>//</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>returns</span><span style='font-size:9.0pt;
line-height:110%'> `SchemaName`</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:26.95pt;margin-bottom:
17.3pt;margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;
line-height:110%;color:blue'>SELECT</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:fuchsia'>PARSENAME</span><span style='font-size:9.0pt;line-height:110%;
color:gray'>(</span><span style='font-size:9.0pt;line-height:110%;color:red'>'[1012-1111].SchoolDatabase.school.Student'</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>,</span><span
style='font-size:9.0pt;line-height:110%'>2</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>)</span><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:gray'>//</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>returns</span><span style='font-size:9.0pt;
line-height:110%'> `school`</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>To get database name use part index <span style='font-size:
9.0pt;line-height:110%;background:#FAFAFA'>3</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:26.95pt;margin-bottom:
.1pt;margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;
line-height:110%;color:blue'>SELECT</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:fuchsia'>PARSENAME</span><span style='font-size:9.0pt;line-height:110%;
color:gray'>(</span><span style='font-size:9.0pt;line-height:110%;color:red'>'ServerName.DatabaseName.SchemaName.ObjectName'</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>,</span><span
style='font-size:9.0pt;line-height:110%'>3</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>)</span><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:gray'>//</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>returns</span><span style='font-size:9.0pt;
line-height:110%'> `DatabaseName`</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:26.95pt;margin-bottom:
17.3pt;margin-left:3.5pt;text-indent:-.5pt'><span style='position:relative;
z-index:-1895764992'><span style='left:0px;position:absolute;left:0px;
top:-64874px;width:718px;height:1px'><img width=718 height=1
src="SQL%20Notes%20for%20Professionals_files/image193.gif"></span></span><span
style='font-size:9.0pt;line-height:110%;color:blue'>SELECT</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:fuchsia'>PARSENAME</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>(</span><span style='font-size:9.0pt;line-height:
110%;color:red'>'[1012-1111].SchoolDatabase.school.Student'</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>,</span><span
style='font-size:9.0pt;line-height:110%'>3</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>)</span><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:gray'>//</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>returns</span><span style='font-size:9.0pt;
line-height:110%'> `SchoolDatabase`</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:14.5pt;
margin-left:.25pt'>To get server name use part index <span style='font-size:
9.0pt;line-height:110%;background:#FAFAFA'>4</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:26.95pt;margin-bottom:
.1pt;margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;
line-height:110%;color:blue'>SELECT</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:fuchsia'>PARSENAME</span><span style='font-size:9.0pt;line-height:110%;
color:gray'>(</span><span style='font-size:9.0pt;line-height:110%;color:red'>'ServerName.DatabaseName.SchemaName.ObjectName'</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>,</span><span
style='font-size:9.0pt;line-height:110%'>4</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>)</span><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:gray'>//</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>returns</span><span style='font-size:9.0pt;
line-height:110%'> `ServerName`</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:26.95pt;margin-bottom:
17.25pt;margin-left:3.5pt;text-indent:-.5pt'><span style='position:relative;
z-index:-1895763968'><span style='left:0px;position:absolute;left:0px;
top:-64970px;width:718px;height:1px'><img width=718 height=1
src="SQL%20Notes%20for%20Professionals_files/image193.gif"></span></span><span
style='font-size:9.0pt;line-height:110%;color:blue'>SELECT</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:fuchsia'>PARSENAME</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>(</span><span style='font-size:9.0pt;line-height:
110%;color:red'>'[1012-1111].SchoolDatabase.school.Student'</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>,</span><span
style='font-size:9.0pt;line-height:110%'>4</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>)</span><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:gray'>//</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>returns</span><span style='font-size:9.0pt;
line-height:110%'> `</span><span style='font-size:9.0pt;line-height:110%;
color:gray'>[</span><span style='font-size:9.0pt;line-height:110%'>1012</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>-</span><span
style='font-size:9.0pt;line-height:110%'>1111</span><span style='font-size:
9.0pt;line-height:110%;color:gray'>]</span><span style='font-size:9.0pt;
line-height:110%'>`</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>PARSENAME will returns null is specified part is not present
in given object name string<br clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc228678">Chapter 42: Functions
(Aggregate)</a></h1>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228679">Section 42.1: Conditional aggregation</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>Payments Table</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Customer Payment_type
Amount</b></p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'>Peter Credit 100</p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'>Peter Credit 300</p>

<p class=MsoNormal style='margin-top:0in;margin-right:369.9pt;margin-bottom:
.2pt;margin-left:.25pt;line-height:141%'>John Credit 1000 John Debit 500</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=92
src="SQL%20Notes%20for%20Professionals_files/image363.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>Result:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Customer Credit Debit</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:427.55pt;margin-bottom:
.2pt;margin-left:.25pt;line-height:142%'>Peter 400 0 John 1000 500</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=719 height=92
src="SQL%20Notes%20for%20Professionals_files/image364.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>Result:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Customer
credit_transaction_count debit_transaction_count</b></p>

<p class=MsoNormal style='margin-bottom:3.95pt;text-indent:0in'>Peter 2 0</p>

<p class=MsoNormal style='margin-bottom:20.8pt;text-indent:0in'>John 1 1</p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228680">Section 42.2: List Concatenation</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>Partial credit to <a
href="http://stackoverflow.com/a/19348687/4896952"><span style='color:#F31D19'>this</span></a>
SO answer.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:2.15pt;
margin-left:.25pt'>List Concatenation aggregates a column or expression by
combining the values into a single string for each group. A string to delimit
each value (either blank or a comma when omitted) and the order of the values
in the result can be specified. While it is not part of the SQL standard, every
major relational database vendor supports it in their own way.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:0in;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=188
src="SQL%20Notes%20for%20Professionals_files/image365.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><img width=718 height=1
src="SQL%20Notes%20for%20Professionals_files/image366.gif" align=left
hspace=12><span style='font-size:9.0pt;line-height:110%'></span><span
style='font-size:9.0pt;line-height:110%;color:blue'>GROUP</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>BY</span><span style='font-size:9.0pt;line-height:
110%'> ColumnA</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'></span><span style='font-size:9.0pt;line-height:110%;color:blue'>ORDER</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>BY</span><span style='font-size:9.0pt;line-height:
110%'> ColumnA</span><span style='font-size:9.0pt;line-height:110%;color:gray'>;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:15.9pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=148
src="SQL%20Notes%20for%20Professionals_files/image367.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>(CTE included to encourage the <a
href="https://en.wikipedia.org/wiki/Don%27t_repeat_yourself"><span
style='color:#F31D19'>DRY principle</span></a>)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:19.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=223
src="SQL%20Notes%20for%20Professionals_files/image368.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>SQL Server 2017 and SQL
Azure</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:4.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=92
src="SQL%20Notes%20for%20Professionals_files/image369.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:457.45pt;margin-bottom:
.2pt;margin-left:.25pt;line-height:217%'><b>SQLite </b>without ordering:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=92
src="SQL%20Notes%20for%20Professionals_files/image370.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>ordering requires a subquery or CTE:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:0in;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=158
src="SQL%20Notes%20for%20Professionals_files/image371.gif"></span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228681">Section 42.3: SUM</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'><span style='font-size:9.0pt;line-height:110%;color:fuchsia;
background:#FAFAFA'>Sum</span> function sum the value of all the rows in the
group. If the group by clause is omitted then sums all the rows.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:3.25pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src="SQL%20Notes%20for%20Professionals_files/image372.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>TotalSalary</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>2500</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:3.4pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=78
src="SQL%20Notes%20for%20Professionals_files/image373.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:73.1pt;text-indent:-72.85pt'><span style='line-height:110%'>1<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>2000</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:20.8pt;
margin-left:73.1pt;text-indent:-72.85pt'><span style='line-height:110%'>2<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>500</p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228682">Section 42.4: AVG()</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.7pt;
margin-left:.25pt'>The aggregate function AVG() returns the average of a given
expression, usually numeric values in a column. Assume we have a table
containing the yearly calculation of population in cities across the world. The
records for New York City look similar to the ones below:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:389.95pt;margin-bottom:
.95pt;margin-left:8.8pt;text-indent:-8.55pt;line-height:111%'><b>EXAMPLE TABLE
city_name population year</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:369.25pt;margin-bottom:
.2pt;margin-left:.25pt;line-height:141%'>New York City 8,550,405 2015 New
York City ... ...</p>

<p class=MsoNormal style='margin-bottom:15.05pt;text-indent:0in'>New York City
8,000,906 2005</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.7pt;
margin-left:.25pt'>To select the average population of the New York City, USA
from a table containing city names, population measurements, and measurement
years for last ten years:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>QUERY</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="SQL%20Notes%20for%20Professionals_files/image374.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:13.05pt;
margin-left:.25pt'>Notice how measurement year is absent from the query since
population is being averaged over time.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:393.6pt;margin-bottom:
.95pt;margin-left:8.8pt;text-indent:-8.55pt;line-height:111%'><b>RESULTS
city_name avg_population</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:26.25pt;
margin-left:.25pt'>New York City 8,250,754</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:29.4pt;
margin-left:24.0pt'><img width=3 height=1
src="SQL%20Notes%20for%20Professionals_files/image158.gif" align=left
hspace=12>Note: The AVG() function will convert values to numeric types. This
is especially important to keep in mind when working with dates.</p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228683">Section 42.5: Count</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>You can count the number of rows:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:3.25pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src="SQL%20Notes%20for%20Professionals_files/image375.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>TotalRows</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:4.45pt;
margin-left:.25pt'>4</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:6.15pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=126
src="SQL%20Notes%20for%20Professionals_files/image376.gif"></span></p>

<p class=MsoNormal style='margin-bottom:15.1pt;text-indent:0in'>2 1</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>You can count over a column/expression with the effect that
will not count the <span style='font-size:9.0pt;line-height:110%;color:#333399;
background:#FAFAFA'>NULL</span> values:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:3.25pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src="SQL%20Notes%20for%20Professionals_files/image377.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>mgr</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:15.05pt;
margin-left:.25pt'>3</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:13.05pt;
margin-left:.25pt'>(There is one null value managerID column)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.4pt;
margin-left:.25pt'>You can also use <b>DISTINCT</b> inside of another function
such as <b>COUNT</b> to only find the <b>DISTINCT</b> members of the set to
perform the operation on.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>For example:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="SQL%20Notes%20for%20Professionals_files/image378.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:11.95pt;
margin-left:.25pt'>Will return different values. The <i>SingleCount</i> will
only Count individual Continents once, while the <i>AllCount</i> will include
duplicates.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:448.7pt;margin-bottom:
3.1pt;margin-left:.25pt;text-indent:0in;line-height:111%'><b>ContinentCode </b>OC</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.3pt;
margin-left:.25pt'>EU</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.3pt;
margin-left:.25pt'>AS</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.3pt;
margin-left:.25pt'>NA</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.3pt;
margin-left:.25pt'>NA</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.3pt;
margin-left:.25pt'>AF</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:15.05pt;
margin-left:.25pt'>AF</p>

<p class=MsoNormal style='margin-top:0in;margin-right:354.6pt;margin-bottom:
.2pt;margin-left:.25pt;line-height:145%'>AllCount: 7 SingleCount: 5</p>

<h2 style='margin-top:0in;margin-right:354.6pt;margin-bottom:.2pt;margin-left:
.25pt;text-indent:.5pt;line-height:145%'><a name="_Toc228684">Section 42.6: Min</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Find the smallest value of column:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:15.1pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image379.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.9pt;
margin-left:.25pt'>Above example will return smallest value for column <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>age</span> of <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>employee</span>
table.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Syntax:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image380.gif"></span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228685">Section 42.7: Max</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Find the maximum value of column:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:15.1pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image381.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.9pt;
margin-left:.25pt'>Above example will return largest value for column <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>age</span> of <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>employee</span>
table.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Syntax:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:0in;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image382.gif"></span><br
clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc228686">Chapter 43: Functions
(Scalar/Single Row)</a></h1>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.45pt;
margin-left:.25pt'>SQL provides several built-in scalar functions. Each scalar
function takes one value as input and returns one value as output for each row
in a result set.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:76.75pt;margin-bottom:
.2pt;margin-left:.25pt;line-height:145%'>You use scalar functions wherever an
expression is allowed within a T-SQL statement.</p>

<h2 style='margin-top:0in;margin-right:76.75pt;margin-bottom:.2pt;margin-left:
.25pt;text-indent:.5pt;line-height:145%'><a name="_Toc228687">Section 43.1:
Date And Time</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:27.5pt;
margin-left:.25pt'>In SQL, you use date and time data types to store calendar
information. These data types include the time, date, smalldatetime, datetime,
datetime2, and datetimeoffset. Each data type has a specific format.</p>

<p class=MsoNormal style='margin-bottom:.95pt;text-indent:0in;line-height:111%'><span
style='font-size:11.0pt;line-height:111%'> </span><b>Data type Format</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:346.95pt;margin-bottom:
.2pt;margin-left:.25pt;line-height:141%'>time hh:mm:ss[.nnnnnnn] date YYYY-MM-DD</p>

<p class=MsoNormal style='margin-top:0in;margin-right:248.35pt;margin-bottom:
11.3pt;margin-left:.25pt;line-height:141%'>smalldatetime YYYY-MM-DD hh:mm:ss
datetime YYYY-MM-DD hh:mm:ss[.nnn] datetime2 YYYY-MM-DD
hh:mm:ss[.nnnnnnn] datetimeoffset YYYY-MM-DD hh:mm:ss[.nnnnnnn] [+/-]hh:mm</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>The <span style='font-size:9.0pt;line-height:110%;
color:fuchsia;background:#FAFAFA'>DATENAME</span> function returns the name or
value of a specific part of the date.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:3.25pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image383.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Datename</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:15.1pt;
margin-left:.25pt'>Saturday</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.3pt;
margin-left:.25pt'>You use the <span style='font-size:9.0pt;line-height:110%;
color:fuchsia;background:#FAFAFA'>GETDATE</span> function to determine the
current date and time of the computer running the current SQL instance. This
function doesn't include the time zone difference.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:3.25pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image384.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:40.75pt;text-indent:0in;line-height:111%'><b>Systemdate</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:15.15pt;
margin-left:.25pt'>2017-01-14 11:11:47.7230728</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.9pt;
margin-left:.25pt'>The <span style='font-size:9.0pt;line-height:110%;
color:fuchsia;background:#FAFAFA'>DATEDIFF</span> function returns the
difference between two dates.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.25pt;
margin-left:.25pt'>In the syntax, datepart is the parameter that specifies
which part of the date you want to use to calculate difference. The datepart
can be year, month, week, day, hour, minute, second, or millisecond. You then
specify the start date in the startdate parameter and the end date in the
enddate parameter for which you want to find the difference.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:3.4pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=78
src="SQL%20Notes%20for%20Professionals_files/image385.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:67.7pt;text-indent:-67.45pt'><span style='line-height:110%'>43659<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>7</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:67.7pt;text-indent:-67.45pt'><span style='line-height:110%'>43660<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>7</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:67.7pt;text-indent:-67.45pt'><span style='line-height:110%'>43661<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>7</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:15.15pt;
margin-left:67.7pt;text-indent:-67.45pt'><span style='line-height:110%'>43662<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>7</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>The <span style='font-size:9.0pt;line-height:110%;
color:fuchsia;background:#FAFAFA'>DATEADD</span> function enables you to add an
interval to part of a specific date.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:3.25pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image386.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:12.05pt;text-indent:0in;line-height:111%'><b>Added20MoreDays</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:20.8pt;
margin-left:.25pt'>2017-02-03 00:00:00.000</p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228688">Section 43.2: Character modifications</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.5pt;
margin-left:.25pt'>Character modifying functions include converting characters
to upper or lower case characters, converting numbers to formatted numbers,
performing character manipulation, etc.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=72 style='width:.75in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=36 valign=top style='width:27.0pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:fuchsia'>lower</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:gray;background:#FAFAFA'>(</span></p>
  </td>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:blue'>char</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>The <span style='font-size:9.0pt;line-height:110%;
color:gray;background:#FAFAFA'>)</span> function converts the given character
parameter to be lower-cased characters.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image387.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:85.95pt;margin-bottom:
.2pt;margin-left:.25pt;line-height:145%'>would return the customer's last name
changed from &quot;SMITH&quot; to &quot;smith&quot;.</p>

<h2 style='margin-top:0in;margin-right:85.95pt;margin-bottom:.2pt;margin-left:
.25pt;text-indent:.5pt;line-height:145%'><a name="_Toc228689">Section 43.3:
Configuration and Conversion Function</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.35pt;
margin-left:.25pt'>An example of a configuration function in SQL is the <span
style='font-size:9.0pt;line-height:110%;color:#CC3333;background:#FAFAFA'>@@SERVERNAME</span>
function. This function provides the name of the local server that's running
SQL.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:3.25pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=28
src="SQL%20Notes%20for%20Professionals_files/image388.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Server</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:15.05pt;
margin-left:.25pt'>SQL064</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.9pt;
margin-left:.25pt'>In SQL, most data conversions occur implicitly, without any
user intervention.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:13.0pt;
margin-left:.25pt'>To perform any conversions that can't be completed
implicitly, you can use the <span style='font-size:9.0pt;line-height:110%;
color:blue;background:#FAFAFA'>CAST</span> or <span style='font-size:9.0pt;
line-height:110%;color:fuchsia;background:#FAFAFA'>CONVERT</span> functions.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:13.05pt;
margin-left:.25pt'>The <span style='font-size:9.0pt;line-height:110%;
color:blue;background:#FAFAFA'>CAST</span> function syntax is simpler than the <span
style='font-size:9.0pt;line-height:110%;color:fuchsia;background:#FAFAFA'>CONVERT</span>
function syntax, but is limited in what it can do.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.95pt;
margin-left:.25pt'>In here, we use both the <span style='font-size:9.0pt;
line-height:110%;color:blue;background:#FAFAFA'>CAST</span> and <span
style='font-size:9.0pt;line-height:110%;color:fuchsia;background:#FAFAFA'>CONVERT</span>
functions to convert the datetime data type to the <span style='font-size:9.0pt;
line-height:110%;color:blue;background:#FAFAFA'>varchar</span> data type.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.55pt;
margin-left:.25pt'>The <span style='font-size:9.0pt;line-height:110%;
color:blue;background:#FAFAFA'>CAST</span> function always uses the default
style setting. For example, it will represent dates and times using the format
YYYY-MM-DD.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>The <span style='font-size:9.0pt;line-height:110%;
color:fuchsia;background:#FAFAFA'>CONVERT</span> function uses the date and
time style you specify. In this case, 3 specifies the date format dd/mm/yy.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:3.25pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=190
src="SQL%20Notes%20for%20Professionals_files/image389.gif"></span></p>

<p class=MsoNormal style='margin-bottom:.95pt;text-indent:0in;line-height:111%'><span
style='font-size:11.0pt;line-height:111%'> </span><b>Cast Convert</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:15.1pt;
margin-left:.25pt'>David Hamiltion was hired on 2003-02-04 David Hamiltion was
hired on 04/02/03</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.5pt;
margin-left:.25pt'>Another example of a conversion function is the <span
style='font-size:9.0pt;line-height:110%;color:fuchsia;background:#FAFAFA'>PARSE</span>
function. This function converts a string to a specified data type.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.55pt;margin-bottom:9.95pt;
margin-left:.25pt;text-align:justify;text-justify:inter-ideograph;line-height:
135%'>In the syntax for the function, you specify the string that must be
converted, the <span style='font-size:9.0pt;line-height:135%;background:#FAFAFA'>AS</span>
keyword, and then the required data type. Optionally, you can also specify the
culture in which the string value should be formatted. If you don't specify
this, the language for the session is used.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:15.45pt;
margin-left:.25pt'>If the string value can't be converted to a numeric, date,
or time format, it will result in an error. You'll then need to use <span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>CAST</span>
or <span style='font-size:9.0pt;line-height:110%;color:fuchsia;background:#FAFAFA'>CONVERT</span>
for the conversion.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:26.95pt;margin-bottom:
6.0pt;margin-left:3.5pt;text-indent:-.5pt'><span style='position:relative;
z-index:-1895760896'><span style='left:0px;position:absolute;left:0px;
top:-71357px;width:718px;height:1px'><img width=718 height=1
src="SQL%20Notes%20for%20Professionals_files/image390.gif"></span></span><span
style='font-size:9.0pt;line-height:110%;color:blue'>SELECT</span><span
style='font-size:9.0pt;line-height:110%;font-family:"Arial",sans-serif'> </span><span
style='font-size:9.0pt;line-height:110%;color:fuchsia'>PARSE</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>(</span><span
style='font-size:9.0pt;line-height:110%;color:red'>'Monday, 13 August 2012'</span><span
style='font-size:9.0pt;line-height:110%;font-family:"Arial",sans-serif'> </span><span
style='font-size:9.0pt;line-height:110%;color:blue'>AS</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>datetime2</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:blue'>USING</span><span style='font-size:9.0pt;line-height:110%;
font-family:"Arial",sans-serif'> </span><span style='font-size:9.0pt;
line-height:110%;color:red'>'en-US'</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>)</span><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:blue'>AS</span><span
style='font-size:9.0pt;line-height:110%;font-family:"Arial",sans-serif'> </span><span
style='font-size:9.0pt;line-height:110%;color:red'>'Date in English'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:33.2pt;text-indent:0in;line-height:111%'><b>Date in English</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:20.8pt;
margin-left:.25pt'>2012-08-13 00:00:00.0000000</p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228690">Section 43.4: Logical and Mathmetical Function</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.15pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>SQL has two logical
functions </b><span style='font-family:"Arial",sans-serif'></span><b> </b><b><span
style='font-size:9.0pt;line-height:111%;color:fuchsia;background:#FAFAFA'>CHOOSE</span>
and </b><b><span style='font-size:9.0pt;line-height:111%;color:fuchsia;
background:#FAFAFA'>IIF</span>.</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.7pt;
margin-left:.25pt'>The <span style='font-size:9.0pt;line-height:110%;
color:fuchsia;background:#FAFAFA'>CHOOSE</span> function returns an item from a
list of values, based on its position in the list. This position is specified
by the index.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:15.3pt;
margin-left:.25pt'>In the syntax, the index parameter specifies the item and is
a whole number, or integer. The val_1 <span style='font-family:"Arial",sans-serif'></span>
val_n parameter identifies the list of values.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:26.95pt;margin-bottom:
6.0pt;margin-left:3.5pt;text-indent:-.5pt'><span style='position:relative;
z-index:-1895759872'><span style='left:0px;position:absolute;left:0px;
top:-71617px;width:718px;height:1px'><img width=718 height=1
src="SQL%20Notes%20for%20Professionals_files/image390.gif"></span></span><span
style='font-size:9.0pt;line-height:110%;color:blue'>SELECT</span><span
style='font-size:9.0pt;line-height:110%;font-family:"Arial",sans-serif'> </span><span
style='font-size:9.0pt;line-height:110%;color:fuchsia'>CHOOSE</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>(</span><span
style='font-size:9.0pt;line-height:110%'>2</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>,</span><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:red'>'Human
Resources'</span><span style='font-size:9.0pt;line-height:110%;color:gray'>,</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:red'>'Sales'</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>,</span><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:red'>'Admin'</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>,</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:red'>'Marketing'</span><span style='font-size:9.0pt;
line-height:110%;font-family:"Arial",sans-serif'> </span><span
style='font-size:9.0pt;line-height:110%;color:gray'>)</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>AS</span><span style='font-size:9.0pt;line-height:
110%;font-family:"Arial",sans-serif'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>Result</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:482.1pt;margin-bottom:
14.85pt;margin-left:.25pt;text-indent:0in;line-height:111%'><b>Result </b>Sales</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.9pt;
margin-left:.25pt'>In this example, you use the <span style='font-size:9.0pt;
line-height:110%;color:fuchsia;background:#FAFAFA'>CHOOSE</span> function to
return the second entry in a list of departments.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.45pt;
margin-left:.25pt'>The <span style='font-size:9.0pt;line-height:110%;
color:fuchsia;background:#FAFAFA'>IIF</span> function returns one of two
values, based on a particular condition. If the condition is true, it will
return true value. Otherwise it will return a false value.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.25pt;
margin-left:.25pt'>In the syntax, the boolean_expression parameter specifies
the Boolean expression. The true_value parameter specifies the value that
should be returned if the boolean_expression evaluates to true and the
false_value parameter specifies the value that should be returned if the
boolean_expression evaluates to false.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:3.25pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=81
src="SQL%20Notes%20for%20Professionals_files/image391.gif"></span></p>

<p class=MsoNormal style='margin-bottom:.95pt;text-indent:0in;line-height:111%'><b>BusinessEntityID SalesYTD Bonus?</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.8pt;
margin-left:86.3pt;text-indent:-86.05pt'><span style='line-height:110%'>274<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>559697.5639 Bonus</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:86.3pt;text-indent:-86.05pt'><span style='line-height:110%'>275<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>3763178.1787 Bonus</p>

<p class=MsoNormal style='margin-bottom:15.05pt;text-indent:0in'>285 172524.4512 No
Bonus</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:27.75pt;
margin-left:.25pt'>In this example, you use the IIF function to return one of
two values. If a sales person's year-to-date sales are above 200,000, this
person will be eligible for a bonus. Values below 200,000 mean that employees
don't qualify for bonuses.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.6pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>SQL includes several
mathematical functions that you can use to perform calculations on input values
and return numeric results.</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.3pt;
margin-left:.25pt'>One example is the <span style='font-size:9.0pt;line-height:
110%;color:fuchsia;background:#FAFAFA'>SIGN</span> function, which returns a
value indicating the sign of an expression. The value of -1 indicates a
negative expression, the value of +1 indicates a positive expression, and 0
indicates zero.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:3.25pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=28
src="SQL%20Notes%20for%20Professionals_files/image392.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:507.8pt;margin-bottom:
14.8pt;margin-left:.25pt;text-indent:0in;line-height:111%'><b>Sign </b>-1</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.85pt;
margin-left:.25pt'>In the example, the input is a negative number, so the
Results pane lists the result -1.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.45pt;
margin-left:.25pt'>Another mathematical function is the <span style='font-size:
9.0pt;line-height:110%;color:fuchsia;background:#FAFAFA'>POWER</span> function.
This function provides the value of an expression raised to a specified power.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.25pt;
margin-left:.25pt'>In the syntax, the float_expression parameter specifies the
expression, and the y parameter specifies the power to which you want to raise
the expression.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:3.25pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=28
src="SQL%20Notes%20for%20Professionals_files/image393.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Result</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>125000<br clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc228691">Chapter 44: Functions
(Analytic)</a></h1>

<p class=MsoNormal style='margin-top:0in;margin-right:18.65pt;margin-bottom:
.2pt;margin-left:.25pt;text-align:justify;text-justify:inter-ideograph;
line-height:135%'>You use analytic functions to determine values based on
groups of values. For example, you can use this type of function to determine
running totals, percentages, or the top result within a group.</p>

<h2 style='margin-top:0in;margin-right:18.65pt;margin-bottom:.2pt;margin-left:
.25pt;text-align:justify;text-justify:inter-ideograph;text-indent:.5pt;
line-height:135%'><a name="_Toc228692">Section 44.1: LAG and LEAD</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.45pt;
margin-left:.25pt'>The <span style='font-size:9.0pt;line-height:110%;
color:fuchsia;background:#FAFAFA'>LAG</span> function provides data on rows
before the current row in the same result set. For example, in a <span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>SELECT </span>statement,
you can compare values in the current row with values in a previous row.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.5pt;
margin-left:.25pt'>You use a scalar expression to specify the values that
should be compared. The offset parameter is the number of rows before the
current row that will be used in the comparison. If you don't specify the
number of rows, the default value of one row is used.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.6pt;
margin-left:.25pt'>The default parameter specifies the value that should be
returned when the expression at offset has a <span style='font-size:9.0pt;
line-height:110%;color:#333399;background:#FAFAFA'>NULL</span> value. If you
don't specify a value, a value of <span style='font-size:9.0pt;line-height:
110%;color:#333399;background:#FAFAFA'>NULL</span> is returned.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.45pt;
margin-left:.25pt'>The <span style='font-size:9.0pt;line-height:110%;
color:fuchsia;background:#FAFAFA'>LEAD</span> function provides data on rows
after the current row in the row set. For example, in a <span style='font-size:
9.0pt;line-height:110%;color:blue;background:#FAFAFA'>SELECT</span> statement,
you can compare values in the current row with values in the following row.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.5pt;
margin-left:.25pt'>You specify the values that should be compared using a
scalar expression. The offset parameter is the number of rows after the current
row that will be used in the comparison.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.3pt;
margin-left:.25pt'>You specify the value that should be returned when the
expression at offset has a <span style='font-size:9.0pt;line-height:110%;
color:#333399;background:#FAFAFA'>NULL</span> value using the default
parameter. If you don't specify these parameters, the default of one row is
used and a value of <span style='font-size:9.0pt;line-height:110%;color:#333399;
background:#FAFAFA'>NULL</span> is returned.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=83
src="SQL%20Notes%20for%20Professionals_files/image394.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.45pt;
margin-left:.25pt'>This example uses the LEAD and LAG functions to compare the
sales values for each employee to date with those of the employees listed above
and below, with records ordered based on the BusinessEntityID column.</p>

<p class=MsoNormal style='margin-bottom:.95pt;text-indent:0in;line-height:111%'><b>BusinessEntityID SalesYTD Lead
value Lag value</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:92.0pt;text-indent:-91.75pt'><span style='line-height:110%'>274<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>559697.5639 3763178.1787 0.0000</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:92.0pt;text-indent:-91.75pt'><span style='line-height:110%'>275<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>3763178.1787 4251368.5497 559697.5639</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:92.0pt;text-indent:-91.75pt'><span style='line-height:110%'>276<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>4251368.5497 3189418.3662 3763178.1787</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:92.0pt;text-indent:-91.75pt'><span style='line-height:110%'>277<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>3189418.3662 1453719.4653 4251368.5497</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:92.0pt;text-indent:-91.75pt'><span style='line-height:110%'>278<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>1453719.4653 2315185.6110 3189418.3662</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:20.8pt;
margin-left:92.0pt;text-indent:-91.75pt'><span style='line-height:110%'>279<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>2315185.6110 1352577.1325 1453719.4653</p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228693">Section 44.2: PERCENTILE_DISC and PERCENTILE_CONT</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.6pt;
margin-left:.25pt'>The <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>PERCENTILE_DISC</span> function lists the value of the
first entry where the cumulative distribution is higher than the percentile
that you provide using the <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>numeric_literal</span> parameter.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=86 style='width:.9in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=86 valign=top style='width:.9in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:blue'>WITHIN</span><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:blue'>GROUP</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:13.1pt;
margin-left:.25pt'>The values are grouped by rowset or partition, as specified
by the clause.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.45pt;
margin-left:.25pt'>The <span style='font-size:9.0pt;line-height:110%;
color:fuchsia;background:#FAFAFA'>PERCENTILE_CONT</span> function is similar to
the <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>PERCENTILE_DISC</span>
function, but returns the average of the sum of the first matching entry and
the next entry.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=120
src="SQL%20Notes%20for%20Professionals_files/image395.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.45pt;
margin-left:.25pt'>To find the exact value from the row that matches or exceeds
the 0.5 percentile, you pass the percentile as the numeric literal in the <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>PERCENTILE_DISC</span>
function. The Percentile Discreet column in a result set lists the value of the
row at which the cumulative distribution is higher than the specified
percentile.</p>

<p class=MsoNormal style='margin-bottom:.95pt;text-indent:0in;line-height:111%'><b>BusinessEntityID JobTitle SickLeaveHours
Cumulative Distribution Percentile Discreet</b></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=537
 style='width:402.4pt;margin-left:1.0pt;border-collapse:collapse'>
 <tr style='height:13.65pt'>
  <td width=358 valign=top style='width:268.55pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>272 Application
  Specialist 55</p>
  </td>
  <td width=85 valign=top style='width:63.8pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>0.25</p>
  </td>
  <td width=93 valign=top style='width:70.0pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal align=right style='margin-bottom:0in;text-align:right;
  text-indent:0in;line-height:107%'><b>56</b></p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=358 valign=top style='width:268.55pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>268 Application
  Specialist 56</p>
  </td>
  <td width=85 valign=top style='width:63.8pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>0.75</p>
  </td>
  <td width=93 valign=top style='width:70.0pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal align=right style='margin-bottom:0in;text-align:right;
  text-indent:0in;line-height:107%'><b>56</b></p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=358 valign=top style='width:268.55pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>269 Application
  Specialist 56</p>
  </td>
  <td width=85 valign=top style='width:63.8pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>0.75</p>
  </td>
  <td width=93 valign=top style='width:70.0pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal align=right style='margin-bottom:0in;text-align:right;
  text-indent:0in;line-height:107%'><b>56</b></p>
  </td>
 </tr>
 <tr style='height:13.65pt'>
  <td width=358 valign=top style='width:268.55pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>267 Application
  Specialist 57</p>
  </td>
  <td width=85 valign=top style='width:63.8pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>1</p>
  </td>
  <td width=93 valign=top style='width:70.0pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal align=right style='margin-bottom:0in;text-align:right;
  text-indent:0in;line-height:107%'><b>56</b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:15.25pt;
margin-left:.25pt'>To base the calculation on a set of values, you use the <span
style='font-size:9.0pt;line-height:110%;color:fuchsia;background:#FAFAFA'>PERCENTILE_CONT</span>
function. The &quot;Percentile Continuous&quot; column in the results lists the
average value of the sum of the result value and the next highest matching
value.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:1.85pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%;color:blue'>SELECT</span><span style='font-size:9.0pt;line-height:110%;
font-family:"Arial",sans-serif'> </span><span style='font-size:9.0pt;
line-height:110%'>BusinessEntityID</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>,</span><span style='font-size:9.0pt;line-height:
110%;font-family:"Arial",sans-serif'> </span><span style='font-size:9.0pt;
line-height:110%'>JobTitle</span><span style='font-size:9.0pt;line-height:110%;
color:gray'>,</span><span style='font-size:9.0pt;line-height:110%;font-family:
"Arial",sans-serif'> </span><span style='font-size:9.0pt;line-height:110%'>SickLeaveHours</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>,</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:1.85pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%;font-family:"Arial",sans-serif'> </span><span style='font-size:9.0pt;
line-height:110%;color:fuchsia'>CUME_DIST</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>()</span><span style='font-size:9.0pt;line-height:
110%;font-family:"Arial",sans-serif'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>OVER</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>(</span><span style='font-size:9.0pt;line-height:
110%;color:blue'>PARTITION</span><span style='font-size:9.0pt;line-height:110%'>
</span><span style='font-size:9.0pt;line-height:110%;color:blue'>BY</span><span
style='font-size:9.0pt;line-height:110%;font-family:"Arial",sans-serif'> </span><span
style='font-size:9.0pt;line-height:110%'>JobTitle</span><span style='font-size:
9.0pt;line-height:110%;font-family:"Arial",sans-serif'> </span><span
style='font-size:9.0pt;line-height:110%;color:blue'>ORDER</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>BY</span><span style='font-size:9.0pt;line-height:
110%;font-family:"Arial",sans-serif'> </span><span style='font-size:9.0pt;
line-height:110%'>SickLeaveHours</span><span style='font-size:9.0pt;line-height:
110%;font-family:"Arial",sans-serif'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>ASC</span><span style='font-size:9.0pt;line-height:
110%;color:gray'>)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:1.85pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%;font-family:"Arial",sans-serif'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>AS</span><span style='font-size:9.0pt;line-height:
110%;font-family:"Arial",sans-serif'> </span><span style='font-size:9.0pt;
line-height:110%'>&quot;Cumulative Distribution&quot;</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>,</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:1.85pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%;font-family:"Arial",sans-serif'> </span><span style='font-size:9.0pt;
line-height:110%'>PERCENTILE_DISC</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>(</span><span style='font-size:9.0pt;line-height:
110%'>0.5</span><span style='font-size:9.0pt;line-height:110%;color:gray'>)</span><span
style='font-size:9.0pt;line-height:110%;font-family:"Arial",sans-serif'> </span><span
style='font-size:9.0pt;line-height:110%;color:blue'>WITHIN</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>GROUP</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>(</span><span style='font-size:9.0pt;line-height:
110%;color:blue'>ORDER</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:blue'>BY</span><span
style='font-size:9.0pt;line-height:110%'> SickLeaveHours</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>)</span><span
style='font-size:9.0pt;line-height:110%;font-family:"Arial",sans-serif'> </span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:1.85pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%;font-family:"Arial",sans-serif'> </span><span style='font-size:
9.0pt;line-height:110%;color:blue'>OVER</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>(</span><span style='font-size:9.0pt;line-height:
110%;color:blue'>PARTITION</span><span style='font-size:9.0pt;line-height:110%'>
</span><span style='font-size:9.0pt;line-height:110%;color:blue'>BY</span><span
style='font-size:9.0pt;line-height:110%'> JobTitle</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>)</span><span
style='font-size:9.0pt;line-height:110%;font-family:"Arial",sans-serif'> </span><span
style='font-size:9.0pt;line-height:110%;color:blue'>AS</span><span
style='font-size:9.0pt;line-height:110%;font-family:"Arial",sans-serif'> </span><span
style='font-size:9.0pt;line-height:110%'>&quot;Percentile Discreet&quot;</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>,</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:1.85pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%;font-family:"Arial",sans-serif'> </span><span style='font-size:9.0pt;
line-height:110%;color:fuchsia'>PERCENTILE_CONT</span><span style='font-size:
9.0pt;line-height:110%;color:gray'>(</span><span style='font-size:9.0pt;
line-height:110%'>0.5</span><span style='font-size:9.0pt;line-height:110%;
color:gray'>)</span><span style='font-size:9.0pt;line-height:110%;font-family:
"Arial",sans-serif'> </span><span style='font-size:9.0pt;line-height:110%;
color:blue'>WITHIN</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:blue'>GROUP</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>(</span><span
style='font-size:9.0pt;line-height:110%;color:blue'>ORDER</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>BY</span><span style='font-size:9.0pt;line-height:
110%'> SickLeaveHours</span><span style='font-size:9.0pt;line-height:110%;
color:gray'>)</span><span style='font-size:9.0pt;line-height:110%;font-family:
"Arial",sans-serif'> </span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:202.35pt;margin-bottom:
.15pt;margin-left:3.5pt;text-indent:-.5pt'><span style='position:relative;
z-index:-1895758848'><span style='left:0px;position:absolute;left:0px;
top:-73978px;width:718px;height:1px'><img width=718 height=1
src="SQL%20Notes%20for%20Professionals_files/image396.gif"></span></span><span
style='font-size:9.0pt;line-height:110%;font-family:"Arial",sans-serif'>
</span><span style='font-size:9.0pt;line-height:110%;color:blue'>OVER</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>(</span><span
style='font-size:9.0pt;line-height:110%;color:blue'>PARTITION</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>BY</span><span style='font-size:9.0pt;line-height:
110%'> JobTitle</span><span style='font-size:9.0pt;line-height:110%;color:gray'>)</span><span
style='font-size:9.0pt;line-height:110%;font-family:"Arial",sans-serif'> </span><span
style='font-size:9.0pt;line-height:110%;color:blue'>AS</span><span
style='font-size:9.0pt;line-height:110%;font-family:"Arial",sans-serif'> </span><span
style='font-size:9.0pt;line-height:110%'>&quot;Percentile Continuous&quot; </span><span
style='font-size:9.0pt;line-height:110%;color:blue'>FROM</span><span
style='font-size:9.0pt;line-height:110%;font-family:"Arial",sans-serif'> </span><span
style='font-size:9.0pt;line-height:110%'>Employee</span><span style='font-size:
9.0pt;line-height:110%;color:gray'>;</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=695
 style='width:521.05pt;margin-left:1.0pt;border-collapse:collapse'>
 <tr style='height:24.3pt'>
  <td width=115 style='width:86.05pt;padding:0in 0in 0in 0in;height:24.3pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><b>BusinessEntityID</b></p>
  </td>
  <td width=243 style='width:182.5pt;padding:0in 0in 0in 0in;height:24.3pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><span
  style='font-size:11.0pt;line-height:107%'> </span><b>JobTitle SickLeaveHours</b></p>
  </td>
  <td width=125 valign=top style='width:1.3in;padding:0in 0in 0in 0in;
  height:24.3pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;text-align:center;
  text-indent:0in;line-height:107%'><b>Cumulative Distribution</b></p>
  </td>
  <td width=115 valign=top style='width:85.95pt;padding:0in 0in 0in 0in;
  height:24.3pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;text-align:center;
  text-indent:0in;line-height:107%'><b>Percentile Discreet</b></p>
  </td>
  <td width=97 valign=top style='width:72.9pt;padding:0in 0in 0in 0in;
  height:24.3pt'>
  <p class=MsoNormal align=center style='margin-bottom:0in;text-align:center;
  text-indent:0in;line-height:107%'><b>Percentile Continuous</b></p>
  </td>
 </tr>
 <tr style='height:15.4pt'>
  <td width=115 valign=top style='width:86.05pt;padding:0in 0in 0in 0in;
  height:15.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>272</p>
  </td>
  <td width=243 valign=top style='width:182.5pt;padding:0in 0in 0in 0in;
  height:15.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Application
  Specialist 55</p>
  </td>
  <td width=125 valign=top style='width:1.3in;padding:0in 0in 0in 0in;
  height:15.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>0.25</p>
  </td>
  <td width=115 valign=top style='width:85.95pt;padding:0in 0in 0in 0in;
  height:15.4pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
  margin-left:5.15pt;text-indent:0in;line-height:107%'>56</p>
  </td>
  <td width=97 valign=top style='width:72.9pt;padding:0in 0in 0in 0in;
  height:15.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><b>56</b></p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=115 valign=top style='width:86.05pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>268</p>
  </td>
  <td width=243 valign=top style='width:182.5pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Application
  Specialist 56</p>
  </td>
  <td width=125 valign=top style='width:1.3in;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>0.75</p>
  </td>
  <td width=115 valign=top style='width:85.95pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
  margin-left:5.15pt;text-indent:0in;line-height:107%'>56</p>
  </td>
  <td width=97 valign=top style='width:72.9pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><b>56</b></p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=115 valign=top style='width:86.05pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>269</p>
  </td>
  <td width=243 valign=top style='width:182.5pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Application
  Specialist 56</p>
  </td>
  <td width=125 valign=top style='width:1.3in;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>0.75</p>
  </td>
  <td width=115 valign=top style='width:85.95pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
  margin-left:5.15pt;text-indent:0in;line-height:107%'>56</p>
  </td>
  <td width=97 valign=top style='width:72.9pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><b>56</b></p>
  </td>
 </tr>
 <tr style='height:13.65pt'>
  <td width=115 valign=top style='width:86.05pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>267</p>
  </td>
  <td width=243 valign=top style='width:182.5pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Application
  Specialist 57</p>
  </td>
  <td width=125 valign=top style='width:1.3in;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>1</p>
  </td>
  <td width=115 valign=top style='width:85.95pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
  margin-left:5.15pt;text-indent:0in;line-height:107%'>56</p>
  </td>
  <td width=97 valign=top style='width:72.9pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><b>56</b></p>
  </td>
 </tr>
</table>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228694">Section 44.3: FIRST_VALUE</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.35pt;
margin-left:.25pt'>You use the <span style='font-size:9.0pt;line-height:110%;
color:fuchsia;background:#FAFAFA'>FIRST_VALUE</span> function to determine the
first value in an ordered result set, which you identify using a scalar
expression.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:15.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=81
src="SQL%20Notes%20for%20Professionals_files/image397.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.45pt;
margin-left:.25pt'>In this example, the <span style='font-size:9.0pt;
line-height:110%;color:fuchsia;background:#FAFAFA'>FIRST_VALUE</span> function
is used to return the <span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>ID</span> of the state or province with the lowest tax rate. The <span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>OVER</span>
clause is used to order the tax rates to obtain the lowest rate.</p>

<p class=MsoNormal style='margin-bottom:.95pt;text-indent:0in;line-height:111%'><b>StateProvinceID Name TaxRate
FirstValue</b></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=374
 style='width:280.15pt;margin-left:1.0pt;border-collapse:collapse'>
 <tr style='height:13.65pt'>
  <td width=358 colspan=2 valign=top style='width:268.7pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>74 Utah
  State Sales Tax 5.00</p>
  </td>
  <td width=15 valign=top style='width:11.45pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>74</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=358 colspan=2 valign=top style='width:268.7pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>36 Minnesota
  State Sales Tax 6.75</p>
  </td>
  <td width=15 valign=top style='width:11.45pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>74</p>
  </td>
 </tr>
 <tr style='height:13.65pt'>
  <td width=358 colspan=2 valign=top style='width:268.7pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>30 Massachusetts
  State Sales Tax 7.00</p>
  </td>
  <td width=15 valign=top style='width:11.45pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>74</p>
  </td>
 </tr>
 <tr style='height:13.65pt'>
  <td width=302 valign=top style='width:226.2pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>1 Canadian
  GST</p>
  </td>
  <td width=57 valign=top style='width:42.5pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>7.00</p>
  </td>
  <td width=15 valign=top style='width:11.45pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>74</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=302 valign=top style='width:226.2pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>57 Canadian
  GST</p>
  </td>
  <td width=57 valign=top style='width:42.5pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>7.00</p>
  </td>
  <td width=15 valign=top style='width:11.45pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>74</p>
  </td>
 </tr>
 <tr style='height:13.65pt'>
  <td width=302 valign=top style='width:226.2pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>63 Canadian
  GST</p>
  </td>
  <td width=57 valign=top style='width:42.5pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>7.00</p>
  </td>
  <td width=15 valign=top style='width:11.45pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>74</p>
  </td>
 </tr>
</table>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228695">Section 44.4: LAST_VALUE</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.35pt;
margin-left:.25pt'>The <span style='font-size:9.0pt;line-height:110%;
color:fuchsia;background:#FAFAFA'>LAST_VALUE</span> function provides the last
value in an ordered result set, which you specify using a scalar expression.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:15.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=81
src="SQL%20Notes%20for%20Professionals_files/image398.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.85pt;
margin-left:.25pt'>This example uses the <span style='font-size:9.0pt;
line-height:110%;color:fuchsia;background:#FAFAFA'>LAST_VALUE</span> function
to return the last value for each rowset in the ordered values.</p>

<p class=MsoNormal style='margin-bottom:.95pt;text-indent:0in;line-height:111%'><b>TerritoryID StartDate BusinessentityID
LastValue</b></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=371
 style='width:278.3pt;margin-left:1.0pt;border-collapse:collapse'>
 <tr style='height:13.65pt'>
  <td width=76 valign=top style='width:57.3pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>1</p>
  </td>
  <td width=272 valign=top style='width:203.85pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>2005-07-01
  00.00.00.000 280</p>
  </td>
  <td width=23 valign=top style='width:17.15pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>283</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=76 valign=top style='width:57.3pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>1</p>
  </td>
  <td width=272 valign=top style='width:203.85pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>2006-11-01
  00.00.00.000 284</p>
  </td>
  <td width=23 valign=top style='width:17.15pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>283</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=76 valign=top style='width:57.3pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>1</p>
  </td>
  <td width=272 valign=top style='width:203.85pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>2005-07-01
  00.00.00.000 283</p>
  </td>
  <td width=23 valign=top style='width:17.15pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>283</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=76 valign=top style='width:57.3pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>2</p>
  </td>
  <td width=272 valign=top style='width:203.85pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>2007-01-01
  00.00.00.000 277</p>
  </td>
  <td width=23 valign=top style='width:17.15pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>275</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=76 valign=top style='width:57.3pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>2</p>
  </td>
  <td width=272 valign=top style='width:203.85pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>2005-07-01
  00.00.00.000 275</p>
  </td>
  <td width=23 valign=top style='width:17.15pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>275</p>
  </td>
 </tr>
 <tr style='height:13.65pt'>
  <td width=76 valign=top style='width:57.3pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>3</p>
  </td>
  <td width=272 valign=top style='width:203.85pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>2007-01-01
  00.00.00.000 275</p>
  </td>
  <td width=23 valign=top style='width:17.15pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>277</p>
  </td>
 </tr>
</table>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228696">Section 44.5: PERCENT_RANK and CUME_DIST</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.7pt;
margin-left:.25pt'>The <span style='font-size:9.0pt;line-height:110%;
color:fuchsia;background:#FAFAFA'>PERCENT_RANK</span> function calculates the
ranking of a row relative to the row set. The percentage is based on the number
of rows in the group that have a lower value than the current row.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.55pt;
margin-left:.25pt'>The first value in the result set always has a percent rank
of zero. The value for the highest-ranked <span style='font-family:"Arial",sans-serif'></span>
or last <span style='font-family:"Arial",sans-serif'></span> value in the set
is always one.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.3pt;
margin-left:.25pt'>The <span style='font-size:9.0pt;line-height:110%;
color:fuchsia;background:#FAFAFA'>CUME_DIST</span> function calculates the
relative position of a specified value in a group of values, by determining the
percentage of values less than or equal to that value. This is called the
cumulative distribution.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:15.3pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=120
src="SQL%20Notes%20for%20Professionals_files/image399.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.7pt;
margin-left:.25pt'>In this example, you use an <span style='font-size:9.0pt;
line-height:110%;color:blue;background:#FAFAFA'>ORDER</span> clause to
partition <span style='font-family:"Arial",sans-serif'></span> or group <span
style='font-family:"Arial",sans-serif'></span> the rows retrieved by the <span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>SELECT</span>
statement based on employees' job titles, with the results in each group sorted
based on the numbers of sick leave hours that employees have used.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=715
 style='width:536.6pt;margin-left:1.0pt;border-collapse:collapse'>
 <tr style='height:12.1pt'>
  <td width=317 valign=top style='width:237.75pt;padding:0in 0in 0in 0in;
  height:12.1pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><b>BusinessEntityID JobTitle</b></p>
  </td>
  <td width=398 valign=top style='width:298.85pt;padding:0in 0in 0in 0in;
  height:12.1pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><b>SickLeaveHours Percent
  Rank Cumulative Distribution</b></p>
  </td>
 </tr>
 <tr style='height:15.55pt'>
  <td width=317 valign=top style='width:237.75pt;padding:0in 0in 0in 0in;
  height:15.55pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>267 Application
  Specialist</p>
  </td>
  <td width=398 valign=top style='width:298.85pt;padding:0in 0in 0in 0in;
  height:15.55pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>57 0 0.25</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=317 valign=top style='width:237.75pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>268 Application
  Specialist</p>
  </td>
  <td width=398 valign=top style='width:298.85pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>56 0.333333333333333
  0.75</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=317 valign=top style='width:237.75pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>269 Application
  Specialist</p>
  </td>
  <td width=398 valign=top style='width:298.85pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>56 0.333333333333333
  0.75</p>
  </td>
 </tr>
 <tr style='height:13.65pt'>
  <td width=317 valign=top style='width:237.75pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>272 Application
  Specialist</p>
  </td>
  <td width=398 valign=top style='width:298.85pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>55 1 1</p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:87.05pt'>Assitant to the Cheif Financial</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=680
 style='width:510.35pt;margin-left:1.0pt;border-collapse:collapse'>
 <tr style='height:19.85pt'>
  <td width=112 valign=top style='width:83.7pt;padding:0in 0in 0in 0in;
  height:19.85pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>262</p>
  </td>
  <td width=205 valign=top style='width:154.05pt;padding:0in 0in 0in 0in;
  height:19.85pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
  margin-left:2.35pt;text-indent:0in;line-height:107%'>Officer</p>
  </td>
  <td width=108 valign=top style='width:81.0pt;padding:0in 0in 0in 0in;
  height:19.85pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>48</p>
  </td>
  <td width=130 valign=top style='width:97.45pt;padding:0in 0in 0in 0in;
  height:19.85pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>0</p>
  </td>
  <td width=126 valign=top style='width:94.2pt;padding:0in 0in 0in 0in;
  height:19.85pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>1</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=112 valign=top style='width:83.7pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>239</p>
  </td>
  <td width=205 valign=top style='width:154.05pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
  margin-left:2.35pt;text-indent:0in;line-height:107%'>Benefits Specialist</p>
  </td>
  <td width=108 valign=top style='width:81.0pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>45</p>
  </td>
  <td width=130 valign=top style='width:97.45pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>0</p>
  </td>
  <td width=126 valign=top style='width:94.2pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>1</p>
  </td>
 </tr>
 <tr style='height:16.95pt'>
  <td width=112 valign=top style='width:83.7pt;padding:0in 0in 0in 0in;
  height:16.95pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>252</p>
  </td>
  <td width=205 valign=top style='width:154.05pt;padding:0in 0in 0in 0in;
  height:16.95pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
  margin-left:2.35pt;text-indent:0in;line-height:107%'>Buyer</p>
  </td>
  <td width=108 valign=top style='width:81.0pt;padding:0in 0in 0in 0in;
  height:16.95pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>50</p>
  </td>
  <td width=130 valign=top style='width:97.45pt;padding:0in 0in 0in 0in;
  height:16.95pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>0</p>
  </td>
  <td width=126 valign=top style='width:94.2pt;padding:0in 0in 0in 0in;
  height:16.95pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>0.111111111111111</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=112 valign=top style='width:83.7pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>251</p>
  </td>
  <td width=205 valign=top style='width:154.05pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
  margin-left:2.35pt;text-indent:0in;line-height:107%'>Buyer</p>
  </td>
  <td width=108 valign=top style='width:81.0pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>49</p>
  </td>
  <td width=130 valign=top style='width:97.45pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>0.125</p>
  </td>
  <td width=126 valign=top style='width:94.2pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>0.333333333333333</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=112 valign=top style='width:83.7pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>256</p>
  </td>
  <td width=205 valign=top style='width:154.05pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
  margin-left:2.35pt;text-indent:0in;line-height:107%'>Buyer</p>
  </td>
  <td width=108 valign=top style='width:81.0pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>49</p>
  </td>
  <td width=130 valign=top style='width:97.45pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>0.125</p>
  </td>
  <td width=126 valign=top style='width:94.2pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>0.333333333333333</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=112 valign=top style='width:83.7pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>253</p>
  </td>
  <td width=205 valign=top style='width:154.05pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
  margin-left:2.35pt;text-indent:0in;line-height:107%'>Buyer</p>
  </td>
  <td width=108 valign=top style='width:81.0pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>48</p>
  </td>
  <td width=130 valign=top style='width:97.45pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>0.375</p>
  </td>
  <td width=126 valign=top style='width:94.2pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>0.555555555555555</p>
  </td>
 </tr>
 <tr style='height:13.65pt'>
  <td width=112 valign=top style='width:83.7pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>254</p>
  </td>
  <td width=205 valign=top style='width:154.05pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
  margin-left:2.35pt;text-indent:0in;line-height:107%'>Buyer</p>
  </td>
  <td width=108 valign=top style='width:81.0pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>48</p>
  </td>
  <td width=130 valign=top style='width:97.45pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>0.375</p>
  </td>
  <td width=126 valign=top style='width:94.2pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>0.555555555555555</p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.55pt;
margin-left:.25pt'>The <span style='font-size:9.0pt;line-height:110%;
color:fuchsia;background:#FAFAFA'>PERCENT_RANK</span> function ranks the
entries within each group. For each entry, it returns the percentage of entries
in the same group that have lower values.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.3pt;
margin-left:.25pt'>The <span style='font-size:9.0pt;line-height:110%;
color:fuchsia;background:#FAFAFA'>CUME_DIST</span> function is similar, except
that it returns the percentage of values less than or equal to the current
value.<br clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc228697">Chapter 45: Window
Functions</a></h1>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228698">Section 45.1: Setting up a flag if other rows have
a common property</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>Let's say I have this data:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>Table items</p>

<p class=MsoNormal style='margin-bottom:.95pt;text-indent:0in;line-height:111%'><b>id name tag</b></p>

<p class=MsoNormal style='text-indent:0in'>1 example unique_tag</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=118
 style='width:88.8pt;margin-left:1.0pt;border-collapse:collapse'>
 <tr style='height:13.65pt'>
  <td width=77 valign=top style='width:57.9pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>2 foo</p>
  </td>
  <td width=41 valign=top style='width:30.85pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>simple</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=77 valign=top style='width:57.9pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>42
  bar</p>
  </td>
  <td width=41 valign=top style='width:30.85pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>simple</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=77 valign=top style='width:57.9pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>3 baz</p>
  </td>
  <td width=41 valign=top style='width:30.85pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>hello</p>
  </td>
 </tr>
 <tr style='height:13.65pt'>
  <td width=77 valign=top style='width:57.9pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>51
  quux</p>
  </td>
  <td width=41 valign=top style='width:30.85pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>world</p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:14.45pt;
margin-left:.25pt'>I'd like to get all those lines and know if a tag is used by
other lines</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:17.25pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='position:relative;z-index:
-1895757824'><span style='left:0px;position:absolute;left:0px;top:-75877px;
width:718px;height:1px'><img width=718 height=1
src="SQL%20Notes%20for%20Professionals_files/image134.gif"></span></span><span
style='font-size:9.0pt;line-height:110%;color:blue'>SELECT</span><span
style='font-size:9.0pt;line-height:110%'> id</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>,</span><span style='font-size:9.0pt;line-height:
110%'> name</span><span style='font-size:9.0pt;line-height:110%;color:gray'>,</span><span
style='font-size:9.0pt;line-height:110%'> tag</span><span style='font-size:
9.0pt;line-height:110%;color:gray'>,</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:fuchsia'>COUNT</span><span style='font-size:9.0pt;line-height:110%;
color:gray'>(*)</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:blue'>OVER</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:gray'>(</span><span style='font-size:9.0pt;line-height:
110%;color:blue'>PARTITION</span><span style='font-size:9.0pt;line-height:110%'>
</span><span style='font-size:9.0pt;line-height:110%;color:blue'>BY</span><span
style='font-size:9.0pt;line-height:110%'> tag</span><span style='font-size:
9.0pt;line-height:110%;color:gray'>)</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:gray'>&gt;</span><span style='font-size:9.0pt;line-height:110%'> 1 </span><span
style='font-size:9.0pt;line-height:110%;color:blue'>AS</span><span
style='font-size:9.0pt;line-height:110%'> flag </span><span style='font-size:
9.0pt;line-height:110%;color:blue'>FROM</span><span style='font-size:9.0pt;
line-height:110%'> items</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>The result will be:</p>

<p class=MsoNormal style='margin-bottom:.95pt;text-indent:0in;line-height:111%'><b>id name tag flag</b></p>

<p class=MsoNormal style='text-indent:0in'>1 example unique_tag false</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=180
 style='width:134.75pt;margin-left:1.0pt;border-collapse:collapse'>
 <tr style='height:13.65pt'>
  <td width=77 valign=top style='width:57.9pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>2 foo</p>
  </td>
  <td width=73 valign=top style='width:55.0pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>simple</p>
  </td>
  <td width=29 valign=top style='width:21.85pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>true</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=77 valign=top style='width:57.9pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>42
  bar</p>
  </td>
  <td width=73 valign=top style='width:55.0pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>simple</p>
  </td>
  <td width=29 valign=top style='width:21.85pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>true</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=77 valign=top style='width:57.9pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>3 baz</p>
  </td>
  <td width=73 valign=top style='width:55.0pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>hello</p>
  </td>
  <td width=29 valign=top style='width:21.85pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>false</p>
  </td>
 </tr>
 <tr style='height:13.65pt'>
  <td width=77 valign=top style='width:57.9pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>51
  quux</p>
  </td>
  <td width=73 valign=top style='width:55.0pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>world</p>
  </td>
  <td width=29 valign=top style='width:21.85pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>false</p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:14.45pt;
margin-left:.25pt'>In case your database doesn't have OVER and PARTITION you
can use this to produce the same result:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:23.0pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='position:relative;z-index:
-1895756800'><span style='left:0px;position:absolute;left:0px;top:-76114px;
width:718px;height:1px'><img width=718 height=1
src="SQL%20Notes%20for%20Professionals_files/image134.gif"></span></span><span
style='font-size:9.0pt;line-height:110%;color:blue'>SELECT</span><span
style='font-size:9.0pt;line-height:110%'> id</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>,</span><span style='font-size:9.0pt;line-height:
110%'> name</span><span style='font-size:9.0pt;line-height:110%;color:gray'>,</span><span
style='font-size:9.0pt;line-height:110%'> tag</span><span style='font-size:
9.0pt;line-height:110%;color:gray'>,</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:gray'>(</span><span style='font-size:9.0pt;line-height:110%;color:blue'>SELECT</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:fuchsia'>COUNT</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>(</span><span style='font-size:9.0pt;line-height:
110%'>tag</span><span style='font-size:9.0pt;line-height:110%;color:gray'>)</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>FROM</span><span style='font-size:9.0pt;
line-height:110%'> items B </span><span style='font-size:9.0pt;line-height:
110%;color:blue'>WHERE</span><span style='font-size:9.0pt;line-height:110%'>
tag </span><span style='font-size:9.0pt;line-height:110%;color:gray'>=</span><span
style='font-size:9.0pt;line-height:110%'> A</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>.</span><span style='font-size:9.0pt;line-height:
110%;color:#25256F'>tag</span><span style='font-size:9.0pt;line-height:110%;
color:gray'>)</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:gray'>&gt;</span><span
style='font-size:9.0pt;line-height:110%'> 1 </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>AS</span><span style='font-size:9.0pt;line-height:
110%'> flag </span><span style='font-size:9.0pt;line-height:110%;color:blue'>FROM</span><span
style='font-size:9.0pt;line-height:110%'> items A</span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228699">Section 45.2: Finding &quot;out-of-sequence&quot;
records using the LAG() function</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>Given these sample data:</p>

<p class=MsoNormal style='margin-bottom:.95pt;text-indent:0in;line-height:111%'><b>ID
STATUS STATUS_TIME STATUS_BY</b></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=296
 style='width:221.75pt;margin-left:1.0pt;border-collapse:collapse'>
 <tr style='height:13.65pt'>
  <td width=69 valign=top style='width:51.75pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>1
  ONE</p>
  </td>
  <td width=227 valign=top style='width:170.0pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>2016-09-28-19.47.52.501398
  USER_1</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=69 valign=top style='width:51.75pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>3
  ONE</p>
  </td>
  <td width=227 valign=top style='width:170.0pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>2016-09-28-19.47.52.501511
  USER_2</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=69 valign=top style='width:51.75pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>1
  THREE</p>
  </td>
  <td width=227 valign=top style='width:170.0pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>2016-09-28-19.47.52.501517
  USER_3</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=69 valign=top style='width:51.75pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>3
  TWO</p>
  </td>
  <td width=227 valign=top style='width:170.0pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>2016-09-28-19.47.52.501521
  USER_2</p>
  </td>
 </tr>
 <tr style='height:13.65pt'>
  <td width=69 valign=top style='width:51.75pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>3
  THREE</p>
  </td>
  <td width=227 valign=top style='width:170.0pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>2016-09-28-19.47.52.501524
  USER_4</p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.45pt;
margin-left:.25pt'>Items identified by <span style='font-size:9.0pt;line-height:
110%;background:#FAFAFA'>ID</span> values must move from <span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>STATUS</span>
'ONE' to 'TWO' to 'THREE' in sequence, without skipping statuses. The problem
is to find users (<span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>STATUS_BY</span>) values who violate the rule and move from 'ONE'
immediately to 'THREE'.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=36 style='width:27.0pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=36 valign=top style='width:27.0pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:fuchsia'>LAG</span><span style='font-size:9.0pt;
  line-height:107%;color:gray'>()</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>The analytical function helps to solve the problem by
returning for each row the value in the preceding row:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=109
src="SQL%20Notes%20for%20Professionals_files/image400.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:14.45pt;
margin-left:.25pt'>In case your database doesn't have LAG() you can use this to
produce the same result:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%;color:blue'>SELECT</span><span style='font-size:9.0pt;line-height:110%'> A</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>.</span><span
style='font-size:9.0pt;line-height:110%;color:#25256F'>id</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>,</span><span
style='font-size:9.0pt;line-height:110%'> A</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>.</span><span style='font-size:9.0pt;line-height:
110%;color:blue'>status</span><span style='font-size:9.0pt;line-height:110%;
color:gray'>,</span><span style='font-size:9.0pt;line-height:110%'> B</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>.</span><span
style='font-size:9.0pt;line-height:110%;color:blue'>status</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>as</span><span style='font-size:9.0pt;line-height:
110%'> prev_status</span><span style='font-size:9.0pt;line-height:110%;
color:gray'>,</span><span style='font-size:9.0pt;line-height:110%'> A</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>.</span><span
style='font-size:9.0pt;line-height:110%;color:#25256F'>status_time</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>,</span><span
style='font-size:9.0pt;line-height:110%'> B</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>.</span><span style='font-size:9.0pt;line-height:
110%;color:#25256F'>status_time</span><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:blue'>as</span><span
style='font-size:9.0pt;line-height:110%'> prev_status_time</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%;color:blue'>FROM</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:blue'>Data</span><span
style='font-size:9.0pt;line-height:110%'> A</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>,</span><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:blue'>Data</span><span
style='font-size:9.0pt;line-height:110%'> B</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%;color:blue'>WHERE</span><span style='font-size:9.0pt;line-height:110%'> A</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>.</span><span
style='font-size:9.0pt;line-height:110%;color:#25256F'>id</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:gray'>=</span><span style='font-size:9.0pt;line-height:
110%'> B</span><span style='font-size:9.0pt;line-height:110%;color:gray'>.</span><span
style='font-size:9.0pt;line-height:110%;color:#25256F'>id</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='position:relative;z-index:
-1895755776'><span style='left:0px;position:absolute;left:0px;top:-76688px;
width:718px;height:1px'><img width=718 height=1
src="SQL%20Notes%20for%20Professionals_files/image401.gif"></span></span><span
style='font-size:9.0pt;line-height:110%;color:#333399'>AND</span><span
style='font-size:9.0pt;line-height:110%'> B</span><span style='font-size:
9.0pt;line-height:110%;color:gray'>.</span><span style='font-size:9.0pt;
line-height:110%;color:#25256F'>status_time</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:gray'>=</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:gray'>(</span><span
style='font-size:9.0pt;line-height:110%;color:blue'>SELECT</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:fuchsia'>MAX</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>(</span><span style='font-size:9.0pt;line-height:
110%'>status_time</span><span style='font-size:9.0pt;line-height:110%;
color:gray'>)</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:blue'>FROM</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>Data</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:blue'>where</span><span style='font-size:9.0pt;line-height:110%'>
status_time </span><span style='font-size:9.0pt;line-height:110%;color:gray'>&lt;</span><span
style='font-size:9.0pt;line-height:110%'> A</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>.</span><span style='font-size:9.0pt;line-height:
110%;color:#25256F'>status_time</span><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:#333399'>and</span><span
style='font-size:9.0pt;line-height:110%'> id </span><span style='font-size:
9.0pt;line-height:110%;color:gray'>=</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
margin-left:3.5pt;text-indent:-.5pt;line-height:107%'><span style='font-size:
9.0pt;line-height:107%'>A</span><span style='font-size:9.0pt;line-height:107%;
color:gray'>.</span><span style='font-size:9.0pt;line-height:107%;color:#25256F'>id</span><span
style='font-size:9.0pt;line-height:107%;color:gray'>)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:23.0pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%;color:#333399'>AND</span><span style='font-size:9.0pt;line-height:110%'>
A</span><span style='font-size:9.0pt;line-height:110%;color:gray'>.</span><span
style='font-size:9.0pt;line-height:110%;color:blue'>status</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:gray'>=</span><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:red'>'THREE'</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#333399'>AND</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:#333399'>NOT</span><span style='font-size:9.0pt;line-height:110%'> B</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>.</span><span
style='font-size:9.0pt;line-height:110%;color:blue'>status</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:gray'>=</span><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:red'>'TWO'</span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228700">Section 45.3: Getting a running total</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>Given this data:</p>

<p class=MsoNormal style='margin-bottom:.95pt;text-indent:0in;line-height:111%'><span
style='font-size:11.0pt;line-height:111%'> </span><b>date amount</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:.25pt'>2016-03-12 200</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:.25pt'>2016-03-11 -50</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:.25pt'>2016-03-14 100</p>

<p class=MsoNormal style='margin-top:0in;margin-right:412.7pt;margin-bottom:
.2pt;margin-left:.25pt;line-height:141%'>2016-03-15 100 2016-03-10 -250</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="SQL%20Notes%20for%20Professionals_files/image402.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>will give you</p>

<p class=MsoNormal style='margin-bottom:.95pt;text-indent:0in;line-height:111%'><span
style='font-size:11.0pt;line-height:111%'> </span><b>date amount
running</b></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=156
 style='width:117.35pt;margin-left:1.0pt;border-collapse:collapse'>
 <tr style='height:13.65pt'>
  <td width=129 valign=top style='width:97.0pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>2016-03-10
  -250</p>
  </td>
  <td width=27 valign=top style='width:20.4pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>-250</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=129 valign=top style='width:97.0pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>2016-03-11
  -50</p>
  </td>
  <td width=27 valign=top style='width:20.4pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>-300</p>
  </td>
 </tr>
 <tr style='height:16.55pt'>
  <td width=129 valign=top style='width:97.0pt;padding:0in 0in 0in 0in;
  height:16.55pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>2016-03-12
  200</p>
  </td>
  <td width=27 valign=top style='width:20.4pt;padding:0in 0in 0in 0in;
  height:16.55pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>-100</p>
  </td>
 </tr>
 <tr style='height:16.95pt'>
  <td width=129 valign=top style='width:97.0pt;padding:0in 0in 0in 0in;
  height:16.95pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>2016-03-14
  100</p>
  </td>
  <td width=27 valign=top style='width:20.4pt;padding:0in 0in 0in 0in;
  height:16.95pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>0</p>
  </td>
 </tr>
 <tr style='height:13.65pt'>
  <td width=129 valign=top style='width:97.0pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>2016-03-15
  100</p>
  </td>
  <td width=27 valign=top style='width:20.4pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>-100</p>
  </td>
 </tr>
</table>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:4.2pt;margin-left:
-.25pt'><a name="_Toc228701">Section 45.4: Adding the total rows selected to
every row</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.05pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='position:relative;z-index:
-1895754752'><span style='left:0px;position:absolute;left:0px;top:-77270px;
width:718px;height:1px'><img width=718 height=1
src="SQL%20Notes%20for%20Professionals_files/image134.gif"></span></span><span
style='font-size:9.0pt;line-height:110%;color:blue'>SELECT</span><span
style='font-size:9.0pt;line-height:110%'> your_columns</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>,</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:fuchsia'>COUNT</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>(*)</span><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:blue'>OVER</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>()</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>as</span><span style='font-size:9.0pt;line-height:
110%'> Ttl_Rows </span><span style='font-size:9.0pt;line-height:110%;
color:blue'>FROM</span><span style='font-size:9.0pt;line-height:110%'>
your_data_set</span></p>

<p class=MsoNormal style='margin-bottom:.95pt;text-indent:0in;line-height:111%'><b>id name Ttl_Rows</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>1 example 5</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=80
 style='width:60.35pt;margin-left:1.0pt;border-collapse:collapse'>
 <tr style='height:13.65pt'>
  <td width=73 valign=top style='width:54.6pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>2
  foo</p>
  </td>
  <td width=8 valign=top style='width:5.7pt;padding:0in 0in 0in 0in;height:
  13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>5</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=73 valign=top style='width:54.6pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>3
  bar</p>
  </td>
  <td width=8 valign=top style='width:5.7pt;padding:0in 0in 0in 0in;height:
  16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>5</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=73 valign=top style='width:54.6pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>4
  baz</p>
  </td>
  <td width=8 valign=top style='width:5.7pt;padding:0in 0in 0in 0in;height:
  16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>5</p>
  </td>
 </tr>
 <tr style='height:13.65pt'>
  <td width=73 valign=top style='width:54.6pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>5
  quux</p>
  </td>
  <td width=8 valign=top style='width:5.7pt;padding:0in 0in 0in 0in;height:
  13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>5</p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.25pt;
margin-left:.25pt'>Instead of using two queries to get a count then the line,
you can use an aggregate as a window function and use the full result set as
the window.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:18.55pt;
margin-left:.25pt'>This can be used as a base for further calculation without
the complexity of extra self joins.</p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228702">Section 45.5: Getting the N most recent rows over
multiple grouping</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>Given this data</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>User_ID Completion_Date</b></p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'>1 2016-07-20</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:40.05pt;text-indent:-39.8pt'><span style='line-height:110%'>1<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>2016-07-21</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:40.05pt;text-indent:-39.8pt'><span style='line-height:110%'>2<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>2016-07-20</p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'>2 2016-07-21</p>

<p class=MsoNormal style='text-indent:0in'>2 2016-07-22</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:15.1pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=109
src="SQL%20Notes%20for%20Professionals_files/image403.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.9pt;
margin-left:.25pt'>Using n=1, you'll get the one most recent row per <span
style='font-size:9.0pt;line-height:110%;color:fuchsia;background:#FAFAFA'>user_id</span>:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>User_ID Completion_Date
Row_Num</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:40.05pt;text-indent:-39.8pt'><span style='line-height:110%'>1<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>2016-07-21 1</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:40.05pt;text-indent:-39.8pt'><span style='line-height:110%'>2<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>2016-07-22 1<br clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc228703">Chapter 46: Common Table
Expressions</a></h1>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228704">Section 46.1: generating values</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.55pt;
margin-left:.25pt'>Most databases do not have a native way of generating a
series of numbers for ad-hoc use; however, common table expressions can be used
with recursion to emulate that type of function.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.3pt;
margin-left:.25pt'>The following example generates a common table expression
called <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Numbers</span>
with a column <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>i</span>
which has a row for numbers 1-5:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:3.25pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=256
src="SQL%20Notes%20for%20Professionals_files/image404.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>i</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.3pt;
margin-left:.25pt'>1</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.3pt;
margin-left:.25pt'>2</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.3pt;
margin-left:.25pt'>3</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.3pt;
margin-left:.25pt'>4</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:15.05pt;
margin-left:.25pt'>5</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:18.55pt;
margin-left:.25pt'>This method can be used with any number interval, as well as
other types of data.</p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:0in;margin-left:-.25pt'><a
name="_Toc228705">Section 46.2: recursively enumerating a subtree</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:0in;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=720 height=339
src="SQL%20Notes%20for%20Professionals_files/image405.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:401.3pt;margin-bottom:
3.5pt;margin-left:.25pt;text-indent:0in;line-height:111%'><b>Level ID FName LName
1 </b>1 James Smith</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:28.45pt;text-indent:-28.2pt'><b><span style='line-height:110%'>2<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></b>2 John Johnson</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:28.45pt;text-indent:-28.2pt'><b><span style='line-height:110%'>3<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></b>4 Johnathon Smith</p>

<p class=MsoNormal style='margin-bottom:20.8pt;text-indent:0in'><b>2 </b>3
Michael Williams</p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228706">Section 46.3: Temporary query</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>These behave in the same manner as nested subqueries but
with a different syntax.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:3.25pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=142
src="SQL%20Notes%20for%20Professionals_files/image406.gif"></span></p>

<p class=MsoNormal style='margin-bottom:.95pt;text-indent:0in;line-height:111%'><b>ID Model TotalCost</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:12.95pt;text-indent:-12.7pt'><span style='line-height:110%'>1<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Ford
F-150 200</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:15.25pt;
margin-left:12.95pt;text-indent:-12.7pt'><span style='line-height:110%'>2<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Ford
F-150 230</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Equivalent subquery
syntax</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=125
src="SQL%20Notes%20for%20Professionals_files/image407.gif"></span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:0in;margin-left:-.25pt'><a
name="_Toc228707">Section 46.4: recursively going up in a tree</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:3.4pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=275
src="SQL%20Notes%20for%20Professionals_files/image408.gif"></span></p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'>4 Johnathon
Smith 1212121212 <b>2 </b>1</p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'><b>2 </b>John Johnson
2468101214 <b>1 </b>1</p>

<p class=MsoNormal style='text-indent:0in'><b>1 </b>James Smith 1234567890 NULL 1</p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:0in;margin-left:-.25pt'><a
name="_Toc228708">Section 46.5: Recursively generate dates, extended to include
team rostering as example</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:15.1pt;
margin-left:-.45pt;text-indent:0in;line-height:107%'><img border=0 width=719
height=454 id="Picture 218688"
src="SQL%20Notes%20for%20Professionals_files/image409.gif"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Result</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>I.e. For Week 1 TeamA is on R&amp;R, TeamB is on Day Shift
and TeamC is on Night Shift.</p>

<p class=MsoNormal style='margin-bottom:10.35pt;text-indent:0in;line-height:
107%'><img border=0 width=463 height=143 id="Picture 23285"
src="SQL%20Notes%20for%20Professionals_files/image410.jpg"></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228709">Section 46.6: Oracle CONNECT BY functionality with
recursive CTEs</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.25pt;
margin-left:.25pt'>Oracle's CONNECT BY functionality provides many useful and
nontrivial features that are not built-in when using SQL standard recursive
CTEs. This example replicates these features (with a few additions for sake of
completeness), using SQL Server syntax. It is most useful for Oracle developers
finding many features missing in their hierarchical queries on other databases,
but it also serves to showcase what can be done with a hierarchical query in
general.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:0in;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=91
src="SQL%20Notes%20for%20Professionals_files/image411.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:blue'>SELECT</span><span
style='font-size:9.0pt;line-height:110%'> 1 </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>AS</span><span style='font-size:9.0pt;line-height:
110%'> &quot;LEVEL&quot;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:green'>--, 1 AS CONNECT_BY_ISROOT</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:green'>--, 0 AS CONNECT_BY_ISBRANCH</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:gray'>,</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:blue'>CASE</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>WHEN</span><span style='font-size:9.0pt;
line-height:110%'> t</span><span style='font-size:9.0pt;line-height:110%;
color:gray'>.</span><span style='font-size:9.0pt;line-height:110%;color:#25256F'>id</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#333399'>IN</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:gray'>(</span><span style='font-size:9.0pt;line-height:110%;color:blue'>SELECT</span><span
style='font-size:9.0pt;line-height:110%'> parent_id </span><span
style='font-size:9.0pt;line-height:110%;color:blue'>FROM</span><span
style='font-size:9.0pt;line-height:110%'> tbl</span><span style='font-size:
9.0pt;line-height:110%;color:gray'>)</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:blue'>THEN</span><span style='font-size:9.0pt;line-height:110%'> 0 </span><span
style='font-size:9.0pt;line-height:110%;color:blue'>ELSE</span><span
style='font-size:9.0pt;line-height:110%'> 1 </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>END</span><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:blue'>AS</span><span
style='font-size:9.0pt;line-height:110%'> CONNECT_BY_ISLEAF</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:gray'>,</span><span style='font-size:9.0pt;line-height:110%'> 0 </span><span
style='font-size:9.0pt;line-height:110%;color:blue'>AS</span><span
style='font-size:9.0pt;line-height:110%'> CONNECT_BY_ISCYCLE</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:91.95pt;margin-bottom:
.15pt;margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:
110%;color:gray'>,</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:red'>'/'</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:gray'>+</span><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:blue'>CAST</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>(</span><span
style='font-size:9.0pt;line-height:110%'>t</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>.</span><span style='font-size:9.0pt;line-height:
110%;color:#25256F'>id</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:blue'>AS</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>VARCHAR</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>(</span><span style='font-size:9.0pt;line-height:
110%;color:fuchsia'>MAX</span><span style='font-size:9.0pt;line-height:110%;
color:gray'>))</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:gray'>+</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:red'>'/'</span><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:blue'>AS</span><span
style='font-size:9.0pt;line-height:110%'> SYS_CONNECT_BY_PATH_id </span><span
style='font-size:9.0pt;line-height:110%;color:gray'>,</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:red'>'/'</span><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:gray'>+</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>CAST</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>(</span><span style='font-size:9.0pt;line-height:
110%'>t</span><span style='font-size:9.0pt;line-height:110%;color:gray'>.</span><span
style='font-size:9.0pt;line-height:110%;color:#25256F'>name</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>AS</span><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:blue'>VARCHAR</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>(</span><span
style='font-size:9.0pt;line-height:110%;color:fuchsia'>MAX</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>))</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:gray'>+</span><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:red'>'/'</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>AS</span><span style='font-size:9.0pt;line-height:
110%'> SYS_CONNECT_BY_PATH_name</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:gray'>,</span><span style='font-size:9.0pt;line-height:110%'> t</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>.</span><span
style='font-size:9.0pt;line-height:110%;color:#25256F'>id</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>AS</span><span style='font-size:9.0pt;line-height:
110%'> root_id</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
margin-left:3.5pt;text-indent:-.5pt;line-height:107%'><span style='font-size:
9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
line-height:107%;color:gray'>,</span><span style='font-size:9.0pt;line-height:
107%'> t</span><span style='font-size:9.0pt;line-height:107%;color:gray'>.*</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:blue'>FROM</span><span
style='font-size:9.0pt;line-height:110%'> tbl t</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:blue'>WHERE</span><span
style='font-size:9.0pt;line-height:110%'> t</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>.</span><span style='font-size:9.0pt;line-height:
110%;color:#25256F'>parent_id</span><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:blue'>IS</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#333399'>NULL</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:
9.0pt;line-height:110%;color:green'>-- START WITH parent_id IS NULL</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:blue'>UNION</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#333399'>ALL</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:green'>/*
Recursive */</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:blue'>SELECT</span><span
style='font-size:9.0pt;line-height:110%'> th</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>.</span><span style='font-size:9.0pt;line-height:
110%'>&quot;LEVEL&quot; </span><span style='font-size:9.0pt;line-height:110%;
color:gray'>+</span><span style='font-size:9.0pt;line-height:110%'> 1 </span><span
style='font-size:9.0pt;line-height:110%;color:blue'>AS</span><span
style='font-size:9.0pt;line-height:110%'> &quot;LEVEL&quot;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:green'>--, 0 AS CONNECT_BY_ISROOT</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:green'>--, CASE WHEN t.id IN (SELECT parent_id FROM tbl) THEN 1 ELSE 0
END AS CONNECT_BY_ISBRANCH</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='position:relative;z-index:
-1895753728'><span style='left:0px;position:absolute;left:0px;top:-81163px;
width:718px;height:1px'><img width=718 height=1
src="SQL%20Notes%20for%20Professionals_files/image412.gif"></span></span><span
style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:gray'>,</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>CASE</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:blue'>WHEN</span><span style='font-size:9.0pt;line-height:110%'> t</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>.</span><span
style='font-size:9.0pt;line-height:110%;color:#25256F'>id</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#333399'>IN</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:gray'>(</span><span style='font-size:9.0pt;line-height:110%;color:blue'>SELECT</span><span
style='font-size:9.0pt;line-height:110%'> parent_id </span><span
style='font-size:9.0pt;line-height:110%;color:blue'>FROM</span><span
style='font-size:9.0pt;line-height:110%'> tbl</span><span style='font-size:
9.0pt;line-height:110%;color:gray'>)</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:blue'>THEN</span><span style='font-size:9.0pt;line-height:110%'> 0 </span><span
style='font-size:9.0pt;line-height:110%;color:blue'>ELSE</span><span
style='font-size:9.0pt;line-height:110%'> 1 </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>END</span><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:blue'>AS</span><span
style='font-size:9.0pt;line-height:110%'> CONNECT_BY_ISLEAF </span><span
style='font-size:9.0pt;line-height:110%;color:gray'>,</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>CASE</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:blue'>WHEN</span><span style='font-size:9.0pt;line-height:110%'> th</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>.</span><span
style='font-size:9.0pt;line-height:110%;color:#25256F'>SYS_CONNECT_BY_PATH_id</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#333399'>LIKE</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:red'>'%/'</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:gray'>+</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>CAST</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>(</span><span style='font-size:9.0pt;line-height:
110%'>t</span><span style='font-size:9.0pt;line-height:110%;color:gray'>.</span><span
style='font-size:9.0pt;line-height:110%;color:#25256F'>id</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>AS</span><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:blue'>VARCHAR</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>(</span><span
style='font-size:9.0pt;line-height:110%;color:fuchsia'>MAX</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>))</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:gray'>+</span><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:red'>'/%'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%;color:blue'>THEN</span><span style='font-size:9.0pt;line-height:110%'> 1 </span><span
style='font-size:9.0pt;line-height:110%;color:blue'>ELSE</span><span
style='font-size:9.0pt;line-height:110%'> 0 </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>END</span><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:blue'>AS</span><span
style='font-size:9.0pt;line-height:110%'> CONNECT_BY_ISCYCLE</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
margin-left:3.5pt;text-indent:-.5pt;line-height:107%'><span style='font-size:
9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
line-height:107%;color:gray'>,</span><span style='font-size:9.0pt;line-height:
107%'> th</span><span style='font-size:9.0pt;line-height:107%;color:gray'>.</span><span
style='font-size:9.0pt;line-height:107%;color:#25256F'>SYS_CONNECT_BY_PATH_id</span><span
style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
line-height:107%;color:gray'>+</span><span style='font-size:9.0pt;line-height:
107%'> </span><span style='font-size:9.0pt;line-height:107%;color:blue'>CAST</span><span
style='font-size:9.0pt;line-height:107%;color:gray'>(</span><span
style='font-size:9.0pt;line-height:107%'>t</span><span style='font-size:9.0pt;
line-height:107%;color:gray'>.</span><span style='font-size:9.0pt;line-height:
107%;color:#25256F'>id</span><span style='font-size:9.0pt;line-height:107%'> </span><span
style='font-size:9.0pt;line-height:107%;color:blue'>AS</span><span
style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
line-height:107%;color:blue'>VARCHAR</span><span style='font-size:9.0pt;
line-height:107%;color:gray'>(</span><span style='font-size:9.0pt;line-height:
107%;color:fuchsia'>MAX</span><span style='font-size:9.0pt;line-height:107%;
color:gray'>))</span><span style='font-size:9.0pt;line-height:107%'> </span><span
style='font-size:9.0pt;line-height:107%;color:gray'>+</span><span
style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
line-height:107%;color:red'>'/'</span><span style='font-size:9.0pt;line-height:
107%'> </span><span style='font-size:9.0pt;line-height:107%;color:blue'>AS</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'>SYS_CONNECT_BY_PATH_id</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
margin-left:3.5pt;text-indent:-.5pt;line-height:107%'><span style='font-size:
9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
line-height:107%;color:gray'>,</span><span style='font-size:9.0pt;line-height:
107%'> th</span><span style='font-size:9.0pt;line-height:107%;color:gray'>.</span><span
style='font-size:9.0pt;line-height:107%;color:#25256F'>SYS_CONNECT_BY_PATH_name</span><span
style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
line-height:107%;color:gray'>+</span><span style='font-size:9.0pt;line-height:
107%'> </span><span style='font-size:9.0pt;line-height:107%;color:blue'>CAST</span><span
style='font-size:9.0pt;line-height:107%;color:gray'>(</span><span
style='font-size:9.0pt;line-height:107%'>t</span><span style='font-size:9.0pt;
line-height:107%;color:gray'>.</span><span style='font-size:9.0pt;line-height:
107%;color:#25256F'>name</span><span style='font-size:9.0pt;line-height:107%'> </span><span
style='font-size:9.0pt;line-height:107%;color:blue'>AS</span><span
style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
line-height:107%;color:blue'>VARCHAR</span><span style='font-size:9.0pt;
line-height:107%;color:gray'>(</span><span style='font-size:9.0pt;line-height:
107%;color:fuchsia'>MAX</span><span style='font-size:9.0pt;line-height:107%;
color:gray'>))</span><span style='font-size:9.0pt;line-height:107%'> </span><span
style='font-size:9.0pt;line-height:107%;color:gray'>+</span><span
style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
line-height:107%;color:red'>'/'</span><span style='font-size:9.0pt;line-height:
107%'> </span><span style='font-size:9.0pt;line-height:107%;color:blue'>AS</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'>SYS_CONNECT_BY_PATH_name</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
margin-left:3.5pt;text-indent:-.5pt;line-height:107%'><span style='font-size:
9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
line-height:107%;color:gray'>,</span><span style='font-size:9.0pt;line-height:
107%'> th</span><span style='font-size:9.0pt;line-height:107%;color:gray'>.</span><span
style='font-size:9.0pt;line-height:107%;color:#25256F'>root_id</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
margin-left:3.5pt;text-indent:-.5pt;line-height:107%'><span style='font-size:
9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
line-height:107%;color:gray'>,</span><span style='font-size:9.0pt;line-height:
107%'> t</span><span style='font-size:9.0pt;line-height:107%;color:gray'>.*</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:blue'>FROM</span><span
style='font-size:9.0pt;line-height:110%'> tbl t</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:#333399'>JOIN</span><span style='font-size:9.0pt;line-height:110%'>
tbl_hierarchy th </span><span style='font-size:9.0pt;line-height:110%;
color:blue'>ON</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:gray'>(</span><span
style='font-size:9.0pt;line-height:110%'>th</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>.</span><span style='font-size:9.0pt;line-height:
110%;color:#25256F'>id</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:gray'>=</span><span
style='font-size:9.0pt;line-height:110%'> t</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>.</span><span style='font-size:9.0pt;line-height:
110%;color:#25256F'>parent_id</span><span style='font-size:9.0pt;line-height:
110%;color:gray'>)</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:green'>-- CONNECT BY PRIOR id =
parent_id</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
margin-left:3.5pt;text-indent:-.5pt;line-height:107%'><span style='font-size:
9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;line-height:
107%;color:blue'>WHERE</span><span style='font-size:9.0pt;line-height:107%'> th</span><span
style='font-size:9.0pt;line-height:107%;color:gray'>.</span><span
style='font-size:9.0pt;line-height:107%;color:#25256F'>CONNECT_BY_ISCYCLE</span><span
style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
line-height:107%;color:gray'>=</span><span style='font-size:9.0pt;line-height:
107%'> 0</span><span style='font-size:9.0pt;line-height:107%;color:gray'>)</span><span
style='font-size:9.0pt;line-height:107%'> </span><span
style='font-size:9.0pt;line-height:107%;color:green'>-- NOCYCLE</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%;color:blue'>SELECT</span><span style='font-size:9.0pt;line-height:110%'>
th</span><span style='font-size:9.0pt;line-height:110%;color:gray'>.*</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:green'>--,
REPLICATE(' ', (th.&quot;LEVEL&quot; - 1) * 3) + th.name AS tbl_hierarchy</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:blue'>FROM</span><span
style='font-size:9.0pt;line-height:110%'> tbl_hierarchy th</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:#333399'>JOIN</span><span
style='font-size:9.0pt;line-height:110%'> tbl CONNECT_BY_ROOT </span><span
style='font-size:9.0pt;line-height:110%;color:blue'>ON</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:gray'>(</span><span style='font-size:9.0pt;line-height:
110%'>CONNECT_BY_ROOT</span><span style='font-size:9.0pt;line-height:110%;
color:gray'>.</span><span style='font-size:9.0pt;line-height:110%;color:#25256F'>id</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:gray'>=</span><span style='font-size:9.0pt;line-height:
110%'> th</span><span style='font-size:9.0pt;line-height:110%;color:gray'>.</span><span
style='font-size:9.0pt;line-height:110%;color:#25256F'>root_id</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:23.75pt;margin-bottom:
11.9pt;margin-left:.25pt;text-indent:3.75pt;line-height:240%'><span
style='font-size:9.0pt;line-height:240%'></span><span style='font-size:9.0pt;
line-height:240%;color:blue'>ORDER</span><span style='font-size:9.0pt;
line-height:240%'> </span><span style='font-size:9.0pt;line-height:240%;
color:blue'>BY</span><span style='font-size:9.0pt;line-height:240%'> th</span><span
style='font-size:9.0pt;line-height:240%;color:gray'>.</span><span
style='font-size:9.0pt;line-height:240%;color:#25256F'>SYS_CONNECT_BY_PATH_name</span><span
style='font-size:9.0pt;line-height:240%;color:gray'>;</span><span
style='font-size:9.0pt;line-height:240%'> </span><span
style='font-size:9.0pt;line-height:240%;color:green'>-- ORDER SIBLINGS BY name </span>CONNECT
BY features demonstrated above, with explanations:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.6pt;
margin-left:60.0pt'>CONNECT BY: Specifies the relationship that defines the
hierarchy.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.6pt;
margin-left:60.0pt'>START WITH: Specifies the root nodes.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.6pt;
margin-left:60.0pt'>ORDER SIBLINGS BY: Orders results properly.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.6pt;
margin-left:30.0pt'><span style='position:relative;z-index:-1895752704'><span
style='left:0px;position:absolute;left:28px;top:-81606px;width:60px;height:
1px'><img width=60 height=1
src="SQL%20Notes%20for%20Professionals_files/image413.gif"></span></span>Parameters</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:16.3pt;
margin-left:60.0pt'>NOCYCLE: Stops processing a branch when a loop is detected.
Valid hierarchies are Directed Acyclic Graphs, and circular references violate
this construct.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.6pt;
margin-left:60.0pt'>PRIOR: Obtains data from the node's parent.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.6pt;
margin-left:60.0pt'>CONNECT_BY_ROOT: Obtains data from the node's root.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.6pt;
margin-left:30.0pt'><span style='position:relative;z-index:-1895751680'><span
style='left:0px;position:absolute;left:28px;top:-81730px;width:76px;height:
1px'><img width=76 height=1
src="SQL%20Notes%20for%20Professionals_files/image414.gif"></span></span>Pseudocolumns</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.6pt;
margin-left:60.0pt'>LEVEL: Indicates the node's distance from its root.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.6pt;
margin-left:60.0pt'>CONNECT_BY_ISLEAF: Indicates a node without children.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:16.65pt;
margin-left:60.0pt'>CONNECT_BY_ISCYCLE: Indicates a node with a circular
reference.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.25pt;
margin-left:60.0pt'>SYS_CONNECT_BY_PATH: Returns a flattened/concatenated
representation of the path to the node from its root.</p>

<h1 style='margin-left:-.25pt'><a name="_Toc228710">Chapter 47: Views</a></h1>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228711">Section 47.1: Simple views</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>A view can filter some rows from the base table or project
only some columns from it:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=76
src="SQL%20Notes%20for%20Professionals_files/image415.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>If you select form the view:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:3.25pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image416.gif"></span></p>

<p class=MsoNormal style='margin-bottom:.95pt;text-indent:0in;line-height:111%'><b>Id FName Salary
Hire_date</b></p>

<p class=MsoNormal style='margin-bottom:20.8pt;text-indent:0in'>4 Johnathon 500 24-07-2016</p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228712">Section 47.2: Complex views</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.25pt;
margin-left:.25pt'>A view can be a really complex query(aggregations, joins,
subqueries, etc). Just be sure you add column names for everything you select:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=92
src="SQL%20Notes%20for%20Professionals_files/image417.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:8.15pt;
margin-left:.25pt'>Now you can select from it as from any table:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:1.55pt;
margin-left:.5pt;text-indent:-.5pt'><span style='font-size:11.0pt;line-height:
110%'><img border=0 width=718 height=43
src="SQL%20Notes%20for%20Professionals_files/image418.gif"></span><span
style='font-size:9.0pt;line-height:110%;color:blue'>FROM</span><span
style='font-size:9.0pt;line-height:110%'> dept_income</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>DepartmentName
TotalSalary</b></p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'>HR 1900</p>

<p class=MsoNormal style='text-indent:0in'>Sales 600</p>

<h1 style='margin-left:-.25pt'><a name="_Toc228713">Chapter 48: Materialized
Views</a></h1>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:18.2pt;
margin-left:.25pt'>A materialized view is a view whose results are physically
stored and must be periodically refreshed in order to remain current. They are
therefore useful for storing the results of complex, long-running queries when
realtime results are not required. Materialized views can be created in Oracle
and PostgreSQL. Other database systems offer similar functionality, such as SQL
Server's indexed views or DB2's materialized query tables.</p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:0in;margin-left:-.25pt'><a
name="_Toc228714">Section 48.1: PostgreSQL example</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:0in;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=565
src="SQL%20Notes%20for%20Professionals_files/image419.gif"></span></p>

<h1 style='margin-left:-.25pt'><a name="_Toc228715">Chapter 49: Comments</a></h1>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228716">Section 49.1: Single-line comments</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Single line comments are preceded by <span style='font-size:
9.0pt;line-height:110%;background:#FAFAFA'>--</span>, and go until the end of
the line:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="SQL%20Notes%20for%20Professionals_files/image420.gif"></span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228717">Section 49.2: Multi-line comments</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Multi-line code comments are wrapped in <span
style='font-size:9.0pt;line-height:110%;color:green;background:#FAFAFA'>/* ...
*/</span>:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=76
src="SQL%20Notes%20for%20Professionals_files/image421.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>It is also possible to insert such a comment into the middle
of a line:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:0in;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src="SQL%20Notes%20for%20Professionals_files/image422.gif"></span><br
clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc228718">Chapter 50: Foreign Keys</a></h1>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228719">Section 50.1: Foreign Keys explained</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.45pt;
margin-left:.25pt'>Foreign Keys constraints ensure data integrity, by enforcing
that values in one table must match values in another table.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.25pt;
margin-left:.25pt'>An example of where a foreign key is required is: In a
university, a course must belong to a department. Code for the this scenario
is:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=76
src="SQL%20Notes%20for%20Professionals_files/image423.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Insert values with the following statement:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image424.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>The following table will contain the information of the
subjects offered by the Computer science branch:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=109
src="SQL%20Notes%20for%20Professionals_files/image425.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.9pt;
margin-left:.25pt'>(The data type of the Foreign Key must match the datatype of
the referenced key.)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:14.2pt;
margin-left:.25pt'>The Foreign Key constraint on the column <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Dept_Code</span>
allows values only if they already exist in the referenced table, <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Department</span>.
This means that if you try to insert the following values:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:26.95pt;margin-bottom:
17.4pt;margin-left:3.5pt;text-indent:-.5pt'><span style='position:relative;
z-index:-1895750656'><span style='left:0px;position:absolute;left:0px;
top:-84254px;width:718px;height:1px'><img width=718 height=1
src="SQL%20Notes%20for%20Professionals_files/image134.gif"></span></span><span
style='font-size:9.0pt;line-height:110%;color:blue'>INSERT</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>INTO</span><span style='font-size:9.0pt;
line-height:110%'> Programming_Courses </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>Values</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:gray'>(</span><span style='font-size:9.0pt;line-height:110%;color:red'>'CS300'</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>,</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:red'>'FDB-DB001'</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>,</span><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:red'>'Database
Systems'</span><span style='font-size:9.0pt;line-height:110%;color:gray'>);</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:14.1pt;
margin-left:.25pt'>the database will raise a Foreign Key violation error,
because <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>CS300</span>
does not exist in the <span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>Department</span> table. But when you try a key value that exists:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:26.95pt;margin-bottom:
.1pt;margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;
line-height:110%;color:blue'>INSERT</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:blue'>INTO</span><span style='font-size:9.0pt;line-height:110%'>
Programming_Courses </span><span style='font-size:9.0pt;line-height:110%;
color:blue'>VALUES</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:gray'>(</span><span
style='font-size:9.0pt;line-height:110%;color:red'>'CS205'</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>,</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:red'>'FDB-DB001'</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>,</span><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:red'>'Database
Systems'</span><span style='font-size:9.0pt;line-height:110%;color:gray'>);</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:54.3pt;margin-bottom:
.1pt;margin-left:0in;text-indent:3.75pt;line-height:240%'><span
style='position:relative;z-index:-1895749632'><span style='left:0px;position:
absolute;left:0px;top:-84369px;width:718px;height:1px'><img width=718 height=1
src="SQL%20Notes%20for%20Professionals_files/image193.gif"></span></span><span
style='font-size:9.0pt;line-height:240%;color:blue'>INSERT</span><span
style='font-size:9.0pt;line-height:240%'> </span><span style='font-size:9.0pt;
line-height:240%;color:blue'>INTO</span><span style='font-size:9.0pt;
line-height:240%'> Programming_Courses </span><span style='font-size:9.0pt;
line-height:240%;color:blue'>VALUES</span><span style='font-size:9.0pt;
line-height:240%'> </span><span style='font-size:9.0pt;line-height:240%;
color:gray'>(</span><span style='font-size:9.0pt;line-height:240%;color:red'>'CS205'</span><span
style='font-size:9.0pt;line-height:240%;color:gray'>,</span><span
style='font-size:9.0pt;line-height:240%'> </span><span style='font-size:9.0pt;
line-height:240%;color:red'>'DB2-DB002'</span><span style='font-size:9.0pt;
line-height:240%;color:gray'>,</span><span style='font-size:9.0pt;line-height:
240%'> </span><span style='font-size:9.0pt;line-height:240%;color:red'>'Database
Systems II'</span><span style='font-size:9.0pt;line-height:240%;color:gray'>); </span>then
the database allows these values.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.05pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>A few tips for using
Foreign Keys</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.6pt;
margin-left:20.9pt'><img width=5 height=1
src="SQL%20Notes%20for%20Professionals_files/image110.gif" align=left
hspace=12>A Foreign Key must reference a UNIQUE (or PRIMARY) key in the parent
table.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.6pt;
margin-left:20.9pt'>Entering a NULL value in a Foreign Key column does not
raise an error.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.6pt;
margin-left:20.9pt'>Foreign Key constraints can reference tables within the
same database.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:43.4pt;margin-bottom:
.2pt;margin-left:.25pt;text-indent:5.5pt;line-height:145%'>Foreign Key
constraints can refer to another column in the same table (self-reference).</p>

<h2 style='margin-top:0in;margin-right:43.4pt;margin-bottom:.2pt;margin-left:
.25pt;text-indent:5.5pt;line-height:145%'><a name="_Toc228720">Section 50.2:
Creating a table with a foreign key</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>In this example we have an existing table, <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>SuperHeros</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.85pt;
margin-left:.25pt'>This table contains a primary key <span style='font-size:
9.0pt;line-height:110%;background:#FAFAFA'>ID</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>We will add a new table in order to store the powers of each
super hero:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:15.45pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=109
src="SQL%20Notes%20for%20Professionals_files/image426.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>The column <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>HeroId</span> is a <b>foreign key</b> to the table <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>SuperHeros</span>.<br
clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc228721">Chapter 51: Sequence</a></h1>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:0in;margin-left:-.25pt'><a
name="_Toc228722">Section 51.1: Create Sequence</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="SQL%20Notes%20for%20Professionals_files/image427.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:123.1pt;margin-bottom:
.2pt;margin-left:.25pt;line-height:145%'>Creates a sequence with a starting
value of 1000 which is incremented by 1.</p>

<h2 style='margin-top:0in;margin-right:123.1pt;margin-bottom:.2pt;margin-left:
.25pt;text-indent:.5pt;line-height:145%'><a name="_Toc228723">Section 51.2:
Using Sequences</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.45pt;
margin-left:.25pt'>a reference to <i>seq_name</i>.NEXTVAL is used to get the
next value in a sequence. A single statement can only generate a single
sequence value. If there are multiple references to NEXTVAL in a statement,
they use will use the same generated number.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>NEXTVAL can be used for INSERTS</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src="SQL%20Notes%20for%20Professionals_files/image428.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>It can be used for UPDATES</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="SQL%20Notes%20for%20Professionals_files/image429.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>It can also be used for SELECTS</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:0in;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image430.gif"></span></p>

<h1 style='margin-left:-.25pt'><a name="_Toc228724">Chapter 52: Subqueries</a></h1>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228725">Section 52.1: Subquery in FROM clause</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.3pt;
margin-left:.25pt'>A subquery in a <span style='font-size:9.0pt;line-height:
110%;color:blue;background:#FAFAFA'>FROM</span> clause acts similarly to a
temporary table that is generated during the execution of a query and lost
afterwards.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=125
src="SQL%20Notes%20for%20Professionals_files/image431.gif"></span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:0in;margin-left:-.25pt'><a
name="_Toc228726">Section 52.2: Subquery in SELECT clause</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=109
src="SQL%20Notes%20for%20Professionals_files/image432.gif"></span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228727">Section 52.3: Subquery in WHERE clause</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.25pt;
margin-left:.25pt'>Use a subquery to filter the result set. For example this
will return all employees with a salary equal to the highest paid employee.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="SQL%20Notes%20for%20Professionals_files/image433.gif"></span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228728">Section 52.4: Correlated Subqueries</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.25pt;
margin-left:.25pt'>Correlated (also known as Synchronized or Coordinated)
Subqueries are nested queries that make references to the current row of their
outer query:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:15.1pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=125
src="SQL%20Notes%20for%20Professionals_files/image434.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=158 style='width:1.65in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=158 valign=top style='width:1.65in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:blue'>SELECT</span><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:fuchsia'>AVG</span><span style='font-size:9.0pt;line-height:107%;
  color:gray'>(</span><span style='font-size:9.0pt;line-height:107%'>Salary</span><span
  style='font-size:9.0pt;line-height:107%;color:gray'>)</span><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:gray'>...</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:18.7pt;
margin-left:.25pt'>Subquery is <i>correlated</i> because it refers to <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Employee</span> row
<span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>eOuter</span>
from its outer query.</p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228729">Section 52.5: Filter query results using query on
di&#57379;erent table</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>This query selects all employees not on the Supervisors
table.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:0in;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=30
src="SQL%20Notes%20for%20Professionals_files/image435.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=54
src="SQL%20Notes%20for%20Professionals_files/image436.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>The same results can be achieved using a LEFT JOIN.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=76
src="SQL%20Notes%20for%20Professionals_files/image437.gif"></span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228730">Section 52.6: Subqueries in FROM clause</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>You can use subqueries to define a temporary table and use
it in the FROM clause of an &quot;outer&quot; query.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src="SQL%20Notes%20for%20Professionals_files/image438.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>The above finds cities from the weather table whose daily
temperature variation is greater than 20. The result is:</p>

<p class=MsoNormal style='margin-bottom:.95pt;text-indent:0in;line-height:111%'><span
style='font-size:11.0pt;line-height:111%'> </span><b>city temp_var</b></p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'>ST LOUIS 21</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:.25pt'>LOS ANGELES 31</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:.25pt'>LOS ANGELES 23</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:.25pt'>LOS ANGELES 31</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:.25pt'>LOS ANGELES 27</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:.25pt'>LOS ANGELES 28</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:.25pt'>LOS ANGELES 28</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:15.05pt;
margin-left:.25pt'>LOS ANGELES 32</p>

<h2 style='margin-top:0in;margin-right:180.95pt;margin-bottom:0in;margin-left:
-.25pt;line-height:145%'><a name="_Toc228731"><span style='font-size:10.0pt;
line-height:145%;color:black;font-weight:normal'>. </span>Section 52.7:
Subqueries in WHERE clause</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.25pt;
margin-left:.25pt'>The following example finds cities (from the cities example)
whose population is below the average temperature (obtained via a sub-qquery):</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src="SQL%20Notes%20for%20Professionals_files/image439.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.45pt;
margin-left:.25pt'>Here: the subquery (SELECT avg(pop2000) FROM cities) is used
to specify conditions in the WHERE clause. The result is:</p>

<p class=MsoNormal style='margin-bottom:.95pt;text-indent:0in;line-height:111%'><span
style='font-size:11.0pt;line-height:111%'> </span><b>name pop2000</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:.25pt'>San Francisco 776733</p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'>ST LOUIS 348189</p>

<p class=MsoNormal style='text-indent:0in'>Kansas City 146866</p>

<h1 style='margin-left:-.25pt'><a name="_Toc228732">Chapter 53: Execution
blocks</a></h1>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:0in;margin-left:-.25pt'><a
name="_Toc228733">Section 53.1: Using BEGIN ... END</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:0in;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=76
src="SQL%20Notes%20for%20Professionals_files/image440.gif"></span><br
clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc228734">Chapter 54: Stored
Procedures</a></h1>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228735">Section 54.1: Create and call a stored procedure</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.25pt;
margin-left:.25pt'>Stored procedures can be created through a database
management GUI (<a href="https://msdn.microsoft.com/en-us/library/ms345415.aspx"><span
style='color:#F31D19'>SQL Server example</span></a>), or through a SQL
statement as follows:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=191
src="SQL%20Notes%20for%20Professionals_files/image441.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Calling the procedure:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:0in;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=158
src="SQL%20Notes%20for%20Professionals_files/image442.gif"></span></p>

<h1 style='margin-left:-.25pt'><a name="_Toc228736">Chapter 55: Triggers</a></h1>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228737">Section 55.1: CREATE TRIGGER</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.25pt;
margin-left:.25pt'>This example creates a trigger that inserts a record to a
second table (MyAudit) after a record is inserted into the table the trigger is
defined on (MyTable). Here the &quot;inserted&quot; table is a special table
used by Microsoft SQL Server to store affected rows during INSERT and UPDATE
statements; there is also a special &quot;deleted&quot; table that performs the
same function for DELETE statements.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=191
src="SQL%20Notes%20for%20Professionals_files/image443.gif"></span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:0in;margin-left:-.25pt'><a
name="_Toc228738">Section 55.2: Use Trigger to manage a &quot;Recycle Bin&quot;
for deleted items</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:0in;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=142
src="SQL%20Notes%20for%20Professionals_files/image444.gif"></span></p>

<h1 style='margin-left:-.25pt'><a name="_Toc228739">Chapter 56: Transactions</a></h1>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:0in;margin-left:-.25pt'><a
name="_Toc228740">Section 56.1: Simple Transaction</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=92
src="SQL%20Notes%20for%20Professionals_files/image445.gif"></span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228741">Section 56.2: Rollback Transaction</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>When something fails in your transaction code and you want
to undo it, you can rollback your transaction:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:0in;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=191
src="SQL%20Notes%20for%20Professionals_files/image446.gif"></span><br
clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc228742">Chapter 57: Table Design</a></h1>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228743">Section 57.1: Properties of a well designed table</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.25pt;
margin-left:.25pt'>A true relational database must go beyond throwing data into
a few tables and writing some SQL statements to pull that data out.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.45pt;
margin-left:.25pt'>At best a badly designed table structure will slow the
execution of queries and could make it impossible for the database to function
as intended.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.7pt;
margin-left:.25pt'>A database table should not be considered as just another
table; it has to follow a set of rules to be considered truly relational.
Academically it is referred to as a 'relation' to make the distinction.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.5pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>The five rules of a
relational table are:</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:2.1pt;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:110%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Each
value is <i>atomic</i>; the value in each field in each row must be a single
value.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:2.1pt;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:110%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Each
field contains values that are of the same data type.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:2.1pt;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:110%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Each
field heading has a unique name.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.8pt;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:110%'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Each
row in the table must have at least one value that makes it unique amongst the
other records in the table.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:13.05pt;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:110%'>5.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>The
order of the rows and columns has no significance.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>A table conforming to
the five rules:</b></p>

<p class=MsoNormal style='margin-bottom:.95pt;text-indent:0in;line-height:111%'><b>Id
Name DOB Manager</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:11.9pt;text-indent:-11.65pt'><span style='line-height:110%'>1<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Fred 11/02/1971
3</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:3.85pt;
margin-left:11.9pt;text-indent:-11.65pt'><span style='line-height:110%'>2<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Fred 11/02/1971
3</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.35pt;
margin-left:11.9pt;text-indent:-11.65pt'><span style='line-height:110%'>3<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Sue 08/07/1975
2</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.85pt;
margin-left:20.9pt'><img width=5 height=1
src="SQL%20Notes%20for%20Professionals_files/image110.gif" align=left
hspace=12>Rule 1: Each value is atomic. <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>Id</span>, <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>Name</span>, <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>DOB</span> and <span style='font-size:
9.0pt;line-height:110%;background:#FAFAFA'>Manager</span> only contain a single
value.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.45pt;
margin-left:20.9pt'>Rule 2: <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>Id</span> contains only integers, <span style='font-size:
9.0pt;line-height:110%;background:#FAFAFA'>Name</span> contains text (we could
add that it's text of four characters or less), <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>DOB </span>contains dates of a valid type
and <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Manager</span>
contains integers (we could add that corresponds to a Primary Key field in a
managers table).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.8pt;
margin-left:20.9pt'><img width=5 height=1
src="SQL%20Notes%20for%20Professionals_files/image110.gif" align=left
hspace=12>Rule 3: <span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>Id</span>, <span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>Name</span>, <span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>DOB</span> and <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>Manager</span> are unique heading names within the table.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.7pt;
margin-left:20.9pt'>Rule 4: The inclusion of the <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>Id</span> field ensures that each record
is distinct from any other record within the table.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>A badly designed table:</b></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=255
 style='width:191.25pt;margin-left:1.0pt;border-collapse:collapse'>
 <tr style='height:12.3pt'>
  <td width=58 valign=top style='width:43.55pt;padding:0in 0in 0in 0in;
  height:12.3pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><b>Id Name</b></p>
  </td>
  <td width=157 valign=top style='width:117.8pt;padding:0in 0in 0in 0in;
  height:12.3pt'>
  <p class=MsoNormal align=center style='margin-top:0in;margin-right:2.0pt;
  margin-bottom:0in;margin-left:0in;text-align:center;text-indent:0in;
  line-height:107%'><b>DOB</b></p>
  </td>
  <td width=40 valign=top style='width:29.9pt;padding:0in 0in 0in 0in;
  height:12.3pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><b>Name</b></p>
  </td>
 </tr>
 <tr style='height:15.4pt'>
  <td width=58 valign=top style='width:43.55pt;padding:0in 0in 0in 0in;
  height:15.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>1
  Fred</p>
  </td>
  <td width=157 valign=top style='width:117.8pt;padding:0in 0in 0in 0in;
  height:15.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>11/02/1971</p>
  </td>
  <td width=40 valign=top style='width:29.9pt;padding:0in 0in 0in 0in;
  height:15.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>3</p>
  </td>
 </tr>
 <tr style='height:13.65pt'>
  <td width=58 valign=top style='width:43.55pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>1
  Fred</p>
  </td>
  <td width=157 valign=top style='width:117.8pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>11/02/1971</p>
  </td>
  <td width=40 valign=top style='width:29.9pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>3</p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-bottom:12.15pt;text-indent:0in'>3 Sue Friday
the 18th July 1975 2, 1</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.6pt;
margin-left:20.9pt'><img width=5 height=1
src="SQL%20Notes%20for%20Professionals_files/image110.gif" align=left
hspace=12>Rule 1: The second name field contains two values - 2 and 1.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.6pt;
margin-left:20.9pt'>Rule 2: The DOB field contains dates and text.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.6pt;
margin-left:20.9pt'>Rule 3: There's two fields called 'name'.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:224.95pt;margin-bottom:
1.25pt;margin-left:20.9pt'>Rule 4: The first and second record are exactly the
same. Rule 5: This rule isn't broken.</p>

<h1 style='margin-left:-.25pt'><a name="_Toc228744">Chapter 58: Synonyms</a></h1>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:0in;margin-left:-.25pt'><a
name="_Toc228745">Section 58.1: Create Synonym</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:0in;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src="SQL%20Notes%20for%20Professionals_files/image447.gif"></span><br
clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc228746">Chapter 59: Information
Schema</a></h1>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228747">Section 59.1: Basic Information Schema Search</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>One of the most useful queries for end users of large
RDBMS's is a search of an information schema.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.45pt;
margin-left:.25pt'>Such a query allows users to rapidly find database tables
containing columns of interest, such as when attempting to relate data from 2
tables indirectly through a third table, without existing knowledge of which
tables may contain keys or other useful columns in common with the target
tables.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Using T-SQL for this example, a database's information
schema may be searched as follows:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="SQL%20Notes%20for%20Professionals_files/image448.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>The result contains a list of matching columns, their
tables' names, and other useful information.<br clear=all style='page-break-before:
always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc228748">Chapter 60: Order of
Execution</a></h1>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:0in;margin-left:-.25pt'><a
name="_Toc228749">Section 60.1: Logical Order of Query Processing in SQL</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=174
src="SQL%20Notes%20for%20Professionals_files/image449.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>The order in which a query is processed and description of
each section.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:13.3pt;
margin-left:.25pt'>VT stands for 'Virtual Table' and shows how various data is
produced as the query is processed</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:9.3pt;
margin-left:35.7pt;text-indent:-19.6pt'><span style='line-height:110%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>FROM: A Cartesian product (cross join) is performed between the
first two tables in the FROM clause, and as a result, virtual table VT1 is
generated.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:9.6pt;
margin-left:35.7pt;text-indent:-19.6pt'><span style='line-height:110%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>ON: The ON filter is applied to VT1. Only rows for which the is
TRUE are inserted to VT2.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:9.3pt;
margin-left:35.7pt;text-indent:-19.6pt'><span style='line-height:110%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>OUTER (join): If an OUTER JOIN is specified (as opposed to a
CROSS JOIN or an INNER JOIN), rows from the preserved table or tables for which
a match was not found are added to the rows from VT2 as outer rows, generating
VT3. If more than two tables appear in the FROM clause, steps 1 through 3 are
applied repeatedly between the result of the last join and the next table in
the FROM clause until all tables are processed.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:9.6pt;
margin-left:35.7pt;text-indent:-19.6pt'><span style='line-height:110%'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>WHERE: The WHERE filter is applied to VT3. Only rows for which
the is TRUE are inserted to VT4.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:9.3pt;
margin-left:35.7pt;text-indent:-19.6pt'><span style='line-height:110%'>5.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>GROUP BY: The rows from VT4 are arranged in groups based on the
column list specified in the GROUP BY clause. VT5 is generated.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:9.6pt;
margin-left:35.7pt;text-indent:-19.6pt'><span style='line-height:110%'>6.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>CUBE | ROLLUP: Supergroups (groups of groups) are added to the
rows from VT5, generating VT6.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:9.6pt;
margin-left:35.7pt;text-indent:-19.6pt'><span style='line-height:110%'>7.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>HAVING: The HAVING filter is applied to VT6. Only groups for
which the is TRUE are inserted to VT7.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:9.6pt;
margin-left:35.7pt;text-indent:-19.6pt'><span style='line-height:110%'>8.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>SELECT: The SELECT list is processed, generating VT8.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:9.6pt;
margin-left:35.7pt;text-indent:-19.6pt'><span style='line-height:110%'>9.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>DISTINCT: Duplicate rows are removed from VT8. VT9 is generated.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:9.3pt;
margin-left:35.7pt;text-indent:-19.6pt'><span style='line-height:110%'>10.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>ORDER
BY: The rows from VT9 are sorted according to the column list specified in the
ORDER BY clause. A cursor is generated (VC10).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.25pt;
margin-left:35.7pt;text-indent:-19.6pt'><span style='line-height:110%'>11.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>TOP:
The specified number or percentage of rows is selected from the beginning of
VC10. Table VT11 is generated and returned to the caller. LIMIT has the same
functionality as TOP in some SQL dialects such as Postgres and Netezza.</p>

<h1 style='margin-left:-.25pt'><a name="_Toc228750">Chapter 61: Clean Code in
SQL</a></h1>

<p class=MsoNormal style='margin-top:0in;margin-right:5.2pt;margin-bottom:.2pt;
margin-left:.25pt;line-height:145%'>How to write good, readable SQL queries,
and example of good practices.</p>

<h2 style='margin-top:0in;margin-right:5.2pt;margin-bottom:.2pt;margin-left:
.25pt;text-indent:.5pt;line-height:145%'><a name="_Toc228751">Section 61.1:
Formatting and Spelling of Keywords and Names</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.2pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Table/Column Names</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Two common ways of formatting table/column names are <a
href="https://en.wikipedia.org/wiki/Camel_case"><span style='font-size:9.0pt;
line-height:110%;color:#F31D19;background:#FAFAFA'>CamelCase</span></a> and <a
href="https://en.wikipedia.org/wiki/Snake_case"><span style='font-size:9.0pt;
line-height:110%;color:#F31D19;background:#FAFAFA'>snake_case</span></a>:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=119
src="SQL%20Notes%20for%20Professionals_files/image450.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.5pt;
margin-left:.25pt'>Names should describe what is stored in their object. This
implies that column names usually should be singular. Whether table names
should use singular or plural is a <a
href="http://stackoverflow.com/questions/338156/table-naming-dilemma-singular-vs-plural-names"><span
style='color:#F31D19'>heavily discussed</span></a> question, but in practice,
it is more common to use plural table names.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.7pt;
margin-left:.25pt'>Adding prefixes or suffixes like <span style='font-size:
9.0pt;line-height:110%;background:#FAFAFA'>tbl</span> or <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>col</span> reduces
readability, so avoid them. However, they are sometimes used to avoid conflicts
with SQL keywords, and often used with triggers and indexes (whose names are
usually not mentioned in queries).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.95pt;
margin-left:.25pt;text-indent:0in;line-height:111%'><b>Keywords</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:21.4pt;margin-bottom:
.2pt;margin-left:.25pt;line-height:145%'>SQL keywords are not case sensitive.
However, it is common practice to write them in upper case.</p>

<h2 style='margin-top:0in;margin-right:21.4pt;margin-bottom:.2pt;margin-left:
.25pt;text-indent:.5pt;line-height:145%'><a name="_Toc228752">Section 61.2:
Indenting</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:14.1pt;
margin-left:.25pt'>There is no widely accepted standard. What everyone agrees
on is that squeezing everything into a single line is bad:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='position:relative;z-index:
-1895744512'><span style='left:0px;position:absolute;left:0px;top:-91533px;
width:718px;height:1px'><img width=718 height=1
src="SQL%20Notes%20for%20Professionals_files/image193.gif"></span></span><span
style='font-size:9.0pt;line-height:110%;color:blue'>SELECT</span><span
style='font-size:9.0pt;line-height:110%'> d</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>.</span><span style='font-size:9.0pt;line-height:
110%;color:#25256F'>Name</span><span style='font-size:9.0pt;line-height:110%;
color:gray'>,</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:fuchsia'>COUNT</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>(*)</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>AS</span><span style='font-size:9.0pt;line-height:
110%'> Employees </span><span style='font-size:9.0pt;line-height:110%;
color:blue'>FROM</span><span style='font-size:9.0pt;line-height:110%'>
Departments </span><span style='font-size:9.0pt;line-height:110%;color:blue'>AS</span><span
style='font-size:9.0pt;line-height:110%'> d </span><span style='font-size:9.0pt;
line-height:110%;color:#333399'>JOIN</span><span style='font-size:9.0pt;
line-height:110%'> Employees </span><span style='font-size:9.0pt;line-height:
110%;color:blue'>AS</span><span style='font-size:9.0pt;line-height:110%'> e </span><span
style='font-size:9.0pt;line-height:110%;color:blue'>ON</span><span
style='font-size:9.0pt;line-height:110%'> d</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>.</span><span style='font-size:9.0pt;line-height:
110%;color:#25256F'>ID</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:gray'>=</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:17.25pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'>e</span><span style='font-size:9.0pt;line-height:110%;color:gray'>.</span><span
style='font-size:9.0pt;line-height:110%;color:#25256F'>DepartmentID</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>WHERE</span><span style='font-size:9.0pt;
line-height:110%'> d</span><span style='font-size:9.0pt;line-height:110%;
color:gray'>.</span><span style='font-size:9.0pt;line-height:110%;color:#25256F'>Name</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:gray'>!=</span><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:red'>'HR'</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>HAVING</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:fuchsia'>COUNT</span><span style='font-size:9.0pt;line-height:110%;
color:gray'>(*)</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:gray'>&gt;</span><span
style='font-size:9.0pt;line-height:110%'> 10 </span><span style='font-size:
9.0pt;line-height:110%;color:blue'>ORDER</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:blue'>BY</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:fuchsia'>COUNT</span><span
style='font-size:9.0pt;line-height:110%;color:gray'>(*)</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>DESC</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>At the minimum, put every clause into a new line, and split
lines if they would become too long otherwise:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=125
src="SQL%20Notes%20for%20Professionals_files/image451.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Sometimes, everything after the SQL keyword introducing a
clause is indented to the same column:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:0in;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=106
src="SQL%20Notes%20for%20Professionals_files/image452.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=21
src="SQL%20Notes%20for%20Professionals_files/image453.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>(This can also be done while aligning the SQL keywords
right.)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Another common style is to put important keywords on their
own lines:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=240
src="SQL%20Notes%20for%20Professionals_files/image454.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Vertically aligning multiple similar expressions improves
readability:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=92
src="SQL%20Notes%20for%20Professionals_files/image455.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=280 style='width:209.65pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=36 valign=top style='width:27.0pt;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>@&quot;</span><span style='font-size:9.0pt;
  line-height:107%;color:gray'>...</span></p>
  </td>
  <td width=49 valign=top style='width:37.1pt;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;background:#FAFAFA'>&quot;</span> in C#, </p>
  </td>
  <td width=65 valign=top style='width:48.6pt;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>&quot;&quot;&quot;</span><span style='font-size:9.0pt;
  line-height:107%;color:gray'>...</span><span style='font-size:9.0pt;
  line-height:107%'>&quot;&quot;&quot;</span></p>
  </td>
  <td width=86 valign=top style='width:64.55pt;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>in Python, or </p>
  </td>
  <td width=14 valign=top style='width:.15in;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>R&quot;</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:gray;background:#FAFAFA'>(</span></p>
  </td>
  <td width=22 valign=top style='width:16.2pt;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:gray'>...</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:4.75pt;margin-bottom:
.2pt;margin-left:.25pt;text-align:justify;text-justify:inter-ideograph;
line-height:135%'>Using multiple lines makes it harder to embed SQL commands
into other programming languages. However, many languages have a mechanism for
multi-line strings, e.g., <span style='font-size:9.0pt;line-height:135%;
color:gray;background:#FAFAFA'>)</span><span style='font-size:9.0pt;line-height:
135%;background:#FAFAFA'>&quot;</span> in C++.</p>

<h2 style='margin-top:0in;margin-right:4.75pt;margin-bottom:.2pt;margin-left:
.25pt;text-align:justify;text-justify:inter-ideograph;text-indent:.5pt;
line-height:135%'><a name="_Toc228753">Section 61.3: SELECT *</a></h2>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=50 style='width:37.8pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=50 valign=top style='width:37.8pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:blue'>SELECT</span><span style='font-size:9.0pt;
  line-height:107%'> </span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'><span style='font-size:9.0pt;line-height:110%;color:gray;
background:#FAFAFA'>*</span> returns all columns in the same order as they are
defined in the table.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=50 style='width:37.8pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=50 valign=top style='width:37.8pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:blue'>SELECT</span><span style='font-size:9.0pt;
  line-height:107%'> </span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.45pt;
margin-left:.25pt'>When using <span style='font-size:9.0pt;line-height:110%;
color:gray;background:#FAFAFA'>*</span>, the data returned by a query can
change whenever the table definition changes. This increases the risk that
different versions of your application or your database are incompatible with
each other.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>Furthermore, reading more columns than necessary can
increase the amount of disk and network I/O.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>So you should always explicitly specify the column(s) you
actually want to retrieve:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="SQL%20Notes%20for%20Professionals_files/image456.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>(When doing interactive queries, these considerations do not
apply.)</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=50 style='width:37.8pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=50 valign=top style='width:37.8pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:blue'>SELECT</span><span style='font-size:9.0pt;
  line-height:107%'> </span></p>
  </td>
 </tr>
</table>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=50 style='width:37.8pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=50 valign=top style='width:37.8pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:blue'>SELECT</span><span style='font-size:9.0pt;
  line-height:107%'> </span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.3pt;
margin-left:.25pt'>However, <span style='font-size:9.0pt;line-height:110%;
color:gray;background:#FAFAFA'>*</span> does not hurt in the subquery of an
EXISTS operator, because EXISTS ignores the actual data anyway (it checks only
if at least one row has been found). For the same reason, it is not meaningful
to list any specific column(s) for EXISTS, so <span style='font-size:9.0pt;
line-height:110%;color:gray;background:#FAFAFA'>*</span> actually makes more
sense:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:0in;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=83
src="SQL%20Notes%20for%20Professionals_files/image457.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=71
src="SQL%20Notes%20for%20Professionals_files/image458.gif"></span></p>

<h2 style='margin-top:0in;margin-right:.3pt;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc228754">Section 61.4: Joins</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:13.3pt;
margin-left:.25pt'>Explicit joins should always be used; implicit joins have
several problems:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.25pt;
margin-left:30.0pt;text-indent:-9.1pt'><span style='font-size:11.0pt;
line-height:110%'><img border=0 width=5 height=5 id="Group 198295"
src="SQL%20Notes%20for%20Professionals_files/image459.gif"></span>The join
condition is somewhere in the WHERE clause, mixed up with any other filter
conditions. This makes it harder to see which tables are joined, and how.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:20.9pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=693 height=286
src="SQL%20Notes%20for%20Professionals_files/image460.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.6pt;
margin-left:30.0pt'>(This requires that both tables use the same column name.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.55pt;
margin-left:30.0pt'>USING automatically removes the duplicate column from the
result, e.g., the join in this query returns a single <span style='font-size:
9.0pt;line-height:110%;background:#FAFAFA'>RecipeID</span> column.)</p>

<h1 style='margin-left:-.25pt'><a name="_Toc228755">Chapter 62: SQL Injection</a></h1>

<p class=MsoNormal style='margin-top:0in;margin-right:.55pt;margin-bottom:.2pt;
margin-left:.25pt;text-align:justify;text-justify:inter-ideograph;line-height:
135%'>SQL injection is an attempt to access a website's database tables by
injecting SQL into a form field. If a web server does not protect against SQL
injection attacks, a hacker can trick the database into running the additional
SQL code. By executing their own SQL code, hackers can upgrade their account
access, view someone else's private information, or make any other
modifications to the database.</p>

<h2 style='margin-top:0in;margin-right:.55pt;margin-bottom:.2pt;margin-left:
.25pt;text-align:justify;text-justify:inter-ideograph;text-indent:.5pt;
line-height:135%'><a name="_Toc228756">Section 62.1: SQL injection sample</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>Assuming the call to your web application's login handler
looks like this:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image461.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:14.45pt;
margin-left:.25pt'>Now in login.ashx, you read these values:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:162.05pt;margin-bottom:
4.7pt;margin-left:0in;text-align:justify;text-justify:inter-ideograph;
text-indent:3.75pt;line-height:176%'><span style='position:relative;z-index:
-1895743488'><span style='left:0px;position:absolute;left:0px;top:-93732px;
width:718px;height:1px'><img width=718 height=1
src="SQL%20Notes%20for%20Professionals_files/image193.gif"></span></span><span
style='font-size:9.0pt;line-height:176%'>strUserName </span><span
style='font-size:9.0pt;line-height:176%;color:gray'>=</span><span
style='font-size:9.0pt;line-height:176%'> getHttpsRequestParameterString</span><span
style='font-size:9.0pt;line-height:176%;color:gray'>(</span><span
style='font-size:9.0pt;line-height:176%'>&quot;username&quot;</span><span
style='font-size:9.0pt;line-height:176%;color:gray'>); </span><span
style='font-size:9.0pt;line-height:176%'>strPassword </span><span
style='font-size:9.0pt;line-height:176%;color:gray'>=</span><span
style='font-size:9.0pt;line-height:176%'> getHttpsRequestParameterString</span><span
style='font-size:9.0pt;line-height:176%;color:gray'>(</span><span
style='font-size:9.0pt;line-height:176%'>&quot;password&quot;</span><span
style='font-size:9.0pt;line-height:176%;color:gray'>); </span>and query your
database to determine whether a user with that password exists.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>So you construct an SQL query string:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=720 height=43
src="SQL%20Notes%20for%20Professionals_files/image462.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>This will work if the username and password do not contain a
quote.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:14.45pt;
margin-left:.25pt'>However, if one of the parameters does contain a quote, the
SQL that gets sent to the database will look like this:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%;color:green'>-- strUserName = &quot;d'Alambert&quot;;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:17.3pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='position:relative;z-index:
-1895742464'><span style='left:0px;position:absolute;left:0px;top:-94002px;
width:718px;height:1px'><img width=718 height=1
src="SQL%20Notes%20for%20Professionals_files/image193.gif"></span></span><span
style='font-size:9.0pt;line-height:110%'>txtSQL </span><span style='font-size:
9.0pt;line-height:110%;color:gray'>=</span><span style='font-size:9.0pt;
line-height:110%'> &quot;</span><span style='font-size:9.0pt;line-height:110%;
color:blue'>SELECT</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:gray'>*</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>FROM</span><span style='font-size:9.0pt;
line-height:110%'> Users </span><span style='font-size:9.0pt;line-height:110%;
color:blue'>WHERE</span><span style='font-size:9.0pt;line-height:110%'>
username </span><span style='font-size:9.0pt;line-height:110%;color:gray'>=</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:red'>'d'</span><span style='font-size:9.0pt;line-height:
110%'>Alambert</span><span style='font-size:9.0pt;line-height:110%;color:red'>'
AND password = '</span><span style='font-size:9.0pt;line-height:110%'>123</span><span
style='font-size:9.0pt;line-height:110%;color:red'>'&quot;;</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=65 style='width:48.6pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=65 valign=top style='width:48.6pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:red'>'Alambert</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>This will result in a syntax error, because the quote after
the <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>d</span>
in <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>d</span>
ends the SQL string.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>You could correct this by escaping quotes in username and
password, e.g.:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src="SQL%20Notes%20for%20Professionals_files/image463.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>However, it's more appropriate to use parameters:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=76
src="SQL%20Notes%20for%20Professionals_files/image464.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:25.5pt;margin-bottom:
.2pt;margin-left:.25pt;line-height:169%'>If you do not use parameters, and
forget to replace quote in even one of the values, then a malicious user (aka
hacker) can use this to execute SQL commands on your database. For example, if
an attacker is evil, he/she will set the password to</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="SQL%20Notes%20for%20Professionals_files/image465.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>and then the SQL will look like this:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:17.25pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='position:relative;z-index:
-1895741440'><span style='left:0px;position:absolute;left:0px;top:-94405px;
width:718px;height:1px'><img width=718 height=1
src="SQL%20Notes%20for%20Professionals_files/image134.gif"></span></span><span
style='font-size:9.0pt;line-height:110%'>&quot;</span><span style='font-size:
9.0pt;line-height:110%;color:blue'>SELECT</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:gray'>*</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:blue'>FROM</span><span
style='font-size:9.0pt;line-height:110%'> Users </span><span style='font-size:
9.0pt;line-height:110%;color:blue'>WHERE</span><span style='font-size:9.0pt;
line-height:110%'> username </span><span style='font-size:9.0pt;line-height:
110%;color:gray'>=</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:red'>'somebody'</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#333399'>AND</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:blue'>password</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:gray'>=</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:red'>'lol'</span><span style='font-size:9.0pt;
line-height:110%;color:gray'>;</span><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:blue'>DROP</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:blue'>DATABASE</span><span style='font-size:9.0pt;
line-height:110%'> master</span><span style='font-size:9.0pt;line-height:110%;
color:gray'>;</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:green'>--'&quot;;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>Unfortunately for you, this is valid SQL, and the DB will
execute this!</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.8pt;
margin-left:.25pt'>This type of exploit is called an SQL injection.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.45pt;
margin-left:.25pt'>There are many other things a malicious user could do, such
as stealing every user's email address, steal everyone's password, steal credit
card numbers, steal any amount of data in your database, etc.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:1.6pt;
margin-left:.25pt'>This is why you always need to escape your strings.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.55pt;margin-bottom:.2pt;
margin-left:.25pt;text-align:justify;text-justify:inter-ideograph;line-height:
135%'>And the fact that you'll invariably forget to do so sooner or later is
exactly why you should use parameters. Because if you use parameters, then your
programming language framework will do any necessary escaping for you.</p>

<h2 style='margin-top:0in;margin-right:.55pt;margin-bottom:.2pt;margin-left:
.25pt;text-align:justify;text-justify:inter-ideograph;text-indent:.5pt;
line-height:135%'><a name="_Toc228757">Section 62.2: simple injection sample</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>If the SQL statement is constructed like this:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src="SQL%20Notes%20for%20Professionals_files/image466.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=86 style='width:.9in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>pw</span><span style='font-size:9.0pt;line-height:
  107%;color:red'>' or '</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;background:#FAFAFA'>1</span></p>
  </td>
  <td width=22 valign=top style='width:16.2pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:red'>'='</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:14.1pt;
margin-left:.25pt'>Then a hacker could retrieve your data by giving a password
like <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>1</span>;
the resulting SQL statement will be:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:17.35pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='position:relative;z-index:
-1895740416'><span style='left:0px;position:absolute;left:0px;top:-94805px;
width:718px;height:1px'><img width=718 height=1
src="SQL%20Notes%20for%20Professionals_files/image134.gif"></span></span><span
style='font-size:9.0pt;line-height:110%;color:blue'>SELECT</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:gray'>*</span><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:blue'>FROM</span><span
style='font-size:9.0pt;line-height:110%'> Users </span><span style='font-size:
9.0pt;line-height:110%;color:blue'>WHERE</span><span style='font-size:9.0pt;
line-height:110%'> username </span><span style='font-size:9.0pt;line-height:
110%;color:gray'>=</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:red'>'somebody'</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#333399'>AND</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:blue'>password</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:gray'>=</span><span
style='font-size:9.0pt;line-height:110%;color:red'>'pw'</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#333399'>or</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:red'>'1'</span><span style='font-size:9.0pt;line-height:110%;color:gray'>=</span><span
style='font-size:9.0pt;line-height:110%;color:red'>'1'</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=50 style='width:37.8pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=22 valign=top style='width:16.2pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:red'>'1'</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:gray;background:#FAFAFA'>=</span></p>
  </td>
  <td width=22 valign=top style='width:16.2pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:red'>'1'</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:12.85pt;
margin-left:.25pt'>This one will pass the password check for all rows in the <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Users</span> table
because is always true.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.2pt;
margin-left:.25pt'>To prevent this, use SQL parameters:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.1pt;margin-bottom:0in;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src="SQL%20Notes%20for%20Professionals_files/image467.gif"></span></p>

<h1 style='margin-left:-.25pt'><a name="_Toc228758">Credits</a></h1>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:12.05pt;
margin-bottom:.2pt;margin-left:12.65pt;text-align:center;text-indent:-.5pt;
line-height:123%'>Thank you greatly to all the people from Stack Overflow
Documentation who helped provide this content, more changes can be sent to <u><span
style='color:#F31D19'>web@petercv.com</span></u> for new content to be
published or updated</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=612
 style='width:459.1pt;margin-left:1.0pt;border-collapse:collapse'>
 <tr style='height:12.55pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:12.55pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1934778/"><span style='color:#F31D19'>zgr
  ztrk</span></a></p>
  </td>
  <td width=442 valign=top style='width:331.6pt;padding:0in 0in 0in 0in;
  height:12.55pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapters
  8 and 17</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/5669294/"><span style='color:#F31D19'>3N1GM4</span></a></p>
  </td>
  <td width=442 valign=top style='width:331.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  7</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/232403/"><span style='color:#F31D19'>a1ex07</span></a></p>
  </td>
  <td width=442 valign=top style='width:331.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  37</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/226897/"><span style='color:#F31D19'>Abe
  Miessler</span></a></p>
  </td>
  <td width=442 valign=top style='width:331.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  7</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/6158629/"><span style='color:#F31D19'>Abhilash
  R Vankayala</span></a></p>
  </td>
  <td width=442 valign=top style='width:331.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapters
  5, 6, 11, 27, 30 and 32</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1801382/"><span style='color:#F31D19'>aholmes</span></a></p>
  </td>
  <td width=442 valign=top style='width:331.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  6</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1980414/"><span style='color:#F31D19'>Aidan</span></a></p>
  </td>
  <td width=442 valign=top style='width:331.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapters
  21 and 25</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1618292/"><span style='color:#F31D19'>alex9311</span></a></p>
  </td>
  <td width=442 valign=top style='width:331.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  21</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/5165961/"><span style='color:#F31D19'>Almir
  Vuk</span></a></p>
  </td>
  <td width=442 valign=top style='width:331.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapters
  21 and 37</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/3955698/"><span style='color:#F31D19'>Alok
  Singh</span></a></p>
  </td>
  <td width=442 valign=top style='width:331.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  6</p>
  </td>
 </tr>
 <tr style='height:14.55pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.55pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/2609817/"><span style='color:#F31D19'>Ameya
  Deshpande</span></a></p>
  </td>
  <td width=442 valign=top style='width:331.6pt;padding:0in 0in 0in 0in;
  height:14.55pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  26</p>
  </td>
 </tr>
 <tr style='height:26.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:26.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/4201765/"><span style='color:#F31D19'>Amir
  Pourmand </span></a><a href="https://stackoverflow.com/users/4201765/"><span
  lang=AR-SA dir=RTL style='line-height:107%;font-family:"Arial",sans-serif;
  color:#F31D19'>&#1575; </span></a><a
  href="https://stackoverflow.com/users/4201765/"><span lang=AR-SA dir=RTL
  style='line-height:107%;font-family:"Arial",sans-serif;color:#F31D19'>&#1605;</span></a><a
  href="https://stackoverflow.com/users/4201765/"><span lang=AR-SA dir=RTL
  style='line-height:107%;font-family:"Arial",sans-serif;color:#F31D19'>&#1740;</span></a><a
  href="https://stackoverflow.com/users/4201765/"><span lang=AR-SA dir=RTL
  style='line-height:107%;font-family:"Arial",sans-serif;color:#F31D19'>&#1585;</span></a><a
  href="https://stackoverflow.com/users/4201765/"><span lang=AR-SA dir=RTL
  style='line-height:107%;font-family:"Arial",sans-serif;color:#F31D19'>&#1662;</span></a><a
  href="https://stackoverflow.com/users/4201765/"><span lang=AR-SA dir=RTL
  style='line-height:107%;font-family:"Arial",sans-serif;color:#F31D19'>&#1608;</span></a><a
  href="https://stackoverflow.com/users/4201765/"><span lang=AR-SA dir=RTL
  style='line-height:107%;font-family:"Arial",sans-serif;color:#F31D19'>&#1585;</span></a><a
  href="https://stackoverflow.com/users/4201765/"><span lang=AR-SA dir=RTL
  style='line-height:107%;font-family:"Arial",sans-serif;color:#F31D19'>&#1605;</span></a><a
  href="https://stackoverflow.com/users/4201765/"><span lang=AR-SA dir=RTL
  style='line-height:107%;font-family:"Arial",sans-serif;color:#F31D19'>&#1606;</span></a><a
  href="https://stackoverflow.com/users/4201765/"><span lang=AR-SA dir=RTL
  style='line-height:107%;font-family:"Arial",sans-serif;color:#F31D19'>&#1583;</span></a></p>
  </td>
  <td width=442 style='width:331.6pt;padding:0in 0in 0in 0in;height:26.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  56</p>
  </td>
 </tr>
 <tr style='height:14.55pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.55pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1860089/"><span style='color:#F31D19'>Amnon</span></a></p>
  </td>
  <td width=442 valign=top style='width:331.6pt;padding:0in 0in 0in 0in;
  height:14.55pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  6</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/909742/"><span style='color:#F31D19'>Andrea</span></a></p>
  </td>
  <td width=442 valign=top style='width:331.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  24</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/3319687/"><span style='color:#F31D19'>Andrea
  Montanari</span></a></p>
  </td>
  <td width=442 valign=top style='width:331.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  36</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/5221149/"><span style='color:#F31D19'>Andreas</span></a></p>
  </td>
  <td width=442 valign=top style='width:331.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  2</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/620444/"><span style='color:#F31D19'>Andy
  G</span></a></p>
  </td>
  <td width=442 valign=top style='width:331.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  18</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1000827/"><span style='color:#F31D19'>apomene</span></a></p>
  </td>
  <td width=442 valign=top style='width:331.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  6</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/2887760/"><span style='color:#F31D19'>Ares</span></a></p>
  </td>
  <td width=442 valign=top style='width:331.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  21</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/151758/"><span style='color:#F31D19'>Arkh</span></a></p>
  </td>
  <td width=442 valign=top style='width:331.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  45</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/5250746/"><span style='color:#F31D19'>Arpit
  Solanki</span></a></p>
  </td>
  <td width=442 valign=top style='width:331.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  6</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/6220816/"><span style='color:#F31D19'>Arthur
  D</span></a></p>
  </td>
  <td width=442 valign=top style='width:331.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  41</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/2451726/"><span style='color:#F31D19'>Arulkumar</span></a></p>
  </td>
  <td width=442 valign=top style='width:331.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapters
  13 and 41</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/3522593/"><span style='color:#F31D19'>ashja99</span></a></p>
  </td>
  <td width=442 valign=top style='width:331.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapters
  11 and 42</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/2279200/"><span style='color:#F31D19'>Athafoud</span></a></p>
  </td>
  <td width=442 valign=top style='width:331.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  24</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/5829848/"><span style='color:#F31D19'>Ayaz
  Shah</span></a></p>
  </td>
  <td width=442 valign=top style='width:331.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  11</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/5050431/"><span style='color:#F31D19'>A_Arnold</span></a></p>
  </td>
  <td width=442 valign=top style='width:331.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  18</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/2811537/"><span style='color:#F31D19'>Bart
  Schuijt</span></a></p>
  </td>
  <td width=442 valign=top style='width:331.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  11</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1029516/"><span style='color:#F31D19'>Batsu</span></a></p>
  </td>
  <td width=442 valign=top style='width:331.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  41</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/215452/"><span style='color:#F31D19'>bhs</span></a></p>
  </td>
  <td width=442 valign=top style='width:331.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  45</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/70157/"><span style='color:#F31D19'>bignose</span></a></p>
  </td>
  <td width=442 valign=top style='width:331.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  5</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1386551/"><span style='color:#F31D19'>blackbishop</span></a></p>
  </td>
  <td width=442 valign=top style='width:331.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  25</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/5546267/"><span style='color:#F31D19'>Blag</span></a></p>
  </td>
  <td width=442 valign=top style='width:331.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  17</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/648119/"><span style='color:#F31D19'>Bostjan</span></a></p>
  </td>
  <td width=442 valign=top style='width:331.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapters
  5, 7 and 13</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/533120/"><span style='color:#F31D19'>Branko
  Dimitrijevic</span></a></p>
  </td>
  <td width=442 valign=top style='width:331.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  18</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/5116096/"><span style='color:#F31D19'>Brent
  Oliver</span></a></p>
  </td>
  <td width=442 valign=top style='width:331.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  6</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/957950/"><span style='color:#F31D19'>brichins</span></a></p>
  </td>
  <td width=442 valign=top style='width:331.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  54</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/5095669/"><span style='color:#F31D19'>carlosb</span></a></p>
  </td>
  <td width=442 valign=top style='width:331.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapters
  37 and 39</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/536950/"><span style='color:#F31D19'>Chris</span></a></p>
  </td>
  <td width=442 valign=top style='width:331.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  6</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/112670/"><span style='color:#F31D19'>Christian</span></a></p>
  </td>
  <td width=442 valign=top style='width:331.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  5</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/6619524/"><span style='color:#F31D19'>Christian
  Sagmller</span></a></p>
  </td>
  <td width=442 valign=top style='width:331.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  6</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/913124/"><span style='color:#F31D19'>Christos</span></a></p>
  </td>
  <td width=442 valign=top style='width:331.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  6</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/11654/"><span style='color:#F31D19'>CL.</span></a></p>
  </td>
  <td width=442 valign=top style='width:331.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>Chapters 1, 2, 6, 8, 10,
  14, 18, 19, 21, 31, 36, 37, 41, 42, 46, 49, 61 and 62</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/2404889/"><span style='color:#F31D19'>Cristian
  Abelleira</span></a></p>
  </td>
  <td width=442 valign=top style='width:331.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  30</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1841839/"><span style='color:#F31D19'>DaImTo</span></a></p>
  </td>
  <td width=442 valign=top style='width:331.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  30</p>
  </td>
 </tr>
 <tr style='height:12.55pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:12.55pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/2444386/"><span style='color:#F31D19'>Daniel</span></a></p>
  </td>
  <td width=442 valign=top style='width:331.6pt;padding:0in 0in 0in 0in;
  height:12.55pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  46</p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:275.6pt;margin-bottom:
0in;margin-left:-28.35pt;text-indent:0in;line-height:107%'>&nbsp;</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=349
 style='width:261.9pt;margin-left:1.0pt;border-collapse:collapse'>
 <tr style='height:12.55pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:12.55pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/2612068/"><span style='color:#F31D19'>Daniel
  Langemann</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:12.55pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapters
  18 and 24</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/2036808/"><span style='color:#F31D19'>dariru</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  6</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1961634/"><span style='color:#F31D19'>Dariusz</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapters
  10 and 19</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/307968/"><span style='color:#F31D19'>Darrel
  Lee</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  40</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/4677305/"><span style='color:#F31D19'>Darren
  Bartrup</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapters
  18 and 57</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/204285/"><span style='color:#F31D19'>Daryl</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapters
  6, 55, 56 and 58</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/335858/"><span style='color:#F31D19'>dasblinkenlight</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  52</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1132642/"><span style='color:#F31D19'>David
  Manheim</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  37</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/2410379/"><span style='color:#F31D19'>David
  Pine</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  6</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/114292/"><span style='color:#F31D19'>David
  Spillett</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  6</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/5319981/"><span style='color:#F31D19'>day_dreamer</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  6</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/6101163/"><span style='color:#F31D19'>dd4711</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  46</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/7259926/"><span style='color:#F31D19'>dmfay</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  48</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1759015/"><span style='color:#F31D19'>Durgpal
  Singh</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  6</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/2297366/"><span style='color:#F31D19'>Dylan
  Vander Berg</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapters
  21 and 29</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/5410879/"><span style='color:#F31D19'>Emil
  Rowland</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  20</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/4915654/"><span style='color:#F31D19'>Eric
  VB</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  6</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/319875/"><span style='color:#F31D19'>Florin
  Ghita</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>Chapters 5, 18, 25, 42 and
  47</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/4250629/"><span style='color:#F31D19'>FlyingPiMonster</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapters
  5, 6, 19, 36 and 37</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/592182/"><span style='color:#F31D19'>forsvarir</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapters
  5 and 18</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/395857/"><span style='color:#F31D19'>Franck
  Dernoncourt</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapters
  6, 18 and 41</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1191259/"><span style='color:#F31D19'>Frank</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  7</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1657427/"><span style='color:#F31D19'>fuzzy_logic</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  46</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/3494243/"><span style='color:#F31D19'>Gallus</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  60</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/3212574/"><span style='color:#F31D19'>geeksal</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  1</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1709629/"><span style='color:#F31D19'>Gidil</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  45</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/5860431/"><span style='color:#F31D19'>Golden
  Gate</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  41</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/3845436/"><span style='color:#F31D19'>guiguiblitz</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  9</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/4551041/"><span style='color:#F31D19'>H.
  Pauwelyn</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  21</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/3604745/"><span style='color:#F31D19'>Hack</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  59</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1495703/"><span style='color:#F31D19'>Harish
  Gyanani</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  11</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/7003682/"><span style='color:#F31D19'>Harjot</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  50</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/834261/"><span style='color:#F31D19'>hatchet</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  41</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/4645236/"><span style='color:#F31D19'>hellyale</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  11</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/504958/"><span style='color:#F31D19'>HK1</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  18</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/9034/"><span style='color:#F31D19'>HLGEM</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  18</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/2076049/"><span style='color:#F31D19'>HoangHieu</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  6</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/3564751/"><span style='color:#F31D19'>Horaciux</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  37</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/6518147/"><span style='color:#F31D19'>Hynek
  Bernard</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  30</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/2308473/"><span style='color:#F31D19'>Ian
  Kenney</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  42</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/3739391/"><span style='color:#F31D19'>iliketocode</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  6</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/2723943/"><span style='color:#F31D19'>Imran
  Ali Khan</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapters
  6, 41 and 42</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/485534/"><span style='color:#F31D19'>Inca</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  6</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/829407/"><span style='color:#F31D19'>IncrediApp</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  55</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/3872894/"><span style='color:#F31D19'>Jared
  Hooper</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  6</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/4154421/"><span style='color:#F31D19'>Jason
  W</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  24</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/3059893/"><span style='color:#F31D19'>JavaHopper</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  5</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/4964923/"><span style='color:#F31D19'>Jaydip
  Jadhav</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  41</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/347414/"><span style='color:#F31D19'>Jaydles</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapters
  6, 7, 8 and 10</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/5907809/"><span style='color:#F31D19'>Jenism</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  37</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/2193968/"><span style='color:#F31D19'>Jerry
  Jeremiah</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  45</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/6450450/"><span style='color:#F31D19'>Jim</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  24</p>
  </td>
 </tr>
 <tr style='height:12.55pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:12.55pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/2577734/"><span style='color:#F31D19'>Joe
  Taras</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:12.55pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  24</p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:127.85pt;margin-bottom:
0in;margin-left:-28.35pt;text-indent:0in;line-height:107%'>&nbsp;</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=546
 style='width:409.65pt;margin-left:1.0pt;border-collapse:collapse'>
 <tr style='height:12.55pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:12.55pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/4096670/"><span style='color:#F31D19'>Joel</span></a></p>
  </td>
  <td width=376 valign=top style='width:282.15pt;padding:0in 0in 0in 0in;
  height:12.55pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapters
  29 and 31</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/2843157/"><span style='color:#F31D19'>John
  Odom</span></a></p>
  </td>
  <td width=376 valign=top style='width:282.15pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapters
  6, 18, 22, 32 and 56</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1946501/"><span style='color:#F31D19'>John
  Slegers</span></a></p>
  </td>
  <td width=376 valign=top style='width:282.15pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapters
  6 and 18</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/4917882/"><span style='color:#F31D19'>John
  Smith</span></a></p>
  </td>
  <td width=376 valign=top style='width:282.15pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  51</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/361842/"><span style='color:#F31D19'>JohnLBevan</span></a></p>
  </td>
  <td width=376 valign=top style='width:282.15pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  1</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/2767207/"><span style='color:#F31D19'>Jojodmo</span></a></p>
  </td>
  <td width=376 valign=top style='width:282.15pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  21</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1043674/"><span style='color:#F31D19'>Jon
  Chan</span></a></p>
  </td>
  <td width=376 valign=top style='width:282.15pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  13</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1438/"><span style='color:#F31D19'>Jon
  Ericson</span></a></p>
  </td>
  <td width=376 valign=top style='width:282.15pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapters
  1 and 13</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/168703/"><span style='color:#F31D19'>JonH</span></a></p>
  </td>
  <td width=376 valign=top style='width:282.15pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  6</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/575376/"><span style='color:#F31D19'>juergen
  d</span></a></p>
  </td>
  <td width=376 valign=top style='width:282.15pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapters
  12, 13 and 42</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/5194088/"><span style='color:#F31D19'>Karthikeyan</span></a></p>
  </td>
  <td width=376 valign=top style='width:282.15pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  28</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/5276718/"><span style='color:#F31D19'>Kewin
  Bjrk Nielsen</span></a></p>
  </td>
  <td width=376 valign=top style='width:282.15pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapters
  41 and 43</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1940824/"><span style='color:#F31D19'>KIRAN
  KUMAR MATAM</span></a></p>
  </td>
  <td width=376 valign=top style='width:282.15pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  21</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1203811/"><span style='color:#F31D19'>KjetilNordin</span></a></p>
  </td>
  <td width=376 valign=top style='width:282.15pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  36</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1271898/"><span style='color:#F31D19'>Knickerless</span></a></p>
  </td>
  <td width=376 valign=top style='width:282.15pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  62</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/692942/"><span style='color:#F31D19'>Lankymart</span></a></p>
  </td>
  <td width=376 valign=top style='width:282.15pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  6</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1439748/"><span style='color:#F31D19'>LCIII</span></a></p>
  </td>
  <td width=376 valign=top style='width:282.15pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  15</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/27010/"><span style='color:#F31D19'>Leigh
  Riffel</span></a></p>
  </td>
  <td width=376 valign=top style='width:282.15pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  41</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/5586958/"><span style='color:#F31D19'>Lexi</span></a></p>
  </td>
  <td width=376 valign=top style='width:282.15pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  25</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/5011068/"><span style='color:#F31D19'>Lohitha
  Palagiri</span></a></p>
  </td>
  <td width=376 valign=top style='width:282.15pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  11</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1944366/"><span style='color:#F31D19'>Mark
  Iannucci</span></a></p>
  </td>
  <td width=376 valign=top style='width:282.15pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapters
  6 and 18</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/6574064/"><span style='color:#F31D19'>Mark
  Perera</span></a></p>
  </td>
  <td width=376 valign=top style='width:282.15pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapters
  6 and 11</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/4178262/"><span style='color:#F31D19'>Mark
  Stewart</span></a></p>
  </td>
  <td width=376 valign=top style='width:282.15pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  43</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1509764/"><span style='color:#F31D19'>Matas
  Vaitkevicius</span></a></p>
  </td>
  <td width=376 valign=top style='width:282.15pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapters
  6, 13, 14, 19, 21 and 41</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/4694621/"><span style='color:#F31D19'>Mateusz
  Piotrowski</span></a></p>
  </td>
  <td width=376 valign=top style='width:282.15pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  41</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/2641576/"><span style='color:#F31D19'>Matt</span></a></p>
  </td>
  <td width=376 valign=top style='width:282.15pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapters
  5, 6 and 10</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/163024/"><span style='color:#F31D19'>Matt
  S</span></a></p>
  </td>
  <td width=376 valign=top style='width:282.15pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  6</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/3264217/"><span style='color:#F31D19'>Mattew
  Whitt</span></a></p>
  </td>
  <td width=376 valign=top style='width:282.15pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  6</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/126039/"><span style='color:#F31D19'>mauris</span></a></p>
  </td>
  <td width=376 valign=top style='width:282.15pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  37</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/5192848/"><span style='color:#F31D19'>Mihai</span></a></p>
  </td>
  <td width=376 valign=top style='width:282.15pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapters
  6 and 24</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/6357886/"><span style='color:#F31D19'>mithra
  chintha</span></a></p>
  </td>
  <td width=376 valign=top style='width:282.15pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapters
  8 and 25</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/5976576/"><span style='color:#F31D19'>MotKohn</span></a></p>
  </td>
  <td width=376 valign=top style='width:282.15pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  10</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/2422776/"><span style='color:#F31D19'>Mureinik</span></a></p>
  </td>
  <td width=376 valign=top style='width:282.15pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapters
  10, 18 and 45</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1227152/"><span style='color:#F31D19'>mustaccio</span></a></p>
  </td>
  <td width=376 valign=top style='width:282.15pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapters
  6 and 45</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/145988/"><span style='color:#F31D19'>Mzzzzzz</span></a></p>
  </td>
  <td width=376 valign=top style='width:282.15pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  5</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/2111584/"><span style='color:#F31D19'>Nathan</span></a></p>
  </td>
  <td width=376 valign=top style='width:282.15pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  42</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/4650537/"><span style='color:#F31D19'>nazark</span></a></p>
  </td>
  <td width=376 valign=top style='width:282.15pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  8</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/5280641/"><span style='color:#F31D19'>Neria
  Nachum</span></a></p>
  </td>
  <td width=376 valign=top style='width:282.15pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  41</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/6491757/"><span style='color:#F31D19'>Nunie123</span></a></p>
  </td>
  <td width=376 valign=top style='width:282.15pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  52</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1583/"><span style='color:#F31D19'>Oded</span></a></p>
  </td>
  <td width=376 valign=top style='width:282.15pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  6</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1334542/"><span style='color:#F31D19'>Ojen</span></a></p>
  </td>
  <td width=376 valign=top style='width:282.15pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapters
  6 and 11</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/6203436/"><span style='color:#F31D19'>omini
  data</span></a></p>
  </td>
  <td width=376 valign=top style='width:282.15pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapters
  42 and 44</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/15354/"><span style='color:#F31D19'>onedaywhen</span></a></p>
  </td>
  <td width=376 valign=top style='width:282.15pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  6</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/365188/"><span style='color:#F31D19'>Ozair
  Kafray</span></a></p>
  </td>
  <td width=376 valign=top style='width:282.15pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  25</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1579182/"><span style='color:#F31D19'>Parado</span></a></p>
  </td>
  <td width=376 valign=top style='width:282.15pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapters
  8 and 37</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/6620537/"><span style='color:#F31D19'>Paul
  Bambury</span></a></p>
  </td>
  <td width=376 valign=top style='width:282.15pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  30</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/222758/"><span style='color:#F31D19'>Paulo
  Freitas</span></a></p>
  </td>
  <td width=376 valign=top style='width:282.15pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  37</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/4896952/"><span style='color:#F31D19'>Peter
  K</span></a></p>
  </td>
  <td width=376 valign=top style='width:282.15pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapters
  42 and 46</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/3626537/"><span style='color:#F31D19'>Phrancis</span></a></p>
  </td>
  <td width=376 valign=top style='width:282.15pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>Chapters 1, 3, 4, 8, 11,
  13, 18, 19, 29, 38, 41, 46, 49, 52 and 53</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/500773/"><span style='color:#F31D19'>Prateek</span></a></p>
  </td>
  <td width=376 valign=top style='width:282.15pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapters
  1, 6 and 21</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1503505/"><span style='color:#F31D19'>Preuk</span></a></p>
  </td>
  <td width=376 valign=top style='width:282.15pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  6</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/3215948/"><span style='color:#F31D19'>Racil
  Hilan</span></a></p>
  </td>
  <td width=376 valign=top style='width:282.15pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  6</p>
  </td>
 </tr>
 <tr style='height:12.55pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:12.55pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/2052732/"><span style='color:#F31D19'>raholling</span></a></p>
  </td>
  <td width=376 valign=top style='width:282.15pt;padding:0in 0in 0in 0in;
  height:12.55pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  18</p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:259.1pt;margin-bottom:
0in;margin-left:-28.35pt;text-indent:0in;line-height:107%'>&nbsp;</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=371
 style='width:278.4pt;margin-left:1.0pt;border-collapse:collapse'>
 <tr style='height:12.55pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:12.55pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/4203686/"><span style='color:#F31D19'>rajarshig</span></a></p>
  </td>
  <td width=201 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:12.55pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  26</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/6392939/"><span style='color:#F31D19'>RamenChef</span></a></p>
  </td>
  <td width=201 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  41</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/2680864/"><span style='color:#F31D19'>Reboot</span></a></p>
  </td>
  <td width=201 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  42</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1423901/"><span style='color:#F31D19'>Redithion</span></a></p>
  </td>
  <td width=201 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  11</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/4730201/"><span style='color:#F31D19'>Ricardo
  Pontual</span></a></p>
  </td>
  <td width=201 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  22</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/6471538/"><span style='color:#F31D19'>Robert
  Columbia</span></a></p>
  </td>
  <td width=201 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapters
  6 and 41</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/84383/"><span style='color:#F31D19'>Ryan</span></a></p>
  </td>
  <td width=201 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  37</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/6281947/"><span style='color:#F31D19'>Ryan
  Rockey</span></a></p>
  </td>
  <td width=201 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  60</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/5293076/"><span style='color:#F31D19'>Saroj
  Sasmal</span></a></p>
  </td>
  <td width=201 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapters
  4 and 6</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/325521/"><span style='color:#F31D19'>Shiva</span></a></p>
  </td>
  <td width=201 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  5</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/5550507/"><span style='color:#F31D19'>Sibeesh
  Venu</span></a></p>
  </td>
  <td width=201 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  46</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/26111/"><span style='color:#F31D19'>Simon
  Foster</span></a></p>
  </td>
  <td width=201 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  25</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/6668376/"><span style='color:#F31D19'>Simone</span></a></p>
  </td>
  <td width=201 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  7</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1515052/"><span style='color:#F31D19'>Simulant</span></a></p>
  </td>
  <td width=201 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  16</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/2258393/"><span style='color:#F31D19'>SommerEngineering</span></a></p>
  </td>
  <td width=201 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  6</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1735928/"><span style='color:#F31D19'>SQLFox</span></a></p>
  </td>
  <td width=201 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  27</p>
  </td>
 </tr>
 <tr style='height:14.55pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.55pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/2958272/"><span style='color:#F31D19'>sqluser</span></a></p>
  </td>
  <td width=201 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.55pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  6</p>
  </td>
 </tr>
 <tr style='height:14.6pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.6pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/4609360/"><span style='color:#F31D19'>Stanislovas
  Kala</span></a><a href="https://stackoverflow.com/users/4609360/"><span
  style='font-family:"Arial",sans-serif;color:#F31D19'></span></a><a
  href="https://stackoverflow.com/users/4609360/"><span style='color:#F31D19'>nikovas</span></a></p>
  </td>
  <td width=201 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.6pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  10</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/155077/"><span style='color:#F31D19'>Stefan
  Steiger</span></a></p>
  </td>
  <td width=201 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapters
  11, 18, 33 and 62</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/3865006/"><span style='color:#F31D19'>Steven</span></a></p>
  </td>
  <td width=201 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  35</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/4651802/"><span style='color:#F31D19'>Stivan</span></a></p>
  </td>
  <td width=201 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  61</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/414/"><span style='color:#F31D19'>Stu</span></a></p>
  </td>
  <td width=201 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  31</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/4497805/"><span style='color:#F31D19'>Timothy</span></a></p>
  </td>
  <td width=201 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  6</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/683218/"><span style='color:#F31D19'>tinlyx</span></a></p>
  </td>
  <td width=201 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  52</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/4660897/"><span style='color:#F31D19'>Tot
  Zam</span></a></p>
  </td>
  <td width=201 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>Chapters 5, 13, 18, 19, 26
  and 42</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/3401520/"><span style='color:#F31D19'>Uberzen1</span></a></p>
  </td>
  <td width=201 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  23</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/3056913/"><span style='color:#F31D19'>Umesh</span></a></p>
  </td>
  <td width=201 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  29</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1221533/"><span style='color:#F31D19'>user1221533</span></a></p>
  </td>
  <td width=201 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  38</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1336087/"><span style='color:#F31D19'>user1336087</span></a></p>
  </td>
  <td width=201 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  6</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/2314737/"><span style='color:#F31D19'>user2314737</span></a></p>
  </td>
  <td width=201 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  34</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/5389107/"><span style='color:#F31D19'>user5389107</span></a></p>
  </td>
  <td width=201 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  5</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/3682162/"><span style='color:#F31D19'>Vikrant</span></a></p>
  </td>
  <td width=201 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  11</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1398786/"><span style='color:#F31D19'>vmaroli</span></a></p>
  </td>
  <td width=201 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapters
  11, 19 and 41</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1268937/"><span style='color:#F31D19'>walid</span></a></p>
  </td>
  <td width=201 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapters
  4 and 12</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/187538/"><span style='color:#F31D19'>WesleyJohnson</span></a></p>
  </td>
  <td width=201 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  5</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/5322242/"><span style='color:#F31D19'>William
  Ledbetter</span></a></p>
  </td>
  <td width=201 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  42</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/3292325/"><span style='color:#F31D19'>wintersolider</span></a></p>
  </td>
  <td width=201 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  6</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1979340/"><span style='color:#F31D19'>Wolfgang</span></a></p>
  </td>
  <td width=201 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  8</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/98804/"><span style='color:#F31D19'>xenodevil</span></a></p>
  </td>
  <td width=201 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapters
  18 and 29</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1016435/"><span style='color:#F31D19'>xQbert</span></a></p>
  </td>
  <td width=201 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  6</p>
  </td>
 </tr>
 <tr style='height:14.55pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.55pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/954725/"><span style='color:#F31D19'>Yehuda
  Shapira</span></a></p>
  </td>
  <td width=201 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.55pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  50</p>
  </td>
 </tr>
 <tr style='height:14.6pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.6pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><span
  style='position:relative;z-index:-1895739392'><span style='position:absolute;
  left:0px;top:-98836px;width:86px;height:1px'><img width=86 height=1
  src="SQL%20Notes%20for%20Professionals_files/image468.gif"></span></span><a
  href="https://stackoverflow.com/users/344949/"><span style='color:#F31D19;
  text-decoration:none'>ypercube</span></a></p>
  </td>
  <td width=201 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.6pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapters
  1 and 4</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/4378400/"><span style='color:#F31D19'>Yury
  Fedorov</span></a></p>
  </td>
  <td width=201 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  6</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/6633643/"><span style='color:#F31D19'>Zaga</span></a></p>
  </td>
  <td width=201 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  12</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/4700149/"><span style='color:#F31D19'>Zahiro
  Mor</span></a></p>
  </td>
  <td width=201 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapters
  6 and 7</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/2554537/"><span style='color:#F31D19'>zedfoxus</span></a></p>
  </td>
  <td width=201 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  6</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/3528562/"><span style='color:#F31D19'>Zoyd</span></a></p>
  </td>
  <td width=201 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  27</p>
  </td>
 </tr>
 <tr style='height:14.55pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.55pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/2989201/"><span style='color:#F31D19'>zplizzi</span></a></p>
  </td>
  <td width=201 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.55pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  26</p>
  </td>
 </tr>
 <tr style='height:14.6pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.6pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/4358339/"><span style='font-family:
  "Arial",sans-serif;color:#F31D19'>&#592;</span></a><a
  href="https://stackoverflow.com/users/4358339/"><span style='color:#F31D19'>l</span></a><a
  href="https://stackoverflow.com/users/4358339/"><span style='font-family:
  "Arial",sans-serif;color:#F31D19'>&#477;</span></a><a
  href="https://stackoverflow.com/users/4358339/"><span style='color:#F31D19'>x</span></a></p>
  </td>
  <td width=201 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.6pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapters
  10 and 41</p>
  </td>
 </tr>
 <tr style='height:14.6pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.6pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/7172363/"><span style='font-family:
  "Arial",sans-serif;color:#F31D19'>&#1040;</span></a><a
  href="https://stackoverflow.com/users/7172363/"><span style='font-family:
  "Arial",sans-serif;color:#F31D19'>&#1083;</span></a><a
  href="https://stackoverflow.com/users/7172363/"><span style='font-family:
  "Arial",sans-serif;color:#F31D19'>&#1077;&#1082;</span></a><a
  href="https://stackoverflow.com/users/7172363/"><span style='font-family:
  "Arial",sans-serif;color:#F31D19'>&#1089;</span></a><a
  href="https://stackoverflow.com/users/7172363/"><span style='font-family:
  "Arial",sans-serif;color:#F31D19'>&#1077;</span></a><a
  href="https://stackoverflow.com/users/7172363/"><span style='font-family:
  "Arial",sans-serif;color:#F31D19'>&#1081;</span></a><a
  href="https://stackoverflow.com/users/7172363/"><span style='color:#F31D19'> </span></a><a
  href="https://stackoverflow.com/users/7172363/"><span style='font-family:
  "Arial",sans-serif;color:#F31D19'>&#1053;</span></a><a
  href="https://stackoverflow.com/users/7172363/"><span style='font-family:
  "Arial",sans-serif;color:#F31D19'>&#1077;</span></a><a
  href="https://stackoverflow.com/users/7172363/"><span style='font-family:
  "Arial",sans-serif;color:#F31D19'>&#1091;</span></a><a
  href="https://stackoverflow.com/users/7172363/"><span style='font-family:
  "Arial",sans-serif;color:#F31D19'>&#1076;</span></a><a
  href="https://stackoverflow.com/users/7172363/"><span style='font-family:
  "Arial",sans-serif;color:#F31D19'>&#1072;</span></a><a
  href="https://stackoverflow.com/users/7172363/"><span style='font-family:
  "Arial",sans-serif;color:#F31D19'>&#1095;</span></a><a
  href="https://stackoverflow.com/users/7172363/"><span style='font-family:
  "Arial",sans-serif;color:#F31D19'>&#1080;</span></a><a
  href="https://stackoverflow.com/users/7172363/"><span style='font-family:
  "Arial",sans-serif;color:#F31D19'>&#1085;</span></a></p>
  </td>
  <td width=201 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.6pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  42</p>
  </td>
 </tr>
 <tr style='height:12.6pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:12.6pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/3709746/"><span style='font-family:
  "Arial",sans-serif;color:#F31D19'>&#1056;</span></a><a
  href="https://stackoverflow.com/users/3709746/"><span style='font-family:
  "Arial",sans-serif;color:#F31D19'>&#1072;</span></a><a
  href="https://stackoverflow.com/users/3709746/"><span style='font-family:
  "Arial",sans-serif;color:#F31D19'>&#1093;</span></a><a
  href="https://stackoverflow.com/users/3709746/"><span style='font-family:
  "Arial",sans-serif;color:#F31D19'>&#1091;</span></a><a
  href="https://stackoverflow.com/users/3709746/"><span style='font-family:
  "Arial",sans-serif;color:#F31D19'>&#1083;</span></a><a
  href="https://stackoverflow.com/users/3709746/"><span style='color:#F31D19'> </span></a><a
  href="https://stackoverflow.com/users/3709746/"><span style='font-family:
  "Arial",sans-serif;color:#F31D19'>&#1052;</span></a><a
  href="https://stackoverflow.com/users/3709746/"><span style='font-family:
  "Arial",sans-serif;color:#F31D19'>&#1072;</span></a><a
  href="https://stackoverflow.com/users/3709746/"><span style='font-family:
  "Arial",sans-serif;color:#F31D19'>&#1082;</span></a><a
  href="https://stackoverflow.com/users/3709746/"><span style='font-family:
  "Arial",sans-serif;color:#F31D19'>&#1074;</span></a><a
  href="https://stackoverflow.com/users/3709746/"><span style='font-family:
  "Arial",sans-serif;color:#F31D19'>&#1072;</span></a><a
  href="https://stackoverflow.com/users/3709746/"><span style='font-family:
  "Arial",sans-serif;color:#F31D19'>&#1085;</span></a><a
  href="https://stackoverflow.com/users/3709746/"><span style='font-family:
  "Arial",sans-serif;color:#F31D19'>&#1072;</span></a></p>
  </td>
  <td width=201 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:12.6pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  18</p>
  </td>
 </tr>
</table>

</div>

<span style='font-size:10.0pt;line-height:110%;font-family:"Calibri",sans-serif;
color:black'><br clear=all style='page-break-before:always'>
</span>

<div class=WordSection5>

<h1 style='margin-left:-43.15pt'><a name="_Toc228759">You may also like</a></h1>

<p class=MsoNormal style='margin-top:0in;margin-right:-45.95pt;margin-bottom:
0in;margin-left:-47.25pt;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=726 height=992
id="Group 199317" src="SQL%20Notes%20for%20Professionals_files/image469.gif"></span></p>

</div>

</body>

</html>
