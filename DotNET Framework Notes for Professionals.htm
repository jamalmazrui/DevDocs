<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=Generator content="Microsoft Word 15 (filtered)">
<title>.NET Framework Notes for Professionals</title>
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Helvetica;
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:Courier;
	panose-1:2 7 4 9 2 2 5 2 4 4;}
@font-face
	{font-family:"Tms Rmn";
	panose-1:2 2 6 3 4 5 5 2 3 4;}
@font-face
	{font-family:Helv;
	panose-1:2 11 6 4 2 2 2 3 2 4;}
@font-face
	{font-family:"New York";
	panose-1:2 4 5 3 6 5 6 2 3 4;}
@font-face
	{font-family:System;
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"MS Mincho";
	panose-1:2 2 6 9 4 2 5 8 3 4;}
@font-face
	{font-family:Batang;
	panose-1:2 3 6 0 0 1 1 1 1 1;}
@font-face
	{font-family:SimSun;
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:PMingLiU;
	panose-1:2 1 6 1 0 1 1 1 1 1;}
@font-face
	{font-family:"MS Gothic";
	panose-1:2 11 6 9 7 2 5 8 2 4;}
@font-face
	{font-family:Dotum;
	panose-1:2 11 6 0 0 1 1 1 1 1;}
@font-face
	{font-family:SimHei;
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:MingLiU;
	panose-1:2 1 6 9 0 1 1 1 1 1;}
@font-face
	{font-family:Mincho;
	panose-1:2 2 6 9 4 3 5 8 3 5;}
@font-face
	{font-family:Gulim;
	panose-1:2 11 6 0 0 1 1 1 1 1;}
@font-face
	{font-family:Century;
	panose-1:2 4 6 4 5 5 5 2 3 4;}
@font-face
	{font-family:"Angsana New";
	panose-1:2 2 6 3 5 4 5 2 3 4;}
@font-face
	{font-family:"Cordia New";
	panose-1:2 11 3 4 2 2 2 2 2 4;}
@font-face
	{font-family:Mangal;
	panose-1:0 0 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:Latha;
	panose-1:2 0 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:Sylfaen;
	panose-1:1 10 5 2 5 3 6 3 3 3;}
@font-face
	{font-family:Vrinda;
	panose-1:0 0 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:Raavi;
	panose-1:2 0 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:Shruti;
	panose-1:2 0 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:Sendnya;
	panose-1:0 0 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:Gautami;
	panose-1:2 0 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:Tunga;
	panose-1:0 0 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Estrangelo Edessa";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:"Yu Gothic";
	panose-1:2 11 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:DengXian;
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:"Calibri Light";
	panose-1:2 15 3 2 2 2 4 3 2 4;}
@font-face
	{font-family:"Palatino Linotype";
	panose-1:2 4 5 2 5 5 5 3 3 4;}
@font-face
	{font-family:Verdana;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
	{font-family:"Arial Unicode MS";
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:"Aptos Display";}
@font-face
	{font-family:Aptos;}
@font-face
	{font-family:"Segoe UI Emoji";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"DejaVu Sans Mono";
	panose-1:2 11 6 9 3 8 4 2 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:1.6pt;
	margin-left:.5pt;
	text-indent:-.5pt;
	line-height:109%;
	font-size:10.0pt;
	font-family:"Calibri",sans-serif;
	color:black;}
h1
	{mso-style-link:"Heading 1 Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:.15pt;
	margin-left:.5pt;
	text-indent:-.5pt;
	line-height:110%;
	page-break-after:avoid;
	font-size:26.0pt;
	font-family:"Calibri",sans-serif;
	color:#1889D0;}
h2
	{mso-style-link:"Heading 2 Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5pt;
	text-indent:-.5pt;
	line-height:107%;
	page-break-after:avoid;
	font-size:18.0pt;
	font-family:"Calibri",sans-serif;
	color:#1889D0;}
h3
	{mso-style-link:"Heading 3 Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5pt;
	text-indent:-.5pt;
	line-height:107%;
	page-break-after:avoid;
	font-size:18.0pt;
	font-family:"Calibri",sans-serif;
	color:#1889D0;}
p.MsoToc1, li.MsoToc1, div.MsoToc1
	{margin-top:0in;
	margin-right:1.15pt;
	margin-bottom:1.6pt;
	margin-left:1.25pt;
	text-indent:-.5pt;
	line-height:109%;
	font-size:10.0pt;
	font-family:"Calibri",sans-serif;
	color:black;}
p.MsoToc2, li.MsoToc2, div.MsoToc2
	{margin-top:0in;
	margin-right:.75pt;
	margin-bottom:2.4pt;
	margin-left:21.25pt;
	text-indent:-.5pt;
	line-height:109%;
	font-size:10.0pt;
	font-family:"Calibri",sans-serif;
	color:black;}
span.Heading3Char
	{mso-style-name:"Heading 3 Char";
	mso-style-link:"Heading 3";
	font-family:"Calibri",sans-serif;
	color:#1889D0;
	font-weight:bold;}
span.Heading1Char
	{mso-style-name:"Heading 1 Char";
	mso-style-link:"Heading 1";
	font-family:"Calibri",sans-serif;
	color:#1889D0;
	font-weight:bold;}
span.Heading2Char
	{mso-style-name:"Heading 2 Char";
	mso-style-link:"Heading 2";
	font-family:"Calibri",sans-serif;
	color:#1889D0;
	font-weight:bold;}
span.msoIns
	{mso-style-name:"";
	text-decoration:underline;
	color:#65B4B4;}
span.msoDel
	{mso-style-name:"";
	text-decoration:line-through;
	color:#FF4B4B;}
.MsoChpDefault
	{font-size:12.0pt;}
.MsoPapDefault
	{margin-bottom:8.0pt;
	line-height:115%;}
 /* Page Definitions */
 @page WordSection1
	{size:595.3pt 841.9pt;
	margin:23.8pt 41.95pt 44.85pt 28.35pt;}
div.WordSection1
	{page:WordSection1;}
@page WordSection2
	{size:595.3pt 841.9pt;
	margin:23.8pt 28.35pt 42.35pt 28.35pt;}
div.WordSection2
	{page:WordSection2;}
@page WordSection3
	{size:595.3pt 841.9pt;
	margin:63.75pt 1.0in 34.15pt 1.0in;}
div.WordSection3
	{page:WordSection3;}
 /* List Definitions */
 ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>

</head>

<body lang=EN-US style='word-wrap:break-word'>

<div class=WordSection1>

<p class=MsoNormal style='margin-top:0in;margin-right:553.35pt;margin-bottom:
0in;margin-left:-28.35pt;text-indent:0in;line-height:107%'><img width=792
height=1120
src=".NET%20Framework%20Notes%20for%20Professionals_files/image001.jpg"><br
clear=ALL>
<br clear=all style='page-break-before:always'>
</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.15pt;
margin-left:-.25pt;line-height:110%'><b><span style='font-size:26.0pt;
line-height:110%;color:#1889D0'>Contents</span></b></p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><img
width=700 height=942 id="Picture 275282"
src=".NET%20Framework%20Notes%20for%20Professionals_files/image002.gif"></p>

<p class=MsoToc1><a href="#_Toc281384"><b><span style='font-size:12.0pt;
line-height:109%;color:#1889D0'>Chapter 7: Stack and Heap</span></b><span
style='color:black;text-decoration:none'>......................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>26</span></a></p>

<p class=MsoToc2><a href="#_Toc281385"><span style='color:#1889D0'>Section 7.1:
Value types in use</span><span style='color:black;text-decoration:none'>.................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>26</span></a></p>

<p class=MsoToc2><a href="#_Toc281386"><span style='color:#1889D0'>Section 7.2:
Reference types in use</span><span style='color:black;text-decoration:none'>............................................................................................................................................................ </span><span style='color:black;text-decoration:none'>26</span></a></p>

<p class=MsoToc1><a href="#_Toc281387"><b><span style='font-size:12.0pt;
line-height:109%;color:#1889D0'>Chapter 8: LINQ</span></b><span
style='color:black;text-decoration:none'>................................................................................................................................................................................................ </span><span style='color:black;text-decoration:none'>28</span></a></p>

<p class=MsoToc2><a href="#_Toc281388"><span style='color:#1889D0'>Section 8.1:
SelectMany (flat map)</span><span style='color:black;text-decoration:none'>............................................................................................................................................................ </span><span style='color:black;text-decoration:none'>28</span></a></p>

<p class=MsoToc2><a href="#_Toc281389"><span style='color:#1889D0'>Section 8.2:
Where (filter)</span><span style='color:black;text-decoration:none'>............................................................................................................................................................................ </span><span style='color:black;text-decoration:none'>29</span></a></p>

<p class=MsoToc2><a href="#_Toc281390"><span style='color:#1889D0'>Section 8.3:
Any</span><span style='color:black;text-decoration:none'>............................................................................................................................................................................................. </span><span style='color:black;text-decoration:none'>29</span></a></p>

<p class=MsoToc2><a href="#_Toc281391"><span style='color:#1889D0'>Section 8.4:
GroupJoin</span><span style='color:black;text-decoration:none'>.................................................................................................................................................................................. </span><span style='color:black;text-decoration:none'>30</span></a></p>

<p class=MsoToc2><a href="#_Toc281392"><span style='color:#1889D0'>Section 8.5:
Except</span><span style='color:black;text-decoration:none'>........................................................................................................................................................................................ </span><span style='color:black;text-decoration:none'>31</span></a></p>

<p class=MsoToc2><a href="#_Toc281393"><span style='color:#1889D0'>Section 8.6:
Zip</span><span style='color:black;text-decoration:none'>............................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>31</span></a></p>

<p class=MsoToc2><a href="#_Toc281394"><span style='color:#1889D0'>Section 8.7:
Aggregate (fold)</span><span style='color:black;text-decoration:none'>....................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>31</span></a></p>

<p class=MsoToc2><a href="#_Toc281395"><span style='color:#1889D0'>Section 8.8:
ToLookup</span><span style='color:black;text-decoration:none'>................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>32</span></a></p>

<p class=MsoToc2><a href="#_Toc281396"><span style='color:#1889D0'>Section 8.9:
Intersect</span><span style='color:black;text-decoration:none'>.................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>32</span></a></p>

<p class=MsoToc2><a href="#_Toc281397"><span style='color:#1889D0'>Section
8.10: Concat</span><span style='color:black;text-decoration:none'>...................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>32</span></a></p>

<p class=MsoToc2><a href="#_Toc281398"><span style='color:#1889D0'>Section
8.11: All</span><span style='color:black;text-decoration:none'>............................................................................................................................................................................................. </span><span style='color:black;text-decoration:none'>32</span></a></p>

<p class=MsoToc2><a href="#_Toc281399"><span style='color:#1889D0'>Section
8.12: Sum</span><span style='color:black;text-decoration:none'>.......................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>33</span></a></p>

<p class=MsoToc2><a href="#_Toc281400"><span style='color:#1889D0'>Section
8.13: SequenceEqual</span><span style='color:black;text-decoration:none'>...................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>33</span></a></p>

<p class=MsoToc2><a href="#_Toc281401"><span style='color:#1889D0'>Section
8.14: Min</span><span style='color:black;text-decoration:none'>........................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>33</span></a></p>

<p class=MsoToc2><a href="#_Toc281402"><span style='color:#1889D0'>Section
8.15: Distinct</span><span style='color:black;text-decoration:none'>.................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>34</span></a></p>

<p class=MsoToc2><a href="#_Toc281403"><span style='color:#1889D0'>Section
8.16: Count</span><span style='color:black;text-decoration:none'>....................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>34</span></a></p>

<p class=MsoToc2><a href="#_Toc281404"><span style='color:#1889D0'>Section
8.17: Cast</span><span style='color:black;text-decoration:none'>.......................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>34</span></a></p>

<p class=MsoToc2><a href="#_Toc281405"><span style='color:#1889D0'>Section
8.18: Range</span><span style='color:black;text-decoration:none'>....................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>34</span></a></p>

<p class=MsoToc2><a href="#_Toc281406"><span style='color:#1889D0'>Section
8.19: ThenBy</span><span style='color:black;text-decoration:none'>..................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>35</span></a></p>

<p class=MsoToc2><a href="#_Toc281407"><span style='color:#1889D0'>Section
8.20: Repeat</span><span style='color:black;text-decoration:none'>..................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>35</span></a></p>

<p class=MsoToc2><a href="#_Toc281408"><span style='color:#1889D0'>Section
8.21: Empty</span><span style='color:black;text-decoration:none'>...................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>35</span></a></p>

<p class=MsoToc2><a href="#_Toc281409"><span style='color:#1889D0'>Section
8.22: Select (map)</span><span style='color:black;text-decoration:none'>........................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>35</span></a></p>

<p class=MsoToc2><a href="#_Toc281410"><span style='color:#1889D0'>Section
8.23: OrderBy</span><span style='color:black;text-decoration:none'>................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>36</span></a></p>

<p class=MsoToc2><a href="#_Toc281411"><span style='color:#1889D0'>Section
8.24: OrderByDescending</span><span style='color:black;text-decoration:none'>.............................................................................................................................................................. </span><span style='color:black;text-decoration:none'>36</span></a></p>

<p class=MsoToc2><a href="#_Toc281412"><span style='color:#1889D0'>Section
8.25: Contains</span><span style='color:black;text-decoration:none'>.................................................................................................................................................................................. </span><span style='color:black;text-decoration:none'>36</span></a></p>

<p class=MsoToc2><a href="#_Toc281413"><span style='color:#1889D0'>Section
8.26: First (find)</span><span style='color:black;text-decoration:none'>................................................................................................................................................................................ </span><span style='color:black;text-decoration:none'>36</span></a></p>

<p class=MsoToc2><a href="#_Toc281414"><span style='color:#1889D0'>Section
8.27: Single</span><span style='color:black;text-decoration:none'>....................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>37</span></a></p>

<p class=MsoToc2><a href="#_Toc281415"><span style='color:#1889D0'>Section
8.28: Last</span><span style='color:black;text-decoration:none'>........................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>37</span></a></p>

<p class=MsoToc2><a href="#_Toc281416"><span style='color:#1889D0'>Section
8.29: LastOrDefault</span><span style='color:black;text-decoration:none'>......................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>37</span></a></p>

<p class=MsoToc2><a href="#_Toc281417"><span style='color:#1889D0'>Section
8.30: SingleOrDefault</span><span style='color:black;text-decoration:none'>...................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>38</span></a></p>

<p class=MsoToc2><a href="#_Toc281418"><span style='color:#1889D0'>Section
8.31: FirstOrDefault</span><span style='color:black;text-decoration:none'>......................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>38</span></a></p>

<p class=MsoToc2><a href="#_Toc281419"><span style='color:#1889D0'>Section
8.32: Skip</span><span style='color:black;text-decoration:none'>........................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>38</span></a></p>

<p class=MsoToc2><a href="#_Toc281420"><span style='color:#1889D0'>Section
8.33: Take</span><span style='color:black;text-decoration:none'>.......................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>39</span></a></p>

<p class=MsoToc2><a href="#_Toc281421"><span style='color:#1889D0'>Section
8.34: Reverse</span><span style='color:black;text-decoration:none'>.................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>39</span></a></p>

<p class=MsoToc2><a href="#_Toc281422"><span style='color:#1889D0'>Section
8.35: OfType</span><span style='color:black;text-decoration:none'>..................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>39</span></a></p>

<p class=MsoToc2><a href="#_Toc281423"><span style='color:#1889D0'>Section
8.36: Max</span><span style='color:black;text-decoration:none'>.......................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>39</span></a></p>

<p class=MsoToc2><a href="#_Toc281424"><span style='color:#1889D0'>Section
8.37: Average</span><span style='color:black;text-decoration:none'>................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>39</span></a></p>

<p class=MsoToc2><a href="#_Toc281425"><span style='color:#1889D0'>Section
8.38: GroupBy</span><span style='color:black;text-decoration:none'>.................................................................................................................................................................................. </span><span style='color:black;text-decoration:none'>40</span></a></p>

<p class=MsoToc2><a href="#_Toc281426"><span style='color:#1889D0'>Section
8.39: ToDictionary</span><span style='color:black;text-decoration:none'>........................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>40</span></a></p>

<p class=MsoToc2><a href="#_Toc281427"><span style='color:#1889D0'>Section
8.40: Union</span><span style='color:black;text-decoration:none'>....................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>41</span></a></p>

<p class=MsoToc2><a href="#_Toc281428"><span style='color:#1889D0'>Section
8.41: ToArray</span><span style='color:black;text-decoration:none'>.................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>42</span></a></p>

<p class=MsoToc2><a href="#_Toc281429"><span style='color:#1889D0'>Section
8.42: ToList</span><span style='color:black;text-decoration:none'>........................................................................................................................................................................................ </span><span style='color:black;text-decoration:none'>42</span></a></p>

<p class=MsoToc2><a href="#_Toc281430"><span style='color:#1889D0'>Section
8.43: ElementAt</span><span style='color:black;text-decoration:none'>............................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>42</span></a></p>

<p class=MsoToc2><a href="#_Toc281431"><span style='color:#1889D0'>Section
8.44: ElementAtOrDefault</span><span style='color:black;text-decoration:none'>............................................................................................................................................................. </span><span style='color:black;text-decoration:none'>42</span></a></p>

<p class=MsoToc2><a href="#_Toc281432"><span style='color:#1889D0'>Section
8.45: SkipWhile</span><span style='color:black;text-decoration:none'>................................................................................................................................................................................ </span><span style='color:black;text-decoration:none'>42</span></a></p>

<p class=MsoToc2><a href="#_Toc281433"><span style='color:#1889D0'>Section
8.46: TakeWhile</span><span style='color:black;text-decoration:none'>............................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>43</span></a></p>

<p class=MsoToc2><a href="#_Toc281434"><span style='color:#1889D0'>Section
8.47: DefaultIfEmpty</span><span style='color:black;text-decoration:none'>....................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>43</span></a></p>

<p class=MsoToc2><a href="#_Toc281435"><span style='color:#1889D0'>Section
8.48: Join</span><span style='color:black;text-decoration:none'>........................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>43</span></a></p>

<p class=MsoToc2><a href="#_Toc281436"><span style='color:#1889D0'>Section
8.49: Left Outer Join</span><span style='color:black;text-decoration:none'>........................................................................................................................................................................ </span><span style='color:black;text-decoration:none'>44</span></a></p>

<p class=MsoToc1><a href="#_Toc281437"><b><span style='font-size:12.0pt;
line-height:109%;color:#1889D0'>Chapter 9: ForEach</span></b><span
style='color:black;text-decoration:none'>.......................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>46</span></a></p>

<p class=MsoToc2><a href="#_Toc281438"><span style='color:#1889D0'>Section 9.1:
Extension method for IEnumerable</span><span style='color:black;text-decoration:
none'>..................................................................................................................................... </span><span style='color:black;text-decoration:none'>46</span></a></p>

<p class=MsoToc2><a href="#_Toc281439"><span style='color:#1889D0'>Section 9.2:
Calling a method on an object in a list</span><span style='color:black;
text-decoration:none'>................................................................................................................................. </span><span style='color:black;text-decoration:none'>46</span></a></p>

<p class=MsoToc1><a href="#_Toc281440"><b><span style='font-size:12.0pt;
line-height:109%;color:#1889D0'>Chapter 10: Reflection</span></b><span
style='color:black;text-decoration:none'>.................................................................................................................................................................................. </span><span style='color:black;text-decoration:none'>47</span></a></p>

<p class=MsoToc2><a href="#_Toc281441"><span style='color:#1889D0'>Section
10.1: What is an Assembly?</span><span style='color:black;text-decoration:none'>........................................................................................................................................................... </span><span style='color:black;text-decoration:none'>47</span></a></p>

<p class=MsoToc2><a href="#_Toc281442"><span style='color:#1889D0'>Section
10.2: Compare two objects with reflection</span><span style='color:black;
text-decoration:none'>................................................................................................................................ </span><span style='color:black;text-decoration:none'>47</span></a></p>

<p class=MsoToc2><a href="#_Toc281443"><span style='color:#1889D0'>Section
10.3: Creating Object and setting properties using reflection</span><span
style='color:black;text-decoration:none'>................................................................................................. </span><span style='color:black;text-decoration:none'>48</span></a></p>

<p class=MsoToc2><a href="#_Toc281444"><span style='color:#1889D0'>Section
10.4: How to create an object of T using Reflection</span><span
style='color:black;text-decoration:none'>................................................................................................................. </span><span style='color:black;text-decoration:none'>48</span></a></p>

<p class=MsoToc2><a href="#_Toc281445"><span style='color:#1889D0'>Section
10.5: Getting an attribute of an enum with reflection (and caching it)</span><span
style='color:black;text-decoration:none'>................................................................................. </span><span style='color:black;text-decoration:none'>48</span></a></p>

<p class=MsoToc1><a href="#_Toc281446"><b><span style='font-size:12.0pt;
line-height:109%;color:#1889D0'>Chapter 11: Expression Trees</span></b><span
style='color:black;text-decoration:none'>.................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>50</span></a></p>

<p class=MsoToc2><a href="#_Toc281447"><span style='color:#1889D0'>Section
11.1: building a predicate of form field == value</span><span style='color:
black;text-decoration:none'>....................................................................................................................... </span><span style='color:black;text-decoration:none'>50</span></a></p>

<p class=MsoToc2><a href="#_Toc281448"><span style='color:#1889D0'>Section
11.2: Simple Expression Tree Generated by the C# Compiler</span><span
style='color:black;text-decoration:none'>................................................................................................. </span><span style='color:black;text-decoration:none'>50</span></a></p>

<p class=MsoToc2><a href="#_Toc281449"><span style='color:#1889D0'>Section
11.3: Expression for retrieving a static field</span><span style='color:black;
text-decoration:none'>................................................................................................................................ </span><span style='color:black;text-decoration:none'>51</span></a></p>

<p class=MsoToc2><a href="#_Toc281450"><span style='color:#1889D0'>Section
11.4: InvocationExpression Class</span><span style='color:black;text-decoration:
none'>.................................................................................................................................................. </span><span style='color:black;text-decoration:none'>51</span></a></p>

<p class=MsoToc1><a href="#_Toc281451"><b><span style='font-size:12.0pt;
line-height:109%;color:#1889D0'>Chapter 12: Custom Types</span></b><span
style='color:black;text-decoration:none'>.......................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>54</span></a></p>

<p class=MsoToc2><a href="#_Toc281452"><span style='color:#1889D0'>Section
12.1: Struct Definition</span><span style='color:black;text-decoration:none'>.................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>54</span></a></p>

<p class=MsoToc2><a href="#_Toc281453"><span style='color:#1889D0'>Section
12.2: Class Definition</span><span style='color:black;text-decoration:none'>...................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>54</span></a></p>

<p class=MsoToc1><a href="#_Toc281454"><b><span style='font-size:12.0pt;
line-height:109%;color:#1889D0'>Chapter 13: Code Contracts</span></b><span
style='color:black;text-decoration:none'>....................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>56</span></a></p>

<p class=MsoToc2><a href="#_Toc281455"><span style='color:#1889D0'>Section
13.1: Contracts for Interfaces</span><span style='color:black;text-decoration:
none'>........................................................................................................................................................ </span><span style='color:black;text-decoration:none'>56</span></a></p>

<p class=MsoToc2><a href="#_Toc281456"><span style='color:#1889D0'>Section
13.2: Installing and Enabling Code Contracts</span><span style='color:black;
text-decoration:none'>............................................................................................................................. </span><span style='color:black;text-decoration:none'>56</span></a></p>

<p class=MsoToc2><a href="#_Toc281457"><span style='color:#1889D0'>Section
13.3: Preconditions</span><span style='color:black;text-decoration:none'>......................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>58</span></a></p>

<p class=MsoToc2><a href="#_Toc281458"><span style='color:#1889D0'>Section
13.4: Postconditions</span><span style='color:black;text-decoration:none'>........................................................................................................................................................................ </span><span style='color:black;text-decoration:none'>59</span></a></p>

<p class=MsoToc1><a href="#_Toc281459"><b><span style='font-size:12.0pt;
line-height:109%;color:#1889D0'>Chapter 14: Settings</span></b><span
style='color:black;text-decoration:none'>....................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>60</span></a></p>

<p class=MsoToc2><a href="#_Toc281460"><span style='color:#1889D0'>Section
14.1: AppSettings from ConfigurationSettings in .NET 1.x</span><span
style='color:black;text-decoration:none'>....................................................................................................... </span><span style='color:black;text-decoration:none'>60</span></a></p>

<p class=MsoToc2><a href="#_Toc281461"><span style='color:#1889D0'>Section
14.2: Reading AppSettings from ConfigurationManager in .NET 2.0 and later</span><span
style='color:black;text-decoration:none'>.................................................................... </span><span style='color:black;text-decoration:none'>60</span></a></p>

<p class=MsoToc2><a href="#_Toc281462"><span style='color:#1889D0'>Section
14.3: Introduction to strongly-typed application and user settings support from
Visual Studio</span><span style='color:black;text-decoration:none'> ..................................... </span><span style='color:black;text-decoration:none'>61</span></a></p>

<p class=MsoToc2><a href="#_Toc281463"><span style='color:#1889D0'>Section
14.4: Reading strongly-typed settings from custom section of configuration file</span><span
style='color:black;text-decoration:none'>............................................................... </span><span style='color:black;text-decoration:none'>62</span></a></p>

<p class=MsoToc1><a href="#_Toc281464"><b><span style='font-size:12.0pt;
line-height:109%;color:#1889D0'>Chapter 15: Regular Expressions
(System.Text.RegularExpressions)</span></b><span style='color:black;text-decoration:
none'>.................................................................................. </span><span style='color:black;text-decoration:none'>65</span></a></p>

<p class=MsoToc2><a href="#_Toc281465"><span style='color:#1889D0'>Section
15.1: Check if pattern matches input</span><span style='color:black;text-decoration:
none'>........................................................................................................................................... </span><span style='color:black;text-decoration:none'>65</span></a></p>

<p class=MsoToc2><a href="#_Toc281466"><span style='color:#1889D0'>Section
15.2: Remove non alphanumeric characters from string</span><span
style='color:black;text-decoration:none'>......................................................................................................... </span><span style='color:black;text-decoration:none'>65</span></a></p>

<p class=MsoToc2><a href="#_Toc281467"><span style='color:#1889D0'>Section
15.3: Passing Options</span><span style='color:black;text-decoration:none'>...................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>65</span></a></p>

<p class=MsoToc2><a href="#_Toc281468"><span style='color:#1889D0'>Section
15.4: Match into groups</span><span style='color:black;text-decoration:none'>................................................................................................................................................................. </span><span style='color:black;text-decoration:none'>65</span></a></p>

<p class=MsoToc2><a href="#_Toc281469"><span style='color:#1889D0'>Section
15.5: Find all matches</span><span style='color:black;text-decoration:none'>..................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>65</span></a></p>

<p class=MsoToc2><a href="#_Toc281470"><span style='color:#1889D0'>Section
15.6: Simple match and replace</span><span style='color:black;text-decoration:
none'>................................................................................................................................................... </span><span style='color:black;text-decoration:none'>66</span></a></p>

<p class=MsoToc1><a href="#_Toc281471"><b><span style='font-size:12.0pt;
line-height:109%;color:#1889D0'>Chapter 16: File Input/Output</span></b><span
style='color:black;text-decoration:none'>.................................................................................................................................................................. </span><span style='color:black;text-decoration:none'>67</span></a></p>

<p class=MsoToc2><a href="#_Toc281472"><span style='color:#1889D0'>Section
16.1: C# File.Exists()</span><span style='color:black;text-decoration:none'>........................................................................................................................................................................ </span><span style='color:black;text-decoration:none'>67</span></a></p>

<p class=MsoToc2><a href="#_Toc281473"><span style='color:#1889D0'>Section
16.2: VB WriteAllText</span><span style='color:black;text-decoration:none'>...................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>67</span></a></p>

<p class=MsoToc2><a href="#_Toc281474"><span style='color:#1889D0'>Section
16.3: VB StreamWriter</span><span style='color:black;text-decoration:none'>.................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>67</span></a></p>

<p class=MsoToc2><a href="#_Toc281475"><span style='color:#1889D0'>Section
16.4: C# StreamWriter</span><span style='color:black;text-decoration:none'>.................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>67</span></a></p>

<p class=MsoToc2><a href="#_Toc281476"><span style='color:#1889D0'>Section
16.5: C# WriteAllText()</span><span style='color:black;text-decoration:none'>.................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>68</span></a></p>

<p class=MsoToc1><a href="#_Toc281477"><b><span style='font-size:12.0pt;
line-height:109%;color:#1889D0'>Chapter 17: System.IO</span></b><span
style='color:black;text-decoration:none'>.................................................................................................................................................................................. </span><span style='color:black;text-decoration:none'>69</span></a></p>

<p class=MsoToc2><a href="#_Toc281478"><span style='color:#1889D0'>Section
17.1: Reading a text file using StreamReader</span><span style='color:black;
text-decoration:none'>............................................................................................................................. </span><span style='color:black;text-decoration:none'>69</span></a></p>

<p class=MsoToc2><a href="#_Toc281479"><span style='color:#1889D0'>Section
17.2: Serial Ports using System.IO.SerialPorts</span><span style='color:black;
text-decoration:none'>............................................................................................................................ </span><span style='color:black;text-decoration:none'>69</span></a></p>

<p class=MsoToc2><a href="#_Toc281480"><span style='color:#1889D0'>Section
17.3: Reading/Writing Data Using System.IO.File</span><span style='color:black;
text-decoration:none'>...................................................................................................................... </span><span style='color:black;text-decoration:none'>70</span></a></p>

<p class=MsoToc1><a href="#_Toc281481"><b><span style='font-size:12.0pt;
line-height:109%;color:#1889D0'>Chapter 18: System.IO.File class</span></b><span
style='color:black;text-decoration:none'>.............................................................................................................................................................. </span><span style='color:black;text-decoration:none'>72</span></a></p>

<p class=MsoToc2><a href="#_Toc281482"><span style='color:#1889D0'>Section
18.1: Delete a file</span><span style='color:black;text-decoration:none'>............................................................................................................................................................................ </span><span style='color:black;text-decoration:none'>72</span></a></p>

<p class=MsoToc2><a href="#_Toc281483"><span style='color:#1889D0'>Section
18.2: Strip unwanted lines from a text file</span><span style='color:black;
text-decoration:none'>.................................................................................................................................. </span><span style='color:black;text-decoration:none'>73</span></a></p>

<p class=MsoToc2><a href="#_Toc281484"><span style='color:#1889D0'>Section
18.3: Convert text file encoding</span><span style='color:black;text-decoration:
none'>.................................................................................................................................................... </span><span style='color:black;text-decoration:none'>73</span></a></p>

<p class=MsoToc2><a href="#_Toc281485"><span style='color:#1889D0'>Section
18.4: Enumerate files older than a specified amount</span><span
style='color:black;text-decoration:none'>............................................................................................................... </span><span style='color:black;text-decoration:none'>74</span></a></p>

<p class=MsoToc2><a href="#_Toc281486"><span style='color:#1889D0'>Section
18.5: Move a File from one location to another</span><span style='color:black;
text-decoration:none'>........................................................................................................................ </span><span style='color:black;text-decoration:none'>74</span></a></p>

<p class=MsoToc1><a href="#_Toc281487"><b><span style='font-size:12.0pt;
line-height:109%;color:#1889D0'>Chapter 19: Reading and writing Zip files</span></b><span
style='color:black;text-decoration:none'>.......................................................................................................................................... </span><span style='color:black;text-decoration:none'>76</span></a></p>

<p class=MsoToc2><a href="#_Toc281488"><span style='color:#1889D0'>Section
19.1: Listing ZIP contents</span><span style='color:black;text-decoration:none'>............................................................................................................................................................... </span><span style='color:black;text-decoration:none'>76</span></a></p>

<p class=MsoToc2><a href="#_Toc281489"><span style='color:#1889D0'>Section
19.2: Extracting files from ZIP files</span><span style='color:black;
text-decoration:none'>............................................................................................................................................... </span><span style='color:black;text-decoration:none'>76</span></a></p>

<p class=MsoToc2><a href="#_Toc281490"><span style='color:#1889D0'>Section
19.3: Updating a ZIP file</span><span style='color:black;text-decoration:none'>................................................................................................................................................................. </span><span style='color:black;text-decoration:none'>76</span></a></p>

<p class=MsoToc1><a href="#_Toc281491"><b><span style='font-size:12.0pt;
line-height:109%;color:#1889D0'>Chapter 20: Managed Extensibility Framework</span></b><span
style='color:black;text-decoration:none'>............................................................................................................................. </span><span style='color:black;text-decoration:none'>78</span></a></p>

<p class=MsoToc2><a href="#_Toc281492"><span style='color:#1889D0'>Section
20.1: Connecting (Basic)</span><span style='color:black;text-decoration:none'>................................................................................................................................................................. </span><span style='color:black;text-decoration:none'>78</span></a></p>

<p class=MsoToc2><a href="#_Toc281493"><span style='color:#1889D0'>Section
20.2: Exporting a Type (Basic)</span><span style='color:black;text-decoration:
none'>....................................................................................................................................................... </span><span style='color:black;text-decoration:none'>78</span></a></p>

<p class=MsoToc2><a href="#_Toc281494"><span style='color:#1889D0'>Section
20.3: Importing (Basic)</span><span style='color:black;text-decoration:none'>................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>79</span></a></p>

<p class=MsoToc1><a href="#_Toc281495"><b><span style='font-size:12.0pt;
line-height:109%;color:#1889D0'>Chapter 21: SpeechRecognitionEngine class to
recognize speech</span></b><span style='color:black;text-decoration:none'>....................................................................................... </span><span style='color:black;text-decoration:none'>80</span></a></p>

<p class=MsoToc2><a href="#_Toc281496"><span style='color:#1889D0'>Section
21.1: Asynchronously recognizing speech based on a restricted set of phrases</span><span
style='color:black;text-decoration:none'>................................................................. </span><span style='color:black;text-decoration:none'>80</span></a></p>

<p class=MsoToc2><a href="#_Toc281497"><span style='color:#1889D0'>Section
21.2: Asynchronously recognizing speech for free text dictation</span><span
style='color:black;text-decoration:none'>........................................................................................... </span><span style='color:black;text-decoration:none'>80</span></a></p>

<p class=MsoToc1><a href="#_Toc281498"><b><span style='font-size:12.0pt;
line-height:109%;color:#1889D0'>Chapter 22: System.Runtime.Caching.MemoryCache
(ObjectCache)</span></b><span style='color:black;text-decoration:none'>................................................................................ </span><span style='color:black;text-decoration:none'>81</span></a></p>

<p class=MsoToc2><a href="#_Toc281499"><span style='color:#1889D0'>Section
22.1: Adding Item to Cache (Set)</span><span style='color:black;text-decoration:
none'>.................................................................................................................................................. </span><span style='color:black;text-decoration:none'>81</span></a></p>

<p class=MsoToc2><a href="#_Toc281500"><span style='color:#1889D0'>Section
22.2: System.Runtime.Caching.MemoryCache (ObjectCache)</span><span
style='color:black;text-decoration:none'>............................................................................................... </span><span style='color:black;text-decoration:none'>81</span></a></p>

<p class=MsoToc1><a href="#_Toc281501"><b><span style='font-size:12.0pt;
line-height:109%;color:#1889D0'>Chapter 23: System.Reflection.Emit namespace</span></b><span
style='color:black;text-decoration:none'>........................................................................................................................... </span><span style='color:black;text-decoration:none'>83</span></a></p>

<p class=MsoToc2><a href="#_Toc281502"><span style='color:#1889D0'>Section
23.1: Creating an assembly dynamically</span><span style='color:black;
text-decoration:none'>..................................................................................................................................... </span><span style='color:black;text-decoration:none'>83</span></a></p>

<p class=MsoToc1><a href="#_Toc281503"><b><span style='font-size:12.0pt;
line-height:109%;color:#1889D0'>Chapter 24: .NET Core</span></b><span
style='color:black;text-decoration:none'>................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>86</span></a></p>

<p class=MsoToc2><a href="#_Toc281504"><span style='color:#1889D0'>Section
24.1: Basic Console App</span><span style='color:black;text-decoration:none'>................................................................................................................................................................. </span><span style='color:black;text-decoration:none'>86</span></a></p>

<p class=MsoToc1><a href="#_Toc281505"><b><span style='font-size:12.0pt;
line-height:109%;color:#1889D0'>Chapter 25: ADO.NET</span></b><span
style='color:black;text-decoration:none'>.................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>87</span></a></p>

<p class=MsoToc2><a href="#_Toc281506"><span style='color:#1889D0'>Section
25.1: Best Practices - Executing Sql Statements</span><span style='color:black;
text-decoration:none'>........................................................................................................................ </span><span style='color:black;text-decoration:none'>87</span></a></p>

<p class=MsoToc2><a href="#_Toc281507"><span style='color:#1889D0'>Section
25.2: Executing SQL statements as a command</span><span style='color:black;
text-decoration:none'>......................................................................................................................... </span><span style='color:black;text-decoration:none'>88</span></a></p>

<p class=MsoToc2><a href="#_Toc281508"><span style='color:#1889D0'>Section
25.3: Using common interfaces to abstract away vendor specific classes</span><span
style='color:black;text-decoration:none'>............................................................................ </span><span style='color:black;text-decoration:none'>89</span></a></p>

<p class=MsoToc1><a href="#_Toc281509"><b><span style='font-size:12.0pt;
line-height:109%;color:#1889D0'>Chapter 26: Dependency Injection</span></b><span
style='color:black;text-decoration:none'>........................................................................................................................................................ </span><span style='color:black;text-decoration:none'>90</span></a></p>

<p class=MsoToc2><a href="#_Toc281510"><span style='color:#1889D0'>Section
26.1: How Dependency Injection Makes Unit Testing Easier</span><span
style='color:black;text-decoration:none'>................................................................................................... </span><span style='color:black;text-decoration:none'>90</span></a></p>

<p class=MsoToc2><a href="#_Toc281511"><span style='color:#1889D0'>Section
26.2: Dependency Injection - Simple example</span><span style='color:black;
text-decoration:none'>........................................................................................................................... </span><span style='color:black;text-decoration:none'>90</span></a></p>

<p class=MsoToc2><a href="#_Toc281512"><span style='color:#1889D0'>Section
26.3: Why We Use Dependency Injection Containers (IoC Containers)</span><span
style='color:black;text-decoration:none'>................................................................................ </span><span style='color:black;text-decoration:none'>91</span></a></p>

<p class=MsoToc1><a href="#_Toc281513"><b><span style='font-size:12.0pt;
line-height:109%;color:#1889D0'>Chapter 27: Platform Invoke</span></b><span
style='color:black;text-decoration:none'>...................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>94</span></a></p>

<p class=MsoToc2><a href="#_Toc281514"><span style='color:#1889D0'>Section
27.1: Marshaling structs</span><span style='color:black;text-decoration:none'>................................................................................................................................................................. </span><span style='color:black;text-decoration:none'>94</span></a></p>

<p class=MsoToc2><a href="#_Toc281515"><span style='color:#1889D0'>Section
27.2: Marshaling unions</span><span style='color:black;text-decoration:none'>................................................................................................................................................................. </span><span style='color:black;text-decoration:none'>95</span></a></p>

<p class=MsoToc2><a href="#_Toc281516"><span style='color:#1889D0'>Section
27.3: Calling a Win32 dll function</span><span style='color:black;text-decoration:
none'>................................................................................................................................................. </span><span style='color:black;text-decoration:none'>96</span></a></p>

<p class=MsoToc2><a href="#_Toc281517"><span style='color:#1889D0'>Section
27.4: Using Windows API</span><span style='color:black;text-decoration:none'>............................................................................................................................................................... </span><span style='color:black;text-decoration:none'>97</span></a></p>

<p class=MsoToc2><a href="#_Toc281518"><span style='color:#1889D0'>Section
27.5: Marshalling arrays</span><span style='color:black;text-decoration:none'>................................................................................................................................................................. </span><span style='color:black;text-decoration:none'>97</span></a></p>

<p class=MsoToc1><a href="#_Toc281519"><b><span style='font-size:12.0pt;
line-height:109%;color:#1889D0'>Chapter 28: NuGet packaging system</span></b><span
style='color:black;text-decoration:none'>.................................................................................................................................................. </span><span style='color:black;text-decoration:none'>98</span></a></p>

<p class=MsoToc2><a href="#_Toc281520"><span style='color:#1889D0'>Section
28.1: Uninstalling a package from one project in a solution</span><span
style='color:black;text-decoration:none'>................................................................................................... </span><span style='color:black;text-decoration:none'>98</span></a></p>

<p class=MsoToc2><a href="#_Toc281521"><span style='color:#1889D0'>Section
28.2: Installing a specific version of a package</span><span style='color:black;
text-decoration:none'>........................................................................................................................... </span><span style='color:black;text-decoration:none'>98</span></a></p>

<p class=MsoToc2><a href="#_Toc281522"><span style='color:#1889D0'>Section
28.3: Adding a package source feed (MyGet, Klondike, ect)</span><span
style='color:black;text-decoration:none'>................................................................................................... </span><span style='color:black;text-decoration:none'>98</span></a></p>

<p class=MsoToc2><a href="#_Toc281523"><span style='color:#1889D0'>Section
28.4: Installing the NuGet Package Manager</span><span style='color:black;
text-decoration:none'>............................................................................................................................. </span><span style='color:black;text-decoration:none'>98</span></a></p>

<p class=MsoToc2><a href="#_Toc281524"><span style='color:#1889D0'>Section
28.5: Managing Packages through the UI</span><span style='color:black;
text-decoration:none'>................................................................................................................................... </span><span style='color:black;text-decoration:none'>99</span></a></p>

<p class=MsoToc2><a href="#_Toc281525"><span style='color:#1889D0'>Section
28.6: Managing Packages through the console</span><span style='color:black;
text-decoration:none'>......................................................................................................................... </span><span style='color:black;text-decoration:none'>99</span></a></p>

<p class=MsoToc2><a href="#_Toc281526"><span style='color:#1889D0'>Section
28.7: Updating a package</span><span style='color:black;text-decoration:none'>............................................................................................................................................................... </span><span style='color:black;text-decoration:none'>99</span></a></p>

<p class=MsoToc2><a href="#_Toc281527"><span style='color:#1889D0'>Section
28.8: Uninstalling a package</span><span style='color:black;text-decoration:
none'>........................................................................................................................................................ </span><span style='color:black;text-decoration:none'>100</span></a></p>

<p class=MsoToc2><a href="#_Toc281528"><span style='color:#1889D0'>Section
28.9: Uninstall a specific version of package</span><span style='color:black;
text-decoration:none'>............................................................................................................................ </span><span style='color:black;text-decoration:none'>100</span></a></p>

<p class=MsoToc1><a href="#_Toc281529"><b><span style='font-size:12.0pt;
line-height:109%;color:#1889D0'>Chapter 29: Globalization in ASP.NET MVC using
Smart internationalization for ASP.NET</span></b><span style='color:black;
text-decoration:none'> ................................. </span><span style='color:black;text-decoration:none'>101</span></a></p>

<p class=MsoToc2><a href="#_Toc281530"><span style='color:#1889D0'>Section
29.1: Basic configuration and setup</span><span style='color:black;text-decoration:
none'>........................................................................................................................................... </span><span style='color:black;text-decoration:none'>101</span></a></p>

<p class=MsoToc1><a href="#_Toc281531"><b><span style='font-size:12.0pt;
line-height:109%;color:#1889D0'>Chapter 30: System.Net.Mail</span></b><span
style='color:black;text-decoration:none'>.................................................................................................................................................................. </span><span style='color:black;text-decoration:none'>103</span></a></p>

<p class=MsoToc2><a href="#_Toc281532"><span style='color:#1889D0'>Section
30.1: MailMessage</span><span style='color:black;text-decoration:none'>........................................................................................................................................................................ </span><span style='color:black;text-decoration:none'>103</span></a></p>

<p class=MsoToc2><a href="#_Toc281533"><span style='color:#1889D0'>Section
30.2: Mail with Attachment</span><span style='color:black;text-decoration:none'>......................................................................................................................................................... </span><span style='color:black;text-decoration:none'>104</span></a></p>

<p class=MsoToc1><a href="#_Toc281534"><b><span style='font-size:12.0pt;
line-height:109%;color:#1889D0'>Chapter 31: Using Progress&lt;T&gt; and
IProgress&lt;T&gt;</span></b><span style='color:black;text-decoration:none'>....................................................................................................................... </span><span style='color:black;text-decoration:none'>105</span></a></p>

<p class=MsoToc2><a href="#_Toc281535"><span style='color:#1889D0'>Section
31.1: Simple Progress reporting</span><span style='color:black;text-decoration:
none'>................................................................................................................................................. </span><span style='color:black;text-decoration:none'>105</span></a></p>

<p class=MsoToc2><a href="#_Toc281536"><span style='color:#1889D0'>Section
31.2: Using IProgress&lt;T&gt;</span><span style='color:black;text-decoration:
none'>.............................................................................................................................................................. </span><span style='color:black;text-decoration:none'>105</span></a></p>

<p class=MsoToc1><a href="#_Toc281537"><b><span style='font-size:12.0pt;
line-height:109%;color:#1889D0'>Chapter 32: JSON Serialization</span></b><span
style='color:black;text-decoration:none'>.............................................................................................................................................................. </span><span style='color:black;text-decoration:none'>107</span></a></p>

<p class=MsoToc2><a href="#_Toc281538"><span style='color:#1889D0'>Section
32.1: Deserialization using
System.Web.Script.Serialization.JavaScriptSerializer</span><span
style='color:black;text-decoration:none'>.............................................................. </span><span style='color:black;text-decoration:none'>107</span></a></p>

<p class=MsoToc2><a href="#_Toc281539"><span style='color:#1889D0'>Section
32.2: Serialization using Json.NET</span><span style='color:black;text-decoration:
none'>.............................................................................................................................................. </span><span style='color:black;text-decoration:none'>107</span></a></p>

<p class=MsoToc2><a href="#_Toc281540"><span style='color:#1889D0'>Section
32.3: Serialization-Deserialization using Newtonsoft.Json</span><span
style='color:black;text-decoration:none'>.................................................................................................... </span><span style='color:black;text-decoration:none'>108</span></a></p>

<p class=MsoToc2><a href="#_Toc281541"><span style='color:#1889D0'>Section
32.4: Deserialization using Json.NET</span><span style='color:black;text-decoration:
none'>......................................................................................................................................... </span><span style='color:black;text-decoration:none'>108</span></a></p>

<p class=MsoToc2><a href="#_Toc281542"><span style='color:#1889D0'>Section
32.5: Dynamic binding</span><span style='color:black;text-decoration:none'>.................................................................................................................................................................. </span><span style='color:black;text-decoration:none'>108</span></a></p>

<p class=MsoToc2><a href="#_Toc281543"><span style='color:#1889D0'>Section
32.6: Serialization using Json.NET with JsonSerializerSettings</span><span
style='color:black;text-decoration:none'>.............................................................................................. </span><span style='color:black;text-decoration:none'>109</span></a></p>

<p class=MsoToc1><a href="#_Toc281544"><b><span style='font-size:12.0pt;
line-height:109%;color:#1889D0'>Chapter 33: JSON in .NET with Newtonsoft.Json</span></b><span
style='color:black;text-decoration:none'>........................................................................................................................ </span><span style='color:black;text-decoration:none'>110</span></a></p>

<p class=MsoToc2><a href="#_Toc281545"><span style='color:#1889D0'>Section
33.1: Deserialize an object from JSON text</span><span style='color:black;
text-decoration:none'>.............................................................................................................................. </span><span style='color:black;text-decoration:none'>110</span></a></p>

<p class=MsoToc2><a href="#_Toc281546"><span style='color:#1889D0'>Section
33.2: Serialize object into JSON</span><span style='color:black;text-decoration:
none'>.................................................................................................................................................. </span><span style='color:black;text-decoration:none'>110</span></a></p>

<p class=MsoToc1><a href="#_Toc281547"><b><span style='font-size:12.0pt;
line-height:109%;color:#1889D0'>Chapter 34: XmlSerializer</span></b><span
style='color:black;text-decoration:none'>......................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>111</span></a></p>

<p class=MsoToc2><a href="#_Toc281548"><span style='color:#1889D0'>Section
34.1: Formatting: Custom DateTime format</span><span style='color:black;
text-decoration:none'>............................................................................................................................ </span><span style='color:black;text-decoration:none'>111</span></a></p>

<p class=MsoToc2><a href="#_Toc281549"><span style='color:#1889D0'>Section
34.2: Serialize object</span><span style='color:black;text-decoration:none'>.................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>111</span></a></p>

<p class=MsoToc2><a href="#_Toc281550"><span style='color:#1889D0'>Section
34.3: Deserialize object</span><span style='color:black;text-decoration:none'>................................................................................................................................................................ </span><span style='color:black;text-decoration:none'>111</span></a></p>

<p class=MsoToc2><a href="#_Toc281551"><span style='color:#1889D0'>Section
34.4: Behaviour: Map array name to property (XmlArray)</span><span
style='color:black;text-decoration:none'>.................................................................................................... </span><span style='color:black;text-decoration:none'>111</span></a></p>

<p class=MsoToc2><a href="#_Toc281552"><span style='color:#1889D0'>Section
34.5: Behaviour: Map Element name to Property</span><span style='color:black;
text-decoration:none'>.................................................................................................................. </span><span style='color:black;text-decoration:none'>112</span></a></p>

<p class=MsoToc2><a href="#_Toc281553"><span style='color:#1889D0'>Section
34.6: E&#57380;ciently building multiple serializers with derived types
specified dynamically</span><span style='color:black;text-decoration:none'>................................................... </span><span style='color:black;text-decoration:none'>112</span></a></p>

<p class=MsoToc1><a href="#_Toc281554"><b><span style='font-size:12.0pt;
line-height:109%;color:#1889D0'>Chapter 35: VB Forms</span></b><span
style='color:black;text-decoration:none'>................................................................................................................................................................................. </span><span style='color:black;text-decoration:none'>115</span></a></p>

<p class=MsoToc2><a href="#_Toc281555"><span style='color:#1889D0'>Section
35.1: Hello World in VB.NET Forms</span><span style='color:black;text-decoration:
none'>............................................................................................................................................ </span><span style='color:black;text-decoration:none'>115</span></a></p>

<p class=MsoToc2><a href="#_Toc281556"><span style='color:#1889D0'>Section
35.2: For Beginners</span><span style='color:black;text-decoration:none'>....................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>115</span></a></p>

<p class=MsoToc2><a href="#_Toc281557"><span style='color:#1889D0'>Section
35.3: Forms Timer</span><span style='color:black;text-decoration:none'>......................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>115</span></a></p>

<p class=MsoToc1><a href="#_Toc281558"><b><span style='font-size:12.0pt;
line-height:109%;color:#1889D0'>Chapter 36: JIT compiler</span></b><span
style='color:black;text-decoration:none'>............................................................................................................................................................................ </span><span style='color:black;text-decoration:none'>118</span></a></p>

<p class=MsoToc2><a href="#_Toc281559"><span style='color:#1889D0'>Section
36.1: IL compilation sample</span><span style='color:black;text-decoration:
none'>........................................................................................................................................................ </span><span style='color:black;text-decoration:none'>118</span></a></p>

<p class=MsoToc1><a href="#_Toc281560"><b><span style='font-size:12.0pt;
line-height:109%;color:#1889D0'>Chapter 37: CLR</span></b><span
style='color:black;text-decoration:none'>.............................................................................................................................................................................................. </span><span style='color:black;text-decoration:none'>121</span></a></p>

<p class=MsoToc2><a href="#_Toc281561"><span style='color:#1889D0'>Section
37.1: An introduction to Common Language Runtime</span><span style='color:black;
text-decoration:none'>........................................................................................................... </span><span style='color:black;text-decoration:none'>121</span></a></p>

<p class=MsoToc1><a href="#_Toc281562"><b><span style='font-size:12.0pt;
line-height:109%;color:#1889D0'>Chapter 38: TPL Dataflow</span></b><span
style='color:black;text-decoration:none'>......................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>122</span></a></p>

<p class=MsoToc2><a href="#_Toc281563"><span style='color:#1889D0'>Section
38.1: Asynchronous Producer Consumer With A Bounded Bu&#57379;erBlock</span><span
style='color:black;text-decoration:none'>............................................................................. </span><span style='color:black;text-decoration:none'>122</span></a></p>

<p class=MsoToc2><a href="#_Toc281564"><span style='color:#1889D0'>Section
38.2: Posting to an ActionBlock and waiting for completion</span><span
style='color:black;text-decoration:none'>................................................................................................ </span><span style='color:black;text-decoration:none'>122</span></a></p>

<p class=MsoToc2><a href="#_Toc281565"><span style='color:#1889D0'>Section
38.3: Linking blocks to create a pipeline</span><span style='color:black;
text-decoration:none'>................................................................................................................................... </span><span style='color:black;text-decoration:none'>122</span></a></p>

<p class=MsoToc2><a href="#_Toc281566"><span style='color:#1889D0'>Section
38.4: Synchronous Producer/Consumer with Bu&#57379;erBlock&lt;T&gt;</span><span
style='color:black;text-decoration:none'>.............................................................................................. </span><span style='color:black;text-decoration:none'>123</span></a></p>

<p class=MsoToc1><a href="#_Toc281567"><b><span style='font-size:12.0pt;
line-height:109%;color:#1889D0'>Chapter 39: Threading</span></b><span
style='color:black;text-decoration:none'>................................................................................................................................................................................ </span><span style='color:black;text-decoration:none'>125</span></a></p>

<p class=MsoToc2><a href="#_Toc281568"><span style='color:#1889D0'>Section
39.1: Accessing form controls from other threads</span><span style='color:black;
text-decoration:none'>.................................................................................................................. </span><span style='color:black;text-decoration:none'>125</span></a></p>

<p class=MsoToc1><a href="#_Toc281569"><b><span style='font-size:12.0pt;
line-height:109%;color:#1889D0'>Chapter 40: Process and Thread a&#57380;nity
setting</span></b><span style='color:black;text-decoration:none'>............................................................................................................................ </span><span style='color:black;text-decoration:none'>127</span></a></p>

<p class=MsoToc2><a href="#_Toc281570"><span style='color:#1889D0'>Section
40.1: Get process a&#57380;nity mask</span><span style='color:black;text-decoration:
none'>.................................................................................................................................................... </span><span style='color:black;text-decoration:none'>127</span></a></p>

<p class=MsoToc2><a href="#_Toc281571"><span style='color:#1889D0'>Section
40.2: Set process a&#57380;nity mask</span><span style='color:black;text-decoration:
none'>..................................................................................................................................................... </span><span style='color:black;text-decoration:none'>127</span></a></p>

<p class=MsoToc1><a href="#_Toc281572"><b><span style='font-size:12.0pt;
line-height:109%;color:#1889D0'>Chapter 41: Parallel processing using .Net
framework</span></b><span style='color:black;text-decoration:none'>............................................................................................................ </span><span style='color:black;text-decoration:none'>129</span></a></p>

<p class=MsoToc2><a href="#_Toc281573"><span style='color:#1889D0'>Section
41.1: Parallel Extensions</span><span style='color:black;text-decoration:none'>.............................................................................................................................................................. </span><span style='color:black;text-decoration:none'>129</span></a></p>

<p class=MsoToc1><a href="#_Toc281574"><b><span style='font-size:12.0pt;
line-height:109%;color:#1889D0'>Chapter 42: Task Parallel Library (TPL)</span></b><span
style='color:black;text-decoration:none'>.............................................................................................................................................. </span><span style='color:black;text-decoration:none'>130</span></a></p>

<p class=MsoToc2><a href="#_Toc281575"><span style='color:#1889D0'>Section
42.1: Basic producer-consumer loop (BlockingCollection)</span><span
style='color:black;text-decoration:none'>.................................................................................................... </span><span style='color:black;text-decoration:none'>130</span></a></p>

<p class=MsoToc2><a href="#_Toc281576"><span style='color:#1889D0'>Section
42.2: Parallel.Invoke</span><span style='color:black;text-decoration:none'>...................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>130</span></a></p>

<p class=MsoToc2><a href="#_Toc281577"><span style='color:#1889D0'>Section
42.3: Task: Returning a value</span><span style='color:black;text-decoration:
none'>...................................................................................................................................................... </span><span style='color:black;text-decoration:none'>131</span></a></p>

<p class=MsoToc2><a href="#_Toc281578"><span style='color:#1889D0'>Section
42.4: Parallel.ForEach</span><span style='color:black;text-decoration:none'>................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>131</span></a></p>

<p class=MsoToc2><a href="#_Toc281579"><span style='color:#1889D0'>Section
42.5: Parallel.For</span><span style='color:black;text-decoration:none'>........................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>131</span></a></p>

<p class=MsoToc2><a href="#_Toc281580"><span style='color:#1889D0'>Section
42.6: Task: basic instantiation and Wait</span><span style='color:black;
text-decoration:none'>.................................................................................................................................... </span><span style='color:black;text-decoration:none'>132</span></a></p>

<p class=MsoToc2><a href="#_Toc281581"><span style='color:#1889D0'>Section
42.7: Task.WhenAll</span><span style='color:black;text-decoration:none'>........................................................................................................................................................................ </span><span style='color:black;text-decoration:none'>132</span></a></p>

<p class=MsoToc2><a href="#_Toc281582"><span style='color:#1889D0'>Section
42.8: Flowing execution context with AsyncLocal</span><span style='color:black;
text-decoration:none'>................................................................................................................... </span><span style='color:black;text-decoration:none'>132</span></a></p>

<p class=MsoToc2><a href="#_Toc281583"><span style='color:#1889D0'>Section
42.9: Parallel.ForEach in VB.NET</span><span style='color:black;text-decoration:
none'>................................................................................................................................................ </span><span style='color:black;text-decoration:none'>133</span></a></p>

<p class=MsoToc2><a href="#_Toc281584"><span style='color:#1889D0'>Section
42.10: Task: WaitAll and variable capturing</span><span style='color:black;
text-decoration:none'>............................................................................................................................. </span><span style='color:black;text-decoration:none'>133</span></a></p>

<p class=MsoToc2><a href="#_Toc281585"><span style='color:#1889D0'>Section
42.11: Task: WaitAny</span><span style='color:black;text-decoration:none'>.................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>134</span></a></p>

<p class=MsoToc2><a href="#_Toc281586"><span style='color:#1889D0'>Section
42.12: Task: handling exceptions (using Wait)</span><span style='color:black;
text-decoration:none'>......................................................................................................................... </span><span style='color:black;text-decoration:none'>134</span></a></p>

<p class=MsoToc2><a href="#_Toc281587"><span style='color:#1889D0'>Section
42.13: Task: handling exceptions (without using Wait)</span><span
style='color:black;text-decoration:none'>.......................................................................................................... </span><span style='color:black;text-decoration:none'>134</span></a></p>

<p class=MsoToc2><a href="#_Toc281588"><span style='color:#1889D0'>Section
42.14: Task: cancelling using CancellationToken</span><span style='color:black;
text-decoration:none'>..................................................................................................................... </span><span style='color:black;text-decoration:none'>135</span></a></p>

<p class=MsoToc2><a href="#_Toc281589"><span style='color:#1889D0'>Section
42.15: Task.WhenAny</span><span style='color:black;text-decoration:none'>................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>136</span></a></p>

<p class=MsoToc1><a href="#_Toc281590"><b><span style='font-size:12.0pt;
line-height:109%;color:#1889D0'>Chapter 43: Task Parallel Library (TPL) API
Overviews</span></b><span style='color:black;text-decoration:none'>............................................................................................................. </span><span style='color:black;text-decoration:none'>137</span></a></p>

<p class=MsoToc2><a href="#_Toc281591"><span style='color:#1889D0'>Section
43.1: Perform work in response to a button click and update the UI</span><span
style='color:black;text-decoration:none'>.................................................................................. </span><span style='color:black;text-decoration:none'>137</span></a></p>

<p class=MsoToc1><a href="#_Toc281592"><b><span style='font-size:12.0pt;
line-height:109%;color:#1889D0'>Chapter 44: Synchronization Contexts</span></b><span
style='color:black;text-decoration:none'>.............................................................................................................................................. </span><span style='color:black;text-decoration:none'>138</span></a></p>

<p class=MsoToc2><a href="#_Toc281593"><span style='color:#1889D0'>Section
44.1: Execute code on the UI thread after performing background work</span><span
style='color:black;text-decoration:none'>.......................................................................... </span><span style='color:black;text-decoration:none'>138</span></a></p>

<p class=MsoToc1><a href="#_Toc281594"><b><span style='font-size:12.0pt;
line-height:109%;color:#1889D0'>Chapter 45: Memory management</span></b><span
style='color:black;text-decoration:none'>..................................................................................................................................................... </span><span style='color:black;text-decoration:none'>139</span></a></p>

<p class=MsoToc2><a href="#_Toc281595"><span style='color:#1889D0'>Section
45.1: Use SafeHandle when wrapping unmanaged resources</span><span
style='color:black;text-decoration:none'>.............................................................................................. </span><span style='color:black;text-decoration:none'>139</span></a></p>

<p class=MsoToc2><a href="#_Toc281596"><span style='color:#1889D0'>Section
45.2: Unmanaged Resources</span><span style='color:black;text-decoration:none'>...................................................................................................................................................... </span><span style='color:black;text-decoration:none'>139</span></a></p>

<p class=MsoToc1><a href="#_Toc281597"><b><span style='font-size:12.0pt;
line-height:109%;color:#1889D0'>Chapter 46: Garbage Collection</span></b><span
style='color:black;text-decoration:none'>............................................................................................................................................................ </span><span style='color:black;text-decoration:none'>141</span></a></p>

<p class=MsoToc2><a href="#_Toc281598"><span style='color:#1889D0'>Section
46.1: A basic example of (garbage) collection</span><span style='color:black;
text-decoration:none'>......................................................................................................................... </span><span style='color:black;text-decoration:none'>141</span></a></p>

<p class=MsoToc2><a href="#_Toc281599"><span style='color:#1889D0'>Section
46.2: Live objects and dead objects - the basics</span><span style='color:black;
text-decoration:none'>..................................................................................................................... </span><span style='color:black;text-decoration:none'>141</span></a></p>

<p class=MsoToc2><a href="#_Toc281600"><span style='color:#1889D0'>Section
46.3: Multiple dead objects</span><span style='color:black;text-decoration:
none'>........................................................................................................................................................ </span><span style='color:black;text-decoration:none'>142</span></a></p>

<p class=MsoToc2><a href="#_Toc281601"><span style='color:#1889D0'>Section
46.4: Weak References</span><span style='color:black;text-decoration:none'>................................................................................................................................................................. </span><span style='color:black;text-decoration:none'>142</span></a></p>

<p class=MsoToc2><a href="#_Toc281602"><span style='color:#1889D0'>Section
46.5: Dispose() vs. finalizers</span><span style='color:black;text-decoration:
none'>........................................................................................................................................................ </span><span style='color:black;text-decoration:none'>143</span></a></p>

<p class=MsoToc2><a href="#_Toc281603"><span style='color:#1889D0'>Section
46.6: Proper disposal and finalization of objects</span><span style='color:
black;text-decoration:none'>.................................................................................................................... </span><span style='color:black;text-decoration:none'>144</span></a></p>

<p class=MsoToc1><a href="#_Toc281604"><b><span style='font-size:12.0pt;
line-height:109%;color:#1889D0'>Chapter 47: Exceptions</span></b><span
style='color:black;text-decoration:none'>............................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>146</span></a></p>

<p class=MsoToc2><a href="#_Toc281605"><span style='color:#1889D0'>Section
47.1: Catching and rethrowing caught exceptions</span><span style='color:black;
text-decoration:none'>.................................................................................................................. </span><span style='color:black;text-decoration:none'>146</span></a></p>

<p class=MsoToc2><a href="#_Toc281606"><span style='color:#1889D0'>Section
47.2: Using a finally block</span><span style='color:black;text-decoration:
none'>............................................................................................................................................................ </span><span style='color:black;text-decoration:none'>147</span></a></p>

<p class=MsoToc2><a href="#_Toc281607"><span style='color:#1889D0'>Section
47.3: Exception Filters</span><span style='color:black;text-decoration:none'>.................................................................................................................................................................. </span><span style='color:black;text-decoration:none'>147</span></a></p>

<p class=MsoToc2><a href="#_Toc281608"><span style='color:#1889D0'>Section
47.4: Rethrowing an exception within a catch block</span><span
style='color:black;text-decoration:none'>.............................................................................................................. </span><span style='color:black;text-decoration:none'>148</span></a></p>

<p class=MsoToc2><a href="#_Toc281609"><span style='color:#1889D0'>Section
47.5: Throwing an exception from a di&#57379;erent method while preserving its
information</span><span style='color:black;text-decoration:none'>................................................ </span><span style='color:black;text-decoration:none'>148</span></a></p>

<p class=MsoToc2><a href="#_Toc281610"><span style='color:#1889D0'>Section
47.6: Catching an exception</span><span style='color:black;text-decoration:
none'>........................................................................................................................................................ </span><span style='color:black;text-decoration:none'>149</span></a></p>

<p class=MsoToc1><a href="#_Toc281611"><b><span style='font-size:12.0pt;
line-height:109%;color:#1889D0'>Chapter 48: System.Diagnostics</span></b><span
style='color:black;text-decoration:none'>............................................................................................................................................................ </span><span style='color:black;text-decoration:none'>150</span></a></p>

<p class=MsoToc2><a href="#_Toc281612"><span style='color:#1889D0'>Section
48.1: Run shell commands</span><span style='color:black;text-decoration:none'>.......................................................................................................................................................... </span><span style='color:black;text-decoration:none'>150</span></a></p>

<p class=MsoToc2><a href="#_Toc281613"><span style='color:#1889D0'>Section
48.2: Send Command to CMD and Receive Output</span><span style='color:black;
text-decoration:none'>................................................................................................................ </span><span style='color:black;text-decoration:none'>150</span></a></p>

<p class=MsoToc2><a href="#_Toc281614"><span style='color:#1889D0'>Section
48.3: Stopwatch</span><span style='color:black;text-decoration:none'>............................................................................................................................................................................. </span><span style='color:black;text-decoration:none'>152</span></a></p>

<p class=MsoToc1><a href="#_Toc281615"><b><span style='font-size:12.0pt;
line-height:109%;color:#1889D0'>Chapter 49: Encryption / Cryptography</span></b><span
style='color:black;text-decoration:none'>............................................................................................................................................ </span><span style='color:black;text-decoration:none'>153</span></a></p>

<p class=MsoToc2><a href="#_Toc281616"><span style='color:#1889D0'>Section
49.1: Encryption and Decryption using Cryptography (AES)</span><span
style='color:black;text-decoration:none'>................................................................................................. </span><span style='color:black;text-decoration:none'>153</span></a></p>

<p class=MsoToc2><a href="#_Toc281617"><span style='color:#1889D0'>Section
49.2: RijndaelManaged</span><span style='color:black;text-decoration:none'>................................................................................................................................................................ </span><span style='color:black;text-decoration:none'>154</span></a></p>

<p class=MsoToc2><a href="#_Toc281618"><span style='color:#1889D0'>Section
49.3: Encrypt and decrypt data using AES (in C#)</span><span style='color:black;
text-decoration:none'>................................................................................................................... </span><span style='color:black;text-decoration:none'>155</span></a></p>

<p class=MsoToc2><a href="#_Toc281619"><span style='color:#1889D0'>Section
49.4: Create a Key from a Password / Random SALT (in C#)</span><span
style='color:black;text-decoration:none'>.................................................................................................. </span><span style='color:black;text-decoration:none'>158</span></a></p>

<p class=MsoToc1><a href="#_Toc281620"><b><span style='font-size:12.0pt;
line-height:109%;color:#1889D0'>Chapter 50: Work with SHA1 in C#</span></b><span
style='color:black;text-decoration:none'>...................................................................................................................................................... </span><span style='color:black;text-decoration:none'>161</span></a></p>

<p class=MsoToc2><a href="#_Toc281621"><span style='color:#1889D0'>Section
50.1: #Generate SHA1 checksum of a file</span><span style='color:black;
text-decoration:none'>................................................................................................................................. </span><span style='color:black;text-decoration:none'>161</span></a></p>

<p class=MsoToc2><a href="#_Toc281622"><span style='color:#1889D0'>Section
50.2: #Generate hash of a text</span><span style='color:black;text-decoration:
none'>................................................................................................................................................... </span><span style='color:black;text-decoration:none'>161</span></a></p>

<p class=MsoToc1><a href="#_Toc281623"><b><span style='font-size:12.0pt;
line-height:109%;color:#1889D0'>Chapter 51: Unit testing</span></b><span
style='color:black;text-decoration:none'>............................................................................................................................................................................ </span><span style='color:black;text-decoration:none'>162</span></a></p>

<p class=MsoToc2><a href="#_Toc281624"><span style='color:#1889D0'>Section
51.1: Adding MSTest unit testing project to an existing solution</span><span
style='color:black;text-decoration:none'>......................................................................................... </span><span style='color:black;text-decoration:none'>162</span></a></p>

<p class=MsoToc2><a href="#_Toc281625"><span style='color:#1889D0'>Section
51.2: Creating a sample test method</span><span style='color:black;text-decoration:
none'>........................................................................................................................................ </span><span style='color:black;text-decoration:none'>162</span></a></p>

<p class=MsoToc1><a href="#_Toc281626"><b><span style='font-size:12.0pt;
line-height:109%;color:#1889D0'>Chapter 52: Write to and read from StdErr
stream</span></b><span style='color:black;text-decoration:none'>.................................................................................................................... </span><span style='color:black;text-decoration:none'>163</span></a></p>

<p class=MsoToc2><a href="#_Toc281627"><span style='color:#1889D0'>Section
52.1: Write to standard error output using Console</span><span
style='color:black;text-decoration:none'>............................................................................................................... </span><span style='color:black;text-decoration:none'>163</span></a></p>

<p class=MsoToc2><a href="#_Toc281628"><span style='color:#1889D0'>Section
52.2: Read from standard error of child process</span><span style='color:black;
text-decoration:none'>..................................................................................................................... </span><span style='color:black;text-decoration:none'>163</span></a></p>

<p class=MsoToc1><a href="#_Toc281629"><b><span style='font-size:12.0pt;
line-height:109%;color:#1889D0'>Chapter 53: Upload file and POST data to
webserver</span></b><span style='color:black;text-decoration:none'>.............................................................................................................. </span><span style='color:black;text-decoration:none'>164</span></a></p>

<p class=MsoToc2><a href="#_Toc281630"><span style='color:#1889D0'>Section
53.1: Upload file with WebRequest</span><span style='color:black;text-decoration:
none'>........................................................................................................................................... </span><span style='color:black;text-decoration:none'>164</span></a></p>

<p class=MsoToc1><a href="#_Toc281631"><b><span style='font-size:12.0pt;
line-height:109%;color:#1889D0'>Chapter 54: Networking</span></b><span
style='color:black;text-decoration:none'>............................................................................................................................................................................ </span><span style='color:black;text-decoration:none'>166</span></a></p>

<p class=MsoToc2><a href="#_Toc281632"><span style='color:#1889D0'>Section
54.1: Basic TCP chat (TcpListener, TcpClient, NetworkStream)</span><span
style='color:black;text-decoration:none'>............................................................................................. </span><span style='color:black;text-decoration:none'>166</span></a></p>

<p class=MsoToc2><a href="#_Toc281633"><span style='color:#1889D0'>Section
54.2: Basic SNTP client (UdpClient)</span><span style='color:black;text-decoration:
none'>............................................................................................................................................ </span><span style='color:black;text-decoration:none'>167</span></a></p>

<p class=MsoToc1><a href="#_Toc281634"><b><span style='font-size:12.0pt;
line-height:109%;color:#1889D0'>Chapter 55: HTTP servers</span></b><span
style='color:black;text-decoration:none'>.......................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>169</span></a></p>

<p class=MsoToc2><a href="#_Toc281635"><span style='color:#1889D0'>Section
55.1: Basic read-only HTTP file server (ASP.NET Core)</span><span
style='color:black;text-decoration:none'>........................................................................................................... </span><span style='color:black;text-decoration:none'>169</span></a></p>

<p class=MsoToc2><a href="#_Toc281636"><span style='color:#1889D0'>Section
55.2: Basic read-only HTTP file server (HttpListener)</span><span
style='color:black;text-decoration:none'>............................................................................................................. </span><span style='color:black;text-decoration:none'>170</span></a></p>

<p class=MsoToc1><a href="#_Toc281637"><b><span style='font-size:12.0pt;
line-height:109%;color:#1889D0'>Chapter 56: HTTP clients</span></b><span
style='color:black;text-decoration:none'>........................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>173</span></a></p>

<p class=MsoToc2><a href="#_Toc281638"><span style='color:#1889D0'>Section
56.1: Reading GET response as string using System.Net.HttpClient</span><span
style='color:black;text-decoration:none'>.................................................................................... </span><span style='color:black;text-decoration:none'>173</span></a></p>

<p class=MsoToc2><a href="#_Toc281639"><span style='color:#1889D0'>Section
56.2: Basic HTTP downloader using System.Net.Http.HttpClient</span><span
style='color:black;text-decoration:none'>......................................................................................... </span><span style='color:black;text-decoration:none'>173</span></a></p>

<p class=MsoToc2><a href="#_Toc281640"><span style='color:#1889D0'>Section
56.3: Reading GET response as string using System.Net.HttpWebRequest</span><span
style='color:black;text-decoration:none'>........................................................................ </span><span style='color:black;text-decoration:none'>174</span></a></p>

<p class=MsoToc2><a href="#_Toc281641"><span style='color:#1889D0'>Section
56.4: Reading GET response as string using System.Net.WebClient</span><span
style='color:black;text-decoration:none'>.................................................................................... </span><span style='color:black;text-decoration:none'>174</span></a></p>

<p class=MsoToc2><a href="#_Toc281642"><span style='color:#1889D0'>Section
56.5: Sending a POST request with a string payload using
System.Net.HttpWebRequest</span><span style='color:black;text-decoration:none'>.............................................. </span><span style='color:black;text-decoration:none'>174</span></a></p>

<p class=MsoToc2><a href="#_Toc281643"><span style='color:#1889D0'>Section
56.6: Sending a POST request with a string payload using System.Net.WebClient</span><span
style='color:black;text-decoration:none'>........................................................... </span><span style='color:black;text-decoration:none'>175</span></a></p>

<p class=MsoToc2><a href="#_Toc281644"><span style='color:#1889D0'>Section
56.7: Sending a POST request with a string payload using System.Net.HttpClient</span><span
style='color:black;text-decoration:none'>........................................................... </span><span style='color:black;text-decoration:none'>175</span></a></p>

<p class=MsoToc1><a href="#_Toc281645"><b><span style='font-size:12.0pt;
line-height:109%;color:#1889D0'>Chapter 57: Serial Ports</span></b><span
style='color:black;text-decoration:none'>............................................................................................................................................................................. </span><span style='color:black;text-decoration:none'>176</span></a></p>

<p class=MsoToc2><a href="#_Toc281646"><span style='color:#1889D0'>Section
57.1: Basic operation</span><span style='color:black;text-decoration:none'>.................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>176</span></a></p>

<p class=MsoToc2><a href="#_Toc281647"><span style='color:#1889D0'>Section
57.2: List available port names</span><span style='color:black;text-decoration:
none'>................................................................................................................................................... </span><span style='color:black;text-decoration:none'>176</span></a></p>

<p class=MsoToc2><a href="#_Toc281648"><span style='color:#1889D0'>Section
57.3: Asynchronous read</span><span style='color:black;text-decoration:none'>............................................................................................................................................................. </span><span style='color:black;text-decoration:none'>176</span></a></p>

<p class=MsoToc2><a href="#_Toc281649"><span style='color:#1889D0'>Section
57.4: Synchronous text echo service</span><span style='color:black;text-decoration:
none'>......................................................................................................................................... </span><span style='color:black;text-decoration:none'>176</span></a></p>

<p class=MsoToc2><a href="#_Toc281650"><span style='color:#1889D0'>Section
57.5: Asynchronous message receiver</span><span style='color:black;text-decoration:
none'>...................................................................................................................................... </span><span style='color:black;text-decoration:none'>177</span></a></p>

<p class=MsoToc1><a href="#_Toc281651"><b><span style='font-size:12.0pt;
line-height:109%;color:#1889D0'>Appendix A: Acronym Glossary</span></b><span
style='color:black;text-decoration:none'>............................................................................................................................................................. </span><span style='color:black;text-decoration:none'>180</span></a></p>

<p class=MsoToc2><a href="#_Toc281652"><span style='color:#1889D0'>Section A.1:
.Net Related Acronyms</span><span style='color:black;text-decoration:none'>........................................................................................................................................................ </span><span style='color:black;text-decoration:none'>180</span></a></p>

<p class=MsoToc1><a href="#_Toc281653"><b><span style='font-size:12.0pt;
line-height:109%;color:#1889D0'>Credits</span></b><span style='color:black;
text-decoration:none'>................................................................................................................................................................................................................. </span><span style='color:black;text-decoration:none'>181</span></a></p>

<p class=MsoToc1><a href="#_Toc281654"><b><span style='font-size:12.0pt;
line-height:109%;color:#1889D0'>You may also like</span></b><span
style='color:black;text-decoration:none'>........................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>184</span></a></p>

<p class=MsoNormal>&nbsp;</p>

</div>

<span style='font-size:10.0pt;line-height:109%;font-family:"Calibri",sans-serif;
color:black'><br clear=all style='page-break-before:always'>
</span>

<div class=WordSection2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:105.15pt;
margin-left:-.25pt;line-height:110%'><b><span style='font-size:26.0pt;
line-height:110%;color:#1889D0'>About</span></b></p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:116.5pt;
margin-bottom:29.9pt;margin-left:116.5pt;text-align:center;text-indent:0in;
line-height:123%'><span style='font-size:11.0pt;line-height:123%'>Please feel
free to share this PDF with anyone for free, latest version of this book can be
downloaded from: </span><a href="https://goalkicker.com/DotNETFrameworkBook"><span
style='font-size:11.0pt;line-height:123%;color:#1889D0'>https://goalkicker.com/DotNETFrameworkBook</span></a></p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:80.3pt;
margin-bottom:.2pt;margin-left:80.8pt;text-align:center;line-height:123%'>This <i>.NET
Framework Notes for Professionals</i> book is compiled from <a
href="https://archive.org/details/documentation-dump.7z"><span
style='color:#1889D0'>Stack Overflow </span></a><a
href="https://archive.org/details/documentation-dump.7z"><span
style='color:#1889D0'>Documentation</span></a>, the content is written by the
beautiful people at Stack Overflow.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:80.3pt;
margin-bottom:11.2pt;margin-left:80.8pt;text-align:center;line-height:123%'><span
style='position:relative;z-index:-1895824384'><span style='left:0px;position:
absolute;left:87px;top:-199px;width:545px;height:476px'><img width=545
height=476
src=".NET%20Framework%20Notes%20for%20Professionals_files/image003.gif"></span></span>Text
content is released under Creative Commons BY-SA, see credits at the end of
this book whom contributed to the various chapters. Images may be copyright of
their respective owners unless otherwise specified</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:80.3pt;
margin-bottom:.2pt;margin-left:80.8pt;text-align:center;line-height:123%'>This
is an unofficial free book created for educational purposes and is not
affiliated with official .NET Framework group(s) or company(s) nor Stack</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:80.3pt;
margin-bottom:11.2pt;margin-left:80.8pt;text-align:center;line-height:123%'>Overflow.
All trademarks and registered trademarks are the property of their respective
company owners</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:80.3pt;
margin-bottom:11.2pt;margin-left:80.8pt;text-align:center;line-height:123%'>The
information presented in this book is not guaranteed to be correct nor
accurate, use at your own risk</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:131.55pt'>Please send feedback and corrections to <u><span
style='color:#1889D0'>web@petercv.com</span></u></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.15pt;
margin-left:-.25pt;line-height:110%'><b><span style='font-size:26.0pt;
line-height:110%;color:#1889D0'>Chapter 1: Getting started with .NET Framework</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:2.1pt;
margin-left:.75pt;line-height:107%'><b>.NET</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:1.35pt;
margin-left:.75pt;line-height:107%'><b>Version Release Date</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:3.9pt;
margin-left:0in;text-indent:0in'><a
href="https://en.wikipedia.org/wiki/.NET_Framework_version_history#.NET_Framework_1.0"><span
style='color:#1889D0'>1.0</span></a><u><span style='color:#1889D0'> </span></u>2002-02-13</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:3.9pt;
margin-left:0in;text-indent:0in'><a
href="https://en.wikipedia.org/wiki/.NET_Framework_version_history#.NET_Framework_1.1"><span
style='color:#1889D0'>1.1</span></a><u><span style='color:#1889D0'> </span></u>2003-04-24</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:3.9pt;
margin-left:0in;text-indent:0in'><a
href="https://en.wikipedia.org/wiki/.NET_Framework_version_history#.NET_Framework_2.0"><span
style='color:#1889D0'>2.0</span></a><u><span style='color:#1889D0'> </span></u>2005-11-07</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:3.9pt;
margin-left:0in;text-indent:0in'><a
href="https://en.wikipedia.org/wiki/.NET_Framework_version_history#.NET_Framework_3.0"><span
style='color:#1889D0'>3.0</span></a><u><span style='color:#1889D0'> </span></u>2006-11-06</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:3.9pt;
margin-left:0in;text-indent:0in'><a
href="https://en.wikipedia.org/wiki/.NET_Framework_version_history#.NET_Framework_3.5"><span
style='color:#1889D0'>3.5</span></a><u><span style='color:#1889D0'> </span></u>2007-11-19</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:3.9pt;
margin-left:1.05pt'><a
href="https://en.wikipedia.org/wiki/.NET_Framework_version_history#Service_Pack_1"><span
style='color:#1889D0'>3.5 SP1</span></a><u><span style='color:#1889D0'> </span></u>2008-08-11</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:3.9pt;
margin-left:0in;text-indent:0in'><a
href="https://en.wikipedia.org/wiki/.NET_Framework_version_history#.NET_Framework_4"><span
style='color:#1889D0'>4.0</span></a><u><span style='color:#1889D0'> </span></u>2010-04-12</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:3.9pt;
margin-left:0in;text-indent:0in'><a
href="https://en.wikipedia.org/wiki/.NET_Framework_version_history#.NET_Framework_4.5"><span
style='color:#1889D0'>4.5</span></a><u><span style='color:#1889D0'> </span></u>2012-08-15</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:3.9pt;
margin-left:0in;text-indent:0in'><a
href="https://en.wikipedia.org/wiki/.NET_Framework_version_history#.NET_Framework_4.5.1"><span
style='color:#1889D0'>4.5.1</span></a><u><span style='color:#1889D0'> </span></u>2013-10-17</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:3.9pt;
margin-left:0in;text-indent:0in'><a
href="https://en.wikipedia.org/wiki/.NET_Framework_version_history#.NET_Framework_4.5.2"><span
style='color:#1889D0'>4.5.2</span></a><u><span style='color:#1889D0'> </span></u>2014-05-05</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:3.9pt;
margin-left:0in;text-indent:0in'><a
href="https://en.wikipedia.org/wiki/.NET_Framework_version_history#.NET_Framework_4.6"><span
style='color:#1889D0'>4.6</span></a><u><span style='color:#1889D0'> </span></u>2015-07-20</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:3.9pt;
margin-left:0in;text-indent:0in'><a
href="https://en.wikipedia.org/wiki/.NET_Framework_version_history#.NET_Framework_4.6.1"><span
style='color:#1889D0'>4.6.1</span></a><u><span style='color:#1889D0'> </span></u>2015-11-17</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:3.9pt;
margin-left:0in;text-indent:0in'><a
href="https://en.wikipedia.org/wiki/.NET_Framework_version_history#.NET_Framework_4.6.2"><span
style='color:#1889D0'>4.6.2</span></a><u><span style='color:#1889D0'> </span></u>2016-08-02</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:3.9pt;
margin-left:0in;text-indent:0in'><a
href="https://en.wikipedia.org/wiki/.NET_Framework_version_history#.NET_Framework_4.7"><span
style='color:#1889D0'>4.7</span></a><u><span style='color:#1889D0'> </span></u>2017-04-05</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:4.15pt;
margin-left:0in;text-indent:0in'><a
href="https://blogs.msdn.microsoft.com/dotnet/2017/10/17/announcing-the-net-framework-4-7-1/"><span
style='color:#1889D0'>4.7.1</span></a><u><span style='color:#1889D0'> </span></u>2017-10-17</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:2.1pt;
margin-left:.75pt;line-height:107%'><b>Compact Framework</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:1.35pt;
margin-left:.75pt;line-height:107%'><b>Version Release Date</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:3.9pt;
margin-left:0in;text-indent:0in'>1.0 2000-01-01</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:3.9pt;
margin-left:0in;text-indent:0in'>2.0 2005-10-01</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:3.9pt;
margin-left:0in;text-indent:0in'>3.5 2007-11-19</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:3.9pt;
margin-left:0in;text-indent:0in'>3.7 2009-01-01</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:4.15pt;
margin-left:0in;text-indent:0in'>3.9 2013-06-01</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:2.1pt;
margin-left:.75pt;line-height:107%'><b>Micro Framework</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:1.35pt;
margin-left:.75pt;line-height:107%'><b>Version Release Date</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:3.9pt;
margin-left:0in;text-indent:0in'>4.2 2011-10-04</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:3.9pt;
margin-left:0in;text-indent:0in'>4.3 2012-12-04</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:20.85pt;
margin-left:0in;text-indent:0in'>4.4 2015-10-20</p>

<h3 style='margin-left:-.25pt'>Section 1.1: Hello World in C#</h3>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=191
src=".NET%20Framework%20Notes%20for%20Professionals_files/image004.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=122 style='width:91.8pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=122 valign=top style='width:91.8pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Console</span><span style='font-size:9.0pt;line-height:107%;color:#666666'>.</span><span
  style='font-size:9.0pt;line-height:107%'>WriteLine</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal align=right style='margin-top:0in;margin-right:8.25pt;
margin-bottom:1.85pt;margin-left:.5pt;text-align:right;line-height:107%'>has
several overloads. In this case, the string &quot;Hello World&quot; is the
parameter, and it will output</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=65 style='width:48.6pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=65 valign=top style='width:48.6pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666'>.</span><span style='font-size:9.0pt;line-height:107%'>ToString</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt;line-height:215%'>the &quot;Hello World&quot; to the
standard out stream during execution. Other overloads may call the of the
argument before writing to the stream. See the <a
href="https://msdn.microsoft.com/en-us/library/system.console.writeline"><span
style='color:#1889D0'>.NET Framework Documentation</span></a> for more
information. <a href="https://dotnetfiddle.net/S7hjxp"><span style='color:#1889D0'>Live
Demo in Action at .NET Fiddle</span></a></p>

<h3 style='margin-top:0in;margin-right:290.3pt;margin-bottom:0in;margin-left:
-.25pt;margin-bottom:.0001pt;line-height:145%'><span style='font-size:10.0pt;
line-height:145%;color:black;font-weight:normal'>Introduction to C# </span>Section
1.2: Hello World in F#</h3>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=109
src=".NET%20Framework%20Notes%20for%20Professionals_files/image005.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.05pt;
margin-left:-.25pt;line-height:107%'><a href="https://dotnetfiddle.net/hDvqwC"><span
style='color:#1889D0'>Live Demo in Action at .NET Fiddle</span></a></p>

<h3 style='margin-top:0in;margin-right:166.8pt;margin-bottom:0in;margin-left:
-.25pt;margin-bottom:.0001pt;line-height:145%'><span style='font-size:10.0pt;
line-height:145%;color:black;font-weight:normal'>Introduction to F# </span>Section
1.3: Hello World in Visual Basic .NET</h3>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=125
src=".NET%20Framework%20Notes%20for%20Professionals_files/image006.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.05pt;
margin-left:-.25pt;line-height:107%'><a href="https://dotnetfiddle.net/dRDZVe"><span
style='color:#1889D0'>Live Demo in Action at .NET Fiddle</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:18.65pt;
margin-left:1.05pt'>Introduction to Visual Basic .NET</p>

<h3 style='margin-left:-.25pt'>Section 1.4: Hello World in C++/CLI</h3>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=109
src=".NET%20Framework%20Notes%20for%20Professionals_files/image007.gif"></span></p>

<h3 style='margin-left:-.25pt'>Section 1.5: Hello World in IL</h3>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=226
src=".NET%20Framework%20Notes%20for%20Professionals_files/image008.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=169
src=".NET%20Framework%20Notes%20for%20Professionals_files/image009.gif"></span></p>

<h3 style='margin-left:-.25pt'>Section 1.6: Hello World in PowerShell</h3>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src=".NET%20Framework%20Notes%20for%20Professionals_files/image010.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:18.65pt;
margin-left:1.05pt'>Introduction to PowerShell</p>

<h3 style='margin-left:-.25pt'>Section 1.7: Hello World in Nemerle</h3>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src=".NET%20Framework%20Notes%20for%20Professionals_files/image011.gif"></span></p>

<h3 style='margin-left:-.25pt'>Section 1.8: Hello World in Python (IronPython)</h3>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=86
src=".NET%20Framework%20Notes%20for%20Professionals_files/image012.gif"></span></p>

<h3 style='margin-left:-.25pt'>Section 1.9: Hello World in Oxygene</h3>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=306
src=".NET%20Framework%20Notes%20for%20Professionals_files/image013.gif"></span></p>

<h3 style='margin-left:-.25pt'>Section 1.10: Hello World in Boo</h3>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=26
src=".NET%20Framework%20Notes%20for%20Professionals_files/image014.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.15pt;
margin-left:-.25pt;line-height:110%'><b><span style='font-size:26.0pt;
line-height:110%;color:#1889D0'>Chapter 2: Strings</span></b></p>

<h3 style='margin-top:0in;margin-right:0in;margin-bottom:2.5pt;margin-left:
-.25pt'>Section 2.1: Count characters</h3>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=79 style='width:59.4pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=43 valign=top style='width:.45in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>System</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>.</span></p>
  </td>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#0600FF'>Char</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>If you need to count <i>characters</i> then, for the
reasons explained in <i>Remarks</i> section, you can't simply use Length
property because it's the length of the array of which are not characters but
code-units (not Unicode code-points nor graphemes). Correct code is then:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src=".NET%20Framework%20Notes%20for%20Professionals_files/image015.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=137 style='width:102.6pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=137 valign=top style='width:102.6pt;background:#FAFAFA;padding:
  1.8pt 0in 0in 0in;height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>EnumerateCharacters</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>A small optimization may rewrite <span style='font-size:
9.0pt;line-height:109%;color:#666666;background:#FAFAFA'>()</span> extension
method specifically for this purpose:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=256
src=".NET%20Framework%20Notes%20for%20Professionals_files/image016.gif"></span></p>

<h3 style='margin-top:0in;margin-right:0in;margin-bottom:2.5pt;margin-left:
-.25pt'>Section 2.2: Count distinct characters</h3>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>If you need to count distinct characters then, for the
reasons explained in <i>Remarks</i> section, you can't simply use</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=79 style='width:59.4pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=43 valign=top style='width:.45in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>System</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>.</span></p>
  </td>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#0600FF'>Char</span></p>
  </td>
 </tr>
</table>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=151 style='width:113.4pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>text</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>.</span></p>
  </td>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Distinct</span></p>
  </td>
  <td width=22 valign=top style='width:16.2pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>().</span></p>
  </td>
  <td width=36 valign=top style='width:27.0pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Count</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'><span style='font-size:9.0pt;line-height:109%;background:
#FAFAFA'>Length</span> property because it's the length of the array of which
are not characters but code-units (not Unicode code-points nor graphemes). If,
for example, you simply write <span style='font-size:9.0pt;line-height:109%;
color:#666666;background:#FAFAFA'>()</span> you will get incorrect results,
correct code:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src=".NET%20Framework%20Notes%20for%20Professionals_files/image017.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:14.15pt;
margin-left:1.05pt'>One step further is to <b>count occurrences of each
character</b>, if performance aren't an issue you may simply do it like this
(in this example regardless of case):</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%;color:#0600FF'>var</span><span style='font-size:9.0pt;line-height:110%'>
frequencies </span><span style='font-size:9.0pt;line-height:110%;color:#666666'>=</span><span
style='font-size:9.0pt;line-height:110%'> text</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>.</span><span style='font-size:9.0pt;
line-height:110%'>EnumerateCharacters</span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>()</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>GroupBy</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>(</span><span style='font-size:9.0pt;
line-height:110%'>x </span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>=&gt;</span><span style='font-size:9.0pt;line-height:110%'> x,
StringComparer</span><span style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>CurrentCultureIgnoreCase</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:23.0pt;
margin-left:3.5pt;line-height:110%'><span style='position:relative;z-index:
-1895823360'><span style='left:0px;position:absolute;left:0px;top:-42px;
width:718px;height:59px'><img width=718 height=59
src=".NET%20Framework%20Notes%20for%20Professionals_files/image018.gif"></span></span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>.</span><span style='font-size:9.0pt;
line-height:110%;color:#0600FF'>Select</span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>(</span><span style='font-size:9.0pt;
line-height:110%'>x </span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>=&gt;</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>new</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>{</span><span style='font-size:9.0pt;
line-height:110%'> Character </span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>=</span><span style='font-size:9.0pt;line-height:110%'> x</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>Key, Count </span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>=</span><span
style='font-size:9.0pt;line-height:110%'> x</span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>.</span><span style='font-size:9.0pt;
line-height:110%'>Count</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>()</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>};</span></p>

<h3 style='margin-top:0in;margin-right:0in;margin-bottom:2.5pt;margin-left:
-.25pt'>Section 2.3: Convert string to/from another encoding</h3>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=79 style='width:59.4pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=43 valign=top style='width:.45in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>System</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>.</span></p>
  </td>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#0600FF'>Char</span></p>
  </td>
 </tr>
</table>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=79 style='width:59.4pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=43 valign=top style='width:.45in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>System</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>.</span></p>
  </td>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#0600FF'>Byte</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.55pt;
margin-left:1.05pt'>.NET strings contain (UTF-16 code-units). If you want to
save (or manage) text with another encoding you have to work with an array of .</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=304 style='width:228.25pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=79 valign=top style='width:59.4pt;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>System.Text</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>.</span></p>
  </td>
  <td width=50 valign=top style='width:37.8pt;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Encoder</span></p>
  </td>
  <td width=31 valign=top style='width:23.05pt;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'>and </p>
  </td>
  <td width=79 valign=top style='width:59.4pt;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>System.Text</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>.</span></p>
  </td>
  <td width=50 valign=top style='width:37.8pt;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Decoder</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>Conversions are performed by classes derived from which,</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=29 style='width:.3in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#0600FF'>byte</span></p>
  </td>
 </tr>
</table>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=94 style='width:70.2pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=43 valign=top style='width:.45in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>System</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>.</span></p>
  </td>
  <td width=43 valign=top style='width:.45in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#0600FF'>String</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:20.8pt;margin-bottom:
12.55pt;margin-left:70.75pt;text-indent:-70.2pt'>together, can convert to/from
another encoding (from a byte <i>X</i> encoded array <span style='font-size:
9.0pt;line-height:109%;color:#666666;background:#FAFAFA'>[]</span> to an UTF-16
encoded and vice-versa).</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=144 style='width:1.5in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=79 valign=top style='width:59.4pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>System.Text</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>.</span></p>
  </td>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Encoding</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.8pt;
margin-left:1.05pt'>Because the encoder/decoder usually works very close to
each other they're grouped together in a class derived from , derived classes
offer conversions to/from popular encodings (UTF-8, UTF-16 and so on).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:2.35pt;
margin-left:.75pt;line-height:107%'><b>Examples:</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:.75pt;line-height:107%'><b>Convert a string to UTF-8</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:19.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src=".NET%20Framework%20Notes%20for%20Professionals_files/image019.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:19.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=42
src=".NET%20Framework%20Notes%20for%20Professionals_files/image020.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.35pt;
margin-left:.75pt;line-height:107%'><b>Change encoding of an existing text file</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>This code will read content of an UTF-8 encoded text file
and save it back encoded as UTF-16. Note that this code is not optimal if file
is big because it will read all its content into memory:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src=".NET%20Framework%20Notes%20for%20Professionals_files/image021.gif"></span></p>

<h3 style='margin-top:0in;margin-right:0in;margin-bottom:2.6pt;margin-left:
-.25pt'>Section 2.4: Comparing strings</h3>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:13.0pt;
margin-left:1.05pt'>Despite <span style='font-size:9.0pt;line-height:109%;
color:#0600FF;background:#FAFAFA'>String</span> is a reference type <span
style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>==</span> operator
compares string values rather than references.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.6pt;
margin-left:1.05pt'>As you may know <span style='font-size:9.0pt;line-height:
109%;color:#0600FF;background:#FAFAFA'>string</span> is just an array of
characters. But if you think that strings equality check and comparison is made
character by character, you are mistaken. This operation is culture specific
(see Remarks below): some character sequences can be treated as equal depending
on the <a
href="https://msdn.microsoft.com/en-us/library/system.globalization.cultureinfo.currentculture(v=vs.110).aspx"><span
style='color:#1889D0'>culture</span></a>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:13.1pt;
margin-left:1.05pt'>Think twice before short circuiting equality check by
comparing <span style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>Length</span>
<a href="https://msdn.microsoft.com/library/system.string.length(v=vs.110).aspx"><span
style='color:#1889D0'>properties</span></a> of two strings!</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=94 style='width:70.2pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=43 valign=top style='width:.45in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#0600FF'>String</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>.</span></p>
  </td>
  <td width=43 valign=top style='width:.45in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Equals</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:25.65pt;margin-bottom:
.25pt;margin-left:-.25pt;text-align:justify;text-justify:inter-ideograph;
line-height:135%'>Use overloads of <a
href="https://msdn.microsoft.com/en-us/library/t4411bks(v=vs.110).aspx"><span
style='color:#1889D0'>method</span></a> which accept additional <span
style='font-size:9.0pt;line-height:135%;background:#FAFAFA'>StringComparison</span>
<a
href="https://msdn.microsoft.com/en-us/library/system.stringcomparison(v=vs.110).aspx"><span
style='color:#1889D0'>enumeration</span></a> value, if you need to change
default behavior. <b><span style='font-size:18.0pt;line-height:135%;color:#1889D0'>Section
2.5: Count occurrences of a character</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>Because of the reasons explained in <i>Remarks</i> section
you can't simply do this (unless you want to count occurrences of a specific
code-unit):</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src=".NET%20Framework%20Notes%20for%20Professionals_files/image022.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>You need a more complex function:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=92
src=".NET%20Framework%20Notes%20for%20Professionals_files/image023.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:39.0pt;margin-bottom:
.25pt;margin-left:-.25pt;text-align:justify;text-justify:inter-ideograph;
line-height:135%'>Note that string comparison (in contrast to character
comparison which is culture invariant) must always be performed according to
rules to a specific culture. <b><span style='font-size:18.0pt;line-height:135%;
color:#1889D0'>Section 2.6: Split string into fixed length blocks</span></b></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=79 style='width:59.4pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=43 valign=top style='width:.45in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>System</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>.</span></p>
  </td>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#0600FF'>Char</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>We cannot break a string into arbitrary points (because a
may not be valid alone because it's a combining character or part of a
surrogate) then code must take that into account (note that with <i>length</i>
I mean the number of <i>graphemes</i> not the number of <i>code-units</i>):</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=289
src=".NET%20Framework%20Notes%20for%20Professionals_files/image024.gif"></span></p>

<h3 style='margin-top:0in;margin-right:0in;margin-bottom:2.6pt;margin-left:
-.25pt'>Section 2.7: Object.ToString() virtual method</h3>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=58 style='width:.6in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>ToString</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>Everything in .NET is an object, hence every type has <span
style='font-size:9.0pt;line-height:109%;color:#666666;background:#FAFAFA'>()</span>
<a
href="https://msdn.microsoft.com/en-us/library/system.object.tostring(v=vs.110).aspx"><span
style='color:#1889D0'>method</span></a> defined in <span style='font-size:9.0pt;
line-height:109%;color:#0600FF;background:#FAFAFA'>Object</span> <a
href="https://msdn.microsoft.com/en-us/library/system.object(v=vs.110).aspx"><span
style='color:#1889D0'>class</span></a> which can be overridden. Default
implementation of this method just returns the name of the type:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=109
src=".NET%20Framework%20Notes%20for%20Professionals_files/image025.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=58 style='width:.6in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>ToString</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:43.7pt'><span style='font-size:9.0pt;line-height:109%;color:#666666;
background:#FAFAFA'>()</span> is implicitly called when concatinating value
with a string:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=174
src=".NET%20Framework%20Notes%20for%20Professionals_files/image026.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>The result of this method is also extensively used by
debugging tools. If, for some reason, you do not want to override this method,
but want to customize how debugger shows the value of your type, use
DebuggerDisplay Attribute (<a
href="https://msdn.microsoft.com/en-us/library/system.diagnostics.debuggerdisplayattribute(v=vs.110).aspx"><span
style='color:#1889D0'>MSDN</span></a>):</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=142
src=".NET%20Framework%20Notes%20for%20Professionals_files/image027.gif"></span></p>

<h3 style='margin-top:0in;margin-right:0in;margin-bottom:2.5pt;margin-left:
-.25pt'>Section 2.8: Immutability of strings</h3>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>Strings are immutable. You just cannot change existing
string. Any operation on the string crates a new instance of the string having
new value. It means that if you need to replace a single character in a very
long string, memory will be allocated for a new value.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=720 height=60
src=".NET%20Framework%20Notes%20for%20Professionals_files/image028.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>If you need to perform many operations with string value,
use <span style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>StringBuilder</span><a
href="https://msdn.microsoft.com/en-us/library/system.text.stringbuilder(v=vs.110).aspx"><span
style='color:black;text-decoration:none'> </span></a><a
href="https://msdn.microsoft.com/en-us/library/system.text.stringbuilder(v=vs.110).aspx"><span
style='color:#1889D0'>class</span></a> which is designed for efficient strings
manipulation:</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=109
src=".NET%20Framework%20Notes%20for%20Professionals_files/image029.gif"></span><br
clear=all style='page-break-before:always'>
</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.15pt;
margin-left:-.25pt;line-height:110%'><b><span style='font-size:26.0pt;
line-height:110%;color:#1889D0'>Chapter 3: DateTime parsing</span></b></p>

<h3 style='margin-left:-.25pt'>Section 3.1: ParseExact</h3>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=142
src=".NET%20Framework%20Notes%20for%20Professionals_files/image030.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=187 style='width:1.95in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=79 valign=top style='width:59.4pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>CultureInfo</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>.</span></p>
  </td>
  <td width=101 valign=top style='width:1.05in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>CurrentCulture</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.8pt;
margin-left:1.05pt'>Note that passing as the third parameter is identical to
passing <span style='font-size:9.0pt;line-height:109%;color:#0600FF;background:
#FAFAFA'>null</span>. Or, you can pass a specific culture.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.35pt;
margin-left:.75pt;line-height:107%'><b>Format Strings</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.15pt;margin-bottom:
.15pt;margin-left:-.25pt;line-height:107%'><i>Input string can be in any format
that matches the format string</i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=109
src=".NET%20Framework%20Notes%20for%20Professionals_files/image031.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.15pt;margin-bottom:
.15pt;margin-left:-.25pt;line-height:107%'><i>Any characters that are not
format specifiers are treated as literals</i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=109
src=".NET%20Framework%20Notes%20for%20Professionals_files/image032.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.15pt;margin-bottom:
.15pt;margin-left:-.25pt;line-height:107%'><i>Case matters for format
specifiers</i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=109
src=".NET%20Framework%20Notes%20for%20Professionals_files/image033.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.9pt;
margin-left:1.05pt'>Note that the month and minute values were parsed into the
wrong destinations.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.15pt;margin-bottom:
14.65pt;margin-left:-.25pt;line-height:107%'><i>Single-character format strings
must be one of the standard formats</i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:124.4pt;margin-bottom:
17.45pt;margin-left:3.5pt;line-height:110%'><span style='position:relative;
z-index:-1895822336'><span style='left:0px;position:absolute;left:0px;
top:-9px;width:718px;height:59px'><img width=718 height=59
src=".NET%20Framework%20Notes%20for%20Professionals_files/image034.gif"></span></span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>var</span><span
style='font-size:9.0pt;line-height:110%'> date </span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>=</span><span style='font-size:9.0pt;
line-height:110%'> DateTime</span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%'>ParseExact</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%;color:#A60000'>&quot;11/24/2015&quot;</span><span
style='font-size:9.0pt;line-height:110%'>, </span><span style='font-size:9.0pt;
line-height:110%;color:#A60000'>&quot;d&quot;</span><span style='font-size:
9.0pt;line-height:110%'>, </span><span style='font-size:9.0pt;line-height:110%;
color:#0600FF'>new</span><span style='font-size:9.0pt;line-height:110%'>
CultureInfo</span><span style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%;color:#A60000'>&quot;en-US&quot;</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>)); </span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>var</span><span
style='font-size:9.0pt;line-height:110%'> date </span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>=</span><span style='font-size:9.0pt;
line-height:110%'> DateTime</span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%'>ParseExact</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%;color:#A60000'>&quot;2015-11-24T10:15:45&quot;</span><span
style='font-size:9.0pt;line-height:110%'>, </span><span style='font-size:9.0pt;
line-height:110%;color:#A60000'>&quot;s&quot;</span><span style='font-size:
9.0pt;line-height:110%'>, </span><span style='font-size:9.0pt;line-height:110%;
color:#0600FF'>null</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>); </span><span style='font-size:9.0pt;line-height:110%;
color:#0600FF'>var</span><span style='font-size:9.0pt;line-height:110%'> date </span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>=</span><span
style='font-size:9.0pt;line-height:110%'> DateTime</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>ParseExact</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%;color:#A60000'>&quot;2015-11-24
10:15:45Z&quot;</span><span style='font-size:9.0pt;line-height:110%'>, </span><span
style='font-size:9.0pt;line-height:110%;color:#A60000'>&quot;u&quot;</span><span
style='font-size:9.0pt;line-height:110%'>, </span><span style='font-size:9.0pt;
line-height:110%;color:#0600FF'>null</span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>);</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.35pt;
margin-left:.75pt;line-height:107%'><b>Exceptions</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.15pt;margin-bottom:
.15pt;margin-left:-.25pt;line-height:107%'><i>ArgumentNullException</i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:210.8pt;margin-bottom:
17.2pt;margin-left:3.5pt;line-height:110%'><span style='position:relative;
z-index:-1895821312'><span style='left:0px;position:absolute;left:0px;
top:-8px;width:718px;height:43px'><img width=718 height=43
src=".NET%20Framework%20Notes%20for%20Professionals_files/image035.gif"></span></span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>var</span><span
style='font-size:9.0pt;line-height:110%'> date </span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>=</span><span style='font-size:9.0pt;
line-height:110%'> DateTime</span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%'>ParseExact</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>null</span><span
style='font-size:9.0pt;line-height:110%'>, </span><span style='font-size:9.0pt;
line-height:110%;color:#A60000'>&quot;yyyy-MM-dd&quot;</span><span
style='font-size:9.0pt;line-height:110%'>, </span><span style='font-size:9.0pt;
line-height:110%;color:#0600FF'>null</span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>); </span><span style='font-size:9.0pt;
line-height:110%;color:#0600FF'>var</span><span style='font-size:9.0pt;
line-height:110%'> date </span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>=</span><span style='font-size:9.0pt;line-height:110%'> DateTime</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>ParseExact</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%;color:#A60000'>&quot;2015-11-24&quot;</span><span
style='font-size:9.0pt;line-height:110%'>, </span><span style='font-size:9.0pt;
line-height:110%;color:#0600FF'>null</span><span style='font-size:9.0pt;
line-height:110%'>, </span><span style='font-size:9.0pt;line-height:110%;
color:#0600FF'>null</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>);</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.15pt;margin-bottom:
14.65pt;margin-left:-.25pt;line-height:107%'><i>FormatException</i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:183.8pt;margin-bottom:
12.45pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;color:#0600FF'>var</span><span style='font-size:9.0pt;
line-height:110%'> date </span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>=</span><span style='font-size:9.0pt;line-height:110%'> DateTime</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>ParseExact</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%;color:#A60000'>&quot;&quot;</span><span
style='font-size:9.0pt;line-height:110%'>, </span><span style='font-size:9.0pt;
line-height:110%;color:#A60000'>&quot;yyyy-MM-dd&quot;</span><span
style='font-size:9.0pt;line-height:110%'>, </span><span style='font-size:9.0pt;
line-height:110%;color:#0600FF'>null</span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>); </span><span style='font-size:9.0pt;
line-height:110%;color:#0600FF'>var</span><span style='font-size:9.0pt;
line-height:110%'> date </span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>=</span><span style='font-size:9.0pt;line-height:110%'> DateTime</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>ParseExact</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%;color:#A60000'>&quot;2015-11-24&quot;</span><span
style='font-size:9.0pt;line-height:110%'>, </span><span style='font-size:9.0pt;
line-height:110%;color:#A60000'>&quot;&quot;</span><span style='font-size:9.0pt;
line-height:110%'>, </span><span style='font-size:9.0pt;line-height:110%;
color:#0600FF'>null</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>); </span><span style='font-size:9.0pt;line-height:110%;
color:#0600FF'>var</span><span style='font-size:9.0pt;line-height:110%'> date </span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>=</span><span
style='font-size:9.0pt;line-height:110%'> DateTime</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>ParseExact</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%;color:#A60000'>&quot;2015-0C-24&quot;</span><span
style='font-size:9.0pt;line-height:110%'>, </span><span style='font-size:9.0pt;
line-height:110%;color:#A60000'>&quot;yyyy-MM-dd&quot;</span><span
style='font-size:9.0pt;line-height:110%'>, </span><span style='font-size:9.0pt;
line-height:110%;color:#0600FF'>null</span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>); </span><span style='font-size:9.0pt;
line-height:110%;color:#0600FF'>var</span><span style='font-size:9.0pt;
line-height:110%'> date </span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>=</span><span style='font-size:9.0pt;line-height:110%'> DateTime</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>ParseExact</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%;color:#A60000'>&quot;2015-11-24&quot;</span><span
style='font-size:9.0pt;line-height:110%'>, </span><span style='font-size:9.0pt;
line-height:110%;color:#A60000'>&quot;yyyy-QQ-dd&quot;</span><span
style='font-size:9.0pt;line-height:110%'>, </span><span style='font-size:9.0pt;
line-height:110%;color:#0600FF'>null</span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>);</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:148.8pt;margin-bottom:
12.45pt;margin-left:3.5pt;line-height:110%'><i><span style='font-size:9.0pt;
line-height:110%;color:darkgreen'>// Single-character format strings must be
one of the standard formats </span></i><span style='font-size:9.0pt;line-height:
110%;color:#0600FF'>var</span><span style='font-size:9.0pt;line-height:110%'>
date </span><span style='font-size:9.0pt;line-height:110%;color:#666666'>=</span><span
style='font-size:9.0pt;line-height:110%'> DateTime</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>ParseExact</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%;color:#A60000'>&quot;2015-11-24&quot;</span><span
style='font-size:9.0pt;line-height:110%'>, </span><span style='font-size:9.0pt;
line-height:110%;color:#A60000'>&quot;q&quot;</span><span style='font-size:
9.0pt;line-height:110%'>, </span><span style='font-size:9.0pt;line-height:110%;
color:#0600FF'>null</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>);</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:20.95pt;margin-bottom:
17.45pt;margin-left:3.5pt;line-height:110%'><span style='position:relative;
z-index:-1895820288'><span style='left:0px;position:absolute;left:0px;
top:-139px;width:718px;height:191px'><img width=718 height=191
src=".NET%20Framework%20Notes%20for%20Professionals_files/image036.gif"></span></span><i><span
style='font-size:9.0pt;line-height:110%;color:darkgreen'>// Format strings must
match the input exactly* (see next section) </span></i><span style='font-size:
9.0pt;line-height:110%;color:#0600FF'>var</span><span style='font-size:9.0pt;
line-height:110%'> date </span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>=</span><span style='font-size:9.0pt;line-height:110%'> DateTime</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>ParseExact</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%;color:#A60000'>&quot;2015-11-24&quot;</span><span
style='font-size:9.0pt;line-height:110%'>, </span><span style='font-size:9.0pt;
line-height:110%;color:#A60000'>&quot;d&quot;</span><span style='font-size:
9.0pt;line-height:110%'>, </span><span style='font-size:9.0pt;line-height:110%;
color:#0600FF'>null</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>);</span><span style='font-size:9.0pt;line-height:110%'> </span><i><span
style='font-size:9.0pt;line-height:110%;color:darkgreen'>// Expects 11/24/2015
or 24/11/2015 for most cultures</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:.75pt;line-height:107%'><b>Handling multiple possible formats</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%;color:#0600FF'>var</span><span style='font-size:9.0pt;line-height:110%'>
date </span><span style='font-size:9.0pt;line-height:110%;color:#666666'>=</span><span
style='font-size:9.0pt;line-height:110%'> DateTime</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>ParseExact</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%;color:#A60000'>&quot;2015-11-24T10:15:45&quot;</span><span
style='font-size:9.0pt;line-height:110%'>,</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:7.55pt;
margin-left:3.5pt;line-height:110%'><span style='position:relative;z-index:
-1895819264'><span style='left:0px;position:absolute;left:0px;top:-24px;
width:718px;height:59px'><img width=718 height=59
src=".NET%20Framework%20Notes%20for%20Professionals_files/image037.gif"></span></span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#0600FF'>new</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>[]</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>{</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#A60000'>&quot;s&quot;</span><span style='font-size:
9.0pt;line-height:110%'>, </span><span style='font-size:9.0pt;line-height:110%;
color:#A60000'>&quot;t&quot;</span><span style='font-size:9.0pt;line-height:
110%'>, </span><span style='font-size:9.0pt;line-height:110%;color:#A60000'>&quot;u&quot;</span><span
style='font-size:9.0pt;line-height:110%'>, </span><span style='font-size:9.0pt;
line-height:110%;color:#A60000'>&quot;yyyy-MM-dd&quot;</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>}</span><span style='font-size:9.0pt;
line-height:110%'>, </span><i><span style='font-size:9.0pt;line-height:110%;
color:darkgreen'>// Will succeed as long as input matches one of these </span></i><span
style='font-size:9.0pt;line-height:110%'>CultureInfo</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>CurrentCulture, DateTimeStyles</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>None</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>);</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=278
src=".NET%20Framework%20Notes%20for%20Professionals_files/image038.gif"></span></p>

<h3 style='margin-top:0in;margin-right:0in;margin-bottom:2.6pt;margin-left:
-.25pt'>Section 3.2: TryParse</h3>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.6pt;
margin-left:1.05pt'>This method accepts a string as input, attempts to parse it
into a <span style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>DateTime</span>,
and returns a Boolean result indicating success or failure. If the call
succeeds, the variable passed as the <span style='font-size:9.0pt;line-height:
109%;color:#0600FF;background:#FAFAFA'>out</span> parameter is populated with
the parsed result.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=122 style='width:91.8pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>DateTime</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>.</span></p>
  </td>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>MinValue</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:13.15pt;
margin-left:1.05pt'>If the parse fails, the variable passed as the <span
style='font-size:9.0pt;line-height:109%;color:#0600FF;background:#FAFAFA'>out</span>
parameter is set to the default value, .</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:.75pt;line-height:107%'><b>TryParse(string, out DateTime)</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=109
src=".NET%20Framework%20Notes%20for%20Professionals_files/image039.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:14.55pt;
margin-left:1.05pt'>This method attempts to parse the input string based on the
system regional settings and known formats such as ISO 8601 and other common
formats.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:22.65pt;margin-bottom:
.2pt;margin-left:3.5pt;line-height:110%'><span style='position:relative;
z-index:-1895818240'><span style='left:0px;position:absolute;left:0px;
top:-8px;width:718px;height:76px'><img width=718 height=76
src=".NET%20Framework%20Notes%20for%20Professionals_files/image040.gif"></span></span><span
style='font-size:9.0pt;line-height:110%'>DateTime</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>.</span><span style='font-size:9.0pt;
line-height:110%'>TryParse</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>(</span><span style='font-size:9.0pt;line-height:110%;
color:#A60000'>&quot;11/24/2015 14:28:42&quot;</span><span style='font-size:
9.0pt;line-height:110%'>, </span><span style='font-size:9.0pt;line-height:110%;
color:#0600FF'>out</span><span style='font-size:9.0pt;line-height:110%'>
parsedValue</span><span style='font-size:9.0pt;line-height:110%;color:#666666'>);</span><span
style='font-size:9.0pt;line-height:110%'> </span><i><span style='font-size:
9.0pt;line-height:110%;color:darkgreen'>// true </span></i><span
style='font-size:9.0pt;line-height:110%'>DateTime</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>.</span><span style='font-size:9.0pt;
line-height:110%'>TryParse</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>(</span><span style='font-size:9.0pt;line-height:110%;
color:#A60000'>&quot;2015-11-24 14:28:42&quot;</span><span style='font-size:
9.0pt;line-height:110%'>, </span><span style='font-size:9.0pt;line-height:110%;
color:#0600FF'>out</span><span style='font-size:9.0pt;line-height:110%'>
parsedValue</span><span style='font-size:9.0pt;line-height:110%;color:#666666'>);</span><span
style='font-size:9.0pt;line-height:110%'> </span><i><span style='font-size:
9.0pt;line-height:110%;color:darkgreen'>// true</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%'>DateTime</span><span style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>TryParse</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>(</span><span style='font-size:9.0pt;
line-height:110%;color:#A60000'>&quot;2015-11-24T14:28:42&quot;</span><span
style='font-size:9.0pt;line-height:110%'>, </span><span style='font-size:9.0pt;
line-height:110%;color:#0600FF'>out</span><span style='font-size:9.0pt;
line-height:110%'> parsedValue</span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>);</span><span style='font-size:9.0pt;line-height:110%'> </span><i><span
style='font-size:9.0pt;line-height:110%;color:darkgreen'>// true</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:17.25pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%'>DateTime</span><span style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>TryParse</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>(</span><span style='font-size:9.0pt;
line-height:110%;color:#A60000'>&quot;Sat, 24 Nov 2015 14:28:42&quot;</span><span
style='font-size:9.0pt;line-height:110%'>, </span><span style='font-size:9.0pt;
line-height:110%;color:#0600FF'>out</span><span style='font-size:9.0pt;
line-height:110%'> parsedValue</span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>);</span><span style='font-size:9.0pt;line-height:110%'> </span><i><span
style='font-size:9.0pt;line-height:110%;color:darkgreen'>// true</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>Since this method does not accept culture info, it uses the
system locale. This can lead to unexpected results.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=403
src=".NET%20Framework%20Notes%20for%20Professionals_files/image041.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:13.15pt;
margin-left:1.05pt'>Note that if you are in the US, you might be surprised that
the parsed result is November 10, not October 11.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:.75pt;line-height:107%'><b>TryParse(string, IFormatProvider,
DateTimeStyles, out DateTime)</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%;color:#0600FF'>if</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%'>DateTime</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>.</span><span style='font-size:9.0pt;
line-height:110%'>TryParse</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>(</span><span style='font-size:9.0pt;line-height:110%;
color:#A60000'>&quot; monkey &quot;</span><span style='font-size:9.0pt;
line-height:110%'>, </span><span style='font-size:9.0pt;line-height:110%;
color:#0600FF'>new</span><span style='font-size:9.0pt;line-height:110%'>
CultureInfo</span><span style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%;color:#A60000'>&quot;en-GB&quot;</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>)</span><span
style='font-size:9.0pt;line-height:110%'>,</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;line-height:110%'><span style='position:relative;z-index:
-1895817216'><span style='left:0px;position:absolute;left:0px;top:-25px;
width:718px;height:92px'><img width=718 height=92
src=".NET%20Framework%20Notes%20for%20Professionals_files/image042.gif"></span></span><span
style='font-size:9.0pt;line-height:110%'> DateTimeStyles</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>AllowLeadingWhite </span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>|</span><span
style='font-size:9.0pt;line-height:110%'> DateTimeStyles</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>AllowTrailingWhite, </span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>out</span><span
style='font-size:9.0pt;line-height:110%'> parsedValue</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.25pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%;color:#666666'>{</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:21.85pt;margin-bottom:
.25pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%'> Console</span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%'>WriteLine</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%;color:#A60000'>&quot;Apparently, '
monkey ' is a date/time value. Who knew?&quot;</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>);</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:17.3pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%;color:#666666'>}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.7pt;
margin-left:1.05pt'>Unlike its sibling method, this overload allows a specific
culture and style(s) to be specified. Passing <span style='font-size:9.0pt;
line-height:109%;color:#0600FF;background:#FAFAFA'>null</span> for the <span
style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>IFormatProvider</span>
parameter uses the system culture.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.15pt;margin-bottom:
13.0pt;margin-left:-.25pt;line-height:107%'><i>Exceptions</i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:13.3pt;
margin-left:1.05pt'>Note that it is possible for this method to throw an
exception under certain conditions. These relate to the parameters introduced
for this overload: <span style='font-size:9.0pt;line-height:109%;background:
#FAFAFA'>IFormatProvider</span> and <span style='font-size:9.0pt;line-height:
109%;background:#FAFAFA'>DateTimeStyles</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:2.6pt;
margin-left:21.4pt;line-height:107%'><img width=5 height=25
src=".NET%20Framework%20Notes%20for%20Professionals_files/image043.gif"
align=left hspace=12><span style='font-size:9.0pt;line-height:107%;background:
#FAFAFA'>NotSupportedException</span>: <span style='font-size:9.0pt;line-height:
107%;background:#FAFAFA'>IFormatProvider</span> specifies a neutral culture</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:21.4pt;line-height:131%'><span style='font-size:9.0pt;line-height:
131%;background:#FAFAFA'>ArgumentException</span>: <span style='font-size:9.0pt;
line-height:131%;background:#FAFAFA'>DateTimeStyles</span> is not a valid
option, or contains incompatible flags such as <span style='font-size:9.0pt;
line-height:131%;background:#FAFAFA'>AssumeLocal</span> and <span
style='font-size:9.0pt;line-height:131%;background:#FAFAFA'>AssumeUniversal</span>.</p>

<h3 style='margin-top:0in;margin-right:0in;margin-bottom:2.7pt;margin-left:
-.25pt'>Section 3.3: TryParseExact</h3>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.75pt;
margin-left:1.05pt'>This method behaves as a combination of <span
style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>TryParse</span> and
<span style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>ParseExact</span>:
It allows custom format(s) to be specified, and returns a Boolean result
indicating success or failure rather than throwing an exception if the parse
fails.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.35pt;
margin-left:.75pt;line-height:107%'><b>TryParseExact(string, string,
IFormatProvider, DateTimeStyles, out DateTime)</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:14.2pt;
margin-left:1.05pt'>This overload attempts to parse the input string against a
specific format. The input string must match that format in order to be parsed.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:17.5pt;
margin-left:3.5pt;line-height:110%'><span style='position:relative;z-index:
-1895815168'><span style='left:0px;position:absolute;left:0px;top:-8px;
width:718px;height:26px'><img width=718 height=26
src=".NET%20Framework%20Notes%20for%20Professionals_files/image044.gif"></span></span><span
style='font-size:9.0pt;line-height:110%'>DateTime</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>.</span><span style='font-size:9.0pt;
line-height:110%'>TryParseExact</span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>(</span><span style='font-size:9.0pt;line-height:110%;
color:#A60000'>&quot;11242015&quot;</span><span style='font-size:9.0pt;
line-height:110%'>, </span><span style='font-size:9.0pt;line-height:110%;
color:#A60000'>&quot;MMddyyyy&quot;</span><span style='font-size:9.0pt;
line-height:110%'>, </span><span style='font-size:9.0pt;line-height:110%;
color:#0600FF'>null</span><span style='font-size:9.0pt;line-height:110%'>,
DateTimeStyles</span><span style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>None, </span><span style='font-size:
9.0pt;line-height:110%;color:#0600FF'>out</span><span style='font-size:9.0pt;
line-height:110%'> parsedValue</span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>);</span><span style='font-size:9.0pt;line-height:110%'> </span><i><span
style='font-size:9.0pt;line-height:110%;color:darkgreen'>// true</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.35pt;
margin-left:.75pt;line-height:107%'><b>TryParseExact(string, string[],
IFormatProvider, DateTimeStyles, out DateTime)</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:14.2pt;
margin-left:1.05pt'>This overload attempts to parse the input string against an
array of formats. The input string must match at least one format in order to
be parsed.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;line-height:110%'><span style='position:relative;z-index:
-1895814144'><span style='left:0px;position:absolute;left:0px;top:-8px;
width:718px;height:43px'><img width=718 height=43
src=".NET%20Framework%20Notes%20for%20Professionals_files/image035.gif"></span></span><span
style='font-size:9.0pt;line-height:110%'>DateTime</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>.</span><span style='font-size:9.0pt;
line-height:110%'>TryParseExact</span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>(</span><span style='font-size:9.0pt;line-height:110%;
color:#A60000'>&quot;11242015&quot;</span><span style='font-size:9.0pt;
line-height:110%'>, </span><span style='font-size:9.0pt;line-height:110%;
color:#0600FF'>new</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>[]</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>{</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:#A60000'>&quot;yyyy-MM-dd&quot;</span><span style='font-size:9.0pt;
line-height:110%'>, </span><span style='font-size:9.0pt;line-height:110%;
color:#A60000'>&quot;MMddyyyy&quot;</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>}</span><span style='font-size:9.0pt;line-height:110%'>, </span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>null</span><span
style='font-size:9.0pt;line-height:110%'>, DateTimeStyles</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>None, </span><span style='font-size:
9.0pt;line-height:110%;color:#0600FF'>out</span><span style='font-size:9.0pt;
line-height:110%'> parsedValue</span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>);</span><span style='font-size:9.0pt;line-height:110%'> </span><i><span
style='font-size:9.0pt;line-height:110%;color:darkgreen'>// true</span></i><br
clear=all style='page-break-before:always'>
</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.15pt;
margin-left:-.25pt;line-height:110%'><b><span style='font-size:26.0pt;
line-height:110%;color:#1889D0'>Chapter 4: Dictionaries</span></b></p>

<h3 style='margin-left:-.25pt'>Section 4.1: Initializing a Dictionary with a
Collection Initializer</h3>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=273
src=".NET%20Framework%20Notes%20for%20Professionals_files/image045.gif"></span></p>

<h3 style='margin-left:-.25pt'>Section 4.2: Adding to a Dictionary</h3>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=720 height=158
src=".NET%20Framework%20Notes%20for%20Professionals_files/image046.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>Alternatively they can be added/set via the an indexer. (An
indexer internally looks like a property, having a get and set, but takes a
parameter of any type which is specified between the brackets) :</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=76
src=".NET%20Framework%20Notes%20for%20Professionals_files/image047.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.55pt;
margin-left:1.05pt'>Unlike the <span style='font-size:9.0pt;line-height:109%;
color:#0600FF;background:#FAFAFA'>Add</span> method which throws an exception,
if a key is already contained in the dictionary, the indexer just replaces the
existing value.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=245 style='width:2.55in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=245 valign=top style='width:2.55in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>ConcurrentDictionary</span><span style='font-size:9.0pt;line-height:
  107%;color:#666666'>&lt;</span><span style='font-size:9.0pt;line-height:107%'>TKey,
  TValue</span><span style='font-size:9.0pt;line-height:107%;color:#666666'>&gt;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:14.55pt;
margin-left:1.05pt'>For thread-safe dictionary use :</p>

<p class=MsoNormal style='margin-top:0in;margin-right:156.85pt;margin-bottom:
22.95pt;margin-left:3.5pt;line-height:110%'><span style='position:relative;
z-index:-1895813120'><span style='left:0px;position:absolute;left:0px;
top:-9px;width:718px;height:43px'><img width=718 height=43
src=".NET%20Framework%20Notes%20for%20Professionals_files/image035.gif"></span></span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>var</span><span
style='font-size:9.0pt;line-height:110%'> dict </span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>=</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:#0600FF'>new</span><span style='font-size:9.0pt;line-height:110%'>
ConcurrentDictionary</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>&lt;</span><span style='font-size:9.0pt;line-height:110%;
color:#0600FF'>int</span><span style='font-size:9.0pt;line-height:110%'>, </span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>string</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>&gt;(); </span><span
style='font-size:9.0pt;line-height:110%'>dict</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>.</span><span style='font-size:9.0pt;
line-height:110%'>AddOrUpdate</span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>(</span><span style='font-size:9.0pt;line-height:110%;
color:red'>1</span><span style='font-size:9.0pt;line-height:110%'>, </span><span
style='font-size:9.0pt;line-height:110%;color:#A60000'>&quot;First&quot;</span><span
style='font-size:9.0pt;line-height:110%'>, </span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>(</span><span style='font-size:9.0pt;
line-height:110%'>oldKey, oldValue</span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>)</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>=&gt;</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:#A60000'>&quot;First&quot;</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>);</span></p>

<h3 style='margin-top:0in;margin-right:0in;margin-bottom:2.5pt;margin-left:
-.25pt'>Section 4.3: Getting a value from a dictionary</h3>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>Given this setup code:</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=60
src=".NET%20Framework%20Notes%20for%20Professionals_files/image048.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=54
src=".NET%20Framework%20Notes%20for%20Professionals_files/image049.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>You may want to read the value for the entry with key 1. If
key doesn't exist getting a value will throw <span style='font-size:9.0pt;
line-height:109%;background:#FAFAFA'>KeyNotFoundException</span>, so you may
want to first check for that with <span style='font-size:9.0pt;line-height:
109%;background:#FAFAFA'>ContainsKey</span>:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src=".NET%20Framework%20Notes%20for%20Professionals_files/image050.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>This has one disadvantage: you will search through your
dictionary twice (once to check for existence and one to read the value). For a
large dictionary this can impact performance. Fortunately both operations can
be performed together:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src=".NET%20Framework%20Notes%20for%20Professionals_files/image051.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:-.25pt;line-height:107%'><b><span style='font-size:18.0pt;
line-height:107%;color:#1889D0'>Section 4.4: Make a Dictionary&lt;string, T&gt;
with Case-</span></b></p>

<h3 style='margin-top:0in;margin-right:0in;margin-bottom:4.2pt;margin-left:
-.25pt'>Insensivitve keys</h3>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:23.0pt;
margin-left:3.5pt;line-height:110%'><span style='position:relative;z-index:
-1895812096'><span style='left:0px;position:absolute;left:0px;top:-8px;
width:718px;height:26px'><img width=718 height=26
src=".NET%20Framework%20Notes%20for%20Professionals_files/image052.gif"></span></span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>var</span><span
style='font-size:9.0pt;line-height:110%'> MyDict </span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>=</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:#0600FF'>new</span><span style='font-size:9.0pt;line-height:110%'>
Dictionary</span><span style='font-size:9.0pt;line-height:110%;color:#666666'>&lt;</span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>string</span><span
style='font-size:9.0pt;line-height:110%'>,T</span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>&gt;(</span><span style='font-size:9.0pt;
line-height:110%'>StringComparison</span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>.</span><span style='font-size:9.0pt;
line-height:110%'>InvariantCultureIgnoreCase</span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>)</span></p>

<h3 style='margin-top:0in;margin-right:0in;margin-bottom:2.5pt;margin-left:
-.25pt'>Section 4.5: IEnumerable to Dictionary (&#8805; .NET 3.5)</h3>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.15pt;
margin-left:-.25pt;line-height:107%'>Create a <a
href="https://msdn.microsoft.com/en-us/library/xfhwa508(v=vs.100).aspx"><span
style='color:#1889D0'>Dictionary&lt;TKey, TValue&gt;</span></a> from an <a
href="https://msdn.microsoft.com/en-us/library/9eekhta0(v=vs.100).aspx"><span
style='color:#1889D0'>IEnumerable&lt;T&gt;</span></a>:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:22.4pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src=".NET%20Framework%20Notes%20for%20Professionals_files/image053.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:22.4pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=92
src=".NET%20Framework%20Notes%20for%20Professionals_files/image054.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=174
src=".NET%20Framework%20Notes%20for%20Professionals_files/image055.gif"></span></p>

<h3 style='margin-top:0in;margin-right:0in;margin-bottom:2.5pt;margin-left:
-.25pt'>Section 4.6: Enumerating a Dictionary</h3>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:13.15pt;
margin-left:1.05pt'>You can enumerate through a Dictionary in one of 3 ways:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.35pt;
margin-left:.75pt;line-height:107%'><b>Using KeyValue pairs</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=92
src=".NET%20Framework%20Notes%20for%20Professionals_files/image056.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:.75pt;line-height:107%'><b>Using Keys</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=92
src=".NET%20Framework%20Notes%20for%20Professionals_files/image057.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:.75pt;line-height:107%'><b>Using Values</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=92
src=".NET%20Framework%20Notes%20for%20Professionals_files/image058.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:-.25pt;line-height:107%'><b><span style='font-size:18.0pt;
line-height:107%;color:#1889D0'>Section 4.7:
ConcurrentDictionary&lt;TKey,&#8194;TValue&gt; (from .NET</span></b></p>

<h3 style='margin-top:0in;margin-right:0in;margin-bottom:13.7pt;margin-left:
-.25pt'>4.0)</h3>

<p class=MsoNormal style='margin-top:0in;margin-right:12.05pt;margin-bottom:
24.0pt;margin-left:24.5pt'><img width=3 height=71
src=".NET%20Framework%20Notes%20for%20Professionals_files/image059.gif"
align=left hspace=12>Represents a thread-safe collection of key/value pairs
that can be accessed by multiple threads concurrently.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.35pt;
margin-left:.75pt;line-height:107%'><b>Creating an instance</b></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=166 style='width:124.2pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=72 valign=top style='width:.75in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Dictionary</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>&lt;</span>&nbsp;</p>
  </td>
  <td width=86 valign=top style='width:.9in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>TKey, TValue</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>Creating an instance works pretty much the same way as with
<span style='font-size:9.0pt;line-height:109%;color:#666666;background:#FAFAFA'>&gt;</span>,
e.g.:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:19.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src=".NET%20Framework%20Notes%20for%20Professionals_files/image060.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.35pt;
margin-left:.75pt;line-height:107%'><b>Adding or Updating</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:13.0pt;
margin-left:1.05pt'>You might be surprised, that there is no <span
style='font-size:9.0pt;line-height:109%;color:#0600FF;background:#FAFAFA'>Add</span>
method, but instead there is <span style='font-size:9.0pt;line-height:109%;
background:#FAFAFA'>AddOrUpdate</span> with 2 overloads:</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=463 style='width:347.4pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=79 valign=top style='width:59.4pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>AddOrUpdate</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>(</span></p>
  </td>
  <td width=156 valign=top style='width:117.0pt;background:#FAFAFA;padding:
  1.8pt 0in 0in 0in;height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>TKey key,</span><span style='font-size:9.0pt;line-height:107%;
  font-family:"Arial",sans-serif'>&#8194;</span><span style='font-size:9.0pt;
  line-height:107%'>TValue,</span><span style='font-size:9.0pt;line-height:
  107%;font-family:"Arial",sans-serif'>&#8194;</span><span style='font-size:
  9.0pt;line-height:107%'>Func</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>&lt;</span>&nbsp;</p>
  </td>
  <td width=142 valign=top style='width:106.2pt;background:#FAFAFA;padding:
  1.8pt 0in 0in 0in;height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>TKey,</span><span style='font-size:9.0pt;line-height:107%;font-family:
  "Arial",sans-serif'>&#8194;</span><span style='font-size:9.0pt;line-height:
  107%'>TValue,</span><span style='font-size:9.0pt;line-height:107%;font-family:
  "Arial",sans-serif'>&#8194;</span><span style='font-size:9.0pt;line-height:
  107%'>TValue</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>&gt;</span>&nbsp;</p>
  </td>
  <td width=65 valign=top style='width:48.6pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>addValue</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.95pt;margin-bottom:12.95pt;
margin-left:528.15pt;text-indent:-528.15pt;line-height:107%'><span
style='line-height:107%'>(1)<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-size:9.0pt;line-height:107%;color:#666666;
background:#FAFAFA'>)</span> - <i>Adds a key/value pair if the key does not
already exist, or updates a key/value pair by using the specified function if
the key already exists.</i></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=685 style='width:513.9pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=79 valign=top style='width:59.4pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>AddOrUpdate</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>(</span></p>
  </td>
  <td width=100 valign=top style='width:74.7pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>TKey key,</span><span style='font-size:9.0pt;line-height:107%;
  font-family:"Arial",sans-serif'>&#8194;</span><span style='font-size:9.0pt;
  line-height:107%'>Func</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>&lt;</span>&nbsp;</p>
  </td>
  <td width=85 valign=top style='width:63.9pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>TKey,</span><span style='font-size:9.0pt;line-height:107%;font-family:
  "Arial",sans-serif'>&#8194;</span><span style='font-size:9.0pt;line-height:
  107%'>TValue</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>&gt;</span>&nbsp;</p>
  </td>
  <td width=107 valign=top style='width:80.1pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>addValue,</span><span style='font-size:9.0pt;line-height:107%;
  font-family:"Arial",sans-serif'>&#8194;</span><span style='font-size:9.0pt;
  line-height:107%'>Func</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>&lt;</span>&nbsp;</p>
  </td>
  <td width=142 valign=top style='width:106.2pt;background:#FAFAFA;padding:
  1.8pt 0in 0in 0in;height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>TKey,</span><span style='font-size:9.0pt;line-height:107%;font-family:
  "Arial",sans-serif'>&#8194;</span><span style='font-size:9.0pt;line-height:
  107%'>TValue,</span><span style='font-size:9.0pt;line-height:107%;font-family:
  "Arial",sans-serif'>&#8194;</span><span style='font-size:9.0pt;line-height:
  107%'>TValue</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>&gt;</span>&nbsp;</p>
  </td>
  <td width=137 valign=top style='width:102.6pt;background:#FAFAFA;padding:
  1.8pt 0in 0in 0in;height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>updateValueFactory</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.95pt;margin-bottom:1.6pt;
margin-left:528.15pt;text-indent:-528.15pt'><span style='line-height:109%'>(2)<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-size:9.0pt;line-height:109%;color:#666666;
background:#FAFAFA'>)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.15pt;margin-bottom:
12.7pt;margin-left:-.25pt;line-height:107%'>- <i>Uses the specified functions
to add a key/value pair to the if the key does not already exist, or to update
a key/value pair if the key already exists.</i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:45.45pt;margin-bottom:
1.6pt;margin-left:4.3pt;text-indent:-3.75pt;line-height:253%'><span
style='position:absolute;z-index:-1895810048;left:0px;margin-left:0px;
margin-top:30px;width:718px;height:26px'><img width=718 height=26
src=".NET%20Framework%20Notes%20for%20Professionals_files/image061.gif"></span>Adding
or updating a value, no matter what was the value if it was already present for
given key (1): <span style='font-size:9.0pt;line-height:253%;color:#0600FF'>string</span><span
style='font-size:9.0pt;line-height:253%'> addedValue </span><span
style='font-size:9.0pt;line-height:253%;color:#666666'>=</span><span
style='font-size:9.0pt;line-height:253%'> dict</span><span style='font-size:
9.0pt;line-height:253%;color:#666666'>.</span><span style='font-size:9.0pt;
line-height:253%'>AddOrUpdate</span><span style='font-size:9.0pt;line-height:
253%;color:#666666'>(</span><span style='font-size:9.0pt;line-height:253%;
color:red'>1</span><span style='font-size:9.0pt;line-height:253%'>, </span><span
style='font-size:9.0pt;line-height:253%;color:#A60000'>&quot;First&quot;</span><span
style='font-size:9.0pt;line-height:253%'>, </span><span style='font-size:9.0pt;
line-height:253%;color:#666666'>(</span><span style='font-size:9.0pt;
line-height:253%'>updateKey, valueOld</span><span style='font-size:9.0pt;
line-height:253%;color:#666666'>)</span><span style='font-size:9.0pt;
line-height:253%'> </span><span style='font-size:9.0pt;line-height:253%;
color:#666666'>=&gt;</span><span style='font-size:9.0pt;line-height:253%'> </span><span
style='font-size:9.0pt;line-height:253%;color:#A60000'>&quot;First&quot;</span><span
style='font-size:9.0pt;line-height:253%;color:#666666'>);</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:14.55pt;
margin-left:1.05pt'>Adding or updating a value, but now altering the value in
update, based on the previous value (1):</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;line-height:110%'><span style='position:relative;z-index:
-1895809024'><span style='left:0px;position:absolute;left:0px;top:-8px;
width:718px;height:26px'><img width=718 height=26
src=".NET%20Framework%20Notes%20for%20Professionals_files/image044.gif"></span></span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>string</span><span
style='font-size:9.0pt;line-height:110%'> addedValue2 </span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>=</span><span
style='font-size:9.0pt;line-height:110%'> dict</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>.</span><span style='font-size:9.0pt;
line-height:110%'>AddOrUpdate</span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>(</span><span style='font-size:9.0pt;line-height:110%;
color:red'>1</span><span style='font-size:9.0pt;line-height:110%'>, </span><span
style='font-size:9.0pt;line-height:110%;color:#A60000'>&quot;First&quot;</span><span
style='font-size:9.0pt;line-height:110%'>, </span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>(</span><span style='font-size:9.0pt;
line-height:110%'>updateKey, valueOld</span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>)</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>=&gt;</span><span style='font-size:9.0pt;line-height:110%'> $</span><span
style='font-size:9.0pt;line-height:110%;color:#A60000'>&quot;{valueOld}
Updated&quot;</span><span style='font-size:9.0pt;line-height:110%;color:#666666'>);</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:14.55pt;
margin-left:1.05pt'>Using the overload (2) we can also add new value using a
factory:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:21.25pt;
margin-left:3.5pt;line-height:110%'><span style='position:relative;z-index:
-1895808000'><span style='left:0px;position:absolute;left:0px;top:-8px;
width:718px;height:43px'><img width=718 height=43
src=".NET%20Framework%20Notes%20for%20Professionals_files/image035.gif"></span></span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>string</span><span
style='font-size:9.0pt;line-height:110%'> addedValue3 </span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>=</span><span
style='font-size:9.0pt;line-height:110%'> dict</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>.</span><span style='font-size:9.0pt;
line-height:110%'>AddOrUpdate</span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>(</span><span style='font-size:9.0pt;line-height:110%;
color:red'>1</span><span style='font-size:9.0pt;line-height:110%'>, </span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%'>key</span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>)</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>=&gt;</span><span style='font-size:9.0pt;line-height:110%'> key </span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>==</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:red'>1</span><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:#666666'>?</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#A60000'>&quot;First&quot;</span><span style='font-size:
9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>:</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:#A60000'>&quot;Not First&quot;</span><span
style='font-size:9.0pt;line-height:110%'>, </span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>(</span><span style='font-size:9.0pt;
line-height:110%'>updateKey, valueOld</span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>)</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>=&gt;</span><span style='font-size:9.0pt;line-height:110%'> $</span><span
style='font-size:9.0pt;line-height:110%;color:#A60000'>&quot;{valueOld}
Updated&quot;</span><span style='font-size:9.0pt;line-height:110%;color:#666666'>);</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.35pt;
margin-left:.75pt;line-height:107%'><b>Getting value</b></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=158 style='width:1.65in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=72 valign=top style='width:.75in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Dictionary</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>&lt;</span>&nbsp;</p>
  </td>
  <td width=79 valign=top style='width:59.4pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>TKey,TValue</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>Getting a value is the same as with the <span
style='font-size:9.0pt;line-height:109%;color:#666666;background:#FAFAFA'>&gt;</span>:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:19.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src=".NET%20Framework%20Notes%20for%20Professionals_files/image062.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.35pt;
margin-left:.75pt;line-height:107%'><b>Getting or Adding a value</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:13.15pt;
margin-left:1.05pt'>There are two mehod overloads, that will <b>get or add</b>
a value in a thread-safe manner.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>Get value with key 2, or add value &quot;Second&quot; if
the key is not present:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src=".NET%20Framework%20Notes%20for%20Professionals_files/image063.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:86.65pt;margin-bottom:
.1in;margin-left:4.3pt;text-indent:-3.75pt;line-height:253%'><span
style='position:absolute;z-index:-1895806976;left:0px;margin-left:0px;
margin-top:30px;width:718px;height:26px'><img width=718 height=26
src=".NET%20Framework%20Notes%20for%20Professionals_files/image064.gif"></span>Using
a factory for adding a value, if value is not present: <span style='font-size:
9.0pt;line-height:253%;color:#0600FF'>string</span><span style='font-size:9.0pt;
line-height:253%'> theValue2 </span><span style='font-size:9.0pt;line-height:
253%;color:#666666'>=</span><span style='font-size:9.0pt;line-height:253%'>
dict</span><span style='font-size:9.0pt;line-height:253%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:253%'>GetOrAdd</span><span style='font-size:
9.0pt;line-height:253%;color:#666666'>(</span><span style='font-size:9.0pt;
line-height:253%;color:red'>2</span><span style='font-size:9.0pt;line-height:
253%'>, </span><span style='font-size:9.0pt;line-height:253%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:253%'>key</span><span style='font-size:9.0pt;
line-height:253%;color:#666666'>)</span><span style='font-size:9.0pt;
line-height:253%'> </span><span style='font-size:9.0pt;line-height:253%;
color:#666666'>=&gt;</span><span style='font-size:9.0pt;line-height:253%'> key </span><span
style='font-size:9.0pt;line-height:253%;color:#666666'>==</span><span
style='font-size:9.0pt;line-height:253%'> </span><span style='font-size:9.0pt;
line-height:253%;color:red'>2</span><span style='font-size:9.0pt;line-height:
253%'> </span><span style='font-size:9.0pt;line-height:253%;color:#666666'>?</span><span
style='font-size:9.0pt;line-height:253%'> </span><span style='font-size:9.0pt;
line-height:253%;color:#A60000'>&quot;Second&quot;</span><span
style='font-size:9.0pt;line-height:253%'> </span><span style='font-size:9.0pt;
line-height:253%;color:#666666'>:</span><span style='font-size:9.0pt;
line-height:253%'> </span><span style='font-size:9.0pt;line-height:253%;
color:#A60000'>&quot;Not Second.&quot;</span><span style='font-size:9.0pt;
line-height:253%'> </span><span style='font-size:9.0pt;line-height:253%;
color:#666666'>);</span></p>

<h3 style='margin-top:0in;margin-right:0in;margin-bottom:2.5pt;margin-left:
-.25pt'>Section 4.8: Dictionary to List</h3>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:14.55pt;
margin-left:1.05pt'>Creating a list of KeyValuePair:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:86.65pt;margin-bottom:
17.2pt;margin-left:3.5pt;line-height:110%'><span style='position:relative;
z-index:-1895805952'><span style='left:0px;position:absolute;left:0px;
top:-8px;width:718px;height:59px'><img width=718 height=59
src=".NET%20Framework%20Notes%20for%20Professionals_files/image065.gif"></span></span><span
style='font-size:9.0pt;line-height:110%'>Dictionary</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>&lt;</span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>int</span><span
style='font-size:9.0pt;line-height:110%'>, </span><span style='font-size:9.0pt;
line-height:110%;color:#0600FF'>int</span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>&gt;</span><span style='font-size:9.0pt;
line-height:110%'> dictionary </span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>=</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>new</span><span
style='font-size:9.0pt;line-height:110%'> Dictionary</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>&lt;</span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>int</span><span
style='font-size:9.0pt;line-height:110%'>, </span><span style='font-size:9.0pt;
line-height:110%;color:#0600FF'>int</span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>&gt;(); </span><span style='font-size:9.0pt;
line-height:110%'>List</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>&lt;</span><span style='font-size:9.0pt;line-height:110%'>KeyValuePair</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>&lt;</span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>int</span><span
style='font-size:9.0pt;line-height:110%'>, </span><span style='font-size:9.0pt;
line-height:110%;color:#0600FF'>int</span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>&gt;&gt;</span><span style='font-size:9.0pt;
line-height:110%'> list </span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>=</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>new</span><span
style='font-size:9.0pt;line-height:110%'> List</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>&lt;</span><span style='font-size:9.0pt;
line-height:110%'>KeyValuePair</span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>&lt;</span><span style='font-size:9.0pt;line-height:110%;
color:#0600FF'>int</span><span style='font-size:9.0pt;line-height:110%'>, </span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>int</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>&gt;&gt;(); </span><span
style='font-size:9.0pt;line-height:110%'>list</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>.</span><span style='font-size:9.0pt;
line-height:110%'>AddRange</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>(</span><span style='font-size:9.0pt;line-height:110%'>dictionary</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>);</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>Creating a list of keys:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src=".NET%20Framework%20Notes%20for%20Professionals_files/image066.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>Creating a list of values:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src=".NET%20Framework%20Notes%20for%20Professionals_files/image067.gif"></span></p>

<h3 style='margin-top:0in;margin-right:0in;margin-bottom:2.5pt;margin-left:
-.25pt'>Section 4.9: Removing from a Dictionary</h3>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>Given this setup code:</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=109
src=".NET%20Framework%20Notes%20for%20Professionals_files/image068.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>Use the <span style='font-size:9.0pt;line-height:109%;
color:#0600FF;background:#FAFAFA'>Remove</span> method to remove a key and its
associated value.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src=".NET%20Framework%20Notes%20for%20Professionals_files/image069.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.85pt;
margin-left:1.05pt'>Executing this code removes the key <span style='font-size:
9.0pt;line-height:109%;background:#FAFAFA'>2</span> and it's value from the
dictionary. <span style='font-size:9.0pt;line-height:109%;color:#0600FF;
background:#FAFAFA'>Remove</span> returns a boolean value indicating whether
the specified key was found and removed from the dictionary. If the key does
not exist in the dictionary, nothing is removed from the dictionary, and false
is returned (no exception is thrown).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>It's <b>incorrect</b> to try and remove a key by setting
the value for the key to <span style='font-size:9.0pt;line-height:109%;
color:#0600FF;background:#FAFAFA'>null</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src=".NET%20Framework%20Notes%20for%20Professionals_files/image070.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:13.0pt;
margin-left:1.05pt'>This will not remove the key. It will just replace the
previous value with a value of <span style='font-size:9.0pt;line-height:109%;
color:#0600FF;background:#FAFAFA'>null</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>To remove all keys and values from a dictionary, use the <span
style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>Clear</span>
method.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src=".NET%20Framework%20Notes%20for%20Professionals_files/image071.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:14.65pt;margin-bottom:
0in;margin-left:1.05pt;line-height:145%'>After executing <span
style='font-size:9.0pt;line-height:145%;background:#FAFAFA'>Clear</span> the
dictionary's <span style='font-size:9.0pt;line-height:145%;background:#FAFAFA'>Count</span>
will be 0, but the internal capacity remains unchanged. <b><span
style='font-size:18.0pt;line-height:145%;color:#1889D0'>Section 4.10:
ContainsKey(TKey)</span></b></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=115 style='width:1.2in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=79 valign=top style='width:59.4pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><a
  href="https://msdn.microsoft.com/library/htszx2dy(v=vs.110).aspx"><span
  style='font-size:9.0pt;line-height:107%;color:#1889D0'>ContainsKey</span></a></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><a
  href="https://msdn.microsoft.com/library/htszx2dy(v=vs.110).aspx"><span
  style='font-size:9.0pt;line-height:107%;color:#666666;background:#FAFAFA'>(</span></a></p>
  </td>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><a
  href="https://msdn.microsoft.com/library/htszx2dy(v=vs.110).aspx"><span
  style='font-size:9.0pt;line-height:107%;color:#1889D0'>TKey</span></a></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>To check if a <span style='font-size:9.0pt;line-height:
109%;background:#FAFAFA'>Dictionary</span> has an specifique key, you can call
the method <a href="https://msdn.microsoft.com/library/htszx2dy(v=vs.110).aspx"><span
style='font-size:9.0pt;line-height:109%;color:#666666;background:#FAFAFA'>)</span></a>
and provide the key of <span style='font-size:9.0pt;line-height:109%;
background:#FAFAFA'>TKey</span> type. The method returns a <span
style='font-size:9.0pt;line-height:109%;color:#0600FF;background:#FAFAFA'>bool</span>
value when the key exists on the dictionary. For sample:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=125
src=".NET%20Framework%20Notes%20for%20Professionals_files/image072.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>And check if a <span style='font-size:9.0pt;line-height:
109%;background:#FAFAFA'>C2</span> exists on the Dictionary:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=76
src=".NET%20Framework%20Notes%20for%20Professionals_files/image073.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=166 style='width:124.2pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=72 valign=top style='width:.75in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><a
  href="https://msdn.microsoft.com/library/htszx2dy(v=vs.110).aspx"><span
  style='font-size:9.0pt;line-height:107%;color:#1889D0'>Dictionary</span></a></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><a
  href="https://msdn.microsoft.com/library/htszx2dy(v=vs.110).aspx"><span
  style='font-size:9.0pt;line-height:107%;color:#666666;background:#FAFAFA'>&lt;</span></a></p>
  </td>
  <td width=86 valign=top style='width:.9in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><a
  href="https://msdn.microsoft.com/library/htszx2dy(v=vs.110).aspx"><span
  style='font-size:9.0pt;line-height:107%;color:#1889D0'>TKey, TValue</span></a></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:18.65pt;
margin-left:1.05pt'>The ContainsKey method is available on the generic version <a
href="https://msdn.microsoft.com/library/htszx2dy(v=vs.110).aspx"><span
style='font-size:9.0pt;line-height:109%;color:#666666;background:#FAFAFA'>&gt;</span></a>.</p>

<h3 style='margin-top:0in;margin-right:0in;margin-bottom:3.5pt;margin-left:
-.25pt'>Section 4.11: ConcurrentDictionary augmented with Lazy'1 reduces
duplicated computation</h3>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.35pt;
margin-left:.75pt;line-height:107%'><b>Problem</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.55pt;
margin-left:1.05pt'>ConcurrentDictionary shines when it comes to instantly
returning of existing keys from cache, mostly lock free, and contending on a
granular level. But what if the object creation is really expensive,
outweighing the cost of context switching, and some cache misses occur?</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>If the same key is requested from multiple threads, one of
the objects resulting from colliding operations will be eventually added to the
collection, and the others will be thrown away, wasting the CPU resource to
create the object and memory resource to store the object temporarily. Other
resources could be wasted as well. This is really bad.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.35pt;
margin-left:.75pt;line-height:107%'><b>Solution</b></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=358 style='width:268.2pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=144 valign=top style='width:1.5in;background:#FAFAFA;padding:1.05pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>ConcurrentDictionary</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.05pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>&lt;</span>&nbsp;</p>
  </td>
  <td width=86 valign=top style='width:.9in;background:#FAFAFA;padding:1.05pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>TKey, TValue</span></p>
  </td>
  <td width=41 valign=top style='width:30.6pt;padding:1.05pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>&gt;</span> with </p>
  </td>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:1.05pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Lazy</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.05pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>&lt;</span>&nbsp;</p>
  </td>
  <td width=43 valign=top style='width:.45in;background:#FAFAFA;padding:1.05pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>TValue</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>We can combine <span style='font-size:9.0pt;line-height:
109%;color:#666666;background:#FAFAFA'>&gt;</span>. The idea is that
ConcurrentDictionary</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>GetOrAdd method can only return the value which was
actually added to the collection. The loosing Lazy objects could be wasted in
this case too, but that's not much problem, as the Lazy object itself is
relatively unexpensive. The Value property of the losing Lazy is never
requested, because we are smart to only request the Value property of the one
actually added to the collection - the one returned from the GetOrAdd method:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=256
src=".NET%20Framework%20Notes%20for%20Professionals_files/image074.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>Caching of XmlSerializer objects can be particularly
expensive, and there is a lot of contention at the application startup too. And
there is more to this: if those are custom serializers, there will be a memory
leak too for the rest of the process lifecycle. The only benefit of the
ConcurrentDictionary in this case is that for the rest of the process lifecycle
there will be no locks, but application startup and memory usage would be
inacceptable. This is a job for our ConcurrentDictionary, augmented with Lazy:</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=207
src=".NET%20Framework%20Notes%20for%20Professionals_files/image075.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.15pt;
margin-left:-.25pt;line-height:110%'><b><span style='font-size:26.0pt;
line-height:110%;color:#1889D0'>Chapter 5: Collections</span></b></p>

<h3 style='margin-top:0in;margin-right:0in;margin-bottom:2.5pt;margin-left:
-.25pt'>Section 5.1: Using collection initializers</h3>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:14.3pt;
margin-left:1.05pt'>Some collection types can be initialized at the declaration
time. For example, the following statement creates and initializes the <span
style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>numbers</span> with
some integers:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:17.25pt;
margin-left:3.5pt;line-height:110%'><span style='position:relative;z-index:
-1895804928'><span style='left:0px;position:absolute;left:0px;top:-8px;
width:718px;height:26px'><img width=718 height=26
src=".NET%20Framework%20Notes%20for%20Professionals_files/image076.gif"></span></span><span
style='font-size:9.0pt;line-height:110%'>List</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>&lt;</span><span style='font-size:9.0pt;
line-height:110%;color:#0600FF'>int</span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>&gt;</span><span style='font-size:9.0pt;
line-height:110%'> numbers </span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>=</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>new</span><span
style='font-size:9.0pt;line-height:110%'> List</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>&lt;</span><span style='font-size:9.0pt;
line-height:110%;color:#0600FF'>int</span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>&gt;(){</span><span style='font-size:9.0pt;
line-height:110%;color:red'>10</span><span style='font-size:9.0pt;line-height:
110%'>, </span><span style='font-size:9.0pt;line-height:110%;color:red'>9</span><span
style='font-size:9.0pt;line-height:110%'>, </span><span style='font-size:9.0pt;
line-height:110%;color:red'>8</span><span style='font-size:9.0pt;line-height:
110%'>, </span><span style='font-size:9.0pt;line-height:110%;color:red'>7</span><span
style='font-size:9.0pt;line-height:110%'>, </span><span style='font-size:9.0pt;
line-height:110%;color:red'>7</span><span style='font-size:9.0pt;line-height:
110%'>, </span><span style='font-size:9.0pt;line-height:110%;color:red'>6</span><span
style='font-size:9.0pt;line-height:110%'>, </span><span style='font-size:9.0pt;
line-height:110%;color:red'>5</span><span style='font-size:9.0pt;line-height:
110%'>, </span><span style='font-size:9.0pt;line-height:110%;color:red'>10</span><span
style='font-size:9.0pt;line-height:110%'>, </span><span style='font-size:9.0pt;
line-height:110%;color:red'>4</span><span style='font-size:9.0pt;line-height:
110%'>, </span><span style='font-size:9.0pt;line-height:110%;color:red'>3</span><span
style='font-size:9.0pt;line-height:110%'>, </span><span style='font-size:9.0pt;
line-height:110%;color:red'>2</span><span style='font-size:9.0pt;line-height:
110%'>, </span><span style='font-size:9.0pt;line-height:110%;color:red'>1</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>};</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:9.35pt;
margin-left:1.05pt'>Internally, the C# compiler actually converts this
initialization to a series of calls to the Add method. Consequently, you can
use this syntax only for collections that actually support the <span
style='font-size:9.0pt;line-height:109%;color:#0600FF;background:#FAFAFA'>Add</span>
method.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=124 style='width:93.25pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=36 valign=top style='width:27.0pt;background:#FAFAFA;padding:1.25pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Stack</span></p>
  </td>
  <td width=52 valign=top style='width:39.25pt;padding:1.25pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>&lt;</span><span style='font-size:
  9.0pt;line-height:107%;background:#FAFAFA'>T</span><span style='font-size:
  9.0pt;line-height:107%;color:#666666;background:#FAFAFA'>&gt;</span> and </p>
  </td>
  <td width=36 valign=top style='width:27.0pt;background:#FAFAFA;padding:1.25pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Queue</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.2pt;
margin-left:0in;text-indent:0in'><span style='font-size:11.0pt;line-height:
109%'> <img border=0 width=3 height=51 id="Group 239044"
src=".NET%20Framework%20Notes%20for%20Professionals_files/image077.gif"></span> The
 <span style='font-size:9.0pt;
line-height:109%;color:#666666;background:#FAFAFA'>&lt;</span><span
style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>T</span><span
style='font-size:9.0pt;line-height:109%;color:#666666;background:#FAFAFA'>&gt;</span>
classes do not support it.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=166 style='width:124.2pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=72 valign=top style='width:.75in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Dictionary</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>&lt;</span>&nbsp;</p>
  </td>
  <td width=86 valign=top style='width:.9in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>TKey, TValue</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:14.2pt;
margin-left:1.05pt'>For complex collections such as the <span style='font-size:
9.0pt;line-height:109%;color:#666666;background:#FAFAFA'>&gt;</span> class,
that take key/value pairs, you can specify each key/value pair as an anonymous
type in the initializer list.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%'>Dictionary</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>&lt;</span><span style='font-size:9.0pt;line-height:110%;
color:#0600FF'>int</span><span style='font-size:9.0pt;line-height:110%'>, </span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>string</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>&gt;</span><span
style='font-size:9.0pt;line-height:110%'> employee </span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>=</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#0600FF'>new</span><span style='font-size:9.0pt;
line-height:110%'> Dictionary</span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>&lt;</span><span style='font-size:9.0pt;line-height:110%;
color:#0600FF'>int</span><span style='font-size:9.0pt;line-height:110%'>, </span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>string</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>&gt;()</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:21.85pt;margin-bottom:
17.25pt;margin-left:3.5pt;line-height:110%'><span style='position:relative;
z-index:-1895803904'><span style='left:0px;position:absolute;left:0px;
top:-25px;width:718px;height:43px'><img width=718 height=43
src=".NET%20Framework%20Notes%20for%20Professionals_files/image035.gif"></span></span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>{{</span><span style='font-size:9.0pt;
line-height:110%;color:red'>44</span><span style='font-size:9.0pt;line-height:
110%'>, </span><span style='font-size:9.0pt;line-height:110%;color:#A60000'>&quot;John&quot;</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>}</span><span
style='font-size:9.0pt;line-height:110%'>, </span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>{</span><span style='font-size:9.0pt;
line-height:110%;color:red'>45</span><span style='font-size:9.0pt;line-height:
110%'>, </span><span style='font-size:9.0pt;line-height:110%;color:#A60000'>&quot;Bob&quot;</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>}</span><span
style='font-size:9.0pt;line-height:110%'>, </span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>{</span><span style='font-size:9.0pt;
line-height:110%;color:red'>47</span><span style='font-size:9.0pt;line-height:
110%'>, </span><span style='font-size:9.0pt;line-height:110%;color:#A60000'>&quot;James&quot;</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>}</span><span
style='font-size:9.0pt;line-height:110%'>, </span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>{</span><span style='font-size:9.0pt;
line-height:110%;color:red'>48</span><span style='font-size:9.0pt;line-height:
110%'>, </span><span style='font-size:9.0pt;line-height:110%;color:#A60000'>&quot;Franklin&quot;</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>}};</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:175.15pt;margin-bottom:
0in;margin-left:1.05pt;line-height:145%'>The first item in each pair is the
key, and the second is the value. <b><span style='font-size:18.0pt;line-height:
145%;color:#1889D0'>Section 5.2: Stack</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>There is a collection in .Net used to manage values in a <a
href="https://msdn.microsoft.com/library/system.collections.stack(v=vs.110).aspx"><span
style='font-size:9.0pt;line-height:109%;color:#1889D0;background:#FAFAFA'>Stack</span></a>
that uses the <a href="https://en.wikipedia.org/wiki/Stack_(abstract_data_type)"><span
style='color:#1889D0'>LIFO (last-in first-out)</span></a> concept. The</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=404 style='width:303.05pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><a
  href="https://msdn.microsoft.com/library/system.collections.stack.push(v=vs.110).aspx"><span
  style='font-size:9.0pt;line-height:107%;color:#1889D0'>Push</span></a></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><a
  href="https://msdn.microsoft.com/library/system.collections.stack.push(v=vs.110).aspx"><span
  style='font-size:9.0pt;line-height:107%;color:#666666;background:#FAFAFA'>(</span></a></p>
  </td>
  <td width=43 valign=top style='width:.45in;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><a
  href="https://msdn.microsoft.com/library/system.collections.stack.push(v=vs.110).aspx"><span
  style='font-size:9.0pt;line-height:107%;color:#1889D0'>T item</span></a></p>
  </td>
  <td width=303 valign=top style='width:227.45pt;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><a
  href="https://msdn.microsoft.com/library/system.collections.stack.push(v=vs.110).aspx"><span
  style='font-size:9.0pt;line-height:107%;color:#666666;background:#FAFAFA'>)</span></a>
  which is used to add elements in the stack and </p>
  </td>
  <td width=22 valign=top style='width:16.2pt;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><a
  href="https://msdn.microsoft.com/library/system.collections.stack.pop(v=vs.110).aspx"><span
  style='font-size:9.0pt;line-height:107%;color:#1889D0'>Pop</span></a></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>basics of stacks is the method <a
href="https://msdn.microsoft.com/library/system.collections.stack.pop(v=vs.110).aspx"><span
style='font-size:9.0pt;line-height:109%;color:#666666;background:#FAFAFA'>(</span></a><a
href="https://msdn.microsoft.com/library/system.collections.stack.pop(v=vs.110).aspx"><span
style='font-size:9.0pt;line-height:109%;color:#666666;background:#FAFAFA'>)</span></a>
which is used to</p>

<p class=MsoNormal style='margin-top:0in;margin-right:15.5pt;margin-bottom:
0in;margin-left:1.05pt;line-height:169%'>get the last element added and remove
it from the stack. The generic version can be used like the following code for
a queue of strings. First, add the namespace:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src=".NET%20Framework%20Notes%20for%20Professionals_files/image078.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>and use it:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=191
src=".NET%20Framework%20Notes%20for%20Professionals_files/image079.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.9pt;
margin-left:1.05pt'>There is a non generic version of the type, which works
with objects.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>The namespace is:</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=26
src=".NET%20Framework%20Notes%20for%20Professionals_files/image080.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>And a code sample of non generic stack:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=223
src=".NET%20Framework%20Notes%20for%20Professionals_files/image081.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>There is also a method called <a
href="https://msdn.microsoft.com/library/system.collections.stack.peek(v=vs.110).aspx"><span
style='color:#1889D0'>Peek()</span></a> which returns the last element added
but without removing it from the <span style='font-size:9.0pt;line-height:109%;
background:#FAFAFA'>Stack</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=92
src=".NET%20Framework%20Notes%20for%20Professionals_files/image082.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>It is possible to iterate on the elements on the stack and
it will respect the order of the stack (LIFO).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=191
src=".NET%20Framework%20Notes%20for%20Professionals_files/image083.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>The output (without removing):</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=110
src=".NET%20Framework%20Notes%20for%20Professionals_files/image084.gif"></span></p>

<h3 style='margin-left:-.25pt'>Section 5.3: Creating an initialized List with
Custom Types</h3>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=92
src=".NET%20Framework%20Notes%20for%20Professionals_files/image085.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=72 style='width:.75in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>List</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>&lt;</span>&nbsp;</p>
  </td>
  <td width=36 valign=top style='width:27.0pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Model</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>Here we have a Class with no constructor with two
properties: <span style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>Name</span>
and a nullable boolean property <span style='font-size:9.0pt;line-height:109%;
background:#FAFAFA'>Selected</span>. If we wanted to initialize a <span
style='font-size:9.0pt;line-height:109%;color:#666666;background:#FAFAFA'>&gt;</span>,
there are a few different ways to execute this.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=125
src=".NET%20Framework%20Notes%20for%20Professionals_files/image086.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>Here, we are creating several <span style='font-size:9.0pt;
line-height:109%;color:#0600FF;background:#FAFAFA'>new</span> instances of our <span
style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>Model</span> class,
and initializing them with data. What if we added a constructor?</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=191
src=".NET%20Framework%20Notes%20for%20Professionals_files/image087.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>This allows us to initialize our List a <i>little</i>
differently.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=109
src=".NET%20Framework%20Notes%20for%20Professionals_files/image088.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>What about a Class where one of the properties is a class
itself?</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=273
src=".NET%20Framework%20Notes%20for%20Professionals_files/image089.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>Notice we reverted the constructor on the <span
style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>Model</span> class
to simplify the example a little bit.</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=112
src=".NET%20Framework%20Notes%20for%20Professionals_files/image090.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=120
src=".NET%20Framework%20Notes%20for%20Professionals_files/image091.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=451 style='width:338.05pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:1.05pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>List</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.05pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>&lt;</span>&nbsp;</p>
  </td>
  <td width=94 valign=top style='width:70.2pt;background:#FAFAFA;padding:1.05pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>ExtendedModel</span></p>
  </td>
  <td width=41 valign=top style='width:30.6pt;padding:1.05pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>&gt;</span> with </p>
  </td>
  <td width=72 valign=top style='width:.75in;background:#FAFAFA;padding:1.05pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Collection</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.05pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>&lt;</span>&nbsp;</p>
  </td>
  <td width=94 valign=top style='width:70.2pt;background:#FAFAFA;padding:1.05pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>ExtendedModel</span></p>
  </td>
  <td width=14 valign=top style='width:10.45pt;padding:1.05pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>&gt;</span>, </p>
  </td>
  <td width=94 valign=top style='width:70.2pt;background:#FAFAFA;padding:1.05pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>ExtendedModel</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>Note that we can interchange our <span style='font-size:
9.0pt;line-height:109%;color:#666666;background:#FAFAFA'>[]</span>,</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=43 style='width:.45in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=43 valign=top style='width:.45in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#0600FF'>object</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:342.45pt;margin-bottom:
0in;margin-left:.55pt;text-indent:.45in;line-height:146%'><span
style='font-size:9.0pt;line-height:146%;color:#666666;background:#FAFAFA'>[]</span>,
or even simply <span style='font-size:9.0pt;line-height:146%;background:#FAFAFA'>[]</span>.
<b><span style='font-size:18.0pt;line-height:146%;color:#1889D0'>Section 5.4:
Queue</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>There is a collection in .Net used to manage values in a <a
href="https://msdn.microsoft.com/library/system.collections.queue(v=vs.110).aspx"><span
style='font-size:9.0pt;line-height:109%;color:#1889D0;background:#FAFAFA'>Queue</span></a>
that uses the <a
href="https://en.wikipedia.org/wiki/FIFO_(computing_and_electronics)"><span
style='color:#1889D0'>FIFO (first-in first-out)</span></a> concept. The</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=462 style='width:346.6pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=50 valign=top style='width:37.8pt;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><a
  href="https://msdn.microsoft.com/library/t249c2y7(v=vs.110).aspx"><span
  style='font-size:9.0pt;line-height:107%;color:#1889D0'>Enqueu</span></a><a
  href="https://msdn.microsoft.com/library/t249c2y7(v=vs.110).aspx"><span
  style='font-size:9.0pt;line-height:107%;color:#1889D0'>e</span></a></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><a
  href="https://msdn.microsoft.com/library/t249c2y7(v=vs.110).aspx"><span
  style='font-size:9.0pt;line-height:107%;color:#666666;background:#FAFAFA'>(</span></a></p>
  </td>
  <td width=43 valign=top style='width:.45in;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><a
  href="https://msdn.microsoft.com/library/t249c2y7(v=vs.110).aspx"><span
  style='font-size:9.0pt;line-height:107%;color:#1889D0'>T ite</span></a><a
  href="https://msdn.microsoft.com/library/t249c2y7(v=vs.110).aspx"><span
  style='font-size:9.0pt;line-height:107%;color:#1889D0'>m</span></a></p>
  </td>
  <td width=311 valign=top style='width:233.2pt;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><a
  href="https://msdn.microsoft.com/library/t249c2y7(v=vs.110).aspx"><span
  style='font-size:9.0pt;line-height:107%;color:#666666;background:#FAFAFA'>)</span></a>
  which is used to add elements in the queue and </p>
  </td>
  <td width=50 valign=top style='width:37.8pt;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><a
  href="https://msdn.microsoft.com/library/1c8bzx97(v=vs.110).aspx"><span
  style='font-size:9.0pt;line-height:107%;color:#1889D0'>Dequeue</span></a></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>basics of queues is the method <a
href="https://msdn.microsoft.com/library/1c8bzx97(v=vs.110).aspx"><span
style='font-size:9.0pt;line-height:109%;color:#666666;background:#FAFAFA'>()</span></a>
which</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.55pt;
margin-left:1.05pt'>is used to get the first element and remove it from the
queue. The generic version can be used like the following code for a queue of
strings.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>First, add the namespace:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src=".NET%20Framework%20Notes%20for%20Professionals_files/image092.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>and use it:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=191
src=".NET%20Framework%20Notes%20for%20Professionals_files/image093.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.9pt;
margin-left:1.05pt'>There is a non generic version of the type, which works
with objects.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>The namespace is:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src=".NET%20Framework%20Notes%20for%20Professionals_files/image080.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>Adn a code sample fo non generic queue:</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=223
src=".NET%20Framework%20Notes%20for%20Professionals_files/image094.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>There is also a method called <a
href="https://msdn.microsoft.com/library/system.collections.queue.peek(v=vs.110).aspx"><span
style='color:#1889D0'>Peek()</span></a> which returns the object at the
beginning of the queue without removing it the elements.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=191
src=".NET%20Framework%20Notes%20for%20Professionals_files/image095.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>The output (without removing):</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=110
src=".NET%20Framework%20Notes%20for%20Professionals_files/image096.gif"></span><br
clear=all style='page-break-before:always'>
</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.15pt;
margin-left:-.25pt;line-height:110%'><b><span style='font-size:26.0pt;
line-height:110%;color:#1889D0'>Chapter 6: ReadOnlyCollections</span></b></p>

<h3 style='margin-top:0in;margin-right:0in;margin-bottom:2.75pt;margin-left:
-.25pt'>Section 6.1: Creating a ReadOnlyCollection</h3>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.35pt;
margin-left:.75pt;line-height:107%'><b>Using the Constructor</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:14.75pt;
margin-left:1.05pt'>A <span style='font-size:9.0pt;line-height:109%;background:
#FAFAFA'>ReadOnlyCollection</span> is created by passing an existing <span
style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>IList</span> object
into the constructor:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%;color:#0600FF'>var</span><span style='font-size:9.0pt;line-height:110%'>
groceryList </span><span style='font-size:9.0pt;line-height:110%;color:#666666'>=</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#0600FF'>new</span><span style='font-size:9.0pt;
line-height:110%'> List</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>&lt;</span><span style='font-size:9.0pt;line-height:110%;
color:#0600FF'>string</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>&gt;</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>{</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#A60000'>&quot;Apple&quot;</span><span style='font-size:
9.0pt;line-height:110%'>, </span><span style='font-size:9.0pt;line-height:110%;
color:#A60000'>&quot;Banana&quot;</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>};</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:21.35pt;
margin-left:3.5pt;line-height:110%'><span style='position:relative;z-index:
-1895802880'><span style='left:0px;position:absolute;left:0px;top:-25px;
width:718px;height:43px'><img width=718 height=43
src=".NET%20Framework%20Notes%20for%20Professionals_files/image035.gif"></span></span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>var</span><span
style='font-size:9.0pt;line-height:110%'> readOnlyGroceryList </span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>=</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#0600FF'>new</span><span style='font-size:9.0pt;
line-height:110%'> ReadOnlyCollection</span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>&lt;</span><span style='font-size:9.0pt;
line-height:110%;color:#0600FF'>string</span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>&gt;(</span><span style='font-size:9.0pt;
line-height:110%'>groceryList</span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>);</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.35pt;
margin-left:.75pt;line-height:107%'><b>Using LINQ</b></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=86 style='width:.9in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=86 valign=top style='width:.9in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>AsReadOnly</span><span style='font-size:9.0pt;line-height:107%;
  color:#666666'>()</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>Additionaly, LINQ provides an extension method for <span
style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>IList</span>
objects:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:19.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src=".NET%20Framework%20Notes%20for%20Professionals_files/image097.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.35pt;
margin-left:.75pt;line-height:107%'><b>Note</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:14.15pt;
margin-left:1.05pt'>Typically, you want to maintain the source collection
privately and allow public access to the <span style='font-size:9.0pt;
line-height:109%;background:#FAFAFA'>ReadOnlyCollection</span>. While you could
create a <span style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>ReadOnlyCollection</span>
from an in-line list, you would be unable to modify the collection after you
created it.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:124.45pt;margin-bottom:
17.2pt;margin-left:3.5pt;line-height:110%'><span style='position:relative;
z-index:-1895801856'><span style='left:0px;position:absolute;left:0px;
top:-8px;width:718px;height:59px'><img width=718 height=59
src=".NET%20Framework%20Notes%20for%20Professionals_files/image098.gif"></span></span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>var</span><span
style='font-size:9.0pt;line-height:110%'> readOnlyGroceryList </span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>=</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#0600FF'>new</span><span style='font-size:9.0pt;
line-height:110%'> List</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>&lt;</span><span style='font-size:9.0pt;line-height:110%;
color:#0600FF'>string</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>&gt;</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>{</span><span
style='font-size:9.0pt;line-height:110%;color:#A60000'>&quot;Apple&quot;</span><span
style='font-size:9.0pt;line-height:110%'>, </span><span style='font-size:9.0pt;
line-height:110%;color:#A60000'>&quot;Banana&quot;</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>}.</span><span
style='font-size:9.0pt;line-height:110%'>AsReadOnly</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(); </span><i><span
style='font-size:9.0pt;line-height:110%;color:darkgreen'>// Great, but you will
not be able to update the grocery list because // you do not have a reference
to the source list anymore!</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:87.8pt;margin-bottom:
.25pt;margin-left:-.25pt;text-align:justify;text-justify:inter-ideograph;
line-height:135%'>If you find yourself doing this, you may want to consider
using another data structure, such as an <span style='font-size:9.0pt;
line-height:135%;background:#FAFAFA'>ImmutableCollection</span>. <b><span
style='font-size:18.0pt;line-height:135%;color:#1889D0'>Section 6.2: Updating a
ReadOnlyCollection</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>A <span style='font-size:9.0pt;line-height:109%;background:
#FAFAFA'>ReadOnlyCollection</span> cannot be edited directly. Instead, the
source collection is updated and the</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:14.85pt;
margin-left:1.05pt'><span style='font-size:9.0pt;line-height:109%;background:
#FAFAFA'>ReadOnlyCollection</span> will reflect these changes. This is the key
feature of the <span style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>ReadOnlyCollection</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:138.75pt;margin-bottom:
.2pt;margin-left:3.5pt;line-height:224%'><span style='position:relative;
z-index:-1895800832'><span style='left:0px;position:absolute;left:0px;
top:-9px;width:718px;height:207px'><img width=718 height=207
src=".NET%20Framework%20Notes%20for%20Professionals_files/image099.gif"></span></span><span
style='font-size:9.0pt;line-height:224%;color:#0600FF'>var</span><span
style='font-size:9.0pt;line-height:224%'> groceryList </span><span
style='font-size:9.0pt;line-height:224%;color:#666666'>=</span><span
style='font-size:9.0pt;line-height:224%'> </span><span style='font-size:9.0pt;
line-height:224%;color:#0600FF'>new</span><span style='font-size:9.0pt;
line-height:224%'> List</span><span style='font-size:9.0pt;line-height:224%;
color:#666666'>&lt;</span><span style='font-size:9.0pt;line-height:224%;
color:#0600FF'>string</span><span style='font-size:9.0pt;line-height:224%;
color:#666666'>&gt;</span><span style='font-size:9.0pt;line-height:224%'> </span><span
style='font-size:9.0pt;line-height:224%;color:#666666'>{</span><span
style='font-size:9.0pt;line-height:224%'> </span><span style='font-size:9.0pt;
line-height:224%;color:#A60000'>&quot;Apple&quot;</span><span style='font-size:
9.0pt;line-height:224%'>, </span><span style='font-size:9.0pt;line-height:224%;
color:#A60000'>&quot;Banana&quot;</span><span style='font-size:9.0pt;
line-height:224%'> </span><span style='font-size:9.0pt;line-height:224%;
color:#666666'>}; </span><span style='font-size:9.0pt;line-height:224%;
color:#0600FF'>var</span><span style='font-size:9.0pt;line-height:224%'>
readOnlyGroceryList </span><span style='font-size:9.0pt;line-height:224%;
color:#666666'>=</span><span style='font-size:9.0pt;line-height:224%'> </span><span
style='font-size:9.0pt;line-height:224%;color:#0600FF'>new</span><span
style='font-size:9.0pt;line-height:224%'> ReadOnlyCollection</span><span
style='font-size:9.0pt;line-height:224%;color:#666666'>&lt;</span><span
style='font-size:9.0pt;line-height:224%;color:#0600FF'>string</span><span
style='font-size:9.0pt;line-height:224%;color:#666666'>&gt;(</span><span
style='font-size:9.0pt;line-height:224%'>groceryList</span><span
style='font-size:9.0pt;line-height:224%;color:#666666'>); </span><span
style='font-size:9.0pt;line-height:224%;color:#0600FF'>var</span><span
style='font-size:9.0pt;line-height:224%'> itemCount </span><span
style='font-size:9.0pt;line-height:224%;color:#666666'>=</span><span
style='font-size:9.0pt;line-height:224%'> readOnlyGroceryList</span><span
style='font-size:9.0pt;line-height:224%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:224%'>Count</span><span style='font-size:
9.0pt;line-height:224%;color:#666666'>;</span><span style='font-size:9.0pt;
line-height:224%'> </span><i><span style='font-size:9.0pt;line-height:224%;
color:darkgreen'>// There are currently 2 items</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:17.25pt;margin-bottom:
12.45pt;margin-left:3.5pt;line-height:110%'><i><span style='font-size:9.0pt;
line-height:110%;color:darkgreen'>//readOnlyGroceryList.Add(&quot;Candy&quot;);
// Compiler Error - Items cannot be added to a ReadOnlyCollection object </span></i><span
style='font-size:9.0pt;line-height:110%'>groceryList</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>Add</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%;color:#A60000'>&quot;Vitamins&quot;</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>);</span><span
style='font-size:9.0pt;line-height:110%'> </span><i><span
style='font-size:9.0pt;line-height:110%;color:darkgreen'>// ..but they can be
added to the original collection</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%'>itemCount </span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>=</span><span style='font-size:9.0pt;line-height:110%'>
readOnlyGroceryList</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%'>Count</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>;</span><span
style='font-size:9.0pt;line-height:110%'> </span><i><span
style='font-size:9.0pt;line-height:110%;color:darkgreen'>// Now there are 3
items</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:17.25pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%;color:#0600FF'>var</span><span style='font-size:9.0pt;line-height:110%'>
lastItem </span><span style='font-size:9.0pt;line-height:110%;color:#666666'>=</span><span
style='font-size:9.0pt;line-height:110%'> readOnlyGroceryList</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>Last</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>();</span><span style='font-size:9.0pt;
line-height:110%'> </span><i><span style='font-size:9.0pt;line-height:110%;
color:darkgreen'>// The last item on the read only list is now
&quot;Vitamins&quot;</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:18.8pt;
margin-left:-.25pt;line-height:107%'><a href="https://dotnetfiddle.net/C8qQrS"><span
style='color:#1889D0'>View Demo</span></a></p>

<h3 style='margin-top:0in;margin-right:0in;margin-bottom:3.4pt;margin-left:
-.25pt'>Section 6.3: Warning: Elements in a ReadOnlyCollection are not
inherently read-only</h3>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>If the source collection is of a type that is not
immutable, elements accessed through a <span style='font-size:9.0pt;line-height:
109%;background:#FAFAFA'>ReadOnlyCollection</span> can be modified.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=486
src=".NET%20Framework%20Notes%20for%20Professionals_files/image100.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.15pt;
margin-left:-.25pt;line-height:107%'><a href="https://dotnetfiddle.net/fXE66F"><span
style='color:#1889D0'>View Demo</span></a></p>

<h1 style='margin-left:-.25pt'><a name="_Toc281384">Chapter 7: Stack and Heap</a></h1>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc281385">Section 7.1: Value types in use</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:13.15pt;
margin-left:1.05pt'>Value types simply contain a <b><i>value</i></b>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:13.15pt;
margin-left:1.05pt'>All value types are derived from the <a
href="https://msdn.microsoft.com/en-us/library/system.valuetype.aspx"><span
style='color:#1889D0'>System.ValueType</span></a> class, and this includes most
of the built in types.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>When creating a new value type, the an area of memory
called <b><i>the stack</i></b> is used.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.55pt;
margin-left:1.05pt'>The stack will grow accordingly, by the size the declared
type. So for example, an int will always be allocated 32 bits of memory on the
stack. When the value type is no longer in scope, the space on the stack will
be deallocated.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.8pt;
margin-left:1.05pt'>The code below demonstrates a value type being assigned to
a new variable. A struct is being used as a convenient way to create a custom
value type (the System.ValueType class cannot be otherwise extended).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>The important thing to understand is that when assigning a
value type, the value itself <b><i>copied</i></b> to the new variable, meaning
we have two distinct instances of the object, that cannot affect each other.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=437
src=".NET%20Framework%20Notes%20for%20Professionals_files/image101.gif"></span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc281386">Section 7.2: Reference types in use</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:26.2pt;margin-bottom:
12.75pt;margin-left:1.05pt'>Reference types are comprised of both a <b><i>reference</i></b>
to a memory area, and a <b><i>value</i></b> stored within that area. This is
analogous to pointers in C/C++.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>All reference types are stored on what is known as <b><i>the
heap</i></b>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.55pt;
margin-left:1.05pt'>The heap is simply a managed area of memory where objects
are stored. When a new object is instantiated, a part of the heap will be
allocated for use by that object, and a reference to that location of the heap
will be returned. The heap is managed and maintained by the <i>garbage
collector</i>, and does not allow for manual intervention.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.9pt;
margin-left:1.05pt'>In addition to the memory space required for the instance
itself, additional space is required to store the reference itself, along with
additional temporary information required by the .NET CLR.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.8pt;
margin-left:1.05pt'>The code below demonstrates a reference type being assigned
to a new variable. In this instance, we are using a class, all classes are
reference types (even if static).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.5pt;
margin-left:1.05pt'>When a reference type is assigned to another variable, it
is the <b><i>reference</i></b> to the object that is copied over, <b>not</b>
the value itself. This is an important distinction between value types and
reference types.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:147.95pt;margin-bottom:
1.6pt;margin-left:1.05pt'>The implications of this are that we now have <i>two</i>
references to the same object. Any changes to the values within that object
will be reflected by both variables.</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=421
src=".NET%20Framework%20Notes%20for%20Professionals_files/image102.gif"></span></p>

<h1 style='margin-left:-.25pt'><a name="_Toc281387">Chapter 8: LINQ</a></h1>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.25pt;
margin-left:-.25pt;text-align:justify;text-justify:inter-ideograph;line-height:
107%'>LINQ (Language Integrated Query) is an expression that retrieves data
from a data source. LINQ simplifies this situation by offering a consistent
model for working with data across various kinds of data sources and formats.
In a LINQ query, you are always working with objects. You use the same basic
coding patterns to query and transform data in XML documents, SQL databases,
ADO.NET Datasets, .NET collections, and any other format for which a provider
is available. LINQ can be used in C# and VB.</p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:.25pt;margin-left:
-.25pt;text-align:justify;text-justify:inter-ideograph'><a name="_Toc281388">Section
8.1: SelectMany (flat map)</a></h2>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=657
 style='width:492.45pt;border-collapse:collapse'>
 <tr style='height:.15in'>
  <td width=72 valign=top style='width:.75in;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><a
  href="https://msdn.microsoft.com/en-us/library/bb548891(v=vs.100).aspx"><span
  style='font-size:9.0pt;line-height:107%;color:#1889D0'>Enumerable</span></a></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><a
  href="https://msdn.microsoft.com/en-us/library/bb548891(v=vs.100).aspx"><span
  style='font-size:9.0pt;line-height:107%;color:#666666;background:#FAFAFA'>.</span></a></p>
  </td>
  <td width=43 valign=top style='width:.45in;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><a
  href="https://msdn.microsoft.com/en-us/library/bb548891(v=vs.100).aspx"><span
  style='font-size:9.0pt;line-height:107%;color:#0600FF'>Select</span></a></p>
  </td>
  <td width=383 valign=top style='width:287.25pt;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'>returns an output element for every input
  element. Whereas </p>
  </td>
  <td width=72 valign=top style='width:.75in;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><a
  href="https://msdn.microsoft.com/en-us/library/bb534336(v=vs.100).aspx"><span
  style='font-size:9.0pt;line-height:107%;color:#1889D0'>Enumerable</span></a></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><a
  href="https://msdn.microsoft.com/en-us/library/bb534336(v=vs.100).aspx"><span
  style='font-size:9.0pt;line-height:107%;color:#666666;background:#FAFAFA'>.</span></a></p>
  </td>
  <td width=72 valign=top style='width:.75in;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><a
  href="https://msdn.microsoft.com/en-us/library/bb534336(v=vs.100).aspx"><span
  style='font-size:9.0pt;line-height:107%;color:#1889D0'>SelectMany</span></a></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.75pt;
margin-left:1.05pt'>produces a variable number of output elements for each
input element. This means that the output sequence may contain more or fewer
elements than were in the input sequence.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=122 style='width:91.8pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=72 valign=top style='width:.75in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Enumerable</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>.</span></p>
  </td>
  <td width=43 valign=top style='width:.45in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#0600FF'>Select</span></p>
  </td>
 </tr>
</table>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=151 style='width:113.4pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=72 valign=top style='width:.75in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Enumerable</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>.</span></p>
  </td>
  <td width=72 valign=top style='width:.75in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>SelectMany</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:6.45pt;margin-bottom:
1.6pt;margin-left:113.95pt;text-indent:-113.4pt'><span style='font-size:9.0pt;
line-height:109%;background:#FAFAFA'>Lambda expressions</span> passed to must
return a single item. Lambda expressions passed to must produce a child
sequence. This child sequence may contain a varying number of</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:13.15pt;
margin-left:1.05pt'>elements for each element in the input sequence.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:.75pt;line-height:107%'><b>Example</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=585
src=".NET%20Framework%20Notes%20for%20Professionals_files/image103.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.35pt;
margin-left:.75pt;line-height:107%'><b>Output:</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.2pt;
margin-left:0in;text-indent:0in'><span style='font-size:11.0pt;line-height:
109%'> <img border=0 width=3 height=36 id="Group 237504"
src=".NET%20Framework%20Notes%20for%20Professionals_files/image104.gif"></span> 1,2,3,4,5,6</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.1pt;
margin-left:-.25pt;line-height:107%'><a href="https://dotnetfiddle.net/XKGtBr"><span
style='color:#1889D0'>View Demo</span></a></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=151 style='width:113.4pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=72 valign=top style='width:.75in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Enumerable</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>.</span></p>
  </td>
  <td width=72 valign=top style='width:.75in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>SelectMany</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal align=right style='margin-top:0in;margin-right:32.95pt;
margin-bottom:0in;margin-left:.5pt;text-align:right;line-height:107%'>can also
be achieved with a syntax-based query using two consecutive <span
style='font-size:9.0pt;line-height:107%;color:#0600FF;background:#FAFAFA'>from</span>
clauses:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=76
src=".NET%20Framework%20Notes%20for%20Professionals_files/image105.gif"></span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:2.5pt;margin-left:
-.25pt'><a name="_Toc281389">Section 8.2: Where (filter)</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:63.05pt;margin-bottom:
0in;margin-left:1.05pt;line-height:217%'>This method returns an IEnumerable
with all the elements that meets the lambda expression <b>Example</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=125
src=".NET%20Framework%20Notes%20for%20Professionals_files/image106.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.05pt;
margin-left:.75pt;line-height:107%'><b>Output:</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.2pt;
margin-left:0in;text-indent:0in'><span style='font-size:11.0pt;line-height:
109%'> <img border=0 width=3 height=51 id="Group 237506"
src=".NET%20Framework%20Notes%20for%20Professionals_files/image107.gif"></span> Foo,Fizz</p>

<p class=MsoNormal style='margin-top:0in;margin-right:402.5pt;margin-bottom:
0in;margin-left:-.25pt;line-height:145%'><a
href="https://dotnetfiddle.net/nTbZI0"><span style='color:#1889D0'>View Demo</span></a></p>

<h2 style='margin-top:0in;margin-right:402.5pt;margin-bottom:0in;margin-left:
-.25pt;margin-bottom:.0001pt;line-height:145%'><a name="_Toc281390">Section
8.3: Any</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>Returns <span style='font-size:9.0pt;line-height:109%;
color:#0600FF;background:#FAFAFA'>true</span> if the collection has any
elements that meets the condition in the lambda expression:</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=273
src=".NET%20Framework%20Notes%20for%20Professionals_files/image108.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc281391">Section 8.4: GroupJoin</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
0in;margin-left:-.45pt;text-indent:0in;line-height:107%'><img border=0
width=719 height=989 id="Picture 275283"
src=".NET%20Framework%20Notes%20for%20Professionals_files/image109.gif"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.25pt;
margin-left:3.5pt;line-height:110%'><i><span style='font-size:9.0pt;line-height:
110%;color:darkgreen'>//Foobuzz's projects: Hello World 3D, Super Fizzbuzz
Maker</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:23.0pt;
margin-left:3.5pt;line-height:110%'><span style='position:relative;z-index:
-1895799808'><span style='left:0px;position:absolute;left:0px;top:-2769px;
width:718px;height:1px'><img width=718 height=1
src=".NET%20Framework%20Notes%20for%20Professionals_files/image110.gif"></span></span><i><span
style='font-size:9.0pt;line-height:110%;color:darkgreen'>//Barfizz's projects:
Citizen Kane - The action game, Pro Pong 2016</span></i></p>

<h2 style='margin-left:-.25pt'><a name="_Toc281392">Section 8.5: Except</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=142
src=".NET%20Framework%20Notes%20for%20Professionals_files/image111.gif"></span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:3.65pt;margin-left:
-.25pt'><a name="_Toc281393">Section 8.6: Zip</a></h2>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>.NET <span
style='font-size:8.0pt;line-height:107%;font-family:"DejaVu Sans Mono";
color:#666666'>Version &#8805; 4.0</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=142
src=".NET%20Framework%20Notes%20for%20Professionals_files/image112.gif"></span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:2.5pt;margin-left:
-.25pt'><a name="_Toc281394">Section 8.7: Aggregate (fold)</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>Generating a new object in each step:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=125
src=".NET%20Framework%20Notes%20for%20Professionals_files/image113.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>Using the same object in all steps:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=92
src=".NET%20Framework%20Notes%20for%20Professionals_files/image114.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:14.55pt;
margin-left:1.05pt'>Using a result selector:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:232.4pt;margin-bottom:
.2pt;margin-left:3.5pt;line-height:110%'><span style='position:relative;
z-index:-1895798784'><span style='left:0px;position:absolute;left:0px;
top:-3593px;width:718px;height:1px'><img width=718 height=1
src=".NET%20Framework%20Notes%20for%20Professionals_files/image115.gif"></span></span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>var</span><span
style='font-size:9.0pt;line-height:110%'> commaSeparatedElements3 </span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>=</span><span
style='font-size:9.0pt;line-height:110%'> elements</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>Aggregate</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>( </span><span
style='font-size:9.0pt;line-height:110%'>seed</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>:</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:#0600FF'>new</span><span style='font-size:9.0pt;line-height:110%'>
StringBuilder</span><span style='font-size:9.0pt;line-height:110%;color:#666666'>()</span><span
style='font-size:9.0pt;line-height:110%'>, func</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>:</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>(</span><span style='font-size:9.0pt;
line-height:110%'>seed, element</span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>)</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>=&gt;</span><span
style='font-size:9.0pt;line-height:110%'> seed</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>.</span><span style='font-size:9.0pt;
line-height:110%'>Append</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>(</span><span style='font-size:9.0pt;line-height:110%'>$</span><span
style='font-size:9.0pt;line-height:110%;color:#A60000'>&quot;{element},&quot;</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>)</span><span
style='font-size:9.0pt;line-height:110%'>, resultSelector</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>:</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>(</span><span style='font-size:9.0pt;
line-height:110%'>seed</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>)</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>=&gt;</span><span
style='font-size:9.0pt;line-height:110%'> seed</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>.</span><span style='font-size:9.0pt;
line-height:110%'>ToString</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>());</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:17.25pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%'>Console</span><span style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>WriteLine</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%'>commaSeparatedElements3</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>);</span><span
style='font-size:9.0pt;line-height:110%'> </span><i><span style='font-size:
9.0pt;line-height:110%;color:darkgreen'>//1,2,3,4,5,</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>If a seed is omitted, the first element becomes the seed:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=92
src=".NET%20Framework%20Notes%20for%20Professionals_files/image116.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc281395">Section 8.8: ToLookup</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=322
src=".NET%20Framework%20Notes%20for%20Professionals_files/image117.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc281396">Section 8.9: Intersect</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=142
src=".NET%20Framework%20Notes%20for%20Professionals_files/image118.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc281397">Section 8.10: Concat</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=142
src=".NET%20Framework%20Notes%20for%20Professionals_files/image119.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:18.7pt;
margin-left:1.05pt'>Note that duplicates are kept in the result. If this is
undesirable, use <span style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>Union</span>
instead.</p>

<h2 style='margin-left:-.25pt'><a name="_Toc281398">Section 8.11: All</a></h2>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=66
src=".NET%20Framework%20Notes%20for%20Professionals_files/image120.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=71
src=".NET%20Framework%20Notes%20for%20Professionals_files/image121.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>Note that the <span style='font-size:9.0pt;line-height:
109%;background:#FAFAFA'>All</span> method functions by checking for the first
element to evaluate as <span style='font-size:9.0pt;line-height:109%;
color:#0600FF;background:#FAFAFA'>false</span> according to the predicate.
Therefore, the method will return <span style='font-size:9.0pt;line-height:
109%;color:#0600FF;background:#FAFAFA'>true</span> for <i>any</i> predicate in
the case that the set is empty:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src=".NET%20Framework%20Notes%20for%20Professionals_files/image122.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc281399">Section 8.12: Sum</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=223
src=".NET%20Framework%20Notes%20for%20Professionals_files/image123.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc281400">Section 8.13: SequenceEqual</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=158
src=".NET%20Framework%20Notes%20for%20Professionals_files/image124.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc281401">Section 8.14: Min</a></h2>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=223
src=".NET%20Framework%20Notes%20for%20Professionals_files/image125.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc281402">Section 8.15: Distinct</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=109
src=".NET%20Framework%20Notes%20for%20Professionals_files/image126.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc281403">Section 8.16: Count</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=125
src=".NET%20Framework%20Notes%20for%20Professionals_files/image127.gif"></span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc281404">Section 8.17: Cast</a></h2>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=79 style='width:59.4pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=79 valign=top style='width:59.4pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>IEnumerable</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.75pt;
margin-left:59.95pt;text-indent:-59.4pt'><span style='font-size:9.0pt;
line-height:109%;background:#FAFAFA'>Cast</span> is different from the other
methods of <span style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>Enumerable</span>
in that it is an extension method for <span style='font-size:9.0pt;line-height:
109%;background:#FAFAFA'>IEnumerable</span>, not for <span style='font-size:
9.0pt;line-height:109%;color:#666666;background:#FAFAFA'>&lt;</span><span
style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>T</span><span
style='font-size:9.0pt;line-height:109%;color:#666666;background:#FAFAFA'>&gt;</span>.
Thus it can be used to convert instances of the former into instances of the
later.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=79 style='width:59.4pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=79 valign=top style='width:59.4pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>IEnumerable</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>This does not compile since <span style='font-size:9.0pt;
line-height:109%;background:#FAFAFA'>ArrayList</span> does not implement <span
style='font-size:9.0pt;line-height:109%;color:#666666;background:#FAFAFA'>&lt;</span><span
style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>T</span><span
style='font-size:9.0pt;line-height:109%;color:#666666;background:#FAFAFA'>&gt;</span>:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src=".NET%20Framework%20Notes%20for%20Professionals_files/image128.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>This works as expected:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.4pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src=".NET%20Framework%20Notes%20for%20Professionals_files/image129.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'><span style='font-size:9.0pt;line-height:109%;background:
#FAFAFA'>Cast</span> does <b>not</b> perform conversion casts. The following
compiles but throws <span style='font-size:9.0pt;line-height:109%;background:
#FAFAFA'>InvalidCastException</span> at runtime:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src=".NET%20Framework%20Notes%20for%20Professionals_files/image130.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>The proper way to perform a converting cast to a collection
is as follows:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src=".NET%20Framework%20Notes%20for%20Professionals_files/image131.gif"></span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:2.55pt;margin-left:
-.25pt'><a name="_Toc281405">Section 8.18: Range</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>The two parameters to <span style='font-size:9.0pt;
line-height:109%;background:#FAFAFA'>Range</span> are the <i>first</i> number
and the <i>count</i> of elements to produce (not the last number).</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=92
src=".NET%20Framework%20Notes%20for%20Professionals_files/image132.gif"></span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc281406">Section 8.19: ThenBy</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'><span style='font-size:9.0pt;line-height:109%;background:
#FAFAFA'>ThenBy</span> can only be used after a <span style='font-size:9.0pt;
line-height:109%;background:#FAFAFA'>OrderBy</span> clause allowing to order
using multiple criteria</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=256
src=".NET%20Framework%20Notes%20for%20Professionals_files/image133.gif"></span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:2.5pt;margin-left:
-.25pt'><a name="_Toc281407">Section 8.20: Repeat</a></h2>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=122 style='width:91.8pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=122 valign=top style='width:91.8pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Enumerable</span><span style='font-size:9.0pt;line-height:107%;
  color:#666666'>.</span><span style='font-size:9.0pt;line-height:107%'>Repeat</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal align=right style='margin-top:0in;margin-right:41.75pt;
margin-bottom:0in;margin-left:.5pt;text-align:right;line-height:107%'>generates
a sequence of a repeated value. In this example it generates &quot;Hello&quot;
4 times.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=223
src=".NET%20Framework%20Notes%20for%20Professionals_files/image134.gif"></span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:2.5pt;margin-left:
-.25pt'><a name="_Toc281408">Section 8.21: Empty</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>To create an empty IEnumerable of int:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src=".NET%20Framework%20Notes%20for%20Professionals_files/image135.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:14.55pt;
margin-left:1.05pt'>This empty IEnumerable is cached for each Type T, so that:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%'>Enumerable</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%'>Empty</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>&lt;</span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>decimal</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>&gt;()</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>==</span><span style='font-size:9.0pt;
line-height:110%'> Enumerable</span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%'>Empty</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>&lt;</span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>decimal</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>&gt;();</span><span
style='font-size:9.0pt;line-height:110%'> </span><i><span style='font-size:
9.0pt;line-height:110%;color:darkgreen'>// This is True</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:23.0pt;
margin-left:3.5pt;line-height:110%'><span style='position:relative;z-index:
-1895797760'><span style='left:0px;position:absolute;left:0px;top:-7334px;
width:718px;height:1px'><img width=718 height=1
src=".NET%20Framework%20Notes%20for%20Professionals_files/image136.gif"></span></span><span
style='font-size:9.0pt;line-height:110%'>Enumerable</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>Empty</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>&lt;</span><span style='font-size:9.0pt;
line-height:110%;color:#0600FF'>int</span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>&gt;()</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>==</span><span style='font-size:9.0pt;line-height:110%'>
Enumerable</span><span style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>Empty</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>&lt;</span><span style='font-size:9.0pt;
line-height:110%;color:#0600FF'>decimal</span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>&gt;();</span><span style='font-size:9.0pt;
line-height:110%'> </span><i><span style='font-size:9.0pt;line-height:110%;
color:darkgreen'>// This is False</span></i></p>

<h2 style='margin-left:-.25pt'><a name="_Toc281409">Section 8.22: Select (map)</a></h2>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=112
src=".NET%20Framework%20Notes%20for%20Professionals_files/image137.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=104
src=".NET%20Framework%20Notes%20for%20Professionals_files/image138.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:18.65pt;
margin-left:1.05pt'>This type of function is usually called <span
style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>map</span> in
functional programming languages.</p>

<h2 style='margin-left:-.25pt'><a name="_Toc281410">Section 8.23: OrderBy</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=223
src=".NET%20Framework%20Notes%20for%20Professionals_files/image139.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc281411">Section 8.24:
OrderByDescending</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=223
src=".NET%20Framework%20Notes%20for%20Professionals_files/image140.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc281412">Section 8.25: Contains</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src=".NET%20Framework%20Notes%20for%20Professionals_files/image141.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc281413">Section 8.26: First (find)</a></h2>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=125
src=".NET%20Framework%20Notes%20for%20Professionals_files/image142.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>The following throws <span style='font-size:9.0pt;
line-height:109%;background:#FAFAFA'>InvalidOperationException</span> with
message &quot;Sequence contains no matching element&quot;:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src=".NET%20Framework%20Notes%20for%20Professionals_files/image143.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc281414">Section 8.27: Single</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=142
src=".NET%20Framework%20Notes%20for%20Professionals_files/image144.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>The following throws <span style='font-size:9.0pt;
line-height:109%;background:#FAFAFA'>InvalidOperationException</span> since
there is more than one element in the sequence:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src=".NET%20Framework%20Notes%20for%20Professionals_files/image145.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc281415">Section 8.28: Last</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:11.9pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=159
src=".NET%20Framework%20Notes%20for%20Professionals_files/image146.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src=".NET%20Framework%20Notes%20for%20Professionals_files/image147.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc281416">Section 8.29: LastOrDefault</a></h2>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=359
src=".NET%20Framework%20Notes%20for%20Professionals_files/image148.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=21
src=".NET%20Framework%20Notes%20for%20Professionals_files/image149.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc281417">Section 8.30:
SingleOrDefault</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:11.9pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=225
src=".NET%20Framework%20Notes%20for%20Professionals_files/image150.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src=".NET%20Framework%20Notes%20for%20Professionals_files/image151.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc281418">Section 8.31:
FirstOrDefault</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=355
src=".NET%20Framework%20Notes%20for%20Professionals_files/image152.gif"></span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:2.5pt;margin-left:
-.25pt'><a name="_Toc281419">Section 8.32: Skip</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>Skip will enumerate the first N items without returning
them. Once item number N+1 is reached, Skip starts returning every enumerated
item:</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=109
src=".NET%20Framework%20Notes%20for%20Professionals_files/image153.gif"></span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:2.55pt;margin-left:
-.25pt'><a name="_Toc281420">Section 8.33: Take</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>This method takes the first <span style='font-size:9.0pt;
line-height:109%;background:#FAFAFA'>n</span> elements from an enumerable.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=109
src=".NET%20Framework%20Notes%20for%20Professionals_files/image154.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc281421">Section 8.34: Reverse</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=109
src=".NET%20Framework%20Notes%20for%20Professionals_files/image155.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc281422">Section 8.35: OfType</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=109
src=".NET%20Framework%20Notes%20for%20Professionals_files/image156.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc281423">Section 8.36: Max</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=223
src=".NET%20Framework%20Notes%20for%20Professionals_files/image157.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc281424">Section 8.37: Average</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=92
src=".NET%20Framework%20Notes%20for%20Professionals_files/image158.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>This method calculates the average of enumerable of
numbers.</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=32
src=".NET%20Framework%20Notes%20for%20Professionals_files/image159.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=136
src=".NET%20Framework%20Notes%20for%20Professionals_files/image160.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:118.95pt;margin-bottom:
0in;margin-left:1.05pt;line-height:145%'>This method calculates the average of
enumerable using delegated function.</p>

<h2 style='margin-top:0in;margin-right:118.95pt;margin-bottom:0in;margin-left:
1.05pt;margin-bottom:.0001pt;line-height:145%'><a name="_Toc281425">Section
8.38: GroupBy</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=322
src=".NET%20Framework%20Notes%20for%20Professionals_files/image161.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:14.55pt;
margin-left:1.05pt'>Group invoices by country, generating a new object with the
number of record, total paid, and average paid</p>

<p class=MsoNormal style='margin-top:0in;margin-right:254.05pt;margin-bottom:
.2pt;margin-left:3.5pt;line-height:110%'><span style='position:relative;
z-index:-1895796736'><span style='left:0px;position:absolute;left:0px;
top:-11999px;width:718px;height:1px'><img width=718 height=1
src=".NET%20Framework%20Notes%20for%20Professionals_files/image115.gif"></span></span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>var</span><span
style='font-size:9.0pt;line-height:110%'> a </span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>=</span><span style='font-size:9.0pt;
line-height:110%'> db</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%'>Invoices</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>GroupBy</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>(</span><span style='font-size:9.0pt;
line-height:110%'>i </span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>=&gt;</span><span style='font-size:9.0pt;line-height:110%'> i</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>Country</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>) </span><span style='font-size:9.0pt;
line-height:110%'></span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%;
color:#0600FF'>Select</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>(</span><span style='font-size:9.0pt;line-height:110%'>g </span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>=&gt;</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#0600FF'>new</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>{</span><span style='font-size:9.0pt;line-height:110%'> Country </span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>=</span><span
style='font-size:9.0pt;line-height:110%'> g</span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>.</span><span style='font-size:9.0pt;
line-height:110%'>Key,</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%'> Count </span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>=</span><span style='font-size:9.0pt;
line-height:110%'> g</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%'>Count</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>()</span><span
style='font-size:9.0pt;line-height:110%'>,</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%'> Total </span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>=</span><span style='font-size:9.0pt;
line-height:110%'> g</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%'>Sum</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%'>i </span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>=&gt;</span><span style='font-size:9.0pt;
line-height:110%'> i</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%'>Paid</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>)</span><span
style='font-size:9.0pt;line-height:110%'>,</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:17.25pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%'> Average </span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>=</span><span style='font-size:9.0pt;
line-height:110%'> g</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%'>Average</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%'>i </span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>=&gt;</span><span style='font-size:9.0pt;
line-height:110%'> i</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%'>Paid</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>)</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>});</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:14.55pt;
margin-left:1.05pt'>If we want only the totals, no group</p>

<p class=MsoNormal style='margin-top:0in;margin-right:281.05pt;margin-bottom:
.2pt;margin-left:3.5pt;line-height:110%'><span style='position:relative;
z-index:-1895795712'><span style='left:0px;position:absolute;left:0px;
top:-12148px;width:718px;height:1px'><img width=718 height=1
src=".NET%20Framework%20Notes%20for%20Professionals_files/image162.gif"></span></span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>var</span><span
style='font-size:9.0pt;line-height:110%'> a </span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>=</span><span style='font-size:9.0pt;
line-height:110%'> db</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%'>Invoices</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>GroupBy</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>(</span><span style='font-size:9.0pt;
line-height:110%'>i </span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>=&gt;</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:red'>1</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>) </span><span
style='font-size:9.0pt;line-height:110%'></span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>Select</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%'>g </span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>=&gt;</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:#0600FF'>new</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>{</span><span
style='font-size:9.0pt;line-height:110%'> Count </span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>=</span><span style='font-size:9.0pt;
line-height:110%'> g</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%'>Count</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>()</span><span
style='font-size:9.0pt;line-height:110%'>,</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%'> Total </span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>=</span><span style='font-size:9.0pt;
line-height:110%'> g</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%'>Sum</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%'>i </span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>=&gt;</span><span style='font-size:9.0pt;
line-height:110%'> i</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%'>Paid</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>)</span><span
style='font-size:9.0pt;line-height:110%'>,</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:17.25pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%'> Average </span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>=</span><span style='font-size:9.0pt;
line-height:110%'> g</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%'>Average</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%'>i </span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>=&gt;</span><span style='font-size:9.0pt;
line-height:110%'> i</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%'>Paid</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>)</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>});</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:14.55pt;
margin-left:1.05pt'>If we need several counts</p>

<p class=MsoNormal style='margin-top:0in;margin-right:183.85pt;margin-bottom:
.2pt;margin-left:3.5pt;line-height:110%'><span style='position:relative;
z-index:-1895794688'><span style='left:0px;position:absolute;left:0px;
top:-12279px;width:718px;height:1px'><img width=718 height=1
src=".NET%20Framework%20Notes%20for%20Professionals_files/image162.gif"></span></span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>var</span><span
style='font-size:9.0pt;line-height:110%'> a </span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>=</span><span style='font-size:9.0pt;
line-height:110%'> db</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%'>Invoices</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>GroupBy</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>(</span><span style='font-size:9.0pt;
line-height:110%'>g </span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>=&gt;</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:red'>1</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>) </span><span
style='font-size:9.0pt;line-height:110%'></span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>Select</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%'>g </span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>=&gt;</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:#0600FF'>new</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>{</span><span
style='font-size:9.0pt;line-height:110%'> High </span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>=</span><span style='font-size:9.0pt;
line-height:110%'> g</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%'>Count</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%'>i </span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>=&gt;</span><span style='font-size:9.0pt;
line-height:110%'> i</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%'>Paid </span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>&gt;=</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:red'>1000</span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>)</span><span style='font-size:9.0pt;line-height:110%'>,</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%'> Low </span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>=</span><span style='font-size:9.0pt;
line-height:110%'> g</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%'>Count</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%'>i </span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>=&gt;</span><span style='font-size:9.0pt;
line-height:110%'> i</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%'>Paid </span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>&lt;</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:red'>1000</span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>)</span><span style='font-size:9.0pt;line-height:110%'>,</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:23.0pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%'> Sum </span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>=</span><span style='font-size:9.0pt;
line-height:110%'> g</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%'>Sum</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%'>i </span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>=&gt;</span><span style='font-size:9.0pt;
line-height:110%'> i</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%'>Paid</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>)</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>});</span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:2.6pt;margin-left:
-.25pt'><a name="_Toc281426">Section 8.39: ToDictionary</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>Returns a new dictionary from the source <span
style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>IEnumerable</span>
using the provided keySelector function to determine keys.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>Will throw an <span style='font-size:9.0pt;line-height:
109%;background:#FAFAFA'>ArgumentException</span> if keySelector is not
injective(returns a unique value for each member of the source collection.)
There are overloads which allow one to specify the value to be stored as well
as the key.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=109
src=".NET%20Framework%20Notes%20for%20Professionals_files/image163.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=144 style='width:1.5in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=72 valign=top style='width:.75in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Dictionary</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>&lt;</span>&nbsp;</p>
  </td>
  <td width=65 valign=top style='width:48.6pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>TKey,TVal</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>Specifying just a key selector function will create a <span
style='font-size:9.0pt;line-height:109%;color:#666666;background:#FAFAFA'>&gt;</span>
with <span style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>TKey</span>
the return Type of the key selector, <span style='font-size:9.0pt;line-height:
109%;background:#FAFAFA'>TVal</span> the original object Type, and the original
object as the stored value.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=92
src=".NET%20Framework%20Notes%20for%20Professionals_files/image164.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=144 style='width:1.5in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=72 valign=top style='width:.75in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Dictionary</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>&lt;</span>&nbsp;</p>
  </td>
  <td width=65 valign=top style='width:48.6pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>TKey,TVal</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>Specifying a value selector function as well will create a <span
style='font-size:9.0pt;line-height:109%;color:#666666;background:#FAFAFA'>&gt;</span>
with <span style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>TKey</span>
still the return type of the key selector, but <span style='font-size:9.0pt;
line-height:109%;background:#FAFAFA'>TVal</span> now the return type of the
value selector function, and the returned value as the stored value.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=92
src=".NET%20Framework%20Notes%20for%20Professionals_files/image165.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>As stated above, the keys returned by the key selector must
be unique. The following will throw an exception.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=158
src=".NET%20Framework%20Notes%20for%20Professionals_files/image166.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>If a unique key can not be given for the source collection,
consider using ToLookup instead. On the surface,</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.25pt;
margin-left:-.25pt;text-align:justify;text-justify:inter-ideograph;line-height:
135%'>ToLookup behaves similarly to ToDictionary, however, in the resulting
Lookup each key is paired with a collection of values with matching keys.</p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:.25pt;margin-left:
-.25pt;text-align:justify;text-justify:inter-ideograph;line-height:135%'><a
name="_Toc281427">Section 8.40: Union</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=142
src=".NET%20Framework%20Notes%20for%20Professionals_files/image167.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>Note that duplicates are removed from the result. If this
is undesirable, use <span style='font-size:9.0pt;line-height:109%;background:
#FAFAFA'>Concat</span> instead.</p>

<h2 style='margin-left:-.25pt'><a name="_Toc281428">Section 8.41: ToArray</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=174
src=".NET%20Framework%20Notes%20for%20Professionals_files/image168.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc281429">Section 8.42: ToList</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=207
src=".NET%20Framework%20Notes%20for%20Professionals_files/image169.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc281430">Section 8.43: ElementAt</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=158
src=".NET%20Framework%20Notes%20for%20Professionals_files/image170.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc281431">Section 8.44:
ElementAtOrDefault</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=174
src=".NET%20Framework%20Notes%20for%20Professionals_files/image171.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc281432">Section 8.45: SkipWhile</a></h2>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=45
src=".NET%20Framework%20Notes%20for%20Professionals_files/image172.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=87
src=".NET%20Framework%20Notes%20for%20Professionals_files/image173.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc281433">Section 8.46: TakeWhile</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=125
src=".NET%20Framework%20Notes%20for%20Professionals_files/image174.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc281434">Section 8.47:
DefaultIfEmpty</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=240
src=".NET%20Framework%20Notes%20for%20Professionals_files/image175.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc281435">Section 8.48: Join</a></h2>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=403
src=".NET%20Framework%20Notes%20for%20Professionals_files/image176.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=596
src=".NET%20Framework%20Notes%20for%20Professionals_files/image177.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc281436">Section 8.49: Left Outer
Join</a></h2>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=374
src=".NET%20Framework%20Notes%20for%20Professionals_files/image178.gif"></span></p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=218
src=".NET%20Framework%20Notes%20for%20Professionals_files/image179.gif"></span><br
clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc281437">Chapter 9: ForEach</a></h1>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:2.5pt;margin-left:
-.25pt'><a name="_Toc281438">Section 9.1: Extension method for IEnumerable</a></h2>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=550 style='width:412.35pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=65 valign=top style='width:48.6pt;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#0600FF'>ForEach</span><span style='font-size:9.0pt;line-height:
  107%;color:#666666'>()</span></p>
  </td>
  <td width=111 valign=top style='width:83.3pt;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'>is defined on the </p>
  </td>
  <td width=50 valign=top style='width:37.8pt;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>List</span><span style='font-size:9.0pt;line-height:107%;color:#666666'>&lt;</span><span
  style='font-size:9.0pt;line-height:107%'>T</span><span style='font-size:9.0pt;
  line-height:107%;color:#666666'>&gt;</span></p>
  </td>
  <td width=109 valign=top style='width:81.55pt;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'>class, but not on </p>
  </td>
  <td width=94 valign=top style='width:70.2pt;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>IQueryable</span><span style='font-size:9.0pt;line-height:107%;
  color:#666666'>&lt;</span><span style='font-size:9.0pt;line-height:107%'>T</span><span
  style='font-size:9.0pt;line-height:107%;color:#666666'>&gt;</span></p>
  </td>
  <td width=20 valign=top style='width:15.3pt;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'>or </p>
  </td>
  <td width=101 valign=top style='width:1.05in;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>IEnumerable</span><span style='font-size:9.0pt;line-height:107%;
  color:#666666'>&lt;</span><span style='font-size:9.0pt;line-height:107%'>T</span><span
  style='font-size:9.0pt;line-height:107%;color:#666666'>&gt;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.8pt;
margin-left:1.05pt'>. You have two choices in those cases:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.35pt;
margin-left:.75pt;line-height:107%'><b>ToList first</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>The enumeration (or query) will be evaluated, copying the
results into a new list or calling the database. The method is then called on
each item.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src=".NET%20Framework%20Notes%20for%20Professionals_files/image180.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:13.15pt;
margin-left:1.05pt'>This method has obvious memory usage overhead, as an
intermediate list is created.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:409.05pt;margin-bottom:
0in;margin-left:1.05pt;line-height:217%'><b>Extension method </b>Write an
extension method:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=125
src=".NET%20Framework%20Notes%20for%20Professionals_files/image181.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>Use:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src=".NET%20Framework%20Notes%20for%20Professionals_files/image182.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:18.35pt;
margin-left:1.05pt'>Caution: The Framework's LINQ methods have been designed
with the intention of being <i>pure</i>, which means they do not produce side
effects. The <span style='font-size:9.0pt;line-height:109%;color:#0600FF;
background:#FAFAFA'>ForEach</span> method's only purpose is to produce side
effects, and deviates from the other methods in this aspect. You may consider
just using a plain <span style='font-size:9.0pt;line-height:109%;color:#0600FF;
background:#FAFAFA'>foreach</span> loop instead.</p>

<h2 style='margin-left:-.25pt'><a name="_Toc281439">Section 9.2: Calling a
method on an object in a list</a></h2>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=223
src=".NET%20Framework%20Notes%20for%20Professionals_files/image183.gif"></span></p>

<h1 style='margin-left:-.25pt'><a name="_Toc281440">Chapter 10: Reflection</a></h1>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:2.5pt;margin-left:
-.25pt'><a name="_Toc281441">Section 10.1: What is an Assembly?</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>Assemblies are the building block of any <a
href="https://en.wikipedia.org/wiki/Common_Language_Runtime"><span
style='color:#1889D0'>Common Language Runtime (CLR)</span></a> application.
Every type you define, together with its methods, properties and their
bytecode, is compiled and packaged inside an Assembly.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:22.4pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src=".NET%20Framework%20Notes%20for%20Professionals_files/image184.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src=".NET%20Framework%20Notes%20for%20Professionals_files/image185.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>Assemblies are self-documenting: they do not only contain
types, methods and their IL code, but also the Metadata necessary to inspect
and consume them, both at compile and runtime:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=109
src=".NET%20Framework%20Notes%20for%20Professionals_files/image186.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:14.55pt;
margin-left:1.05pt'>Assemblies have names which describes their full, unique
identity:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%'>Console</span><span style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>WriteLine</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>typeof</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>int</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>).</span><span
style='font-size:9.0pt;line-height:110%'>Assembly</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>.</span><span style='font-size:9.0pt;
line-height:110%'>FullName</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>);</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:17.4pt;
margin-left:3.5pt;line-height:110%'><span style='position:relative;z-index:
-1895793664'><span style='left:0px;position:absolute;left:0px;top:-18120px;
width:718px;height:1px'><img width=718 height=1
src=".NET%20Framework%20Notes%20for%20Professionals_files/image136.gif"></span></span><i><span
style='font-size:9.0pt;line-height:110%;color:darkgreen'>// Will print:
&quot;mscorlib, Version=4.0.0.0, Culture=neutral,
PublicKeyToken=b77a5c561934e089&quot;</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:18.3pt;
margin-left:1.05pt'>If this name includes a <span style='font-size:9.0pt;
line-height:109%;background:#FAFAFA'>PublicKeyToken</span>, it is called a <i>strong
name</i>. Strong-naming an assembly is the process of creating a signature by
using the private key that corresponds to the public key distributed with the
assembly. This signature is added to the Assembly manifest, which contains the
names and hashes of all the files that make up the assembly, and its <span
style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>PublicKeyToken</span>
becomes part of the name. Assemblies that have the same strong name should be
identical; strong names are used in versioning and to prevent assembly
conflicts.</p>

<h2 style='margin-left:-.25pt'><a name="_Toc281442">Section 10.2: Compare two
objects with reflection</a></h2>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=353
src=".NET%20Framework%20Notes%20for%20Professionals_files/image187.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=186
src=".NET%20Framework%20Notes%20for%20Professionals_files/image188.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:18.9pt;
margin-left:1.05pt'><b>Note:</b> this example do a field based comparasion
(ignore static fields and properties) for simplicity</p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:3.35pt;margin-left:
-.25pt'><a name="_Toc281443">Section 10.3: Creating Object and setting
properties using reflection</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>Lets say we have a class <span style='font-size:9.0pt;
line-height:109%;background:#FAFAFA'>Classy</span> that has property Propertua</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.25pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=76
src=".NET%20Framework%20Notes%20for%20Professionals_files/image189.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>to set <span style='font-size:9.0pt;line-height:109%;
background:#FAFAFA'>Propertua</span> using reflection:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=76
src=".NET%20Framework%20Notes%20for%20Professionals_files/image190.gif"></span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:2.5pt;margin-left:
-.25pt'><a name="_Toc281444">Section 10.4: How to create an object of T using
Reflection</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>Using the default constructor</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src=".NET%20Framework%20Notes%20for%20Professionals_files/image191.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>Using parameterized constructor</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src=".NET%20Framework%20Notes%20for%20Professionals_files/image192.gif"></span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:3.25pt;margin-left:
-.25pt'><a name="_Toc281445">Section 10.5: Getting an attribute of an enum with
reflection (and caching it)</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>Attributes can be useful for denoting metadata on enums.
Getting the value of this can be slow, so it is important to cache results.</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=162
src=".NET%20Framework%20Notes%20for%20Professionals_files/image193.gif"></span></p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=719 height=366
src=".NET%20Framework%20Notes%20for%20Professionals_files/image194.gif"></span><br
clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc281446">Chapter 11: Expression
Trees</a></h1>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:2.5pt;margin-left:
-.25pt'><a name="_Toc281447">Section 11.1: building a predicate of form field
== value</a></h2>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=166 style='width:124.2pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=43 valign=top style='width:.45in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>_ </span><span style='font-size:9.0pt;line-height:107%;color:#666666'>=&gt;</span><span
  style='font-size:9.0pt;line-height:107%'> _</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>.</span></p>
  </td>
  <td width=115 valign=top style='width:1.2in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Field </span><span style='font-size:9.0pt;line-height:107%;color:#666666'>==</span><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:#A60000'>&quot;VALUE&quot;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.95pt;
margin-left:1.05pt'>To build up an expression like at runtime.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=86 style='width:.9in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=43 valign=top style='width:.45in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>_ </span><span style='font-size:9.0pt;line-height:107%;color:#666666'>=&gt;</span><span
  style='font-size:9.0pt;line-height:107%'> _</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>.</span></p>
  </td>
  <td width=36 valign=top style='width:27.0pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Field</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.55pt;
margin-left:1.05pt'>Given a predicate and a string value <span
style='font-size:9.0pt;line-height:109%;color:#A60000;background:#FAFAFA'>&quot;VALUE&quot;</span>,
create an expression that tests whether or not the predicate is true.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:13.0pt;
margin-left:1.05pt'>The expression is suitable for:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:21.4pt'><span style='font-size:9.0pt;line-height:109%;color:#666666;
background:#FAFAFA'>&lt;</span><span style='font-size:9.0pt;line-height:109%;
background:#FAFAFA'>T</span><span style='font-size:9.0pt;line-height:109%;
color:#666666;background:#FAFAFA'>&gt;</span> to test the predicate.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=180 style='width:134.65pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=72 valign=top style='width:.75in;background:#FAFAFA;padding:1.6pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>IQueryable</span></p>
  </td>
  <td width=28 valign=top style='width:21.25pt;padding:1.6pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>&lt;</span><span style='font-size:
  9.0pt;line-height:107%;background:#FAFAFA'>T</span><span style='font-size:
  9.0pt;line-height:107%;color:#666666;background:#FAFAFA'>&gt;</span>, </p>
  </td>
  <td width=79 valign=top style='width:59.4pt;background:#FAFAFA;padding:1.6pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>IEnumerable</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:13.2pt;
margin-left:21.4pt'><img width=5 height=1
src=".NET%20Framework%20Notes%20for%20Professionals_files/image195.gif"
align=left hspace=12>entity framework or <span style='font-size:9.0pt;
line-height:109%;background:#FAFAFA'>Linq</span> to <span style='font-size:
9.0pt;line-height:109%;background:#FAFAFA'>SQL</span> to create a <span
style='font-size:9.0pt;line-height:109%;color:#0600FF;background:#FAFAFA'>Where</span>
clause that tests the predicate.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>This method will build an appropriate <span
style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>Equal</span>
expression that tests whether or not <span style='font-size:9.0pt;line-height:
109%;background:#FAFAFA'>Field</span> equals <span style='font-size:9.0pt;
line-height:109%;color:#A60000;background:#FAFAFA'>&quot;VALUE&quot;</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=191
src=".NET%20Framework%20Notes%20for%20Professionals_files/image196.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>The predicate can be used by including the predicate in a <span
style='font-size:9.0pt;line-height:109%;color:#0600FF;background:#FAFAFA'>Where</span>
extension method.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=76
src=".NET%20Framework%20Notes%20for%20Professionals_files/image197.gif"></span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:3.25pt;margin-left:
-.25pt'><a name="_Toc281448">Section 11.2: Simple Expression Tree Generated by
the C# Compiler</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>Consider the following C# code</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src=".NET%20Framework%20Notes%20for%20Professionals_files/image198.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:14.2pt;
margin-left:1.05pt'>Because the C# compiler sees that the lambda expression is
assigned to an Expression type rather than a delegate type it generates an
expression tree roughly equivalent to this code</p>

<p class=MsoNormal style='margin-top:0in;margin-right:119.05pt;margin-bottom:
17.2pt;margin-left:3.5pt;line-height:110%'><span style='position:relative;
z-index:-1895791616'><span style='left:0px;position:absolute;left:0px;
top:-20739px;width:718px;height:1px'><img width=718 height=1
src=".NET%20Framework%20Notes%20for%20Professionals_files/image199.gif"></span></span><span
style='font-size:9.0pt;line-height:110%'>ParameterExpression parameterA </span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>=</span><span
style='font-size:9.0pt;line-height:110%'> Expression</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>Parameter</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>typeof</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>int</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>)</span><span
style='font-size:9.0pt;line-height:110%'>, </span><span style='font-size:9.0pt;
line-height:110%;color:#A60000'>&quot;a&quot;</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>); </span><span style='font-size:9.0pt;
line-height:110%;color:#0600FF'>var</span><span style='font-size:9.0pt;
line-height:110%'> expression </span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>=</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%'>Expression</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>&lt;</span><span
style='font-size:9.0pt;line-height:110%'>Func</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>&lt;</span><span style='font-size:9.0pt;
line-height:110%;color:#0600FF'>int</span><span style='font-size:9.0pt;
line-height:110%'>, </span><span style='font-size:9.0pt;line-height:110%;
color:#0600FF'>int</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>&gt;&gt;)</span><span style='font-size:9.0pt;line-height:110%'>Expression</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>Lambda</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>( </span><span style='font-size:9.0pt;
line-height:110%'>Expression</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>Add</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>( </span><span
style='font-size:9.0pt;line-height:110%'>parameterA,
Expression</span><span style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>Constant</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>(</span><span style='font-size:9.0pt;
line-height:110%;color:red'>1</span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>))</span><span style='font-size:9.0pt;line-height:110%'>,
parameterA</span><span style='font-size:9.0pt;line-height:110%;color:#666666'>);</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:.2in;
margin-left:1.05pt'>The root of the tree is the lambda expression which
contains a body and a list of parameters. The lambda has 1 parameter called
&quot;a&quot;. The body is a single expression of CLR type BinaryExpression and
NodeType of Add. This expression represents addition. It has two subexpressions
denoted as Left and Right. Left is the ParameterExpression for the parameter
&quot;a&quot; and Right is a ConstantExpression with the value 1.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>The simplest usage of this expression is printing it:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src=".NET%20Framework%20Notes%20for%20Professionals_files/image200.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.9pt;
margin-left:1.05pt'>Which prints the equivalent C# code.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>The expression tree can be compiled into a C# delegate and
executed by the CLR</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src=".NET%20Framework%20Notes%20for%20Professionals_files/image201.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:17.05pt;margin-bottom:
.25pt;margin-left:-.25pt;text-align:justify;text-justify:inter-ideograph;
line-height:135%'>Usually expressions are translated to other languages like
SQL, but can be also used to invoke private, protected and internal members of
public or non-public types as alternative to Reflection.</p>

<h2 style='margin-top:0in;margin-right:17.05pt;margin-bottom:.25pt;margin-left:
-.25pt;text-align:justify;text-justify:inter-ideograph;line-height:135%'><a
name="_Toc281449">Section 11.3: Expression for retrieving a static field</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>Having example type like this:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=76
src=".NET%20Framework%20Notes%20for%20Professionals_files/image202.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:14.55pt;
margin-left:1.05pt'>We can retrieve value of StaticPublicField:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:92.0pt;margin-bottom:
17.2pt;margin-left:3.5pt;line-height:110%'><span style='position:relative;
z-index:-1895790592'><span style='left:0px;position:absolute;left:0px;
top:-21339px;width:718px;height:1px'><img width=718 height=1
src=".NET%20Framework%20Notes%20for%20Professionals_files/image136.gif"></span></span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>var</span><span
style='font-size:9.0pt;line-height:110%'> fieldExpr </span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>=</span><span
style='font-size:9.0pt;line-height:110%'> Expression</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>Field</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>(</span><span style='font-size:9.0pt;
line-height:110%;color:#0600FF'>null</span><span style='font-size:9.0pt;
line-height:110%'>, </span><span style='font-size:9.0pt;line-height:110%;
color:#0600FF'>typeof</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>(</span><span style='font-size:9.0pt;line-height:110%'>TestClass</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>)</span><span
style='font-size:9.0pt;line-height:110%'>, </span><span style='font-size:9.0pt;
line-height:110%;color:#A60000'>&quot;StaticPublicField&quot;</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>); </span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>var</span><span
style='font-size:9.0pt;line-height:110%'> labmda </span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>=</span><span style='font-size:9.0pt;
line-height:110%'> Expression</span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%'>Lambda</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>&lt;</span><span
style='font-size:9.0pt;line-height:110%'>Func</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>&lt;</span><span style='font-size:9.0pt;
line-height:110%;color:#0600FF'>string</span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>&gt;&gt;(</span><span style='font-size:9.0pt;
line-height:110%'>fieldExpr</span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>);</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>It can be then i.e. compiled into a delegate for retrieving
field value.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src=".NET%20Framework%20Notes%20for%20Professionals_files/image203.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:197.05pt;margin-bottom:
0in;margin-left:1.05pt;line-height:145%'>//fieldValue result is
StaticPublicFieldValue</p>

<h2 style='margin-top:0in;margin-right:197.05pt;margin-bottom:0in;margin-left:
1.05pt;margin-bottom:.0001pt;line-height:145%'><a name="_Toc281450">Section
11.4: InvocationExpression Class</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.55pt;
margin-left:1.05pt'><a
href="https://msdn.microsoft.com/en-us/library/system.linq.expressions.invocationexpression(v=vs.110).aspx"><span
style='color:#1889D0'>InvocationExpression class</span></a> allows invocation
of other lambda expressions that are parts of the same Expression tree.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=122 style='width:91.8pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=72 valign=top style='width:.75in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Expression</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>.</span></p>
  </td>
  <td width=43 valign=top style='width:.45in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Invoke</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.9pt;
margin-left:1.05pt'>You create them with static method.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>Problem We want to get on the items which have
&quot;car&quot; in their description. We need to check it for null before
searching for a string inside but we don't want it to be called excessively, as
the computation could be expensive.</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=158
src=".NET%20Framework%20Notes%20for%20Professionals_files/image204.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:566.95pt;margin-bottom:
0in;margin-left:-28.35pt;text-indent:0in;line-height:107%'>&nbsp;</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=718
 style='width:538.6pt;border-collapse:collapse'>
 <tr style='height:771.0pt'>
  <td width=718 valign=top style='width:538.6pt;background:#FAFAFA;padding:
  2.55pt 5.75pt 0in 3.75pt;height:771.0pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:253.7pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:112%'><span style='font-size:
  9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:#0600FF'>new</span><span style='font-size:9.0pt;
  line-height:112%'> Element </span><span style='font-size:9.0pt;line-height:
  112%;color:#666666'>{</span><span style='font-size:9.0pt;line-height:112%'>
  Description </span><span style='font-size:9.0pt;line-height:112%;color:#666666'>=</span><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:#A60000'>&quot;car&quot;</span><span style='font-size:
  9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;line-height:
  112%;color:#666666'>}</span><span style='font-size:9.0pt;line-height:112%'>,
  </span><span style='font-size:9.0pt;line-height:112%;color:#0600FF'>new</span><span
  style='font-size:9.0pt;line-height:112%'> Element </span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>{</span><span
  style='font-size:9.0pt;line-height:112%'> Description </span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>=</span><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:#A60000'>&quot;cargo&quot;</span><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:#666666'>}</span><span style='font-size:9.0pt;
  line-height:112%'>, </span><span style='font-size:9.0pt;
  line-height:112%;color:#0600FF'>new</span><span style='font-size:9.0pt;
  line-height:112%'> Element </span><span style='font-size:9.0pt;line-height:
  112%;color:#666666'>{</span><span style='font-size:9.0pt;line-height:112%'>
  Description </span><span style='font-size:9.0pt;line-height:112%;color:#666666'>=</span><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:#A60000'>&quot;wheel&quot;</span><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:#666666'>}</span><span style='font-size:9.0pt;
  line-height:112%'>, </span><span style='font-size:9.0pt;
  line-height:112%;color:#0600FF'>new</span><span style='font-size:9.0pt;
  line-height:112%'> Element </span><span style='font-size:9.0pt;line-height:
  112%;color:#666666'>{</span><span style='font-size:9.0pt;line-height:112%'>
  Description </span><span style='font-size:9.0pt;line-height:112%;color:#666666'>=</span><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:#0600FF'>null</span><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:#666666'>}</span><span style='font-size:9.0pt;line-height:112%'>,</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:167.3pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:112%'><span style='font-size:
  9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:#0600FF'>new</span><span style='font-size:9.0pt;
  line-height:112%'> Element </span><span style='font-size:9.0pt;line-height:
  112%;color:#666666'>{</span><span style='font-size:9.0pt;line-height:112%'>
  Description </span><span style='font-size:9.0pt;line-height:112%;color:#666666'>=</span><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:#A60000'>&quot;Madagascar&quot;</span><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:#666666'>}</span><span style='font-size:9.0pt;
  line-height:112%'>, </span><span style='font-size:9.0pt;line-height:
  112%;color:#666666'>}; </span><span style='font-size:9.0pt;line-height:112%'></span><span
  style='font-size:9.0pt;line-height:112%;color:#0600FF'>var</span><span
  style='font-size:9.0pt;line-height:112%'> elementIsInterestingExpression </span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>=</span><span
  style='font-size:9.0pt;line-height:112%'> CreateSearchPredicate</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>( </span><span
  style='font-size:9.0pt;line-height:112%'>searchTerm</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>:</span><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:#A60000'>&quot;car&quot;</span><span style='font-size:
  9.0pt;line-height:112%'>, whereToSearch</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>:</span><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:#666666'>(</span><span style='font-size:9.0pt;
  line-height:112%'>Element e</span><span style='font-size:9.0pt;line-height:
  112%;color:#666666'>)</span><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>=&gt;</span><span
  style='font-size:9.0pt;line-height:112%'> e</span><span style='font-size:
  9.0pt;line-height:112%;color:#666666'>.</span><span style='font-size:9.0pt;
  line-height:112%'>Description</span><span style='font-size:9.0pt;line-height:
  112%;color:#666666'>); </span><span style='font-size:9.0pt;line-height:112%'></span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:118.7pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:112%'><span style='font-size:
  9.0pt;line-height:112%'> Console</span><span style='font-size:9.0pt;
  line-height:112%;color:#666666'>.</span><span style='font-size:9.0pt;
  line-height:112%'>WriteLine</span><span style='font-size:9.0pt;line-height:
  112%;color:#666666'>(</span><span style='font-size:9.0pt;line-height:112%'>elementIsInterestingExpression</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>.</span><span
  style='font-size:9.0pt;line-height:112%'>ToString</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>()); </span><span
  style='font-size:9.0pt;line-height:112%'></span><span
  style='font-size:9.0pt;line-height:112%;color:#0600FF'>var</span><span
  style='font-size:9.0pt;line-height:112%'> elementIsInteresting </span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>=</span><span
  style='font-size:9.0pt;line-height:112%'> elementIsInterestingExpression</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>.</span><span
  style='font-size:9.0pt;line-height:112%'>Compile</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>(); </span><span
  style='font-size:9.0pt;line-height:112%'></span><span
  style='font-size:9.0pt;line-height:112%;color:#0600FF'>var</span><span
  style='font-size:9.0pt;line-height:112%'> interestingElements </span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>=</span><span
  style='font-size:9.0pt;line-height:112%'> elements</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>.</span><span
  style='font-size:9.0pt;line-height:112%;color:#0600FF'>Where</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>(</span><span
  style='font-size:9.0pt;line-height:112%'>elementIsInteresting</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>); </span><span
  style='font-size:9.0pt;line-height:112%'></span><span
  style='font-size:9.0pt;line-height:112%;color:#0600FF'>foreach</span><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:#666666'>(</span><span style='font-size:9.0pt;
  line-height:112%;color:#0600FF'>var</span><span style='font-size:9.0pt;
  line-height:112%'> e </span><span style='font-size:9.0pt;line-height:112%;
  color:#0600FF'>in</span><span style='font-size:9.0pt;line-height:112%'>
  interestingElements</span><span style='font-size:9.0pt;line-height:112%;
  color:#666666'>)</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:#666666'>{</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> Console</span><span style='font-size:
  9.0pt;line-height:107%;color:#666666'>.</span><span style='font-size:9.0pt;
  line-height:107%'>WriteLine</span><span style='font-size:9.0pt;line-height:
  107%;color:#666666'>(</span><span style='font-size:9.0pt;line-height:107%'>e</span><span
  style='font-size:9.0pt;line-height:107%;color:#666666'>.</span><span
  style='font-size:9.0pt;line-height:107%'>Description</span><span
  style='font-size:9.0pt;line-height:107%;color:#666666'>);</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:480.5pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:112%'><span style='font-size:
  9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:#666666'>} </span><span style='font-size:9.0pt;
  line-height:112%'></span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:199.7pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:112%'><span style='font-size:
  9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:#0600FF'>var</span><span style='font-size:9.0pt;
  line-height:112%'> countExpensiveComputations </span><span style='font-size:
  9.0pt;line-height:112%;color:#666666'>=</span><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:red'>0</span><span style='font-size:9.0pt;line-height:112%;color:#666666'>;
  </span><span style='font-size:9.0pt;line-height:112%'>Action incCount
  </span><span style='font-size:9.0pt;line-height:112%;color:#666666'>=</span><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:#666666'>()</span><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:#666666'>=&gt;</span><span style='font-size:9.0pt;line-height:112%'>
  countExpensiveComputations</span><span style='font-size:9.0pt;line-height:
  112%;color:#666666'>++; </span><span style='font-size:9.0pt;line-height:112%'>elements
  </span><span style='font-size:9.0pt;line-height:112%;color:#666666'>.</span><span
  style='font-size:9.0pt;line-height:112%;color:#0600FF'>Where</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>(</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> CreateSearchPredicate</span><span
  style='font-size:9.0pt;line-height:107%;color:#666666'>(</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:232.1pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:112%'><span style='font-size:
  9.0pt;line-height:112%'> </span><span style='font-size:
  9.0pt;line-height:112%;color:#A60000'>&quot;car&quot;</span><span
  style='font-size:9.0pt;line-height:112%'>, </span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>(</span><span
  style='font-size:9.0pt;line-height:112%'>Element e</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>)</span><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:#666666'>=&gt;</span><span style='font-size:9.0pt;
  line-height:112%'> ExpensivelyComputed</span><span style='font-size:9.0pt;
  line-height:112%;color:#666666'>( </span><span style='font-size:9.0pt;
  line-height:112%'>e, incCount </span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>)</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:#666666'>).</span><span style='font-size:9.0pt;
  line-height:107%'>Compile</span><span style='font-size:9.0pt;line-height:
  107%;color:#666666'>()</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:#666666'>)</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:#666666'>.</span><span style='font-size:9.0pt;
  line-height:107%'>Count</span><span style='font-size:9.0pt;line-height:107%;
  color:#666666'>();</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> Console</span><span style='font-size:9.0pt;
  line-height:107%;color:#666666'>.</span><span style='font-size:9.0pt;
  line-height:107%'>WriteLine</span><span style='font-size:9.0pt;line-height:
  107%;color:#666666'>(</span><span style='font-size:9.0pt;line-height:107%;
  color:#A60000'>&quot;Property extractor is called {0} times.&quot;</span><span
  style='font-size:9.0pt;line-height:107%'>, countExpensiveComputations</span><span
  style='font-size:9.0pt;line-height:107%;color:#666666'>);</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:124.1pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:112%'><span style='font-size:
  9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;line-height:
  112%;color:#666666'>} </span><span style='font-size:9.0pt;line-height:112%'></span><span
  style='font-size:9.0pt;line-height:112%;color:#0600FF'>private</span><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:#0600FF'>class</span><span style='font-size:9.0pt;
  line-height:112%'> Element </span><span style='font-size:9.0pt;
  line-height:112%;color:#666666'>{ </span><span style='font-size:9.0pt;
  line-height:112%'></span><span style='font-size:9.0pt;line-height:
  112%;color:#0600FF'>public</span><span style='font-size:9.0pt;line-height:
  112%'> </span><span style='font-size:9.0pt;line-height:112%;color:#0600FF'>string</span><span
  style='font-size:9.0pt;line-height:112%'> Description </span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>{</span><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:#0600FF'>get</span><span style='font-size:9.0pt;
  line-height:112%;color:#666666'>;</span><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:#0600FF'>set</span><span style='font-size:9.0pt;line-height:112%;
  color:#666666'>;</span><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>} </span><span
  style='font-size:9.0pt;line-height:112%'></span><span style='font-size:
  9.0pt;line-height:112%;color:#666666'>} </span><span style='font-size:9.0pt;
  line-height:112%'></span><span style='font-size:9.0pt;line-height:
  112%;color:#0600FF'>private</span><span style='font-size:9.0pt;line-height:
  112%'> </span><span style='font-size:9.0pt;line-height:112%;color:#0600FF'>static</span><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:#0600FF'>string</span><span style='font-size:9.0pt;
  line-height:112%'> ExpensivelyComputed</span><span style='font-size:9.0pt;
  line-height:112%;color:#666666'>(</span><span style='font-size:9.0pt;
  line-height:112%'>Element source, Action count</span><span style='font-size:
  9.0pt;line-height:112%;color:#666666'>) </span><span style='font-size:9.0pt;
  line-height:112%'></span><span style='font-size:9.0pt;line-height:112%;
  color:#666666'>{ </span><span style='font-size:9.0pt;line-height:112%'>count</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>(); </span><span
  style='font-size:9.0pt;line-height:112%'></span><span
  style='font-size:9.0pt;line-height:112%;color:#0600FF'>return</span><span
  style='font-size:9.0pt;line-height:112%'> source</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>.</span><span
  style='font-size:9.0pt;line-height:112%'>Description</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>; </span><span
  style='font-size:9.0pt;line-height:112%'></span><span style='font-size:
  9.0pt;line-height:112%;color:#666666'>} </span><span style='font-size:9.0pt;
  line-height:112%'></span><span style='font-size:9.0pt;line-height:
  112%;color:#0600FF'>private</span><span style='font-size:9.0pt;line-height:
  112%'> </span><span style='font-size:9.0pt;line-height:112%;color:#0600FF'>static</span><span
  style='font-size:9.0pt;line-height:112%'> Expression</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>&lt;</span><span
  style='font-size:9.0pt;line-height:112%'>Func</span><span style='font-size:
  9.0pt;line-height:112%;color:#666666'>&lt;</span><span style='font-size:9.0pt;
  line-height:112%'>T, </span><span style='font-size:9.0pt;line-height:112%;
  color:#0600FF'>bool</span><span style='font-size:9.0pt;line-height:112%;
  color:#666666'>&gt;&gt;</span><span style='font-size:9.0pt;line-height:112%'>
  CreateSearchPredicate</span><span style='font-size:9.0pt;line-height:112%;
  color:#666666'>&lt;</span><span style='font-size:9.0pt;line-height:112%'>T</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>&gt;( </span><span
  style='font-size:9.0pt;line-height:112%'></span><span
  style='font-size:9.0pt;line-height:112%;color:#0600FF'>string</span><span
  style='font-size:9.0pt;line-height:112%'> searchTerm, Expression</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>&lt;</span><span
  style='font-size:9.0pt;line-height:112%'>Func</span><span style='font-size:
  9.0pt;line-height:112%;color:#666666'>&lt;</span><span style='font-size:9.0pt;
  line-height:112%'>T, </span><span style='font-size:9.0pt;line-height:112%;
  color:#0600FF'>string</span><span style='font-size:9.0pt;line-height:112%;
  color:#666666'>&gt;&gt;</span><span style='font-size:9.0pt;line-height:112%'>
  whereToSearch</span><span style='font-size:9.0pt;line-height:112%;color:#666666'>)
  </span><span style='font-size:9.0pt;line-height:112%'></span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>{ </span><span
  style='font-size:9.0pt;line-height:112%'></span><span
  style='font-size:9.0pt;line-height:112%;color:#0600FF'>var</span><span
  style='font-size:9.0pt;line-height:112%'> extracted </span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>=</span><span
  style='font-size:9.0pt;line-height:112%'> Expression</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>.</span><span
  style='font-size:9.0pt;line-height:112%'>Parameter</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>(</span><span
  style='font-size:9.0pt;line-height:112%;color:#0600FF'>typeof</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>(</span><span
  style='font-size:9.0pt;line-height:112%;color:#0600FF'>string</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>)</span><span
  style='font-size:9.0pt;line-height:112%'>, </span><span style='font-size:
  9.0pt;line-height:112%;color:#A60000'>&quot;extracted&quot;</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>); </span><span
  style='font-size:9.0pt;line-height:112%'></span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> Expression</span><span style='font-size:9.0pt;
  line-height:107%;color:#666666'>&lt;</span><span style='font-size:9.0pt;
  line-height:107%'>Func</span><span style='font-size:9.0pt;line-height:107%;
  color:#666666'>&lt;</span><span style='font-size:9.0pt;line-height:107%;
  color:#0600FF'>string</span><span style='font-size:9.0pt;line-height:107%'>, </span><span
  style='font-size:9.0pt;line-height:107%;color:#0600FF'>bool</span><span
  style='font-size:9.0pt;line-height:107%;color:#666666'>&gt;&gt;</span><span
  style='font-size:9.0pt;line-height:107%'> coalesceNullCheckWithSearch </span><span
  style='font-size:9.0pt;line-height:107%;color:#666666'>=</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> Expression</span><span style='font-size:
  9.0pt;line-height:107%;color:#666666'>.</span><span style='font-size:9.0pt;
  line-height:107%'>Lambda</span><span style='font-size:9.0pt;line-height:107%;
  color:#666666'>&lt;</span><span style='font-size:9.0pt;line-height:107%'>Func</span><span
  style='font-size:9.0pt;line-height:107%;color:#666666'>&lt;</span><span
  style='font-size:9.0pt;line-height:107%;color:#0600FF'>string</span><span
  style='font-size:9.0pt;line-height:107%'>, </span><span style='font-size:
  9.0pt;line-height:107%;color:#0600FF'>bool</span><span style='font-size:9.0pt;
  line-height:107%;color:#666666'>&gt;&gt;(</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> Expression</span><span
  style='font-size:9.0pt;line-height:107%;color:#666666'>.</span><span
  style='font-size:9.0pt;line-height:107%'>AndAlso</span><span
  style='font-size:9.0pt;line-height:107%;color:#666666'>(</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> Expression</span><span
  style='font-size:9.0pt;line-height:107%;color:#666666'>.</span><span
  style='font-size:9.0pt;line-height:107%'>Not</span><span style='font-size:
  9.0pt;line-height:107%;color:#666666'>(</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:37.65pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:112%'><span style='font-size:
  9.0pt;line-height:112%'> Expression</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>.</span><span
  style='font-size:9.0pt;line-height:112%'>Call</span><span style='font-size:
  9.0pt;line-height:112%;color:#666666'>(</span><span style='font-size:9.0pt;
  line-height:112%;color:#0600FF'>typeof</span><span style='font-size:9.0pt;
  line-height:112%;color:#666666'>(</span><span style='font-size:9.0pt;
  line-height:112%;color:#0600FF'>string</span><span style='font-size:9.0pt;
  line-height:112%;color:#666666'>)</span><span style='font-size:9.0pt;
  line-height:112%'>, </span><span style='font-size:9.0pt;line-height:112%;
  color:#A60000'>&quot;IsNullOrEmpty&quot;</span><span style='font-size:9.0pt;
  line-height:112%'>, </span><span style='font-size:9.0pt;line-height:112%;
  color:#0600FF'>null</span><span style='font-size:9.0pt;line-height:112%'>,
  extracted</span><span style='font-size:9.0pt;line-height:112%;color:#666666'>)
  </span><span style='font-size:9.0pt;line-height:112%'></span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>)</span><span
  style='font-size:9.0pt;line-height:112%'>,</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:5.3pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> Expression</span><span
  style='font-size:9.0pt;line-height:107%;color:#666666'>.</span><span
  style='font-size:9.0pt;line-height:107%'>Call</span><span style='font-size:
  9.0pt;line-height:107%;color:#666666'>(</span><span style='font-size:9.0pt;
  line-height:107%'>extracted, </span><span style='font-size:9.0pt;line-height:
  107%;color:#A60000'>&quot;Contains&quot;</span><span style='font-size:9.0pt;
  line-height:107%'>, </span><span style='font-size:9.0pt;line-height:107%;
  color:#0600FF'>null</span><span style='font-size:9.0pt;line-height:107%'>,
  Expression</span><span style='font-size:9.0pt;line-height:107%;color:#666666'>.</span><span
  style='font-size:9.0pt;line-height:107%'>Constant</span><span
  style='font-size:9.0pt;line-height:107%;color:#666666'>(</span><span
  style='font-size:9.0pt;line-height:107%'>searchTerm</span><span
  style='font-size:9.0pt;line-height:107%;color:#666666'>)) </span><span
  style='font-size:9.0pt;line-height:107%'></span><span
  style='font-size:9.0pt;line-height:107%;color:#666666'>)</span><span
  style='font-size:9.0pt;line-height:107%'>, extracted</span><span
  style='font-size:9.0pt;line-height:107%;color:#666666'>);</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=202
src=".NET%20Framework%20Notes%20for%20Professionals_files/image205.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>Output</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=720 height=126
src=".NET%20Framework%20Notes%20for%20Professionals_files/image206.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>First thing to note is how the actual propery access,
wrapped in an Invoke:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.15pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src=".NET%20Framework%20Notes%20for%20Professionals_files/image207.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=79 style='width:59.4pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=79 valign=top style='width:59.4pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Description</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>, and this is the only part that touches <span
style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>e</span><span
style='font-size:9.0pt;line-height:109%;color:#666666;background:#FAFAFA'>.</span>,
and in place of it, <span style='font-size:9.0pt;line-height:109%;background:
#FAFAFA'>extracted</span> parameter of type <span style='font-size:9.0pt;
line-height:109%;color:#0600FF;background:#FAFAFA'>string</span> is passed to
the next one:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src=".NET%20Framework%20Notes%20for%20Professionals_files/image208.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>Another important thing to note here is <span
style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>AndAlso</span>. It
computes only the left part, if the first part returns 'false'. It's a common
mistake to use the bitwise operator 'And' instead of it, which always computes
both parts, and would fail with a NullReferenceException in this example.</p>

<h1 style='margin-left:-.25pt'><a name="_Toc281451">Chapter 12: Custom Types</a></h1>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc281452">Section 12.1: Struct Definition</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:1.9pt;
margin-left:.75pt;line-height:107%'><b>Structs inherit from System.ValueType,
are value types, and live on the stack. When value types are passed as a
parameter, they are passed by value.</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=92
src=".NET%20Framework%20Notes%20for%20Professionals_files/image209.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'><b>Passed by value</b> means that the value of the
parameter is <i>copied</i> for the method, and any changes made to the
parameter in the method are not reflected outside of the method. For instance,
consider the following code, which calls a method named <span style='font-size:
9.0pt;line-height:109%;background:#FAFAFA'>AddNumbers</span>, passing in the
variables <span style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>a</span>
and <span style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>b</span>,
which are of type <span style='font-size:9.0pt;line-height:109%;color:#0600FF;
background:#FAFAFA'>int</span>, which is a Value type.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=191
src=".NET%20Framework%20Notes%20for%20Professionals_files/image210.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.6pt;
margin-left:1.05pt'>Even though we added 5 to <span style='font-size:9.0pt;
line-height:109%;background:#FAFAFA'>x</span> inside the method, the value of <span
style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>a</span> remains
unchanged, because it's a Value type, and that means <span style='font-size:
9.0pt;line-height:109%;background:#FAFAFA'>x</span> was a <i>copy</i> of <span
style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>a</span>'s value,
but not actually <span style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>a</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:166.8pt;margin-bottom:
0in;margin-left:1.05pt;line-height:145%'>Remember, Value types live on the
stack, and are passed by value.</p>

<h2 style='margin-top:0in;margin-right:166.8pt;margin-bottom:0in;margin-left:
1.05pt;margin-bottom:.0001pt;line-height:145%'><a name="_Toc281453">Section
12.2: Class Definition</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:1.9pt;
margin-left:.75pt;line-height:107%'><b>Classes inherit from System.Object, are
reference types, and live on the heap. When reference types are passed as a
parameter, they are passed by reference.</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=92
src=".NET%20Framework%20Notes%20for%20Professionals_files/image211.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'><b>Passed by reference</b> means that a <i>reference</i> to
the parameter is passed to the method, and any changes to the parameter will be
reflected outside of the method when it returns, because the reference is <i>to
the exact same object in memory</i>. Let's use the same example as before, but
we'll &quot;wrap&quot; the <span style='font-size:9.0pt;line-height:109%;
color:#0600FF;background:#FAFAFA'>int</span>s in a class first.</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=148
src=".NET%20Framework%20Notes%20for%20Professionals_files/image212.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=71
src=".NET%20Framework%20Notes%20for%20Professionals_files/image213.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=297 style='width:223.0pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=43 valign=top style='width:.45in;background:#FAFAFA;padding:1.1pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>sample</span></p>
  </td>
  <td width=132 valign=top style='width:98.8pt;padding:1.1pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>.</span><span style='font-size:9.0pt;
  line-height:107%;background:#FAFAFA'>a</span> to <span style='font-size:9.0pt;
  line-height:107%;background:#FAFAFA'>10</span>, the value of </p>
  </td>
  <td width=122 valign=top style='width:91.8pt;background:#FAFAFA;padding:1.1pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>instanceOfMyClass</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>This time, when we changed <span style='font-size:9.0pt;
line-height:109%;color:#666666;background:#FAFAFA'>.</span><span
style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>a</span> <i>also</i>
changes, because it was <i>passed</i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.55pt;
margin-left:1.05pt'><i>by reference</i>. Passed by reference means that a <i>reference</i>
(also sometimes called a <i>pointer</i>) to the object was passed into the
method, instead of a copy of the object itself.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>Remember, Reference types live on the heap, and are passed
by reference.<br clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc281454">Chapter 13: Code Contracts</a></h1>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:2.5pt;margin-left:
-.25pt'><a name="_Toc281455">Section 13.1: Contracts for Interfaces</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:10.3pt;margin-bottom:
0in;margin-left:1.05pt;line-height:156%'>Using Code Contracts it is possible to
apply a contract to an interface. This is done by declaring an abstract class
that implments the interfaces. The interface should be tagged with the <span
style='font-size:9.0pt;line-height:156%;background:#FAFAFA'>ContractClassAttribute</span>
and the contract definition (the abstract class) should be tagged with the <span
style='font-size:9.0pt;line-height:156%;background:#FAFAFA'>ContractClassForAttribute
</span><b>C# Example...</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=421
src=".NET%20Framework%20Notes%20for%20Professionals_files/image214.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:.75pt;line-height:107%'><b>Static Analysis Result...</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><img border=0 width=370
height=70 id="Picture 17061"
src=".NET%20Framework%20Notes%20for%20Professionals_files/image215.jpg"></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:2.5pt;margin-left:
-.25pt'><a name="_Toc281456">Section 13.2: Installing and Enabling Code
Contracts</a></h2>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=202 style='width:2.1in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=202 valign=top style='width:2.1in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>System.Diagnostics</span><span style='font-size:9.0pt;line-height:107%;
  color:#666666'>.</span><span style='font-size:9.0pt;line-height:107%'>Contracts</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:13.15pt;
margin-left:1.05pt'>While is included within the .Net Framework. To use Code
Contracts you must install the Visual Studio extensions.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:2.6pt;
margin-left:-.25pt;line-height:107%'>Under <span style='font-size:9.0pt;
line-height:107%;background:#FAFAFA'>Extensions and Updates</span> search for <span
style='font-size:9.0pt;line-height:107%;background:#FAFAFA'>Code Contracts</span>
then install the <span style='font-size:9.0pt;line-height:107%;background:#FAFAFA'>Code
Contracts Tools</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.1pt;
margin-left:0in;text-indent:0in;line-height:107%'><img border=0 width=718
height=496 id="Picture 17092"
src=".NET%20Framework%20Notes%20for%20Professionals_files/image216.jpg"></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=108 style='width:81.0pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=108 valign=top style='width:81.0pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#0600FF'>Static</span><span style='font-size:9.0pt;line-height:
  107%'> Checking</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>After the tools are installed you must enable <span
style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>Code Contracts</span>
within your Project solution. At the minimum you probably want to enable the
(check after build). If you are implementing a library that will be used by
other solutions you may want to consider also enabling <span style='font-size:
9.0pt;line-height:109%;background:#FAFAFA'>Runtime Checking</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><img border=0 width=718
height=758 id="Picture 17120"
src=".NET%20Framework%20Notes%20for%20Professionals_files/image217.jpg"></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:2.5pt;margin-left:
-.25pt'><a name="_Toc281457">Section 13.3: Preconditions</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:13.15pt;
margin-left:1.05pt'>Preconditions allows methods to provide minimum required
values for input parameters</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:.75pt;line-height:107%'><b>Example...</b></p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=109
src=".NET%20Framework%20Notes%20for%20Professionals_files/image218.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:.75pt;line-height:107%'><b>Static Analysis Result...</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><img border=0 width=358
height=69 id="Picture 17161"
src=".NET%20Framework%20Notes%20for%20Professionals_files/image219.jpg"></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:2.5pt;margin-left:
-.25pt'><a name="_Toc281458">Section 13.4: Postconditions</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.8pt;
margin-left:1.05pt'>Postconditions ensure that the returned results from a
method will match the provided definition. This provides the caller with a
definition of the expected result. Postconditions may allowed for simplied
implmentations as some possible outcomes can be provided by the static
analyizer.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:.75pt;line-height:107%'><b>Example...</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=109
src=".NET%20Framework%20Notes%20for%20Professionals_files/image220.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:.75pt;line-height:107%'><b>Static Analyis Result...</b></p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><img
border=0 width=718 height=108 id="Picture 17198"
src=".NET%20Framework%20Notes%20for%20Professionals_files/image221.jpg"></p>

<h1 style='margin-left:-.25pt'><a name="_Toc281459">Chapter 14: Settings</a></h1>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc281460">Section 14.1: AppSettings from
ConfigurationSettings in .NET 1.x</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.35pt;
margin-left:.75pt;line-height:107%'><b>Deprecated usage</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.65pt;
margin-left:1.05pt'>The <a
href="https://msdn.microsoft.com/en-us/library/system.configuration.configurationsettings.aspx"><span
style='color:#1889D0'>ConfigurationSettings</span></a> class was the original
way to retrieve settings for an assembly in .NET 1.0 and 1.1. It has been
superseded by the <a
href="https://msdn.microsoft.com/en-us/library/system.configuration.configurationmanager.aspx"><span
style='color:#1889D0'>ConfigurationManager</span></a> class and the <a
href="https://msdn.microsoft.com/en-us/library/system.web.configuration.webconfigurationmanager.aspx"><span
style='color:#1889D0'>WebConfigurationManager</span></a> class.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt;line-height:217%'>If you have two keys with the same name in
the <span style='font-size:9.0pt;line-height:217%;background:#FAFAFA'>appSettings</span>
section of the configuration file, the last one is used. <b>app.config</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=142
src=".NET%20Framework%20Notes%20for%20Professionals_files/image222.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:.75pt;line-height:107%'><b>Program.cs</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=339
src=".NET%20Framework%20Notes%20for%20Professionals_files/image223.gif"></span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:2.6pt;margin-left:
-.25pt'><a name="_Toc281461">Section 14.2: Reading AppSettings from
ConfigurationManager in .NET 2.0 and later</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.85pt;
margin-left:1.05pt'>The <a
href="https://msdn.microsoft.com/en-us/library/system.configuration.configurationmanager.aspx"><span
style='color:#1889D0'>ConfigurationManager</span></a> class supports the <span
style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>AppSettings</span>
property, which allows you to continue reading settings from the <span
style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>appSettings</span>
section of a configuration file the same way as .NET 1.x supported.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:.75pt;line-height:107%'><b>app.config</b></p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=51
src=".NET%20Framework%20Notes%20for%20Professionals_files/image224.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=104
src=".NET%20Framework%20Notes%20for%20Professionals_files/image225.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:.75pt;line-height:107%'><b>Program.cs</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=339
src=".NET%20Framework%20Notes%20for%20Professionals_files/image226.gif"></span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:3.25pt;margin-left:
-.25pt'><a name="_Toc281462">Section 14.3: Introduction to strongly-typed
application and user settings support from Visual Studio</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:13.2pt;
margin-left:1.05pt'>Visual Studio helps manage user and application settings.
Using this approach has these benefits over using the <span style='font-size:
9.0pt;line-height:109%;background:#FAFAFA'>appSettings</span> section of the
configuration file.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:9.7pt;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:109%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Settings
can be made strongly typed. Any type which can be serialized can be used for a
settings value.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=72 style='width:.75in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=22 valign=top style='width:16.2pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>web</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>.</span></p>
  </td>
  <td width=43 valign=top style='width:.45in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>config</span></p>
  </td>
 </tr>
</table>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=79 style='width:59.4pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>user</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>.</span></p>
  </td>
  <td width=43 valign=top style='width:.45in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>config</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:9.35pt;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:109%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Application
settings can be easily separated from user settings. Application settings are
stored in a single configuration file: for Web sites and Web applications, and
app.config, renamed as <i>assembly</i>.exe.config, where <i>assembly</i> is the
name of the executable. User settings (not used by Web projects) are stored in
a file in the user's Application Data folder (which varies with the operating
system version).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:20.05pt;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:109%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Application
settings from class libraries can be combined into a single configuration file
without risk of name collisions, since each class library can have its own
custom settings section.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:13.05pt;
margin-left:1.05pt'>In most project types, the <a
href="https://msdn.microsoft.com/en-us/library/z2f953x9.aspx"><span
style='color:#1889D0'>Project Properties Designer</span></a> has a <a
href="https://msdn.microsoft.com/en-us/library/a65txexh.aspx"><span
style='color:#1889D0'>Settings</span></a> tab which is the starting point for
creating custom application and user settings. Initially, the Settings tab will
be blank, with a single link to create a default settings file. Clicking the
link results in these changes:</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=164 style='width:123.35pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=22 valign=top style='width:16.2pt;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>app</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>.</span></p>
  </td>
  <td width=43 valign=top style='width:.45in;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>config</span></p>
  </td>
  <td width=20 valign=top style='width:15.3pt;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'>or </p>
  </td>
  <td width=22 valign=top style='width:16.2pt;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>web</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>.</span></p>
  </td>
  <td width=43 valign=top style='width:.45in;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>config</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:9.7pt;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:109%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>If
a configuration file () does not exist for the project, one will be created.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:9.35pt;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:109%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>The
Settings tab will be replaced with a grid control which enables you to create,
edit, and delete individual settings entries.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=122 style='width:91.8pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Settings</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>.</span></p>
  </td>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>settings</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:109%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>In
Solution Explorer, a item is added under the Properties special folder.
Opening this</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:9.8pt;
margin-left:30.5pt'>item will open the Settings tab.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=144 style='width:1.5in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Settings</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>.</span></p>
  </td>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Designer</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>.</span></p>
  </td>
  <td width=14 valign=top style='width:.15in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>__</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:109%'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>A
new file with a new partial class is added under the <span style='font-size:
9.0pt;line-height:109%;background:#FAFAFA'>Properties</span> folder in the
project folder. This new file is named (.cs, .vb, etc.), and the class is
named <span style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>Settings</span>.
The class is code-generated,</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:20.15pt;
margin-left:30.5pt'>so it should not be edited, but the class is a partial
class, so you can extend the class by putting additional members in a separate
file. Furthermore, the class is implemented using the Singleton Pattern,
exposing the singleton instance with the property named <span style='font-size:
9.0pt;line-height:109%;color:#0600FF;background:#FAFAFA'>Default</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:13.4pt;
margin-left:1.05pt'>As you add each new entry to the Settings tab, Visual
Studio does these two things:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:9.35pt;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:109%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Saves
the setting in the configuration file, in a custom configuration section
designed to be managed by the Settings class.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:25.8pt;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:109%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Creates
a new member in the Settings class to read, write, and present the setting in
the specific type selected from the Settings tab.</p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:3.25pt;margin-left:
-.25pt'><a name="_Toc281463">Section 14.4: Reading strongly-typed settings from
custom section of configuration file</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>Starting from a new Settings class and custom configuration
section:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><img border=0 width=711
height=330 id="Picture 17715"
src=".NET%20Framework%20Notes%20for%20Professionals_files/image227.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>Add an application setting named ExampleTimeout, using the
time System.Timespan, and set the value to 1 minute:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><img border=0 width=540
height=95 id="Picture 17718"
src=".NET%20Framework%20Notes%20for%20Professionals_files/image228.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.55pt;
margin-left:1.05pt'>Save the Project Properties, which saves the Settings tab
entries, as well as re-generates the custom Settings class and updates the
project configuration file.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:13.15pt;
margin-left:1.05pt'>Use the setting from code (C#):</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.35pt;
margin-left:.75pt;line-height:107%'><b>Program.cs</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:19.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=289
src=".NET%20Framework%20Notes%20for%20Professionals_files/image229.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.35pt;
margin-left:.75pt;line-height:107%'><b>Under the covers</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:45.85pt;margin-bottom:
0in;margin-left:1.05pt;line-height:217%'>Look in the project configuration file
to see how the application setting entry has been created: <b>app.config</b>
(Visual Studio updates this automatically)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.25pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=720 height=322
src=".NET%20Framework%20Notes%20for%20Professionals_files/image230.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.95pt;
margin-left:1.05pt'>Notice that the <span style='font-size:9.0pt;line-height:
109%;background:#FAFAFA'>appSettings</span> section is not used. The <span
style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>applicationSettings</span>
section contains a custom namespacequalified section that has a <span
style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>setting</span>
element for each entry. The type of the value is not stored in the
configuration file; it is only known by the <span style='font-size:9.0pt;
line-height:109%;background:#FAFAFA'>Settings</span> class.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt;line-height:218%'>Look in the <span style='font-size:9.0pt;
line-height:218%;background:#FAFAFA'>Settings</span> class to see how it uses
the <span style='font-size:9.0pt;line-height:218%;background:#FAFAFA'>ConfigurationManager</span>
class to read this custom section. <b>Settings.designer.cs</b> (for C#
projects)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.25pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%;color:#666666'>...</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:#666666'>[</span><span
style='font-size:9.0pt;line-height:110%'>global</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>::</span><span style='font-size:9.0pt;
line-height:110%'>System.Configuration</span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>.</span><span style='font-size:9.0pt;
line-height:110%'>ApplicationScopedSettingAttribute</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>()]</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:#666666'>[</span><span
style='font-size:9.0pt;line-height:110%'>global</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>::</span><span style='font-size:9.0pt;
line-height:110%'>System.Diagnostics</span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>.</span><span style='font-size:9.0pt;
line-height:110%'>DebuggerNonUserCodeAttribute</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>()]</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:129.8pt;margin-bottom:
.2pt;margin-left:3.5pt;line-height:110%'><span style='position:relative;
z-index:-1895789568'><span style='left:0px;position:absolute;left:0px;
top:-31435px;width:718px;height:1px'><img width=718 height=1
src=".NET%20Framework%20Notes%20for%20Professionals_files/image231.gif"></span></span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>[</span><span style='font-size:9.0pt;
line-height:110%'>global</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>::</span><span style='font-size:9.0pt;line-height:110%'>System.Configuration</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>DefaultSettingValueAttribute</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%;color:#A60000'>&quot;00:01:00&quot;</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>)] </span><span
style='font-size:9.0pt;line-height:110%'></span><span style='font-size:
9.0pt;line-height:110%;color:#0600FF'>public</span><span style='font-size:9.0pt;
line-height:110%'> global</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>::</span><span style='font-size:9.0pt;line-height:110%'>System</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>TimeSpan ExampleTimeout </span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>{ </span><span
style='font-size:9.0pt;line-height:110%'></span><span style='font-size:
9.0pt;line-height:110%;color:#0600FF'>get</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>{ </span><span style='font-size:9.0pt;line-height:110%'></span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>return</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>((</span><span style='font-size:9.0pt;
line-height:110%'>global</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>::</span><span style='font-size:9.0pt;line-height:110%'>System</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>TimeSpan</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>)(</span><span style='font-size:9.0pt;
line-height:110%;color:#0600FF'>this</span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>[</span><span style='font-size:9.0pt;
line-height:110%;color:#A60000'>&quot;ExampleTimeout&quot;</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>]));</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=54
src=".NET%20Framework%20Notes%20for%20Professionals_files/image232.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>Notice that a <span style='font-size:9.0pt;line-height:
109%;background:#FAFAFA'>DefaultSettingValueAttribute</span> was created to
stored the value entered in the Settings tab of the Project Properties
Designer. If the entry is missing from the configuration file, this default
value is used instead.<br clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc281464">Chapter 15: Regular
Expressions (System.Text.RegularExpressions)</a></h1>

<h2 style='margin-left:-.25pt'><a name="_Toc281465">Section 15.1: Check if
pattern matches input</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=142
src=".NET%20Framework%20Notes%20for%20Professionals_files/image233.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc281466">Section 15.2: Remove non
alphanumeric characters from string</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=109
src=".NET%20Framework%20Notes%20for%20Professionals_files/image234.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc281467">Section 15.3: Passing
Options</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=142
src=".NET%20Framework%20Notes%20for%20Professionals_files/image235.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc281468">Section 15.4: Match into
groups</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=174
src=".NET%20Framework%20Notes%20for%20Professionals_files/image236.gif"></span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc281469">Section 15.5: Find all matches</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:.75pt;line-height:107%'><b>Using</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:4.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src=".NET%20Framework%20Notes%20for%20Professionals_files/image237.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:.75pt;line-height:107%'><b>Code</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:4.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=174
src=".NET%20Framework%20Notes%20for%20Professionals_files/image238.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=75
src=".NET%20Framework%20Notes%20for%20Professionals_files/image239.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc281470">Section 15.6: Simple match
and replace</a></h2>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=142
src=".NET%20Framework%20Notes%20for%20Professionals_files/image240.gif"></span><br
clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc281471">Chapter 16: File
Input/Output</a></h1>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:1.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><b>Parameter Details</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:20.85pt;
margin-left:1.05pt'>string path Path of the file to check. (relative or fully
qualified)</p>

<h2 style='margin-left:-.25pt'><a name="_Toc281472">Section 16.1: C#
File.Exists()</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=322
src=".NET%20Framework%20Notes%20for%20Professionals_files/image241.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:14.55pt;
margin-left:1.05pt'>Can also be used in a ternary operator.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:23.0pt;
margin-left:3.5pt;line-height:110%'><span style='position:relative;z-index:
-1895788544'><span style='left:0px;position:absolute;left:0px;top:-33563px;
width:718px;height:1px'><img width=718 height=1
src=".NET%20Framework%20Notes%20for%20Professionals_files/image242.gif"></span></span><span
style='font-size:9.0pt;line-height:110%'>Console</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>.</span><span style='font-size:9.0pt;
line-height:110%'>WriteLine</span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>(</span><span style='font-size:9.0pt;line-height:110%'>File</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>Exists</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>(</span><span style='font-size:9.0pt;
line-height:110%'>pathToFile</span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>)</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>?</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#A60000'>&quot;Exists&quot;</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>:</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:#A60000'>&quot;Does not exist&quot;</span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>);</span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc281473">Section 16.2: VB
WriteAllText</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=76
src=".NET%20Framework%20Notes%20for%20Professionals_files/image243.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc281474">Section 16.3: VB
StreamWriter</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=109
src=".NET%20Framework%20Notes%20for%20Professionals_files/image244.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc281475">Section 16.4: C#
StreamWriter</a></h2>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=120
src=".NET%20Framework%20Notes%20for%20Professionals_files/image245.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=54
src=".NET%20Framework%20Notes%20for%20Professionals_files/image246.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc281476">Section 16.5: C#
WriteAllText()</a></h2>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=92
src=".NET%20Framework%20Notes%20for%20Professionals_files/image247.gif"></span><br
clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc281477">Chapter 17: System.IO</a></h1>

<h2 style='margin-left:-.25pt'><a name="_Toc281478">Section 17.1: Reading a
text file using StreamReader</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=142
src=".NET%20Framework%20Notes%20for%20Professionals_files/image248.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.55pt;
margin-left:1.05pt'>Note that this <span style='font-size:9.0pt;line-height:
109%;background:#FAFAFA'>StreamReader</span> constructor overload does some
auto <u><span style='color:#1889D0'>encoding</span></u> detection, which may or
may not conform to the actual encoding used in the file.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=101 style='width:1.05in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=101 valign=top style='width:1.05in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>System.IO</span><span style='font-size:9.0pt;line-height:107%;
  color:#666666'>.</span><span style='font-size:9.0pt;line-height:107%'>File</span></p>
  </td>
 </tr>
</table>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=355 style='width:266.05pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=158 valign=top style='width:1.65in;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>File</span><span style='font-size:9.0pt;line-height:107%;color:#666666'>.</span><span
  style='font-size:9.0pt;line-height:107%'>ReadAllText</span><span
  style='font-size:9.0pt;line-height:107%;color:#666666'>(</span><span
  style='font-size:9.0pt;line-height:107%'>path</span><span style='font-size:
  9.0pt;line-height:107%;color:#666666'>)</span></p>
  </td>
  <td width=31 valign=top style='width:23.05pt;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'>and </p>
  </td>
  <td width=166 valign=top style='width:124.2pt;background:#FAFAFA;padding:
  .9pt 0in 0in 0in;height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>File</span><span style='font-size:9.0pt;line-height:107%;color:#666666'>.</span><span
  style='font-size:9.0pt;line-height:107%'>ReadAllLines</span><span
  style='font-size:9.0pt;line-height:107%;color:#666666'>(</span><span
  style='font-size:9.0pt;line-height:107%'>path</span><span style='font-size:
  9.0pt;line-height:107%;color:#666666'>)</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:8.75pt;margin-bottom:
0in;margin-left:1.05pt;line-height:134%'>Please note that there are some
convenience methods that read all text from file available on the class, namely
.</p>

<h2 style='margin-top:0in;margin-right:8.75pt;margin-bottom:0in;margin-left:
1.05pt;margin-bottom:.0001pt;line-height:134%'><a name="_Toc281479">Section
17.2: Serial Ports using System.IO.SerialPorts</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:19.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=124
src=".NET%20Framework%20Notes%20for%20Professionals_files/image249.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=91
src=".NET%20Framework%20Notes%20for%20Professionals_files/image250.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:28.4pt;
margin-left:1.05pt'><b>NOTE</b>: Those are just three of the seven overloads of
the constructor for the SerialPort type.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.35pt;
margin-left:.75pt;line-height:107%'><b>Reading/Writing data over the SerialPort</b></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=254 style='width:190.45pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=108 valign=top style='width:81.0pt;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>SerialPort</span><span style='font-size:9.0pt;line-height:107%;
  color:#666666'>.</span><span style='font-size:9.0pt;line-height:107%'>Read</span></p>
  </td>
  <td width=31 valign=top style='width:23.05pt;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'>and </p>
  </td>
  <td width=115 valign=top style='width:1.2in;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>SerialPort</span><span style='font-size:9.0pt;line-height:107%;
  color:#666666'>.</span><span style='font-size:9.0pt;line-height:107%'>Write</span></p>
  </td>
 </tr>
</table>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=115 style='width:1.2in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=115 valign=top style='width:1.2in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>System.IO</span><span style='font-size:9.0pt;line-height:107%;
  color:#666666'>.</span><span style='font-size:9.0pt;line-height:107%'>Stream</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal align=center style='margin-bottom:.2pt;text-align:center;
line-height:123%'>The simplest way is to use the methods. However you can also
retrieve a object which you can use to stream data over the SerialPort. To do
this, use</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=151 style='width:113.4pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=151 valign=top style='width:113.4pt;background:#FAFAFA;padding:
  1.8pt 0in 0in 0in;height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>SerialPort</span><span style='font-size:9.0pt;line-height:107%;
  color:#666666'>.</span><span style='font-size:9.0pt;line-height:107%'>BaseStream</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:13.15pt;
margin-left:113.9pt'>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:.75pt;line-height:107%'><b>Reading</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=76
src=".NET%20Framework%20Notes%20for%20Professionals_files/image251.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>You can also read all data available:</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=26
src=".NET%20Framework%20Notes%20for%20Professionals_files/image252.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>Or simply read to the first newline encountered in the
incoming data:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src=".NET%20Framework%20Notes%20for%20Professionals_files/image253.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.35pt;
margin-left:.75pt;line-height:107%'><b>Writing</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>The easiest way to write data over the SerialPort is:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src=".NET%20Framework%20Notes%20for%20Professionals_files/image254.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>However you can also send data over like this when needed:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=720 height=60
src=".NET%20Framework%20Notes%20for%20Professionals_files/image255.gif"></span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:2.5pt;margin-left:
-.25pt'><a name="_Toc281480">Section 17.3: Reading/Writing Data Using
System.IO.File</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>First, let's see three different ways of extracting data
from a file.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.9pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=720 height=150
src=".NET%20Framework%20Notes%20for%20Professionals_files/image256.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:14.15pt;
margin-left:1.05pt'>Next, let's see three different methods of <b>appending</b>
data to a file. If the file you specify doesn't exist, each method will
automatically create the file before attempting to append the data to it.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:21.85pt;margin-bottom:
.25pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%'>File</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%'>AppendAllText</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%'>file, </span><span style='font-size:
9.0pt;line-height:110%;color:#A60000'>&quot;Here is some data that is</span><b><span
style='font-size:9.0pt;line-height:110%;color:teal'>\n</span></b><span
style='font-size:9.0pt;line-height:110%;color:#A60000'>appended to the
file.&quot;</span><span style='font-size:9.0pt;line-height:110%;color:#666666'>);</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;line-height:110%'><span style='position:relative;z-index:
-1895787520'><span style='left:0px;position:absolute;left:0px;top:-35812px;
width:718px;height:1px'><img width=718 height=1
src=".NET%20Framework%20Notes%20for%20Professionals_files/image257.gif"></span></span><span
style='font-size:9.0pt;line-height:110%'>File</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>.</span><span style='font-size:9.0pt;
line-height:110%'>AppendAllLines</span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>(</span><span style='font-size:9.0pt;line-height:110%'>file,
</span><span style='font-size:9.0pt;line-height:110%;color:#0600FF'>new</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#0600FF'>string</span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>[</span><span style='font-size:9.0pt;
line-height:110%;color:red'>2</span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>]</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>{</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#A60000'>&quot;Here is some data that is&quot;</span><span
style='font-size:9.0pt;line-height:110%'>, </span><span style='font-size:9.0pt;
line-height:110%;color:#A60000'>&quot;appended to the file.&quot;</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>}); </span><span style='font-size:9.0pt;
line-height:110%'></span><span style='font-size:9.0pt;line-height:110%;
color:#0600FF'>using</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%'>StreamWriter stream </span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>=</span><span
style='font-size:9.0pt;line-height:110%'> File</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>.</span><span style='font-size:9.0pt;
line-height:110%'>AppendText</span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>(</span><span style='font-size:9.0pt;line-height:110%'>file</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>))</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:259.45pt;margin-bottom:
.25pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%'></span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>{ </span><span style='font-size:9.0pt;line-height:110%'>stream</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>WriteLine</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%;color:#A60000'>&quot;Here is some data
that is&quot;</span><span style='font-size:9.0pt;line-height:110%;color:#666666'>);
</span><span style='font-size:9.0pt;line-height:110%'>stream</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>Write</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>(</span><span style='font-size:9.0pt;
line-height:110%;color:#A60000'>&quot;appended to the file.&quot;</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>);</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.35pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%'></span><span style='font-size:9.0pt;line-height:110%;color:#666666'>}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:30.5pt'>On the first line we simply add a string to the end of the
specified file.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:30.5pt'>On the second line we add each element of the array onto a
new line in the file.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=108 style='width:81.0pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>File</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>.</span></p>
  </td>
  <td width=72 valign=top style='width:.75in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>AppendText</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.8pt;
margin-left:30.5pt'>Finally on the third line we use to open up a streamwriter
which will append whatever data is written to it.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:14.15pt;
margin-left:1.05pt'>And lastly, let's see three different methods of <b>writing</b>
data to a file. The difference between <i>appending</i> and <i>writing </i>being
that writing <b>over-writes</b> the data in the file while appending <b>adds</b>
to the data in the file. If the file you specify doesn't exist, each method
will automatically create the file before attempting to write the data to it.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:21.85pt;margin-bottom:
.25pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%'>File</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%'>WriteAllText</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%'>file, </span><span style='font-size:
9.0pt;line-height:110%;color:#A60000'>&quot;here is some data</span><b><span
style='font-size:9.0pt;line-height:110%;color:teal'>\n</span></b><span
style='font-size:9.0pt;line-height:110%;color:#A60000'>in this file.&quot;</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>);</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.3pt;
margin-left:3.5pt;line-height:110%'><span style='position:relative;z-index:
-1895786496'><span style='left:0px;position:absolute;left:0px;top:-36090px;
width:718px;height:1px'><img width=718 height=1
src=".NET%20Framework%20Notes%20for%20Professionals_files/image258.gif"></span></span><span
style='font-size:9.0pt;line-height:110%'>File</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>.</span><span style='font-size:9.0pt;
line-height:110%'>WriteAllLines</span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>(</span><span style='font-size:9.0pt;line-height:110%'>file,
</span><span style='font-size:9.0pt;line-height:110%;color:#0600FF'>new</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#0600FF'>string</span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>[</span><span style='font-size:9.0pt;
line-height:110%;color:red'>2</span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>]</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>{</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#A60000'>&quot;here is some data&quot;</span><span
style='font-size:9.0pt;line-height:110%'>, </span><span style='font-size:9.0pt;
line-height:110%;color:#A60000'>&quot;in this file&quot;</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>}); </span><span style='font-size:9.0pt;
line-height:110%'>File</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%'>WriteAllBytes</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%'>file, </span><span style='font-size:
9.0pt;line-height:110%;color:#0600FF'>new</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:#0600FF'>byte</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>[</span><span style='font-size:9.0pt;line-height:110%;
color:red'>2</span><span style='font-size:9.0pt;line-height:110%;color:#666666'>]</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>{</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:red'>0</span><span style='font-size:9.0pt;line-height:110%'>, </span><span
style='font-size:9.0pt;line-height:110%;color:red'>255</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>});</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:30.5pt'>The first line writes a string to the file.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:30.5pt'>The second line writes each string in the array on it's own
line in the file.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:21.4pt'><span style='font-size:11.0pt;line-height:109%'><img
border=0 width=5 height=5 id="Group 244817"
src=".NET%20Framework%20Notes%20for%20Professionals_files/image259.gif"></span>And
the third line allows you to write a byte array to the file.<br clear=all
style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc281481">Chapter 18: System.IO.File
class</a></h1>

<p class=MsoNormal style='margin-top:0in;margin-right:188.2pt;margin-bottom:
4.0pt;margin-left:.55pt;text-indent:.05in'><b>Parameter Details </b><span
style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>source </span>The
file that is to be moved to another location.</p>

<p class=MsoNormal align=right style='margin-top:0in;margin-right:11.45pt;
margin-bottom:0in;margin-left:.5pt;text-align:right;line-height:107%'>The
directory in which you would like to move <span style='font-size:9.0pt;
line-height:107%;background:#FAFAFA'>source</span> to (this variable should
also contain the name</p>

<p class=MsoNormal style='margin-top:0in;margin-right:337.1pt;margin-bottom:
21.25pt;margin-left:63.2pt;text-indent:-62.65pt'><span style='font-size:9.0pt;
line-height:109%;background:#FAFAFA'>destination </span>(and file extension) of
the file.</p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:2.5pt;margin-left:
-.25pt'><a name="_Toc281482">Section 18.1: Delete a file</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>To delete a file (if you have required permissions) is as
simple as:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src=".NET%20Framework%20Notes%20for%20Professionals_files/image260.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:13.25pt;
margin-left:1.05pt'>However many things may go wrong:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:21.4pt'><img width=5 height=1
src=".NET%20Framework%20Notes%20for%20Professionals_files/image195.gif"
align=left hspace=12>You do not have required permissions (<span
style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>UnauthorizedAccessException</span>
is thrown).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:21.4pt'>File may be in use by someone else (<span style='font-size:
9.0pt;line-height:109%;background:#FAFAFA'>IOException</span> is thrown).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:49.45pt;margin-bottom:
12.65pt;margin-left:21.4pt'>File cannot be deleted because of low level error
or media is read-only (<span style='font-size:9.0pt;line-height:109%;
background:#FAFAFA'>IOException</span> is thrown). File does not exist anymore
(<span style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>IOException</span>
is thrown).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>Note that last point (file does not exist) is usually <i>circumvented</i>
with a code snippet like this:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src=".NET%20Framework%20Notes%20for%20Professionals_files/image261.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=79 style='width:59.4pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>File</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>.</span></p>
  </td>
  <td width=43 valign=top style='width:.45in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Exists</span></p>
  </td>
 </tr>
</table>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=79 style='width:59.4pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>File</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>.</span></p>
  </td>
  <td width=43 valign=top style='width:.45in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Delete</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>However it's not an atomic operation and file may be delete
by someone else between the call to <span style='font-size:9.0pt;line-height:
109%;color:#666666;background:#FAFAFA'>() </span>and before <span
style='font-size:9.0pt;line-height:109%;color:#666666;background:#FAFAFA'>()</span>.
Right approach to handle I/O operation requires exception handling (assuming an
alternative course of actions may be taken when operation fails):</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=306
src=".NET%20Framework%20Notes%20for%20Professionals_files/image262.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>Note that this I/O errors sometimes are transitory (file in
use, for example) and if a network connection is involved then it may
automatically recover without any action from our side. It's then common to <i>retry</i>
an I/O operation few times with a small delay between each attempt:</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=67
src=".NET%20Framework%20Notes%20for%20Professionals_files/image263.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=448
src=".NET%20Framework%20Notes%20for%20Professionals_files/image264.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=115 style='width:1.2in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=65 valign=top style='width:48.6pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>FileShare</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>.</span></p>
  </td>
  <td width=43 valign=top style='width:.45in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Delete</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:11.45pt;margin-bottom:
.25pt;margin-left:-.25pt;text-align:justify;text-justify:inter-ideograph;
line-height:135%'>Note: in Windows environment file will not be really deleted
when you call this function, if someone else open the file using then file can
be deleted but it will effectively happen only when owner will close the file.</p>

<h2 style='margin-top:0in;margin-right:11.45pt;margin-bottom:.25pt;margin-left:
-.25pt;text-align:justify;text-justify:inter-ideograph;line-height:135%'><a
name="_Toc281483">Section 18.2: Strip unwanted lines from a text file</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.55pt;
margin-left:1.05pt'>To change a text file is not easy because its content must
be moved around. For <i>small</i> files easiest method is to read its content
in memory and then write back modified text.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>In this example we read all lines from a file and drop all
blank lines then we write back to original path:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src=".NET%20Framework%20Notes%20for%20Professionals_files/image265.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>If file is too big to load it in memory and output path is
different from input path:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src=".NET%20Framework%20Notes%20for%20Professionals_files/image266.gif"></span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:2.5pt;margin-left:
-.25pt'><a name="_Toc281484">Section 18.3: Convert text file encoding</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>Text is saved encoded (see also Strings topic) then
sometimes you may need to change its encoding, this example assumes (for
simplicity) that file is not too big and it can be entirely read in memory:</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=76
src=".NET%20Framework%20Notes%20for%20Professionals_files/image267.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:21.5pt;margin-bottom:
.25pt;margin-left:-.25pt;text-align:justify;text-justify:inter-ideograph;
line-height:135%'>When performing conversions do not forget that file may
contain BOM (Byte Order Mark), to better understand how it's managed refer to <a
href="http://stackoverflow.com/q/11701341/1207195"><span style='color:#1889D0'>Encoding.UTF8.GetString
doesn't take into account the Preamble/BOM</span></a>.</p>

<h2 style='margin-top:0in;margin-right:21.5pt;margin-bottom:.25pt;margin-left:
-.25pt;text-align:justify;text-justify:inter-ideograph;line-height:135%'><a
name="_Toc281485">Section 18.4: Enumerate files older than a specified amount</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:14.2pt;
margin-left:1.05pt'>This snippet is an helper function to enumerate all files
older than a specified age, it's useful - for example - when you have to delete
old log files or old cached data.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:227.05pt;margin-bottom:
.2pt;margin-left:3.5pt;line-height:110%'><span style='position:relative;
z-index:-1895784448'><span style='left:0px;position:absolute;left:0px;
top:-38254px;width:718px;height:1px'><img width=718 height=1
src=".NET%20Framework%20Notes%20for%20Professionals_files/image268.gif"></span></span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>static</span><span
style='font-size:9.0pt;line-height:110%'> IEnumerable</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>&lt;</span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>string</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>&gt;</span><span
style='font-size:9.0pt;line-height:110%'> EnumerateAllFilesOlderThan</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>( </span><span
style='font-size:9.0pt;line-height:110%'>TimeSpan
maximumAge, </span><span style='font-size:9.0pt;
line-height:110%;color:#0600FF'>string</span><span style='font-size:9.0pt;
line-height:110%'> path,</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:81.25pt;margin-bottom:
.2pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:
9.0pt;line-height:110%;color:#0600FF'>string</span><span style='font-size:9.0pt;
line-height:110%'> searchPattern </span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>=</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:#A60000'>&quot;*.*&quot;</span><span style='font-size:9.0pt;line-height:
110%'>, SearchOption options </span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>=</span><span
style='font-size:9.0pt;line-height:110%'> SearchOption</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>TopDirectoryOnly</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.25pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%;color:#666666'>{</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.55pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%'> DateTime oldestWriteTime </span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>=</span><span style='font-size:9.0pt;
line-height:110%'> DateTime</span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%'>Now </span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>-</span><span
style='font-size:9.0pt;line-height:110%'> maximumAge</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:140.65pt;margin-bottom:
.2pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:#0600FF'>return</span><span style='font-size:9.0pt;line-height:110%'>
Directory</span><span style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>EnumerateFiles</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%'>path, searchPattern, options</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>) </span><span
style='font-size:9.0pt;line-height:110%'></span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>.</span><span style='font-size:9.0pt;
line-height:110%;color:#0600FF'>Where</span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>(</span><span style='font-size:9.0pt;
line-height:110%'>x </span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>=&gt;</span><span style='font-size:9.0pt;line-height:110%'>
Directory</span><span style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>GetLastWriteTime</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%'>x</span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>)</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>&lt;</span><span style='font-size:9.0pt;line-height:110%'>
oldestWriteTime</span><span style='font-size:9.0pt;line-height:110%;color:#666666'>);</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:17.25pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%;color:#666666'>}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:81.25pt;margin-bottom:
1.45pt;margin-left:3.75pt;text-indent:-3.75pt;line-height:253%'><span
style='position:relative;z-index:-1895783424'><span style='left:0px;position:
absolute;left:0px;top:-38433px;width:718px;height:1px'><img width=718 height=1
src=".NET%20Framework%20Notes%20for%20Professionals_files/image269.gif"></span></span>Used
like this: <span style='font-size:9.0pt;line-height:253%;color:#0600FF'>var</span><span
style='font-size:9.0pt;line-height:253%'> oldFiles </span><span
style='font-size:9.0pt;line-height:253%;color:#666666'>=</span><span
style='font-size:9.0pt;line-height:253%'> EnumerateAllFilesOlderThan</span><span
style='font-size:9.0pt;line-height:253%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:253%'>TimeSpan</span><span style='font-size:
9.0pt;line-height:253%;color:#666666'>.</span><span style='font-size:9.0pt;
line-height:253%'>FromDays</span><span style='font-size:9.0pt;line-height:253%;
color:#666666'>(</span><span style='font-size:9.0pt;line-height:253%;
color:red'>7</span><span style='font-size:9.0pt;line-height:253%;color:#666666'>)</span><span
style='font-size:9.0pt;line-height:253%'>, </span><span style='font-size:9.0pt;
line-height:253%;color:#A60000'>@&quot;c:\log&quot;</span><span
style='font-size:9.0pt;line-height:253%'>, </span><span style='font-size:9.0pt;
line-height:253%;color:#A60000'>&quot;*.log&quot;</span><span style='font-size:
9.0pt;line-height:253%;color:#666666'>);</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.95pt;
margin-left:1.05pt'>Few things to note:</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=385 style='width:289.1pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=65 valign=top style='width:48.6pt;background:#FAFAFA;padding:1.05pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Directory</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.05pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>.</span></p>
  </td>
  <td width=101 valign=top style='width:1.05in;background:#FAFAFA;padding:1.05pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>EnumerateFiles</span></p>
  </td>
  <td width=83 valign=top style='width:62.3pt;padding:1.05pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>()</span> instead of </p>
  </td>
  <td width=65 valign=top style='width:48.6pt;background:#FAFAFA;padding:1.05pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Directory</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.05pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>.</span></p>
  </td>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:1.05pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>GetFiles</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:21.4pt'><img width=5 height=1
src=".NET%20Framework%20Notes%20for%20Professionals_files/image270.gif"
align=left hspace=12>Search is performed using <span style='font-size:9.0pt;
line-height:109%;color:#666666;background:#FAFAFA'>()</span>. Enumeration is <i>alive</i>
then you won't need to wait until all file system entries have been fetched.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:21.4pt'>We're checking for last write time but you may use creation
time or last access time (for example to delete <i>unused</i> cached files,
note that access time may be disabled).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:24.0pt;margin-bottom:
.25pt;margin-left:-.75pt;text-align:justify;text-justify:inter-ideograph;
text-indent:5.5pt;line-height:135%'>Granularity isn't uniform for all those
properties (write time, access time, creation time), check MSDN for details
about this.</p>

<h2 style='margin-top:0in;margin-right:24.0pt;margin-bottom:.25pt;margin-left:
-.75pt;text-align:justify;text-justify:inter-ideograph;text-indent:5.5pt;
line-height:135%'><a name="_Toc281486">Section 18.5: Move a File from one
location to another</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:2.1pt;
margin-left:.75pt;line-height:107%'><b>File.Move</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:.15in;
margin-left:1.05pt'>In order to move a file from one location to another, one
simple line of code can achieve this:</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=526 style='width:394.2pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>File</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>.</span></p>
  </td>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Move</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>(</span></p>
  </td>
  <td width=454 valign=top style='width:340.2pt;background:#FAFAFA;padding:
  1.8pt 0in 0in 0in;height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#A60000'>@&quot;C:\TemporaryFile.txt&quot;</span><span
  style='font-size:9.0pt;line-height:107%'>, </span><span style='font-size:
  9.0pt;line-height:107%;color:#A60000'>@&quot;C:\TemporaryFiles\TemporaryFile.txt&quot;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:0in;
margin-bottom:13.75pt;margin-left:260.6pt;text-align:center;text-indent:0in;
line-height:107%'><span style='font-size:9.0pt;line-height:107%;color:#666666;
background:#FAFAFA'>);</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.55pt;
margin-left:1.05pt'>However, there are many things that could go wrong with
this simple operation. For instance, what if the user running your program does
not have a Drive that is labelled 'C'? What if they did - but they decided to
rename it to 'B', or 'M'?</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.55pt;
margin-left:1.05pt'>What if the Source file (the file in which you would like
to move) has been moved without your knowing - or what if it simply doesn't
exist.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>This can be circumvented by first checking to see whether
the source file does exist:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=720 height=92
src=".NET%20Framework%20Notes%20for%20Professionals_files/image271.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=79 style='width:59.4pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>File</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>.</span></p>
  </td>
  <td width=43 valign=top style='width:.45in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Exists</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.25pt;
margin-left:-.25pt;text-align:justify;text-justify:inter-ideograph;line-height:
135%'>This will ensure that at that very moment, the file does exist, and can
be moved to another location. There may be times where a simple call to won't
be enough. If it isn't, check again, convey to the user that the operation
failed - or handle the exception.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:13.1pt;
margin-left:1.05pt'>A <span style='font-size:9.0pt;line-height:109%;background:
#FAFAFA'>FileNotFoundException</span> is not the only exception you are likely
to encounter.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>See below for possible exceptions:</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=678
 style='width:508.25pt;margin-left:1.0pt;border-collapse:collapse'>
 <tr style='height:12.3pt'>
  <td width=199 valign=top style='width:149.05pt;padding:0in 0in 0in 0in;
  height:12.3pt'>
  <p class=MsoNormal align=center style='margin-top:0in;margin-right:2.0pt;
  margin-bottom:0in;margin-left:0in;text-align:center;text-indent:0in;
  line-height:107%'><b>Exception Type</b></p>
  </td>
  <td width=479 valign=top style='width:359.2pt;padding:0in 0in 0in 0in;
  height:12.3pt'>
  <p class=MsoNormal align=center style='margin-top:0in;margin-right:0in;
  margin-bottom:0in;margin-left:28.35pt;text-align:center;text-indent:0in;
  line-height:107%'><b>Description</b></p>
  </td>
 </tr>
 <tr style='height:15.4pt'>
  <td width=199 valign=top style='width:149.05pt;padding:0in 0in 0in 0in;
  height:15.4pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:9.0pt;line-height:107%;background:#FAFAFA'>IOException</span></p>
  </td>
  <td width=479 valign=top style='width:359.2pt;padding:0in 0in 0in 0in;
  height:15.4pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>The
  file already exists or the source file could not be found.</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=199 valign=top style='width:149.05pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:9.0pt;line-height:107%;background:#FAFAFA'>ArgumentNullException</span></p>
  </td>
  <td width=479 valign=top style='width:359.2pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>The
  value of the Source and/or Destination parameters is null.</p>
  </td>
 </tr>
 <tr style='height:25.65pt'>
  <td width=199 style='width:149.05pt;padding:0in 0in 0in 0in;height:25.65pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:9.0pt;line-height:107%;background:#FAFAFA'>ArgumentException</span></p>
  </td>
  <td width=479 valign=top style='width:359.2pt;padding:0in 0in 0in 0in;
  height:25.65pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>The
  value of the Source and/or Destination parameters are empty, or contain
  invalid characters.</p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:4.3pt;
margin-left:1.05pt'><span style='font-size:9.0pt;line-height:109%;background:
#FAFAFA'>UnauthorizedAccessException </span>You do not have the required
permissions in order to perform this action.</p>

<p class=MsoNormal align=right style='margin-top:0in;margin-right:31.75pt;
margin-bottom:0in;margin-left:.5pt;text-align:right;line-height:107%'>The
Source, Destination or specified path(s) exceed the maximum length. On</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:3.5pt;
margin-left:149.6pt;text-indent:-149.05pt'><span style='font-size:9.0pt;
line-height:109%;background:#FAFAFA'>PathTooLongException </span>Windows,
a Path's length must be less than 248 characters, while File names must be less
than 260 characters.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:4.45pt;
margin-left:1.05pt'><span style='font-size:9.0pt;line-height:109%;background:
#FAFAFA'>DirectoryNotFoundException </span>The specified directory could not be
found.</p>

<p class=MsoNormal style='margin-left:0in;text-indent:0in'><span
style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>NotSupportedException </span>The
Source or Destination paths or file names are in an invalid format.<br
clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc281487">Chapter 19: Reading and
writing Zip files</a></h1>

<p class=MsoNormal style='margin-top:0in;margin-right:22.15pt;margin-bottom:
.25pt;margin-left:-.25pt;text-align:justify;text-justify:inter-ideograph;
line-height:135%'>The <b>ZipFile</b> class lives in the <b>System.IO.Compression</b>
namespace. It can be used to read from, and write to Zip files.</p>

<h2 style='margin-top:0in;margin-right:22.15pt;margin-bottom:.25pt;margin-left:
-.25pt;text-align:justify;text-justify:inter-ideograph;line-height:135%'><a
name="_Toc281488">Section 19.1: Listing ZIP contents</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>This snippet will list all the filenames of a zip archive.
The filenames are relative to the zip root.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=142
src=".NET%20Framework%20Notes%20for%20Professionals_files/image272.gif"></span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:2.5pt;margin-left:
-.25pt'><a name="_Toc281489">Section 19.2: Extracting files from ZIP files</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>Extracting all the files into a directory is very easy:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=92
src=".NET%20Framework%20Notes%20for%20Professionals_files/image273.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:13.15pt;
margin-left:1.05pt'>When the file already exists, a <b>System.IO.IOException</b>
will be thrown.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:14.55pt;
margin-left:1.05pt'>Extracting specific files:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:162.2pt;margin-bottom:
.2pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;color:#0600FF'>using</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>(</span><span style='font-size:9.0pt;line-height:110%'>FileStream
fs </span><span style='font-size:9.0pt;line-height:110%;color:#666666'>=</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#0600FF'>new</span><span style='font-size:9.0pt;
line-height:110%'> FileStream</span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>(</span><span style='font-size:9.0pt;line-height:110%;
color:#A60000'>&quot;archive.zip&quot;</span><span style='font-size:9.0pt;
line-height:110%'>, FileMode</span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%'>Open</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>)) </span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>using</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>(</span><span style='font-size:9.0pt;
line-height:110%'>ZipArchive archive </span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>=</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:#0600FF'>new</span><span style='font-size:9.0pt;line-height:110%'>
ZipArchive</span><span style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%'>fs, ZipArchiveMode</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>Read</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>)) {</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:21.85pt;margin-bottom:
12.45pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%'> </span><i><span style='font-size:9.0pt;line-height:110%;
color:darkgreen'>// Get a root entry file </span></i><span style='font-size:
9.0pt;line-height:110%'>archive</span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>.</span><span style='font-size:9.0pt;
line-height:110%'>GetEntry</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>(</span><span style='font-size:9.0pt;line-height:110%;
color:#A60000'>&quot;test.txt&quot;</span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>).</span><span style='font-size:9.0pt;
line-height:110%'>ExtractToFile</span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>(</span><span style='font-size:9.0pt;line-height:110%;
color:#A60000'>&quot;test_extracted_getentries.txt&quot;</span><span
style='font-size:9.0pt;line-height:110%'>, </span><span style='font-size:9.0pt;
line-height:110%;color:#0600FF'>true</span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>);</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.45pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%'> </span><i><span style='font-size:9.0pt;line-height:110%;color:darkgreen'>//
Enter a path if you want to extract files from a subdirectory </span></i><span
style='font-size:9.0pt;line-height:110%'>archive</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>GetEntry</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>(</span><span style='font-size:9.0pt;
line-height:110%;color:#A60000'>&quot;sub/subtest.txt&quot;</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>).</span><span
style='font-size:9.0pt;line-height:110%'>ExtractToFile</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%;color:#A60000'>&quot;test_sub.txt&quot;</span><span
style='font-size:9.0pt;line-height:110%'>, </span><span style='font-size:9.0pt;
line-height:110%;color:#0600FF'>true</span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>);</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:55.15pt;margin-bottom:
.25pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%'> </span><i><span style='font-size:9.0pt;line-height:110%;
color:darkgreen'>// You can also use the Entries property to find files </span></i><span
style='font-size:9.0pt;line-height:110%'>archive</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>Entries</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>.</span><span style='font-size:9.0pt;
line-height:110%'>FirstOrDefault</span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>(</span><span style='font-size:9.0pt;line-height:110%'>f </span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>=&gt;</span><span
style='font-size:9.0pt;line-height:110%'> f</span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>.</span><span style='font-size:9.0pt;
line-height:110%'>Name </span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>==</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:21.85pt;margin-bottom:
12.55pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;color:#A60000'>&quot;test.txt&quot;</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>)?.</span><span
style='font-size:9.0pt;line-height:110%'>ExtractToFile</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%;color:#A60000'>&quot;test_extracted_linq.txt&quot;</span><span
style='font-size:9.0pt;line-height:110%'>, </span><span style='font-size:9.0pt;
line-height:110%;color:#0600FF'>true</span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>);</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:80.0pt;margin-bottom:
17.05pt;margin-left:3.75pt;text-align:justify;text-justify:inter-ideograph;
text-indent:0in;line-height:112%'><span style='position:relative;z-index:-1895781376'><span
style='left:0px;position:absolute;left:0px;top:-40110px;width:718px;height:
1px'><img width=718 height=1
src=".NET%20Framework%20Notes%20for%20Professionals_files/image274.gif"></span></span><span
style='font-size:9.0pt;line-height:112%'> </span><i><span style='font-size:
9.0pt;line-height:112%;color:darkgreen'>// This will throw a
System.ArgumentNullException because the file cannot be found </span></i><span
style='font-size:9.0pt;line-height:112%'>archive</span><span
style='font-size:9.0pt;line-height:112%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:112%'>GetEntry</span><span style='font-size:
9.0pt;line-height:112%;color:#666666'>(</span><span style='font-size:9.0pt;
line-height:112%;color:#A60000'>&quot;nonexistingfile.txt&quot;</span><span
style='font-size:9.0pt;line-height:112%;color:#666666'>).</span><span
style='font-size:9.0pt;line-height:112%'>ExtractToFile</span><span
style='font-size:9.0pt;line-height:112%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:112%;color:#A60000'>&quot;fail.txt&quot;</span><span
style='font-size:9.0pt;line-height:112%'>, </span><span style='font-size:9.0pt;
line-height:112%;color:#0600FF'>true</span><span style='font-size:9.0pt;
line-height:112%;color:#666666'>); }</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:235.7pt;margin-bottom:
0in;margin-left:1.05pt;line-height:145%'>Any of these methods will produce the
same result.</p>

<h2 style='margin-top:0in;margin-right:235.7pt;margin-bottom:0in;margin-left:
1.05pt;margin-bottom:.0001pt;line-height:145%'><a name="_Toc281490">Section
19.3: Updating a ZIP file</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>To update a ZIP file, the file has to be opened with
ZipArchiveMode.Update instead.</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=29
src=".NET%20Framework%20Notes%20for%20Professionals_files/image275.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=136
src=".NET%20Framework%20Notes%20for%20Professionals_files/image276.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>There is also the option to write directly to a file within
the archive:</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=92
src=".NET%20Framework%20Notes%20for%20Professionals_files/image277.gif"></span><br
clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc281491">Chapter 20: Managed
Extensibility Framework</a></h1>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:2.5pt;margin-left:
-.25pt'><a name="_Toc281492">Section 20.1: Connecting (Basic)</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>See the other (Basic) examples above.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=437
src=".NET%20Framework%20Notes%20for%20Professionals_files/image278.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=223 style='width:167.4pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=223 valign=top style='width:167.4pt;background:#FAFAFA;padding:
  1.8pt 0in 0in 0in;height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666'>[</span><span style='font-size:9.0pt;line-height:107%'>Export</span><span
  style='font-size:9.0pt;line-height:107%;color:#666666'>(</span><span
  style='font-size:9.0pt;line-height:107%;color:#0600FF'>typeof</span><span
  style='font-size:9.0pt;line-height:107%;color:#666666'>(</span><span
  style='font-size:9.0pt;line-height:107%'>IUserProvider</span><span
  style='font-size:9.0pt;line-height:107%;color:#666666'>))]</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>As long as something in the application's assembly search
path has ,</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:13.3pt;
margin-left:1.05pt'><span style='font-size:9.0pt;line-height:109%;background:
#FAFAFA'>UserWriter</span>'s corresponding import will be satisfied and the
users will be printed.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:18.25pt;
margin-left:1.05pt'>Other types of catalogs (e.g., <span style='font-size:9.0pt;
line-height:109%;background:#FAFAFA'>DirectoryCatalog</span>) can be used
instead of (or in addition to) <span style='font-size:9.0pt;line-height:109%;
background:#FAFAFA'>ApplicationCatalog</span>, to look in other places for
exports that satisfy the imports.</p>

<h2 style='margin-left:-.25pt'><a name="_Toc281493">Section 20.2: Exporting a
Type (Basic)</a></h2>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=263
src=".NET%20Framework%20Notes%20for%20Professionals_files/image279.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=87
src=".NET%20Framework%20Notes%20for%20Professionals_files/image280.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:11.1pt;margin-bottom:
.25pt;margin-left:-.25pt;text-align:justify;text-justify:inter-ideograph;
line-height:135%'>This could be defined virtually anywhere; all that matters is
that the application knows where to look for it (via the ComposablePartCatalogs
it creates).</p>

<h2 style='margin-top:0in;margin-right:11.1pt;margin-bottom:.25pt;margin-left:
-.25pt;text-align:justify;text-justify:inter-ideograph;line-height:135%'><a
name="_Toc281494">Section 20.3: Importing (Basic)</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=322
src=".NET%20Framework%20Notes%20for%20Professionals_files/image281.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>This is a type that has a dependency on an <span
style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>IUserProvider</span>,
which could be defined anywhere. Like the previous example, all that matters is
that the application knows where to look for the matching export (via the
ComposablePartCatalogs it creates).</p>

<h1 style='margin-left:-.25pt'><a name="_Toc281495">Chapter 21:
SpeechRecognitionEngine class to recognize speech</a></h1>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=711
 style='width:533.2pt;margin-left:1.0pt;border-collapse:collapse'>
 <tr style='height:12.4pt'>
  <td width=241 valign=top style='width:180.5pt;padding:.05pt 0in 0in 0in;
  height:12.4pt'>
  <p class=MsoNormal align=center style='margin-top:0in;margin-right:2.0pt;
  margin-bottom:0in;margin-left:0in;text-align:center;text-indent:0in;
  line-height:107%'><b><span style='font-size:9.0pt;line-height:107%;
  background:#FAFAFA'>LoadGrammar</span>: Parameters</b></p>
  </td>
  <td width=470 valign=top style='width:352.7pt;padding:.05pt 0in 0in 0in;
  height:12.4pt'>
  <p class=MsoNormal align=center style='margin-top:0in;margin-right:0in;
  margin-bottom:0in;margin-left:3.4pt;text-align:center;text-indent:0in;
  line-height:107%'><b>Details</b></p>
  </td>
 </tr>
 <tr style='height:27.55pt'>
  <td width=241 style='width:180.5pt;padding:.05pt 0in 0in 0in;height:27.55pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>grammar</p>
  </td>
  <td width=470 valign=top style='width:352.7pt;padding:.05pt 0in 0in 0in;
  height:27.55pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>The
  grammar to load. For example, a <span style='font-size:9.0pt;line-height:
  107%;background:#FAFAFA'>DictationGrammar</span> object to allow free text
  dictation.</p>
  </td>
 </tr>
 <tr style='height:16.85pt'>
  <td width=241 valign=top style='width:180.5pt;padding:.05pt 0in 0in 0in;
  height:16.85pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><b><span
  style='font-size:9.0pt;line-height:107%;background:#FAFAFA'>RecognizeAsync</span>:
  Parameters</b></p>
  </td>
  <td width=470 valign=top style='width:352.7pt;padding:.05pt 0in 0in 0in;
  height:16.85pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><b>Details</b></p>
  </td>
 </tr>
 <tr style='height:19.85pt'>
  <td width=241 valign=bottom style='width:180.5pt;padding:.05pt 0in 0in 0in;
  height:19.85pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>mode</p>
  </td>
  <td width=470 valign=top style='width:352.7pt;padding:.05pt 0in 0in 0in;
  height:19.85pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>The <span
  style='font-size:9.0pt;line-height:107%;background:#FAFAFA'>RecognizeMode</span>
  for the current recognition: <span style='font-size:9.0pt;line-height:107%;
  background:#FAFAFA'>Single</span> for just one</p>
  </td>
 </tr>
</table>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=151 style='width:113.4pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=151 valign=top style='width:113.4pt;background:#FAFAFA;padding:
  1.8pt 0in 0in 0in;height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><b><span style='font-size:9.0pt;line-height:
  107%'>GrammarBuilder</span></b><b><span style='font-size:9.0pt;line-height:
  107%;color:#666666'>.</span></b><b><span style='font-size:9.0pt;line-height:
  107%'>Append</span></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:170.35pt;margin-bottom:
0in;margin-left:114.4pt;text-indent:67.1pt'>recognition, <span
style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>Multiple</span> to
allow multiple. <b>: Parameters Details</b></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=703
 style='width:527.2pt;margin-left:1.0pt;border-collapse:collapse'>
 <tr style='height:37.65pt'>
  <td width=241 style='width:180.5pt;padding:0in 0in 0in 0in;height:37.65pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>choices</p>
  </td>
  <td width=462 valign=top style='width:346.7pt;padding:0in 0in 0in 0in;
  height:37.65pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Appends
  some choices to the grammar builder. This means that, when the user inputs
  speech, the recognizer can follow different &quot;branches&quot; from a
  grammar.</p>
  </td>
 </tr>
 <tr style='height:13.75pt'>
  <td width=241 valign=top style='width:180.5pt;padding:0in 0in 0in 0in;
  height:13.75pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><b><span
  style='font-size:9.0pt;line-height:107%;background:#FAFAFA'>Choices</span>
  constructor: Parameters</b></p>
  </td>
  <td width=462 valign=top style='width:346.7pt;padding:0in 0in 0in 0in;
  height:13.75pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><b>Details</b></p>
  </td>
 </tr>
</table>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=151 style='width:113.4pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=151 valign=top style='width:113.4pt;background:#FAFAFA;padding:
  1.8pt 0in 0in 0in;height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>GrammarBuilder</span><span style='font-size:9.0pt;line-height:107%;
  color:#666666'>.</span><span style='font-size:9.0pt;line-height:107%'>Append</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin:0in;text-indent:0in'>choices An
array of choices for the grammar builder. See .</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=548
 style='width:411.1pt;margin-left:1.0pt;border-collapse:collapse'>
 <tr style='height:13.75pt'>
  <td width=241 valign=top style='width:180.5pt;padding:.05pt 0in 0in 0in;
  height:13.75pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><b><span
  style='font-size:9.0pt;line-height:107%;background:#FAFAFA'>Grammar</span>
  constructor: Parameter</b></p>
  </td>
  <td width=308 valign=top style='width:230.65pt;padding:.05pt 0in 0in 0in;
  height:13.75pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><b>Details</b></p>
  </td>
 </tr>
 <tr style='height:13.75pt'>
  <td width=241 valign=top style='width:180.5pt;padding:.05pt 0in 0in 0in;
  height:13.75pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>builder</p>
  </td>
  <td width=308 valign=top style='width:230.65pt;padding:.05pt 0in 0in 0in;
  height:13.75pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'>The <span style='font-size:9.0pt;
  line-height:107%;background:#FAFAFA'>GrammarBuilder</span> to construct a <span
  style='font-size:9.0pt;line-height:107%;background:#FAFAFA'>Grammar</span>
  from.</p>
  </td>
 </tr>
</table>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:4.9pt;margin-left:
-.25pt'><a name="_Toc281496">Section 21.1: Asynchronously recognizing speech
based on a restricted set of phrases</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:48.85pt;margin-bottom:
.2pt;margin-left:3.5pt;line-height:110%'><span style='position:relative;
z-index:-1895780352'><span style='left:0px;position:absolute;left:0px;
top:-42573px;width:718px;height:1px'><img width=718 height=1
src=".NET%20Framework%20Notes%20for%20Professionals_files/image268.gif"></span></span><span
style='font-size:9.0pt;line-height:110%'>SpeechRecognitionEngine
recognitionEngine </span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>=</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>new</span><span
style='font-size:9.0pt;line-height:110%'> SpeechRecognitionEngine</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(); </span><span
style='font-size:9.0pt;line-height:110%'>GrammarBuilder builder </span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>=</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#0600FF'>new</span><span style='font-size:9.0pt;
line-height:110%'> GrammarBuilder</span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>(); </span><span style='font-size:9.0pt;
line-height:110%'>builder</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%'>Append</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>new</span><span
style='font-size:9.0pt;line-height:110%'> Choices</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>(</span><span style='font-size:9.0pt;
line-height:110%;color:#A60000'>&quot;I am&quot;</span><span style='font-size:
9.0pt;line-height:110%'>, </span><span style='font-size:9.0pt;line-height:110%;
color:#A60000'>&quot;You are&quot;</span><span style='font-size:9.0pt;
line-height:110%'>, </span><span style='font-size:9.0pt;line-height:110%;
color:#A60000'>&quot;He is&quot;</span><span style='font-size:9.0pt;line-height:
110%'>, </span><span style='font-size:9.0pt;line-height:110%;color:#A60000'>&quot;She
is&quot;</span><span style='font-size:9.0pt;line-height:110%'>, </span><span
style='font-size:9.0pt;line-height:110%;color:#A60000'>&quot;We are&quot;</span><span
style='font-size:9.0pt;line-height:110%'>, </span><span style='font-size:9.0pt;
line-height:110%;color:#A60000'>&quot;They are&quot;</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>)); </span><span
style='font-size:9.0pt;line-height:110%'>builder</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>.</span><span style='font-size:9.0pt;
line-height:110%'>Append</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>(</span><span style='font-size:9.0pt;line-height:110%;
color:#0600FF'>new</span><span style='font-size:9.0pt;line-height:110%'>
Choices</span><span style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%;color:#A60000'>&quot;friendly&quot;</span><span
style='font-size:9.0pt;line-height:110%'>, </span><span style='font-size:9.0pt;
line-height:110%;color:#A60000'>&quot;unfriendly&quot;</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>)); </span><span
style='font-size:9.0pt;line-height:110%'>recognitionEngine</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>LoadGrammar</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>new</span><span
style='font-size:9.0pt;line-height:110%'> Grammar</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>(</span><span style='font-size:9.0pt;
line-height:110%'>builder</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>)); </span><span style='font-size:9.0pt;line-height:110%'>recognitionEngine</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>SpeechRecognized </span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>+=</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#0600FF'>delegate</span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>(</span><span style='font-size:9.0pt;
line-height:110%;color:#0600FF'>object</span><span style='font-size:9.0pt;
line-height:110%'> sender, SpeechRecognizedEventArgs e</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>) {</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:227.05pt;margin-bottom:
22.95pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%'> Console</span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%'>WriteLine</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%;color:#A60000'>&quot;You said:
{0}&quot;</span><span style='font-size:9.0pt;line-height:110%'>, e</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>Result</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>.</span><span style='font-size:9.0pt;
line-height:110%'>Text</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>); }; </span><span style='font-size:9.0pt;line-height:110%'>recognitionEngine</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>SetInputToDefaultAudioDevice</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(); </span><span
style='font-size:9.0pt;line-height:110%'>recognitionEngine</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>RecognizeAsync</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%'>RecognizeMode</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>Multiple</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>);</span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc281497">Section 21.2:
Asynchronously recognizing speech for free text dictation</a></h2>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=720 height=207
src=".NET%20Framework%20Notes%20for%20Professionals_files/image282.gif"></span></p>

<h1 style='margin-left:-.25pt'><a name="_Toc281498">Chapter 22:
System.Runtime.Caching.MemoryCache (ObjectCache)</a></h1>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:2.5pt;margin-left:
-.25pt'><a name="_Toc281499">Section 22.1: Adding Item to Cache (Set)</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>Set function inserts a cache entry into the cache by using
a CacheItem instance to supply the key and value for the cache entry.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=308
 style='width:231.3pt;margin-left:111.05pt;border-collapse:collapse'>
 <tr style='height:.15in'>
  <td width=308 valign=top style='width:231.3pt;background:#FAFAFA;padding:
  1.8pt 0in 0in 0in;height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>ObjectCache</span><span style='font-size:9.0pt;line-height:107%;
  color:#666666'>.</span><span style='font-size:9.0pt;line-height:107%;
  color:#0600FF'>Set</span><span style='font-size:9.0pt;line-height:107%;
  color:#666666'>(</span><span style='font-size:9.0pt;line-height:107%'>CacheItem,</span><span
  style='font-size:9.0pt;line-height:107%;font-family:"Arial",sans-serif'>&#8194;</span><span
  style='font-size:9.0pt;line-height:107%'>CacheItemPolicy</span><span
  style='font-size:9.0pt;line-height:107%;color:#666666'>)</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:196.25pt;margin-bottom:
0in;margin-left:1.05pt'>This function Overrides </p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=720 height=256
src=".NET%20Framework%20Notes%20for%20Professionals_files/image283.gif"></span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:3.25pt;margin-left:
-.25pt'><a name="_Toc281500">Section 22.2: System.Runtime.Caching.MemoryCache
(ObjectCache)</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>This function gets existing item form cache, and if the
item don't exist in cache, it will fetch item based on the valueFetchFactory
function.</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=720 height=391
src=".NET%20Framework%20Notes%20for%20Professionals_files/image284.gif"></span></p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=54
src=".NET%20Framework%20Notes%20for%20Professionals_files/image285.gif"></span><br
clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc281501">Chapter 23:
System.Reflection.Emit namespace</a></h1>

<h2 style='margin-left:-.25pt'><a name="_Toc281502">Section 23.1: Creating an
assembly dynamically</a></h2>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=903
src=".NET%20Framework%20Notes%20for%20Professionals_files/image286.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:566.95pt;margin-bottom:
0in;margin-left:-28.35pt;text-indent:0in;line-height:107%'>&nbsp;</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=718
 style='width:538.6pt;border-collapse:collapse'>
 <tr style='height:771.0pt'>
  <td width=718 valign=top style='width:538.6pt;background:#FAFAFA;padding:
  2.55pt 5.65pt 0in 3.75pt;height:771.0pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><i><span style='font-size:9.0pt;
  line-height:107%;color:darkgreen'>// Add a private field of type int (Int32).</span></i></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> FieldBuilder fbNumber </span><span
  style='font-size:9.0pt;line-height:107%;color:#666666'>=</span><span
  style='font-size:9.0pt;line-height:107%'> tb</span><span style='font-size:
  9.0pt;line-height:107%;color:#666666'>.</span><span style='font-size:9.0pt;
  line-height:107%'>DefineField</span><span style='font-size:9.0pt;line-height:
  107%;color:#666666'>(</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:340.2pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:112%'><span style='font-size:
  9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:#A60000'>&quot;m_number&quot;</span><span
  style='font-size:9.0pt;line-height:112%'>, </span><span
  style='font-size:9.0pt;line-height:112%;color:#0600FF'>typeof</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>(</span><span
  style='font-size:9.0pt;line-height:112%;color:#0600FF'>int</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>)</span><span
  style='font-size:9.0pt;line-height:112%'>,</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> FieldAttributes</span><span
  style='font-size:9.0pt;line-height:107%;color:#666666'>.</span><span
  style='font-size:9.0pt;line-height:107%;color:#0600FF'>Private</span><span
  style='font-size:9.0pt;line-height:107%;color:#666666'>);</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><i><span style='font-size:9.0pt;
  line-height:107%;color:darkgreen'>// Next, we make a simple sealed method.</span></i></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> MethodBuilder mbMyMethod </span><span
  style='font-size:9.0pt;line-height:107%;color:#666666'>=</span><span
  style='font-size:9.0pt;line-height:107%'> tb</span><span style='font-size:
  9.0pt;line-height:107%;color:#666666'>.</span><span style='font-size:9.0pt;
  line-height:107%'>DefineMethod</span><span style='font-size:9.0pt;line-height:
  107%;color:#666666'>(</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:275.4pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:112%'><span style='font-size:
  9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:#A60000'>&quot;MyMethod&quot;</span><span
  style='font-size:9.0pt;line-height:112%'>, MethodAttributes</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>.</span><span
  style='font-size:9.0pt;line-height:112%;color:#0600FF'>Public</span><span
  style='font-size:9.0pt;line-height:112%'>, </span><span
  style='font-size:9.0pt;line-height:112%;color:#0600FF'>typeof</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>(</span><span
  style='font-size:9.0pt;line-height:112%;color:#0600FF'>int</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>)</span><span
  style='font-size:9.0pt;line-height:112%'>,</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:#0600FF'>new</span><span style='font-size:9.0pt;
  line-height:107%;color:#666666'>[]</span><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:#666666'>{</span><span style='font-size:9.0pt;line-height:107%'> </span><span
  style='font-size:9.0pt;line-height:107%;color:#0600FF'>typeof</span><span
  style='font-size:9.0pt;line-height:107%;color:#666666'>(</span><span
  style='font-size:9.0pt;line-height:107%;color:#0600FF'>int</span><span
  style='font-size:9.0pt;line-height:107%;color:#666666'>)</span><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:#666666'>});</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:12.75pt;margin-bottom:
  12.3pt;margin-left:0in;text-indent:0in;line-height:112%'><span
  style='font-size:9.0pt;line-height:112%'> ILGenerator il </span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>=</span><span
  style='font-size:9.0pt;line-height:112%'> mbMyMethod</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>.</span><span
  style='font-size:9.0pt;line-height:112%'>GetILGenerator</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>(); </span><span
  style='font-size:9.0pt;line-height:112%'>il</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>.</span><span
  style='font-size:9.0pt;line-height:112%'>Emit</span><span style='font-size:
  9.0pt;line-height:112%;color:#666666'>(</span><span style='font-size:9.0pt;
  line-height:112%'>OpCodes</span><span style='font-size:9.0pt;line-height:
  112%;color:#666666'>.</span><span style='font-size:9.0pt;line-height:112%'>Ldarg_0</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>);</span><span
  style='font-size:9.0pt;line-height:112%'> </span><i><span style='font-size:
  9.0pt;line-height:112%;color:darkgreen'>// Load this - always the first
  argument of any instance method </span></i><span style='font-size:9.0pt;
  line-height:112%'>il</span><span style='font-size:9.0pt;line-height:
  112%;color:#666666'>.</span><span style='font-size:9.0pt;line-height:112%'>Emit</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>(</span><span
  style='font-size:9.0pt;line-height:112%'>OpCodes</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>.</span><span
  style='font-size:9.0pt;line-height:112%'>Ldfld, fbNumber</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>); </span><span
  style='font-size:9.0pt;line-height:112%'>il</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>.</span><span
  style='font-size:9.0pt;line-height:112%'>Emit</span><span style='font-size:
  9.0pt;line-height:112%;color:#666666'>(</span><span style='font-size:9.0pt;
  line-height:112%'>OpCodes</span><span style='font-size:9.0pt;line-height:
  112%;color:#666666'>.</span><span style='font-size:9.0pt;line-height:112%'>Ldarg_1</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>);</span><span
  style='font-size:9.0pt;line-height:112%'> </span><i><span style='font-size:
  9.0pt;line-height:112%;color:darkgreen'>// Load the integer argument </span></i><span
  style='font-size:9.0pt;line-height:112%'>il</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>.</span><span
  style='font-size:9.0pt;line-height:112%'>Emit</span><span style='font-size:
  9.0pt;line-height:112%;color:#666666'>(</span><span style='font-size:9.0pt;
  line-height:112%'>OpCodes</span><span style='font-size:9.0pt;line-height:
  112%;color:#666666'>.</span><span style='font-size:9.0pt;line-height:112%'>Mul</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>);</span><span
  style='font-size:9.0pt;line-height:112%'> </span><i><span style='font-size:
  9.0pt;line-height:112%;color:darkgreen'>// Multiply the two numbers with no
  overflow checking </span></i><span style='font-size:9.0pt;line-height:112%'>il</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>.</span><span
  style='font-size:9.0pt;line-height:112%'>Emit</span><span style='font-size:
  9.0pt;line-height:112%;color:#666666'>(</span><span style='font-size:9.0pt;
  line-height:112%'>OpCodes</span><span style='font-size:9.0pt;line-height:
  112%;color:#666666'>.</span><span style='font-size:9.0pt;line-height:112%'>Ret</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>);</span><span
  style='font-size:9.0pt;line-height:112%'> </span><i><span style='font-size:
  9.0pt;line-height:112%;color:darkgreen'>// Return</span></i></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:112%'><span
  style='font-size:9.0pt;line-height:112%'> </span><i><span
  style='font-size:9.0pt;line-height:112%;color:darkgreen'>// Next, we build
  the property. This involves building the property itself, as well as the </span></i><span
  style='font-size:9.0pt;line-height:112%'></span><i><span
  style='font-size:9.0pt;line-height:112%;color:darkgreen'>// getter and setter
  methods.</span></i></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> PropertyBuilder pbNumber </span><span
  style='font-size:9.0pt;line-height:107%;color:#666666'>=</span><span
  style='font-size:9.0pt;line-height:107%'> tb</span><span style='font-size:
  9.0pt;line-height:107%;color:#666666'>.</span><span style='font-size:9.0pt;
  line-height:107%'>DefineProperty</span><span style='font-size:9.0pt;
  line-height:107%;color:#666666'>(</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:246.15pt;margin-bottom:
  12.3pt;margin-left:0in;text-indent:0in;line-height:112%'><span
  style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:#A60000'>&quot;Number&quot;</span><span
  style='font-size:9.0pt;line-height:112%'>, </span><i><span style='font-size:
  9.0pt;line-height:112%;color:darkgreen'>// Name </span></i><span
  style='font-size:9.0pt;line-height:112%'>PropertyAttributes</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>.</span><span
  style='font-size:9.0pt;line-height:112%'>None, </span><span
  style='font-size:9.0pt;line-height:112%;color:#0600FF'>typeof</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>(</span><span
  style='font-size:9.0pt;line-height:112%;color:#0600FF'>int</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>)</span><span
  style='font-size:9.0pt;line-height:112%'>, </span><i><span style='font-size:
  9.0pt;line-height:112%;color:darkgreen'>// Type of the property </span></i><span
  style='font-size:9.0pt;line-height:112%'></span><span
  style='font-size:9.0pt;line-height:112%;color:#0600FF'>new</span><span
  style='font-size:9.0pt;line-height:112%'> Type</span><span style='font-size:
  9.0pt;line-height:112%;color:#666666'>[</span><span style='font-size:9.0pt;
  line-height:112%;color:red'>0</span><span style='font-size:9.0pt;line-height:
  112%;color:#666666'>]);</span><span style='font-size:9.0pt;line-height:112%'>
  </span><i><span style='font-size:9.0pt;line-height:112%;color:darkgreen'>//
  Types of indices, if any</span></i></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> MethodBuilder mbSetNumber </span><span
  style='font-size:9.0pt;line-height:107%;color:#666666'>=</span><span
  style='font-size:9.0pt;line-height:107%'> tb</span><span style='font-size:
  9.0pt;line-height:107%;color:#666666'>.</span><span style='font-size:9.0pt;
  line-height:107%'>DefineMethod</span><span style='font-size:9.0pt;line-height:
  107%;color:#666666'>(</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:#A60000'>&quot;set_Number&quot;</span><span
  style='font-size:9.0pt;line-height:107%'>, </span><i><span style='font-size:
  9.0pt;line-height:107%;color:darkgreen'>// Name - setters are set_Property by
  convention</span></i></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><i><span style='font-size:9.0pt;
  line-height:107%;color:darkgreen'>// Setter is a special method and we don't
  want it to appear to callers from C#</span></i></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.3pt;
  margin-left:0in;text-indent:0in;line-height:112%'><span style='font-size:
  9.0pt;line-height:112%'> MethodAttributes</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>.</span><span
  style='font-size:9.0pt;line-height:112%'>PrivateScope </span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>|</span><span
  style='font-size:9.0pt;line-height:112%'> MethodAttributes</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>.</span><span
  style='font-size:9.0pt;line-height:112%'>HideBySig </span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>|</span><span
  style='font-size:9.0pt;line-height:112%'> MethodAttributes</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>.</span><span
  style='font-size:9.0pt;line-height:112%;color:#0600FF'>Public</span><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:#666666'>| </span><span style='font-size:9.0pt;
  line-height:112%'>MethodAttributes</span><span style='font-size:9.0pt;
  line-height:112%;color:#666666'>.</span><span style='font-size:9.0pt;
  line-height:112%'>SpecialName, </span><span style='font-size:
  9.0pt;line-height:112%;color:#0600FF'>typeof</span><span style='font-size:
  9.0pt;line-height:112%;color:#666666'>(</span><span style='font-size:9.0pt;
  line-height:112%;color:#0600FF'>void</span><span style='font-size:9.0pt;
  line-height:112%;color:#666666'>)</span><span style='font-size:9.0pt;
  line-height:112%'>, </span><i><span style='font-size:9.0pt;line-height:112%;
  color:darkgreen'>// Setters don't return a value </span></i><span
  style='font-size:9.0pt;line-height:112%'></span><span
  style='font-size:9.0pt;line-height:112%;color:#0600FF'>new</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>[]</span><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:#666666'>{</span><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:#0600FF'>typeof</span><span style='font-size:9.0pt;line-height:112%;
  color:#666666'>(</span><span style='font-size:9.0pt;line-height:112%;
  color:#0600FF'>int</span><span style='font-size:9.0pt;line-height:112%;
  color:#666666'>)</span><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>});</span><span
  style='font-size:9.0pt;line-height:112%'> </span><i><span style='font-size:
  9.0pt;line-height:112%;color:darkgreen'>// We have a single argument of type
  System.Int32</span></i></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:101.65pt;margin-bottom:
  12.3pt;margin-left:0in;text-indent:0in;line-height:112%'><span
  style='font-size:9.0pt;line-height:112%'> </span><i><span
  style='font-size:9.0pt;line-height:112%;color:darkgreen'>// To generate the
  body of the method, we'll need an IL generator </span></i><span
  style='font-size:9.0pt;line-height:112%'>il </span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>=</span><span
  style='font-size:9.0pt;line-height:112%'> mbSetNumber</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>.</span><span
  style='font-size:9.0pt;line-height:112%'>GetILGenerator</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>(); </span><span
  style='font-size:9.0pt;line-height:112%'>il</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>.</span><span
  style='font-size:9.0pt;line-height:112%'>Emit</span><span style='font-size:
  9.0pt;line-height:112%;color:#666666'>(</span><span style='font-size:9.0pt;
  line-height:112%'>OpCodes</span><span style='font-size:9.0pt;line-height:
  112%;color:#666666'>.</span><span style='font-size:9.0pt;line-height:112%'>Ldarg_0</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>);</span><span
  style='font-size:9.0pt;line-height:112%'> </span><i><span style='font-size:
  9.0pt;line-height:112%;color:darkgreen'>// Load this </span></i><span
  style='font-size:9.0pt;line-height:112%'>il</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>.</span><span
  style='font-size:9.0pt;line-height:112%'>Emit</span><span style='font-size:
  9.0pt;line-height:112%;color:#666666'>(</span><span style='font-size:9.0pt;
  line-height:112%'>OpCodes</span><span style='font-size:9.0pt;line-height:
  112%;color:#666666'>.</span><span style='font-size:9.0pt;line-height:112%'>Ldarg_1</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>);</span><span
  style='font-size:9.0pt;line-height:112%'> </span><i><span style='font-size:
  9.0pt;line-height:112%;color:darkgreen'>// Load the new value </span></i><span
  style='font-size:9.0pt;line-height:112%'>il</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>.</span><span
  style='font-size:9.0pt;line-height:112%'>Emit</span><span style='font-size:
  9.0pt;line-height:112%;color:#666666'>(</span><span style='font-size:9.0pt;
  line-height:112%'>OpCodes</span><span style='font-size:9.0pt;line-height:
  112%;color:#666666'>.</span><span style='font-size:9.0pt;line-height:112%'>Stfld,
  fbNumber</span><span style='font-size:9.0pt;line-height:112%;color:#666666'>);</span><span
  style='font-size:9.0pt;line-height:112%'> </span><i><span style='font-size:
  9.0pt;line-height:112%;color:darkgreen'>// Save the new value to
  this.m_number </span></i><span style='font-size:9.0pt;line-height:112%'>il</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>.</span><span
  style='font-size:9.0pt;line-height:112%'>Emit</span><span style='font-size:
  9.0pt;line-height:112%;color:#666666'>(</span><span style='font-size:9.0pt;
  line-height:112%'>OpCodes</span><span style='font-size:9.0pt;line-height:
  112%;color:#666666'>.</span><span style='font-size:9.0pt;line-height:112%'>Ret</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>);</span><span
  style='font-size:9.0pt;line-height:112%'> </span><i><span style='font-size:
  9.0pt;line-height:112%;color:darkgreen'>// Return</span></i></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.3pt;
  margin-left:0in;text-indent:0in;line-height:112%'><span style='font-size:
  9.0pt;line-height:112%'> </span><i><span style='font-size:9.0pt;
  line-height:112%;color:darkgreen'>// Finally, link the method to the setter
  of our property </span></i><span style='font-size:9.0pt;line-height:112%'>pbNumber</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>.</span><span
  style='font-size:9.0pt;line-height:112%'>SetSetMethod</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>(</span><span
  style='font-size:9.0pt;line-height:112%'>mbSetNumber</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>);</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> MethodBuilder mbGetNumber </span><span
  style='font-size:9.0pt;line-height:107%;color:#666666'>=</span><span
  style='font-size:9.0pt;line-height:107%'> tb</span><span style='font-size:
  9.0pt;line-height:107%;color:#666666'>.</span><span style='font-size:9.0pt;
  line-height:107%'>DefineMethod</span><span style='font-size:9.0pt;line-height:
  107%;color:#666666'>(</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:#A60000'>&quot;get_Number&quot;</span><span
  style='font-size:9.0pt;line-height:107%'>,</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.3pt;
  margin-left:0in;text-indent:0in;line-height:112%'><span style='font-size:
  9.0pt;line-height:112%'> MethodAttributes</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>.</span><span
  style='font-size:9.0pt;line-height:112%'>PrivateScope </span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>|</span><span
  style='font-size:9.0pt;line-height:112%'> MethodAttributes</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>.</span><span
  style='font-size:9.0pt;line-height:112%'>HideBySig </span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>|</span><span
  style='font-size:9.0pt;line-height:112%'> MethodAttributes</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>.</span><span
  style='font-size:9.0pt;line-height:112%;color:#0600FF'>Public</span><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:#666666'>| </span><span style='font-size:9.0pt;
  line-height:112%'>MethodAttributes</span><span style='font-size:9.0pt;
  line-height:112%;color:#666666'>.</span><span style='font-size:9.0pt;
  line-height:112%'>SpecialName, </span><span style='font-size:
  9.0pt;line-height:112%;color:#0600FF'>typeof</span><span style='font-size:
  9.0pt;line-height:112%;color:#666666'>(</span><span style='font-size:9.0pt;
  line-height:112%;color:#0600FF'>int</span><span style='font-size:9.0pt;
  line-height:112%;color:#666666'>)</span><span style='font-size:9.0pt;
  line-height:112%'>, </span><span style='font-size:9.0pt;
  line-height:112%;color:#0600FF'>new</span><span style='font-size:9.0pt;
  line-height:112%'> Type</span><span style='font-size:9.0pt;line-height:112%;
  color:#666666'>[</span><span style='font-size:9.0pt;line-height:112%;
  color:red'>0</span><span style='font-size:9.0pt;line-height:112%;color:#666666'>]);</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:122.75pt;margin-bottom:
  12.3pt;margin-left:0in;text-indent:0in;line-height:112%'><span
  style='font-size:9.0pt;line-height:112%'> il </span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>=</span><span
  style='font-size:9.0pt;line-height:112%'> mbGetNumber</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>.</span><span
  style='font-size:9.0pt;line-height:112%'>GetILGenerator</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>(); </span><span
  style='font-size:9.0pt;line-height:112%'>il</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>.</span><span
  style='font-size:9.0pt;line-height:112%'>Emit</span><span style='font-size:
  9.0pt;line-height:112%;color:#666666'>(</span><span style='font-size:9.0pt;
  line-height:112%'>OpCodes</span><span style='font-size:9.0pt;line-height:
  112%;color:#666666'>.</span><span style='font-size:9.0pt;line-height:112%'>Ldarg_0</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>);</span><span
  style='font-size:9.0pt;line-height:112%'> </span><i><span style='font-size:
  9.0pt;line-height:112%;color:darkgreen'>// Load this </span></i><span
  style='font-size:9.0pt;line-height:112%'>il</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>.</span><span
  style='font-size:9.0pt;line-height:112%'>Emit</span><span style='font-size:
  9.0pt;line-height:112%;color:#666666'>(</span><span style='font-size:9.0pt;
  line-height:112%'>OpCodes</span><span style='font-size:9.0pt;line-height:
  112%;color:#666666'>.</span><span style='font-size:9.0pt;line-height:112%'>Ldfld,
  fbNumber</span><span style='font-size:9.0pt;line-height:112%;color:#666666'>);</span><span
  style='font-size:9.0pt;line-height:112%'> </span><i><span style='font-size:
  9.0pt;line-height:112%;color:darkgreen'>// Load the value of this.m_number </span></i><span
  style='font-size:9.0pt;line-height:112%'>il</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>.</span><span
  style='font-size:9.0pt;line-height:112%'>Emit</span><span style='font-size:
  9.0pt;line-height:112%;color:#666666'>(</span><span style='font-size:9.0pt;
  line-height:112%'>OpCodes</span><span style='font-size:9.0pt;line-height:
  112%;color:#666666'>.</span><span style='font-size:9.0pt;line-height:112%'>Ret</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>);</span><span
  style='font-size:9.0pt;line-height:112%'> </span><i><span style='font-size:
  9.0pt;line-height:112%;color:darkgreen'>// Return the value</span></i></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:297.0pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:112%'><span style='font-size:
  9.0pt;line-height:112%'> pbNumber</span><span style='font-size:9.0pt;
  line-height:112%;color:#666666'>.</span><span style='font-size:9.0pt;
  line-height:112%'>SetGetMethod</span><span style='font-size:9.0pt;line-height:
  112%;color:#666666'>(</span><span style='font-size:9.0pt;line-height:112%'>mbGetNumber</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>); </span><span
  style='font-size:9.0pt;line-height:112%'></span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><i><span style='font-size:9.0pt;
  line-height:107%;color:darkgreen'>// Finally, we add the two constructors.</span></i></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:9.0pt;line-height:107%'> </span><i><span
  style='font-size:9.0pt;line-height:107%;color:darkgreen'>// Constructor needs
  to call the constructor of the parent class, or another constructor in</span></i></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.25pt;
margin-left:3.5pt;line-height:110%'><i><span style='font-size:9.0pt;line-height:
110%;color:darkgreen'>the same class</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%'> ConstructorBuilder intConstructor </span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>=</span><span style='font-size:9.0pt;
line-height:110%'> tb</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%'>DefineConstructor</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:27.25pt;margin-bottom:
12.45pt;margin-left:3.5pt;line-height:110%'><span style='position:relative;
z-index:-1895779328'><span style='left:0px;position:absolute;left:0px;
top:-46093px;width:718px;height:1px'><img width=718 height=1
src=".NET%20Framework%20Notes%20for%20Professionals_files/image287.gif"></span></span><span
style='font-size:9.0pt;line-height:110%'> MethodAttributes</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>Public</span><span
style='font-size:9.0pt;line-height:110%'>, CallingConventions</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>Standard </span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>|</span><span
style='font-size:9.0pt;line-height:110%'> CallingConventions</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>HasThis, </span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>new</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>[]</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>{</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:#0600FF'>typeof</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>(</span><span style='font-size:9.0pt;line-height:110%;
color:#0600FF'>int</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>)</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>}); </span><span
style='font-size:9.0pt;line-height:110%'>il </span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>=</span><span
style='font-size:9.0pt;line-height:110%'> intConstructor</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>GetILGenerator</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(); </span><span
style='font-size:9.0pt;line-height:110%'>il</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>Emit</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>(</span><span style='font-size:9.0pt;
line-height:110%'>OpCodes</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%'>Ldarg_0</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>);</span><span
style='font-size:9.0pt;line-height:110%'> </span><i><span style='font-size:
9.0pt;line-height:110%;color:darkgreen'>// this </span></i><span
style='font-size:9.0pt;line-height:110%'>il</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>Emit</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>(</span><span style='font-size:9.0pt;
line-height:110%'>OpCodes</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%'>Call, </span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>typeof</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>object</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>).</span><span
style='font-size:9.0pt;line-height:110%'>GetConstructor</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>new</span><span
style='font-size:9.0pt;line-height:110%'> Type</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>[</span><span style='font-size:9.0pt;
line-height:110%;color:red'>0</span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>]));</span><span style='font-size:9.0pt;line-height:110%'> </span><i><span
style='font-size:9.0pt;line-height:110%;color:darkgreen'>// call parent's
constructor </span></i><span style='font-size:9.0pt;line-height:110%'>il</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>Emit</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>(</span><span style='font-size:9.0pt;
line-height:110%'>OpCodes</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%'>Ldarg_0</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>);</span><span
style='font-size:9.0pt;line-height:110%'> </span><i><span style='font-size:
9.0pt;line-height:110%;color:darkgreen'>// this </span></i><span
style='font-size:9.0pt;line-height:110%'>il</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>Emit</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>(</span><span style='font-size:9.0pt;
line-height:110%'>OpCodes</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%'>Ldarg_1</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>);</span><span
style='font-size:9.0pt;line-height:110%'> </span><i><span style='font-size:
9.0pt;line-height:110%;color:darkgreen'>// our int argument </span></i><span
style='font-size:9.0pt;line-height:110%'>il</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>Emit</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>(</span><span style='font-size:9.0pt;
line-height:110%'>OpCodes</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%'>Stfld,
fbNumber</span><span style='font-size:9.0pt;line-height:110%;color:#666666'>);</span><span
style='font-size:9.0pt;line-height:110%'> </span><i><span style='font-size:
9.0pt;line-height:110%;color:darkgreen'>// store argument in this.m_number </span></i><span
style='font-size:9.0pt;line-height:110%'>il</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>Emit</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>(</span><span style='font-size:9.0pt;
line-height:110%'>OpCodes</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%'>Ret</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>);</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:#0600FF'>var</span><span
style='font-size:9.0pt;line-height:110%'> parameterlessConstructor </span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>=</span><span
style='font-size:9.0pt;line-height:110%'> tb</span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>.</span><span style='font-size:9.0pt;
line-height:110%'>DefineConstructor</span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>(</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:5.65pt;margin-bottom:
12.45pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%'> MethodAttributes</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>.</span><span style='font-size:9.0pt;
line-height:110%;color:#0600FF'>Public</span><span style='font-size:9.0pt;
line-height:110%'>, CallingConventions</span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>.</span><span style='font-size:9.0pt;
line-height:110%'>Standard </span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>|</span><span style='font-size:9.0pt;line-height:110%'>
CallingConventions</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%'>HasThis, </span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>new </span><span
style='font-size:9.0pt;line-height:110%'>Type</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>[</span><span style='font-size:9.0pt;
line-height:110%;color:red'>0</span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>]); </span><span style='font-size:9.0pt;line-height:110%'>il
</span><span style='font-size:9.0pt;line-height:110%;color:#666666'>=</span><span
style='font-size:9.0pt;line-height:110%'> parameterlessConstructor</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>GetILGenerator</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(); </span><span
style='font-size:9.0pt;line-height:110%'>il</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>Emit</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>(</span><span style='font-size:9.0pt;
line-height:110%'>OpCodes</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%'>Ldarg_0</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>);</span><span
style='font-size:9.0pt;line-height:110%'> </span><i><span style='font-size:
9.0pt;line-height:110%;color:darkgreen'>// this </span></i><span
style='font-size:9.0pt;line-height:110%'>il</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>Emit</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>(</span><span style='font-size:9.0pt;
line-height:110%'>OpCodes</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%'>Ldc_I4_S,
</span><span style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>byte</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>)</span><span
style='font-size:9.0pt;line-height:110%;color:red'>42</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>);</span><span
style='font-size:9.0pt;line-height:110%'> </span><i><span style='font-size:
9.0pt;line-height:110%;color:darkgreen'>// load 42 as an integer constant </span></i><span
style='font-size:9.0pt;line-height:110%'>il</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>Emit</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>(</span><span style='font-size:9.0pt;
line-height:110%'>OpCodes</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%'>Call,
intConstructor</span><span style='font-size:9.0pt;line-height:110%;color:#666666'>);</span><span
style='font-size:9.0pt;line-height:110%'> </span><i><span style='font-size:
9.0pt;line-height:110%;color:darkgreen'>// call this(42) </span></i><span
style='font-size:9.0pt;line-height:110%'>il</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>Emit</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>(</span><span style='font-size:9.0pt;
line-height:110%'>OpCodes</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%'>Ret</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>);</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.25pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%'> </span><i><span style='font-size:9.0pt;line-height:110%;
color:darkgreen'>// And make sure the type is created</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.55pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%'> Type ourType </span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>=</span><span style='font-size:9.0pt;line-height:110%'> tb</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>CreateType</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>();</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.25pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%'> </span><i><span style='font-size:9.0pt;line-height:110%;
color:darkgreen'>// The types from the assembly can be used directly using
reflection, or we can save the assembly to use as a reference</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:#0600FF'>object</span><span
style='font-size:9.0pt;line-height:110%'> ourInstance </span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>=</span><span
style='font-size:9.0pt;line-height:110%'> Activator</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>CreateInstance</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%'>ourType</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>);</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:76.4pt;margin-bottom:
.2pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%'> Console</span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>.</span><span style='font-size:9.0pt;
line-height:110%'>WriteLine</span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>(</span><span style='font-size:9.0pt;line-height:110%'>ourType</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>GetProperty</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%;color:#A60000'>&quot;Number&quot;</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>).</span><span
style='font-size:9.0pt;line-height:110%'>GetValue</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>(</span><span style='font-size:9.0pt;
line-height:110%'>ourInstance</span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>));</span><span style='font-size:9.0pt;line-height:110%'> </span><i><span
style='font-size:9.0pt;line-height:110%;color:darkgreen'>// 42 </span></i><span
style='font-size:9.0pt;line-height:110%'></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.25pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%'> </span><i><span style='font-size:9.0pt;line-height:110%;
color:darkgreen'>// Save the assembly for use elsewhere. This is very useful
for debugging - you can use e.g. ILSpy to look at the equivalent IL/C# code.</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:21.85pt;margin-bottom:
.25pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%'> ab</span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%'>Save</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%;color:#A60000'>@&quot;DynamicAssemblyExample.dll&quot;</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>);</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:297.25pt;margin-bottom:
.2pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%'> </span><i><span style='font-size:9.0pt;line-height:
110%;color:darkgreen'>// Using newly created type </span></i><span
style='font-size:9.0pt;line-height:110%'></span><span style='font-size:
9.0pt;line-height:110%;color:#0600FF'>var</span><span style='font-size:9.0pt;
line-height:110%'> myDynamicType </span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>=</span><span style='font-size:9.0pt;
line-height:110%'> tb</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%'>CreateType</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>();</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;line-height:224%'><span style='font-size:9.0pt;line-height:
224%'> </span><span style='font-size:9.0pt;line-height:224%;color:#0600FF'>var</span><span
style='font-size:9.0pt;line-height:224%'> myDynamicTypeInstance </span><span
style='font-size:9.0pt;line-height:224%;color:#666666'>=</span><span
style='font-size:9.0pt;line-height:224%'> Activator</span><span
style='font-size:9.0pt;line-height:224%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:224%'>CreateInstance</span><span
style='font-size:9.0pt;line-height:224%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:224%'>myDynamicType</span><span
style='font-size:9.0pt;line-height:224%;color:#666666'>); </span><span
style='font-size:9.0pt;line-height:224%'>Console</span><span
style='font-size:9.0pt;line-height:224%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:224%'>WriteLine</span><span
style='font-size:9.0pt;line-height:224%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:224%'>myDynamicTypeInstance</span><span
style='font-size:9.0pt;line-height:224%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:224%'>GetType</span><span style='font-size:
9.0pt;line-height:224%;color:#666666'>());</span><span style='font-size:9.0pt;
line-height:224%'> </span><i><span style='font-size:9.0pt;line-height:224%;
color:darkgreen'>// MyDynamicType</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:#0600FF'>var</span><span
style='font-size:9.0pt;line-height:110%'> numberField </span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>=</span><span
style='font-size:9.0pt;line-height:110%'> myDynamicType</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>GetField</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>(</span><span style='font-size:9.0pt;
line-height:110%;color:#A60000'>&quot;m_number&quot;</span><span
style='font-size:9.0pt;line-height:110%'>, BindingFlags</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>NonPublic </span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>| </span><span
style='font-size:9.0pt;line-height:110%'>BindingFlags</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>Instance</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>);</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.55pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%'> numberField</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%'>SetValue </span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%'>myDynamicTypeInstance, </span><span
style='font-size:9.0pt;line-height:110%;color:red'>10</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>);</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%'> Console</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%'>WriteLine</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%'>numberField</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>GetValue</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>(</span><span style='font-size:9.0pt;
line-height:110%'>myDynamicTypeInstance</span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>));</span><span style='font-size:9.0pt;
line-height:110%'> </span><i><span style='font-size:9.0pt;line-height:110%;
color:darkgreen'>// 10</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.25pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:#666666'>}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.25pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%;color:#666666'>}</span></p>

<h1 style='margin-left:-.25pt'><a name="_Toc281503">Chapter 24: .NET Core</a></h1>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.55pt;
margin-left:1.05pt'>.NET Core is a general purpose development platform
maintained by Microsoft and the .NET community on GitHub. It is cross-platform,
supporting Windows, macOS and Linux, and can be used in device, cloud, and
embedded/IoT scenarios.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.55pt;
margin-left:1.05pt'>When you think of .NET Core the following should come to
mind (flexible deployment, cross-platform, commandline tools, open source).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:18.65pt;
margin-left:1.05pt'>Another great thing is that even if it's open source
Microsoft is actively supporting it.</p>

<h2 style='margin-left:-.25pt'><a name="_Toc281504">Section 24.1: Basic Console
App</a></h2>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=207
src=".NET%20Framework%20Notes%20for%20Professionals_files/image288.gif"></span><br
clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc281505">Chapter 25: ADO.NET</a></h1>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.55pt;
margin-left:1.05pt'>ADO(ActiveX Data Objects).Net is a tool provided by
Microsoft which provides access to data sources such as SQL Server, Oracle, and
XML through its components. .Net front-end applications can retrieve, create,
and manipulate data, once they are connected to a data source through ADO.Net
with appropriate privileges.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:18.3pt;
margin-left:1.05pt'>ADO.Net provides a connection-less architecture. It is a
secure approach to interact with a database, since, the connection doesn't have
to be maintained during the entire session.</p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:4.2pt;margin-left:
-.25pt'><a name="_Toc281506">Section 25.1: Best Practices - Executing Sql
Statements</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:264.85pt;margin-bottom:
.2pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;color:#0600FF'>public</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:#0600FF'>void</span><span style='font-size:9.0pt;line-height:110%'>
SaveNewEmployee</span><span style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%'>Employee newEmployee</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>) {</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.25pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%'> </span><i><span style='font-size:9.0pt;line-height:110%;color:darkgreen'>//
best practice - wrap all database connections in a using block so they are
always closed &amp; disposed even in the event of an Exception</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.25pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%'> </span><i><span style='font-size:9.0pt;line-height:110%;color:darkgreen'>//
best practice - retrieve the connection string by name from the app.config or
web.config</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.25pt;
margin-left:3.5pt;line-height:110%'><i><span style='font-size:9.0pt;line-height:
110%;color:darkgreen'>(depending on the application type) (note, this requires
an assembly reference to System.configuration)</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:#0600FF'>using</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%'>SqlConnection con </span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>=</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#0600FF'>new</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:0in;
margin-left:3.75pt;text-align:justify;text-justify:inter-ideograph;text-indent:
0in;line-height:112%'><span style='font-size:9.0pt;line-height:112%'>SqlConnection</span><span
style='font-size:9.0pt;line-height:112%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:112%'>System.Configuration</span><span
style='font-size:9.0pt;line-height:112%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:112%'>ConfigurationManager</span><span
style='font-size:9.0pt;line-height:112%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:112%'>ConnectionStrings</span><span
style='font-size:9.0pt;line-height:112%;color:#666666'>[</span><span
style='font-size:9.0pt;line-height:112%;color:#A60000'>&quot;MyConnectionName&quot;</span><span
style='font-size:9.0pt;line-height:112%;color:#666666'>].</span><span
style='font-size:9.0pt;line-height:112%'>Conne ctionString</span><span
style='font-size:9.0pt;line-height:112%;color:#666666'>)) </span><span
style='font-size:9.0pt;line-height:112%'></span><span style='font-size:
9.0pt;line-height:112%;color:#666666'>{</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.25pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%'> </span><i><span style='font-size:9.0pt;line-height:110%;
color:darkgreen'>// best practice - use column names in your INSERT statement
so you are not dependent on the sql schema column order</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.25pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%'> </span><i><span style='font-size:9.0pt;line-height:110%;
color:darkgreen'>// best practice - always use parameters to avoid sql
injection attacks and errors if malformed text is used like including a single
quote which is the sql equivalent of escaping or starting a string
(varchar/nvarchar)</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.25pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%'> </span><i><span style='font-size:9.0pt;line-height:110%;
color:darkgreen'>// best practice - give your parameters meaningful names just
like you do variables in your code</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:21.85pt;margin-bottom:
.25pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:#0600FF'>using</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>(</span><span style='font-size:9.0pt;line-height:110%'>SqlCommand
sc </span><span style='font-size:9.0pt;line-height:110%;color:#666666'>=</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#0600FF'>new</span><span style='font-size:9.0pt;
line-height:110%'> SqlCommand</span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>(</span><span style='font-size:9.0pt;line-height:110%;
color:#A60000'>&quot;INSERT INTO employee (FirstName, LastName,</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:92.0pt;margin-bottom:
.25pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;color:#A60000'>DateOfBirth /*etc*/) VALUES (@firstName,
@lastName, @dateOfBirth /*etc*/)&quot;</span><span style='font-size:9.0pt;
line-height:110%'>, con</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>)) </span><span style='font-size:9.0pt;line-height:110%'></span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>{</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:5.15pt;margin-bottom:
12.45pt;margin-left:3.5pt;line-height:110%'><span style='position:relative;
z-index:-1895778304'><span style='left:0px;position:absolute;left:0px;
top:-47508px;width:718px;height:1px'><img width=718 height=1
src=".NET%20Framework%20Notes%20for%20Professionals_files/image289.gif"></span></span><span
style='font-size:9.0pt;line-height:110%'> </span><i><span
style='font-size:9.0pt;line-height:110%;color:darkgreen'>// best practice -
always specify the database data type of the column you are using </span></i><span
style='font-size:9.0pt;line-height:110%'></span><i><span
style='font-size:9.0pt;line-height:110%;color:darkgreen'>// best practice -
check for valid values in your code and/or use a database constraint, if
inserting NULL then use System.DbNull.Value </span></i><span style='font-size:
9.0pt;line-height:110%'>sc</span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>.</span><span style='font-size:9.0pt;
line-height:110%'>Parameters</span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%;
color:#0600FF'>Add</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>(</span><span style='font-size:9.0pt;line-height:110%;
color:#0600FF'>new</span><span style='font-size:9.0pt;line-height:110%'>
SqlParameter</span><span style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%;color:#A60000'>&quot;@firstName&quot;</span><span
style='font-size:9.0pt;line-height:110%'>, SqlDbType</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>VarChar, </span><span
style='font-size:9.0pt;line-height:110%;color:red'>200</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>){</span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>Value</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>= </span><span style='font-size:9.0pt;
line-height:110%'>newEmployee</span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%'>FirstName
</span><span style='font-size:9.0pt;line-height:110%;color:#666666'>??</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>(</span><span style='font-size:9.0pt;
line-height:110%;color:#0600FF'>object</span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>)</span><span style='font-size:9.0pt;
line-height:110%'> System</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%'>DBNull</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>Value</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>}); </span><span
style='font-size:9.0pt;line-height:110%'>sc</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>Parameters</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>Add</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>new</span><span
style='font-size:9.0pt;line-height:110%'> SqlParameter</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%;color:#A60000'>&quot;@lastName&quot;</span><span
style='font-size:9.0pt;line-height:110%'>, SqlDbType</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>VarChar, </span><span
style='font-size:9.0pt;line-height:110%;color:red'>200</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>){</span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>Value</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>= </span><span style='font-size:9.0pt;
line-height:110%'>newEmployee</span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%'>LastName
</span><span style='font-size:9.0pt;line-height:110%;color:#666666'>??</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>(</span><span style='font-size:9.0pt;
line-height:110%;color:#0600FF'>object</span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>)</span><span style='font-size:9.0pt;
line-height:110%'> System</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%'>DBNull</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>Value</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>});</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:15.7pt;margin-bottom:
12.45pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%'> </span><i><span style='font-size:9.0pt;
line-height:110%;color:darkgreen'>// best practice - always use the correct
types when specifying your parameters, Value is assigned to a DateTime instance
and not a string representation of a Date </span></i><span style='font-size:
9.0pt;line-height:110%'>sc</span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>.</span><span style='font-size:9.0pt;
line-height:110%'>Parameters</span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%;
color:#0600FF'>Add</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>(</span><span style='font-size:9.0pt;line-height:110%;
color:#0600FF'>new</span><span style='font-size:9.0pt;line-height:110%'>
SqlParameter</span><span style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%;color:#A60000'>&quot;@dateOfBirth&quot;</span><span
style='font-size:9.0pt;line-height:110%'>, SqlDbType</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>Date</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>){</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:#0600FF'>Value</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>= </span><span
style='font-size:9.0pt;line-height:110%'>newEmployee</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>DateOfBirth </span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>});</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:11.8pt;margin-bottom:
.25pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%'> </span><i><span style='font-size:9.0pt;
line-height:110%;color:darkgreen'>// best practice - open your connection as
late as possible unless you need to verify that the database connection is
valid and won't fail and the proceeding code execution takes a long time (not
the case here) </span></i><span style='font-size:9.0pt;line-height:110%'>con</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>Open</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>();</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:351.25pt;margin-bottom:
12.45pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%'> sc</span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%'>ExecuteNonQuery</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(); </span><span
style='font-size:9.0pt;line-height:110%'></span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.25pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%'> </span><i><span style='font-size:9.0pt;line-height:110%;
color:darkgreen'>// the end of the using block will close and dispose the
SqlConnection</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.25pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%'> </span><i><span style='font-size:9.0pt;line-height:110%;
color:darkgreen'>// best practice - end the using block as soon as possible to
release the database connection</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.25pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:#666666'>}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.55pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%;color:#666666'>}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:243.55pt;margin-bottom:
.25pt;margin-left:3.5pt;line-height:110%'><i><span style='font-size:9.0pt;
line-height:110%;color:darkgreen'>// supporting class used as parameter for
example </span></i><span style='font-size:9.0pt;line-height:110%;color:#0600FF'>public</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#0600FF'>class</span><span style='font-size:9.0pt;
line-height:110%'> Employee</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:19.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=87
src=".NET%20Framework%20Notes%20for%20Professionals_files/image290.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.9pt;
margin-left:.75pt;line-height:107%'><b>Best practice for working with </b><a
href="https://msdn.microsoft.com/en-us/library/h43ks021(v=vs.110).aspx"><b><span
style='color:#1889D0'>ADO.NET</span></b></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:30.0pt;text-indent:-9.1pt'><span style='font-size:11.0pt;
line-height:109%'><img border=0 width=5 height=5 id="Group 254615"
src=".NET%20Framework%20Notes%20for%20Professionals_files/image259.gif"></span>Rule
of thumb is to open connection for minimal time. Close the connection
explicitly once your procedure execution is over this will return the
connection object back to connection pool. Default connection pool max size =
100. As connection pooling enhances the performance of physical connection to
SQL</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:1.85pt;
margin-left:30.5pt;line-height:107%'>Server.<a
href="https://msdn.microsoft.com/en-us/library/8xx3tyca(v=vs.110).aspx"><span
style='color:#1889D0'>Connection Pooling in SQL Server</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:21.4pt'><img width=5 height=1
src=".NET%20Framework%20Notes%20for%20Professionals_files/image291.gif"
align=left hspace=12>Wrap all database connections in a using block so they are
always closed &amp; disposed even in the event of an</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:21.4pt'>Exception. See <a
href="https://msdn.microsoft.com/en-us/library/yh598w02.aspx"><span
style='color:#1889D0'>using Statement (C# Reference)</span></a> for more
information on using statements</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:21.4pt'>Retrieve the connection strings by name from the app.config
or web.config (depending on the application type)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:51.55pt'><img width=5 height=1
src=".NET%20Framework%20Notes%20for%20Professionals_files/image291.gif"
align=left hspace=12>This requires an assembly reference to <span
style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>System.configuration</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:51.55pt'>See <a
href="https://msdn.microsoft.com/en-us/library/ms254494(v=vs.110).aspx"><span
style='color:#1889D0'>Connection Strings and Configuration Files</span></a> for
additional information on how to structure your configuration file</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:30.5pt'><img width=46 height=1
src=".NET%20Framework%20Notes%20for%20Professionals_files/image292.gif"
align=left hspace=12>Always use parameters for incoming values to</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:21.4pt'>Avoid <a href="https://en.wikipedia.org/wiki/SQL_injection"><span
style='color:#1889D0'>sql injection</span></a> attacks</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:21.4pt'>Avoid errors if malformed text is used like including a
single quote which is the sql equivalent of escaping or starting a string
(varchar/nvarchar)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:21.4pt'>Letting the database provider reuse query plans (not
supported by all database providers) which increases efficiency</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:30.5pt'><img width=46 height=1
src=".NET%20Framework%20Notes%20for%20Professionals_files/image292.gif"
align=left hspace=12>When working with parameters</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:21.4pt'>Sql parameters type and size mismatch is a common cause of
insert/ updated/ select failure</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:21.4pt'>Give your Sql parameters meaningful names just like you do
variables in your code</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:21.4pt'>Specify the database data type of the column you are using,
this ensures the wrong parameter types is not used which could lead to
unexpected results</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:21.4pt'>Validate your incoming parameters before you pass them into
the command (as the saying goes,</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:21.4pt'>&quot;<a
href="https://en.wikipedia.org/wiki/Garbage_in,_garbage_out"><span
style='color:#1889D0'>garbage in, garbage out</span></a>&quot;). Validate
incoming values as early as possible in the stack</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:21.4pt'>Use the correct types when assigning your parameter values,
example: do not assign the string value of a DateTime, instead assign an actual
DateTime instance to the value of the parameter</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:21.4pt'>Specify the <a
href="https://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlparameter.size(v=vs.110).aspx"><span
style='color:#1889D0'>size</span></a> of string-type parameters. This is
because SQL Server can re-use execution plans if the parameters match in type <i>and</i>
size. Use -1 for MAX</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:21.4pt'>Do not use the method <a
href="https://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlparametercollection.addwithvalue(v=vs.110).aspx"><span
style='color:#1889D0'>AddWithValue</span></a>, the main reason is it is very
easy to forget to specify the parameter type or the precision/scale when
needed. For additional information see <a
href="http://blogs.msmvps.com/jcoehoorn/blog/2014/05/12/can-we-stop-using-addwithvalue-already/"><span
style='color:#1889D0'>Can we stop using </span></a><a
href="http://blogs.msmvps.com/jcoehoorn/blog/2014/05/12/can-we-stop-using-addwithvalue-already/"><span
style='color:#1889D0'>AddWithValue already?</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:30.5pt'><img width=46 height=1
src=".NET%20Framework%20Notes%20for%20Professionals_files/image292.gif"
align=left hspace=12>When using database connections</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:21.4pt'>Open the connection as late as possible and close it as
soon as possible. This is a general guideline when working with any external
resource</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:21.4pt'><img width=4 height=1
src=".NET%20Framework%20Notes%20for%20Professionals_files/image293.gif"
align=left hspace=12>Never share database connection instances (example: having
a singleton host a shared instance of type <span style='font-size:9.0pt;
line-height:109%;background:#FAFAFA'>SqlConnection</span>). Have your code
always create a new database connection instance when needed and then have the
calling code dispose of it and &quot;throw it away&quot; when it is done. The
reason for this is Most database providers have some sort of connection pooling
so creating new managed connections is cheap</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:-.85pt;
margin-bottom:17.3pt;margin-left:80.8pt;text-align:center;line-height:123%'>It
eliminates any future errors if the code starts working with multiple threads</p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:4.2pt;margin-left:
-.25pt'><a name="_Toc281507">Section 25.2: Executing SQL statements as a
command</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.25pt;
margin-left:3.5pt;line-height:110%'><span style='position:relative;z-index:
-1895771136'><span style='left:0px;position:absolute;left:0px;top:-48778px;
width:718px;height:1px'><img width=718 height=1
src=".NET%20Framework%20Notes%20for%20Professionals_files/image294.gif"></span></span><i><span
style='font-size:9.0pt;line-height:110%;color:darkgreen'>// Uses Windows
authentication. Replace the Trusted_Connection parameter with</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:122.75pt;margin-bottom:
12.45pt;margin-left:3.5pt;line-height:110%'><span style='position:relative;
z-index:-1895770112'><span style='left:0px;position:absolute;left:0px;
top:-48796px;width:718px;height:1px'><img width=718 height=1
src=".NET%20Framework%20Notes%20for%20Professionals_files/image295.gif"></span></span><i><span
style='font-size:9.0pt;line-height:110%;color:darkgreen'>// User
Id=...;Password=...; to use SQL Server authentication instead. You may // want
to find the appropriate connection string for your server. </span></i><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>string</span><span
style='font-size:9.0pt;line-height:110%'> connectionString </span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>= </span><span
style='font-size:9.0pt;line-height:110%;color:#A60000'>@&quot;Server=myServer\myInstance;Database=myDataBase;Trusted_Connection=True;&quot;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:135.25pt;margin-bottom:
12.45pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;color:#0600FF'>string</span><span style='font-size:9.0pt;
line-height:110%'> sql </span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>=</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:#A60000'>&quot;INSERT INTO
myTable (myDateTimeField, myIntField) &quot;</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>+ </span><span style='font-size:9.0pt;line-height:110%'></span><span
style='font-size:9.0pt;line-height:110%;color:#A60000'>&quot;VALUES
(@someDateTime, @someInt);&quot;</span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:133.3pt;margin-bottom:
.2pt;margin-left:3.5pt;line-height:110%'><i><span style='font-size:9.0pt;
line-height:110%;color:darkgreen'>// Most ADO.NET objects are disposable and,
thus, require the using keyword. </span></i><span style='font-size:9.0pt;
line-height:110%;color:#0600FF'>using</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>(</span><span style='font-size:9.0pt;line-height:110%;
color:#0600FF'>var</span><span style='font-size:9.0pt;line-height:110%'>
connection </span><span style='font-size:9.0pt;line-height:110%;color:#666666'>=</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#0600FF'>new</span><span style='font-size:9.0pt;
line-height:110%'> SqlConnection</span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>(</span><span style='font-size:9.0pt;line-height:110%'>connectionString</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>)) </span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>using</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>(</span><span style='font-size:9.0pt;
line-height:110%;color:#0600FF'>var</span><span style='font-size:9.0pt;
line-height:110%'> command </span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>=</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>new</span><span
style='font-size:9.0pt;line-height:110%'> SqlCommand</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%'>sql, connection</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>)) {</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.25pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%'> </span><i><span style='font-size:9.0pt;line-height:110%;color:darkgreen'>//
Use parameters instead of string concatenation to add user-supplied</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.55pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%'> </span><i><span style='font-size:9.0pt;line-height:110%;color:darkgreen'>//
values to avoid SQL injection and formatting issues. Explicitly supply
datatype.</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:22.65pt;margin-bottom:
12.45pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%'> </span><i><span style='font-size:9.0pt;line-height:110%;
color:darkgreen'>// System.Data.SqlDbType is an enumeration. See Note1 </span></i><span
style='font-size:9.0pt;line-height:110%'>command</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>Parameters</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>Add</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%;color:#A60000'>&quot;@someDateTime&quot;</span><span
style='font-size:9.0pt;line-height:110%'>, SqlDbType</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>DateTime</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>).</span><span style='font-size:9.0pt;
line-height:110%;color:#0600FF'>Value</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>=</span><span style='font-size:9.0pt;line-height:110%'>
myDateTimeVariable</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>; </span><span style='font-size:9.0pt;line-height:110%'>command</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>Parameters</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>Add</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%;color:#A60000'>&quot;@someInt&quot;</span><span
style='font-size:9.0pt;line-height:110%'>, SqlDbType</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>Int</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>).</span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>Value</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>=</span><span style='font-size:9.0pt;
line-height:110%'> myInt32Variable</span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.25pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%'> </span><i><span style='font-size:9.0pt;line-height:110%;color:darkgreen'>//
Execute the SQL statement. Use ExecuteScalar and ExecuteReader instead</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:117.0pt;margin-bottom:
12.45pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%'> </span><i><span style='font-size:9.0pt;line-height:110%;
color:darkgreen'>// for query that return results (or see the more specific
examples, once </span></i><span style='font-size:9.0pt;line-height:110%'></span><i><span
style='font-size:9.0pt;line-height:110%;color:darkgreen'>// those have been
added).</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:367.45pt;margin-bottom:
17.45pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%'> connection</span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%'>Open</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(); </span><span
style='font-size:9.0pt;line-height:110%'>command</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>ExecuteNonQuery</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(); }</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:13.4pt;
margin-left:1.05pt'><b><i>Note 1:</i></b> Please see <a
href="https://msdn.microsoft.com/en-us/library/system.data.sqldbtype(v=vs.110).aspx"><span
style='color:#1889D0'>SqlDbType Enumeration</span></a> for the MSFT SQL
Server-specific variation.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:18.9pt;
margin-left:1.05pt'><b><i>Note 2:</i></b> Please see <a
href="https://dev.mysql.com/doc/dev/connector-net/html/T_MySql_Data_MySqlClient_MySqlDbType.htm"><span
style='color:#1889D0'>MySqlDbType Enumeration</span></a> for the MySQL-specific
variation.</p>

<h2 style='margin-left:-.25pt'><a name="_Toc281508">Section 25.3: Using common
interfaces to abstract away vendor specific classes</a></h2>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=720 height=322
src=".NET%20Framework%20Notes%20for%20Professionals_files/image296.gif"></span></p>

<h1 style='margin-left:-.25pt'><a name="_Toc281509">Chapter 26: Dependency
Injection</a></h1>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:3.45pt;margin-left:
-.25pt'><a name="_Toc281510">Section 26.1: How Dependency Injection Makes Unit
Testing Easier</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:11.0pt;
margin-left:1.05pt;line-height:131%'>This builds on the previous example of the
<span style='font-size:9.0pt;line-height:131%;background:#FAFAFA'>Greeter</span>
class which has two dependencies, <span style='font-size:9.0pt;line-height:
131%;background:#FAFAFA'>IGreetingProvider</span> and <span style='font-size:
9.0pt;line-height:131%;background:#FAFAFA'>IGreetingWriter</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>The actual implementation of <span style='font-size:9.0pt;
line-height:109%;background:#FAFAFA'>IGreetingProvider</span> might retrieve a
string from an API call or a database. The implementation of <span
style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>IGreetingWriter</span>
might display the greeting in the console. But because <span style='font-size:
9.0pt;line-height:109%;background:#FAFAFA'>Greeter</span> has its dependencies
injected into its constructor, it's easy to write a unit test that injects
mocked versions of those interfaces. In real life we might use a framework like
<a href="http://www.moqthis.com/"><span style='color:#1889D0'>Moq</span></a>,
but in this case I'll write those mocked implementations.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.25pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=519
src=".NET%20Framework%20Notes%20for%20Professionals_files/image297.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>The behavior of <span style='font-size:9.0pt;line-height:
109%;background:#FAFAFA'>IGreetingProvider</span> and <span style='font-size:
9.0pt;line-height:109%;background:#FAFAFA'>IGreetingWriter</span> are not
relevant to this test. We want to test that</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.25pt;
margin-left:-.25pt;text-align:justify;text-justify:inter-ideograph;line-height:
135%'><span style='font-size:9.0pt;line-height:135%;background:#FAFAFA'>Greeter</span>
gets a greeting and writes it. The design of <span style='font-size:9.0pt;
line-height:135%;background:#FAFAFA'>Greeter</span> (using dependency
injection) allows us to inject mocked dependencies without any complicated
moving parts. All we're testing is that <span style='font-size:9.0pt;
line-height:135%;background:#FAFAFA'>Greeter</span> interacts with those
dependencies as we expect it to.</p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:.25pt;margin-left:
-.25pt;text-align:justify;text-justify:inter-ideograph;line-height:135%'><a
name="_Toc281511">Section 26.2: Dependency Injection - Simple example</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>This class is called <span style='font-size:9.0pt;
line-height:109%;background:#FAFAFA'>Greeter</span>. Its responsibility is to
output a greeting. It has two <i>dependencies</i>. It needs something that will
give it the greeting to output, and then it needs a way to output that
greeting. Those dependencies are both described as interfaces, <span
style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>IGreetingProvider</span>
and <span style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>IGreetingWriter</span>.
In this example, those two dependencies are &quot;injected&quot; into <span
style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>Greeter</span>.
(Further explanation following the example.)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=720 height=453
src=".NET%20Framework%20Notes%20for%20Professionals_files/image298.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.5pt;
margin-left:1.05pt'>The <span style='font-size:9.0pt;line-height:109%;
background:#FAFAFA'>Greeting</span> class depends on both <span
style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>IGreetingProvider</span>
and <span style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>IGreetingWriter</span>,
but it is not responsible for creating instances of either. Instead it requires
them in its constructor. Whatever creates an instance of <span
style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>Greeting </span>must
provide those two dependencies. We can call that &quot;injecting&quot; the
dependencies.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:34.55pt;margin-bottom:
.05pt;margin-left:1.05pt;line-height:215%'>Because dependencies are provided to
the class in its constructor, this is also called &quot;constructor
injection.&quot; A few common conventions:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:21.4pt'><img width=5 height=1
src=".NET%20Framework%20Notes%20for%20Professionals_files/image291.gif"
align=left hspace=12>The constructor saves the dependencies as <span
style='font-size:9.0pt;line-height:109%;color:#0600FF;background:#FAFAFA'>private</span>
fields. As soon as the class is instantiated, those dependencies are available
to all other non-static methods of the class.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:21.4pt'>The <span style='font-size:9.0pt;line-height:109%;
color:#0600FF;background:#FAFAFA'>private</span> fields are <span
style='font-size:9.0pt;line-height:109%;color:#0600FF;background:#FAFAFA'>readonly</span>.
Once they are set in the constructor they cannot be changed. This indicates
that those fields should not (and cannot) be modified outside of the
constructor. That further ensures that those dependencies will be available for
the lifetime of the class.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:18.3pt;
margin-left:30.0pt;text-indent:-9.1pt'><span style='font-size:11.0pt;
line-height:109%'><img border=0 width=5 height=5 id="Group 254290"
src=".NET%20Framework%20Notes%20for%20Professionals_files/image259.gif"></span>The
dependencies are interfaces. This is not strictly necessary, but is common
because it makes it easier to substitute one implementation of the dependency
with another. It also allows providing a mocked version of the interface for
unit testing purposes.</p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:3.25pt;margin-left:
-.25pt'><a name="_Toc281512">Section 26.3: Why We Use Dependency Injection
Containers (IoC Containers)</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.55pt;
margin-left:1.05pt'>Dependency injection means writing classes so that they do
not control their dependencies - instead, their dependencies are provided to
them (&quot;injected.&quot;)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.55pt;
margin-left:1.05pt'>This is not the same thing as using a dependency injection
framework (often called a &quot;DI container&quot;, &quot;IoC container&quot;,
or just &quot;container&quot;) like Castle Windsor, Autofac, SimpleInjector,
Ninject, Unity, or others.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:14.6pt;
margin-left:1.05pt'>A container just makes dependency injection easier. For
example, suppose you write a number of classes that rely on dependency
injection. One class depends on several interfaces, the classes that implement
those interfaces depend on other interfaces, and so on. Some depend on specific
values. And just for fun, some of those classes implement <span
style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>IDisposable</span>
and need to be disposed.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:14.2pt;
margin-left:1.05pt'>Each individual class is well-written and easy to test. But
now there's a different problem: Creating an instance of a class has become
much more complicated. Suppose we're creating an instance of a <span
style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>CustomerService</span>
class. It has dependencies and its dependencies have dependencies. Constructing
an instance might look something like this:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:5.6pt;margin-bottom:.2pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%;color:#0600FF'>public</span><span style='font-size:9.0pt;line-height:110%'>
CustomerData GetCustomerData</span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>(</span><span style='font-size:9.0pt;line-height:110%;
color:#0600FF'>string</span><span style='font-size:9.0pt;line-height:110%'>
customerNumber</span><span style='font-size:9.0pt;line-height:110%;color:#666666'>)
{ </span><span style='font-size:9.0pt;line-height:110%'></span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>var</span><span
style='font-size:9.0pt;line-height:110%'> customerApiEndpoint </span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>=</span><span
style='font-size:9.0pt;line-height:110%'> ConfigurationManager</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>AppSettings</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>[</span><span
style='font-size:9.0pt;line-height:110%;color:#A60000'>&quot;customerApi:customerApiEndpoint&quot;</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>]; </span><span
style='font-size:9.0pt;line-height:110%'></span><span style='font-size:
9.0pt;line-height:110%;color:#0600FF'>var</span><span style='font-size:9.0pt;
line-height:110%'> logFilePath </span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>=</span><span style='font-size:9.0pt;line-height:110%'>
ConfigurationManager</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%'>AppSettings</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>[</span><span
style='font-size:9.0pt;line-height:110%;color:#A60000'>&quot;logwriter:logFilePath&quot;</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>]; </span><span
style='font-size:9.0pt;line-height:110%'></span><span style='font-size:
9.0pt;line-height:110%;color:#0600FF'>var</span><span style='font-size:9.0pt;
line-height:110%'> authConnectionString </span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>=</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:54.25pt;margin-bottom:
.2pt;margin-left:3.5pt;line-height:110%'><span style='position:relative;
z-index:-1895768064'><span style='left:0px;position:absolute;left:0px;
top:-51750px;width:718px;height:1px'><img width=718 height=1
src=".NET%20Framework%20Notes%20for%20Professionals_files/image299.gif"></span></span><span
style='font-size:9.0pt;line-height:110%'>ConfigurationManager</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>ConnectionStrings</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>[</span><span
style='font-size:9.0pt;line-height:110%;color:#A60000'>&quot;authorization&quot;</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>].</span><span
style='font-size:9.0pt;line-height:110%'>ConnectionString</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>; </span><span
style='font-size:9.0pt;line-height:110%'></span><span style='font-size:
9.0pt;line-height:110%;color:#0600FF'>using</span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>(</span><span style='font-size:9.0pt;
line-height:110%;color:#0600FF'>var</span><span style='font-size:9.0pt;
line-height:110%'> logWriter </span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>=</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>new</span><span
style='font-size:9.0pt;line-height:110%'> LogWriter</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%'>logFilePath </span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>)) </span><span
style='font-size:9.0pt;line-height:110%'></span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>{ </span><span style='font-size:9.0pt;
line-height:110%'></span><span style='font-size:9.0pt;line-height:110%;
color:#0600FF'>using</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>(</span><span style='font-size:9.0pt;line-height:110%;
color:#0600FF'>var</span><span style='font-size:9.0pt;line-height:110%'>
customerApiClient </span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>=</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>new</span><span
style='font-size:9.0pt;line-height:110%'> CustomerApiClient</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%'>customerApiEndpoint</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>)) </span><span
style='font-size:9.0pt;line-height:110%'></span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>{ </span><span style='font-size:9.0pt;
line-height:110%'></span><span style='font-size:9.0pt;line-height:
110%;color:#0600FF'>var</span><span style='font-size:9.0pt;line-height:110%'>
customerService </span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>=</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>new</span><span
style='font-size:9.0pt;line-height:110%'> CustomerService</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>( </span><span
style='font-size:9.0pt;line-height:110%'></span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>new</span><span
style='font-size:9.0pt;line-height:110%'> SqlAuthorizationRepository</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%'>authorizationConnectionString,
logWriter</span><span style='font-size:9.0pt;line-height:110%;color:#666666'>)</span><span
style='font-size:9.0pt;line-height:110%'>, </span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>new</span><span
style='font-size:9.0pt;line-height:110%'> CustomerDataRepository</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%'>customerApiClient, logWriter</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>)</span><span
style='font-size:9.0pt;line-height:110%'>,
logWriter </span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>);</span><span style='font-size:9.0pt;line-height:110%'> </span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
margin-left:3.75pt;text-indent:0in;line-height:107%'><span style='font-size:
9.0pt;line-height:107%'> </span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:129.85pt;margin-bottom:
.25pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%'> </span><i><span style='font-size:9.0pt;
line-height:110%;color:darkgreen'>// All this just to create an instance of
CustomerService! </span></i><span style='font-size:9.0pt;line-height:
110%'></span><span style='font-size:9.0pt;line-height:110%;
color:#0600FF'>return</span><span style='font-size:9.0pt;line-height:110%'>
customerService</span><span style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>GetCustomerData</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>string</span><span
style='font-size:9.0pt;line-height:110%'> customerNumber</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>); </span><span
style='font-size:9.0pt;line-height:110%'></span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.25pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:#666666'>}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:17.25pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%;color:#666666'>}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>You might wonder, why not put the whole giant construction
in a separate function that just returns</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=130 style='width:1.35in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=130 valign=top style='width:1.35in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>GetCustomerService</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.6pt;
margin-left:1.05pt'><span style='font-size:9.0pt;line-height:109%;background:
#FAFAFA'>CustomerService</span>? One reason is that because the dependencies
for each class are injected into it, a class isn't responsible for knowing
whether those dependencies are <span style='font-size:9.0pt;line-height:109%;
background:#FAFAFA'>IDisposable</span> or disposing them. It just uses them. So
if a we had a <span style='font-size:9.0pt;line-height:109%;color:#666666;
background:#FAFAFA'>()</span> function that returned a fully-constructed <span
style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>CustomerService</span>,
that class might contain a number of disposable resources and no way to access
or dispose them.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.55pt;
margin-left:1.05pt'>And aside from disposing <span style='font-size:9.0pt;
line-height:109%;background:#FAFAFA'>IDisposable</span>, who wants to call a
series of nested constructors like that, ever? That's a short example. It could
get much, much worse. Again, that doesn't mean that we wrote the classes the
wrong way. The classes might be individually perfect. The challenge is composing
them together.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:14.2pt;
margin-left:1.05pt'>A dependency injection container simplifies that. It allows
us to specify which class or value should be used to fulfill each dependency.
This slightly oversimplified example uses Castle Windsor:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:254.05pt;margin-bottom:
.2pt;margin-left:3.5pt;line-height:110%'><span style='position:relative;
z-index:-1895767040'><span style='left:0px;position:absolute;left:0px;
top:-52175px;width:718px;height:1px'><img width=718 height=1
src=".NET%20Framework%20Notes%20for%20Professionals_files/image300.gif"></span></span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>var</span><span
style='font-size:9.0pt;line-height:110%'> container </span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>=</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#0600FF'>new</span><span style='font-size:9.0pt;
line-height:110%'> WindsorContainer</span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>() </span><span style='font-size:9.0pt;
line-height:110%'>container</span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%'>Register</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>( </span><span
style='font-size:9.0pt;line-height:110%'>Component</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>For</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>&lt;</span><span
style='font-size:9.0pt;line-height:110%'>CustomerService</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>&gt;()</span><span
style='font-size:9.0pt;line-height:110%'>,</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%'> Component</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%;
color:#0600FF'>For</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>&lt;</span><span style='font-size:9.0pt;line-height:110%'>ILogWriter,
LogWriter</span><span style='font-size:9.0pt;line-height:110%;color:#666666'>&gt;()</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>DependsOn</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%'>Dependency</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>OnAppSettingsValue</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%;color:#A60000'>&quot;logFilePath&quot;</span><span
style='font-size:9.0pt;line-height:110%'>, </span><span style='font-size:9.0pt;
line-height:110%;color:#A60000'>&quot;logWriter:logFilePath&quot;</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>))</span><span
style='font-size:9.0pt;line-height:110%'>,</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%'> Component</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%;
color:#0600FF'>For</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>&lt;</span><span style='font-size:9.0pt;line-height:110%'>IAuthorizationRepository,
SqlAuthorizationRepository</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>&gt;()</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>DependsOn</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%'>Dependency</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>OnValue</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>(</span><span style='font-size:9.0pt;
line-height:110%'>connectionString,</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%'>ConfigurationManager</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%'>ConnectionStrings</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>[</span><span
style='font-size:9.0pt;line-height:110%;color:#A60000'>&quot;authorization&quot;</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>].</span><span
style='font-size:9.0pt;line-height:110%'>ConnectionString</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>))</span><span
style='font-size:9.0pt;line-height:110%'>,</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%'> Component</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%;
color:#0600FF'>For</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>&lt;</span><span style='font-size:9.0pt;line-height:110%'>ICustomerDataProvider,
CustomerApiClient</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>&gt;()</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>DependsOn</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%'>Dependency</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>OnAppSettingsValue</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%;color:#A60000'>&quot;apiEndpoint&quot;</span><span
style='font-size:9.0pt;line-height:110%'>,</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:21.85pt;margin-bottom:
.25pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;color:#A60000'>&quot;customerApi:customerApiEndpoint&quot;</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>))</span><span
style='font-size:9.0pt;line-height:110%'> </span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:17.4pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%;color:#666666'>);</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:13.8pt;
margin-left:1.05pt'>We call this &quot;registering dependencies&quot; or
&quot;configuring the container.&quot; Translated, this tells our <span
style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>WindsorContainer</span>:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:30.0pt;text-indent:-9.1pt'><span style='font-size:11.0pt;
line-height:109%'><img border=0 width=5 height=5 id="Group 256104"
src=".NET%20Framework%20Notes%20for%20Professionals_files/image259.gif"></span>If
a class requires <span style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>ILogWriter</span>,
create an instance of <span style='font-size:9.0pt;line-height:109%;background:
#FAFAFA'>LogWriter</span>. <span style='font-size:9.0pt;line-height:109%;
background:#FAFAFA'>LogWriter</span> requires a file path. Use this value from <span
style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>AppSettings</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:21.4pt'><img width=5 height=1
src=".NET%20Framework%20Notes%20for%20Professionals_files/image291.gif"
align=left hspace=12>If a class requires <span style='font-size:9.0pt;
line-height:109%;background:#FAFAFA'>IAuthorizationRepository</span>, create an
instance of <span style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>SqlAuthorizationRepository</span>.
It requires a connection string. Use this value from the <span
style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>ConnectionStrings</span>
section.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:10.7pt;
margin-left:21.4pt;line-height:132%'>If a class requires <span
style='font-size:9.0pt;line-height:132%;background:#FAFAFA'>ICustomerDataProvider</span>,
create a <span style='font-size:9.0pt;line-height:132%;background:#FAFAFA'>CustomerApiClient</span>
and provide the string it needs from <span style='font-size:9.0pt;line-height:
132%;background:#FAFAFA'>AppSettings</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:14.2pt;
margin-left:1.05pt'>When we request a dependency from the container we call
that &quot;resolving&quot; a dependency. It's bad practice to do that directly
using the container, but that's a different story. For demonstration purposes,
we could now do this:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:200.05pt;margin-bottom:
17.75pt;margin-left:3.5pt;line-height:110%'><span style='position:relative;
z-index:-1895764992'><span style='left:0px;position:absolute;left:0px;
top:-52583px;width:718px;height:1px'><img width=718 height=1
src=".NET%20Framework%20Notes%20for%20Professionals_files/image301.gif"></span></span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>var</span><span
style='font-size:9.0pt;line-height:110%'> customerService </span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>=</span><span
style='font-size:9.0pt;line-height:110%'> container</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>Resolve</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>&lt;</span><span style='font-size:9.0pt;
line-height:110%'>CustomerService</span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>&gt;(); </span><span style='font-size:9.0pt;
line-height:110%;color:#0600FF'>var</span><span style='font-size:9.0pt;
line-height:110%'> data </span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>=</span><span style='font-size:9.0pt;line-height:110%'>
customerService</span><span style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>GetCustomerData</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%'>customerNumber</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>); </span><span
style='font-size:9.0pt;line-height:110%'>container</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>Release</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>(</span><span style='font-size:9.0pt;
line-height:110%'>customerService</span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>);</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:13.05pt;
margin-left:1.05pt'>The container knows that <span style='font-size:9.0pt;
line-height:109%;background:#FAFAFA'>CustomerService</span> depends on <span
style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>IAuthorizationRepository</span>
and <span style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>ICustomerDataProvider</span>.
It knows what classes it needs to create to fulfill those requirements. Those
classes, in turn, have more dependencies, and the container knows how to
fulfill those. It will create every class it needs to until it can return an
instance of <span style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>CustomerService</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.5pt;
margin-left:1.05pt'>If it gets to a point where a class requires a dependency
that we haven't registered, like <span style='font-size:9.0pt;line-height:109%;
background:#FAFAFA'>IDoesSomethingElse</span>, then when we try to resolve <span
style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>CustomerService</span>
it will throw a clear exception telling us that we haven't registered anything
to fulfill that requirement.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.7pt;
margin-left:1.05pt'>Each DI framework behaves a little differently, but
typically they give us some control over how certain classes are instantiated.
For example, do we want it to create one instance of <span style='font-size:
9.0pt;line-height:109%;background:#FAFAFA'>LogWriter</span> and provide it to
every class that depends on <span style='font-size:9.0pt;line-height:109%;
background:#FAFAFA'>ILogWriter</span>, or do we want it to create a new one
every time? Most containers have a way to specify that.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=238 style='width:178.2pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=65 valign=top style='width:48.6pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>container</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>.</span></p>
  </td>
  <td width=50 valign=top style='width:37.8pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Release</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>(</span></p>
  </td>
  <td width=108 valign=top style='width:81.0pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>customerService</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>What about classes that implement <span style='font-size:
9.0pt;line-height:109%;background:#FAFAFA'>IDisposable</span>? That's why we
call <span style='font-size:9.0pt;line-height:109%;color:#666666;background:
#FAFAFA'>);</span> at the</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.75pt;
margin-left:1.05pt'>end. Most containers (including Windsor) will step back
through all of the dependencies created and <span style='font-size:9.0pt;
line-height:109%;background:#FAFAFA'>Dispose</span> the ones that need
disposing. If <span style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>CustomerService</span>
is <span style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>IDisposable</span>
it will dispose that too.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.55pt;
margin-left:1.05pt'>Registering dependencies as seen above might just look like
more code to write. But when we have lots of classes with lots of dependencies
then it really pays off. And if we had to write those same classes <i>without</i>
using dependency injection then that same application with lots of classes
would become difficult to maintain and test.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>This scratches the surface of <i>why</i> we use dependency
injection containers. <i>How</i> we configure our application to use one (and
use it correctly) is not just one topic - it's a number of topics, as the
instructions and examples vary from one container to the next.</p>

<h1 style='margin-left:-.25pt'><a name="_Toc281513">Chapter 27: Platform Invoke</a></h1>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc281514">Section 27.1: Marshaling structs</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.35pt;
margin-left:.75pt;line-height:107%'><b>Simple struct</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>C++ signature:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=125
src=".NET%20Framework%20Notes%20for%20Professionals_files/image302.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>C# definition</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=174
src=".NET%20Framework%20Notes%20for%20Professionals_files/image303.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.35pt;
margin-left:.75pt;line-height:107%'><b>Struct with unknown size array fields.
Passing in</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>C++ signature</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=125
src=".NET%20Framework%20Notes%20for%20Professionals_files/image304.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.95pt;
margin-left:1.05pt'>When passed from managed to unmanaged code, this</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=411 style='width:308.2pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=158 valign=top style='width:1.65in;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><a
  href="https://msdn.microsoft.com/en-us/library/system.runtime.interopservices.marshal.allochglobal(v=vs.110).aspx"><span
  style='font-size:9.0pt;line-height:107%;color:#1889D0'>Marshal</span></a><a
  href="https://msdn.microsoft.com/en-us/library/system.runtime.interopservices.marshal.allochglobal(v=vs.110).aspx"><span
  style='font-size:9.0pt;line-height:107%;color:#666666'>.</span></a><a
  href="https://msdn.microsoft.com/en-us/library/system.runtime.interopservices.marshal.allochglobal(v=vs.110).aspx"><span
  style='font-size:9.0pt;line-height:107%;color:#1889D0'>AllocHGloba</span></a><a
  href="https://msdn.microsoft.com/en-us/library/system.runtime.interopservices.marshal.allochglobal(v=vs.110).aspx"><span
  style='font-size:9.0pt;line-height:107%;color:#1889D0'>l</span></a><a
  href="https://msdn.microsoft.com/en-us/library/system.runtime.interopservices.marshal.allochglobal(v=vs.110).aspx"><span
  style='font-size:9.0pt;line-height:107%;color:#666666'>(</span></a><a
  href="https://msdn.microsoft.com/en-us/library/system.runtime.interopservices.marshal.allochglobal(v=vs.110).aspx"><span
  style='font-size:9.0pt;line-height:107%;color:#666666'>)</span></a></p>
  </td>
  <td width=101 valign=top style='width:76.0pt;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'>(and freed with </p>
  </td>
  <td width=151 valign=top style='width:113.4pt;background:#FAFAFA;padding:
  .9pt 0in 0in 0in;height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><a
  href="https://msdn.microsoft.com/en-us/library/system.runtime.interopservices.marshal.freehglobal(v=vs.110).aspx"><span
  style='font-size:9.0pt;line-height:107%;color:#1889D0'>Marshal</span></a><a
  href="https://msdn.microsoft.com/en-us/library/system.runtime.interopservices.marshal.freehglobal(v=vs.110).aspx"><span
  style='font-size:9.0pt;line-height:107%;color:#666666'>.</span></a><a
  href="https://msdn.microsoft.com/en-us/library/system.runtime.interopservices.marshal.freehglobal(v=vs.110).aspx"><span
  style='font-size:9.0pt;line-height:107%;color:#1889D0'>FreeHGlobal</span></a><a
  href="https://msdn.microsoft.com/en-us/library/system.runtime.interopservices.marshal.freehglobal(v=vs.110).aspx"><span
  style='font-size:9.0pt;line-height:107%;color:#666666'>(</span></a><a
  href="https://msdn.microsoft.com/en-us/library/system.runtime.interopservices.marshal.freehglobal(v=vs.110).aspx"><span
  style='font-size:9.0pt;line-height:107%;color:#666666'>)</span></a></p>
  </td>
 </tr>
</table>

<p class=MsoNormal align=right style='margin-top:0in;margin-right:120.2pt;
margin-bottom:1.55pt;margin-left:.5pt;text-align:right;line-height:107%'>The <span
style='font-size:9.0pt;line-height:107%;background:#FAFAFA'>data</span> array
should be defined as IntPtr and memory should be explicitly allocated with
afterwords):</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=199
src=".NET%20Framework%20Notes%20for%20Professionals_files/image305.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=399
src=".NET%20Framework%20Notes%20for%20Professionals_files/image306.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:281.8pt;margin-bottom:
0in;margin-left:.75pt;line-height:217%'><b>Struct with unknown size array
fields. Receiving </b>C++ signature:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=109
src=".NET%20Framework%20Notes%20for%20Professionals_files/image307.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=166 style='width:124.2pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=50 valign=top style='width:37.8pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><a
  href="https://msdn.microsoft.com/en-us/library/7b620dhe(v=vs.110).aspx"><span
  style='font-size:9.0pt;line-height:107%;color:#1889D0'>Marshal</span></a></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><a
  href="https://msdn.microsoft.com/en-us/library/7b620dhe(v=vs.110).aspx"><span
  style='font-size:9.0pt;line-height:107%;color:#666666;background:#FAFAFA'>.</span></a></p>
  </td>
  <td width=108 valign=top style='width:81.0pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><a
  href="https://msdn.microsoft.com/en-us/library/7b620dhe(v=vs.110).aspx"><span
  style='font-size:9.0pt;line-height:107%;color:#1889D0'>PtrToStringAnsi</span></a></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>When such data is passed out of unmanaged code and memory
is allocated by the unmanaged functions, the managed caller should receive it
into an <span style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>IntPrt</span>
variable and convert the buffer to a managed array. In case of strings there is
a convenient <a
href="https://msdn.microsoft.com/en-us/library/7b620dhe(v=vs.110).aspx"><span
style='font-size:9.0pt;line-height:109%;color:#666666;background:#FAFAFA'>(</span></a><a
href="https://msdn.microsoft.com/en-us/library/7b620dhe(v=vs.110).aspx"><span
style='font-size:9.0pt;line-height:109%;color:#666666;background:#FAFAFA'>)</span></a>
method:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=158
src=".NET%20Framework%20Notes%20for%20Professionals_files/image308.gif"></span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc281515">Section 27.2: Marshaling unions</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.35pt;
margin-left:.75pt;line-height:107%'><b>Value-type fields only</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>C++ declaration</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=59
src=".NET%20Framework%20Notes%20for%20Professionals_files/image309.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=38
src=".NET%20Framework%20Notes%20for%20Professionals_files/image310.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>C# declaration</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=142
src=".NET%20Framework%20Notes%20for%20Professionals_files/image311.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.35pt;
margin-left:.75pt;line-height:107%'><b>Mixing value-type and reference fields</b></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=79 style='width:59.4pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=79 valign=top style='width:59.4pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>FieldOffset</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>Overlapping a reference value with a value type one is not
allowed so you cannot simply use the <span style='font-size:9.0pt;line-height:
109%;color:#666666;background:#FAFAFA'>(</span><span style='font-size:9.0pt;
line-height:109%;color:red;background:#FAFAFA'>0</span><span style='font-size:
9.0pt;line-height:109%;color:#666666;background:#FAFAFA'>)</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=158 style='width:1.65in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:1.55pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>text</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.55pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>;</span></p>
  </td>
  <td width=86 valign=top style='width:.9in;background:#FAFAFA;padding:1.55pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>FieldOffset</span></p>
  </td>
  <td width=22 valign=top style='width:16.2pt;padding:1.55pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>(</span><span style='font-size:9.0pt;
  line-height:107%;color:red;background:#FAFAFA'>0</span><span
  style='font-size:9.0pt;line-height:107%;color:#666666;background:#FAFAFA'>)</span></p>
  </td>
  <td width=14 valign=top style='width:.15in;background:#FAFAFA;padding:1.55pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>i</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:119.3pt'><span style='font-size:9.0pt;line-height:109%;color:#666666;
background:#FAFAFA'>;</span> will not compile for</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=92
src=".NET%20Framework%20Notes%20for%20Professionals_files/image312.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>and generally you would have to employ custom marshaling.
However, in particular cases like this simpler technics may be used:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=125
src=".NET%20Framework%20Notes%20for%20Professionals_files/image313.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc281516">Section 27.3: Calling a
Win32 dll function</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=207
src=".NET%20Framework%20Notes%20for%20Professionals_files/image314.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=94 style='width:70.2pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=94 valign=top style='width:70.2pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#0600FF'>static</span><span style='font-size:9.0pt;line-height:
  107%'> </span><span style='font-size:9.0pt;line-height:107%;color:#0600FF'>extern</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.7pt;
margin-left:1.05pt'>Declare a function as stting <span style='font-size:9.0pt;
line-height:109%;background:#FAFAFA'>DllImportAttribute</span> with its <span
style='font-size:9.0pt;line-height:109%;color:#0600FF;background:#FAFAFA'>Value</span>
property set to .dll name. Don't forget to use <span style='font-size:9.0pt;
line-height:109%;background:#FAFAFA'>System.Runtime.InteropServices</span>
namespace. Then call it as an regular static method.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>The Platform Invocation Services will take care of loading
the .dll and finding the desired finction. The P/Invoke in most simple cases
will also marshal parameters and return value to and from the .dll (i.e.
convert from .NET datatypes to Win32 ones and vice versa).</p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:2.5pt;margin-left:
-.25pt'><a name="_Toc281517">Section 27.4: Using Windows API</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.1pt;
margin-left:-.25pt;line-height:107%'>Use <a href="http://pinvoke.net/"><span
style='color:#1889D0'>pinvoke.net</span></a>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:15.75pt;margin-bottom:
.25pt;margin-left:-.25pt;text-align:justify;text-justify:inter-ideograph;
line-height:135%'>Before declaring an <span style='font-size:9.0pt;line-height:
135%;color:#0600FF;background:#FAFAFA'>extern</span> Windows API function in
your code, consider looking for it on <a href="http://pinvoke.net/"><span
style='color:#1889D0'>pinvoke.net</span></a>. They most likely already have a
suitable declaration with all supporting types and good examples.</p>

<h2 style='margin-top:0in;margin-right:15.75pt;margin-bottom:.25pt;margin-left:
-.25pt;text-align:justify;text-justify:inter-ideograph;line-height:135%'><a
name="_Toc281518">Section 27.5: Marshalling arrays</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:.75pt;line-height:107%'><b>Arrays of simple type</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=76
src=".NET%20Framework%20Notes%20for%20Professionals_files/image315.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:.75pt;line-height:107%'><b>Arrays of string</b></p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=43
src=".NET%20Framework%20Notes%20for%20Professionals_files/image316.gif"></span><br
clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc281519">Chapter 28: NuGet packaging
system</a></h1>

<h2 style='margin-left:-.25pt'><a name="_Toc281520">Section 28.1: Uninstalling
a package from one project in a solution</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src=".NET%20Framework%20Notes%20for%20Professionals_files/image317.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc281521">Section 28.2: Installing a
specific version of a package</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src=".NET%20Framework%20Notes%20for%20Professionals_files/image318.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc281522">Section 28.3: Adding a
package source feed (MyGet, Klondike, ect)</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src=".NET%20Framework%20Notes%20for%20Professionals_files/image319.gif"></span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:2.5pt;margin-left:
-.25pt'><a name="_Toc281523">Section 28.4: Installing the NuGet Package Manager</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.55pt;
margin-left:1.05pt'>In order to be able to manage your projects' packages, you
need the NuGet Package Manager. This is a Visual Studio Extension, explained in
the official docs: <a href="https://docs.nuget.org/consume/installing-nuget"><span
style='color:#1889D0'>Installing and Updating NuGet Client</span></a>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.55pt;
margin-left:1.05pt'>Starting with Visual Studio 2012, NuGet is included in
every edition, and can be used from: Tools -&gt; NuGet Package Manager -&gt;
Package Manager Console.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>You do so through the Tools menu of Visual Studio, clicking
Extensions and Updates:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><img border=0 width=718
height=362 id="Picture 24331"
src=".NET%20Framework%20Notes%20for%20Professionals_files/image320.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:13.4pt;
margin-left:1.05pt'>This installs both the GUI:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.9pt;
margin-left:21.4pt'><span style='font-size:11.0pt;line-height:109%'><img
border=0 width=5 height=5 id="Group 252844"
src=".NET%20Framework%20Notes%20for%20Professionals_files/image259.gif"></span>Available
through clicking &quot;Manage NuGet Packages...&quot; on a project or its
References folder</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>And the Package Manager Console:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:120.2pt;margin-bottom:
0in;margin-left:.55pt;text-indent:20.9pt;line-height:145%'><span
style='font-size:11.0pt;line-height:145%'><img border=0 width=5 height=5
id="Group 253012"
src=".NET%20Framework%20Notes%20for%20Professionals_files/image259.gif"></span>Tools
-&gt; NuGet Package Manager -&gt; Package Manager Console.</p>

<h2 style='margin-top:0in;margin-right:120.2pt;margin-bottom:0in;margin-left:
.55pt;margin-bottom:.0001pt;text-indent:20.9pt;line-height:145%'><a
name="_Toc281524">Section 28.5: Managing Packages through the UI</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>When you right-click a project (or its References folder),
you can click the &quot;Manage NuGet Packages...&quot; option. This shows the <a
href="https://docs.nuget.org/consume/package-manager-dialog"><span
style='color:#1889D0'>Package Manager Dialog</span></a>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><img border=0 width=718
height=479 id="Picture 24366"
src=".NET%20Framework%20Notes%20for%20Professionals_files/image321.jpg"></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:2.5pt;margin-left:
-.25pt'><a name="_Toc281525">Section 28.6: Managing Packages through the
console</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.55pt;
margin-left:1.05pt'>Click the menus Tools -&gt; NuGet Package Manager -&gt;
Package Manager Console to show the console in your IDE. <a
href="https://docs.nuget.org/consume/package-manager-console-powershell-reference"><span
style='color:#1889D0'>Official documentation here</span></a>.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=108 style='width:81.0pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=108 valign=top style='width:81.0pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>install</span><span style='font-size:9.0pt;line-height:107%;color:#666666'>-</span><span
  style='font-size:9.0pt;line-height:107%'>package</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>Here you can issue, amongst others, commands which
installs the entered package into the currently selected &quot;Default
project&quot;:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src=".NET%20Framework%20Notes%20for%20Professionals_files/image322.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>You can also provide the project to install the package to,
overriding the selected project in the &quot;Default project&quot; dropdown:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src=".NET%20Framework%20Notes%20for%20Professionals_files/image323.gif"></span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:2.5pt;margin-left:
-.25pt'><a name="_Toc281526">Section 28.7: Updating a package</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>To update a package use the following command:</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=26
src=".NET%20Framework%20Notes%20for%20Professionals_files/image324.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=223 style='width:167.4pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=223 valign=top style='width:167.4pt;background:#FAFAFA;padding:
  1.8pt 0in 0in 0in;height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Install-Package</span><span style='font-size:9.0pt;
  line-height:107%'> EntityFramework</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.55pt;
margin-left:1.05pt'>where EntityFramework is the name of the package to be
updated. Note that update will run for all projects, and so is different from
which would install to &quot;Default project&quot; only.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>You can also specify a single project explicitly:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src=".NET%20Framework%20Notes%20for%20Professionals_files/image325.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc281527">Section 28.8: Uninstalling
a package</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src=".NET%20Framework%20Notes%20for%20Professionals_files/image326.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc281528">Section 28.9: Uninstall a
specific version of package</a></h2>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=26
src=".NET%20Framework%20Notes%20for%20Professionals_files/image327.gif"></span><br
clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc281529">Chapter 29: Globalization
in ASP.NET MVC using Smart internationalization for ASP.NET</a></h1>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:3.05pt;margin-left:
-.25pt'><a name="_Toc281530">Section 29.1: Basic configuration and setup</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:35.7pt;text-indent:-19.6pt'><span style='line-height:109%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Add the <a href="https://www.nuget.org/packages/I18N/"><span
style='color:#1889D0'>I18N nuget package</span></a> to your MVC project.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=374 style='width:3.9in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>i18n</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>.</span></p>
  </td>
  <td width=115 valign=top style='width:1.2in;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>LocalizingModule</span></p>
  </td>
  <td width=52 valign=top style='width:38.65pt;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'>to your </p>
  </td>
  <td width=86 valign=top style='width:.9in;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><b><span style='font-size:9.0pt;line-height:
  107%'>&lt;httpModules</span></b></p>
  </td>
  <td width=28 valign=top style='width:20.7pt;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><b><span style='font-size:9.0pt;line-height:
  107%;background:#FAFAFA'>&gt;</span></b> or </p>
  </td>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><b><span style='font-size:9.0pt;line-height:
  107%'>&lt;modules</span></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:35.7pt;text-indent:-19.6pt'><span style='line-height:109%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>In web.config, add the <b><span style='font-size:9.0pt;
line-height:109%;background:#FAFAFA'>&gt;</span></b> section.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=191
src=".NET%20Framework%20Notes%20for%20Professionals_files/image328.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:35.7pt;text-indent:-19.6pt'><span style='line-height:109%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Add a folder named &quot;locale&quot; to the root of your site.
Create a subfolder for each culture you wish to support.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=65 style='width:48.6pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=43 valign=top style='width:.45in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>locale</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>/</span></p>
  </td>
  <td width=14 valign=top style='width:.15in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>fr</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:30.5pt'>For example, <span style='font-size:9.0pt;line-height:109%;
color:#666666;background:#FAFAFA'>//</span>.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=79 style='width:59.4pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>messages</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>.</span></p>
  </td>
  <td width=14 valign=top style='width:.15in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>po</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:35.7pt;text-indent:-19.6pt'><span style='line-height:109%'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>In each culture-specific folder, create a text file named .</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=79 style='width:59.4pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>messages</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>.</span></p>
  </td>
  <td width=14 valign=top style='width:.15in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>po</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:35.7pt;text-indent:-19.6pt'><span style='line-height:109%'>5.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>For testing purposes, enter the following lines of text in your
file:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src=".NET%20Framework%20Notes%20for%20Professionals_files/image329.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:35.7pt;text-indent:-19.6pt'><span style='line-height:109%'>6.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Add a controller to your project which returns some text to
translate.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=240
src=".NET%20Framework%20Notes%20for%20Professionals_files/image330.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:35.7pt;text-indent:-19.6pt'><span style='line-height:109%'>7.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Run your MVC application and browse to the route corresponding to
your controller action, such as <u><span style='color:#1889D0'>http://localhost:[yourportnumber]/default</span></u>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:30.5pt'>Observe that the URL is changed to reflect your default
culture, such as <u><span style='color:#1889D0'>http://localhost:[yourportnumber]/en/default</span></u>.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=144 style='width:1.5in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=14 valign=top style='width:.15in;background:#FAFAFA;padding:1.0pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>en</span></p>
  </td>
  <td width=115 valign=top style='width:1.2in;padding:1.0pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>/</span> in the URL with <span
  style='font-size:9.0pt;line-height:107%;color:#666666;background:#FAFAFA'>/</span></p>
  </td>
  <td width=14 valign=top style='width:.15in;background:#FAFAFA;padding:1.0pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>fr</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:35.7pt;text-indent:-19.6pt'><span style='line-height:109%'>8.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Replace <span style='font-size:9.0pt;line-height:109%;color:#666666;
background:#FAFAFA'>//</span> (or whatever culture you've selected.) The page
should now display the translated version of your text.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=50 style='width:37.8pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=50 valign=top style='width:37.8pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#0600FF'>default</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:35.7pt;text-indent:-19.6pt'><span style='line-height:109%'>9.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Change your browser's language setting to prefer your alternate
culture and browse to <span style='font-size:9.0pt;line-height:109%;color:#666666;
background:#FAFAFA'>/</span> again. Observe that the URL is changed to reflect
your alternate culture and the translated text appears.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:35.7pt;text-indent:-19.6pt'><span style='line-height:109%'>10.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>In
web.config, add handlers so that users cannot browse to your <span
style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>locale</span>
folder.</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=256
src=".NET%20Framework%20Notes%20for%20Professionals_files/image331.gif"></span><br
clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc281531">Chapter 30: System.Net.Mail</a></h1>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:2.5pt;margin-left:
-.25pt'><a name="_Toc281532">Section 30.1: MailMessage</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>Here is the example of creating of mail message with
attachments. After creating we send this message with the help of <span
style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>SmtpClient</span>
class. Default 25 port is used here.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
0in;margin-left:-.45pt;text-indent:0in;line-height:107%'><img border=0
width=719 height=879 id="Picture 275300"
src=".NET%20Framework%20Notes%20for%20Professionals_files/image332.gif"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=136
src=".NET%20Framework%20Notes%20for%20Professionals_files/image333.gif"></span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc281533">Section 30.2: Mail with Attachment</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'><span style='font-size:9.0pt;line-height:109%;background:
#FAFAFA'>MailMessage</span> represents mail message which can be sent further
using <span style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>SmtpClient</span>
class. Several attachments (files) can be added to mail message.</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=174
src=".NET%20Framework%20Notes%20for%20Professionals_files/image334.gif"></span><br
clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc281534">Chapter 31: Using
Progress&lt;T&gt; and IProgress&lt;T&gt;</a></h1>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:2.5pt;margin-left:
-.25pt'><a name="_Toc281535">Section 31.1: Simple Progress reporting</a></h2>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=86 style='width:.9in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=86 valign=top style='width:.9in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>IProgress</span><span style='font-size:9.0pt;line-height:107%;
  color:#666666'>&lt;</span><span style='font-size:9.0pt;line-height:107%'>T</span><span
  style='font-size:9.0pt;line-height:107%;color:#666666'>&gt;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal align=right style='margin-top:0in;margin-right:11.45pt;
margin-bottom:1.85pt;margin-left:.5pt;text-align:right;line-height:107%'>can
be used to report progress of some procedure to another procedure. This example
shows how</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>you can create a basic method that reports its progress.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=289
src=".NET%20Framework%20Notes%20for%20Professionals_files/image335.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>Output:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=190
src=".NET%20Framework%20Notes%20for%20Professionals_files/image336.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=151 style='width:113.4pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=151 valign=top style='width:113.4pt;background:#FAFAFA;padding:
  1.8pt 0in 0in 0in;height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>IProgress</span><span style='font-size:9.0pt;line-height:107%;
  color:#666666'>&lt;</span><span style='font-size:9.0pt;line-height:107%'>T</span><span
  style='font-size:9.0pt;line-height:107%;color:#666666'>&gt;.</span><span
  style='font-size:9.0pt;line-height:107%'>Report</span><span style='font-size:
  9.0pt;line-height:107%;color:#666666'>()</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:17.1pt;margin-bottom:
1.6pt;margin-left:113.95pt;text-indent:-113.4pt'>Note that when you this code
runs, you may see numbers be output out of order. This is because the method
is run asynchronously, and is therefore not as suitable for situations where
the</p>

<p class=MsoNormal style='margin-top:0in;margin-right:265.05pt;margin-bottom:
0in;margin-left:1.05pt;line-height:145%'>progress must be reported in order.</p>

<h2 style='margin-top:0in;margin-right:265.05pt;margin-bottom:0in;margin-left:
1.05pt;margin-bottom:.0001pt;line-height:145%'><a name="_Toc281536">Section
31.2: Using IProgress&lt;T&gt;</a></h2>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=339 style='width:254.25pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=130 valign=top style='width:1.35in;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>System</span><span style='font-size:9.0pt;line-height:107%;color:#666666'>.</span><span
  style='font-size:9.0pt;line-height:107%'>Progress</span><span
  style='font-size:9.0pt;line-height:107%;color:#666666'>&lt;</span><span
  style='font-size:9.0pt;line-height:107%'>T</span><span style='font-size:9.0pt;
  line-height:107%;color:#666666'>&gt;</span></p>
  </td>
  <td width=152 valign=top style='width:113.85pt;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'>class does not have the </p>
  </td>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Report</span><span style='font-size:9.0pt;line-height:107%;color:#666666'>()</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>It's important to note that the method available on it.
This</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=86 style='width:.9in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=86 valign=top style='width:.9in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>IProgress</span><span style='font-size:9.0pt;line-height:107%;
  color:#666666'>&lt;</span><span style='font-size:9.0pt;line-height:107%'>T</span><span
  style='font-size:9.0pt;line-height:107%;color:#666666'>&gt;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>method was implemented explicitly from the interface, and
therefore must be called on a</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=291 style='width:218.4pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=79 valign=top style='width:59.4pt;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Progress</span><span style='font-size:9.0pt;line-height:107%;
  color:#666666'>&lt;</span><span style='font-size:9.0pt;line-height:107%'>T</span><span
  style='font-size:9.0pt;line-height:107%;color:#666666'>&gt;</span></p>
  </td>
  <td width=126 valign=top style='width:94.2pt;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'>when it's cast to an </p>
  </td>
  <td width=86 valign=top style='width:.9in;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>IProgress</span><span style='font-size:9.0pt;line-height:107%;
  color:#666666'>&lt;</span><span style='font-size:9.0pt;line-height:107%'>T</span><span
  style='font-size:9.0pt;line-height:107%;color:#666666'>&gt;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>.</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=112
src=".NET%20Framework%20Notes%20for%20Professionals_files/image337.gif"></span></p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=38
src=".NET%20Framework%20Notes%20for%20Professionals_files/image338.gif"></span><br
clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc281537">Chapter 32: JSON
Serialization</a></h1>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:2.5pt;margin-left:
-.25pt'><a name="_Toc281538">Section 32.1: Deserialization using
System.Web.Script.Serialization.JavaScriptSerializer</a></h2>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=302 style='width:3.15in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=302 valign=top style='width:3.15in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>JavaScriptSerializer</span><span style='font-size:9.0pt;line-height:
  107%;color:#666666'>.</span><span style='font-size:9.0pt;line-height:107%'>Deserialize</span><span
  style='font-size:9.0pt;line-height:107%;color:#666666'>&lt;</span><span
  style='font-size:9.0pt;line-height:107%'>T</span><span style='font-size:9.0pt;
  line-height:107%;color:#666666'>&gt;(</span><span style='font-size:9.0pt;
  line-height:107%'>input</span><span style='font-size:9.0pt;line-height:107%;
  color:#666666'>)</span></p>
  </td>
 </tr>
</table>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=22 style='width:16.2pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=22 valign=top style='width:16.2pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><b><span style='font-size:9.0pt;line-height:
  107%'>&lt;T&gt;</span></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>The method attempts to deserialize a string of valid JSON
into an object of the specified type , using the default mappings natively
supported by <span style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>JavaScriptSerializer</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.25pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=207
src=".NET%20Framework%20Notes%20for%20Professionals_files/image339.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:124.65pt;margin-bottom:
0in;margin-left:1.05pt;line-height:146%'>Note: The <span style='font-size:9.0pt;
line-height:146%;background:#FAFAFA'>JavaScriptSerializer</span> object was
introduced in .NET version 3.5</p>

<h2 style='margin-top:0in;margin-right:124.65pt;margin-bottom:0in;margin-left:
1.05pt;margin-bottom:.0001pt;line-height:146%'><a name="_Toc281539">Section
32.2: Serialization using Json.NET</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=256
src=".NET%20Framework%20Notes%20for%20Professionals_files/image340.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.55pt;
margin-left:1.05pt'>Notice how properties (and classes) can be decorated with
attributes to change their appearance in resulting json string or to remove
them from json string at all (JsonIgnore).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.9pt;
margin-left:1.05pt'>More information about Json.NET serialization attributes
can be found <a
href="http://www.newtonsoft.com/json/help/html/serializationattributes.htm"><span
style='color:#1889D0'>here</span></a>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>In C#, public identifiers are written in <i>PascalCase</i>
by convention. In JSON, the convention is to use <i>camelCase</i> for all
names. You can use a contract resolver to convert between the two.</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=142
src=".NET%20Framework%20Notes%20for%20Professionals_files/image341.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=186
src=".NET%20Framework%20Notes%20for%20Professionals_files/image342.gif"></span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:3.25pt;margin-left:
-.25pt'><a name="_Toc281540">Section 32.3: Serialization-Deserialization using
Newtonsoft.Json</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:14.2pt;
margin-left:1.05pt'>Unlike the other helpers, this one uses static class
helpers to serialize and deserialize, hence it is a little bit easier than the
others to use.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.55pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%;color:#0600FF'>using</span><span style='font-size:9.0pt;line-height:110%'>
Newtonsoft</span><span style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>Json</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:32.65pt;margin-bottom:
22.95pt;margin-left:3.5pt;line-height:110%'><span style='position:relative;
z-index:-1895763968'><span style='left:0px;position:absolute;left:0px;
top:-63549px;width:718px;height:1px'><img width=718 height=1
src=".NET%20Framework%20Notes%20for%20Professionals_files/image115.gif"></span></span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>var</span><span
style='font-size:9.0pt;line-height:110%'> rawJSON </span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>=</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#A60000'>&quot;{</span><b><span style='font-size:9.0pt;
line-height:110%;color:teal'>\&quot;</span></b><span style='font-size:9.0pt;
line-height:110%;color:#A60000'>Name</span><b><span style='font-size:9.0pt;
line-height:110%;color:teal'>\&quot;</span></b><span style='font-size:9.0pt;
line-height:110%;color:#A60000'>:</span><b><span style='font-size:9.0pt;
line-height:110%;color:teal'>\&quot;</span></b><span style='font-size:9.0pt;
line-height:110%;color:#A60000'>Fibonacci Sequence</span><b><span
style='font-size:9.0pt;line-height:110%;color:teal'>\&quot;</span></b><span
style='font-size:9.0pt;line-height:110%;color:#A60000'>,</span><b><span
style='font-size:9.0pt;line-height:110%;color:teal'>\&quot;</span></b><span
style='font-size:9.0pt;line-height:110%;color:#A60000'>Numbers</span><b><span
style='font-size:9.0pt;line-height:110%;color:teal'>\&quot;</span></b><span
style='font-size:9.0pt;line-height:110%;color:#A60000'>:[0, 1, 1, 2, 3, 5, 8,
13]}&quot;</span><span style='font-size:9.0pt;line-height:110%;color:#666666'>;
</span><span style='font-size:9.0pt;line-height:110%;color:#0600FF'>var</span><span
style='font-size:9.0pt;line-height:110%'> fibo </span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>=</span><span
style='font-size:9.0pt;line-height:110%'> JsonConvert</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>DeserializeObject</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>&lt;</span><span
style='font-size:9.0pt;line-height:110%'>Dictionary</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>&lt;</span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>string</span><span
style='font-size:9.0pt;line-height:110%'>, </span><span style='font-size:9.0pt;
line-height:110%;color:#0600FF'>object</span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>&gt;&gt;(</span><span style='font-size:9.0pt;
line-height:110%'>rawJSON</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>); </span><span style='font-size:9.0pt;line-height:110%;
color:#0600FF'>var</span><span style='font-size:9.0pt;line-height:110%'>
rawJSON2 </span><span style='font-size:9.0pt;line-height:110%;color:#666666'>=</span><span
style='font-size:9.0pt;line-height:110%'> JsonConvert</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>SerializeObject</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%'>fibo</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>);</span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc281541">Section 32.4:
Deserialization using Json.NET</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=174
src=".NET%20Framework%20Notes%20for%20Professionals_files/image343.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.9pt;
margin-left:1.05pt'>For more information, refer to the <a
href="http://www.newtonsoft.com/json"><span style='color:#1889D0'>Json.NET
official site</span></a>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:237.0pt;margin-bottom:
0in;margin-left:1.05pt;line-height:145%'>Note: Json.NET supports .NET version 2
and higher.</p>

<h2 style='margin-top:0in;margin-right:237.0pt;margin-bottom:0in;margin-left:
1.05pt;margin-bottom:.0001pt;line-height:145%'><a name="_Toc281542">Section
32.5: Dynamic binding</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.8pt;
margin-left:1.05pt'>Newtonsoft's Json.NET allows you to bind json dynamically
(using ExpandoObject / Dynamic objects) without the need to create the type
explicitly.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:.75pt;line-height:107%'><b>Serialization</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=76
src=".NET%20Framework%20Notes%20for%20Professionals_files/image344.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:.75pt;line-height:107%'><b>De-serialization</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:21.85pt;margin-bottom:
.25pt;margin-left:3.5pt;line-height:110%'><span style='position:relative;
z-index:-1895762944'><span style='left:0px;position:absolute;left:0px;
top:-64158px;width:718px;height:1px'><img width=718 height=1
src=".NET%20Framework%20Notes%20for%20Professionals_files/image345.gif"></span></span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>var</span><span
style='font-size:9.0pt;line-height:110%'> rawJson </span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>=</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#A60000'>&quot;{</span><b><span style='font-size:9.0pt;
line-height:110%;color:teal'>\&quot;</span></b><span style='font-size:9.0pt;
line-height:110%;color:#A60000'>Name</span><b><span style='font-size:9.0pt;
line-height:110%;color:teal'>\&quot;</span></b><span style='font-size:9.0pt;
line-height:110%;color:#A60000'>:</span><b><span style='font-size:9.0pt;
line-height:110%;color:teal'>\&quot;</span></b><span style='font-size:9.0pt;
line-height:110%;color:#A60000'>Fibonacci Sequence</span><b><span
style='font-size:9.0pt;line-height:110%;color:teal'>\&quot;</span></b><span
style='font-size:9.0pt;line-height:110%;color:#A60000'>,</span><b><span
style='font-size:9.0pt;line-height:110%;color:teal'>\&quot;</span></b><span
style='font-size:9.0pt;line-height:110%;color:#A60000'>Numbers</span><b><span
style='font-size:9.0pt;line-height:110%;color:teal'>\&quot;</span></b><span
style='font-size:9.0pt;line-height:110%;color:#A60000'>:[0, 1, 1, 2, 3, 5, 8,
13]}&quot;</span><span style='font-size:9.0pt;line-height:110%;color:#666666'>;
</span><span style='font-size:9.0pt;line-height:110%;color:#0600FF'>dynamic</span><span
style='font-size:9.0pt;line-height:110%'> parsedJson </span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>=</span><span
style='font-size:9.0pt;line-height:110%'> JObject</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>.</span><span style='font-size:9.0pt;
line-height:110%'>Parse</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>(</span><span style='font-size:9.0pt;line-height:110%'>rawJson</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>);</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%'>Console</span><span style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>WriteLine</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%;color:#A60000'>&quot;Name: &quot;</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>+</span><span style='font-size:9.0pt;
line-height:110%'> parsedJson</span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%'>Name</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>);</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:17.25pt;
margin-left:3.5pt;line-height:110%'><span style='position:relative;z-index:
-1895761920'><span style='left:0px;position:absolute;left:0px;top:-64194px;
width:718px;height:1px'><img width=718 height=1
src=".NET%20Framework%20Notes%20for%20Professionals_files/image110.gif"></span></span><span
style='font-size:9.0pt;line-height:110%'>Console</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>.</span><span style='font-size:9.0pt;
line-height:110%'>WriteLine</span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>(</span><span style='font-size:9.0pt;line-height:110%;
color:#A60000'>&quot;Name: &quot;</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>+</span><span style='font-size:9.0pt;line-height:110%'>
parsedJson</span><span style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>Numbers</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>.</span><span style='font-size:9.0pt;
line-height:110%'>Length</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>);</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.9pt;
margin-left:1.05pt'>Notice that the keys in the rawJson object have been turned
into member variables in the dynamic object.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:18.3pt;
margin-left:1.05pt'>This is useful in cases where an application can accept/
produce varying formats of JSON. It is however suggested to use an extra level
of validation for the Json string or to the dynamic object generated as a
result of serialization/ deserialization.</p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:3.25pt;margin-left:
-.25pt'><a name="_Toc281543">Section 32.6: Serialization using Json.NET with
JsonSerializerSettings</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>This serializer has some nice features that the default
.net json serializer doesn't have, like Null value handling, you just need to
create the <span style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>JsonSerializerSettings</span>
:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=720 height=109
src=".NET%20Framework%20Notes%20for%20Professionals_files/image346.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=86 style='width:.9in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>List</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>&lt;</span>&nbsp;</p>
  </td>
  <td width=50 valign=top style='width:37.8pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Student</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>Another serious serializer issue in .net is the self
referencing loop. In the case of a student that is enrolled in a course, its
instance has a course property and a course has a collection of students that
means a <span style='font-size:9.0pt;line-height:109%;color:#666666;background:
#FAFAFA'>&gt; </span>which will create a reference loop. You can handle this
with <span style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>JsonSerializerSettings</span>
:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=109
src=".NET%20Framework%20Notes%20for%20Professionals_files/image347.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>You can put various serializations option like this:</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=720 height=109
src=".NET%20Framework%20Notes%20for%20Professionals_files/image348.gif"></span></p>

<h1 style='margin-left:-.25pt'><a name="_Toc281544">Chapter 33: JSON in .NET
with Newtonsoft.Json</a></h1>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=108 style='width:81.0pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=108 valign=top style='width:81.0pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Newtonsoft</span><span style='font-size:9.0pt;line-height:107%;
  color:#666666'>.</span><span style='font-size:9.0pt;line-height:107%'>Json</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.25pt;
margin-left:-.25pt;text-align:justify;text-justify:inter-ideograph;line-height:
135%'>The NuGet package has become the defacto standard for using and
manipulating JSON formatted text and objects in .NET. It is a robust tool that
is fast, and easy to use.</p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:.25pt;margin-left:
-.25pt;text-align:justify;text-justify:inter-ideograph;line-height:135%'><a
name="_Toc281545">Section 33.1: Deserialize an object from JSON text</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src=".NET%20Framework%20Notes%20for%20Professionals_files/image349.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:187.3pt;margin-bottom:
0in;margin-left:1.05pt;line-height:145%'>This yields a <span style='font-size:
9.0pt;line-height:145%;background:#FAFAFA'>Person</span> object with Name
&quot;Joe Smith&quot; and Age 21.</p>

<h2 style='margin-top:0in;margin-right:187.3pt;margin-bottom:0in;margin-left:
1.05pt;margin-bottom:.0001pt;line-height:145%'><a name="_Toc281546">Section
33.2: Serialize object into JSON</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.45pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=142
src=".NET%20Framework%20Notes%20for%20Professionals_files/image350.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>This results in this JSON: <span style='font-size:9.0pt;
line-height:109%;color:#666666'>{</span><span style='font-size:9.0pt;
line-height:109%;color:#3366CC'>&quot;Name&quot;</span><span style='font-size:
9.0pt;line-height:109%;color:#666666'>:</span><span style='font-size:9.0pt;
line-height:109%;color:#3366CC'>&quot;Joe Smith&quot;</span><span
style='font-size:9.0pt;line-height:109%;color:#666666'>,</span><span
style='font-size:9.0pt;line-height:109%;color:#3366CC'>&quot;Age&quot;</span><span
style='font-size:9.0pt;line-height:109%;color:#666666'>:</span><span
style='font-size:9.0pt;line-height:109%;color:#CC0000'>21</span><span
style='font-size:9.0pt;line-height:109%;color:#666666'>}</span><br clear=all
style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc281547">Chapter 34: XmlSerializer</a></h1>

<h2 style='margin-left:-.25pt'><a name="_Toc281548">Section 34.1: Formatting:
Custom DateTime format</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=720 height=256
src=".NET%20Framework%20Notes%20for%20Professionals_files/image351.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc281549">Section 34.2: Serialize
object</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=142
src=".NET%20Framework%20Notes%20for%20Professionals_files/image352.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc281550">Section 34.3: Deserialize
object</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=142
src=".NET%20Framework%20Notes%20for%20Professionals_files/image353.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc281551">Section 34.4: Behaviour:
Map array name to property (XmlArray)</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:16.6pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=109
src=".NET%20Framework%20Notes%20for%20Professionals_files/image354.gif"></span></p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=70
src=".NET%20Framework%20Notes%20for%20Professionals_files/image355.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=38
src=".NET%20Framework%20Notes%20for%20Professionals_files/image356.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc281552">Section 34.5: Behaviour:
Map Element name to Property</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:16.6pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src=".NET%20Framework%20Notes%20for%20Professionals_files/image357.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=109
src=".NET%20Framework%20Notes%20for%20Professionals_files/image358.gif"></span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:3.5pt;margin-left:
-.25pt'><a name="_Toc281553">Section 34.6: E&#57380;ciently building multiple
serializers with derived types specified dynamically</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.35pt;
margin-left:.75pt;line-height:107%'><b>Where we came from</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>Sometimes we can't provide all of the required metadata
needed for the XmlSerializer framework in attribute.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.8pt;
margin-left:1.05pt'>Suppose we have a base class of serialized objects, and
some of the derived classes are unknown to the base class. We can't place an
attribute for all of the classes which are not know at the design time of the
base type. We could have another team developing some of the derived classes.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.35pt;
margin-left:.75pt;line-height:107%'><b>What can we do</b></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=245 style='width:2.55in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=122 valign=top style='width:91.8pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#0600FF'>new</span><span style='font-size:9.0pt;line-height:107%'>
  XmlSerializer</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>(</span></p>
  </td>
  <td width=115 valign=top style='width:1.2in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>type, knownTypes</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:14.2pt;
margin-left:1.05pt'>We can use <span style='font-size:9.0pt;line-height:109%;
color:#666666;background:#FAFAFA'>)</span>, but that would be a O(N^2)
operation for N serializers, at least to discover all of the types supplied in
arguments:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:135.25pt;margin-bottom:
17.2pt;margin-left:3.5pt;line-height:110%'><span style='position:relative;
z-index:-1895760896'><span style='left:0px;position:absolute;left:0px;
top:-66889px;width:718px;height:1px'><img width=718 height=1
src=".NET%20Framework%20Notes%20for%20Professionals_files/image162.gif"></span></span><i><span
style='font-size:9.0pt;line-height:110%;color:darkgreen'>// Beware of the N^2
in terms of the number of types. </span></i><span style='font-size:9.0pt;
line-height:110%;color:#0600FF'>var</span><span style='font-size:9.0pt;
line-height:110%'> allSerializers </span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>=</span><span style='font-size:9.0pt;
line-height:110%'> allTypes</span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%;
color:#0600FF'>Select</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>(</span><span style='font-size:9.0pt;line-height:110%'>t </span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>=&gt;</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#0600FF'>new</span><span style='font-size:9.0pt;
line-height:110%'> XmlSerializer</span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>(</span><span style='font-size:9.0pt;line-height:110%'>t,
allTypes</span><span style='font-size:9.0pt;line-height:110%;color:#666666'>));
</span><span style='font-size:9.0pt;line-height:110%;color:#0600FF'>var</span><span
style='font-size:9.0pt;line-height:110%'> serializerDictionary </span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>=</span><span
style='font-size:9.0pt;line-height:110%'> Enumerable</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>Range</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>(</span><span style='font-size:9.0pt;
line-height:110%;color:red'>0</span><span style='font-size:9.0pt;line-height:
110%'>, allTypes</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%'>Length</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>) </span><span
style='font-size:9.0pt;line-height:110%'></span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>.</span><span style='font-size:9.0pt;
line-height:110%'>ToDictionary </span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>(</span><span style='font-size:9.0pt;line-height:110%'>i </span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>=&gt;</span><span
style='font-size:9.0pt;line-height:110%'> allTypes</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>[</span><span
style='font-size:9.0pt;line-height:110%'>i</span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>]</span><span style='font-size:9.0pt;
line-height:110%'>, i </span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>=&gt;</span><span style='font-size:9.0pt;line-height:110%'>
allSerializers</span><span style='font-size:9.0pt;line-height:110%;color:#666666'>[</span><span
style='font-size:9.0pt;line-height:110%'>i</span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>])</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:13.15pt;
margin-left:1.05pt'>In this example, the the Base type is not aware of it's
derived types, which is normal in OOP.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.35pt;
margin-left:.75pt;line-height:107%'><b>Doing it efficiently</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.55pt;
margin-left:1.05pt'>Luckily, there is a method which addresses this particular
problem - supplying known types for multiple serializers efficiently:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.15pt;
margin-left:-.25pt;line-height:107%'><a
href="https://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlserializer.fromtypes(v=vs.110).aspx#Anchor_1"><span
style='color:#1889D0'>System.Xml.Serialization.XmlSerializer.FromTypes Method
(Type[])</span></a></p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=721 height=178
src=".NET%20Framework%20Notes%20for%20Professionals_files/image359.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
0in;margin-left:-.45pt;text-indent:0in;line-height:107%'><img border=0
width=719 height=1029 id="Picture 275305"
src=".NET%20Framework%20Notes%20for%20Professionals_files/image360.gif"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=21
src=".NET%20Framework%20Notes%20for%20Professionals_files/image361.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:21.8pt;
margin-left:1.05pt'>Output:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>Trying to serialize without a
derived class metadata:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>&lt;?xml
version=&quot;1.0&quot; encoding=&quot;utf-16&quot;?&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>System.InvalidOperationException:
The type Program+Derived was not expected. Use the XmlInclude or SoapInclude
attribute to specify types that are not known statically.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:14.7pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>at
Microsoft.Xml.Serialization.GeneratedAssembly.XmlSerializationWriter1.Write2_Base(String
n, String ns, Base o, Boolean isNullable, Boolean needType) at
Microsoft.Xml.Serialization.GeneratedAssembly.XmlSerializationWriter1.Write3_Container(String
n, String ns, Container o, Boolean isNullable, Boolean needType) at
Microsoft.Xml.Serialization.GeneratedAssembly.XmlSerializationWriter1.Write4_Container(Object
o) at System.Xml.Serialization.XmlSerializer.Serialize(XmlWriter xmlWriter,
Object o, XmlSerializerNamespaces namespaces, String encodingStyle, String id)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:90.55pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='position:relative;
z-index:-1895759872'><span style='left:0px;position:absolute;left:0px;
top:-68577px;width:718px;height:1px'><img width=718 height=1
src=".NET%20Framework%20Notes%20for%20Professionals_files/image362.gif"></span></span><span
style='font-size:9.0pt;line-height:110%;font-family:"DejaVu Sans Mono"'>--- End
of inner exception stack trace --at
System.Xml.Serialization.XmlSerializer.Serialize(XmlWriter xmlWriter, Object o,
XmlSerializerNamespaces namespaces, String encodingStyle, String id) at
System.Xml.Serialization.XmlSerializer.Serialize(XmlWriter xmlWriter, Object o,
XmlSerializerNamespaces namespaces, String encodingStyle) at
System.Xml.Serialization.XmlSerializer.Serialize(XmlWriter xmlWriter, Object o,
XmlSerializerNamespaces namespaces) at Program.Serialize[T](T o) at
Program.Main() Now trying to serialize with all of the type information:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
24.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>&lt;?xml
version=&quot;1.0&quot; encoding=&quot;utf-16&quot;?&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>0</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
24.2pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>0</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
14.15pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>Slides down well this time!</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.35pt;
margin-left:.75pt;line-height:107%'><b>What's in the output</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:10.45pt;
margin-left:1.05pt'>This error message recommends what we tried to avoid (or
what we can not do in some scenarios) - referencing derived types from base
class:</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=648 style='width:6.75in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=648 valign=top style='width:6.75in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Use the XmlInclude or SoapInclude attribute to specify types that are
  not known statically</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal align=right style='margin-top:0in;margin-right:47.15pt;
margin-bottom:13.75pt;margin-left:0in;text-align:right;text-indent:0in;
line-height:107%'><span style='font-size:9.0pt;line-height:107%;color:#666666;
background:#FAFAFA'>.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:.15in;
margin-left:1.05pt'>This is how we get our derived class in the XML:</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=173 style='width:1.8in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=101 valign=top style='width:1.05in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><b><span style='font-size:9.0pt;line-height:
  107%'>&lt;Base</span></b><span style='font-size:9.0pt;line-height:107%;
  color:#666666'> </span><span style='font-size:9.0pt;line-height:107%;
  color:#000066'>xsi:type</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>=</span></p>
  </td>
  <td width=65 valign=top style='width:48.6pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:red'>&quot;Derived&quot;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.95pt;
margin-left:1.8in;text-indent:0in;line-height:107%'><b><span style='font-size:
9.0pt;line-height:107%;background:#FAFAFA'>&gt;</span></b>&nbsp;</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.55pt;
margin-left:1.05pt'><span style='font-size:9.0pt;line-height:109%;color:#0600FF;
background:#FAFAFA'>Base</span> corresponds to the property type declared in
the <span style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>Container</span>
type, and <span style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>Derived</span>
being the type of the instance actually supplied.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>Here is a working <a href="https://dotnetfiddle.net/hufepI"><span
style='color:#1889D0'>example fiddle</span></a></p>

<h1 style='margin-left:-.25pt'><a name="_Toc281554">Chapter 35: VB Forms</a></h1>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:2.5pt;margin-left:
-.25pt'><a name="_Toc281555">Section 35.1: Hello World in VB.NET Forms</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>To show a message box when the form has been shown:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=207
src=".NET%20Framework%20Notes%20for%20Professionals_files/image363.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.55pt;
margin-left:1.05pt'>Load() will be called first, and only once, when the form
first loads. Show() will be called every time the user launches the form.
Activate() will be called every time the user makes the form active.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:25.45pt;margin-bottom:
.25pt;margin-left:-.25pt;text-align:justify;text-justify:inter-ideograph;
line-height:135%'>Load() will execute before Show() is called, but be warned:
calling msgBox() in show can cause that msgBox() to execute before Load() is
finished. <b>It is generally a bad idea to depend on event ordering between
Load(), Show(), and similar.</b></p>

<h2 style='margin-top:0in;margin-right:25.45pt;margin-bottom:.25pt;margin-left:
-.25pt;text-align:justify;text-justify:inter-ideograph;line-height:135%'><a
name="_Toc281556">Section 35.2: For Beginners</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.9pt;
margin-left:1.05pt'>Some things all beginners should know / do that will help
them have a good start with VB .Net:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>Set the following Options:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=158
src=".NET%20Framework%20Notes%20for%20Professionals_files/image364.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.9pt;
margin-left:1.05pt'><a
href="https://msdn.microsoft.com/en-us/library/te2585xw.aspx?f=255&amp;MSPPError=-2147217396"><span
style='color:#1889D0'>Use &amp;, not + for string concatenation.</span></a><a
href="https://msdn.microsoft.com/en-us/library/system.string(v=vs.110).aspx"><span
style='color:black;text-decoration:none'> </span></a><a
href="https://msdn.microsoft.com/en-us/library/system.string(v=vs.110).aspx"><span
style='color:#1889D0'>Strings</span></a> should be studied in some detail as
they are widely used.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.9pt;
margin-left:1.05pt'>Spend some time understanding <a
href="https://msdn.microsoft.com/en-us/library/t63sy5hs.aspx"><span
style='color:#1889D0'>Value and Reference Types</span></a>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.55pt;
margin-left:1.05pt'>Never use <a
href="https://msdn.microsoft.com/en-us/library/system.windows.forms.application.doevents%28v=vs.110%29.aspx?f=255&amp;MSPPError=-2147217396"><span
style='color:#1889D0'>Application.DoEvents</span></a>. Pay attention to the
'Caution'. When you reach a point where this seems like something you must use,
ask.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:316.4pt;margin-bottom:
0in;margin-left:-.25pt;line-height:145%'>The <a
href="https://social.msdn.microsoft.com/Search/en-US?query=vb%20.net&amp;emptyWatermark=true&amp;searchButtonTooltip=Search%20MSDN&amp;ac=2"><span
style='color:#1889D0'>documentation</span></a> is your friend.</p>

<h2 style='margin-top:0in;margin-right:316.4pt;margin-bottom:0in;margin-left:
-.25pt;margin-bottom:.0001pt;line-height:145%'><a name="_Toc281557">Section
35.3: Forms Timer</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>The <a
href="https://msdn.microsoft.com/en-us/library/system.windows.forms.timer(v=vs.110).aspx"><span
style='color:#1889D0'>Windows.Forms.Timer</span></a> component can be used to
provide the user information that is <b>not</b> time critical. Create a form
with one button, one label, and a Timer component.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>For example it could be used to show the user the time of
day periodically.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=339
src=".NET%20Framework%20Notes%20for%20Professionals_files/image365.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>But this timer is not suited for timing. An example would
be using it for a countdown. In this example we will simulate a countdown to
three minutes. This may very well be one of the most boringly important
examples here.</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=552
src=".NET%20Framework%20Notes%20for%20Professionals_files/image366.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.55pt;
margin-left:1.05pt'>After button1 is clicked, about three minutes pass and
label1 shows the results. Does label1 show 180? Probably not. On my machine it
showed 182.5!</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.55pt;
margin-left:1.05pt'>The reason for the discrepancy is in the documentation,
&quot;The Windows Forms Timer component is single-threaded, and is limited to
an accuracy of 55 milliseconds.&quot; This is why it shouldn't be used for
timing.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>By using the timer and stopwatch a little differently we
can obtain better results.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=519
src=".NET%20Framework%20Notes%20for%20Professionals_files/image367.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>There are other timers that can be used as needed. This <a
href="https://social.msdn.microsoft.com/Search/en-US?query=vb%20.net%20windows%20timers&amp;emptyWatermark=true&amp;searchButtonTooltip=Search%20MSDN&amp;ac=5#refinementChanges=117&amp;pageNumber=1&amp;showMore=false"><span
style='color:#1889D0'>search</span></a> should help in that regard.</p>

<h1 style='margin-left:-.25pt'><a name="_Toc281558">Chapter 36: JIT compiler</a></h1>

<p class=MsoNormal style='margin-top:0in;margin-right:4.5pt;margin-bottom:.25pt;
margin-left:-.25pt;text-align:justify;text-justify:inter-ideograph;line-height:
135%'>JIT compilation, or just-in-time compilation, is an alternative approach
to interpretation of code or ahead-of-time compilation. JIT compilation is used
in the .NET framework. The CLR code (C#, F#, Visual Basic, etc.) is first
compiled into something called Interpreted Language, or IL. This is lower level
code that is closer to machine code, but is not platform specific. Rather, at
runtime, this code is compiled into machine code for the relevant system.</p>

<h2 style='margin-top:0in;margin-right:4.5pt;margin-bottom:.25pt;margin-left:
-.25pt;text-align:justify;text-justify:inter-ideograph;line-height:135%'><a
name="_Toc281559">Section 36.1: IL compilation sample</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>Simple Hello World Application:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=207
src=".NET%20Framework%20Notes%20for%20Professionals_files/image368.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:21.8pt;
margin-left:1.05pt'>Equivalent IL Code (which will be JIT compiled)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:150.15pt;margin-bottom:
36.1pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>// Microsoft (R) .NET
Framework IL Disassembler. Version 4.6.1055.0 // Copyright (c) Microsoft
Corporation. All rights reserved.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>// Metadata version:
v4.0.30319</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>.assembly extern mscorlib</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:101.4pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>{ .publickeytoken = (B7 7A 5C
56 19 34 E0 89 ) // .z\V.4..</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>.ver 4:0:0:0</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>.assembly HelloWorld</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>{</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>.custom instance void</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>[mscorlib]System.Runtime.CompilerServices.CompilationRelaxationsAttribute::.ctor(int32)
= ( 01 00</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>08 00 00 00 00 00 )</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>.custom instance void</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>[mscorlib]System.Runtime.CompilerServices.RuntimeCompatibilityAttribute::.ctor()
= ( 01 00 01 00</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:171.8pt;margin-bottom:
12.2pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>54 02 16 57 72 61 70 4E 6F 6E
45 78 // ....T..WrapNonEx 63 65 70 74 69 6F 6E 54 68 72 6F 77 73 01 )
// ceptionThrows.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>// --- The following custom
attribute is added automatically, do not uncomment -------</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>// .custom instance void
[mscorlib]System.Diagnostics.DebuggableAttribute::.ctor(valuetype</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
12.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>[mscorlib]System.Diagnostics.DebuggableAttribute/DebuggingModes)
= ( 01 00 07 01 00 00 00 00 )</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='position:relative;
z-index:-1895758848'><span style='left:0px;position:absolute;left:0px;
top:-72635px;width:718px;height:1px'><img width=718 height=1
src=".NET%20Framework%20Notes%20for%20Professionals_files/image369.gif"></span></span><span
style='font-size:9.0pt;line-height:110%;font-family:"DejaVu Sans Mono"'>.custom
instance void [mscorlib]System.Reflection.AssemblyTitleAttribute::.ctor(string)
= ( 01 00 0A 48 65 6C 6C 6F 57 6F 72 6C 64 00 00 ) // ...HelloWorld..</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>.custom instance void
[mscorlib]System.Reflection.AssemblyDescriptionAttribute::.ctor(string) = (</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>01 00 00 00 00 )</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>.custom instance void
[mscorlib]System.Reflection.AssemblyConfigurationAttribute::.ctor(string) =</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>( 01 00 00 00 00 )</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>.custom instance void
[mscorlib]System.Reflection.AssemblyCompanyAttribute::.ctor(string) = ( 01</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>00 00 00 00 )</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>.custom instance void
[mscorlib]System.Reflection.AssemblyProductAttribute::.ctor(string) = ( 01 00
0A 48 65 6C 6C 6F 57 6F 72 6C 64 00 00 ) // ...HelloWorld..</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='position:relative;
z-index:-1895757824'><span style='left:0px;position:absolute;left:0px;
top:-72805px;width:718px;height:1px'><img width=718 height=1
src=".NET%20Framework%20Notes%20for%20Professionals_files/image370.gif"></span></span><span
style='font-size:9.0pt;line-height:110%;font-family:"DejaVu Sans Mono"'>.custom
instance void
[mscorlib]System.Reflection.AssemblyCopyrightAttribute::.ctor(string) = ( 01 00
12 43 6F 70 79 72 69 67 68 74 20 C2 A9 20 // ...Copyright ..</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>20 32 30 31 37 00 00
) // 2017..</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>.custom instance void
[mscorlib]System.Reflection.AssemblyTrademarkAttribute::.ctor(string) = ( 01</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>00 00 00 00 )</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>.custom instance void
[mscorlib]System.Runtime.InteropServices.ComVisibleAttribute::.ctor(bool) =</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>( 01 00 00 00 00 )</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>.custom instance void
[mscorlib]System.Runtime.InteropServices.GuidAttribute::.ctor(string) = ( 01</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>00 24 33 30 38 62 33 64 38 36
2D 34 31 37 32 // ..$308b3d86-4172</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:150.15pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>2D 34 30 32 32 2D 61 66 63 63
2D 33 66 38 65 33 // -4022-afcc-3f8e3 32 33 33 63 35 62 30 00 00
) // 233c5b0..</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>.custom instance void
[mscorlib]System.Reflection.AssemblyFileVersionAttribute::.ctor(string) = ( 01
00 07 31 2E 30 2E 30 2E 30 00 00 ) // ...1.0.0.0..</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>.custom instance void
[mscorlib]System.Runtime.Versioning.TargetFrameworkAttribute::.ctor(string)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:128.5pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>= ( 01 00 1C 2E 4E 45 54 46 72
61 6D 65 77 6F 72 6B // ....NETFramework 2C 56 65 72 73 69 6F 6E 3D 76 34 2E
35 2E 32 01 // ,Version=v4.5.2.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>00 54 0E 14 46 72 61 6D 65 77
6F 72 6B 44 69 73 // .T..FrameworkDis</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>70 6C 61 79 4E 61 6D 65 14 2E
4E 45 54 20 46 72 // playName..NET Fr</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>61 6D 65 77 6F 72 6B 20 34 2E
35 2E 32 ) // amework 4.5.2</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>.hash algorithm 0x00008004</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>.ver 1:0:0:0</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>.module HelloWorld.exe</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>// MVID:
{2A7E1D59-1272-4B47-85F6-D7E1ED057831}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>.imagebase 0x00400000</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>.file alignment 0x00000200</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>.stackreserve 0x00100000</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>.subsystem 0x0003 //
WINDOWS_CUI</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>.corflags 0x00020003 //
ILONLY 32BITPREFERRED</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
24.25pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>// Image base:
0x0000021C70230000</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
12.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>// =============== CLASS
MEMBERS DECLARATION ===================</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:215.15pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>.class private auto ansi
beforefieldinit HelloWorld.Program extends [mscorlib]System.Object {</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>.method private hidebysig
static void Main(string[] args) cil managed</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>{</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>.entrypoint</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>// Code size 13 (0xd)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>.maxstack 8</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>IL_0000: nop</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>IL_0001: ldstr
&quot;Hello World&quot;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>IL_0006: call void
[mscorlib]System.Console::WriteLine(string)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>IL_000b: nop</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>IL_000c: ret</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
12.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>} // end of method
Program::Main</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:263.95pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>.method public hidebysig
specialname rtspecialname instance void .ctor() cil managed {</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>// Code size 8 (0x8)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>.maxstack 8</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>IL_0000: ldarg.0</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>IL_0001: call instance
void [mscorlib]System.Object::.ctor()</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>IL_0006: nop</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>IL_0007: ret</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
12.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>} // end of method
Program::.ctor</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.85pt;margin-bottom:
.3pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;font-family:"DejaVu Sans Mono"'>} // end of class
HelloWorld.Program</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>Generated with MS ILDASM tool (IL disassembler)<br
clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc281560">Chapter 37: CLR</a></h1>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:2.75pt;margin-left:
-.25pt'><a name="_Toc281561">Section 37.1: An introduction to Common Language
Runtime</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.75pt;
margin-left:1.05pt'>The <b>Common Language Runtime (CLR)</b> is a virtual
machine environment and part of the .NET Framework. It contains:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:21.4pt'><img width=5 height=1
src=".NET%20Framework%20Notes%20for%20Professionals_files/image291.gif"
align=left hspace=12>A portable bytecode language called <b>Common Intermediate
Language</b> (abbreviated CIL, or IL)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:21.4pt'>A Just-In-Time compiler that generates machine code</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:21.4pt'>A tracing garbage collector that provides automatic memory
management</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:21.4pt'>Support for lightweight sub-processes called AppDomains</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.9pt;
margin-left:21.4pt'>Security mechanisms through the concepts of verifiable code
and trust levels</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>Code that runs in the CLR is referred to as <i>managed code</i>
to distinguish it from code running outside the CLR (usually native code) which
is referred to as <i>unmanaged code</i>. There are various mechanisms that
facilitate interoperability between managed and unmanaged code.<br clear=all
style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc281562">Chapter 38: TPL Dataflow</a></h1>

<h2 style='margin-left:-.25pt'><a name="_Toc281563">Section 38.1: Asynchronous
Producer Consumer With A Bounded Bu&#57379;erBlock</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=470
src=".NET%20Framework%20Notes%20for%20Professionals_files/image371.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc281564">Section 38.2: Posting to an
ActionBlock and waiting for completion</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=720 height=223
src=".NET%20Framework%20Notes%20for%20Professionals_files/image372.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc281565">Section 38.3: Linking
blocks to create a pipeline</a></h2>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=83
src=".NET%20Framework%20Notes%20for%20Professionals_files/image373.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.55pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%'> </span><span style='font-size:9.0pt;line-height:110%;color:#0600FF'>async</span><span
style='font-size:9.0pt;line-height:110%'> uri </span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>=&gt;</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:#0600FF'>await</span><span style='font-size:9.0pt;line-height:110%'>
httpClient</span><span style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>GetStringAsync</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%'>uri</span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>));</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:159.75pt;margin-bottom:
12.45pt;margin-left:3.5pt;line-height:110%'><span style='position:relative;
z-index:-1895755776'><span style='left:0px;position:absolute;left:0px;
top:-75231px;width:718px;height:1px'><img width=718 height=1
src=".NET%20Framework%20Notes%20for%20Professionals_files/image374.gif"></span></span><i><span
style='font-size:9.0pt;line-height:110%;color:darkgreen'>// Create a block that
accepts the content and prints it to the console </span></i><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>var</span><span
style='font-size:9.0pt;line-height:110%'> printerBlock </span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>=</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#0600FF'>new</span><span style='font-size:9.0pt;
line-height:110%'> ActionBlock</span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>&lt;</span><span style='font-size:9.0pt;line-height:110%;
color:#0600FF'>string</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>&gt;( </span><span style='font-size:9.0pt;line-height:110%'>contents
</span><span style='font-size:9.0pt;line-height:110%;color:#666666'>=&gt;</span><span
style='font-size:9.0pt;line-height:110%'> Console</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>.</span><span style='font-size:9.0pt;
line-height:110%'>WriteLine</span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>(</span><span style='font-size:9.0pt;line-height:110%'>contents</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>));</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:108.2pt;margin-bottom:
12.45pt;margin-left:3.5pt;line-height:110%'><i><span style='font-size:9.0pt;
line-height:110%;color:darkgreen'>// Make the downloaderBlock complete the
printerBlock when its completed. </span></i><span style='font-size:9.0pt;
line-height:110%;color:#0600FF'>var</span><span style='font-size:9.0pt;
line-height:110%'> dataflowLinkOptions </span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>=</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:#0600FF'>new</span><span style='font-size:9.0pt;line-height:110%'>
DataflowLinkOptions </span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>{</span><span style='font-size:9.0pt;line-height:110%'>PropagateCompletion
</span><span style='font-size:9.0pt;line-height:110%;color:#666666'>=</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#0600FF'>true</span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>};</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:139.7pt;margin-bottom:
12.45pt;margin-left:3.5pt;line-height:110%'><i><span style='font-size:9.0pt;
line-height:110%;color:darkgreen'>// Link the block to create a pipeline </span></i><span
style='font-size:9.0pt;line-height:110%'>downloaderBlock</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>LinkTo</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>(</span><span style='font-size:9.0pt;
line-height:110%'>printerBlock, dataflowLinkOptions</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>);</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.25pt;
margin-left:3.5pt;line-height:110%'><i><span style='font-size:9.0pt;line-height:
110%;color:darkgreen'>// Post urls to the first block which will pass their
contents to the second one.</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:75.85pt;margin-bottom:
12.45pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%'>downloaderBlock</span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>.</span><span style='font-size:9.0pt;
line-height:110%'>Post</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>(</span><span style='font-size:9.0pt;line-height:110%;
color:#A60000'>&quot;http://youtube.com&quot;</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>); </span><span style='font-size:9.0pt;
line-height:110%'>downloaderBlock</span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>.</span><span style='font-size:9.0pt;
line-height:110%'>Post</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>(</span><span style='font-size:9.0pt;line-height:110%;
color:#A60000'>&quot;http://github.com&quot;</span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>); </span><span style='font-size:9.0pt;
line-height:110%'>downloaderBlock</span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>.</span><span style='font-size:9.0pt;
line-height:110%'>Post</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>(</span><span style='font-size:9.0pt;line-height:110%;
color:#A60000'>&quot;http://twitter.com&quot;</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>);</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.25pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%'>downloaderBlock</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%'>Complete</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>();</span><span
style='font-size:9.0pt;line-height:110%'> </span><i><span style='font-size:
9.0pt;line-height:110%;color:darkgreen'>// Completion will propagate to
printerBlock</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:23.0pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%;color:#0600FF'>await</span><span style='font-size:9.0pt;line-height:110%'>
printerBlock</span><span style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>Completion</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>;</span><span
style='font-size:9.0pt;line-height:110%'> </span><i><span style='font-size:
9.0pt;line-height:110%;color:darkgreen'>// Only need to wait for the last block
in the pipeline</span></i></p>

<h2 style='margin-left:-.25pt'><a name="_Toc281566">Section 38.4: Synchronous
Producer/Consumer with Bu&#57379;erBlock&lt;T&gt;</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
0in;margin-left:-.45pt;text-indent:0in;line-height:107%'><img border=0
width=719 height=632 id="Picture 275310"
src=".NET%20Framework%20Notes%20for%20Professionals_files/image375.gif"></p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=136
src=".NET%20Framework%20Notes%20for%20Professionals_files/image376.gif"></span><br
clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc281567">Chapter 39: Threading</a></h1>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:2.5pt;margin-left:
-.25pt'><a name="_Toc281568">Section 39.1: Accessing form controls from other
threads</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:23.75pt;
margin-left:1.05pt'>If you want to change an attribute of a control such as a
textbox or label from another thread than the GUI thread that created the
control, you will have to invoke it or else you might get an error message
stating:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:6.2pt;margin-bottom:23.75pt;
margin-left:24.5pt'><img width=3 height=1
src=".NET%20Framework%20Notes%20for%20Professionals_files/image377.gif"
align=left hspace=12>&quot;Cross-thread operation not valid: Control
'control_name' accessed from a thread other than the thread it was created
on.&quot;</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>Using this example code on a system.windows.forms form will
cast an exception with that message:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=174
src=".NET%20Framework%20Notes%20for%20Professionals_files/image378.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>Instead when you want to change a textbox's text from
within a thread that doesn't own it use Control.Invoke or Control.BeginInvoke.
You can also use Control.InvokeRequired to check if invoking the control is
necessary.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=125
src=".NET%20Framework%20Notes%20for%20Professionals_files/image379.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>If you need to do this often, you can write an extension
for invokeable objects to reduce the amount of code necessary to make this
check:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=720 height=174
src=".NET%20Framework%20Notes%20for%20Professionals_files/image380.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>And updating the textbox from any thread becomes a bit
simpler:</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=76
src=".NET%20Framework%20Notes%20for%20Professionals_files/image381.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.55pt;
margin-left:1.05pt'>Be aware that Control.BeginInvoke as used in this example
is asynchronous, meaning that code coming after a call to Control.BeginInvoke
can be run immedeately after, whether or not the passed delegate has been
executed yet.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>If you need to be sure that textBox1 is updated before
continuing, use Control.Invoke instead, which will block the calling thread
until your delegate has been executed. Do note that this approach can slow your
code down significantly if you make many invoke calls and note that it will
deadlock your application if your GUI thread is waiting for the calling thread
to complete or release a held resource.<br clear=all style='page-break-before:
always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc281569">Chapter 40: Process and
Thread a&#57380;nity setting</a></h1>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.8pt;
margin-left:0in;text-indent:0in;line-height:107%'><b>Parameter Details</b></p>

<p class=MsoNormal align=right style='margin-top:0in;margin-right:2.75pt;
margin-bottom:0in;margin-left:.5pt;text-align:right;line-height:107%'>integer
that describes the set of processors on which the process is allowed to run.
For example, on a 8</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:21.1pt;
margin-left:55.95pt;text-indent:-55.4pt'>affinity processor system
if you want your process to be executed only on processors 3 and 4 than you
choose affinity like this : 00001100 which equals 12</p>

<h2 style='margin-left:-.25pt'><a name="_Toc281570">Section 40.1: Get process
a&#57380;nity mask</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=535
src=".NET%20Framework%20Notes%20for%20Professionals_files/image382.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>Example of usage :</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=142
src=".NET%20Framework%20Notes%20for%20Professionals_files/image383.gif"></span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:4.2pt;margin-left:
-.25pt'><a name="_Toc281571">Section 40.2: Set process a&#57380;nity mask</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;line-height:110%'><span style='position:relative;z-index:
-1895753728'><span style='left:0px;position:absolute;left:0px;top:-78372px;
width:718px;height:1px'><img width=718 height=1
src=".NET%20Framework%20Notes%20for%20Professionals_files/image384.gif"></span></span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:
9.0pt;line-height:110%;color:#0600FF'>public</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:#0600FF'>static</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>void</span><span
style='font-size:9.0pt;line-height:110%'> SetProcessAffinityMask</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>int</span><span
style='font-size:9.0pt;line-height:110%'> affinity, </span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>string</span><span
style='font-size:9.0pt;line-height:110%'> processName </span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>=</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#0600FF'>null</span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=169
src=".NET%20Framework%20Notes%20for%20Professionals_files/image385.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>Example of usage :</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=174
src=".NET%20Framework%20Notes%20for%20Professionals_files/image386.gif"></span><br
clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc281572">Chapter 41: Parallel
processing using .Net framework</a></h1>

<p class=MsoNormal style='margin-top:0in;margin-right:10.3pt;margin-bottom:
.25pt;margin-left:-.25pt;text-align:justify;text-justify:inter-ideograph;
line-height:135%'>This Topic is about Multi core programming using Task
Parallel Library with .NET framework. The task parallel library allows you to
write code which is human readable and adjusts itself with the number of Cores
available. So you can be sure that your software would auto-upgrade itself with
the upgrading environment.</p>

<h2 style='margin-top:0in;margin-right:10.3pt;margin-bottom:.25pt;margin-left:
-.25pt;text-align:justify;text-justify:inter-ideograph;line-height:135%'><a
name="_Toc281573">Section 41.1: Parallel Extensions</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>Parallel extensions have been introduced along with the
Task Parallel Library to achieve data Parallelism. Data parallelism refers to
scenarios in which the same operation is performed concurrently (that is, in
parallel) on elements in a source collection or array. The .NET provides new
constructs to achieve data parallelism by using Parallel.For and
Parallel.Foreach constructs.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=191
src=".NET%20Framework%20Notes%20for%20Professionals_files/image387.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>The above mentioned Parallel.ForEach construct utilizes the
multiple cores and thus enhances the performance in the same fashion.</p>

<h1 style='margin-left:-.25pt'><a name="_Toc281574">Chapter 42: Task Parallel
Library (TPL)</a></h1>

<h2 style='margin-left:-.25pt'><a name="_Toc281575">Section 42.1: Basic
producer-consumer loop (BlockingCollection)</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=223
src=".NET%20Framework%20Notes%20for%20Professionals_files/image388.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=202 style='width:2.1in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=202 valign=top style='width:2.1in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>collection</span><span style='font-size:9.0pt;line-height:107%;
  color:#666666'>.</span><span style='font-size:9.0pt;line-height:107%'>CompleteAdding</span><span
  style='font-size:9.0pt;line-height:107%;color:#666666'>();</span></p>
  </td>
 </tr>
</table>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=202 style='width:2.1in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=202 valign=top style='width:2.1in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>collection</span><span style='font-size:9.0pt;line-height:107%;
  color:#666666'>.</span><span style='font-size:9.0pt;line-height:107%'>CompleteAdding</span><span
  style='font-size:9.0pt;line-height:107%;color:#666666'>();</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>It is worth noting that if you do not call , you are able
to keep adding to the collection even if your consumer task is running. Just
call when you are sure there</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>are no more additions. This functionality can be used to
make a Multiple Producer to a Single Consumer pattern where you have multiple
sources feeding items into the BlockingCollection and a single consumer pulling
items out and doing something with them. If your BlockingCollection is empty
before you call complete adding, the</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=252 style='width:189.0pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=252 valign=top style='width:189.0pt;background:#FAFAFA;padding:
  1.8pt 0in 0in 0in;height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>collection</span><span style='font-size:9.0pt;line-height:107%;
  color:#666666'>.</span><span style='font-size:9.0pt;line-height:107%'>GetConsumingEnumerable</span><span
  style='font-size:9.0pt;line-height:107%;color:#666666'>()</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>Enumerable from will block until a new item is added to
the collection or</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>BlockingCollection.CompleteAdding(); is called and the
queue is empty.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=207
src=".NET%20Framework%20Notes%20for%20Professionals_files/image389.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc281576">Section 42.2:
Parallel.Invoke</a></h2>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=254
src=".NET%20Framework%20Notes%20for%20Professionals_files/image390.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=21
src=".NET%20Framework%20Notes%20for%20Professionals_files/image391.gif"></span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:2.55pt;margin-left:
-.25pt'><a name="_Toc281577">Section 42.3: Task: Returning a value</a></h2>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=101 style='width:1.05in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Task</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>&lt;</span>&nbsp;</p>
  </td>
  <td width=65 valign=top style='width:48.6pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>TResult </span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>Task that return a value has return type of <span
style='font-size:9.0pt;line-height:109%;color:#666666;background:#FAFAFA'>&gt;</span>
where TResult is the type of value that needs to be returned. You can query the
outcome of a Task by its Result property.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=191
src=".NET%20Framework%20Notes%20for%20Professionals_files/image392.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>If the Task execute asynchronously than awaiting the Task
returns it's result.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=720 height=109
src=".NET%20Framework%20Notes%20for%20Professionals_files/image393.gif"></span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:2.5pt;margin-left:
-.25pt'><a name="_Toc281578">Section 42.4: Parallel.ForEach</a></h2>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=115 style='width:1.2in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Parallel</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>.</span></p>
  </td>
  <td width=50 valign=top style='width:37.8pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#0600FF'>ForEach</span></p>
  </td>
 </tr>
</table>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=108 style='width:81.0pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=79 valign=top style='width:59.4pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Interlocked</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>.</span></p>
  </td>
  <td width=22 valign=top style='width:16.2pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#0600FF'>Add</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>This example uses to calculate the sum of the numbers
between 1 and 10000 by using multiple threads. To achieve thread-safety, is
used to sum the numbers.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=207
src=".NET%20Framework%20Notes%20for%20Professionals_files/image394.gif"></span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:2.5pt;margin-left:
-.25pt'><a name="_Toc281579">Section 42.5: Parallel.For</a></h2>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=86 style='width:.9in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Parallel</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>.</span></p>
  </td>
  <td width=22 valign=top style='width:16.2pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#0600FF'>For</span></p>
  </td>
 </tr>
</table>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=108 style='width:81.0pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=79 valign=top style='width:59.4pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Interlocked</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>.</span></p>
  </td>
  <td width=22 valign=top style='width:16.2pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#0600FF'>Add</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>This example uses to calculate the sum of the numbers
between 1 and 10000 by using multiple threads. To achieve thread-safety, is
used to sum the numbers.</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=113
src=".NET%20Framework%20Notes%20for%20Professionals_files/image395.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=87
src=".NET%20Framework%20Notes%20for%20Professionals_files/image396.gif"></span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:2.6pt;margin-left:
-.25pt'><a name="_Toc281580">Section 42.6: Task: basic instantiation and Wait</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>A task can be created by directly instantiating the <span
style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>Task</span>
class...</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=191
src=".NET%20Framework%20Notes%20for%20Professionals_files/image397.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=58 style='width:.6in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Task</span><span style='font-size:9.0pt;line-height:107%;color:#666666'>.</span><span
  style='font-size:9.0pt;line-height:107%'>Run</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>...or by using the static method:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=158
src=".NET%20Framework%20Notes%20for%20Professionals_files/image398.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:18.7pt;
margin-left:1.05pt'>Note that only in the first case it is necessary to
explicitly invoke <span style='font-size:9.0pt;line-height:109%;background:
#FAFAFA'>Start</span>.</p>

<h2 style='margin-left:-.25pt'><a name="_Toc281581">Section 42.7: Task.WhenAll</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=207
src=".NET%20Framework%20Notes%20for%20Professionals_files/image399.gif"></span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:2.5pt;margin-left:
-.25pt'><a name="_Toc281582">Section 42.8: Flowing execution context with
AsyncLocal</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>When you need to pass some data from the parent task to its
children tasks, so it logically flows with the execution, use <span
style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>AsyncLocal</span> <a
href="https://msdn.microsoft.com/en-us/library/dn906268(v=vs.110).aspx"><span
style='color:#1889D0'>class</span></a>:</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=39
src=".NET%20Framework%20Notes%20for%20Professionals_files/image400.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.3pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=719 height=514
src=".NET%20Framework%20Notes%20for%20Professionals_files/image401.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=108 style='width:81.0pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=108 valign=top style='width:81.0pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>AsynLocal</span><span style='font-size:9.0pt;line-height:107%;
  color:#666666'>.</span><span style='font-size:9.0pt;line-height:107%;
  color:#0600FF'>Value</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'><b>Note:</b> As can be seen from the example above has <span
style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>copy on read</span>
semantic, but if you flow some</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:18.3pt;
margin-left:1.05pt'>reference type and change its properties you will affect
other tasks. Hence, best practice with <span style='font-size:9.0pt;line-height:
109%;background:#FAFAFA'>AsyncLocal</span> is to use value types or immutable
types.</p>

<h2 style='margin-left:-.25pt'><a name="_Toc281583">Section 42.9:
Parallel.ForEach in VB.NET</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=174
src=".NET%20Framework%20Notes%20for%20Professionals_files/image402.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc281584">Section 42.10: Task:
WaitAll and variable capturing</a></h2>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=149
src=".NET%20Framework%20Notes%20for%20Professionals_files/image403.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=38
src=".NET%20Framework%20Notes%20for%20Professionals_files/image404.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc281585">Section 42.11: Task:
WaitAny</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=223
src=".NET%20Framework%20Notes%20for%20Professionals_files/image405.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:19.0pt;
margin-left:1.05pt'><b>Note:</b> The final <span style='font-size:9.0pt;
line-height:109%;background:#FAFAFA'>WaitAll</span> is necessary becasue <span
style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>WaitAny</span> does
not cause exceptions to be observed.</p>

<h2 style='margin-left:-.25pt'><a name="_Toc281586">Section 42.12: Task:
handling exceptions (using Wait)</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=437
src=".NET%20Framework%20Notes%20for%20Professionals_files/image406.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc281587">Section 42.13: Task:
handling exceptions (without using Wait)</a></h2>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=123
src=".NET%20Framework%20Notes%20for%20Professionals_files/image407.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=317
src=".NET%20Framework%20Notes%20for%20Professionals_files/image408.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc281588">Section 42.14: Task:
cancelling using CancellationToken</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.25pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=720 height=552
src=".NET%20Framework%20Notes%20for%20Professionals_files/image409.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>As an alternative to <span style='font-size:9.0pt;
line-height:109%;background:#FAFAFA'>ThrowIfCancellationRequested</span>, the
cancellation request can be detected with <span style='font-size:9.0pt;
line-height:109%;background:#FAFAFA'>IsCancellationRequested</span> and a <span
style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>OperationCanceledException</span>
can be thrown manually:</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=32
src=".NET%20Framework%20Notes%20for%20Professionals_files/image410.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.1pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=153
src=".NET%20Framework%20Notes%20for%20Professionals_files/image411.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>Note how the cancellation token is passed to the task
constructor in the <span style='font-size:9.0pt;line-height:109%;background:
#FAFAFA'>cancellationToken</span> parameter. This is needed so that the task
transitions to the <span style='font-size:9.0pt;line-height:109%;background:
#FAFAFA'>Canceled</span> state, not to the <span style='font-size:9.0pt;
line-height:109%;background:#FAFAFA'>Faulted</span> state, when</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:18.5pt;
margin-left:1.05pt'><span style='font-size:9.0pt;line-height:109%;background:
#FAFAFA'>ThrowIfCancellationRequested</span> is invoked. Also, for the same
reason, the cancellation token is explicitly supplied in the constructor of <span
style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>OperationCanceledException</span>
in the second case.</p>

<h2 style='margin-left:-.25pt'><a name="_Toc281589">Section 42.15: Task.WhenAny</a></h2>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=240
src=".NET%20Framework%20Notes%20for%20Professionals_files/image412.gif"></span></p>

<h1 style='margin-left:-.25pt'><a name="_Toc281590">Chapter 43: Task Parallel
Library (TPL) API Overviews</a></h1>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:3.25pt;margin-left:
-.25pt'><a name="_Toc281591">Section 43.1: Perform work in response to a button
click and update the UI</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>This example demonstrates how you can respond to a button
click by performing some work on a worker thread and then update the user
interface to indicate completion</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=720 height=240
src=".NET%20Framework%20Notes%20for%20Professionals_files/image413.gif"></span><br
clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc281592">Chapter 44: Synchronization
Contexts</a></h1>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:3.45pt;margin-left:
-.25pt'><a name="_Toc281593">Section 44.1: Execute code on the UI thread after
performing background work</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>This example shows how to update a UI component from a
background thread by using a <span style='font-size:9.0pt;line-height:109%;
background:#FAFAFA'>SynchronizationContext</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=720 height=306
src=".NET%20Framework%20Notes%20for%20Professionals_files/image414.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=101 style='width:1.05in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=101 valign=top style='width:1.05in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>MyTextBox</span><span style='font-size:9.0pt;line-height:107%;
  color:#666666'>.</span><span style='font-size:9.0pt;line-height:107%'>Text</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>In this example, if you tried to directly update inside
the <span style='font-size:9.0pt;line-height:109%;color:#0600FF;background:
#FAFAFA'>for</span> loop, you would get a threading error.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.5pt;
margin-left:1.05pt'>By posting the <span style='font-size:9.0pt;line-height:
109%;background:#FAFAFA'>UpdateCallback</span> action to the <span
style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>SynchronizationContext</span>,
the text box is updated on the same thread as the rest of the UI.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=137 style='width:102.6pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=137 valign=top style='width:102.6pt;background:#FAFAFA;padding:
  1.8pt 0in 0in 0in;height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>System</span><span style='font-size:9.0pt;line-height:107%;color:#666666'>.</span><span
  style='font-size:9.0pt;line-height:107%'>IProgress</span><span
  style='font-size:9.0pt;line-height:107%;color:#666666'>&lt;</span><span
  style='font-size:9.0pt;line-height:107%'>T</span><span style='font-size:9.0pt;
  line-height:107%;color:#666666'>&gt;</span></p>
  </td>
 </tr>
</table>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=130 style='width:1.35in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=130 valign=top style='width:1.35in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>System</span><span style='font-size:9.0pt;line-height:107%;color:#666666'>.</span><span
  style='font-size:9.0pt;line-height:107%'>Progress</span><span
  style='font-size:9.0pt;line-height:107%;color:#666666'>&lt;</span><span
  style='font-size:9.0pt;line-height:107%'>T</span><span style='font-size:9.0pt;
  line-height:107%;color:#666666'>&gt;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>In practice, progress updates should be performed using an
instance of . The default implementation automatically captures the
synchronisation context it is created on.</p>

<h1 style='margin-left:-.25pt'><a name="_Toc281594">Chapter 45: Memory
management</a></h1>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:3.35pt;margin-left:
-.25pt'><a name="_Toc281595">Section 45.1: Use SafeHandle when wrapping
unmanaged resources</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>When writing wrappers for unmanaged resources, you should
subclass <span style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>SafeHandle</span>
rather than trying to implement <span style='font-size:9.0pt;line-height:109%;
background:#FAFAFA'>IDisposable</span> and a finalizer yourself. Your <span
style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>SafeHandle</span>
subclass should be as small and simple as possible to minimize the chance of a
handle leak. This likely means that your SafeHandle implementation would an
internal implementation detail of a class which wraps it to provide a usable
API. This class ensures that, even if a program leaks your <span
style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>SafeHandle</span>
instance, your unmanaged handle is released.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=322
src=".NET%20Framework%20Notes%20for%20Professionals_files/image415.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:9.65pt;margin-bottom:
.25pt;margin-left:-.25pt;text-align:justify;text-justify:inter-ideograph;
line-height:135%'>Disclaimer: This example is an attempt to show how to guard a
managed resource with <span style='font-size:9.0pt;line-height:135%;background:
#FAFAFA'>SafeHandle</span> which implements <span style='font-size:9.0pt;
line-height:135%;background:#FAFAFA'>IDisposable</span> for you and configures
finalizers appropriately. It is very contrived and likely pointless to allocate
a chunk of memory in this manner.</p>

<h2 style='margin-top:0in;margin-right:9.65pt;margin-bottom:.25pt;margin-left:
-.25pt;text-align:justify;text-justify:inter-ideograph;line-height:135%'><a
name="_Toc281596">Section 45.2: Unmanaged Resources</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>When we talk about the GC and the &quot;heap&quot;, we're
really talking about what's called the <i>managed heap</i>. Objects on the <i>managed
heap</i> can access resources not on the managed heap, for example, when
writing to or reading from a file. Unexpected behavior can occur when, a file
is opened for reading and then an exception occurs, preventing the file handle
from closing as it normally would. For this reason, .NET requires that
unmanaged resources implement the <span style='font-size:9.0pt;line-height:
109%;background:#FAFAFA'>IDisposable</span> interface. This interface has a
single method called <span style='font-size:9.0pt;line-height:109%;background:
#FAFAFA'>Dispose</span> with no parameters:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=76
src=".NET%20Framework%20Notes%20for%20Professionals_files/image416.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=50 style='width:37.8pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=50 valign=top style='width:37.8pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Dispose</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>When handling unmanaged resources, you should make sure
that they are properly disposed. You can do this by explicitly calling <span
style='font-size:9.0pt;line-height:109%;color:#666666;background:#FAFAFA'>()</span>
in a <span style='font-size:9.0pt;line-height:109%;color:#0600FF;background:
#FAFAFA'>finally</span> block, or with a <span style='font-size:9.0pt;
line-height:109%;color:#0600FF;background:#FAFAFA'>using</span> statement.</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=82
src=".NET%20Framework%20Notes%20for%20Professionals_files/image417.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=136
src=".NET%20Framework%20Notes%20for%20Professionals_files/image418.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>or</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=125
src=".NET%20Framework%20Notes%20for%20Professionals_files/image419.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>The latter is the preferred method, and is automatically
expanded to the former during compilation.<br clear=all style='page-break-before:
always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc281597">Chapter 46: Garbage
Collection</a></h1>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.55pt;
margin-left:1.05pt'>In .Net, objects created with new() are allocated on the
managed heap. These objects are never explicitly finalized by the program that
uses them; instead, this process is controlled by the .Net Garbage Collector.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:8.3pt;margin-bottom:.25pt;
margin-left:-.25pt;text-align:justify;text-justify:inter-ideograph;line-height:
135%'>Some of the examples below are &quot;lab cases&quot; to show the Garbage
Collector at work and some significant details of its behavior, while other
focus on how to prepare classes for proper handling by the Garbage Collector.</p>

<h2 style='margin-top:0in;margin-right:8.3pt;margin-bottom:.25pt;margin-left:
-.25pt;text-align:justify;text-justify:inter-ideograph;line-height:135%'><a
name="_Toc281598">Section 46.1: A basic example of (garbage) collection</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>Given the following class:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=207
src=".NET%20Framework%20Notes%20for%20Professionals_files/image420.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>A program that creates an instance, even without using it:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src=".NET%20Framework%20Notes%20for%20Professionals_files/image421.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>Produces the following output:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src=".NET%20Framework%20Notes%20for%20Professionals_files/image422.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.55pt;
margin-left:1.05pt'>If nothing else happens, the object is not finalized until
the program ends (which frees all objects on the managed heap, finalizing these
in the process).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>It is possible to force the Garbage Collector to run at a
given point, as follows:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src=".NET%20Framework%20Notes%20for%20Professionals_files/image423.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>Which produces the following result:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src=".NET%20Framework%20Notes%20for%20Professionals_files/image424.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:19.65pt;margin-bottom:
.25pt;margin-left:-.25pt;text-align:justify;text-justify:inter-ideograph;
line-height:135%'>This time, as soon as the Garbage Collector was invoked, the
unused (aka &quot;dead&quot;) object was finalized and freed from the managed
heap.</p>

<h2 style='margin-top:0in;margin-right:19.65pt;margin-bottom:.25pt;margin-left:
-.25pt;text-align:justify;text-justify:inter-ideograph;line-height:135%'><a
name="_Toc281599">Section 46.2: Live objects and dead objects - the basics</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>Rule of thumb: when garbage collection occurs, &quot;live
objects&quot; are those still in use, while &quot;dead objects&quot; are those
no longer used (any variable or field referencing them, if any, has gone out of
scope before the collection occurs).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>In the following example (for convenience,
FinalizableObject1 and FinalizableObject2 are subclasses of</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:14.55pt;
margin-left:1.05pt'>FinalizableObject from the example above and thus inherit
the initialization / finalization message behavior):</p>

<p class=MsoNormal style='margin-top:0in;margin-right:129.0pt;margin-bottom:
17.2pt;margin-left:3.5pt;line-height:110%'><span style='position:relative;
z-index:-1895752704'><span style='left:0px;position:absolute;left:0px;
top:-89163px;width:718px;height:1px'><img width=718 height=1
src=".NET%20Framework%20Notes%20for%20Professionals_files/image162.gif"></span></span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>var</span><span
style='font-size:9.0pt;line-height:110%'> obj1 </span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>=</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:#0600FF'>new</span><span style='font-size:9.0pt;line-height:110%'>
FinalizableObject1</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>();</span><span style='font-size:9.0pt;line-height:110%'> </span><i><span
style='font-size:9.0pt;line-height:110%;color:darkgreen'>// Finalizable1
instance allocated here </span></i><span style='font-size:9.0pt;line-height:
110%;color:#0600FF'>var</span><span style='font-size:9.0pt;line-height:110%'>
obj2 </span><span style='font-size:9.0pt;line-height:110%;color:#666666'>=</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#0600FF'>new</span><span style='font-size:9.0pt;
line-height:110%'> FinalizableObject2</span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>();</span><span style='font-size:9.0pt;
line-height:110%'> </span><i><span style='font-size:9.0pt;line-height:110%;
color:darkgreen'>// Finalizable2 instance allocated here </span></i><span
style='font-size:9.0pt;line-height:110%'>obj1 </span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>=</span><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:#0600FF'>null</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>;</span><span style='font-size:9.0pt;line-height:110%'> </span><i><span
style='font-size:9.0pt;line-height:110%;color:darkgreen'>// No more references
to the Finalizable1 instance </span></i><span style='font-size:9.0pt;
line-height:110%'>GC</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%'>Collect</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>();</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>The output will be:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src=".NET%20Framework%20Notes%20for%20Professionals_files/image425.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:26.45pt;margin-bottom:
.25pt;margin-left:-.25pt;text-align:justify;text-justify:inter-ideograph;
line-height:135%'>At the time when the Garbage Collector is invoked,
FinalizableObject1 is a dead object and gets finalized, while
FinalizableObject2 is a live object and it is kept on the managed heap.</p>

<h2 style='margin-top:0in;margin-right:26.45pt;margin-bottom:.25pt;margin-left:
-.25pt;text-align:justify;text-justify:inter-ideograph;line-height:135%'><a
name="_Toc281600">Section 46.3: Multiple dead objects</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>What if two (or several) otherwise dead objects reference
one another? This is shown in the example below, supposing that OtherObject is
a public property of FinalizableObject:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=142
src=".NET%20Framework%20Notes%20for%20Professionals_files/image426.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>This produces the following output:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=76
src=".NET%20Framework%20Notes%20for%20Professionals_files/image427.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:9.75pt;margin-bottom:
.25pt;margin-left:-.25pt;text-align:justify;text-justify:inter-ideograph;
line-height:135%'>The two objects are finalized and freed from the managed heap
despite referencing each other (because no other reference exists to any of
them from an actually live object).</p>

<h2 style='margin-top:0in;margin-right:9.75pt;margin-bottom:.25pt;margin-left:
-.25pt;text-align:justify;text-justify:inter-ideograph;line-height:135%'><a
name="_Toc281601">Section 46.4: Weak References</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.55pt;
margin-left:1.05pt'>Weak references are... references, to other objects (aka
&quot;targets&quot;), but &quot;weak&quot; as they do not prevent those objects
from being garbage-collected. In other words, weak references do not count when
the Garbage Collector evaluates objects as &quot;live&quot; or
&quot;dead&quot;.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>The following code:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src=".NET%20Framework%20Notes%20for%20Professionals_files/image428.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>Produces the output:</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=38
src=".NET%20Framework%20Notes%20for%20Professionals_files/image429.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=21
src=".NET%20Framework%20Notes%20for%20Professionals_files/image430.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.55pt;
margin-left:1.05pt'>The object is freed from the managed heap despite being
referenced by the WeakReference variable (still in scope when the Garbage
collector was invoked).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.55pt;
margin-left:1.05pt'>Consequence #1: at any time, it is unsafe to assume whether
a WeakReference target is still allocated on the managed heap or not.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>Consequence #2: whenever a program needs to access the
target of a Weakreference, code should be provided for both cases, of the
target being still allocated or not. The method to access the target is
TryGetTarget:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=289
src=".NET%20Framework%20Notes%20for%20Professionals_files/image431.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>The generic version of WeakReference is available since
.Net 4.5. All framework versions provide a non-generic, untyped version that is
built in the same way and checked as follows:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=322
src=".NET%20Framework%20Notes%20for%20Professionals_files/image432.gif"></span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:2.5pt;margin-left:
-.25pt'><a name="_Toc281602">Section 46.5: Dispose() vs. finalizers</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>Implement Dispose() method (and declare the containing
class as IDisposable) as a means to ensure any memoryheavy resources are freed
as soon as the object is no longer used. The &quot;catch&quot; is that there is
no strong guarantee the the Dispose() method would ever be invoked (unlike
finalizers that always get invoked at the end of the life of the object).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>One scenario is a program calling Dispose() on objects it
explicitly creates:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=720 height=273
src=".NET%20Framework%20Notes%20for%20Professionals_files/image433.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.55pt;
margin-left:1.05pt'>Another scenario is declaring a class to be instantiated by
the framework. In this case the new class usually inherits a base class, for
instance in MVC one creates a controller class as a subclass of
System.Web.Mvc.ControllerBase. When the base class implements IDisposable
interface, this is a good hint that Dispose() would be invoked properly by the
framework - but again there is no strong guarantee.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.9pt;
margin-left:1.05pt'>Thus Dispose() is not a substitute for a finalizer;
instead, the two should be used for different purposes:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:21.4pt'><img width=5 height=1
src=".NET%20Framework%20Notes%20for%20Professionals_files/image195.gif"
align=left hspace=12>A finalizer eventually frees resources to avoid memory
leaks that would occur otherwise</p>

<p class=MsoNormal style='margin-top:0in;margin-right:8.45pt;margin-bottom:
.25pt;margin-left:-.75pt;text-align:justify;text-justify:inter-ideograph;
text-indent:5.5pt;line-height:135%'>Dispose() frees resources (possibly the
same ones) as soon as these are no longer needed, to ease pressure on overall
memory allocation.</p>

<h2 style='margin-top:0in;margin-right:8.45pt;margin-bottom:.25pt;margin-left:
-.75pt;text-align:justify;text-justify:inter-ideograph;text-indent:5.5pt;
line-height:135%'><a name="_Toc281603">Section 46.6: Proper disposal and
finalization of objects</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.55pt;
margin-left:1.05pt'>As Dispose() and finalizers are aimed to different
purposes, a class managing external memory-heavy resources should implement
both of them. The consequence is writing the class so that it handles well two
possible scenarios:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:21.4pt'><img width=5 height=1
src=".NET%20Framework%20Notes%20for%20Professionals_files/image195.gif"
align=left hspace=12>When only the finalizer is invoked</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.9pt;
margin-left:21.4pt'>When Dispose() is invoked first and later the finalizer is
invoked as well</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.55pt;
margin-left:1.05pt'>One solution is writing the cleanup code in such a way that
running it once or twice would produce the same result as running it only once.
Feasibility depends on the nature of the cleanup, for instance:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:21.4pt'><img width=5 height=1
src=".NET%20Framework%20Notes%20for%20Professionals_files/image195.gif"
align=left hspace=12>Closing an already closed database connection would
probably have no effect so it works</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.55pt;
margin-left:21.4pt'>Updating some &quot;usage count&quot; is dangerous and
would produce a wrong result when called twice instead of once.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>A safer solution is ensuring by design that the cleanup
code is called once and only once whatever the external context. This can be
achieved the &quot;classic way&quot; using a dedicated flag:</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=163
src=".NET%20Framework%20Notes%20for%20Professionals_files/image434.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=136
src=".NET%20Framework%20Notes%20for%20Professionals_files/image435.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>Alternately, the Garbage Collector provides a specific
method SuppressFinalize() that allows skipping the finalizer after Dispose has
been invoked:</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=256
src=".NET%20Framework%20Notes%20for%20Professionals_files/image436.gif"></span><br
clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc281604">Chapter 47: Exceptions</a></h1>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:2.5pt;margin-left:
-.25pt'><a name="_Toc281605">Section 47.1: Catching and rethrowing caught
exceptions</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>When you want to catch an exception and do something, but
you can't continue execution of the current block of code because of the
exception, you may want to rethrow the exception to the next exception handler
in the call stack. There are good ways and bad ways to do this.</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=720 height=860
src=".NET%20Framework%20Notes%20for%20Professionals_files/image437.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=87
src=".NET%20Framework%20Notes%20for%20Professionals_files/image438.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.55pt;
margin-left:1.05pt'>You can filter by exception type and even by exception
properties (new in C# 6.0, a bit longer available in VB.NET (citation needed)):</p>

<p class=MsoNormal style='margin-top:0in;margin-right:247.95pt;margin-bottom:
0in;margin-left:-.25pt;line-height:145%'>Documentation/C#/new features</p>

<h2 style='margin-top:0in;margin-right:247.95pt;margin-bottom:0in;margin-left:
-.25pt;margin-bottom:.0001pt;line-height:145%'><a name="_Toc281606">Section
47.2: Using a finally block</a></h2>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=397 style='width:297.65pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#0600FF'>finally</span><span style='font-size:9.0pt;line-height:
  107%'> </span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>{</span></p>
  </td>
  <td width=36 valign=top style='width:27.0pt;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'></span><span style='font-size:9.0pt;line-height:107%;color:#666666'>...</span><span
  style='font-size:9.0pt;line-height:107%'> </span></p>
  </td>
  <td width=74 valign=top style='width:55.5pt;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>}</span> block of a </p>
  </td>
  <td width=22 valign=top style='width:16.2pt;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>try</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>-</span></p>
  </td>
  <td width=50 valign=top style='width:37.8pt;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#0600FF'>finally</span></p>
  </td>
  <td width=20 valign=top style='width:15.3pt;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'>or </p>
  </td>
  <td width=22 valign=top style='width:16.2pt;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>try</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>-</span></p>
  </td>
  <td width=36 valign=top style='width:27.0pt;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>catch</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>-</span></p>
  </td>
  <td width=50 valign=top style='width:37.8pt;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#0600FF'>finally</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>The will always execute, regardless of whether an</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=144 style='width:1.5in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=79 valign=top style='width:59.4pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Environment</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>.</span></p>
  </td>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>FailFast</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:8.35pt;margin-bottom:
12.9pt;margin-left:108.55pt;text-indent:-1.5in'>exception occurred or not
(except when a <span style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>StackOverflowException</span>
has been thrown or call has been made to <span style='font-size:9.0pt;
line-height:109%;color:#666666;background:#FAFAFA'>()</span>).</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=72 style='width:.75in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#0600FF'>try</span><span style='font-size:9.0pt;line-height:107%'>
  </span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>{</span></p>
  </td>
  <td width=36 valign=top style='width:27.0pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'></span><span style='font-size:9.0pt;line-height:107%;color:#666666'>...</span><span
  style='font-size:9.0pt;line-height:107%'> </span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>It can be utilized to free or clean up resources acquired
in the <span style='font-size:9.0pt;line-height:109%;color:#666666;background:
#FAFAFA'>}</span> block safely.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=339
src=".NET%20Framework%20Notes%20for%20Professionals_files/image439.gif"></span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:2.6pt;margin-left:
-.25pt'><a name="_Toc281607">Section 47.3: Exception Filters</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:13.0pt;
margin-left:1.05pt'>Since C# 6.0 exceptions can be filtered using the <span
style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>when</span>
operator.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:13.15pt;
margin-left:1.05pt'>This is similar to using a simple <span style='font-size:
9.0pt;line-height:109%;background:#FAFAFA'>if</span> but does not unwind the
stack if the condition inside the <span style='font-size:9.0pt;line-height:
109%;background:#FAFAFA'>when</span> is not met.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:.75pt;line-height:107%'><b>Example</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=142
src=".NET%20Framework%20Notes%20for%20Professionals_files/image440.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>The same info can be found in the C# 6.0 Features here:
Exception filters</p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:2.6pt;margin-left:
-.25pt'><a name="_Toc281608">Section 47.4: Rethrowing an exception within a
catch block</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>Within a <span style='font-size:9.0pt;line-height:109%;
color:#0600FF;background:#FAFAFA'>catch</span> block the <span
style='font-size:9.0pt;line-height:109%;color:#0600FF;background:#FAFAFA'>throw</span>
keyword can be used on its own, without specifying an exception value, to <i>rethrow
</i>the exception which was just caught. Rethrowing an exception allows the
original exception to continue up the exception handling chain, preserving its
call stack or associated data:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=92
src=".NET%20Framework%20Notes%20for%20Professionals_files/image441.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=58 style='width:.6in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#0600FF'>throw</span><span style='font-size:9.0pt;line-height:
  107%'> ex</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>A common anti-pattern is to instead , which has the effect
of limiting the next exception handler's view of the stack trace:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=109
src=".NET%20Framework%20Notes%20for%20Professionals_files/image442.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=58 style='width:.6in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#0600FF'>throw</span><span style='font-size:9.0pt;line-height:
  107%'> ex</span></p>
  </td>
 </tr>
</table>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=58 style='width:.6in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#0600FF'>throw</span><span style='font-size:9.0pt;line-height:
  107%'> ex</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:18.3pt;
margin-left:1.05pt'>In general using isn't desirable, as future exception
handlers which inspect the stack trace will only be able to see calls as far
back as . By omitting the <span style='font-size:9.0pt;line-height:109%;
background:#FAFAFA'>ex</span> variable, and using the <span style='font-size:
9.0pt;line-height:109%;color:#0600FF;background:#FAFAFA'>throw</span> keyword
alone the original exception will <a
href="http://stackoverflow.com/questions/4065893/about-throw-and-exception-bubbling"><span
style='color:#1889D0'>&quot;bubble-up&quot;</span></a>.</p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:3.25pt;margin-left:
-.25pt'><a name="_Toc281609">Section 47.5: Throwing an exception from a
di&#57379;erent method while preserving its information</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>Occasionally you'd want to catch an exception and throw it
from a different thread or method while preserving the original exception
stack. This can be done with <span style='font-size:9.0pt;line-height:109%;
background:#FAFAFA'>ExceptionDispatchInfo</span>:</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=720 height=435
src=".NET%20Framework%20Notes%20for%20Professionals_files/image443.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=21
src=".NET%20Framework%20Notes%20for%20Professionals_files/image444.gif"></span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:2.5pt;margin-left:
-.25pt'><a name="_Toc281610">Section 47.6: Catching an exception</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.9pt;
margin-left:1.05pt'>Code can and should throw exceptions in exceptional
circumstances. Examples of this include:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:1.85pt;
margin-left:21.4pt;line-height:107%'><img width=5 height=1
src=".NET%20Framework%20Notes%20for%20Professionals_files/image195.gif"
align=left hspace=12>Attempting to <a
href="https://msdn.microsoft.com/en-us/library/system.io.endofstreamexception(v=vs.110).aspx"><span
style='color:#1889D0'>read past the end of a stream</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:1.85pt;
margin-left:21.4pt;line-height:107%'><a
href="https://msdn.microsoft.com/en-us/library/system.unauthorizedaccessexception(v=vs.110).aspx"><span
style='color:#1889D0'>Not having necessary permissions</span></a> to access a
file</p>

<p class=MsoNormal style='margin-top:0in;margin-right:185.5pt;margin-bottom:
12.55pt;margin-left:21.4pt'>Attempting to perform an invalid operation, such as
<a
href="https://msdn.microsoft.com/en-us/library/system.dividebyzeroexception(v=vs.110).aspx"><span
style='color:#1889D0'>dividing by zero </span></a><a
href="https://msdn.microsoft.com/en-us/library/system.net.webexception.aspx"><span
style='color:#1889D0'>A timeout occurring</span></a> when downloading a file
from the internet</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.9pt;
margin-left:1.05pt'>The caller can handle these exceptions by
&quot;catching&quot; them, and should only do so when:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:21.4pt'><img width=5 height=1
src=".NET%20Framework%20Notes%20for%20Professionals_files/image195.gif"
align=left hspace=12>It can actually resolve the exceptional circumstance or
recover appropriately, or;</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:21.4pt'>It can provide additional context to the exception that
would be useful if the exception needs to be re-thrown</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.9pt;
margin-left:30.5pt'>(re-thrown exceptions are caught by exception handlers
further up the call stack)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.55pt;
margin-left:1.05pt'>It should be noted that choosing <i>not</i> to catch an
exception is perfectly valid if the intention is for it to be handled at a
higher level.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=72 style='width:.75in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#0600FF'>try</span><span style='font-size:9.0pt;line-height:107%'>
  </span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>{</span></p>
  </td>
  <td width=36 valign=top style='width:27.0pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'></span><span style='font-size:9.0pt;line-height:107%;color:#666666'>...</span><span
  style='font-size:9.0pt;line-height:107%'> </span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>Catching an exception is done by wrapping the
potentially-throwing code in a <span style='font-size:9.0pt;line-height:109%;
color:#666666;background:#FAFAFA'>}</span> block as follows, and catching the
exceptions it's able to handle in a <span style='font-size:11.0pt;line-height:
109%'><img border=0 width=718 height=255
src=".NET%20Framework%20Notes%20for%20Professionals_files/image445.gif"></span><br
clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc281611">Chapter 48:
System.Diagnostics</a></h1>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:4.2pt;margin-left:
-.25pt'><a name="_Toc281612">Section 48.1: Run shell commands</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:162.25pt;margin-bottom:
6.35pt;margin-left:0in;text-align:justify;text-justify:inter-ideograph;
text-indent:3.75pt;line-height:176%'><span style='position:relative;z-index:
-1895746560'><span style='left:0px;position:absolute;left:0px;top:-96245px;
width:718px;height:1px'><img width=718 height=1
src=".NET%20Framework%20Notes%20for%20Professionals_files/image136.gif"></span></span><span
style='font-size:9.0pt;line-height:176%;color:#0600FF'>string</span><span
style='font-size:9.0pt;line-height:176%'> strCmdText </span><span
style='font-size:9.0pt;line-height:176%;color:#666666'>=</span><span
style='font-size:9.0pt;line-height:176%'> </span><span style='font-size:9.0pt;
line-height:176%;color:#A60000'>&quot;/C copy /b Image1.jpg + Archive.rar
Image2.jpg&quot;</span><span style='font-size:9.0pt;line-height:176%;
color:#666666'>; </span><span style='font-size:9.0pt;line-height:176%'>System.Diagnostics</span><span
style='font-size:9.0pt;line-height:176%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:176%'>Process</span><span style='font-size:
9.0pt;line-height:176%;color:#666666'>.</span><span style='font-size:9.0pt;
line-height:176%'>Start</span><span style='font-size:9.0pt;line-height:176%;
color:#666666'>(</span><span style='font-size:9.0pt;line-height:176%;
color:#A60000'>&quot;CMD.exe&quot;</span><span style='font-size:9.0pt;
line-height:176%'>,strCmdText</span><span style='font-size:9.0pt;line-height:
176%;color:#666666'>); </span>This is to hide the cmd window.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;line-height:
110%'>System.Diagnostics</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%'>Process
process </span><span style='font-size:9.0pt;line-height:110%;color:#666666'>=</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#0600FF'>new</span><span style='font-size:9.0pt;
line-height:110%'> System.Diagnostics</span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>.</span><span style='font-size:9.0pt;
line-height:110%'>Process</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>();</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:48.8pt;margin-bottom:
22.95pt;margin-left:3.5pt;line-height:110%'><span style='position:relative;
z-index:-1895745536'><span style='left:0px;position:absolute;left:0px;
top:-96329px;width:718px;height:1px'><img width=718 height=1
src=".NET%20Framework%20Notes%20for%20Professionals_files/image446.gif"></span></span><span
style='font-size:9.0pt;line-height:110%'>System.Diagnostics</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>ProcessStartInfo startInfo </span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>=</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#0600FF'>new</span><span style='font-size:9.0pt;
line-height:110%'> System.Diagnostics</span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>.</span><span style='font-size:9.0pt;
line-height:110%'>ProcessStartInfo</span><span style='font-size:9.0pt;
line-height:110%;color:#666666'>(); </span><span style='font-size:9.0pt;
line-height:110%'>startInfo</span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%'>WindowStyle
</span><span style='font-size:9.0pt;line-height:110%;color:#666666'>=</span><span
style='font-size:9.0pt;line-height:110%'> System.Diagnostics</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>ProcessWindowStyle</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>Hidden</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>; </span><span style='font-size:9.0pt;
line-height:110%'>startInfo</span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>.</span><span style='font-size:9.0pt;line-height:110%'>FileName
</span><span style='font-size:9.0pt;line-height:110%;color:#666666'>=</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#A60000'>&quot;cmd.exe&quot;</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>; </span><span
style='font-size:9.0pt;line-height:110%'>startInfo</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>Arguments </span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>=</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#A60000'>&quot;/C copy /b Image1.jpg + Archive.rar
Image2.jpg&quot;</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>; </span><span style='font-size:9.0pt;line-height:110%'>process</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>.</span><span
style='font-size:9.0pt;line-height:110%'>StartInfo </span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>=</span><span
style='font-size:9.0pt;line-height:110%'> startInfo</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>; </span><span
style='font-size:9.0pt;line-height:110%'>process</span><span style='font-size:
9.0pt;line-height:110%;color:#666666'>.</span><span style='font-size:9.0pt;
line-height:110%'>Start</span><span style='font-size:9.0pt;line-height:110%;
color:#666666'>();</span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:2.6pt;margin-left:
-.25pt'><a name="_Toc281613">Section 48.2: Send Command to CMD and Receive
Output</a></h2>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=50 style='width:37.8pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=50 valign=top style='width:37.8pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Cmd</span><span style='font-size:9.0pt;line-height:107%;color:#666666'>.</span><span
  style='font-size:9.0pt;line-height:107%'>exe</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>This method allows a <span style='font-size:9.0pt;
line-height:109%;background:#FAFAFA'>command</span> to be sent to , and returns
the standard output (including standard error) as a string:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=720 height=421
src=".NET%20Framework%20Notes%20for%20Professionals_files/image447.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:.75pt;line-height:107%'><b>Usage</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:21.85pt;margin-bottom:
.25pt;margin-left:3.5pt;line-height:110%'><span style='font-size:9.0pt;
line-height:110%;color:#0600FF'>var</span><span style='font-size:9.0pt;
line-height:110%'> servername </span><span style='font-size:9.0pt;line-height:
110%;color:#666666'>=</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:#A60000'>&quot;SVR-01.domain.co.za&quot;</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:21.85pt;margin-bottom:
17.5pt;margin-left:3.5pt;line-height:110%'><span style='position:relative;
z-index:-1895744512'><span style='left:0px;position:absolute;left:0px;
top:-96968px;width:718px;height:1px'><img width=718 height=1
src=".NET%20Framework%20Notes%20for%20Professionals_files/image136.gif"></span></span><span
style='font-size:9.0pt;line-height:110%;color:#0600FF'>var</span><span
style='font-size:9.0pt;line-height:110%'> currentUsers </span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>=</span><span
style='font-size:9.0pt;line-height:110%'> SendCommand</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>(</span><span
style='font-size:9.0pt;line-height:110%'>$</span><span style='font-size:9.0pt;
line-height:110%;color:#A60000'>&quot;/C QUERY USER /SERVER:{servername}&quot;</span><span
style='font-size:9.0pt;line-height:110%;color:#666666'>)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.05pt;
margin-left:.75pt;line-height:107%'><b>Output</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:0in;text-indent:0in;line-height:123%'><span style='font-size:11.0pt;
line-height:123%'> <img border=0 width=3 height=40 id="Group 264990"
src=".NET%20Framework%20Notes%20for%20Professionals_files/image448.gif"></span> string
currentUsers = &quot;USERNAME SESSIONNAME ID STATE IDLE TIME LOGON TIME
Joe.Bloggs ica-cgp#0 2</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:24.5pt'><img width=3 height=1
src=".NET%20Framework%20Notes%20for%20Professionals_files/image377.gif"
align=left hspace=12>Active 24692+13:29 25/07/2016 07:50 Jim.McFlannegan
ica-cgp#1 3 Active . 25/07/2016 08:33 Andy.McAnderson ica-cgp#2 4 Active .
25/07/2016 08:54 John.Smith ica-cgp#4 5 Active 14 25/07/2016</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:24.5pt'>08:57 Bob.Bobbington ica-cgp#5 6 Active 24692+13:29
25/07/2016 09:05 Tim.Tom ica-cgp#6 7 Active .</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:24.1pt;
margin-left:24.5pt'>25/07/2016 09:08 Bob.Joges ica-cgp#7 8 Active 24692+13:29
25/07/2016 09:13&quot;</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>On some occasions, access to the server in question may be
restricted to certain users. If you have the login credentials for this user,
then it is possible to send queries with this method:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=720 height=519
src=".NET%20Framework%20Notes%20for%20Professionals_files/image449.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>Getting the password:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=191
src=".NET%20Framework%20Notes%20for%20Professionals_files/image450.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.35pt;
margin-left:.75pt;line-height:107%'><b>Notes</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>Both of the above methods will return a concatenation of
STDOUT and STDERR, as <span style='font-size:9.0pt;line-height:109%;background:
#FAFAFA'>OutputDataReceived</span> and <span style='font-size:9.0pt;line-height:
109%;background:#FAFAFA'>ErrorDataReceived</span> are both appending to the
same variable - <span style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>cmdOut</span>.</p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:2.65pt;margin-left:
-.25pt'><a name="_Toc281614">Section 48.3: Stopwatch</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>This example shows how <span style='font-size:9.0pt;
line-height:109%;background:#FAFAFA'>Stopwatch</span> can be used to benchmark
a block of code.</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=486
src=".NET%20Framework%20Notes%20for%20Professionals_files/image451.gif"></span></p>

<h1 style='margin-left:-.25pt'><a name="_Toc281615">Chapter 49: Encryption /
Cryptography</a></h1>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:3.25pt;margin-left:
-.25pt'><a name="_Toc281616">Section 49.1: Encryption and Decryption using
Cryptography (AES)</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>Decryption Code</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=470
src=".NET%20Framework%20Notes%20for%20Professionals_files/image452.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>Encryption Code</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=358
src=".NET%20Framework%20Notes%20for%20Professionals_files/image453.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=87
src=".NET%20Framework%20Notes%20for%20Professionals_files/image454.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>Usage</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=92
src=".NET%20Framework%20Notes%20for%20Professionals_files/image455.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc281617">Section 49.2:
RijndaelManaged</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
0in;margin-left:-.45pt;text-indent:0in;line-height:107%'><img border=0
width=719 height=738 id="Picture 275315"
src=".NET%20Framework%20Notes%20for%20Professionals_files/image456.gif"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=465
src=".NET%20Framework%20Notes%20for%20Professionals_files/image457.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:.75pt;line-height:107%'><b>Usage</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=92
src=".NET%20Framework%20Notes%20for%20Professionals_files/image458.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.35pt;
margin-left:.75pt;line-height:107%'><b>Note:</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:18.65pt;
margin-left:21.4pt'><span style='font-size:11.0pt;line-height:109%'><img
border=0 width=5 height=5 id="Group 265160"
src=".NET%20Framework%20Notes%20for%20Professionals_files/image259.gif"></span>Rijndael
is the predecessor of the standard symmetric cryptographic algorithm AES.</p>

<h2 style='margin-left:-.25pt'><a name="_Toc281618">Section 49.3: Encrypt and
decrypt data using AES (in C#)</a></h2>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=293
src=".NET%20Framework%20Notes%20for%20Professionals_files/image459.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:566.95pt;margin-bottom:
0in;margin-left:-28.35pt;text-indent:0in;line-height:107%'>&nbsp;</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=718
 style='width:538.6pt;border-collapse:collapse'>
 <tr style='height:771.0pt'>
  <td width=718 valign=top style='width:538.6pt;background:#FAFAFA;padding:
  2.55pt 32.65pt 0in 3.75pt;height:771.0pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:#666666'>{</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><i><span style='font-size:
  9.0pt;line-height:107%;color:darkgreen'>// Encrypt the string to an array of
  bytes.</span></i></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:.75in;margin-bottom:
  12.3pt;margin-left:0in;text-indent:0in;line-height:112%'><span
  style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:#0600FF'>byte</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>[]</span><span
  style='font-size:9.0pt;line-height:112%'> encrypted </span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>=</span><span
  style='font-size:9.0pt;line-height:112%'> EncryptStringToBytes_Aes</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>(</span><span
  style='font-size:9.0pt;line-height:112%'>original,
  myAes</span><span style='font-size:9.0pt;line-height:112%;color:#666666'>.</span><span
  style='font-size:9.0pt;line-height:112%'>Key,
  myAes</span><span style='font-size:9.0pt;line-height:112%;color:#666666'>.</span><span
  style='font-size:9.0pt;line-height:112%'>IV</span><span style='font-size:
  9.0pt;line-height:112%;color:#666666'>);</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><i><span style='font-size:
  9.0pt;line-height:107%;color:darkgreen'>// Decrypt the bytes to a string.</span></i></p>
  <p class=MsoNormal align=right style='margin-top:0in;margin-right:91.8pt;
  margin-bottom:12.3pt;margin-left:0in;text-align:right;text-indent:0in;
  line-height:112%'><span style='font-size:9.0pt;line-height:112%'>
  </span><span style='font-size:9.0pt;line-height:112%;color:#0600FF'>string</span><span
  style='font-size:9.0pt;line-height:112%'> roundtrip </span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>=</span><span
  style='font-size:9.0pt;line-height:112%'> DecryptStringFromBytes_Aes</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>(</span><span
  style='font-size:9.0pt;line-height:112%'>encrypted,
  myAes</span><span style='font-size:9.0pt;line-height:112%;color:#666666'>.</span><span
  style='font-size:9.0pt;line-height:112%'>Key,
  myAes</span><span style='font-size:9.0pt;line-height:112%;color:#666666'>.</span><span
  style='font-size:9.0pt;line-height:112%'>IV</span><span style='font-size:
  9.0pt;line-height:112%;color:#666666'>);</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><i><span style='font-size:
  9.0pt;line-height:107%;color:darkgreen'>//Display the original data and the
  decrypted data.</span></i></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:.15in;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:112%'><span style='font-size:
  9.0pt;line-height:112%'> Console</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>.</span><span
  style='font-size:9.0pt;line-height:112%'>WriteLine</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>(</span><span
  style='font-size:9.0pt;line-height:112%;color:#A60000'>&quot;Original:
  {0}&quot;</span><span style='font-size:9.0pt;line-height:112%'>, original</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>); </span><span
  style='font-size:9.0pt;line-height:112%'>Console</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>.</span><span
  style='font-size:9.0pt;line-height:112%'>WriteLine</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>(</span><span
  style='font-size:9.0pt;line-height:112%;color:#A60000'>&quot;Round Trip:
  {0}&quot;</span><span style='font-size:9.0pt;line-height:112%'>, roundtrip</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>);</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:4.65in;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:112%'><span style='font-size:
  9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:#666666'>} </span><span style='font-size:9.0pt;
  line-height:112%'></span><span style='font-size:9.0pt;line-height:
  112%;color:#666666'>} </span><span style='font-size:9.0pt;line-height:112%'></span><span
  style='font-size:9.0pt;line-height:112%;color:#0600FF'>catch</span><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:#666666'>(</span><span style='font-size:9.0pt;
  line-height:112%'>Exception e</span><span style='font-size:9.0pt;line-height:
  112%;color:#666666'>) </span><span style='font-size:9.0pt;line-height:112%'></span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>{</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> Console</span><span style='font-size:
  9.0pt;line-height:107%;color:#666666'>.</span><span style='font-size:9.0pt;
  line-height:107%'>WriteLine</span><span style='font-size:9.0pt;line-height:
  107%;color:#666666'>(</span><span style='font-size:9.0pt;line-height:107%;
  color:#A60000'>&quot;Error: {0}&quot;</span><span style='font-size:9.0pt;
  line-height:107%'>, e</span><span style='font-size:9.0pt;line-height:107%;
  color:#666666'>.</span><span style='font-size:9.0pt;line-height:107%'>Message</span><span
  style='font-size:9.0pt;line-height:107%;color:#666666'>);</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:426.6pt;margin-bottom:
  12.3pt;margin-left:0in;text-indent:0in;line-height:112%'><span
  style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>} </span><span
  style='font-size:9.0pt;line-height:112%'></span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>}</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:27.0pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:112%'><span style='font-size:
  9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:#0600FF'>static</span><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:#0600FF'>byte</span><span style='font-size:9.0pt;line-height:112%;
  color:#666666'>[]</span><span style='font-size:9.0pt;line-height:112%'>
  EncryptStringToBytes_Aes</span><span style='font-size:9.0pt;line-height:112%;
  color:#666666'>(</span><span style='font-size:9.0pt;line-height:112%;
  color:#0600FF'>string</span><span style='font-size:9.0pt;line-height:112%'>
  plainText, </span><span style='font-size:9.0pt;line-height:112%;color:#0600FF'>byte</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>[]</span><span
  style='font-size:9.0pt;line-height:112%'> Key, </span><span style='font-size:
  9.0pt;line-height:112%;color:#0600FF'>byte</span><span style='font-size:9.0pt;
  line-height:112%;color:#666666'>[]</span><span style='font-size:9.0pt;
  line-height:112%'> IV</span><span style='font-size:9.0pt;line-height:112%;
  color:#666666'>) </span><span style='font-size:9.0pt;line-height:112%'></span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>{</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><i><span style='font-size:9.0pt;
  line-height:107%;color:darkgreen'>// Check arguments.</span></i></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:2.4in;margin-bottom:
  10.25pt;margin-left:0in;text-indent:0in;line-height:130%'><span
  style='font-size:9.0pt;line-height:130%'> </span><span
  style='font-size:9.0pt;line-height:130%;color:#0600FF'>if</span><span
  style='font-size:9.0pt;line-height:130%'> </span><span style='font-size:9.0pt;
  line-height:130%;color:#666666'>(</span><span style='font-size:9.0pt;
  line-height:130%'>plainText </span><span style='font-size:9.0pt;line-height:
  130%;color:#666666'>==</span><span style='font-size:9.0pt;line-height:130%'> </span><span
  style='font-size:9.0pt;line-height:130%;color:#0600FF'>null</span><span
  style='font-size:9.0pt;line-height:130%'> </span><span style='font-size:9.0pt;
  line-height:130%;color:#666666'>||</span><span style='font-size:9.0pt;
  line-height:130%'> plainText</span><span style='font-size:9.0pt;line-height:
  130%;color:#666666'>.</span><span style='font-size:9.0pt;line-height:130%'>Length
  </span><span style='font-size:9.0pt;line-height:130%;color:#666666'>&lt;=</span><span
  style='font-size:9.0pt;line-height:130%'> </span><span style='font-size:9.0pt;
  line-height:130%;color:red'>0</span><span style='font-size:9.0pt;line-height:
  130%;color:#666666'>) </span><span style='font-size:9.0pt;line-height:130%'></span><span
  style='font-size:9.0pt;line-height:130%;color:#0600FF'>throw</span><span
  style='font-size:9.0pt;line-height:130%'> </span><span style='font-size:9.0pt;
  line-height:130%;color:#0600FF'>new</span><span style='font-size:9.0pt;
  line-height:130%'> ArgumentNullException</span><span style='font-size:9.0pt;
  line-height:130%;color:#666666'>(</span><span style='font-size:9.0pt;
  line-height:130%;color:#A60000'>&quot;plainText&quot;</span><span
  style='font-size:9.0pt;line-height:130%;color:#666666'>); </span><span
  style='font-size:9.0pt;line-height:130%'></span><span
  style='font-size:9.0pt;line-height:130%;color:#0600FF'>if</span><span
  style='font-size:9.0pt;line-height:130%'> </span><span style='font-size:9.0pt;
  line-height:130%;color:#666666'>(</span><span style='font-size:9.0pt;
  line-height:130%'>Key </span><span style='font-size:9.0pt;line-height:130%;
  color:#666666'>==</span><span style='font-size:9.0pt;line-height:130%'> </span><span
  style='font-size:9.0pt;line-height:130%;color:#0600FF'>null</span><span
  style='font-size:9.0pt;line-height:130%'> </span><span style='font-size:9.0pt;
  line-height:130%;color:#666666'>||</span><span style='font-size:9.0pt;
  line-height:130%'> Key</span><span style='font-size:9.0pt;line-height:130%;
  color:#666666'>.</span><span style='font-size:9.0pt;line-height:130%'>Length </span><span
  style='font-size:9.0pt;line-height:130%;color:#666666'>&lt;=</span><span
  style='font-size:9.0pt;line-height:130%'> </span><span style='font-size:9.0pt;
  line-height:130%;color:red'>0</span><span style='font-size:9.0pt;line-height:
  130%;color:#666666'>) </span><span style='font-size:9.0pt;line-height:130%'></span><span
  style='font-size:9.0pt;line-height:130%;color:#0600FF'>throw</span><span
  style='font-size:9.0pt;line-height:130%'> </span><span style='font-size:9.0pt;
  line-height:130%;color:#0600FF'>new</span><span style='font-size:9.0pt;
  line-height:130%'> ArgumentNullException</span><span style='font-size:9.0pt;
  line-height:130%;color:#666666'>(</span><span style='font-size:9.0pt;
  line-height:130%;color:#A60000'>&quot;Key&quot;</span><span style='font-size:
  9.0pt;line-height:130%;color:#666666'>); </span><span style='font-size:9.0pt;
  line-height:130%'></span><span style='font-size:9.0pt;line-height:
  130%;color:#0600FF'>if</span><span style='font-size:9.0pt;line-height:130%'> </span><span
  style='font-size:9.0pt;line-height:130%;color:#666666'>(</span><span
  style='font-size:9.0pt;line-height:130%'>IV </span><span style='font-size:
  9.0pt;line-height:130%;color:#666666'>==</span><span style='font-size:9.0pt;
  line-height:130%'> </span><span style='font-size:9.0pt;line-height:130%;
  color:#0600FF'>null</span><span style='font-size:9.0pt;line-height:130%'> </span><span
  style='font-size:9.0pt;line-height:130%;color:#666666'>||</span><span
  style='font-size:9.0pt;line-height:130%'> IV</span><span style='font-size:
  9.0pt;line-height:130%;color:#666666'>.</span><span style='font-size:9.0pt;
  line-height:130%'>Length </span><span style='font-size:9.0pt;line-height:
  130%;color:#666666'>&lt;=</span><span style='font-size:9.0pt;line-height:
  130%'> </span><span style='font-size:9.0pt;line-height:130%;color:red'>0</span><span
  style='font-size:9.0pt;line-height:130%;color:#666666'>) </span><span
  style='font-size:9.0pt;line-height:130%'></span><span
  style='font-size:9.0pt;line-height:130%;color:#0600FF'>throw</span><span
  style='font-size:9.0pt;line-height:130%'> </span><span style='font-size:9.0pt;
  line-height:130%;color:#0600FF'>new</span><span style='font-size:9.0pt;
  line-height:130%'> ArgumentNullException</span><span style='font-size:9.0pt;
  line-height:130%;color:#666666'>(</span><span style='font-size:9.0pt;
  line-height:130%;color:#A60000'>&quot;IV&quot;</span><span style='font-size:
  9.0pt;line-height:130%;color:#666666'>); </span><span style='font-size:9.0pt;
  line-height:130%'></span><span style='font-size:9.0pt;line-height:
  130%;color:#0600FF'>byte</span><span style='font-size:9.0pt;line-height:130%;
  color:#666666'>[]</span><span style='font-size:9.0pt;line-height:130%'>
  encrypted</span><span style='font-size:9.0pt;line-height:130%;color:#666666'>;</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:152.1pt;margin-bottom:
  12.3pt;margin-left:0in;text-indent:0in;line-height:112%'><span
  style='font-size:9.0pt;line-height:112%'> </span><i><span
  style='font-size:9.0pt;line-height:112%;color:darkgreen'>// Create an Aes
  object with the specified key and IV. </span></i><span style='font-size:9.0pt;
  line-height:112%'></span><span style='font-size:9.0pt;line-height:
  112%;color:#0600FF'>using</span><span style='font-size:9.0pt;line-height:
  112%'> </span><span style='font-size:9.0pt;line-height:112%;color:#666666'>(</span><span
  style='font-size:9.0pt;line-height:112%'>Aes aesAlg </span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>=</span><span
  style='font-size:9.0pt;line-height:112%'> Aes</span><span style='font-size:
  9.0pt;line-height:112%;color:#666666'>.</span><span style='font-size:9.0pt;
  line-height:112%'>Create</span><span style='font-size:9.0pt;line-height:112%;
  color:#666666'>()) </span><span style='font-size:9.0pt;line-height:112%'></span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>{ </span><span
  style='font-size:9.0pt;line-height:112%'>aesAlg</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>.</span><span
  style='font-size:9.0pt;line-height:112%'>Key </span><span style='font-size:
  9.0pt;line-height:112%;color:#666666'>=</span><span style='font-size:9.0pt;
  line-height:112%'> Key</span><span style='font-size:9.0pt;line-height:112%;
  color:#666666'>; </span><span style='font-size:9.0pt;line-height:112%'>aesAlg</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>.</span><span
  style='font-size:9.0pt;line-height:112%'>IV </span><span style='font-size:
  9.0pt;line-height:112%;color:#666666'>=</span><span style='font-size:9.0pt;
  line-height:112%'> IV</span><span style='font-size:9.0pt;line-height:112%;
  color:#666666'>;</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><i><span style='font-size:
  9.0pt;line-height:107%;color:darkgreen'>// Create a decrytor to perform the
  stream transform.</span></i></p>
  <p class=MsoNormal align=right style='margin-top:0in;margin-right:1.05in;
  margin-bottom:12.3pt;margin-left:0in;text-align:right;text-indent:0in;
  line-height:112%'><span style='font-size:9.0pt;line-height:112%'>
  ICryptoTransform encryptor </span><span style='font-size:9.0pt;line-height:
  112%;color:#666666'>=</span><span style='font-size:9.0pt;line-height:112%'>
  aesAlg</span><span style='font-size:9.0pt;line-height:112%;color:#666666'>.</span><span
  style='font-size:9.0pt;line-height:112%'>CreateEncryptor</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>(</span><span
  style='font-size:9.0pt;line-height:112%'>aesAlg</span><span style='font-size:
  9.0pt;line-height:112%;color:#666666'>.</span><span style='font-size:9.0pt;
  line-height:112%'>Key,
  aesAlg</span><span style='font-size:9.0pt;line-height:112%;color:#666666'>.</span><span
  style='font-size:9.0pt;line-height:112%'>IV</span><span style='font-size:
  9.0pt;line-height:112%;color:#666666'>);</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><i><span style='font-size:
  9.0pt;line-height:107%;color:darkgreen'>// Create the streams used for
  encryption.</span></i></p>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:112%'><span style='font-size:9.0pt;line-height:
  112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:#0600FF'>using</span><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>(</span><span
  style='font-size:9.0pt;line-height:112%'>MemoryStream msEncrypt </span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>=</span><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:#0600FF'>new</span><span style='font-size:9.0pt;
  line-height:112%'> MemoryStream</span><span style='font-size:9.0pt;
  line-height:112%;color:#666666'>()) </span><span style='font-size:9.0pt;
  line-height:112%'></span><span style='font-size:9.0pt;
  line-height:112%;color:#666666'>{ </span><span style='font-size:9.0pt;
  line-height:112%'></span><span style='font-size:9.0pt;
  line-height:112%;color:#0600FF'>using</span><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:#666666'>(</span><span style='font-size:9.0pt;line-height:112%'>CryptoStream
  csEncrypt </span><span style='font-size:9.0pt;line-height:112%;color:#666666'>=</span><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:#0600FF'>new</span><span style='font-size:9.0pt;
  line-height:112%'> CryptoStream</span><span style='font-size:9.0pt;
  line-height:112%;color:#666666'>(</span><span style='font-size:9.0pt;
  line-height:112%'>msEncrypt,
  encryptor,
  CryptoStreamMode</span><span style='font-size:9.0pt;line-height:112%;
  color:#666666'>.</span><span style='font-size:9.0pt;line-height:112%'>Write</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>)) </span><span
  style='font-size:9.0pt;line-height:112%'></span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>{ </span><span
  style='font-size:9.0pt;line-height:112%'></span><span
  style='font-size:9.0pt;line-height:112%;color:#0600FF'>using</span><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:#666666'>(</span><span style='font-size:9.0pt;
  line-height:112%'>StreamWriter swEncrypt </span><span style='font-size:9.0pt;
  line-height:112%;color:#666666'>=</span><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:#0600FF'>new</span><span style='font-size:9.0pt;line-height:112%'>
  StreamWriter</span><span style='font-size:9.0pt;line-height:112%;color:#666666'>(</span><span
  style='font-size:9.0pt;line-height:112%'>csEncrypt</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>)) </span><span
  style='font-size:9.0pt;line-height:112%'></span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>{</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><i><span
  style='font-size:9.0pt;line-height:107%;color:darkgreen'>//Write all data to
  the stream.</span></i></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:199.8pt;margin-bottom:
  12.3pt;margin-left:0in;text-indent:0in;line-height:112%'><span
  style='font-size:9.0pt;line-height:112%'>
  swEncrypt</span><span style='font-size:9.0pt;line-height:112%;color:#666666'>.</span><span
  style='font-size:9.0pt;line-height:112%'>Write</span><span style='font-size:
  9.0pt;line-height:112%;color:#666666'>(</span><span style='font-size:9.0pt;
  line-height:112%'>plainText</span><span style='font-size:9.0pt;line-height:
  112%;color:#666666'>); </span><span style='font-size:9.0pt;line-height:112%'></span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>}</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:2.7in;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:112%'><span style='font-size:
  9.0pt;line-height:112%'> encrypted </span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>=</span><span
  style='font-size:9.0pt;line-height:112%'> msEncrypt</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>.</span><span
  style='font-size:9.0pt;line-height:112%'>ToArray</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>(); </span><span
  style='font-size:9.0pt;line-height:112%'></span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>}</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:#666666'>}</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:9.0pt;line-height:107%'> </span><span
  style='font-size:9.0pt;line-height:107%;color:#666666'>}</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.75pt;margin-left:-.45pt;text-indent:0in;line-height:107%'><img border=0
width=719 height=810 id="Picture 275320"
src=".NET%20Framework%20Notes%20for%20Professionals_files/image460.gif"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:13.15pt;
margin-left:1.05pt'>This example is from <a
href="https://msdn.microsoft.com/en-us/library/system.security.cryptography.aes(v=vs.110).aspx"><span
style='color:#1889D0'>MSDN</span></a>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.75pt;
margin-left:1.05pt'>It is a console demo application, showing how to encrypt a
string by using the standard <b>AES</b> encryption, and how to decrypt it
afterwards.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.75pt;
margin-left:1.05pt'>(<a
href="https://en.wikipedia.org/wiki/Advanced_Encryption_Standard"><b><span
style='color:#1889D0'>AES = Advanced Encryption Standard</span></b></a><b>,</b>
a specification for the encryption of electronic data established by the U.S.
National Institute of Standards and Technology (NIST) in 2001 which is still
the de-facto standard for symmetric encryption)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.35pt;
margin-left:.75pt;line-height:107%'><b>Notes:</b></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=101 style='width:1.05in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=72 valign=top style='width:.75in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>CipherMode</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>.</span></p>
  </td>
  <td width=22 valign=top style='width:16.2pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>ECB</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:9.35pt;
margin-left:30.0pt;text-indent:-9.1pt'><span style='font-size:11.0pt;
line-height:109%'><img border=0 width=5 height=5 id="Group 266249"
src=".NET%20Framework%20Notes%20for%20Professionals_files/image259.gif"></span>In
a real encryption scenario, you need to choose a proper cipher mode (can be
assigned to the <span style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>Mode
</span>property by selecting a value from the <span style='font-size:9.0pt;
line-height:109%;background:#FAFAFA'>CipherMode</span> enumeration). <b>Never</b>
use the (electronic codebook mode), since this procuces a weak cypher stream</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:9.3pt;
margin-left:30.0pt;text-indent:-9.1pt'><span style='font-size:11.0pt;
line-height:109%'><img border=0 width=5 height=5 id="Group 266250"
src=".NET%20Framework%20Notes%20for%20Professionals_files/image259.gif"></span>To
create a good (and not a weak) <span style='font-size:9.0pt;line-height:109%;
background:#FAFAFA'>Key</span>, either use a cryptographic random generator or
use the example above (<b>Create a Key from a Password</b>). The recommended <b>KeySize</b>
is 256 bit. Supported key sizes are available via the <span style='font-size:
9.0pt;line-height:109%;background:#FAFAFA'>LegalKeySizes</span> property.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:9.65pt;
margin-left:21.4pt'><img width=5 height=1
src=".NET%20Framework%20Notes%20for%20Professionals_files/image461.gif"
align=left hspace=12>To initialize the initialization vector <span
style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>IV</span>, you can
use a SALT as shown in the example above (<b>Random SALT</b>)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:20.5pt;
margin-left:21.4pt'>Supported block sizes are available via the <span
style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>SupportedBlockSizes</span>
property, the block size can be assigned via the <span style='font-size:9.0pt;
line-height:109%;background:#FAFAFA'>BlockSize</span> property</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:18.9pt;
margin-left:1.05pt'><b>Usage:</b> see Main() method.</p>

<h2 style='margin-left:-.25pt'><a name="_Toc281619">Section 49.4: Create a Key
from a Password / Random SALT (in C#)</a></h2>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=691
src=".NET%20Framework%20Notes%20for%20Professionals_files/image462.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=924
src=".NET%20Framework%20Notes%20for%20Professionals_files/image463.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.9pt;
margin-left:1.05pt'>This example is taken from <a
href="https://msdn.microsoft.com/en-us/library/system.security.cryptography.passwordderivebytes(v=vs.110).aspx"><span
style='color:#1889D0'>MSDN.</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>It is a console demo, and it shows how to create a secure
key based on a user-defined password, and how to create a random SALT based on
the cryptographic random generator.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.35pt;
margin-left:.75pt;line-height:107%'><b>Notes:</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:9.7pt;
margin-left:30.0pt;text-indent:-9.1pt'><span style='font-size:11.0pt;
line-height:109%'><img border=0 width=5 height=5 id="Group 262830"
src=".NET%20Framework%20Notes%20for%20Professionals_files/image259.gif"></span>The
built-in function <span style='font-size:9.0pt;line-height:109%;background:
#FAFAFA'>PasswordDeriveBytes</span> uses the standard PBKDF1 algorithm to
generate a key from the password. Per default, it uses 100 iterations to
generate the key to slow down brute force attacks. The SALT generated randomly
further strenghens the key.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:9.35pt;
margin-left:30.0pt;text-indent:-9.1pt'><span style='font-size:11.0pt;
line-height:109%'><img border=0 width=5 height=5 id="Group 262831"
src=".NET%20Framework%20Notes%20for%20Professionals_files/image259.gif"></span>The
function <span style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>CryptDeriveKey</span>
converts the key generated by <span style='font-size:9.0pt;line-height:109%;
background:#FAFAFA'>PasswordDeriveBytes</span> into a key compatible with the
specified encryption algorithm (here &quot;TripleDES&quot;) by using the
specified hash algorithm (here &quot;SHA1&quot;). The keysize in this example
is 192 bytes, and the initialization vector IV is taken from the triple-DES
crypto provider</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:9.55pt;
margin-left:30.0pt;text-indent:-9.1pt'><span style='font-size:11.0pt;
line-height:109%'><img border=0 width=5 height=5 id="Group 262832"
src=".NET%20Framework%20Notes%20for%20Professionals_files/image259.gif"></span>Usually,
this mechanism is used to protect a stronger random generated key by a
password, which encrypts large amount of data. You can also use it to provide
multiple passwords of different users to give access to the same data (being
protected by a different random key).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:21.4pt'><span style='font-size:11.0pt;line-height:109%'><img
border=0 width=5 height=5 id="Group 262833"
src=".NET%20Framework%20Notes%20for%20Professionals_files/image259.gif"></span>Unfortunately,
<span style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>CryptDeriveKey</span>
does currently not support AES. See <a
href="https://social.msdn.microsoft.com/Forums/vstudio/en-US/61d85001-2eae-4419-b4bf-ce98d46f4d21/passwordderivebytescryptderivekey-derives-an-aes-key-but-gets-object-identifier-oid-is-unknown?forum=netfxbcl"><span
style='color:#1889D0'>here.</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:20.25pt;
margin-left:30.5pt'><b>NOTE:</b> As a workaround, you can create a random AES
key for encryption of the data to be protected with AES and store the AES key
in a TripleDES-Container which uses the key generated by <span
style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>CryptDeriveKey</span>.
But that limits the security to TripleDES, does not take advantage of the
larger keysizes of AES and creates a dependency to TripleDES.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'><b>Usage:</b> See Main() method.<br clear=all
style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc281620">Chapter 50: Work with SHA1
in C#</a></h1>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.55pt;
margin-left:1.05pt'>in this project you see how to work with SHA1 cryptographic
hash function. for example get hash from string and how to crack SHA1 hash.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:18.8pt;
margin-left:-.25pt;line-height:107%'>source compelete on github: <a
href="https://github.com/mahdiabasi/SHA1Tool"><span style='color:#1889D0'>https://github.com/mahdiabasi/SHA1Tool</span></a></p>

<h2 style='margin-left:-.25pt'><a name="_Toc281621">Section 50.1: #Generate
SHA1 checksum of a file</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=206
src=".NET%20Framework%20Notes%20for%20Professionals_files/image464.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc281622">Section 50.2: #Generate
hash of a text</a></h2>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=223
src=".NET%20Framework%20Notes%20for%20Professionals_files/image465.gif"></span></p>

<h1 style='margin-left:-.25pt'><a name="_Toc281623">Chapter 51: Unit testing</a></h1>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:3.25pt;margin-left:
-.25pt'><a name="_Toc281624">Section 51.1: Adding MSTest unit testing project
to an existing solution</a></h2>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=65 style='width:48.6pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=65 valign=top style='width:48.6pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Foo</span><span style='font-size:9.0pt;line-height:107%;color:#666666'>.</span><span
  style='font-size:9.0pt;line-height:107%'>Tests</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:21.4pt'><img width=5 height=1
src=".NET%20Framework%20Notes%20for%20Professionals_files/image195.gif"
align=left hspace=12>Right click on the solution, Add new project</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:21.4pt'>From the Test section, select an Unit Test Project</p>

<p class=MsoNormal style='margin-top:0in;margin-right:97.95pt;margin-bottom:
.25pt;margin-left:-.75pt;text-align:justify;text-justify:inter-ideograph;
text-indent:5.5pt;line-height:135%'>Pick a name for the assembly - if you are
testing project <span style='font-size:9.0pt;line-height:135%;background:#FAFAFA'>Foo</span>,
the name can be Add a reference to the tested project in the unit test project
references</p>

<h2 style='margin-top:0in;margin-right:97.95pt;margin-bottom:.25pt;margin-left:
-.75pt;text-align:justify;text-justify:inter-ideograph;text-indent:5.5pt;
line-height:135%'><a name="_Toc281625">Section 51.2: Creating a sample test
method</a></h2>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=79 style='width:59.4pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=79 valign=top style='width:59.4pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666'>[</span><span style='font-size:9.0pt;line-height:107%'>TestClass</span><span
  style='font-size:9.0pt;line-height:107%;color:#666666'>]</span></p>
  </td>
 </tr>
</table>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=86 style='width:.9in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=86 valign=top style='width:.9in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666'>[</span><span style='font-size:9.0pt;line-height:107%'>TestMethod</span><span
  style='font-size:9.0pt;line-height:107%;color:#666666'>]</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>MSTest (the default testing framework) requires you to have
your test classes decorated by a attribute, and the test methods with a
attribute, and to be public.</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=240
src=".NET%20Framework%20Notes%20for%20Professionals_files/image466.gif"></span></p>

<h1 style='margin-left:-.25pt'><a name="_Toc281626">Chapter 52: Write to and
read from StdErr stream</a></h1>

<h2 style='margin-left:-.25pt'><a name="_Toc281627">Section 52.1: Write to
standard error output using Console</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=174
src=".NET%20Framework%20Notes%20for%20Professionals_files/image467.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc281628">Section 52.2: Read from
standard error of child process</a></h2>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=322
src=".NET%20Framework%20Notes%20for%20Professionals_files/image468.gif"></span></p>

<h1 style='margin-left:-.25pt'><a name="_Toc281629">Chapter 53: Upload file and
POST data to webserver</a></h1>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:2.5pt;margin-left:
-.25pt'><a name="_Toc281630">Section 53.1: Upload file with WebRequest</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>To send a file and form data in single request, content
should have <a href="https://tools.ietf.org/html/rfc2388"><span
style='color:#1889D0'>multipart/form-data</span></a> type.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
18.7pt;margin-left:-.45pt;text-indent:0in;line-height:107%'><img border=0
width=719 height=716 id="Picture 275322"
src=".NET%20Framework%20Notes%20for%20Professionals_files/image469.gif"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>Usage:</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=112
src=".NET%20Framework%20Notes%20for%20Professionals_files/image470.gif"></span></p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=21
src=".NET%20Framework%20Notes%20for%20Professionals_files/image471.gif"></span><br
clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc281631">Chapter 54: Networking</a></h1>

<h2 style='margin-left:-.25pt'><a name="_Toc281632">Section 54.1: Basic TCP
chat (TcpListener, TcpClient, NetworkStream)</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
0in;margin-left:-.45pt;text-indent:0in;line-height:107%'><img border=0
width=719 height=913 id="Picture 275327"
src=".NET%20Framework%20Notes%20for%20Professionals_files/image472.gif"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=399
src=".NET%20Framework%20Notes%20for%20Professionals_files/image473.gif"></span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:2.5pt;margin-left:
-.25pt'><a name="_Toc281633">Section 54.2: Basic SNTP client (UdpClient)</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:1.05pt'>See <a href="http://tools.ietf.org/html/rfc2030"><span
style='color:#1889D0'>RFC 2030</span></a> for details on the SNTP protocol.</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=720 height=536
src=".NET%20Framework%20Notes%20for%20Professionals_files/image474.gif"></span></p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=547
src=".NET%20Framework%20Notes%20for%20Professionals_files/image475.gif"></span></p>

<h1 style='margin-left:-.25pt'><a name="_Toc281634">Chapter 55: HTTP servers</a></h1>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:2.5pt;margin-left:
-.25pt'><a name="_Toc281635">Section 55.1: Basic read-only HTTP file server
(ASP.NET Core)</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:13.05pt;
margin-left:8.85pt;text-indent:-8.3pt'><span style='line-height:109%'>1<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span>- Create an empty
folder, it will contain the files created in the next steps.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=86 style='width:.9in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=86 valign=top style='width:.9in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>project</span><span style='font-size:9.0pt;line-height:107%;color:#666666'>.</span><span
  style='font-size:9.0pt;line-height:107%'>json</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:8.85pt;text-indent:-8.3pt'><span style='line-height:109%'>2<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span>- Create a file
named with the following content (adjust the port number and <span
style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>rootDirectory</span>
as appropriate):</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=720 height=306
src=".NET%20Framework%20Notes%20for%20Professionals_files/image476.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=72 style='width:.75in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=72 valign=top style='width:.75in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Startup</span><span style='font-size:9.0pt;line-height:107%;color:#666666'>.</span><span
  style='font-size:9.0pt;line-height:107%'>cs</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:8.85pt;text-indent:-8.3pt'><span style='line-height:109%'>3<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span>- Create a file
named with the following code:</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=489
src=".NET%20Framework%20Notes%20for%20Professionals_files/image477.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=71
src=".NET%20Framework%20Notes%20for%20Professionals_files/image478.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:8.85pt;text-indent:-8.3pt'><span style='line-height:109%'>4<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span>- Open a command
prompt, navigate to the folder and execute:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.25pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src=".NET%20Framework%20Notes%20for%20Professionals_files/image479.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.6pt;
margin-left:1.05pt'><b>Note:</b> These commands need to be run only once. Use <span
style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>dnvm list</span> to
check the actual number of the latest installed version of the core CLR.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=275 style='width:206.6pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>http</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>:</span></p>
  </td>
  <td width=239 valign=top style='width:179.6pt;background:#FAFAFA;padding:
  1.8pt 0in 0in 0in;height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><i><span style='font-size:9.0pt;line-height:
  107%;color:darkgreen'>//localhost:60000/path/to/file.ext</span></i></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.95pt;
margin-left:8.85pt;text-indent:-8.3pt'><span style='line-height:109%'>5<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span>- Start the server
with: <span style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>dnx web</span>.
Files can now be requested at .</p>

<p class=MsoNormal style='margin-top:0in;margin-right:12.0pt;margin-bottom:
.25pt;margin-left:-.25pt;text-align:justify;text-justify:inter-ideograph;
line-height:135%'>For simplicity, filenames are assumed to be all ASCII (for
the filename part in the Content-Disposition header) and file access errors are
not handled.</p>

<h2 style='margin-top:0in;margin-right:12.0pt;margin-bottom:.25pt;margin-left:
-.25pt;text-align:justify;text-justify:inter-ideograph;line-height:135%'><a
name="_Toc281636">Section 55.2: Basic read-only HTTP file server (HttpListener)</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.35pt;
margin-left:.75pt;line-height:107%'><b>Notes:</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.9pt;
margin-left:1.05pt'>This example must be run in administrative mode.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.9pt;
margin-left:1.05pt'>Only one simultaneous client is supported.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>For simplicity, filenames are assumed to be all ASCII (for
the <i>filename</i> part in the <i>Content-Disposition</i> header) and file
access errors are not handled.</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=720 height=501
src=".NET%20Framework%20Notes%20for%20Professionals_files/image480.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:566.95pt;margin-bottom:
0in;margin-left:-28.35pt;text-indent:0in;line-height:107%'>&nbsp;</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=718
 style='width:538.6pt;border-collapse:collapse'>
 <tr style='height:771.0pt'>
  <td width=718 valign=top style='width:538.6pt;background:#FAFAFA;padding:
  2.55pt 5.75pt 0in 3.75pt;height:771.0pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:145.65pt;margin-bottom:
  12.3pt;margin-left:0in;text-indent:0in;line-height:112%'><span
  style='font-size:9.0pt;line-height:112%'> listener </span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>=</span><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:#0600FF'>new</span><span style='font-size:9.0pt;
  line-height:112%'> HttpListener</span><span style='font-size:9.0pt;
  line-height:112%;color:#666666'>(); </span><span style='font-size:9.0pt;
  line-height:112%'>listener</span><span style='font-size:9.0pt;
  line-height:112%;color:#666666'>.</span><span style='font-size:9.0pt;
  line-height:112%'>Prefixes</span><span style='font-size:9.0pt;line-height:
  112%;color:#666666'>.</span><span style='font-size:9.0pt;line-height:112%;
  color:#0600FF'>Add</span><span style='font-size:9.0pt;line-height:112%;
  color:#666666'>(</span><span style='font-size:9.0pt;line-height:112%;
  color:#A60000'>&quot;http://*:&quot;</span><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:#666666'>+</span><span style='font-size:9.0pt;line-height:112%'> port </span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>+</span><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:#A60000'>&quot;/&quot;</span><span style='font-size:
  9.0pt;line-height:112%;color:#666666'>); </span><span style='font-size:9.0pt;
  line-height:112%'>listener</span><span style='font-size:9.0pt;
  line-height:112%;color:#666666'>.</span><span style='font-size:9.0pt;
  line-height:112%'>Start</span><span style='font-size:9.0pt;line-height:112%;
  color:#666666'>();</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:75.45pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:112%'><span style='font-size:
  9.0pt;line-height:112%'> Console</span><span style='font-size:9.0pt;
  line-height:112%;color:#666666'>.</span><span style='font-size:9.0pt;
  line-height:112%'>WriteLine</span><span style='font-size:9.0pt;line-height:
  112%;color:#666666'>(</span><span style='font-size:9.0pt;line-height:112%;
  color:#A60000'>&quot;--- Server stated, base path is: &quot;</span><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:#666666'>+</span><span style='font-size:9.0pt;
  line-height:112%'> baseFilesystemPath</span><span style='font-size:9.0pt;
  line-height:112%;color:#666666'>); </span><span style='font-size:9.0pt;
  line-height:112%'>Console</span><span style='font-size:9.0pt;
  line-height:112%;color:#666666'>.</span><span style='font-size:9.0pt;
  line-height:112%'>WriteLine</span><span style='font-size:9.0pt;line-height:
  112%;color:#666666'>(</span><span style='font-size:9.0pt;line-height:112%;
  color:#A60000'>&quot;--- Listening, exit with Ctrl-C&quot;</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>); </span><span
  style='font-size:9.0pt;line-height:112%'></span><span
  style='font-size:9.0pt;line-height:112%;color:#0600FF'>try </span><span
  style='font-size:9.0pt;line-height:112%'></span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>{</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:345.5pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:112%'><span style='font-size:
  9.0pt;line-height:112%'> ServerLoop</span><span style='font-size:
  9.0pt;line-height:112%;color:#666666'>(); </span><span style='font-size:9.0pt;
  line-height:112%'></span><span style='font-size:9.0pt;line-height:
  112%;color:#666666'>} </span><span style='font-size:9.0pt;line-height:112%'></span><span
  style='font-size:9.0pt;line-height:112%;color:#0600FF'>catch</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>(</span><span
  style='font-size:9.0pt;line-height:112%'>Exception ex</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>) </span><span
  style='font-size:9.0pt;line-height:112%'></span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>{ </span><span
  style='font-size:9.0pt;line-height:112%'>Console</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>.</span><span
  style='font-size:9.0pt;line-height:112%'>WriteLine</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>(</span><span
  style='font-size:9.0pt;line-height:112%'>ex</span><span style='font-size:
  9.0pt;line-height:112%;color:#666666'>); </span><span style='font-size:9.0pt;
  line-height:112%'></span><span style='font-size:9.0pt;line-height:
  112%;color:#0600FF'>if</span><span style='font-size:9.0pt;line-height:112%;
  color:#666666'>(</span><span style='font-size:9.0pt;line-height:112%'>response
  </span><span style='font-size:9.0pt;line-height:112%;color:#666666'>!=</span><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:#0600FF'>null</span><span style='font-size:9.0pt;
  line-height:112%;color:#666666'>)</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:#666666'>{</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> SendErrorResponse</span><span
  style='font-size:9.0pt;line-height:107%;color:#666666'>(</span><span
  style='font-size:9.0pt;line-height:107%;color:red'>500</span><span
  style='font-size:9.0pt;line-height:107%'>, </span><span style='font-size:
  9.0pt;line-height:107%;color:#A60000'>&quot;Internal server error&quot;</span><span
  style='font-size:9.0pt;line-height:107%;color:#666666'>);</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:#666666'>}</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:475.1pt;margin-bottom:
  12.3pt;margin-left:0in;text-indent:0in;line-height:112%'><span
  style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>} </span><span
  style='font-size:9.0pt;line-height:112%'></span><span style='font-size:
  9.0pt;line-height:112%;color:#666666'>}</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:269.9pt;margin-bottom:
  12.3pt;margin-left:0in;text-indent:0in;line-height:112%'><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:
  9.0pt;line-height:112%;color:#0600FF'>static</span><span style='font-size:
  9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;line-height:
  112%;color:#0600FF'>void</span><span style='font-size:9.0pt;line-height:112%'>
  ServerLoop</span><span style='font-size:9.0pt;line-height:112%;color:#666666'>()
  </span><span style='font-size:9.0pt;line-height:112%'></span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>{ </span><span
  style='font-size:9.0pt;line-height:112%'></span><span
  style='font-size:9.0pt;line-height:112%;color:#0600FF'>while</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>(</span><span
  style='font-size:9.0pt;line-height:112%;color:#0600FF'>true</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>) </span><span
  style='font-size:9.0pt;line-height:112%'></span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>{ </span><span
  style='font-size:9.0pt;line-height:112%'></span><span
  style='font-size:9.0pt;line-height:112%;color:#0600FF'>var</span><span
  style='font-size:9.0pt;line-height:112%'> context </span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>=</span><span
  style='font-size:9.0pt;line-height:112%'> listener</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>.</span><span
  style='font-size:9.0pt;line-height:112%'>GetContext</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>();</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:259.1pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:112%'><span style='font-size:
  9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:#0600FF'>var</span><span style='font-size:9.0pt;
  line-height:112%'> request </span><span style='font-size:9.0pt;line-height:
  112%;color:#666666'>=</span><span style='font-size:9.0pt;line-height:112%'>
  context</span><span style='font-size:9.0pt;line-height:112%;color:#666666'>.</span><span
  style='font-size:9.0pt;line-height:112%'>Request</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>; </span><span
  style='font-size:9.0pt;line-height:112%'>response </span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>=</span><span
  style='font-size:9.0pt;line-height:112%'> context</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>.</span><span
  style='font-size:9.0pt;line-height:112%'>Response</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>;</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:#0600FF'>var</span><span style='font-size:9.0pt;
  line-height:107%'> fileName </span><span style='font-size:9.0pt;line-height:
  107%;color:#666666'>=</span><span style='font-size:9.0pt;line-height:107%'>
  request</span><span style='font-size:9.0pt;line-height:107%;color:#666666'>.</span><span
  style='font-size:9.0pt;line-height:107%'>RawUrl</span><span style='font-size:
  9.0pt;line-height:107%;color:#666666'>.</span><span style='font-size:9.0pt;
  line-height:107%'>Substring</span><span style='font-size:9.0pt;line-height:
  107%;color:#666666'>(</span><span style='font-size:9.0pt;line-height:107%;
  color:red'>1</span><span style='font-size:9.0pt;line-height:107%;color:#666666'>);</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> Console</span><span style='font-size:
  9.0pt;line-height:107%;color:#666666'>.</span><span style='font-size:9.0pt;
  line-height:107%'>WriteLine</span><span style='font-size:9.0pt;line-height:
  107%;color:#666666'>(</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:172.65pt;margin-bottom:
  12.3pt;margin-left:0in;text-indent:0in;line-height:112%'><span
  style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:#A60000'>&quot;--- Got {0}
  request for: {1}&quot;</span><span style='font-size:9.0pt;line-height:112%'>,
  request</span><span style='font-size:9.0pt;line-height:112%;color:#666666'>.</span><span
  style='font-size:9.0pt;line-height:112%'>HttpMethod, fileName</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>);</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:#0600FF'>if</span><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:#666666'>(</span><span style='font-size:9.0pt;line-height:107%'>request</span><span
  style='font-size:9.0pt;line-height:107%;color:#666666'>.</span><span
  style='font-size:9.0pt;line-height:107%'>HttpMethod</span><span
  style='font-size:9.0pt;line-height:107%;color:#666666'>.</span><span
  style='font-size:9.0pt;line-height:107%'>ToUpper</span><span
  style='font-size:9.0pt;line-height:107%;color:#666666'>()</span><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:#666666'>!=</span><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:#A60000'>&quot;GET&quot;</span><span style='font-size:9.0pt;line-height:
  107%;color:#666666'>)</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:199.7pt;margin-bottom:
  12.3pt;margin-left:0in;text-indent:0in;line-height:112%'><span
  style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>{ </span><span
  style='font-size:9.0pt;line-height:112%'>SendErrorResponse</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>(</span><span
  style='font-size:9.0pt;line-height:112%;color:red'>405</span><span
  style='font-size:9.0pt;line-height:112%'>, </span><span style='font-size:
  9.0pt;line-height:112%;color:#A60000'>&quot;Method must be GET&quot;</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>); </span><span
  style='font-size:9.0pt;line-height:112%'></span><span
  style='font-size:9.0pt;line-height:112%;color:#0600FF'>continue</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>; </span><span
  style='font-size:9.0pt;line-height:112%'></span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>}</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:112%'><span
  style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:#0600FF'>var</span><span
  style='font-size:9.0pt;line-height:112%'> fullFilePath </span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>=</span><span
  style='font-size:9.0pt;line-height:112%'> Path</span><span style='font-size:
  9.0pt;line-height:112%;color:#666666'>.</span><span style='font-size:9.0pt;
  line-height:112%'>Combine</span><span style='font-size:9.0pt;line-height:
  112%;color:#666666'>(</span><span style='font-size:9.0pt;line-height:112%'>baseFilesystemPath,
  fileName</span><span style='font-size:9.0pt;line-height:112%;color:#666666'>);
  </span><span style='font-size:9.0pt;line-height:112%'></span><span
  style='font-size:9.0pt;line-height:112%;color:#0600FF'>if</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>(!</span><span
  style='font-size:9.0pt;line-height:112%'>File</span><span style='font-size:
  9.0pt;line-height:112%;color:#666666'>.</span><span style='font-size:9.0pt;
  line-height:112%'>Exists</span><span style='font-size:9.0pt;line-height:112%;
  color:#666666'>(</span><span style='font-size:9.0pt;line-height:112%'>fullFilePath</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>))</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:#666666'>{</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:221.25pt;margin-bottom:
  12.3pt;margin-left:0in;text-indent:0in;line-height:112%'><span
  style='font-size:9.0pt;line-height:112%'> SendErrorResponse</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>(</span><span
  style='font-size:9.0pt;line-height:112%;color:red'>404</span><span
  style='font-size:9.0pt;line-height:112%'>, </span><span style='font-size:
  9.0pt;line-height:112%;color:#A60000'>&quot;File not found&quot;</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>); </span><span
  style='font-size:9.0pt;line-height:112%'></span><span
  style='font-size:9.0pt;line-height:112%;color:#0600FF'>continue</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>; </span><span
  style='font-size:9.0pt;line-height:112%'></span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>}</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:183.45pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:112%'><span style='font-size:
  9.0pt;line-height:112%'> Console</span><span style='font-size:
  9.0pt;line-height:112%;color:#666666'>.</span><span style='font-size:9.0pt;
  line-height:112%'>Write</span><span style='font-size:9.0pt;line-height:112%;
  color:#666666'>(</span><span style='font-size:9.0pt;line-height:112%;
  color:#A60000'>&quot; Sending file...&quot;</span><span style='font-size:
  9.0pt;line-height:112%;color:#666666'>); </span><span style='font-size:9.0pt;
  line-height:112%'></span><span style='font-size:9.0pt;line-height:
  112%;color:#0600FF'>using</span><span style='font-size:9.0pt;line-height:
  112%'> </span><span style='font-size:9.0pt;line-height:112%;color:#666666'>(</span><span
  style='font-size:9.0pt;line-height:112%;color:#0600FF'>var</span><span
  style='font-size:9.0pt;line-height:112%'> fileStream </span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>=</span><span
  style='font-size:9.0pt;line-height:112%'> File</span><span style='font-size:
  9.0pt;line-height:112%;color:#666666'>.</span><span style='font-size:9.0pt;
  line-height:112%'>OpenRead</span><span style='font-size:9.0pt;line-height:
  112%;color:#666666'>(</span><span style='font-size:9.0pt;line-height:112%'>fullFilePath</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>))</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:102.45pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:112%'><span style='font-size:
  9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:#666666'>{ </span><span style='font-size:9.0pt;
  line-height:112%'>response</span><span style='font-size:9.0pt;
  line-height:112%;color:#666666'>.</span><span style='font-size:9.0pt;
  line-height:112%'>ContentType </span><span style='font-size:9.0pt;line-height:
  112%;color:#666666'>=</span><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:#A60000'>&quot;application/octet-stream&quot;</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>; </span><span
  style='font-size:9.0pt;line-height:112%'>response</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>.</span><span
  style='font-size:9.0pt;line-height:112%'>ContentLength64 </span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>=</span><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:#666666'>(</span><span style='font-size:9.0pt;
  line-height:112%;color:#0600FF'>new</span><span style='font-size:9.0pt;
  line-height:112%'> FileInfo</span><span style='font-size:9.0pt;line-height:
  112%;color:#666666'>(</span><span style='font-size:9.0pt;line-height:112%'>fullFilePath</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>)).</span><span
  style='font-size:9.0pt;line-height:112%'>Length</span><span style='font-size:
  9.0pt;line-height:112%;color:#666666'>; </span><span style='font-size:9.0pt;
  line-height:112%'>response</span><span style='font-size:9.0pt;
  line-height:112%;color:#666666'>.</span><span style='font-size:9.0pt;
  line-height:112%'>AddHeader</span><span style='font-size:9.0pt;line-height:
  112%;color:#666666'>(</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:59.25pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:112%'><span style='font-size:
  9.0pt;line-height:112%'> </span><span style='font-size:
  9.0pt;line-height:112%;color:#A60000'>&quot;Content-Disposition&quot;</span><span
  style='font-size:9.0pt;line-height:112%'>, </span><span
  style='font-size:9.0pt;line-height:112%;color:#A60000'>&quot;Attachment;
  filename=</span><b><span style='font-size:9.0pt;line-height:112%;color:teal'>\&quot;</span></b><span
  style='font-size:9.0pt;line-height:112%;color:#A60000'>&quot;</span><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:#666666'>+</span><span style='font-size:9.0pt;
  line-height:112%'> Path</span><span style='font-size:9.0pt;line-height:112%;
  color:#666666'>.</span><span style='font-size:9.0pt;line-height:112%'>GetFileName</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>(</span><span
  style='font-size:9.0pt;line-height:112%'>fullFilePath</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>)</span><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:#666666'>+</span><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:#A60000'>&quot;</span><b><span style='font-size:9.0pt;line-height:112%;
  color:teal'>\&quot;</span></b><span style='font-size:9.0pt;line-height:112%;
  color:#A60000'>&quot;</span><span style='font-size:9.0pt;line-height:112%;
  color:#666666'>); </span><span style='font-size:9.0pt;line-height:112%'>fileStream</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>.</span><span
  style='font-size:9.0pt;line-height:112%'>CopyTo</span><span style='font-size:
  9.0pt;line-height:112%;color:#666666'>(</span><span style='font-size:9.0pt;
  line-height:112%'>response</span><span style='font-size:9.0pt;line-height:
  112%;color:#666666'>.</span><span style='font-size:9.0pt;line-height:112%'>OutputStream</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>);</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:#666666'>}</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:275.3pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:112%'><span style='font-size:
  9.0pt;line-height:112%'> response</span><span style='font-size:
  9.0pt;line-height:112%;color:#666666'>.</span><span style='font-size:9.0pt;
  line-height:112%'>OutputStream</span><span style='font-size:9.0pt;line-height:
  112%;color:#666666'>.</span><span style='font-size:9.0pt;line-height:112%'>Close</span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>(); </span><span
  style='font-size:9.0pt;line-height:112%'>response </span><span
  style='font-size:9.0pt;line-height:112%;color:#666666'>=</span><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:#0600FF'>null</span><span style='font-size:9.0pt;
  line-height:112%;color:#666666'>; </span><span style='font-size:9.0pt;
  line-height:112%'>Console</span><span style='font-size:9.0pt;
  line-height:112%;color:#666666'>.</span><span style='font-size:9.0pt;
  line-height:112%'>WriteLine</span><span style='font-size:9.0pt;line-height:
  112%;color:#666666'>(</span><span style='font-size:9.0pt;line-height:112%;
  color:#A60000'>&quot; Ok!&quot;</span><span style='font-size:9.0pt;
  line-height:112%;color:#666666'>);</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:#666666'>}</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:
  9.0pt;line-height:107%;color:#666666'>}</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=153
src=".NET%20Framework%20Notes%20for%20Professionals_files/image481.gif"></span><br
clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc281637">Chapter 56: HTTP clients</a></h1>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:3.4pt;margin-left:
-.25pt'><a name="_Toc281638">Section 56.1: Reading GET response as string using
System.Net.HttpClient</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.15pt;
margin-left:-.25pt;line-height:107%'><span style='font-size:9.0pt;line-height:
107%;background:#FAFAFA'>HttpClient</span> is available through <a
href="https://www.nuget.org/packages/Microsoft.Net.Http/"><span
style='color:#1889D0'>NuGet: Microsoft HTTP Client Libraries</span></a>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=191
src=".NET%20Framework%20Notes%20for%20Professionals_files/image482.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc281639">Section 56.2: Basic HTTP
downloader using System.Net.Http.HttpClient</a></h2>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=608
src=".NET%20Framework%20Notes%20for%20Professionals_files/image483.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=317
src=".NET%20Framework%20Notes%20for%20Professionals_files/image484.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc281640">Section 56.3: Reading GET
response as string using System.Net.HttpWebRequest</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=174
src=".NET%20Framework%20Notes%20for%20Professionals_files/image485.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc281641">Section 56.4: Reading GET
response as string using System.Net.WebClient</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=125
src=".NET%20Framework%20Notes%20for%20Professionals_files/image486.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc281642">Section 56.5: Sending a
POST request with a string payload using System.Net.HttpWebRequest</a></h2>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=175
src=".NET%20Framework%20Notes%20for%20Professionals_files/image487.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=104
src=".NET%20Framework%20Notes%20for%20Professionals_files/image488.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc281643">Section 56.6: Sending a
POST request with a string payload using System.Net.WebClient</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=223
src=".NET%20Framework%20Notes%20for%20Professionals_files/image489.gif"></span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:3.4pt;margin-left:
-.25pt'><a name="_Toc281644">Section 56.7: Sending a POST request with a string
payload using System.Net.HttpClient</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.15pt;
margin-left:-.25pt;line-height:107%'><span style='font-size:9.0pt;line-height:
107%;background:#FAFAFA'>HttpClient</span> is available through <a
href="https://www.nuget.org/packages/Microsoft.Net.Http/"><span
style='color:#1889D0'>NuGet: Microsoft HTTP Client Libraries</span></a>.</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=306
src=".NET%20Framework%20Notes%20for%20Professionals_files/image490.gif"></span></p>

<h1 style='margin-left:-.25pt'><a name="_Toc281645">Chapter 57: Serial Ports</a></h1>

<h2 style='margin-left:-.25pt'><a name="_Toc281646">Section 57.1: Basic
operation</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=109
src=".NET%20Framework%20Notes%20for%20Professionals_files/image491.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc281647">Section 57.2: List
available port names</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src=".NET%20Framework%20Notes%20for%20Professionals_files/image492.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc281648">Section 57.3: Asynchronous
read</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=355
src=".NET%20Framework%20Notes%20for%20Professionals_files/image493.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc281649">Section 57.4: Synchronous
text echo service</a></h2>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=272
src=".NET%20Framework%20Notes%20for%20Professionals_files/image494.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=71
src=".NET%20Framework%20Notes%20for%20Professionals_files/image495.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc281650">Section 57.5: Asynchronous
message receiver</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
0in;margin-left:-.45pt;text-indent:0in;line-height:107%'><img border=0
width=719 height=900 id="Picture 275338"
src=".NET%20Framework%20Notes%20for%20Professionals_files/image496.gif"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.85pt;margin-left:-.45pt;text-indent:0in;line-height:107%'><img border=0
width=719 height=712 id="Picture 275340"
src=".NET%20Framework%20Notes%20for%20Professionals_files/image497.gif"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.55pt;
margin-left:1.05pt'>This program waits for messages enclosed in <span
style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>STX</span> and <span
style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>ETX</span> bytes
and outputs the text coming between them. Everything else is discarded. On
write buffer overflow it stops. On other errors it reset input and output
buffers and waits for further messages.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.9pt;
margin-left:1.05pt'>The code illustrates:</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=166 style='width:124.2pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=72 valign=top style='width:.75in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>SerialPort</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>.</span></p>
  </td>
  <td width=86 valign=top style='width:.9in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>DataReceived</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:30.5pt'>Asynchronous serial port reading (see usage).</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=173 style='width:1.8in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=72 valign=top style='width:.75in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>SerialPort</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>.</span></p>
  </td>
  <td width=94 valign=top style='width:70.2pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>ErrorReceived</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:30.5pt'><span style='position:relative;z-index:-1895740416'><span
style='left:0px;position:absolute;left:28px;top:-120458px;width:46px;
height:1px'><img width=46 height=1
src=".NET%20Framework%20Notes%20for%20Professionals_files/image498.gif"></span></span>Serial
port error processing (see usage).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:30.5pt'>Non-text message-based protocol implementation.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:30.5pt'>Partial message reading.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=166 style='width:124.2pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=72 valign=top style='width:.75in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>SerialPort</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>.</span></p>
  </td>
  <td width=86 valign=top style='width:.9in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>DataReceived</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:60.5pt'>The event may happen earlier than entire message (up to <span
style='font-size:9.0pt;line-height:109%;background:#FAFAFA'>ETX</span>) comes.
The entire message may also not be available in the input buffer
(SerialPort.Read(..., ..., port.BytesToRead) reads only a part of the message).
In this case we stash the received part (<span style='font-size:9.0pt;
line-height:109%;background:#FAFAFA'>unprocessedBuffer</span>) and carry on
waiting for further data.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:21.4pt'><span style='font-size:11.0pt;line-height:109%'><img
border=0 width=5 height=5 id="Group 268790"
src=".NET%20Framework%20Notes%20for%20Professionals_files/image259.gif"></span>Dealing
with several messages coming in one go.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=166 style='width:124.2pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=72 valign=top style='width:.75in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>SerialPort</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#666666;background:#FAFAFA'>.</span></p>
  </td>
  <td width=86 valign=top style='width:.9in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>DataReceived</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:60.0pt;text-indent:-8.95pt'><span style='font-size:11.0pt;
line-height:109%'><img border=0 width=5 height=5 id="Group 266633"
src=".NET%20Framework%20Notes%20for%20Professionals_files/image499.gif"></span>The
 event may happen only after several messages have been sent by
the other end.<br clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc281651">Appendix A: Acronym
Glossary</a></h1>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:2.5pt;margin-left:
-.25pt'><a name="_Toc281652">Section A.1: .Net Related Acronyms</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.55pt;
margin-left:1.05pt'>Please note that some terms like JIT and GC are generic
enough to apply to many programming language environments and runtimes.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>CLR: Common Language Runtime</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>IL: Intermediate Language</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>EE: Execution Engine</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>JIT: Just-in-time compiler</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>GC: Garbage Collector</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>OOM: Out of memory</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>STA: Single-threaded apartment</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.6pt;
margin-left:1.05pt'>MTA: Multi-threaded apartment<br clear=all
style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc281653">Credits</a></h1>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:12.15pt;
margin-bottom:.2pt;margin-left:12.65pt;text-align:center;line-height:123%'>Thank
you greatly to all the people from Stack Overflow Documentation who helped
provide this content, more changes can be sent to <u><span style='color:#1889D0'>web@petercv.com</span></u>
for new content to be published or updated</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=349
 style='width:261.9pt;margin-left:1.0pt;border-collapse:collapse'>
 <tr style='height:12.55pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:12.55pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/389966/"><span style='color:#1889D0'>Adi
  Lester</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:12.55pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapters
  42 and 47</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1380428/"><span style='color:#1889D0'>Adil
  Mammadov</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  8</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1207195/"><span style='color:#1889D0'>Adriano
  Repetti</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapters
  1, 2, 4 and 18</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/2797802/"><span style='color:#1889D0'>Akshay
  Anand</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  25</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/100596/"><span style='color:#1889D0'>Alan
  McBee</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapters
  12, 14 and 47</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1560126/"><span style='color:#1889D0'>ale10ander</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapters
  16 and 35</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/4685428/"><span style='color:#1889D0'>Aleks
  Andreev</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapters
  10, 52 and 53</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/4896211/"><span style='color:#1889D0'>Alexander
  Mandt</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  49</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/444110/"><span style='color:#1889D0'>Alexander
  V.</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  8</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/151249/"><span style='color:#1889D0'>Alfred
  Myers</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  47</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/5777678/"><span style='color:#1889D0'>Aman
  Sharma</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapters
  5 and 42</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/520691/"><span style='color:#1889D0'>Andrew
  Jens</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  1</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1115360/"><span style='color:#1889D0'>Andrew
  Morton</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  25</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/39068/"><span style='color:#1889D0'>Andrey
  Shchekin</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  28</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/4590959/"><span style='color:#1889D0'>Andrius</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  32</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/3127813/"><span style='color:#1889D0'>Anik
  Saha</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  28</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/296526/"><span style='color:#1889D0'>Aphelion</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  34</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/54544/"><span style='color:#1889D0'>Arvin
  Baccay</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  47</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1249449/"><span style='color:#1889D0'>Arxae</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  19</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/3780629/"><span style='color:#1889D0'>Ashtonian</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  28</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/293099/"><span style='color:#1889D0'>Athari</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  1</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/5012730/"><span style='color:#1889D0'>avat</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  46</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/72746/"><span style='color:#1889D0'>Axarydax</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  51</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/6619191/"><span style='color:#1889D0'>BananaSft</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  47</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/4671754/"><span style='color:#1889D0'>Bassie</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  48</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/3355825/"><span style='color:#1889D0'>Behzad</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  39</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1523776/"><span style='color:#1889D0'>Benjamin
  Hodgson</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  8</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/429091/"><span style='color:#1889D0'>binki</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  45</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1842065/"><span style='color:#1889D0'>Bjrn</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapters
  4 and 10</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/23633/"><span style='color:#1889D0'>Bradley
  Grainger</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  8</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1977143/"><span style='color:#1889D0'>Bruno
  Garcia</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  8</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/340760/"><span style='color:#1889D0'>BrunoLM</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  15</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/186133/"><span style='color:#1889D0'>Carlos
  Muoz</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  8</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/266143/"><span style='color:#1889D0'>CodeCaster</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'>Chapters 8, 17, 28, 47 and 56</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/23528/"><span style='color:#1889D0'>Daniel
  A. White</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapters
  1 and 25</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/307968/"><span style='color:#1889D0'>Darrel
  Lee</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  4</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/42841/"><span style='color:#1889D0'>Dave
  R.</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  47</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/66532/"><span style='color:#1889D0'>dbasnett</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  35</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/6123921/"><span style='color:#1889D0'>delete
  me</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  18</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/462639/"><span style='color:#1889D0'>demonplus</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapters
  30 and 49</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/3699612/"><span style='color:#1889D0'>Denuath</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  15</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/526704/"><span style='color:#1889D0'>DLeh</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapters
  31 and 33</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/4295017/"><span style='color:#1889D0'>Dmitry
  Egorov</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapters
  27 and 57</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1764853/"><span style='color:#1889D0'>DoNot</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  8</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/328730/"><span style='color:#1889D0'>Dr
  Rob Lang</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  9</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1816093/"><span style='color:#1889D0'>Drew</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  25</p>
  </td>
 </tr>
 <tr style='height:12.55pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:12.55pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/3845456/"><span style='color:#1889D0'>DrewJordan</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:12.55pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapters
  12 and 45</p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:275.7pt;margin-bottom:
0in;margin-left:-28.35pt;text-indent:0in;line-height:107%'>&nbsp;</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=349
 style='width:261.9pt;margin-left:1.0pt;border-collapse:collapse'>
 <tr style='height:12.55pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:12.55pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/2385/"><span style='color:#1889D0'>Eduardo
  Molteni</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:12.55pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  8</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1875256/"><span style='color:#1889D0'>Ehsan
  Sajjad</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  8</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/2132357/"><span style='color:#1889D0'>Eric</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  32</p>
  </td>
 </tr>
 <tr style='height:14.55pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.55pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/316799/"><span style='color:#1889D0'>Felipe
  Oriani</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.55pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapters
  4 and 5</p>
  </td>
 </tr>
 <tr style='height:14.6pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.6pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/21704/"><span style='color:#1889D0'>Filip
  Fr</span></a><a href="https://stackoverflow.com/users/21704/"><span
  style='font-family:"Arial",sans-serif;color:#1889D0'>&#261;</span></a><a
  href="https://stackoverflow.com/users/21704/"><span style='color:#1889D0'>cz</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.6pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  17</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/40868/"><span style='color:#1889D0'>Fredou</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  48</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1590988/"><span style='color:#1889D0'>Gajendra</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  37</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/29638/"><span style='color:#1889D0'>GalacticCowboy</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapters
  3 and 8</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/177317/"><span style='color:#1889D0'>George
  Polevoy</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapters
  4, 11 and 34</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1938828/"><span style='color:#1889D0'>Guanxi</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  22</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/286976/"><span style='color:#1889D0'>Gusdor</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapters
  43 and 44</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/2420979/"><span style='color:#1889D0'>Haney</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  8</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/5744/"><span style='color:#1889D0'>harriyott</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  5</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/834261/"><span style='color:#1889D0'>hatchet</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  4</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/87698/"><span style='color:#1889D0'>Heinzi</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  25</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/215752/"><span style='color:#1889D0'>Hogan</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  4</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/3521193/"><span style='color:#1889D0'>Hywel
  Rees</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  7</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/885318/"><span style='color:#1889D0'>i3arnon</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  38</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/21061/"><span style='color:#1889D0'>Ian</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  4</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1260204/"><span style='color:#1889D0'>Igor</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  25</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/6177689/"><span style='color:#1889D0'>Ingenioushax</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  16</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/3874053/"><span style='color:#1889D0'>Jacobr365</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapters
  38, 42 and 43</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1645454/"><span style='color:#1889D0'>Jagadisha
  B S</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  49</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1604229/"><span style='color:#1889D0'>JamyRyals</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  42</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/637783/"><span style='color:#1889D0'>jbtule</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  8</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/2837810/"><span style='color:#1889D0'>Jigar</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  10</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/231821/"><span style='color:#1889D0'>Jim</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  11</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/3042204/"><span style='color:#1889D0'>jnovo</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  8</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1083771/"><span style='color:#1889D0'>Joe
  Amenta</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapters
  8 and 20</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/525539/"><span style='color:#1889D0'>John</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  3</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/80572/"><span style='color:#1889D0'>Kevin
  Montrose</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  1</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/4574/"><span style='color:#1889D0'>Konamiman</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'>Chapters 8, 42, 54, 55 and 56</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1615769/"><span style='color:#1889D0'>Krikor
  Ailanjian</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  36</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/2312877/"><span style='color:#1889D0'>Kritner</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  47</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/4558029/"><span style='color:#1889D0'>lokusking</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  49</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/863564/"><span style='color:#1889D0'>Lorenzo
  Dematt</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  10</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/3032289/"><span style='color:#1889D0'>Luaan</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  23</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/3764814/"><span style='color:#1889D0'>Lucas
  Trzesniewski</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  9</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/3131696/"><span style='color:#1889D0'>M22an</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  32</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/5962841/"><span style='color:#1889D0'>Mafii</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  47</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/7722915/"><span style='color:#1889D0'>mahdi
  abasi</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  50</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1163867/"><span style='color:#1889D0'>MarcinJuraszek</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapters
  1 and 8</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/2679750/"><span style='color:#1889D0'>Mark
  C.</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  5</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1509764/"><span style='color:#1889D0'>Matas
  Vaitkevicius</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapters
  10 and 28</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/3835956/"><span style='color:#1889D0'>Mathias
  Mller</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  42</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1016343/"><span style='color:#1889D0'>Matt</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  49</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/5543849/"><span style='color:#1889D0'>Matt
  dc</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  15</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1139722/"><span style='color:#1889D0'>matteeyah</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  1</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/89586/"><span style='color:#1889D0'>Matthew
  Whited</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  13</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/8384/"><span style='color:#1889D0'>McKay</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  8</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/3125553/"><span style='color:#1889D0'>Mellow</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  39</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/3164614/"><span style='color:#1889D0'>Mihail
  Stancescu</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  24</p>
  </td>
 </tr>
 <tr style='height:12.55pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:12.55pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/391656/"><span style='color:#1889D0'>Mr.Mindor</span></a></p>
  </td>
  <td width=179 valign=top style='width:134.4pt;padding:0in 0in 0in 0in;
  height:12.55pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  8</p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:319.45pt;margin-bottom:
0in;margin-left:-28.35pt;text-indent:0in;line-height:107%'>&nbsp;</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=291
 style='width:218.15pt;margin-left:1.0pt;border-collapse:collapse'>
 <tr style='height:12.55pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:12.55pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/3008260/"><span style='color:#1889D0'>MSE</span></a></p>
  </td>
  <td width=121 valign=top style='width:90.65pt;padding:0in 0in 0in 0in;
  height:12.55pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  40</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1458122/"><span style='color:#1889D0'>n.podbielski</span></a></p>
  </td>
  <td width=121 valign=top style='width:90.65pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  11</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/3191599/"><span style='color:#1889D0'>Nate
  Barbettini</span></a></p>
  </td>
  <td width=121 valign=top style='width:90.65pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  8</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/3248293/"><span style='color:#1889D0'>Nikola.Lukovic</span></a></p>
  </td>
  <td width=121 valign=top style='width:90.65pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  38</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/4182275/"><span style='color:#1889D0'>NikolayKondratyev</span></a></p>
  </td>
  <td width=121 valign=top style='width:90.65pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  23</p>
  </td>
 </tr>
 <tr style='height:14.55pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.55pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/3850405/"><span style='color:#1889D0'>Ogglas</span></a></p>
  </td>
  <td width=121 valign=top style='width:90.65pt;padding:0in 0in 0in 0in;
  height:14.55pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  48</p>
  </td>
 </tr>
 <tr style='height:14.6pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.6pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/5186881/"><span style='color:#1889D0'>On</span></a><a
  href="https://stackoverflow.com/users/5186881/"><span style='color:#1889D0'>d</span></a><a
  href="https://stackoverflow.com/users/5186881/"><span style='font-family:
  "Arial",sans-serif;color:#1889D0'>&#345;</span></a><a
  href="https://stackoverflow.com/users/5186881/"><span style='color:#1889D0'>ej
  </span></a><a href="https://stackoverflow.com/users/5186881/"><span
  style='font-family:"Arial",sans-serif;color:#1889D0'></span></a><a
  href="https://stackoverflow.com/users/5186881/"><span style='color:#1889D0'>torc</span></a></p>
  </td>
  <td width=121 valign=top style='width:90.65pt;padding:0in 0in 0in 0in;
  height:14.6pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  48</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/365188/"><span style='color:#1889D0'>Ozair
  Kafray</span></a></p>
  </td>
  <td width=121 valign=top style='width:90.65pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  28</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/4340086/"><span style='color:#1889D0'>Pavel
  Mayorov</span></a></p>
  </td>
  <td width=121 valign=top style='width:90.65pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  42</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/921054/"><span style='color:#1889D0'>Pavel
  Voronin</span></a></p>
  </td>
  <td width=121 valign=top style='width:90.65pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapters
  2 and 42</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/4166211/"><span style='color:#1889D0'>PedroSouki</span></a></p>
  </td>
  <td width=121 valign=top style='width:90.65pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  32</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/2619912/"><span style='color:#1889D0'>ProgramFOX</span></a></p>
  </td>
  <td width=121 valign=top style='width:90.65pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  21</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/4882032/"><span style='color:#1889D0'>Ringil</span></a></p>
  </td>
  <td width=121 valign=top style='width:90.65pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  4</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/557445/"><span style='color:#1889D0'>Rion
  Williams</span></a></p>
  </td>
  <td width=121 valign=top style='width:90.65pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  1</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/6471538/"><span style='color:#1889D0'>Robert
  Columbia</span></a></p>
  </td>
  <td width=121 valign=top style='width:90.65pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  4</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/5981756/"><span style='color:#1889D0'>RoyalPotato</span></a></p>
  </td>
  <td width=121 valign=top style='width:90.65pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  17</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1280810/"><span style='color:#1889D0'>Ruben
  Steins</span></a></p>
  </td>
  <td width=121 valign=top style='width:90.65pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  8</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/5571927/"><span style='color:#1889D0'>Salvador
  Rubio Martinez</span></a></p>
  </td>
  <td width=121 valign=top style='width:90.65pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  8</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/628418/"><span style='color:#1889D0'>Sammi</span></a></p>
  </td>
  <td width=121 valign=top style='width:90.65pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  8</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/5101046/"><span style='color:#1889D0'>Scott
  Hannen</span></a></p>
  </td>
  <td width=121 valign=top style='width:90.65pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'>Chapters 26 and 29</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/3288649/"><span style='color:#1889D0'>SeeuD1</span></a></p>
  </td>
  <td width=121 valign=top style='width:90.65pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  1</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/5575747/"><span style='color:#1889D0'>Sergio
  Domnguez</span></a></p>
  </td>
  <td width=121 valign=top style='width:90.65pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  8</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/2245256/"><span style='color:#1889D0'>Sidewinder94</span></a></p>
  </td>
  <td width=121 valign=top style='width:90.65pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  8</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/356550/"><span style='color:#1889D0'>smdrager</span></a></p>
  </td>
  <td width=121 valign=top style='width:90.65pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  10</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1460422/"><span style='color:#1889D0'>starbeamrainbowlabs</span></a></p>
  </td>
  <td width=121 valign=top style='width:90.65pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'>Chapters 37 and 47</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1197518/"><span style='color:#1889D0'>Steve</span></a></p>
  </td>
  <td width=121 valign=top style='width:90.65pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  30</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1359668/"><span style='color:#1889D0'>Steven
  Doggart</span></a></p>
  </td>
  <td width=121 valign=top style='width:90.65pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  1</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/122507/"><span style='color:#1889D0'>Stilgar</span></a></p>
  </td>
  <td width=121 valign=top style='width:90.65pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  11</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/59081/"><span style='color:#1889D0'>Tanveer
  Badar</span></a></p>
  </td>
  <td width=121 valign=top style='width:90.65pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  58</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/892536/"><span style='color:#1889D0'>tehDorf</span></a></p>
  </td>
  <td width=121 valign=top style='width:90.65pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapters
  6 and 15</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/24839/"><span style='color:#1889D0'>the
  berserker</span></a></p>
  </td>
  <td width=121 valign=top style='width:90.65pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  4</p>
  </td>
 </tr>
 <tr style='height:26.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:26.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1892179/"><span style='color:#1889D0'>Theodoros</span></a></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1892179/"><span style='color:#1889D0'>Chatzigiannakis</span></a></p>
  </td>
  <td width=121 style='width:90.65pt;padding:0in 0in 0in 0in;height:26.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  37</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/5548042/"><span style='color:#1889D0'>Thomas
  Bledsoe</span></a></p>
  </td>
  <td width=121 valign=top style='width:90.65pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  42</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/2701677/"><span style='color:#1889D0'>Thriggle</span></a></p>
  </td>
  <td width=121 valign=top style='width:90.65pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  32</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1045881/"><span style='color:#1889D0'>toddmo</span></a></p>
  </td>
  <td width=121 valign=top style='width:90.65pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  23</p>
  </td>
 </tr>
 <tr style='height:14.55pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.55pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1469980/"><span style='color:#1889D0'>Tolga
  Evcimen</span></a></p>
  </td>
  <td width=121 valign=top style='width:90.65pt;padding:0in 0in 0in 0in;
  height:14.55pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  32</p>
  </td>
 </tr>
 <tr style='height:14.6pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.6pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/2715716/"><span style='color:#1889D0'>Tom</span></a><a
  href="https://stackoverflow.com/users/2715716/"><span style='font-family:
  "Arial",sans-serif;color:#1889D0'></span></a><a
  href="https://stackoverflow.com/users/2715716/"><span style='color:#1889D0'>
  Hbelbauer</span></a></p>
  </td>
  <td width=121 valign=top style='width:90.65pt;padding:0in 0in 0in 0in;
  height:14.6pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  4</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/2321864/"><span style='color:#1889D0'>user2321864</span></a></p>
  </td>
  <td width=121 valign=top style='width:90.65pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  25</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1805776/"><span style='color:#1889D0'>vicky</span></a></p>
  </td>
  <td width=121 valign=top style='width:90.65pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  30</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/6733949/"><span style='color:#1889D0'>wangengzheng</span></a></p>
  </td>
  <td width=121 valign=top style='width:90.65pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  11</p>
  </td>
 </tr>
 <tr style='height:14.55pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.55pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/7085170/"><span style='color:#1889D0'>Yahfoufi</span></a></p>
  </td>
  <td width=121 valign=top style='width:90.65pt;padding:0in 0in 0in 0in;
  height:14.55pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  41</p>
  </td>
 </tr>
 <tr style='height:12.6pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:12.6pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/3696113/"><span style='font-family:
  "Arial",sans-serif;color:#1889D0'>&#647;</span></a><a
  href="https://stackoverflow.com/users/3696113/"><span style='color:#1889D0'>ol</span></a><a
  href="https://stackoverflow.com/users/3696113/"><span style='font-family:
  "Arial",sans-serif;color:#1889D0'>&#592;</span></a><a
  href="https://stackoverflow.com/users/3696113/"><span style='font-family:
  "Arial",sans-serif;color:#1889D0'>&#477;</span></a><a
  href="https://stackoverflow.com/users/3696113/"><span style='color:#1889D0'>z
  </span></a><a href="https://stackoverflow.com/users/3696113/"><span
  style='font-family:"Arial",sans-serif;color:#1889D0'>&#477;</span></a><a
  href="https://stackoverflow.com/users/3696113/"><span style='font-family:
  "Arial",sans-serif;color:#1889D0'>&#613;</span></a><a
  href="https://stackoverflow.com/users/3696113/"><span style='font-family:
  "Arial",sans-serif;color:#1889D0'>&#647;</span></a><a
  href="https://stackoverflow.com/users/3696113/"><span style='color:#1889D0'>
  qoq</span></a></p>
  </td>
  <td width=121 valign=top style='width:90.65pt;padding:0in 0in 0in 0in;
  height:12.6pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  1</p>
  </td>
 </tr>
</table>

</div>

<span style='font-size:10.0pt;line-height:109%;font-family:"Calibri",sans-serif;
color:black'><br clear=all style='page-break-before:always'>
</span>

<div class=WordSection3>

<h1 style='margin-left:-43.15pt'><a name="_Toc281654">You may also like</a></h1>

<p class=MsoNormal style='margin-top:0in;margin-right:-45.95pt;margin-bottom:
0in;margin-left:-47.25pt;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=726 height=992
id="Group 267165"
src=".NET%20Framework%20Notes%20for%20Professionals_files/image500.gif"></span></p>

</div>

</body>

</html>
