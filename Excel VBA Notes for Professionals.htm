<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=Generator content="Microsoft Word 15 (filtered)">
<title>Excel VBA Notes for Professionals</title>
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Helvetica;
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:Courier;
	panose-1:2 7 4 9 2 2 5 2 4 4;}
@font-face
	{font-family:"Tms Rmn";
	panose-1:2 2 6 3 4 5 5 2 3 4;}
@font-face
	{font-family:Helv;
	panose-1:2 11 6 4 2 2 2 3 2 4;}
@font-face
	{font-family:"New York";
	panose-1:2 4 5 3 6 5 6 2 3 4;}
@font-face
	{font-family:System;
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"MS Mincho";
	panose-1:2 2 6 9 4 2 5 8 3 4;}
@font-face
	{font-family:Batang;
	panose-1:2 3 6 0 0 1 1 1 1 1;}
@font-face
	{font-family:SimSun;
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:PMingLiU;
	panose-1:2 1 6 1 0 1 1 1 1 1;}
@font-face
	{font-family:"MS Gothic";
	panose-1:2 11 6 9 7 2 5 8 2 4;}
@font-face
	{font-family:Dotum;
	panose-1:2 11 6 0 0 1 1 1 1 1;}
@font-face
	{font-family:SimHei;
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:MingLiU;
	panose-1:2 1 6 9 0 1 1 1 1 1;}
@font-face
	{font-family:Mincho;
	panose-1:2 2 6 9 4 3 5 8 3 5;}
@font-face
	{font-family:Gulim;
	panose-1:2 11 6 0 0 1 1 1 1 1;}
@font-face
	{font-family:Century;
	panose-1:2 4 6 4 5 5 5 2 3 4;}
@font-face
	{font-family:"Angsana New";
	panose-1:2 2 6 3 5 4 5 2 3 4;}
@font-face
	{font-family:"Cordia New";
	panose-1:2 11 3 4 2 2 2 2 2 4;}
@font-face
	{font-family:Mangal;
	panose-1:0 0 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:Latha;
	panose-1:2 0 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:Sylfaen;
	panose-1:1 10 5 2 5 3 6 3 3 3;}
@font-face
	{font-family:Vrinda;
	panose-1:0 0 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:Raavi;
	panose-1:2 0 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:Shruti;
	panose-1:2 0 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:Sendnya;
	panose-1:0 0 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:Gautami;
	panose-1:2 0 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:Tunga;
	panose-1:0 0 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Estrangelo Edessa";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:"Yu Gothic";
	panose-1:2 11 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:DengXian;
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:"Calibri Light";
	panose-1:2 15 3 2 2 2 4 3 2 4;}
@font-face
	{font-family:"Palatino Linotype";
	panose-1:2 4 5 2 5 5 5 3 3 4;}
@font-face
	{font-family:Verdana;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
	{font-family:"Arial Unicode MS";
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:"Aptos Display";}
@font-face
	{font-family:Aptos;}
@font-face
	{font-family:"Segoe UI Emoji";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:1.5pt;
	margin-left:0in;
	text-indent:.5pt;
	line-height:110%;
	font-size:10.0pt;
	font-family:"Calibri",sans-serif;
	color:black;}
h1
	{mso-style-link:"Heading 1 Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:.15pt;
	margin-left:.5pt;
	text-indent:-.5pt;
	line-height:110%;
	page-break-after:avoid;
	font-size:26.0pt;
	font-family:"Calibri",sans-serif;
	color:#02723B;}
h2
	{mso-style-link:"Heading 2 Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:2.7pt;
	margin-left:.5pt;
	text-indent:-.5pt;
	line-height:107%;
	page-break-after:avoid;
	font-size:18.0pt;
	font-family:"Calibri",sans-serif;
	color:#02723B;}
p.MsoToc1, li.MsoToc1, div.MsoToc1
	{margin-top:0in;
	margin-right:.75pt;
	margin-bottom:1.5pt;
	margin-left:.75pt;
	text-indent:.5pt;
	line-height:110%;
	font-size:10.0pt;
	font-family:"Calibri",sans-serif;
	color:black;}
p.MsoToc2, li.MsoToc2, div.MsoToc2
	{margin-top:0in;
	margin-right:.75pt;
	margin-bottom:2.85pt;
	margin-left:20.75pt;
	text-indent:.5pt;
	line-height:110%;
	font-size:10.0pt;
	font-family:"Calibri",sans-serif;
	color:black;}
span.Heading2Char
	{mso-style-name:"Heading 2 Char";
	mso-style-link:"Heading 2";
	font-family:"Calibri",sans-serif;
	color:#02723B;
	font-weight:bold;}
span.Heading1Char
	{mso-style-name:"Heading 1 Char";
	mso-style-link:"Heading 1";
	font-family:"Calibri",sans-serif;
	color:#02723B;
	font-weight:bold;}
span.msoIns
	{mso-style-name:"";
	text-decoration:underline;
	color:#65B4B4;}
span.msoDel
	{mso-style-name:"";
	text-decoration:line-through;
	color:#FF4B4B;}
.MsoChpDefault
	{font-size:12.0pt;}
.MsoPapDefault
	{margin-bottom:8.0pt;
	line-height:115%;}
 /* Page Definitions */
 @page WordSection1
	{size:595.3pt 841.9pt;
	margin:23.8pt 41.95pt 49.4pt 28.35pt;}
div.WordSection1
	{page:WordSection1;}
@page WordSection2
	{size:595.3pt 841.9pt;
	margin:23.8pt 28.4pt 42.5pt 28.35pt;}
div.WordSection2
	{page:WordSection2;}
@page WordSection3
	{size:595.3pt 841.9pt;
	margin:63.75pt 1.0in 34.15pt 1.0in;}
div.WordSection3
	{page:WordSection3;}
 /* List Definitions */
 ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>

</head>

<body lang=EN-US style='word-wrap:break-word'>

<div class=WordSection1>

<p class=MsoNormal style='margin-top:0in;margin-right:553.35pt;margin-bottom:
0in;margin-left:-28.35pt;text-indent:0in;line-height:107%'><img width=792
height=1120 src="Excel%20VBA%20Notes%20for%20Professionals_files/image001.jpg"><br
clear=ALL>
<br clear=all style='page-break-before:always'>
</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:2.0pt;
margin-left:-.25pt;text-indent:-.5pt'><b><span style='font-size:26.0pt;
line-height:110%;color:#02723B'>Contents</span></b></p>

<p class=MsoToc1><a href="#_Toc152104"><b><span style='font-size:12.0pt;
line-height:110%;color:#02723B'>About</span></b><span style='color:black;
text-decoration:none'>........................................................................................................................................................................................................................ </span><span style='color:black;text-decoration:none'>1</span></a></p>

<p class=MsoToc1><a href="#_Toc152105"><b><span style='font-size:12.0pt;
line-height:110%;color:#02723B'>Chapter 1: Getting started with Excel VBA</span></b><span
style='color:black;text-decoration:none'>.......................................................................................................................................... </span><span style='color:black;text-decoration:none'>2</span></a></p>

<p class=MsoToc2><a href="#_Toc152106"><span style='color:#02723B'>Section 1.1:
Opening the Visual Basic Editor (VBE)</span><span style='color:black;
text-decoration:none'>.................................................................................................................................... </span><span style='color:black;text-decoration:none'>3</span></a></p>

<p class=MsoToc2><a href="#_Toc152107"><span style='color:#02723B'>Section 1.2:
Declaring Variables</span><span style='color:black;text-decoration:none'>.................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>5</span></a></p>

<p class=MsoToc2><a href="#_Toc152108"><span style='color:#02723B'>Section 1.3:
Adding a new Object Library Reference</span><span style='color:black;
text-decoration:none'>................................................................................................................................. </span><span style='color:black;text-decoration:none'>6</span></a></p>

<p class=MsoToc2><a href="#_Toc152109"><span style='color:#02723B'>Section 1.4:
Hello World</span><span style='color:black;text-decoration:none'>............................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>10</span></a></p>

<p class=MsoToc2><a href="#_Toc152110"><span style='color:#02723B'>Section 1.5:
Getting Started with the Excel Object Model</span><span style='color:black;
text-decoration:none'>..................................................................................................................... </span><span style='color:black;text-decoration:none'>12</span></a></p>

<p class=MsoToc1><a href="#_Toc152111"><b><span style='font-size:12.0pt;
line-height:110%;color:#02723B'>Chapter 2: Arrays</span></b><span
style='color:black;text-decoration:none'>............................................................................................................................................................................................. </span><span style='color:black;text-decoration:none'>16</span></a></p>

<p class=MsoToc2><a href="#_Toc152112"><span style='color:#02723B'>Section 2.1:
Dynamic Arrays (Array Resizing and Dynamic Handling)</span><span
style='color:black;text-decoration:none'>.................................................................................................. </span><span style='color:black;text-decoration:none'>16</span></a></p>

<p class=MsoToc2><a href="#_Toc152113"><span style='color:#02723B'>Section 2.2:
Populating arrays (adding values)</span><span style='color:black;text-decoration:
none'>......................................................................................................................................... </span><span style='color:black;text-decoration:none'>16</span></a></p>

<p class=MsoToc2><a href="#_Toc152114"><span style='color:#02723B'>Section 2.3:
Jagged Arrays (Arrays of Arrays)</span><span style='color:black;text-decoration:
none'>........................................................................................................................................... </span><span style='color:black;text-decoration:none'>17</span></a></p>

<p class=MsoToc2><a href="#_Toc152115"><span style='color:#02723B'>Section 2.4:
Check if Array is Initialized (If it contains elements or not)</span><span
style='color:black;text-decoration:none'>.............................................................................................. </span><span style='color:black;text-decoration:none'>17</span></a></p>

<p class=MsoToc2><a href="#_Toc152116"><span style='color:#02723B'>Section 2.5:
Dynamic Arrays [Array Declaration, Resizing]</span><span style='color:black;
text-decoration:none'>..................................................................................................................... </span><span style='color:black;text-decoration:none'>17</span></a></p>

<p class=MsoToc1><a href="#_Toc152117"><b><span style='font-size:12.0pt;
line-height:110%;color:#02723B'>Chapter 3: Conditional statements</span></b><span
style='color:black;text-decoration:none'>....................................................................................................................................................... </span><span style='color:black;text-decoration:none'>19</span></a></p>

<p class=MsoToc2><a href="#_Toc152118"><span style='color:#02723B'>Section 3.1:
The If statement</span><span style='color:black;text-decoration:none'>....................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>19</span></a></p>

<p class=MsoToc1><a href="#_Toc152119"><b><span style='font-size:12.0pt;
line-height:110%;color:#02723B'>Chapter 4: Ranges and Cells</span></b><span
style='color:black;text-decoration:none'>...................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>21</span></a></p>

<p class=MsoToc2><a href="#_Toc152120"><span style='color:#02723B'>Section 4.1:
Ways to refer to a single cell</span><span style='color:black;text-decoration:
none'>.................................................................................................................................................. </span><span style='color:black;text-decoration:none'>21</span></a></p>

<p class=MsoToc2><a href="#_Toc152121"><span style='color:#02723B'>Section 4.2:
Creating a Range</span><span style='color:black;text-decoration:none'>...................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>21</span></a></p>

<p class=MsoToc2><a href="#_Toc152122"><span style='color:#02723B'>Section 4.3:
O&#57379;set Property</span><span style='color:black;text-decoration:none'>......................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>23</span></a></p>

<p class=MsoToc2><a href="#_Toc152123"><span style='color:#02723B'>Section 4.4:
Saving a reference to a cell in a variable</span><span style='color:black;
text-decoration:none'>............................................................................................................................. </span><span style='color:black;text-decoration:none'>23</span></a></p>

<p class=MsoToc2><a href="#_Toc152124"><span style='color:#02723B'>Section 4.5:
How to Transpose Ranges (Horizontal to Vertical &amp; vice versa)</span><span
style='color:black;text-decoration:none'>...................................................................................... </span><span style='color:black;text-decoration:none'>23</span></a></p>

<p class=MsoToc1><a href="#_Toc152125"><b><span style='font-size:12.0pt;
line-height:110%;color:#02723B'>Chapter 5: Named Ranges</span></b><span
style='color:black;text-decoration:none'>.......................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>25</span></a></p>

<p class=MsoToc2><a href="#_Toc152126"><span style='color:#02723B'>Section 5.1:
Define A Named Range</span><span style='color:black;text-decoration:none'>........................................................................................................................................................... </span><span style='color:black;text-decoration:none'>25</span></a></p>

<p class=MsoToc2><a href="#_Toc152127"><span style='color:#02723B'>Section 5.2:
Using Named Ranges in VBA</span><span style='color:black;text-decoration:none'>................................................................................................................................................. </span><span style='color:black;text-decoration:none'>25</span></a></p>

<p class=MsoToc2><a href="#_Toc152128"><span style='color:#02723B'>Section 5.3:
Manage Named Range(s) using Name Manager</span><span style='color:black;
text-decoration:none'>............................................................................................................... </span><span style='color:black;text-decoration:none'>26</span></a></p>

<p class=MsoToc2><a href="#_Toc152129"><span style='color:#02723B'>Section 5.4:
Named Range Arrays</span><span style='color:black;text-decoration:none'>............................................................................................................................................................... </span><span style='color:black;text-decoration:none'>28</span></a></p>

<p class=MsoToc1><a href="#_Toc152130"><b><span style='font-size:12.0pt;
line-height:110%;color:#02723B'>Chapter 6: Merged Cells / Ranges</span></b><span
style='color:black;text-decoration:none'>.......................................................................................................................................................... </span><span style='color:black;text-decoration:none'>29</span></a></p>

<p class=MsoToc2><a href="#_Toc152131"><span style='color:#02723B'>Section 6.1:
Think twice before using Merged Cells/Ranges</span><span style='color:black;
text-decoration:none'>................................................................................................................. </span><span style='color:black;text-decoration:none'>29</span></a></p>

<p class=MsoToc1><a href="#_Toc152132"><b><span style='font-size:12.0pt;
line-height:110%;color:#02723B'>Chapter 7: Locating duplicate values in a range</span></b><span
style='color:black;text-decoration:none'>............................................................................................................................. </span><span style='color:black;text-decoration:none'>30</span></a></p>

<p class=MsoToc2><a href="#_Toc152133"><span style='color:#02723B'>Section 7.1:
Find duplicates in a range</span><span style='color:black;text-decoration:none'>...................................................................................................................................................... </span><span style='color:black;text-decoration:none'>30</span></a></p>

<p class=MsoToc1><a href="#_Toc152134"><b><span style='font-size:12.0pt;
line-height:110%;color:#02723B'>Chapter 8: User Defined Functions (UDFs)</span></b><span
style='color:black;text-decoration:none'>........................................................................................................................................ </span><span style='color:black;text-decoration:none'>32</span></a></p>

<p class=MsoToc2><a href="#_Toc152135"><span style='color:#02723B'>Section 8.1:
Allow full column references without penalty</span><span style='color:black;
text-decoration:none'>................................................................................................................... </span><span style='color:black;text-decoration:none'>32</span></a></p>

<p class=MsoToc2><a href="#_Toc152136"><span style='color:#02723B'>Section 8.2:
Count Unique values in Range</span><span style='color:black;text-decoration:
none'>.............................................................................................................................................. </span><span style='color:black;text-decoration:none'>33</span></a></p>

<p class=MsoToc2><a href="#_Toc152137"><span style='color:#02723B'>Section 8.3:
UDF - Hello World</span><span style='color:black;text-decoration:none'>.................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>33</span></a></p>

<p class=MsoToc1><a href="#_Toc152138"><b><span style='font-size:12.0pt;
line-height:110%;color:#02723B'>Chapter 9: Conditional formatting using VBA</span></b><span
style='color:black;text-decoration:none'>................................................................................................................................. </span><span style='color:black;text-decoration:none'>36</span></a></p>

<p class=MsoToc2><a href="#_Toc152139"><span style='color:#02723B'>Section 9.1:
FormatConditions.Add</span><span style='color:black;text-decoration:none'>............................................................................................................................................................ </span><span style='color:black;text-decoration:none'>36</span></a></p>

<p class=MsoToc2><a href="#_Toc152140"><span style='color:#02723B'>Section 9.2:
Remove conditional format</span><span style='color:black;text-decoration:none'>................................................................................................................................................... </span><span style='color:black;text-decoration:none'>37</span></a></p>

<p class=MsoToc2><a href="#_Toc152141"><span style='color:#02723B'>Section 9.3:
FormatConditions.AddUniqueValues</span><span style='color:black;text-decoration:
none'>................................................................................................................................... </span><span style='color:black;text-decoration:none'>37</span></a></p>

<p class=MsoToc2><a href="#_Toc152142"><span style='color:#02723B'>Section 9.4:
FormatConditions.AddTop10</span><span style='color:black;text-decoration:none'>................................................................................................................................................. </span><span style='color:black;text-decoration:none'>38</span></a></p>

<p class=MsoToc2><a href="#_Toc152143"><span style='color:#02723B'>Section 9.5:
FormatConditions.AddAboveAverage</span><span style='color:black;text-decoration:
none'>.................................................................................................................................. </span><span style='color:black;text-decoration:none'>38</span></a></p>

<p class=MsoToc2><a href="#_Toc152144"><span style='color:#02723B'>Section 9.6:
FormatConditions.AddIconSetCondition</span><span style='color:black;text-decoration:
none'>............................................................................................................................. </span><span style='color:black;text-decoration:none'>38</span></a></p>

<p class=MsoToc1><a href="#_Toc152145"><b><span style='font-size:12.0pt;
line-height:110%;color:#02723B'>Chapter 10: Workbooks</span></b><span
style='color:black;text-decoration:none'>............................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>41</span></a></p>

<p class=MsoToc2><a href="#_Toc152146"><span style='color:#02723B'>Section
10.1: When To Use ActiveWorkbook and ThisWorkbook</span><span style='color:
black;text-decoration:none'>......................................................................................................... </span><span style='color:black;text-decoration:none'>41</span></a></p>

<p class=MsoToc2><a href="#_Toc152147"><span style='color:#02723B'>Section
10.2: Changing The Default Number of Worksheets In A New Workbook</span><span
style='color:black;text-decoration:none'>............................................................................ </span><span style='color:black;text-decoration:none'>41</span></a></p>

<p class=MsoToc2><a href="#_Toc152148"><span style='color:#02723B'>Section
10.3: Application Workbooks</span><span style='color:black;text-decoration:
none'>........................................................................................................................................................ </span><span style='color:black;text-decoration:none'>41</span></a></p>

<p class=MsoToc2><a href="#_Toc152149"><span style='color:#02723B'>Section
10.4: Opening A (New) Workbook, Even If It's Already Open</span><span
style='color:black;text-decoration:none'>................................................................................................. </span><span style='color:black;text-decoration:none'>42</span></a></p>

<p class=MsoToc2><a href="#_Toc152150"><span style='color:#02723B'>Section
10.5: Saving A Workbook Without Asking The User</span><span style='color:black;
text-decoration:none'>................................................................................................................. </span><span style='color:black;text-decoration:none'>43</span></a></p>

<p class=MsoToc1><a href="#_Toc152151"><b><span style='font-size:12.0pt;
line-height:110%;color:#02723B'>Chapter 11: Working with Excel Tables in VBA</span></b><span
style='color:black;text-decoration:none'>............................................................................................................................... </span><span style='color:black;text-decoration:none'>44</span></a></p>

<p class=MsoToc2><a href="#_Toc152152"><span style='color:#02723B'>Section
11.1: Instantiating a ListObject</span><span style='color:black;text-decoration:
none'>..................................................................................................................................................... </span><span style='color:black;text-decoration:none'>44</span></a></p>

<p class=MsoToc2><a href="#_Toc152153"><span style='color:#02723B'>Section
11.2: Working with ListRows / ListColumns</span><span style='color:black;
text-decoration:none'>................................................................................................................................ </span><span style='color:black;text-decoration:none'>44</span></a></p>

<p class=MsoToc2><a href="#_Toc152154"><span style='color:#02723B'>Section
11.3: Converting an Excel Table to a normal range</span><span style='color:
black;text-decoration:none'>................................................................................................................... </span><span style='color:black;text-decoration:none'>44</span></a></p>

<p class=MsoToc1><a href="#_Toc152155"><b><span style='font-size:12.0pt;
line-height:110%;color:#02723B'>Chapter 12: Loop through all Sheets in Active
Workbook</span></b><span style='color:black;text-decoration:none'>........................................................................................................ </span><span style='color:black;text-decoration:none'>45</span></a></p>

<p class=MsoToc2><a href="#_Toc152156"><span style='color:#02723B'>Section
12.1: Retrieve all Worksheets Names in Active Workbook</span><span
style='color:black;text-decoration:none'>...................................................................................................... </span><span style='color:black;text-decoration:none'>45</span></a></p>

<p class=MsoToc2><a href="#_Toc152157"><span style='color:#02723B'>Section
12.2: Loop Through all Sheets in all Files in a Folder</span><span
style='color:black;text-decoration:none'>................................................................................................................ </span><span style='color:black;text-decoration:none'>45</span></a></p>

<p class=MsoToc1><a href="#_Toc152158"><b><span style='font-size:12.0pt;
line-height:110%;color:#02723B'>Chapter 13: Use Worksheet object and not Sheet
object</span></b><span style='color:black;text-decoration:none'>........................................................................................................ </span><span style='color:black;text-decoration:none'>47</span></a></p>

<p class=MsoToc2><a href="#_Toc152159"><span style='color:#02723B'>Section
13.1: Print the name of the first object</span><span style='color:black;
text-decoration:none'>....................................................................................................................................... </span><span style='color:black;text-decoration:none'>47</span></a></p>

<p class=MsoToc1><a href="#_Toc152160"><b><span style='font-size:12.0pt;
line-height:110%;color:#02723B'>Chapter 14: Methods for Finding the Last Used
Row or Column in a Worksheet</span></b><span style='color:black;text-decoration:
none'>....................................................... </span><sub><span style='font-size:15.5pt;line-height:110%;color:black;text-decoration:none'>48</span></sub></a></p>

<p class=MsoToc2><a href="#_Toc152161"><span style='color:#02723B'>Section
14.1: Find the Last Non-Empty Cell in a Column</span><span style='color:black;
text-decoration:none'>........................................................................................................................ </span><span style='color:black;text-decoration:none'>48</span></a></p>

<p class=MsoToc2><a href="#_Toc152162"><span style='color:#02723B'>Section
14.2: Find the Last Non-Empty Row in Worksheet</span><span style='color:black;
text-decoration:none'>.................................................................................................................... </span><span style='color:black;text-decoration:none'>48</span></a></p>

<p class=MsoToc2><a href="#_Toc152163"><span style='color:#02723B'>Section
14.3: Find the Last Non-Empty Column in Worksheet</span><span style='color:
black;text-decoration:none'>.............................................................................................................. </span><span style='color:black;text-decoration:none'>49</span></a></p>

<p class=MsoToc2><a href="#_Toc152164"><span style='color:#02723B'>Section
14.4: Find the Last Non-Empty Cell in a Row</span><span style='color:black;
text-decoration:none'>.............................................................................................................................. </span><span style='color:black;text-decoration:none'>50</span></a></p>

<p class=MsoToc2><a href="#_Toc152165"><span style='color:#02723B'>Section
14.5: Get the row of the last cell in a range</span><span style='color:black;
text-decoration:none'>................................................................................................................................ </span><span style='color:black;text-decoration:none'>50</span></a></p>

<p class=MsoToc2><a href="#_Toc152166"><span style='color:#02723B'>Section
14.6: Find Last Row Using Named Range</span><span style='color:black;
text-decoration:none'>.................................................................................................................................... </span><span style='color:black;text-decoration:none'>50</span></a></p>

<p class=MsoToc2><a href="#_Toc152167"><span style='color:#02723B'>Section
14.7: Last cell in Range.CurrentRegion</span><span style='color:black;
text-decoration:none'>........................................................................................................................................ </span><span style='color:black;text-decoration:none'>51</span></a></p>

<p class=MsoToc2><a href="#_Toc152168"><span style='color:#02723B'>Section
14.8: Find the Last Non-Empty Cell in Worksheet - Performance (Array)</span><span
style='color:black;text-decoration:none'>............................................................................. </span><span style='color:black;text-decoration:none'>51</span></a></p>

<p class=MsoToc1><a href="#_Toc152169"><b><span style='font-size:12.0pt;
line-height:110%;color:#02723B'>Chapter 15: Creating a drop-down menu in the
Active Worksheet with a Combo Box</span></b><span style='color:black;
text-decoration:none'>........................................... </span><sub><span style='font-size:15.5pt;line-height:110%;color:black;text-decoration:none'>54</span></sub></a></p>

<p class=MsoToc2><a href="#_Toc152170"><span style='color:#02723B'>Section
15.1: Example 2: Options Not Included</span><span style='color:black;
text-decoration:none'>....................................................................................................................................... </span><span style='color:black;text-decoration:none'>54</span></a></p>

<p class=MsoToc2><a href="#_Toc152171"><span style='color:#02723B'>Section
15.2: Jimi Hendrix Menu</span><span style='color:black;text-decoration:none'>................................................................................................................................................................ </span><span style='color:black;text-decoration:none'>55</span></a></p>

<p class=MsoToc1><a href="#_Toc152172"><b><span style='font-size:12.0pt;
line-height:110%;color:#02723B'>Chapter 16: File System Object</span></b><span
style='color:black;text-decoration:none'>................................................................................................................................................................ </span><span style='color:black;text-decoration:none'>57</span></a></p>

<p class=MsoToc2><a href="#_Toc152173"><span style='color:#02723B'>Section
16.1: File, folder, drive exists</span><span style='color:black;text-decoration:
none'>......................................................................................................................................................... </span><span style='color:black;text-decoration:none'>57</span></a></p>

<p class=MsoToc2><a href="#_Toc152174"><span style='color:#02723B'>Section
16.2: Basic file operations</span><span style='color:black;text-decoration:
none'>.............................................................................................................................................................. </span><span style='color:black;text-decoration:none'>57</span></a></p>

<p class=MsoToc2><a href="#_Toc152175"><span style='color:#02723B'>Section
16.3: Basic folder operations</span><span style='color:black;text-decoration:
none'>......................................................................................................................................................... </span><span style='color:black;text-decoration:none'>58</span></a></p>

<p class=MsoToc2><a href="#_Toc152176"><span style='color:#02723B'>Section
16.4: Other operations</span><span style='color:black;text-decoration:none'>................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>58</span></a></p>

<p class=MsoToc1><a href="#_Toc152177"><b><span style='font-size:12.0pt;
line-height:110%;color:#02723B'>Chapter 17: Pivot Tables</span></b><span
style='color:black;text-decoration:none'>.............................................................................................................................................................................. </span><span style='color:black;text-decoration:none'>60</span></a></p>

<p class=MsoToc2><a href="#_Toc152178"><span style='color:#02723B'>Section
17.1: Adding Fields to a Pivot Table</span><span style='color:black;text-decoration:
none'>............................................................................................................................................. </span><span style='color:black;text-decoration:none'>60</span></a></p>

<p class=MsoToc2><a href="#_Toc152179"><span style='color:#02723B'>Section
17.2: Creating a Pivot Table</span><span style='color:black;text-decoration:
none'>........................................................................................................................................................... </span><span style='color:black;text-decoration:none'>60</span></a></p>

<p class=MsoToc2><a href="#_Toc152180"><span style='color:#02723B'>Section
17.3: Pivot Table Ranges</span><span style='color:black;text-decoration:none'>................................................................................................................................................................ </span><span style='color:black;text-decoration:none'>63</span></a></p>

<p class=MsoToc2><a href="#_Toc152181"><span style='color:#02723B'>Section
17.4: Formatting the Pivot Table Data</span><span style='color:black;
text-decoration:none'>......................................................................................................................................... </span><span style='color:black;text-decoration:none'>63</span></a></p>

<p class=MsoToc1><a href="#_Toc152182"><b><span style='font-size:12.0pt;
line-height:110%;color:#02723B'>Chapter 18: Binding</span></b><span
style='color:black;text-decoration:none'>....................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>64</span></a></p>

<p class=MsoToc2><a href="#_Toc152183"><span style='color:#02723B'>Section
18.1: Early Binding vs Late Binding</span><span style='color:black;text-decoration:
none'>............................................................................................................................................... </span><span style='color:black;text-decoration:none'>64</span></a></p>

<p class=MsoToc1><a href="#_Toc152184"><b><span style='font-size:12.0pt;
line-height:110%;color:#02723B'>Chapter 19: autofilter ; Uses and best
practices</span></b><span style='color:black;text-decoration:none'>............................................................................................................................ </span><span style='color:black;text-decoration:none'>66</span></a></p>

<p class=MsoToc2><a href="#_Toc152185"><span style='color:#02723B'>Section
19.1: Smartfilter!</span><span style='color:black;text-decoration:none'>............................................................................................................................................................................. </span><span style='color:black;text-decoration:none'>66</span></a></p>

<p class=MsoToc1><a href="#_Toc152186"><b><span style='font-size:12.0pt;
line-height:110%;color:#02723B'>Chapter 20: Application object</span></b><span
style='color:black;text-decoration:none'>................................................................................................................................................................ </span><span style='color:black;text-decoration:none'>70</span></a></p>

<p class=MsoToc2><a href="#_Toc152187"><span style='color:#02723B'>Section
20.1: Simple Application Object example: Display Excel and VBE Version</span><span
style='color:black;text-decoration:none'>............................................................................ </span><span style='color:black;text-decoration:none'>70</span></a></p>

<p class=MsoToc2><a href="#_Toc152188"><span style='color:#02723B'>Section
20.2: Simple Application Object example: Minimize the Excel window</span><span
style='color:black;text-decoration:none'>................................................................................ </span><span style='color:black;text-decoration:none'>70</span></a></p>

<p class=MsoToc1><a href="#_Toc152189"><b><span style='font-size:12.0pt;
line-height:110%;color:#02723B'>Chapter 21: Charts and Charting</span></b><span
style='color:black;text-decoration:none'>............................................................................................................................................................. </span><span style='color:black;text-decoration:none'>71</span></a></p>

<p class=MsoToc2><a href="#_Toc152190"><span style='color:#02723B'>Section
21.1: Creating a Chart with Ranges and a Fixed Name</span><span
style='color:black;text-decoration:none'>............................................................................................................. </span><span style='color:black;text-decoration:none'>71</span></a></p>

<p class=MsoToc2><a href="#_Toc152191"><span style='color:#02723B'>Section
21.2: Creating an empty Chart</span><span style='color:black;text-decoration:
none'>...................................................................................................................................................... </span><span style='color:black;text-decoration:none'>72</span></a></p>

<p class=MsoToc2><a href="#_Toc152192"><span style='color:#02723B'>Section
21.3: Create a Chart by Modifying the SERIES formula</span><span
style='color:black;text-decoration:none'>............................................................................................................ </span><span style='color:black;text-decoration:none'>73</span></a></p>

<p class=MsoToc2><a href="#_Toc152193"><span style='color:#02723B'>Section
21.4: Arranging Charts into a Grid</span><span style='color:black;text-decoration:
none'>................................................................................................................................................ </span><span style='color:black;text-decoration:none'>75</span></a></p>

<p class=MsoToc1><a href="#_Toc152194"><b><span style='font-size:12.0pt;
line-height:110%;color:#02723B'>Chapter 22: CustomDocumentProperties in
practice</span></b><span style='color:black;text-decoration:none'>................................................................................................................. </span><span style='color:black;text-decoration:none'>79</span></a></p>

<p class=MsoToc2><a href="#_Toc152195"><span style='color:#02723B'>Section
22.1: Organizing new invoice numbers</span><span style='color:black;text-decoration:
none'>....................................................................................................................................... </span><span style='color:black;text-decoration:none'>79</span></a></p>

<p class=MsoToc1><a href="#_Toc152196"><b><span style='font-size:12.0pt;
line-height:110%;color:#02723B'>Chapter 23: PowerPoint Integration Through VBA</span></b><span
style='color:black;text-decoration:none'>....................................................................................................................... </span><span style='color:black;text-decoration:none'>82</span></a></p>

<p class=MsoToc2><a href="#_Toc152197"><span style='color:#02723B'>Section
23.1: The Basics: Launching PowerPoint from VBA</span><span style='color:black;
text-decoration:none'>................................................................................................................... </span><span style='color:black;text-decoration:none'>82</span></a></p>

<p class=MsoToc1><a href="#_Toc152198"><b><span style='font-size:12.0pt;
line-height:110%;color:#02723B'>Chapter 24: How to record a Macro</span></b><span
style='color:black;text-decoration:none'>..................................................................................................................................................... </span><span style='color:black;text-decoration:none'>83</span></a></p>

<p class=MsoToc2><a href="#_Toc152199"><span style='color:#02723B'>Section
24.1: How to record a Macro</span><span style='color:black;text-decoration:
none'>........................................................................................................................................................ </span><span style='color:black;text-decoration:none'>83</span></a></p>

<p class=MsoToc1><a href="#_Toc152200"><b><span style='font-size:12.0pt;
line-height:110%;color:#02723B'>Chapter 25: SQL in Excel VBA - Best Practices</span></b><span
style='color:black;text-decoration:none'>................................................................................................................................. </span><span style='color:black;text-decoration:none'>85</span></a></p>

<p class=MsoToc2><a href="#_Toc152201"><span style='color:#02723B'>Section
25.1: How to use ADODB.Connection in VBA?</span><span style='color:black;
text-decoration:none'>........................................................................................................................... </span><span style='color:black;text-decoration:none'>85</span></a></p>

<p class=MsoToc1><a href="#_Toc152202"><b><span style='font-size:12.0pt;
line-height:110%;color:#02723B'>Chapter 26: Excel-VBA Optimization</span></b><span
style='color:black;text-decoration:none'>.................................................................................................................................................... </span><span style='color:black;text-decoration:none'>87</span></a></p>

<p class=MsoToc2><a href="#_Toc152203"><span style='color:#02723B'>Section
26.1: Optimizing Error Search by Extended Debugging</span><span
style='color:black;text-decoration:none'>............................................................................................................ </span><span style='color:black;text-decoration:none'>87</span></a></p>

<p class=MsoToc2><a href="#_Toc152204"><span style='color:#02723B'>Section
26.2: Disabling Worksheet Updating</span><span style='color:black;text-decoration:
none'>........................................................................................................................................... </span><span style='color:black;text-decoration:none'>88</span></a></p>

<p class=MsoToc2><a href="#_Toc152205"><span style='color:#02723B'>Section
26.3: Row Deletion - Performance</span><span style='color:black;text-decoration:
none'>............................................................................................................................................... </span><span style='color:black;text-decoration:none'>88</span></a></p>

<p class=MsoToc2><a href="#_Toc152206"><span style='color:#02723B'>Section
26.4: Disabling All Excel Functionality Before executing large macros</span><span
style='color:black;text-decoration:none'>.................................................................................. </span><span style='color:black;text-decoration:none'>89</span></a></p>

<p class=MsoToc2><a href="#_Toc152207"><span style='color:#02723B'>Section
26.5: Checking time of execution</span><span style='color:black;text-decoration:
none'>................................................................................................................................................. </span><span style='color:black;text-decoration:none'>90</span></a></p>

<p class=MsoToc2><a href="#_Toc152208"><span style='color:#02723B'>Section
26.6: Using With blocks</span><span style='color:black;text-decoration:none'>.................................................................................................................................................................. </span><span style='color:black;text-decoration:none'>91</span></a></p>

<p class=MsoToc1><a href="#_Toc152209"><b><span style='font-size:12.0pt;
line-height:110%;color:#02723B'>Chapter 27: VBA Security</span></b><span
style='color:black;text-decoration:none'>............................................................................................................................................................................ </span><span style='color:black;text-decoration:none'>93</span></a></p>

<p class=MsoToc2><a href="#_Toc152210"><span style='color:#02723B'>Section
27.1: Password Protect your VBA</span><span style='color:black;text-decoration:
none'>................................................................................................................................................. </span><span style='color:black;text-decoration:none'>93</span></a></p>

<p class=MsoToc1><a href="#_Toc152211"><b><span style='font-size:12.0pt;
line-height:110%;color:#02723B'>Chapter 28: Debugging and Troubleshooting</span></b><span
style='color:black;text-decoration:none'>.................................................................................................................................. </span><span style='color:black;text-decoration:none'>94</span></a></p>

<p class=MsoToc2><a href="#_Toc152212"><span style='color:#02723B'>Section
28.1: Immediate Window</span><span style='color:black;text-decoration:none'>.............................................................................................................................................................. </span><span style='color:black;text-decoration:none'>94</span></a></p>

<p class=MsoToc2><a href="#_Toc152213"><span style='color:#02723B'>Section
28.2: Use Timer to Find Bottlenecks in Performance</span><span
style='color:black;text-decoration:none'>................................................................................................................ </span><span style='color:black;text-decoration:none'>95</span></a></p>

<p class=MsoToc2><a href="#_Toc152214"><span style='color:#02723B'>Section
28.3: Debugger Locals Window</span><span style='color:black;text-decoration:
none'>.................................................................................................................................................... </span><span style='color:black;text-decoration:none'>95</span></a></p>

<p class=MsoToc2><a href="#_Toc152215"><span style='color:#02723B'>Section
28.4: Debug.Print</span><span style='color:black;text-decoration:none'>............................................................................................................................................................................. </span><span style='color:black;text-decoration:none'>96</span></a></p>

<p class=MsoToc2><a href="#_Toc152216"><span style='color:#02723B'>Section
28.5: Stop</span><span style='color:black;text-decoration:none'>.......................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>97</span></a></p>

<p class=MsoToc2><a href="#_Toc152217"><span style='color:#02723B'>Section
28.6: Adding a Breakpoint to your code</span><span style='color:black;
text-decoration:none'>...................................................................................................................................... </span><span style='color:black;text-decoration:none'>97</span></a></p>

<p class=MsoToc1><a href="#_Toc152218"><b><span style='font-size:12.0pt;
line-height:110%;color:#02723B'>Chapter 29: VBA Best Practices</span></b><span
style='color:black;text-decoration:none'>............................................................................................................................................................... </span><span style='color:black;text-decoration:none'>98</span></a></p>

<p class=MsoToc2><a href="#_Toc152219"><span style='color:#02723B'>Section
29.1: ALWAYS Use &quot;Option Explicit&quot;</span><span style='color:black;
text-decoration:none'>............................................................................................................................................. </span><span style='color:black;text-decoration:none'>98</span></a></p>

<p class=MsoToc2><a href="#_Toc152220"><span style='color:#02723B'>Section
29.2: Work with Arrays, Not With Ranges</span><span style='color:black;
text-decoration:none'>................................................................................................................................ </span><span style='color:black;text-decoration:none'>100</span></a></p>

<p class=MsoToc2><a href="#_Toc152221"><span style='color:#02723B'>Section
29.3: Switch o&#57379; properties during macro execution</span><span
style='color:black;text-decoration:none'>............................................................................................................... </span><span style='color:black;text-decoration:none'>101</span></a></p>

<p class=MsoToc2><a href="#_Toc152222"><span style='color:#02723B'>Section
29.4: Use VB constants when available</span><span style='color:black;
text-decoration:none'>..................................................................................................................................... </span><span style='color:black;text-decoration:none'>102</span></a></p>

<p class=MsoToc2><a href="#_Toc152223"><span style='color:#02723B'>Section
29.5: Avoid using SELECT or ACTIVATE</span><span style='color:black;text-decoration:
none'>...................................................................................................................................... </span><span style='color:black;text-decoration:none'>103</span></a></p>

<p class=MsoToc2><a href="#_Toc152224"><span style='color:#02723B'>Section
29.6: Always define and set references to all Workbooks and Sheets</span><span
style='color:black;text-decoration:none'>................................................................................ </span><span style='color:black;text-decoration:none'>105</span></a></p>

<p class=MsoToc2><a href="#_Toc152225"><span style='color:#02723B'>Section
29.7: Use descriptive variable naming</span><span style='color:black;
text-decoration:none'>...................................................................................................................................... </span><span style='color:black;text-decoration:none'>105</span></a></p>

<p class=MsoToc2><a href="#_Toc152226"><span style='color:#02723B'>Section
29.8: Document Your Work</span><span style='color:black;text-decoration:none'>......................................................................................................................................................... </span><span style='color:black;text-decoration:none'>106</span></a></p>

<p class=MsoToc2><a href="#_Toc152227"><span style='color:#02723B'>Section
29.9: Error Handling</span><span style='color:black;text-decoration:none'>...................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>107</span></a></p>

<p class=MsoToc2><a href="#_Toc152228"><span style='color:#02723B'>Section
29.10: Never Assume The Worksheet</span><span style='color:black;text-decoration:
none'>....................................................................................................................................... </span><span style='color:black;text-decoration:none'>109</span></a></p>

<p class=MsoToc2><a href="#_Toc152229"><span style='color:#02723B'>Section
29.11: Avoid re-purposing the names of Properties or Methods as your variables</span><span
style='color:black;text-decoration:none'>.......................................................... </span><span style='color:black;text-decoration:none'>109</span></a></p>

<p class=MsoToc2><a href="#_Toc152230"><span style='color:#02723B'>Section
29.12: Avoid using ActiveCell or ActiveSheet in Excel</span><span
style='color:black;text-decoration:none'>............................................................................................................ </span><span style='color:black;text-decoration:none'>110</span></a></p>

<p class=MsoToc2><a href="#_Toc152231"><span style='color:#02723B'>Section
29.13: WorksheetFunction object executes faster than a UDF equivalent</span><span
style='color:black;text-decoration:none'>......................................................................... </span><span style='color:black;text-decoration:none'>111</span></a></p>

<p class=MsoToc1><a href="#_Toc152232"><b><span style='font-size:12.0pt;
line-height:110%;color:#02723B'>Chapter 30: Excel VBA Tips and Tricks</span></b><span
style='color:black;text-decoration:none'>............................................................................................................................................... </span><span style='color:black;text-decoration:none'>113</span></a></p>

<p class=MsoToc2><a href="#_Toc152233"><span style='color:#02723B'>Section
30.1: Using xlVeryHidden Sheets</span><span style='color:black;text-decoration:
none'>................................................................................................................................................ </span><span style='color:black;text-decoration:none'>113</span></a></p>

<p class=MsoToc2><a href="#_Toc152234"><span style='color:#02723B'>Section
30.2: Using Strings with Delimiters in Place of Dynamic Arrays</span><span
style='color:black;text-decoration:none'>........................................................................................... </span><span style='color:black;text-decoration:none'>114</span></a></p>

<p class=MsoToc2><a href="#_Toc152235"><span style='color:#02723B'>Section
30.3: Worksheet .Name, .Index or .CodeName</span><span style='color:black;
text-decoration:none'>....................................................................................................................... </span><span style='color:black;text-decoration:none'>114</span></a></p>

<p class=MsoToc2><a href="#_Toc152236"><span style='color:#02723B'>Section
30.4: Double Click Event for Excel Shapes</span><span style='color:black;
text-decoration:none'>................................................................................................................................ </span><span style='color:black;text-decoration:none'>116</span></a></p>

<p class=MsoToc2><a href="#_Toc152237"><span style='color:#02723B'>Section
30.5: Open File Dialog - Multiple Files</span><span style='color:black;
text-decoration:none'>....................................................................................................................................... </span><span style='color:black;text-decoration:none'>117</span></a></p>

<p class=MsoToc1><a href="#_Toc152238"><b><span style='font-size:12.0pt;
line-height:110%;color:#02723B'>Chapter 31: Common Mistakes</span></b><span
style='color:black;text-decoration:none'>............................................................................................................................................................. </span><span style='color:black;text-decoration:none'>118</span></a></p>

<p class=MsoToc2><a href="#_Toc152239"><span style='color:#02723B'>Section
31.1: Qualifying References</span><span style='color:black;text-decoration:
none'>........................................................................................................................................................ </span><span style='color:black;text-decoration:none'>118</span></a></p>

<p class=MsoToc2><a href="#_Toc152240"><span style='color:#02723B'>Section
31.2: Deleting rows or columns in a loop</span><span style='color:black;
text-decoration:none'>................................................................................................................................. </span><span style='color:black;text-decoration:none'>119</span></a></p>

<p class=MsoToc2><a href="#_Toc152241"><span style='color:#02723B'>Section
31.3: ActiveWorkbook vs. ThisWorkbook</span><span style='color:black;
text-decoration:none'>................................................................................................................................. </span><span style='color:black;text-decoration:none'>119</span></a></p>

<p class=MsoToc2><a href="#_Toc152242"><span style='color:#02723B'>Section
31.4: Single Document Interface Versus Multiple Document Interfaces</span><span
style='color:black;text-decoration:none'>............................................................................ </span><span style='color:black;text-decoration:none'>120</span></a></p>

<p class=MsoToc1><a href="#_Toc152243"><b><span style='font-size:12.0pt;
line-height:110%;color:#02723B'>Credits</span></b><span style='color:black;
text-decoration:none'>................................................................................................................................................................................................................. </span><span style='color:black;text-decoration:none'>122</span></a></p>

<p class=MsoToc1><a href="#_Toc152244"><b><span style='font-size:12.0pt;
line-height:110%;color:#02723B'>You may also like</span></b><span
style='color:black;text-decoration:none'>........................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>124</span></a></p>

<p class=MsoNormal>&nbsp;</p>

</div>

<span style='font-size:10.0pt;line-height:110%;font-family:"Calibri",sans-serif;
color:black'><br clear=all style='page-break-before:always'>
</span>

<div class=WordSection2>

<h1 style='margin-top:0in;margin-right:0in;margin-bottom:105.15pt;margin-left:
-.25pt'><a name="_Toc152104">About</a></h1>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:116.45pt;
margin-bottom:0in;margin-left:116.5pt;text-align:center;text-indent:0in;
line-height:123%'><span style='font-size:11.0pt;line-height:123%'>Please feel
free to share this PDF with anyone for free, latest version of this book can be
downloaded from:</span></p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:0in;
margin-bottom:31.9pt;margin-left:.05pt;text-align:center;text-indent:0in;
line-height:107%'><a href="https://goalkicker.com/ExcelVBABook"><span
style='font-size:11.0pt;line-height:107%;color:#02723B'>https://goalkicker.com/ExcelVBABook</span></a></p>

<p class=MsoNormal align=right style='margin-top:0in;margin-right:92.15pt;
margin-bottom:1.85pt;margin-left:0in;text-align:right;text-indent:0in;
line-height:107%'>This <i>Excel VBA Notes for Professionals</i> book is
compiled from <a href="https://archive.org/details/documentation-dump.7z"><span
style='color:#02723B'>Stack Overflow</span></a></p>

<p class=MsoNormal align=right style='margin-top:0in;margin-right:82.35pt;
margin-bottom:1.6pt;margin-left:.5pt;text-align:right;text-indent:-.5pt'><a
href="https://archive.org/details/documentation-dump.7z"><span
style='color:#02723B'>Documentation</span></a>, the content is written by the
beautiful people at Stack Overflow.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:80.75pt;
margin-bottom:12.45pt;margin-left:81.3pt;text-align:center;text-indent:-.5pt'>Text
content is released under Creative Commons BY-SA, see credits at the end of
this book whom contributed to the various chapters. Images may be copyright of
their respective owners unless otherwise specified</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:77.8pt;
margin-bottom:12.45pt;margin-left:78.3pt;text-align:center;text-indent:-.5pt'><span
style='position:relative;z-index:-1895824384'><span style='left:0px;position:
absolute;left:87px;top:-275px;width:545px;height:476px'><img width=545
height=476 src="Excel%20VBA%20Notes%20for%20Professionals_files/image002.gif"></span></span>This
is an unofficial free book created for educational purposes and is not
affiliated with official Excel VBA group(s) or company(s) nor Stack Overflow.
All trademarks and registered trademarks are the property of their respective
company owners</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:74.15pt;
margin-bottom:12.45pt;margin-left:74.7pt;text-align:center;text-indent:-.5pt'>The
information presented in this book is not guaranteed to be correct nor
accurate, use at your own risk</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:131.05pt'>Please send feedback and corrections to <u><span
style='color:#02723B'>web@petercv.com</span></u></p>

<h1 style='margin-left:-.25pt'><a name="_Toc152105">Chapter 1: Getting started
with Excel VBA</a></h1>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:13.0pt;
margin-left:.25pt'>Microsoft Excel includes a comprehensive macro programming
language called VBA. This programming language provides you with at least three
additional resources:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:110%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Automatically
drive Excel from code using Macros. For the most part, anything that the user
can do by manipulating Excel from the user interface can be done by writing
code in Excel VBA.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:110%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Create
new, custom worksheet functions.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.8pt;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:110%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Interact
Excel with other applications such as Microsoft Word, PowerPoint, Internet
Explorer, Notepad, etc.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.7pt;
margin-left:.25pt'>VBA stands for Visual Basic for Applications. It is a custom
version of the venerable Visual Basic programming language that has powered
Microsoft Excel's macros since the mid-1990s.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:2.35pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'><b>IMPORTANT</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.95pt;
margin-left:.25pt'>Please ensure any examples or topics created within the
excel-vba tag are <b>specific</b> and <b>relevant</b> to the use of VBA with
Microsoft Excel. Any suggested topics or examples provided that are generic to
the VBA language should be declined in order to prevent duplication of efforts.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:20.55pt;
margin-left:20.9pt'><span style='font-size:11.0pt;line-height:110%'><img
border=0 width=5 height=5 id="Group 125628"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image003.gif"></span>on-topic
examples:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:124.85pt;margin-bottom:
2.35pt;margin-left:40.15pt;text-indent:-10.15pt;line-height:107%'><span
style='line-height:107%;font-family:"Arial",sans-serif'>&#10003;<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><i>Creating and
interacting with worksheet objects</i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:124.85pt;margin-bottom:
29.85pt;margin-left:40.15pt;text-indent:-10.15pt;line-height:107%'><span
style='line-height:107%;font-family:"Arial",sans-serif'>&#10003;<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><i>The </i><i><span
style='font-size:9.0pt;line-height:107%;background:#FAFAFA'>WorksheetFunction</span>
class and respective methods </i><span style='font-family:"Arial",sans-serif'>&#10003;</span>
<i>Using the </i><i><span style='font-size:9.0pt;line-height:107%;background:
#FAFAFA'>xlDirection</span> enumeration to navigate a range</i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:20.55pt;
margin-left:20.9pt'><span style='font-size:11.0pt;line-height:110%'><img
border=0 width=5 height=5 id="Group 125629"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image003.gif"></span>off-topic
examples:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:152.1pt;margin-bottom:
2.35pt;margin-left:38.3pt;text-indent:-8.3pt;line-height:107%'><span
style='line-height:107%;font-family:"Arial",sans-serif'>&#10007;</span><i>How
to create a 'for each' loop</i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:152.1pt;margin-bottom:
44.55pt;margin-left:38.3pt;text-indent:-8.3pt;line-height:107%'><span
style='line-height:107%;font-family:"Arial",sans-serif'>&#10007;</span><i><span
style='font-size:9.0pt;line-height:107%;background:#FAFAFA'>MsgBox</span> class
and how to display a message </i><span style='font-family:"Arial",sans-serif'>&#10007;</span>
<i>Using WinAPI in VBA</i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:2.1pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'><b>VB</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:1.35pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'><b>Version Release Date</b></p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'><span
style='font-size:11.0pt;line-height:110%'> </span>VB6 1998-10-01</p>

<p class=MsoNormal style='margin-bottom:3.8pt;text-indent:0in'><span
style='font-size:11.0pt;line-height:110%'> </span>VB7 2001-06-06</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:3.85pt;
margin-left:.25pt'>WIN32 1998-10-01</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:3.85pt;
margin-left:.25pt'>WIN64 2001-06-06</p>

<p class=MsoNormal style='margin-bottom:4.05pt;text-indent:0in'>MAC 1998-10-01</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:2.1pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'><b>Excel</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:1.35pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'><b>Version Release Date</b></p>

<p class=MsoNormal style='margin-bottom:3.9pt;text-indent:0in;line-height:110%'><span
style='font-size:11.0pt;line-height:110%'> </span>16 <a
href="https://en.wikipedia.org/wiki/Microsoft_Excel"><span style='color:#02723B'>2016-01-01</span></a></p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'><span
style='font-size:11.0pt;line-height:110%'> </span>15 2013-01-01</p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'><span
style='font-size:11.0pt;line-height:110%'> </span>14 2010-01-01</p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'><span
style='font-size:11.0pt;line-height:110%'> </span>12 2007-01-01</p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'><span
style='font-size:11.0pt;line-height:110%'> </span>11 2003-01-01</p>

<p class=MsoNormal style='margin-bottom:3.8pt;text-indent:0in'><span
style='font-size:11.0pt;line-height:110%'> </span>10 2001-01-01</p>

<p class=MsoNormal style='text-indent:0in'><span style='font-size:11.0pt;
line-height:110%'> </span>9 1999-01-01</p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'><span
style='font-size:11.0pt;line-height:110%'> </span>8 1997-01-01</p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'><span
style='font-size:11.0pt;line-height:110%'> </span>7 1995-01-01</p>

<p class=MsoNormal style='margin-bottom:3.85pt;text-indent:0in'><span
style='font-size:11.0pt;line-height:110%'> </span>5 1993-01-01</p>

<p class=MsoNormal style='margin-bottom:20.8pt;text-indent:0in'><span
style='font-size:11.0pt;line-height:110%'> </span>2 1987-01-01</p>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc152106">Section 1.1: Opening the Visual Basic Editor (VBE)</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:.15pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'><b>Step 1: Open a
Workbook</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
15.25pt;margin-left:0in;text-indent:0in;line-height:107%'><img border=0
width=718 height=405 id="Picture 1728"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image004.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:13.45pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'><b>Step 2 Option A: Press
<span style='border:solid black 1.5pt;padding:0in'>Alt </span>+ <span
style='border:solid black 1.5pt;padding:0in'>F11 </span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:13.05pt;
margin-left:.25pt'>This is the standard shortcut to open the VBE.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:13.3pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'><b>Step 2 Option B:
Developer Tab --&gt; View Code</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>First, the Developer Tab must be added to the ribbon. Go to
File -&gt; Options -&gt; Customize Ribbon, then check the box for developer.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><img border=0
width=718 height=498 id="Picture 1772"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image005.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>Then, go to the developer tab and click &quot;View
Code&quot; or &quot;Visual Basic&quot;</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
15.2pt;margin-left:0in;text-indent:0in;line-height:107%'><img border=0
width=718 height=170 id="Picture 1775"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image006.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:13.3pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'><b>Step 2 Option C: View
tab &gt; Macros &gt; Click Edit button to open an Existing Macro</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>All three of these options will open the Visual Basic Editor
(VBE):</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
10.35pt;margin-left:0in;text-indent:0in;line-height:107%'><img border=0
width=717 height=404 id="Picture 1800"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image007.jpg"></p>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc152107">Section 1.2: Declaring Variables</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.5pt;
margin-left:.25pt'>To explicitly declare variables in VBA, use the <b><span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>Dim</span></b>
statement, followed by the variable name and type. If a variable is used
without being declared, or if no type is specified, it will be assigned the
type <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Variant</span>.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=108 style='width:81.0pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=108 valign=top style='width:81.0pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Option</span></b><span style='font-size:
  9.0pt;line-height:107%'> Explicit</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.45pt;
margin-left:.25pt'>Use the statement on first line of a module to force all
variables to be declared before usage (see ALWAYS Use &quot;Option
Explicit&quot; ).</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=108 style='width:81.0pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=108 valign=top style='width:81.0pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Option</span></b><span style='font-size:
  9.0pt;line-height:107%'> Explicit</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>Always using is highly recommended because it helps prevent
typo/spelling errors and ensures variables/objects will stay their intended
type.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
15.2pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=306
src="Excel%20VBA%20Notes%20for%20Professionals_files/image008.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>Multiple variables can be declared on a single line using
commas as delimiters, but <b>each type must be declared individually</b>, or
they will default to the <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>Variant</span> type.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=718 height=25
src="Excel%20VBA%20Notes%20for%20Professionals_files/image009.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'>Debug.Print </span><span style='font-size:9.0pt;line-height:110%;
color:#000066'>TypeName</span><span style='font-size:9.0pt;line-height:110%'>(Str)
</span><i><span style='font-size:9.0pt;line-height:110%;color:green'>'Output:
String</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.3pt;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='position:relative;z-index:
-1895823360'><span style='left:0px;position:absolute;left:0px;top:-20px;
width:718px;height:71px'><img width=718 height=71
src="Excel%20VBA%20Notes%20for%20Professionals_files/image010.gif"></span></span><span
style='font-size:9.0pt;line-height:110%'>Debug.Print </span><span
style='font-size:9.0pt;line-height:110%;color:#000066'>TypeName</span><span
style='font-size:9.0pt;line-height:110%'>(IntOne) </span><i><span
style='font-size:9.0pt;line-height:110%;color:green'>'Output: Variant &lt;---
!!!</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'>Debug.Print </span><span style='font-size:9.0pt;line-height:110%;
color:#000066'>TypeName</span><span style='font-size:9.0pt;line-height:110%'>(IntTwo)
</span><i><span style='font-size:9.0pt;line-height:110%;color:green'>'Output:
Integer</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:17.25pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'>Debug.Print </span><span style='font-size:9.0pt;line-height:110%;
color:#000066'>TypeName</span><span style='font-size:9.0pt;line-height:110%'>(Lng)
</span><i><span style='font-size:9.0pt;line-height:110%;color:green'>'Output:
Long</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>Variables can also be declared using Data Type Character
suffixes ($ % &amp; ! # @), however using these are increasingly discouraged.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
19.05pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=109
src="Excel%20VBA%20Notes%20for%20Professionals_files/image011.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:10.9pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'><b>Other ways of
declaring variables are:</b></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=238 style='width:178.2pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=238 valign=top style='width:178.2pt;background:#FAFAFA;padding:
  1.8pt 0in 0in 0in;height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Static</span></b><span style='font-size:
  9.0pt;line-height:107%'> CounterVariable </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>as</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Integer</span></p>
  </td>
 </tr>
</table>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=238 style='width:178.2pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=238 valign=top style='width:178.2pt;background:#FAFAFA;padding:
  1.8pt 0in 0in 0in;height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Public</span></b><span style='font-size:
  9.0pt;line-height:107%'> CounterVariable </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>as</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Integer</span></p>
  </td>
 </tr>
</table>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=245 style='width:2.55in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=245 valign=top style='width:2.55in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Private</span></b><span style='font-size:
  9.0pt;line-height:107%'> CounterVariable </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>as</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Integer</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:274.15pt;margin-bottom:
24.4pt;margin-left:15.75pt'><img width=13 height=337
src="Excel%20VBA%20Notes%20for%20Professionals_files/image012.gif" align=left
hspace=12><b><span style='font-size:9.0pt;line-height:110%;color:blue;
background:#FAFAFA'>Static</span></b> like: </p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:24.2pt;
margin-left:24.0pt'>When you use the Static statement instead of a Dim
statement, the declared variable will retain its value between calls.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:274.15pt;margin-bottom:
24.4pt;margin-left:15.75pt'><b><span style='font-size:9.0pt;line-height:110%;
color:blue;background:#FAFAFA'>Public</span></b> like: </p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:24.2pt;
margin-left:24.0pt'>Public variables can be used in any procedures in the
project. If a public variable is declared in a standard module or a class
module, it can also be used in any projects that reference the project where
the public variable is declared.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:263.35pt;margin-bottom:
24.45pt;margin-left:16.25pt;text-indent:-.5pt'><b><span style='font-size:9.0pt;
line-height:110%;color:blue;background:#FAFAFA'>Private</span></b> like: </p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:24.0pt;
margin-left:24.0pt'>Private variables can be used only by procedures in the
same module.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.8pt;
margin-left:.25pt'>Source and more info:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:10.25pt;margin-bottom:
12.85pt;margin-left:.75pt;text-align:justify;text-justify:inter-ideograph;
text-indent:-.5pt;line-height:110%'><a
href="https://msdn.microsoft.com/en-us/library/office/gg264241.aspx"><span
style='color:#02723B'>MSDN-Declaring Variables</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:98.25pt;margin-bottom:
0in;margin-left:-.25pt;text-indent:-.5pt;line-height:145%'><a
href="https://docs.microsoft.com/en-us/dotnet/visual-basic/programming-guide/language-features/data-types/type-characters"><span
style='color:#02723B'>Type Characters (Visual Basic)</span></a></p>

<h2 style='margin-top:0in;margin-right:98.25pt;margin-bottom:0in;margin-left:
-.25pt;line-height:145%'><a name="_Toc152108">Section 1.3: Adding a new Object
Library Reference</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.45pt;
margin-left:.25pt'>The procedure describes how to add an Object library
reference, and afterwards how to declare new variables with reference to the
new library class objects.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>The example below shows how to add the <i>PowerPoint</i>
library to the existing VB Project. As can be seen, currently the PowerPoint
Object library is not available.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
15.2pt;margin-left:0in;text-indent:0in;line-height:107%'><img border=0
width=718 height=383 id="Picture 2081"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image013.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:-.25pt;text-indent:-.5pt;line-height:107%'><b>Step 1</b>: Select
Menu <b><i>Tools</i></b> <b>--&gt;</b> <b><i>References</i></b><span
style='font-family:"Arial",sans-serif'></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
15.2pt;margin-left:0in;text-indent:0in;line-height:107%'><img border=0
width=718 height=224 id="Picture 2091"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image014.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'><b>Step 2</b>: Select the Reference you want to add. This
example we scroll down to find <span style='font-family:"Arial",sans-serif'></span><b><i>Microsoft
PowerPoint 14.0 Object Library</i></b><span style='font-family:"Arial",sans-serif'></span>,
and then press <span style='font-family:"Arial",sans-serif'></span><b>OK</b><span
style='font-family:"Arial",sans-serif'></span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><img border=0
width=719 height=399 id="Picture 2125"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image015.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:13.05pt;
margin-left:.25pt'>Note: PowerPoint 14.0 means that Office 2010 version is
installed on the PC.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'><b>Step 3</b>: in the VB Editor, once you press <b>Ctrl+Space</b>
together, you get the autocomplete option of PowerPoint.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
15.05pt;margin-left:0in;text-indent:0in;line-height:107%'><img border=0
width=718 height=355 id="Picture 2132"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image016.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>After selecting <span style='font-size:9.0pt;line-height:
110%;background:#FAFAFA'>PowerPoint</span> and pressing <span style='font-size:
9.0pt;line-height:110%;background:#FAFAFA'>.</span>, another menu appears with
all objects options related to the PowerPoint Object Library. This example
shows how to select the PowerPoint's object <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>Application</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
15.2pt;margin-left:0in;text-indent:0in;line-height:107%'><img border=0
width=718 height=341 id="Picture 2164"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image017.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:13.2pt;
margin-left:.25pt'><b>Step 4</b>: Now the user can declare more variables using
the PowerPoint object library.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>Declare a variable that is referencing the <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Presentation</span>
object of the PowerPoint object library.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
15.0pt;margin-left:0in;text-indent:0in;line-height:107%'><img border=0
width=718 height=344 id="Picture 2172"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image018.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>Declare another variable that is referencing the <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Slide</span> object
of the PowerPoint object library.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><img border=0
width=718 height=340 id="Picture 2199"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image019.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>Now the variables declaration section looks like in the
screen-shot below, and the user can start using these variables in his code.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><img border=0
width=718 height=248 id="Picture 2203"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image020.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>Code version of this tutorial:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
10.35pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=720 height=207
src="Excel%20VBA%20Notes%20for%20Professionals_files/image021.gif"></span></p>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc152109">Section 1.4: Hello World</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:110%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Open
the Visual Basic Editor ( see Opening the Visual Basic Editor )</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:110%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Click
Insert --&gt; Module to add a new Module :</p>

<p class=MsoNormal style='margin-bottom:14.95pt;text-indent:0in;line-height:
107%'><img border=0 width=297 height=261 id="Picture 2258"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image022.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:110%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Copy
and Paste the following code in the new module :</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=60
src="Excel%20VBA%20Notes%20for%20Professionals_files/image023.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>To obtain :</p>

<p class=MsoNormal style='margin-bottom:15.2pt;text-indent:0in;line-height:
107%'><img border=0 width=499 height=416 id="Picture 2274"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image024.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:.15pt;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:110%'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Click
on the green <span style='font-family:"Arial",sans-serif'></span>play<span
style='font-family:"Arial",sans-serif'></span> arrow (or press F5) in the
Visual Basic toolbar to run the program:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
11.3pt;margin-left:30.0pt;text-indent:0in;line-height:107%'><img border=0
width=678 height=94 id="Picture 2282"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image025.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:110%'>5.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Select
the new created sub &quot;hello&quot; and click <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>Run</span> :</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:11.25pt;
margin-left:30.0pt;text-indent:0in;line-height:107%'><img border=0 width=440
height=343 id="Picture 2307"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image026.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:5.95pt;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:110%'>6.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Done,
your should see the following window:</p>

<p class=MsoNormal style='margin-bottom:10.35pt;text-indent:0in;line-height:
107%'><img border=0 width=140 height=149 id="Picture 2311"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image027.jpg"></p>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:0in;margin-left:
-.25pt'><a name="_Toc152110">Section 1.5: Getting Started with the Excel Object
Model</a></h2>

<p class=MsoNormal style='margin-bottom:35.95pt;text-indent:0in'><span
style='font-size:11.0pt;line-height:110%'> <img border=0 width=3
height=52 id="Group 129437"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image028.gif"></span> This
example intend to be a gentle introduction to the Excel Object Model <b>for
beginners</b>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:110%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Open
the Visual Basic Editor (VBE)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:110%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Click
View --&gt; Immediate Window to open the Immediate Window (or <span
style='border:solid black 1.5pt;padding:0in'>ctrl </span>+ <span
style='border:solid black 1.5pt;padding:0in'>G </span>):</p>

<p class=MsoNormal style='margin-bottom:14.95pt;text-indent:0in;line-height:
107%'><img border=0 width=319 height=203 id="Picture 2344"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image029.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:110%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>You
should see the following Immediate Window at the bottom on VBE:</p>

<p class=MsoNormal style='margin-bottom:14.95pt;text-indent:0in;line-height:
107%'><img border=0 width=226 height=120 id="Picture 2374"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image030.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>This window allow you to directly test some VBA code. So
let's start, type in this console :</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=26
src="Excel%20VBA%20Notes%20for%20Professionals_files/image031.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>VBE has intellisense and then it should open a tooltip as in
the following figure :</p>

<p class=MsoNormal style='margin-bottom:14.95pt;text-indent:0in;line-height:
107%'><img border=0 width=255 height=146 id="Picture 2381"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image032.jpg"></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=29 style='width:.3in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>Cout</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>Select .Count in the list or directly type <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>.</span> to obtain
:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
12.05pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=26
src="Excel%20VBA%20Notes%20for%20Professionals_files/image033.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.95pt;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:110%'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Then
press Enter. The expression is evaluated and it should returns 1. This
indicates the number of Worksheet currently present in the workbook. The
question mark (<span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>?</span>)
is an alias for Debug.Print.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:23.65pt;
margin-left:.25pt'>Worksheets is an <b>Object</b> and Count is a <b>Method</b>.
Excel has several Object (<span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>Workbook</span>, <span style='font-size:9.0pt;line-height:
110%;background:#FAFAFA'>Worksheet</span>, <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>Range</span>, <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>Chart</span> ..) and each of one contains
specific methods and properties. You can find the complete list of Object in
the <a href="https://msdn.microsoft.com/en-us/library/ff194068.aspx"><span
style='color:#02723B'>Excel VBA </span></a><a
href="https://msdn.microsoft.com/en-us/library/ff194068.aspx"><span
style='color:#02723B'>reference</span></a>. Worksheets Object is presented <a
href="https://msdn.microsoft.com/en-us/library/ff821537.aspx"><span
style='color:#02723B'>here</span></a> .</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:24.2pt;
margin-left:24.0pt'><img width=3 height=71
src="Excel%20VBA%20Notes%20for%20Professionals_files/image034.gif" align=left
hspace=12>This Excel VBA reference should become your primary source of
information regarding the Excel Object Model.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:110%'>5.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Now
let's try another expression, type (without the <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>?</span> character):</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
12.05pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=26
src="Excel%20VBA%20Notes%20for%20Professionals_files/image035.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=94 style='width:70.2pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=94 valign=top style='width:70.2pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>StackOverflow</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:110%'>6.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Press
Enter. This should create a new worksheet called <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>.</span>:</p>

<p class=MsoNormal style='margin-bottom:14.95pt;text-indent:0in;line-height:
107%'><img border=0 width=287 height=92 id="Picture 2451"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image036.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>To understand this expression you need to read the Add
function in the aforementioned Excel reference. You will find the following:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=718 height=67
src="Excel%20VBA%20Notes%20for%20Professionals_files/image037.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
15.2pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=21
src="Excel%20VBA%20Notes%20for%20Professionals_files/image038.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=101 style='width:1.05in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=72 valign=top style='width:.75in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>Worksheets</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;background:#FAFAFA'>.</span></p>
  </td>
  <td width=22 valign=top style='width:16.2pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>Add</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>So the <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>()</span> create a new worksheet and return it. Worksheet(<b>without
s</b>) is itself a Object that <a
href="https://msdn.microsoft.com/en-us/library/ff194464.aspx"><span
style='color:#02723B'>can be </span></a><a
href="https://msdn.microsoft.com/en-us/library/ff194464.aspx"><span
style='color:#02723B'>found</span></a> in the documentation and <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Name</span> is one
of its <b>property</b> (see <a
href="https://msdn.microsoft.com/en-us/library/ff841127.aspx"><span
style='color:#02723B'>here</span></a>). It is defined as :</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=43
src="Excel%20VBA%20Notes%20for%20Professionals_files/image039.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=158 style='width:1.65in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=72 valign=top style='width:.75in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>Worksheets</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;background:#FAFAFA'>.</span></p>
  </td>
  <td width=22 valign=top style='width:16.2pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>Add</span></p>
  </td>
  <td width=22 valign=top style='width:16.2pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;background:#FAFAFA'>().</span></p>
  </td>
  <td width=36 valign=top style='width:27.0pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>Name </span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:13.25pt;
margin-left:.25pt'>So, by investigating the different objects definitions we
are able to understand this code <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>= </span><span style='font-size:9.0pt;line-height:110%;
color:brown;background:#FAFAFA'>&quot;StackOveflow&quot;</span>.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=22 style='width:16.2pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=22 valign=top style='width:16.2pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>Add</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:16.2pt'><span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>()</span> creates and add a new worksheet and return a <b>reference</b>
to it, then we set its Name <b>property</b> to</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.8pt;
margin-left:.25pt'>&quot;StackOverflow&quot;</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:9.2pt;
margin-left:.25pt'>Now let's be more formal, Excel contains several Objects.
These Objects may be composed of one or several collection(s) of Excel objects
of the same class. It is the case for <span style='font-size:9.0pt;line-height:
110%;background:#FAFAFA'>WorkSheets</span> which is a collection of <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Worksheet </span>object.
Each Object has some properties and methods that the programmer can interact
with.</p>

<p class=MsoNormal style='margin-bottom:12.2pt;text-indent:0in'><span
style='font-size:11.0pt;line-height:110%'> <img border=0 width=3
height=52 id="Group 127441"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image028.gif"></span> The
Excel Object model refers to the Excel <b>object hierarchy</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.45pt;
margin-left:.25pt'>At the top of all objects is the <span style='font-size:
9.0pt;line-height:110%;background:#FAFAFA'>Application</span> object, it
represents the Excel instance itself. Programming in VBA requires a good
understanding of this hierarchy because we always need a reference to an object
to be able to call a Method or to Set/Get a property.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>The (very simplified) Excel Object Model can be represented
as,</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=109
src="Excel%20VBA%20Notes%20for%20Professionals_files/image040.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>A more detail version for the Worksheet Object (as it is in
Excel 2007) is shown below,</p>

<p class=MsoNormal style='margin-bottom:15.0pt;text-indent:0in;line-height:
107%'><span style='font-size:11.0pt;line-height:107%'><img border=0 width=613
height=689 src="Excel%20VBA%20Notes%20for%20Professionals_files/image041.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=166 style='width:124.2pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>Workbook</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;background:#FAFAFA'>.</span></p>
  </td>
  <td width=101 valign=top style='width:1.05in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>WindowActivate</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>Finally some objects may have <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>events</span> (ex: ) that are also part of
the Excel Object Model.</p>

<h1 style='margin-left:-.25pt'><a name="_Toc152111">Chapter 2: Arrays</a></h1>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc152112">Section 2.1: Dynamic Arrays (Array Resizing and
Dynamic Handling)</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.0pt;
margin-left:-.25pt;text-indent:-.5pt;line-height:107%'><i>Due to not being
Excel-VBA exclusive contents this Example has been moved to VBA documentation.</i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:141.3pt;margin-bottom:
0in;margin-left:.25pt;line-height:145%'>Link: Dynamic Arrays (Array Resizing
and Dynamic Handling)</p>

<h2 style='margin-top:0in;margin-right:141.3pt;margin-bottom:0in;margin-left:
.25pt;text-indent:.5pt;line-height:145%'><a name="_Toc152113">Section 2.2:
Populating arrays (adding values)</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:28.1pt;
margin-left:.25pt'>There are multiple ways to populate an array.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:.15pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'><b>Directly</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
19.05pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=223
src="Excel%20VBA%20Notes%20for%20Professionals_files/image042.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:.15pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'><b>Using Array() function</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.3pt;margin-bottom:16.85pt;
margin-left:.5pt;text-indent:-.5pt'><span style='font-size:11.0pt;line-height:
110%'><img border=0 width=718 height=76
src="Excel%20VBA%20Notes%20for%20Professionals_files/image043.gif"></span><i><span
style='font-size:9.0pt;line-height:110%;color:green'>'one-dimensional only</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:.15pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'><b>From range</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=720 height=344
src="Excel%20VBA%20Notes%20for%20Professionals_files/image044.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
19.05pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=719 height=218
src="Excel%20VBA%20Notes%20for%20Professionals_files/image045.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=718 height=229
src="Excel%20VBA%20Notes%20for%20Professionals_files/image046.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
10.35pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=60
src="Excel%20VBA%20Notes%20for%20Professionals_files/image047.gif"></span></p>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc152114">Section 2.3: Jagged Arrays (Arrays of Arrays)</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.0pt;
margin-left:-.25pt;text-indent:-.5pt;line-height:107%'><i>Due to not being
Excel-VBA exclusive contents this Example has been moved to VBA documentation.</i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:18.55pt;
margin-left:.25pt'>Link: Jagged Arrays (Arrays of Arrays)</p>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc152115">Section 2.4: Check if Array is Initialized (If it
contains elements or not)</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>A common problem might be trying to iterate over Array which
has no values in it. For example:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=43
src="Excel%20VBA%20Notes%20for%20Professionals_files/image048.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:14.45pt;
margin-left:.25pt'>To avoid this issue, and to check if an Array contains
elements, use this <i>oneliner</i>:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:23.0pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='position:relative;z-index:
-1895820288'><span style='left:0px;position:absolute;left:0px;top:-8px;
width:718px;height:26px'><img width=718 height=26
src="Excel%20VBA%20Notes%20for%20Professionals_files/image049.gif"></span></span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>If</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Not</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>Not</span></b><span style='font-size:9.0pt;line-height:110%'>
myArray </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Then</span></b><span
style='font-size:9.0pt;line-height:110%'> MsgBox </span><span style='font-size:
9.0pt;line-height:110%;color:#000066'>UBound</span><span style='font-size:9.0pt;
line-height:110%'>(myArray) </span><b><span style='font-size:9.0pt;line-height:
110%;color:blue'>Else</span></b><span style='font-size:9.0pt;line-height:110%'>
MsgBox </span><span style='font-size:9.0pt;line-height:110%;color:brown'>&quot;myArray
not initialised&quot;</span></p>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:0in;margin-left:
-.25pt'><a name="_Toc152116">Section 2.5: Dynamic Arrays [Array Declaration,
Resizing]</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=718 height=91
src="Excel%20VBA%20Notes%20for%20Professionals_files/image050.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=719 height=268
src="Excel%20VBA%20Notes%20for%20Professionals_files/image051.gif"></span><br
clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc152117">Chapter 3: Conditional
statements</a></h1>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc152118">Section 3.1: The If statement</a></h2>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=14 style='width:.15in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=14 valign=top style='width:.15in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>x </span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.55pt;
margin-left:.25pt'><span style='position:absolute;z-index:-1895819264;
left:0px;margin-left:611px;margin-top:19px;width:7px;height:14px'><img width=7
height=14 src="Excel%20VBA%20Notes%20for%20Professionals_files/image052.gif"></span>The
<span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>If</span>
control statement allows different code to be executed depending upon the
evaluation of a conditional (Boolean) statement. A conditional statement is one
that evaluates to either <b><span style='font-size:9.0pt;line-height:110%;
color:blue;background:#FAFAFA'>True</span></b> or <b><span style='font-size:
9.0pt;line-height:110%;color:blue;background:#FAFAFA'>False</span></b>, e.g. <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>&gt;</span><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:brown;background:#FAFAFA'>2</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.85pt;
margin-left:.25pt'>There are three patterns that can be used when implementing
an <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>If</span>
statement, which are described below. Note that an <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>If</span> conditional evaluation is always
followed by a <b><span style='font-size:9.0pt;line-height:110%;color:blue;
background:#FAFAFA'>Then</span></b>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:13.7pt;
margin-left:11.4pt;text-indent:-11.15pt;line-height:107%'><b><span
style='line-height:107%'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span></b><b>Evaluating one </b><b><span style='font-size:9.0pt;
line-height:107%;background:#FAFAFA'>If</span> conditional statement and doing
something if it is </b><b><span style='font-size:9.0pt;line-height:107%;
color:blue;background:#FAFAFA'>True</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:13.4pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'><b>Single line </b><b><span
style='font-size:9.0pt;line-height:107%;background:#FAFAFA'>If</span> statement</b></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=43 style='width:.45in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=43 valign=top style='width:.45in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>End</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>If</span></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>This is the shortest way to use an <span style='font-size:
9.0pt;line-height:110%;background:#FAFAFA'>If</span> and it is useful when only
one statement needs to be carried out upon a <b><span style='font-size:9.0pt;
line-height:110%;color:blue;background:#FAFAFA'>True </span></b>evaluation.
When using this syntax, all of the code must be on a single line. Do not
include an at the end of the line.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
15.45pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=26
src="Excel%20VBA%20Notes%20for%20Professionals_files/image053.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:13.55pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'><b><span
style='font-size:9.0pt;line-height:107%;background:#FAFAFA'>If</span> block</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>If multiple lines of code need to be executed upon a <b><span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>True</span></b>
evaluation, an <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>If</span>
block may be used.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
15.0pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=60
src="Excel%20VBA%20Notes%20for%20Professionals_files/image054.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=43 style='width:.45in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=43 valign=top style='width:.45in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>End</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>If</span></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:13.1pt;
margin-left:.25pt'>Note that, if a multi-line <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>If</span> block is used, a corresponding
is required.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:.15pt;
margin-left:11.4pt;text-indent:-11.15pt;line-height:107%'><b><span
style='line-height:107%'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span></b><b>Evaluating one conditional </b><b><span style='font-size:
9.0pt;line-height:107%;background:#FAFAFA'>If</span> statement, doing one thing
if it is </b><b><span style='font-size:9.0pt;line-height:107%;color:blue;
background:#FAFAFA'>True</span> and doing something else if it is</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:263.35pt;margin-bottom:
13.95pt;margin-left:-.25pt;text-indent:-.5pt'><b><span style='font-size:9.0pt;
line-height:110%;color:blue;background:#FAFAFA'>False</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:13.5pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'><b>Single line </b><b><span
style='font-size:9.0pt;line-height:107%;background:#FAFAFA'>If</span>, </b><b><span
style='font-size:9.0pt;line-height:107%;color:blue;background:#FAFAFA'>Else</span>
statement</b></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=43 style='width:.45in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=43 valign=top style='width:.45in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>End</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>If</span></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:14.1pt;
margin-left:.25pt'>This may be used if one statement is to be carried out upon
a <b><span style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>True</span></b>
evaluation and a different statement is to be carried out on a <b><span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>False</span></b>
evaluation. Be careful using this syntax, as it is often less clear to readers
that there is an <b><span style='font-size:9.0pt;line-height:110%;color:blue;
background:#FAFAFA'>Else</span></b> statement. When using this syntax, all of
the code must be on a single line. Do not include an at the end of the line.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:17.95pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='position:relative;z-index:
-1895818240'><span style='left:0px;position:absolute;left:0px;top:-8px;
width:718px;height:26px'><img width=718 height=26
src="Excel%20VBA%20Notes%20for%20Professionals_files/image055.gif"></span></span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>If</span></b><span
style='font-size:9.0pt;line-height:110%'> [Some condition </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>is</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>True</span></b><span style='font-size:9.0pt;
line-height:110%'>] </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>Then</span></b><span style='font-size:9.0pt;line-height:110%'> [</span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Do</span></b><span
style='font-size:9.0pt;line-height:110%'> something] </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Else</span></b><span
style='font-size:9.0pt;line-height:110%'> [</span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Do</span></b><span style='font-size:9.0pt;
line-height:110%'> something </span><b><span style='font-size:9.0pt;line-height:
110%;color:blue'>else</span></b><span style='font-size:9.0pt;line-height:110%'>]</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:13.7pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'><b><span
style='font-size:9.0pt;line-height:107%;background:#FAFAFA'>If</span>, </b><b><span
style='font-size:9.0pt;line-height:107%;color:blue;background:#FAFAFA'>Else</span>
block</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>Use an <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>If</span>, <b><span style='font-size:9.0pt;line-height:
110%;color:blue;background:#FAFAFA'>Else</span></b> block to add clarity to
your code, or if multiple lines of code need to be executed under either a <b><span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>True</span></b>
or a <b><span style='font-size:9.0pt;line-height:110%;color:blue;background:
#FAFAFA'>False</span></b> evaluation.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
15.0pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=92
src="Excel%20VBA%20Notes%20for%20Professionals_files/image056.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=43 style='width:.45in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=43 valign=top style='width:.45in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>End</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>If</span></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>Note that, if a multi-line <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>If</span> block is used, a corresponding
is required.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:12.9pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'><b>3. Evaluating many
conditional statements, when preceding statements are all </b><b><span
style='font-size:9.0pt;line-height:107%;color:blue;background:#FAFAFA'>False</span>,
and doing something different for each one</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:13.3pt;
margin-left:.25pt'>This pattern is the most general use of <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>If</span> and would
be used when there are many non-overlapping conditions that require different
treatment. Unlike the first two patterns, this case requires the use of an <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>If</span> block,
even if only one line of code will be executed for each condition.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:13.8pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'><b><span
style='font-size:9.0pt;line-height:107%;background:#FAFAFA'>If</span>, </b><b><span
style='font-size:9.0pt;line-height:107%;color:blue;background:#FAFAFA'>ElseIf</span>,
</b><b><span style='font-size:9.0pt;line-height:107%;background:#FAFAFA'>...</span>,
</b><b><span style='font-size:9.0pt;line-height:107%;color:blue;background:
#FAFAFA'>Else</span> block</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>Instead of having to create many <span style='font-size:
9.0pt;line-height:110%;background:#FAFAFA'>If</span> blocks one below another,
an <b><span style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>ElseIf</span></b>
may be used evaluate an extra condition. The <b><span style='font-size:9.0pt;
line-height:110%;color:blue;background:#FAFAFA'>ElseIf</span></b> is only
evaluated if any preceding <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>If</span> evaluation is <b><span style='font-size:9.0pt;
line-height:110%;color:blue;background:#FAFAFA'>False</span></b>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
15.05pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=125
src="Excel%20VBA%20Notes%20for%20Professionals_files/image057.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=43 style='width:.45in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=43 valign=top style='width:.45in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>End</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>If</span></b></p>
  </td>
 </tr>
</table>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=43 style='width:.45in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=43 valign=top style='width:.45in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>End</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>If</span></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>As many <b><span style='font-size:9.0pt;line-height:110%;
color:blue;background:#FAFAFA'>ElseIf</span></b> control statements may be
included between an <span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>If</span> and an as required. An <b><span style='font-size:9.0pt;
line-height:110%;color:blue;background:#FAFAFA'>Else</span></b> control
statement is not required when using <b><span style='font-size:9.0pt;
line-height:110%;color:blue;background:#FAFAFA'>ElseIf</span></b> (although it
is recommended), but if it is included, it must be the final control statement
before the .<br clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc152119">Chapter 4: Ranges and Cells</a></h1>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc152120">Section 4.1: Ways to refer to a single cell</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>The simplest way to refer to a single cell on the current
Excel worksheet is simply to enclose the A1 form of its reference in square
brackets:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
15.15pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=26
src="Excel%20VBA%20Notes%20for%20Professionals_files/image058.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>Note that square brackets are just convenient <a
href="https://en.wikipedia.org/wiki/Syntactic_sugar"><span style='color:#02723B'>syntactic
sugar</span></a> for the <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>Evaluate</span> method of the <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>Application</span> object, so technically,
this is identical to the following code:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
15.0pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=26
src="Excel%20VBA%20Notes%20for%20Professionals_files/image059.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>You could also call the <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>Cells</span> method which takes a row and
a column and returns a cell reference.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=26
src="Excel%20VBA%20Notes%20for%20Professionals_files/image060.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.5pt;
margin-left:.25pt'>Remember that whenever you pass a row and a column to Excel
from VBA, the row is always first, followed by the column, which is confusing
because it is the opposite of the common <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>A1</span> notation where the column
appears first.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>In both of these examples, we did not specify a worksheet,
so Excel will use the active sheet (the sheet that is in front in the user
interface). You can specify the active sheet explicitly:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=26
src="Excel%20VBA%20Notes%20for%20Professionals_files/image061.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>Or you can provide the name of a particular sheet:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
15.0pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=26
src="Excel%20VBA%20Notes%20for%20Professionals_files/image062.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>There are a wide variety of methods that can be used to get
from one range to another. For example, the <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>Rows </span>method can be used to get to
the individual rows of any range, and the <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>Cells</span> method can be used to get to
individual cells of a row or column, so the following code refers to cell C1:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
10.35pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=26
src="Excel%20VBA%20Notes%20for%20Professionals_files/image063.gif"></span></p>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc152121">Section 4.2: Creating a Range</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>A <a
href="https://msdn.microsoft.com/en-us/library/office/ff838238.aspx"><span
style='color:#02723B'>Range</span></a> cannot be created or populated the same
way a string would:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=720 height=223
src="Excel%20VBA%20Notes%20for%20Professionals_files/image064.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:7.6pt;margin-bottom:12.45pt;
margin-left:.25pt'>It is considered best practice to qualify your references,
so from now on we will use the same approach here. More about <a
href="https://msdn.microsoft.com/en-us/library/office/gg251791.aspx"><span
style='color:#02723B'>Creating Object Variables (e.g. Range) on MSDN</span></a>
. More about <a
href="https://msdn.microsoft.com/en-us/library/office/gg251642.aspx"><span
style='color:#02723B'>Set Statement on MSDN</span></a>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:14.45pt;
margin-left:.25pt'>There are different ways to create the same Range:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Sub</span></b><span style='font-size:9.0pt;
line-height:110%'> SetRangeVariable()</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Dim</span></b><span
style='font-size:9.0pt;line-height:110%'> ws </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>As</span></b><span style='font-size:9.0pt;
line-height:110%'> Worksheet</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.55pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Dim</span></b><span
style='font-size:9.0pt;line-height:110%'> r </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>As</span></b><span style='font-size:9.0pt;
line-height:110%'> Range</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:33.5pt;margin-bottom:
.15pt;margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;
line-height:110%'> </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>Set</span></b><span style='font-size:9.0pt;line-height:110%'> ws =
ThisWorkbook.Worksheets(</span><span style='font-size:9.0pt;line-height:110%;
color:brown'>1</span><span style='font-size:9.0pt;line-height:110%'>) </span><i><span
style='font-size:9.0pt;line-height:110%;color:green'>' The first Worksheet in
Workbook with this code in it </span></i><span style='font-size:9.0pt;
line-height:110%'></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.3pt;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><i><span style='font-size:9.0pt;line-height:110%;color:green'>'
These are all equivalent:</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Set</span></b><span
style='font-size:9.0pt;line-height:110%'> r = ws.Range(</span><span
style='font-size:9.0pt;line-height:110%;color:brown'>&quot;A2&quot;</span><span
style='font-size:9.0pt;line-height:110%'>)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Set</span></b><span
style='font-size:9.0pt;line-height:110%'> r = ws.Range(</span><span
style='font-size:9.0pt;line-height:110%;color:brown'>&quot;A&quot;</span><span
style='font-size:9.0pt;line-height:110%'> &amp; </span><span style='font-size:
9.0pt;line-height:110%;color:brown'>2</span><span style='font-size:9.0pt;
line-height:110%'>)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.3pt;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Set</span></b><span
style='font-size:9.0pt;line-height:110%'> r = ws.Cells(</span><span
style='font-size:9.0pt;line-height:110%;color:brown'>2</span><span
style='font-size:9.0pt;line-height:110%'>, </span><span style='font-size:9.0pt;
line-height:110%;color:brown'>1</span><span style='font-size:9.0pt;line-height:
110%'>) </span><i><span style='font-size:9.0pt;line-height:110%;color:green'>'
The cell in row number 2, column number 1</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.3pt;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Set</span></b><span
style='font-size:9.0pt;line-height:110%'> r = ws.[A2] </span><i><span
style='font-size:9.0pt;line-height:110%;color:green'>'Shorthand notation of
Range.</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.3pt;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Set</span></b><span
style='font-size:9.0pt;line-height:110%'> r = Range(</span><span
style='font-size:9.0pt;line-height:110%;color:brown'>&quot;NamedRangeInA2&quot;</span><span
style='font-size:9.0pt;line-height:110%'>) </span><i><span style='font-size:
9.0pt;line-height:110%;color:green'>'If the cell A2 is named NamedRangeInA2.
Note, that this is Sheet independent.</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.3pt;margin-bottom:12.45pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Set</span></b><span
style='font-size:9.0pt;line-height:110%'> r = ws.Range(</span><span
style='font-size:9.0pt;line-height:110%;color:brown'>&quot;A1&quot;</span><span
style='font-size:9.0pt;line-height:110%'>).Offset(</span><span
style='font-size:9.0pt;line-height:110%;color:brown'>1</span><span
style='font-size:9.0pt;line-height:110%'>, </span><span style='font-size:9.0pt;
line-height:110%;color:brown'>0</span><span style='font-size:9.0pt;line-height:
110%'>) </span><i><span style='font-size:9.0pt;line-height:110%;color:green'>'
The cell that is 1 row and 0 columns away from A1 </span></i><span
style='font-size:9.0pt;line-height:110%'></span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Set</span></b><span style='font-size:9.0pt;
line-height:110%'> r = ws.Range(</span><span style='font-size:9.0pt;line-height:
110%;color:brown'>&quot;A1&quot;</span><span style='font-size:9.0pt;line-height:
110%'>).Cells(</span><span style='font-size:9.0pt;line-height:110%;color:brown'>2</span><span
style='font-size:9.0pt;line-height:110%'>,</span><span style='font-size:9.0pt;
line-height:110%;color:brown'>1</span><span style='font-size:9.0pt;line-height:
110%'>) </span><i><span style='font-size:9.0pt;line-height:110%;color:green'>'
Similar to Offset. You can &quot;go outside&quot; the original Range.</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.3pt;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Set</span></b><span
style='font-size:9.0pt;line-height:110%'> r = ws.Range(</span><span
style='font-size:9.0pt;line-height:110%;color:brown'>&quot;A1:A5&quot;</span><span
style='font-size:9.0pt;line-height:110%'>).Cells(</span><span style='font-size:
9.0pt;line-height:110%;color:brown'>2</span><span style='font-size:9.0pt;
line-height:110%'>) </span><i><span style='font-size:9.0pt;line-height:110%;
color:green'>'Second cell in bigger Range.</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.45in;margin-bottom:
17.2pt;margin-left:3.5pt;text-indent:-.5pt'><span style='position:relative;
z-index:-1895817216'><span style='left:0px;position:absolute;left:0px;
top:-287px;width:718px;height:338px'><img width=718 height=338
src="Excel%20VBA%20Notes%20for%20Professionals_files/image065.gif"></span></span><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Set</span></b><span style='font-size:9.0pt;
line-height:110%'> r = ws.Range(</span><span style='font-size:9.0pt;line-height:
110%;color:brown'>&quot;A1:A5&quot;</span><span style='font-size:9.0pt;
line-height:110%'>).Item(</span><span style='font-size:9.0pt;line-height:110%;
color:brown'>2</span><span style='font-size:9.0pt;line-height:110%'>) </span><i><span
style='font-size:9.0pt;line-height:110%;color:green'>'Second cell in bigger
Range. </span></i><span style='font-size:9.0pt;line-height:110%'></span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Set</span></b><span
style='font-size:9.0pt;line-height:110%'> r = ws.Range(</span><span
style='font-size:9.0pt;line-height:110%;color:brown'>&quot;A1:A5&quot;</span><span
style='font-size:9.0pt;line-height:110%'>)(</span><span style='font-size:9.0pt;
line-height:110%;color:brown'>2</span><span style='font-size:9.0pt;line-height:
110%'>) </span><i><span style='font-size:9.0pt;line-height:110%;color:green'>'Second
cell in bigger Range. </span></i><b><span style='font-size:9.0pt;line-height:
110%;color:blue'>End</span></b><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Sub</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:8.3pt;margin-bottom:12.45pt;
margin-left:.25pt'>Note in the example that Cells(2, 1) is equivalent to
Range(&quot;A2&quot;). This is because Cells returns a Range object. Some
sources: <a href="http://www.cpearson.com/Excel/cells.htm"><span
style='color:#02723B'>Chip Pearson-Cells Within Ranges</span></a>; <a
href="https://msdn.microsoft.com/en-us/library/office/ff838238.aspx"><span
style='color:#02723B'>MSDN-Range Object</span></a>; <a
href="http://spreadsheetpage.com/index.php/tip/referring_to_ranges_in_your_vba_code/"><span
style='color:#02723B'>John Walkenback-Referring To Ranges In </span></a><a
href="http://spreadsheetpage.com/index.php/tip/referring_to_ranges_in_your_vba_code/"><span
style='color:#02723B'>Your VBA Code</span></a>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>Also note that in any instance where a number is used in the
declaration of the range, and the number itself is outside of quotation marks,
such as Range(&quot;A&quot; &amp; 2), you can swap that number for a variable
that contains an integer/long. For example:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=273
src="Excel%20VBA%20Notes%20for%20Professionals_files/image066.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>If you are using double loops, Cells is better:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=718 height=112
src="Excel%20VBA%20Notes%20for%20Professionals_files/image067.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
10.35pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=202
src="Excel%20VBA%20Notes%20for%20Professionals_files/image068.gif"></span></p>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc152122">Section 4.3: O&#57379;set Property</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.55pt;margin-bottom:.25pt;
margin-left:.25pt;text-align:justify;text-justify:inter-ideograph;text-indent:
20.9pt;line-height:154%'><span style='font-size:11.0pt;line-height:154%'><img
border=0 width=5 height=5 id="Group 132459"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image003.gif"></span><b>Offset(Rows,
Columns)</b> - The operator used to statically reference another point from the
current cell. Often used in loops. It should be understood that positive
numbers in the rows section moves right, wheres as negatives move left. With
the columns section positives move down and negatives move up. i.e</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=109
src="Excel%20VBA%20Notes%20for%20Professionals_files/image069.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt;line-height:145%'>This code selects B2, puts a new string
there, then moves that string back to A1 afterwards clearing out B2.</p>

<h2 style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;margin-left:
.25pt;text-indent:.5pt;line-height:145%'><a name="_Toc152123">Section 4.4:
Saving a reference to a cell in a variable</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>To save a reference to a cell in a variable, you must use
the <b><span style='font-size:9.0pt;line-height:110%;color:blue;background:
#FAFAFA'>Set</span></b> syntax, for example:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=43
src="Excel%20VBA%20Notes%20for%20Professionals_files/image070.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:-.25pt;text-indent:-.5pt;line-height:107%'><i>later...</i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
15.0pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=26
src="Excel%20VBA%20Notes%20for%20Professionals_files/image071.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:18.2pt;
margin-left:.25pt'>Why is the <b><span style='font-size:9.0pt;line-height:110%;
color:blue;background:#FAFAFA'>Set</span></b> keyword required? <b><span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>Set</span></b>
tells Visual Basic that the value on the right hand side of the <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>=</span> is meant
to be an object.</p>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:0in;margin-left:
-.25pt'><a name="_Toc152124">Section 4.5: How to Transpose Ranges (Horizontal
to Vertical &amp; vice versa)</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=718 height=168
src="Excel%20VBA%20Notes%20for%20Professionals_files/image072.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=38
src="Excel%20VBA%20Notes%20for%20Professionals_files/image073.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>Note: Copy/PasteSpecial also has a Paste Transpose option
which updates the transposed cells' formulas as well.<br clear=all
style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc152125">Chapter 5: Named Ranges</a></h1>

<p class=MsoNormal style='margin-top:0in;margin-right:29.2pt;margin-bottom:
.25pt;margin-left:.75pt;text-align:justify;text-justify:inter-ideograph;
text-indent:-.5pt;line-height:133%'>Topic should include information
specifically related to named ranges in Excel including methods for creating,
modifying, deleting, and accessing defined named ranges.</p>

<h2 style='margin-top:0in;margin-right:29.2pt;margin-bottom:.25pt;margin-left:
.75pt;text-align:justify;text-justify:inter-ideograph;line-height:133%'><a
name="_Toc152126">Section 5.1: Define A Named Range</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.5pt;
margin-left:.25pt'>Using named ranges allows you to describe the meaning of a
cell(s) contents and use this defined name in place of an actual cell address.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=265 style='width:198.8pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=14 valign=top style='width:.15in;background:#FAFAFA;padding:.95pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>A5</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:.95pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;background:#FAFAFA'>*</span></p>
  </td>
  <td width=14 valign=top style='width:.15in;background:#FAFAFA;padding:.95pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>B5</span></p>
  </td>
  <td width=143 valign=top style='width:107.0pt;padding:.95pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>can be replaced with <span
  style='font-size:9.0pt;line-height:107%;background:#FAFAFA'>=</span></p>
  </td>
  <td width=36 valign=top style='width:27.0pt;background:#FAFAFA;padding:.95pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>Width</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:.95pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;background:#FAFAFA'>*</span></p>
  </td>
  <td width=43 valign=top style='width:.45in;background:#FAFAFA;padding:.95pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>Height</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.45pt;
margin-left:.25pt'>For example, formula <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>=</span> to make the formula much easier
to read and understand.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>To define a new named range, select cell or cells to name
and then type new name into the Name Box next to the formula bar.</p>

<p class=MsoNormal style='margin-bottom:52.4pt;text-indent:0in;line-height:
107%'><img border=0 width=405 height=203 id="Picture 4547"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image074.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:21.55pt;margin-bottom:
29.4pt;margin-left:24.0pt'><img width=3 height=111
src="Excel%20VBA%20Notes%20for%20Professionals_files/image075.gif" align=left
hspace=12>Note: Named Ranges default to global scope meaning that they can be
accessed from anywhere within the workbook. Older versions of Excel allow for
duplicate names so care must be taken to prevent duplicate names of global
scope otherwise results will be unpredictable. Use Name Manager from Formulas
tab to change scope.</p>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc152127">Section 5.2: Using Named Ranges in VBA</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'><b>Create</b> new named range called <span style='font-family:
"Arial",sans-serif'></span>MyRange<span style='font-family:"Arial",sans-serif'></span>
assigned to cell <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>A1</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
15.2pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=43
src="Excel%20VBA%20Notes%20for%20Professionals_files/image076.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'><b>Delete</b> defined named range by name</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
15.2pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=26
src="Excel%20VBA%20Notes%20for%20Professionals_files/image077.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:.15pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'><b>Access Named Range</b>
by name</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=718 height=60
src="Excel%20VBA%20Notes%20for%20Professionals_files/image078.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:13.3pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'><b>Access a Named Range
with a Shortcut</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'><a
href="http://www.informit.com/articles/article.aspx?p=2021718&amp;seqNum=4"><span
style='color:#02723B'>Just like any other range</span></a>, named ranges can be
accessed directly with through a shortcut notation that does not require a <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Range</span> object
to be created. The three lines from the code excerpt above can be replaced by a
single line:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
15.05pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=93
src="Excel%20VBA%20Notes%20for%20Professionals_files/image079.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>You can also call methods on the range. The following
selects <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>MyRange</span>:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
10.35pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=720 height=133
src="Excel%20VBA%20Notes%20for%20Professionals_files/image080.gif"></span></p>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc152128">Section 5.3: Manage Named Range(s) using Name
Manager</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.8pt;
margin-left:.25pt'>Formulas tab &gt; Defined Names group &gt; Name Manager
button</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:13.3pt;
margin-left:.25pt'>Named Manager allows you to:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:110%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Create
or change name</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:110%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Create
or change cell reference</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:110%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Create
or change scope</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:110%'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Delete
existing named range</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><img border=0
width=718 height=599 id="Picture 4757"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image081.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>Named Manager provides a useful quick look for broken links.</p>

<p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><img
border=0 width=457 height=351 id="Picture 4760"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image082.jpg"></p>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc152129">Section 5.4: Named Range Arrays</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>Example sheet</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
15.2pt;margin-left:0in;text-indent:0in;line-height:107%'><img border=0
width=718 height=363 id="Picture 4783"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image083.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:.15pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'><b>Code</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
15.2pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=174
src="Excel%20VBA%20Notes%20for%20Professionals_files/image084.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:.15pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'><b>Result</b></p>

<p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><img
border=0 width=360 height=268 id="Picture 4866"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image085.jpg"></p>

<h1 style='margin-left:-.25pt'><a name="_Toc152130">Chapter 6: Merged Cells /
Ranges</a></h1>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc152131">Section 6.1: Think twice before using Merged
Cells/Ranges</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.8pt;
margin-left:.25pt'>First of all, Merged Cells are there only to improve the
look of your sheets.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:28.1pt;
margin-left:.25pt'>So it is literally the last thing that you should do, once
your sheet and workbook are totally functional!</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:13.3pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'><b>Where is the data in a
Merged Range?</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:13.05pt;
margin-left:.25pt'>When you merge a Range, you'll only display one block.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:13.3pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'>The data will be in the
very <b>first cell of that Range</b>, and the <b>others will be empty cells</b>!</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.8pt;
margin-left:.25pt'>One good point about it : no need to fill all the cells or
the range once merged, just fill the first cell! ;)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:13.3pt;
margin-left:.25pt'>The other aspects of this merged ranged are globally
negative :</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:20.9pt'><span style='font-size:11.0pt;line-height:110%'><img
border=0 width=5 height=35 id="Group 126474"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image086.gif"></span>If
you use a method for finding last row or column, you'll risk some errors</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:20.9pt'>If you loop through rows and you have merged some ranges
for a better readability, you'll encounter empty cells and not the value
displayed by the merged range<br clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc152132">Chapter 7: Locating
duplicate values in a range</a></h1>

<p class=MsoNormal style='margin-top:0in;margin-right:14.95pt;margin-bottom:
.25pt;margin-left:.75pt;text-align:justify;text-justify:inter-ideograph;
text-indent:-.5pt;line-height:133%'>At certain points, you will be evaluating a
range of data and you will need to locate the duplicates in it. For bigger data
sets, there are a number of approaches you can take that use either VBA code or
conditional functions. This example uses a simple if-then condition within two
nested for-next loops to test whether each cell in the range is equal in value
to any other cell in the range.</p>

<h2 style='margin-top:0in;margin-right:14.95pt;margin-bottom:.25pt;margin-left:
.75pt;text-align:justify;text-justify:inter-ideograph;line-height:133%'><a
name="_Toc152133">Section 7.1: Find duplicates in a range</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:14.1pt;
margin-left:.25pt'>The following tests range A2 to A7 for duplicate values. <b>Remark:</b>
This example illustrates a possible solution as a first approach to a solution.
It's faster to use an array than a range and one could use collections or
dictionaries or xml methods to check for duplicates.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Sub</span></b><span
style='font-size:9.0pt;line-height:110%'> find_duplicates()</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.3pt;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><i><span style='font-size:9.0pt;
line-height:110%;color:green'>' Declare variables</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Dim</span></b><span
style='font-size:9.0pt;line-height:110%'> ws </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> Worksheet </span><i><span
style='font-size:9.0pt;line-height:110%;color:green'>' worksheet</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Dim</span></b><span
style='font-size:9.0pt;line-height:110%'> cell </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> Range </span><i><span
style='font-size:9.0pt;line-height:110%;color:green'>' cell within worksheet
range</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.3pt;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Dim</span></b><span
style='font-size:9.0pt;line-height:110%'> n </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>Integer</span><span style='font-size:9.0pt;
line-height:110%'> </span><i><span style='font-size:9.0pt;
line-height:110%;color:green'>' highest row number</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.3pt;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Dim</span></b><span
style='font-size:9.0pt;line-height:110%'> bFound </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>Boolean</span><span style='font-size:9.0pt;
line-height:110%'> </span><i><span style='font-size:9.0pt;
line-height:110%;color:green'>' boolean flag, if duplicate is found</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Dim</span></b><span
style='font-size:9.0pt;line-height:110%'> sFound </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>String</span><span style='font-size:9.0pt;
line-height:110%'>: sFound = </span><span style='font-size:9.0pt;line-height:
110%;color:brown'>&quot;|&quot;</span><span style='font-size:9.0pt;line-height:
110%'> </span><i><span style='font-size:9.0pt;line-height:110%;color:green'>'
found duplicates</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.3pt;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Dim</span></b><span
style='font-size:9.0pt;line-height:110%'> s </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>String</span><span style='font-size:9.0pt;
line-height:110%'> </span><i><span style='font-size:9.0pt;
line-height:110%;color:green'>' message string</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.3pt;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Dim</span></b><span
style='font-size:9.0pt;line-height:110%'> s2 </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>String</span><span style='font-size:9.0pt;
line-height:110%'> </span><i><span style='font-size:9.0pt;
line-height:110%;color:green'>' partial message string</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.3pt;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><i><span style='font-size:9.0pt;
line-height:110%;color:green'>' Set Sheet to memory</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.55pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Set</span></b><span
style='font-size:9.0pt;line-height:110%'> ws = ThisWorkbook.Sheets(</span><span
style='font-size:9.0pt;line-height:110%;color:brown'>&quot;Duplicates&quot;</span><span
style='font-size:9.0pt;line-height:110%'>)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:133.9pt;margin-bottom:
.15pt;margin-left:3.5pt;text-indent:-.5pt'><i><span style='font-size:9.0pt;
line-height:110%;color:green'>' loop thru FULLY QUALIFIED REFERENCE </span></i><span
style='font-size:9.0pt;line-height:110%'></span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>For</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>Each</span></b><span style='font-size:9.0pt;line-height:110%'> cell
</span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>In</span></b><span
style='font-size:9.0pt;line-height:110%'> ws.Range(</span><span
style='font-size:9.0pt;line-height:110%;color:brown'>&quot;A2:A7&quot;</span><span
style='font-size:9.0pt;line-height:110%'>) bFound = </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>False</span></b><span
style='font-size:9.0pt;line-height:110%'>: s2 = </span><span style='font-size:
9.0pt;line-height:110%;color:brown'>&quot;&quot;</span><span style='font-size:
9.0pt;line-height:110%'> </span><i><span style='font-size:9.0pt;
line-height:110%;color:green'>' start each cell with empty values</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.3pt;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'></span><i><span style='font-size:9.0pt;line-height:110%;color:green'>'
Check if first occurrence of this value as duplicate to avoid further searches</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>If</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:#000066'>InStr</span><span style='font-size:9.0pt;
line-height:110%'>(sFound, </span><span style='font-size:9.0pt;line-height:
110%;color:brown'>&quot;|&quot;</span><span style='font-size:9.0pt;line-height:
110%'> &amp; cell &amp; </span><span style='font-size:9.0pt;line-height:110%;
color:brown'>&quot;|&quot;</span><span style='font-size:9.0pt;line-height:110%'>)
= </span><span style='font-size:9.0pt;line-height:110%;color:brown'>0</span><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Then</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
margin-left:3.75pt;text-indent:0in;line-height:107%'><span style='font-size:
9.0pt;line-height:107%'> </span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.3pt;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>For</span></b><span
style='font-size:9.0pt;line-height:110%'> n = cell.Row + </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>1</span><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>To</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:brown'>7</span><span style='font-size:9.0pt;line-height:110%'> </span><i><span
style='font-size:9.0pt;line-height:110%;color:green'>' iterate starting point
to avoid REDUNDANT SEARCH</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>If</span></b><span style='font-size:9.0pt;line-height:110%'> cell =
ws.Range(</span><span style='font-size:9.0pt;line-height:110%;color:brown'>&quot;A&quot;</span><span
style='font-size:9.0pt;line-height:110%'> &amp; n).Value </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Then</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.3pt;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>If</span></b><span style='font-size:9.0pt;line-height:110%'>
cell.Row &lt;&gt; n </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>Then</span></b><span style='font-size:9.0pt;line-height:110%'>
</span><i><span style='font-size:9.0pt;line-height:110%;color:green'>' only
other cells, as same cell cannot be a duplicate </span></i><span
style='font-size:9.0pt;line-height:110%'>bFound = </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>True</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><i><span
style='font-size:9.0pt;line-height:110%;color:green'>' boolean flag</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.3pt;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><i><span style='font-size:9.0pt;line-height:110%;
color:green'>' found duplicates in cell A{n}</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> s2 = s2 &amp; vbNewLine &amp; </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>&quot; -&gt; duplicate in
A&quot;</span><span style='font-size:9.0pt;line-height:110%'> &amp; n</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>End</span></b><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>If</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>End</span></b><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>If</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>Next</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>End</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>If</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.3pt;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><i><span style='font-size:9.0pt;line-height:110%;color:green'>'
notice all found duplicates</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>If</span></b><span
style='font-size:9.0pt;line-height:110%'> bFound </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Then</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:185.05pt;margin-bottom:
.15pt;margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;
line-height:110%'> </span><i><span style='font-size:9.0pt;line-height:
110%;color:green'>' add value to list of all found duplicate values </span></i><span
style='font-size:9.0pt;line-height:110%'></span><i><span
style='font-size:9.0pt;line-height:110%;color:green'>' (could be easily split
to an array for further analyze) </span></i><span style='font-size:9.0pt;
line-height:110%'>sFound = sFound &amp; cell &amp; </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>&quot;|&quot;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:54.2pt;margin-bottom:
.2pt;margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;
line-height:110%'> s = s &amp; cell.Address &amp; </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>&quot; (value=&quot;</span><span
style='font-size:9.0pt;line-height:110%'> &amp; cell &amp; </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>&quot;)&quot;</span><span
style='font-size:9.0pt;line-height:110%'> &amp; s2 &amp; vbNewLine &amp;
vbNewLine </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>End</span></b><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>If</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Next</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.3pt;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><i><span style='font-size:9.0pt;
line-height:110%;color:green'>' Messagebox with final result</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:38.0pt;margin-bottom:
17.2pt;margin-left:3.5pt;text-indent:-.5pt'><span style='position:relative;
z-index:-1895815168'><span style='left:0px;position:absolute;left:0px;
top:-616px;width:718px;height:667px'><img width=718 height=667
src="Excel%20VBA%20Notes%20for%20Professionals_files/image087.gif"></span></span><span
style='font-size:9.0pt;line-height:110%'> MsgBox </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>&quot;Duplicate values are
&quot;</span><span style='font-size:9.0pt;line-height:110%'> &amp; sFound &amp;
vbNewLine &amp; vbNewLine &amp; s, vbInformation, </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>&quot;Found
duplicates&quot; </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>End</span></b><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Sub</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>Depending on your needs, the example can be modified - for
instance, the upper limit of n can be the row value of last cell with data in
the range, or the action in case of a True If condition can be edited to
extract the duplicate value somewhere else. However, the mechanics of the
routine would not change.<br clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc152134">Chapter 8: User Defined
Functions (UDFs)</a></h1>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc152135">Section 8.1: Allow full column references without
penalty</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.45pt;
margin-left:.25pt'>It's easier to implement some UDFs on the worksheet if full
column references can be passed in as parameters. However, due to the explicit
nature of coding, any loop involving these ranges may be processing hundreds of
thousands of cells that are completely empty. This reduces your VBA project
(and workbook) to a frozen mess while unnecessary non-values are processed.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.45pt;
margin-left:.25pt'>Looping through a worksheet's cells is one of the slowest
methods of accomplishing a task but sometimes it is unavoidable. Cutting the
work performed down to what is actually required makes perfect sense.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.45pt;
margin-left:.25pt'>The solution is to truncate the full column or full row
references to the <a
href="https://msdn.microsoft.com/en-us/library/office/ff840732.aspx"><span
style='color:#02723B'>Worksheet.UsedRange property</span></a> with the <a
href="https://msdn.microsoft.com/en-us/library/office/aa195772.aspx"><span
style='color:#02723B'>Intersect method</span></a>. The following sample will
loosely replicate a worksheet's native SUMIF function so the <i>criteria_range</i>
will also be resized to suit the <i>sum_range</i> since each value in the <i>sum_range</i>
must be accompanied by a value in the <i>criteria_range</i>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>The <a
href="https://msdn.microsoft.com/en-us/library/office/ff193687.aspx"><span
style='color:#02723B'>Application.Caller</span></a> for a UDF used on a
worksheet is the cell in which it resides. The cell's <a
href="https://msdn.microsoft.com/en-us/library/office/aa224980.aspx"><span
style='color:#02723B'>.Parent</span></a> property is the worksheet. This will
be used to define the .UsedRange.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=718 height=488
src="Excel%20VBA%20Notes%20for%20Professionals_files/image088.gif"></span></p>

<p class=MsoNormal style='margin-bottom:14.95pt;text-indent:0in;line-height:
107%'><img border=0 width=520 height=312 id="Picture 5490"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image089.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.7pt;
margin-left:.25pt'>While this is a fairly simplistic example, it adequately
demonstrates passing in two full column references (1,048,576 rows each) but
only processing 15 rows of data and criteria.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:14.95pt;margin-bottom:
0in;margin-left:.25pt;line-height:145%'>Linked official MSDN documentation of
individual methods and properties courtesy of Microsoft<span style='font-family:
"Arial",sans-serif'></span>.</p>

<h2 style='margin-top:0in;margin-right:14.95pt;margin-bottom:0in;margin-left:
.25pt;text-indent:.5pt;line-height:145%'><a name="_Toc152136">Section 8.2:
Count Unique values in Range</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=720 height=223
src="Excel%20VBA%20Notes%20for%20Professionals_files/image090.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:18.55pt;
margin-left:.25pt'>Collections</p>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc152137">Section 8.3: UDF - Hello World</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:110%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Open
Excel</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:110%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Open
the Visual Basic Editor ( see Opening the Visual Basic Editor )</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:110%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Add
a new module by clicking Insert --&gt; Module :</p>

<p class=MsoNormal style='margin-bottom:14.95pt;text-indent:0in;line-height:
107%'><img border=0 width=297 height=261 id="Picture 5607"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image022.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:110%'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Copy
and Paste the following code in the new module :</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=76
src="Excel%20VBA%20Notes%20for%20Professionals_files/image091.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>To obtain :</p>

<p class=MsoNormal style='margin-bottom:14.95pt;text-indent:0in;line-height:
107%'><img border=0 width=633 height=410 id="Picture 5630"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image092.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:.15pt;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:110%'>5.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Go
back to your workbook and type &quot;=Hello()&quot; into a cell to see the
&quot;Hello World&quot;.</p>

<p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><img
border=0 width=370 height=266 id="Picture 5651"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image093.jpg"><br
clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc152138">Chapter 9: Conditional
formatting using VBA</a></h1>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc152139">Section 9.1: FormatConditions.Add</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:.15pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'><b>Syntax:</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
4.0pt;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=718 height=26
src="Excel%20VBA%20Notes%20for%20Professionals_files/image094.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:2.1pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'><b>Parameters:</b></p>

<p class=MsoNormal style='margin-bottom:.15pt;text-indent:0in;line-height:107%'><b>Name Required
/ Optional Data Type</b></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=343
 style='width:257.55pt;margin-left:1.0pt;border-collapse:collapse'>
 <tr style='height:13.65pt'>
  <td width=197 valign=top style='width:147.9pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Type Required</p>
  </td>
  <td width=146 valign=top style='width:109.65pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>XlFormatConditionType</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=197 valign=top style='width:147.9pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Operator
  Optional</p>
  </td>
  <td width=146 valign=top style='width:109.65pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Variant</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=197 valign=top style='width:147.9pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Formula1
  Optional</p>
  </td>
  <td width=146 valign=top style='width:109.65pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Variant</p>
  </td>
 </tr>
 <tr style='height:13.65pt'>
  <td width=197 valign=top style='width:147.9pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Formula2
  Optional</p>
  </td>
  <td width=146 valign=top style='width:109.65pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Variant</p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:2.1pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'><b>XlFormatConditionType
enumaration:</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:207.45pt;margin-bottom:
0in;margin-left:.25pt;text-indent:45.65pt'><b>Name Description </b>xlAboveAverageCondition
Above average condition</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=288
 style='width:216.2pt;margin-left:1.0pt;border-collapse:collapse'>
 <tr style='height:13.65pt'>
  <td width=164 valign=top style='width:123.2pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>xlBlanksCondition</p>
  </td>
  <td width=124 valign=top style='width:93.0pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Blanks
  condition</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=164 valign=top style='width:123.2pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>xlCellValue</p>
  </td>
  <td width=124 valign=top style='width:93.0pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Cell
  value</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=164 valign=top style='width:123.2pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>xlColorScale</p>
  </td>
  <td width=124 valign=top style='width:93.0pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Color
  scale</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=164 valign=top style='width:123.2pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>xlDatabar</p>
  </td>
  <td width=124 valign=top style='width:93.0pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Databar</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=164 valign=top style='width:123.2pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>xlErrorsCondition</p>
  </td>
  <td width=124 valign=top style='width:93.0pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Errors
  condition</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=164 valign=top style='width:123.2pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>xlExpression</p>
  </td>
  <td width=124 valign=top style='width:93.0pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Expression</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=164 valign=top style='width:123.2pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>XlIconSet</p>
  </td>
  <td width=124 valign=top style='width:93.0pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Icon
  set</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=164 valign=top style='width:123.2pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>xlNoBlanksCondition</p>
  </td>
  <td width=124 valign=top style='width:93.0pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>No blanks condition</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=164 valign=top style='width:123.2pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>xlNoErrorsCondition</p>
  </td>
  <td width=124 valign=top style='width:93.0pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>No errors condition</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=164 valign=top style='width:123.2pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>xlTextString</p>
  </td>
  <td width=124 valign=top style='width:93.0pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Text
  string</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=164 valign=top style='width:123.2pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>xlTimePeriod</p>
  </td>
  <td width=124 valign=top style='width:93.0pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Time
  period</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=164 valign=top style='width:123.2pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>xlTop10</p>
  </td>
  <td width=124 valign=top style='width:93.0pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Top
  10 values</p>
  </td>
 </tr>
 <tr style='height:13.65pt'>
  <td width=164 valign=top style='width:123.2pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>xlUniqueValues</p>
  </td>
  <td width=124 valign=top style='width:93.0pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Unique
  values</p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:.15pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'><b>Formatting by cell
value:</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
19.05pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=109
src="Excel%20VBA%20Notes%20for%20Professionals_files/image095.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:1.6pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'><b>Operators:</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:.15pt;
margin-left:21.9pt;text-indent:-.5pt;line-height:107%'><b>Name</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:460.35pt;margin-bottom:
1.5pt;margin-left:.25pt;line-height:137%'>xlBetween xlEqual xlGreater
xlGreaterEqual xlLess xlLessEqual xlNotBetween xlNotEqual</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:13.05pt;
margin-left:.25pt'>If Type is xlExpression, the Operator argument is ignored.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:.15pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'><b>Formatting by text
contains:</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
19.05pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=109
src="Excel%20VBA%20Notes%20for%20Professionals_files/image096.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:2.1pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'><b>Operators:</b></p>

<p class=MsoNormal style='margin-bottom:1.35pt;text-indent:0in;line-height:
107%'><span style='font-size:11.0pt;line-height:107%'> </span><b>Name Description</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:264.75pt;margin-bottom:
0in;margin-left:.25pt;line-height:141%'>xlBeginsWith Begins with a
specified value. xlContains Contains a specified value.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:3.85pt;
margin-left:.25pt'>xlDoesNotContain Does not contain the specified value.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:261.45pt;margin-bottom:
0in;margin-left:.25pt;line-height:143%'>xlEndsWith Endswith the
specified value <b>Formatting by time period</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
19.05pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=109
src="Excel%20VBA%20Notes%20for%20Professionals_files/image097.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:1.6pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'><b>Operators:</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:.15pt;
margin-left:17.45pt;text-indent:-.5pt;line-height:107%'><b>Name</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:432.5pt;margin-bottom:
17.45pt;margin-left:.25pt;line-height:137%'>xlYesterday xlTomorrow xlLast7Days
xlLastWeek xlThisWeek xlNextWeek xlLastMonth xlThisMonth xlNextMonth</p>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:0in;margin-left:
-.25pt'><a name="_Toc152140">Section 9.2: Remove conditional format</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
19.05pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=42
src="Excel%20VBA%20Notes%20for%20Professionals_files/image098.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:.15pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'><b>Remove all conditional
format in worksheet:</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:18.5pt;
margin-left:.5pt;text-indent:-.5pt'><span style='font-size:11.0pt;line-height:
110%'><img border=0 width=718 height=26 id="Group 127599"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image099.gif"></span><span
style='font-size:9.0pt;line-height:110%'>Cells.FormatConditions.Delete</span></p>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc152141">Section 9.3: FormatConditions.AddUniqueValues</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:.15pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'><b>Highlighting Duplicate
Values</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=718 height=76
src="Excel%20VBA%20Notes%20for%20Professionals_files/image100.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
4.0pt;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=718 height=54
src="Excel%20VBA%20Notes%20for%20Professionals_files/image101.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:.15pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'><b>Highlighting Unique
Values</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
10.35pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=109
src="Excel%20VBA%20Notes%20for%20Professionals_files/image102.gif"></span></p>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc152142">Section 9.4: FormatConditions.AddTop10</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:.15pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'><b>Highlighting Top 5
Values</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
10.35pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=158
src="Excel%20VBA%20Notes%20for%20Professionals_files/image103.gif"></span></p>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:0in;margin-left:
-.25pt'><a name="_Toc152143">Section 9.5: FormatConditions.AddAboveAverage</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
19.05pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=125
src="Excel%20VBA%20Notes%20for%20Professionals_files/image104.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:.15pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'><b>Operators:</b></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=298
 style='width:223.55pt;margin-left:1.0pt;border-collapse:collapse'>
 <tr style='height:12.3pt'>
  <td width=139 valign=top style='width:104.25pt;padding:0in 0in 0in 0in;
  height:12.3pt'>
  <p class=MsoNormal align=center style='margin-top:0in;margin-right:2.0pt;
  margin-bottom:0in;margin-left:0in;text-align:center;text-indent:0in;
  line-height:107%'><b>Name</b></p>
  </td>
  <td width=159 valign=top style='width:119.3pt;padding:0in 0in 0in 0in;
  height:12.3pt'>
  <p class=MsoNormal align=center style='margin-top:0in;margin-right:0in;
  margin-bottom:0in;margin-left:1.25pt;text-align:center;text-indent:0in;
  line-height:107%'><b>Description</b></p>
  </td>
 </tr>
 <tr style='height:15.4pt'>
  <td width=139 valign=top style='width:104.25pt;padding:0in 0in 0in 0in;
  height:15.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>XlAboveAverage</p>
  </td>
  <td width=159 valign=top style='width:119.3pt;padding:0in 0in 0in 0in;
  height:15.4pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Above
  average</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=139 valign=top style='width:104.25pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>XlAboveStdDev</p>
  </td>
  <td width=159 valign=top style='width:119.3pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>Above standard deviation</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=139 valign=top style='width:104.25pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>XlBelowAverage</p>
  </td>
  <td width=159 valign=top style='width:119.3pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Below
  average</p>
  </td>
 </tr>
 <tr style='height:13.65pt'>
  <td width=139 valign=top style='width:104.25pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>XlBelowStdDev</p>
  </td>
  <td width=159 valign=top style='width:119.3pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>Below standard deviation</p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:3.85pt;
margin-left:.25pt'>XlEqualAboveAverage Equal above average</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:20.8pt;
margin-left:.25pt'>XlEqualBelowAverage Equal below average</p>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc152144">Section 9.6: FormatConditions.AddIconSetCondition</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
19.05pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=591
src="Excel%20VBA%20Notes%20for%20Professionals_files/image105.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:1.6pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'><b>IconSet:</b></p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:459.2pt;
margin-bottom:.8pt;margin-left:0in;text-align:center;text-indent:0in;
line-height:107%'><b>Name</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:461.45pt;margin-bottom:
0in;margin-left:.25pt;line-height:137%'>xl3Arrows xl3ArrowsGray xl3Flags
xl3Signs xl3Stars xl3Symbols xl3Symbols2 xl3TrafficLights1 xl3TrafficLights2
xl3Triangles xl4Arrows xl4ArrowsGray xl4CRV xl4RedToBlack xl4TrafficLights
xl5Arrows xl5ArrowsGray xl5Boxes xl5CRV xl5Quarters</p>

<p class=MsoNormal style='margin-bottom:15.2pt;text-indent:0in;line-height:
107%'><img border=0 width=256 height=430 id="Picture 6319"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image106.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:1.6pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'><b>Type:</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:.15pt;
margin-left:49.85pt;text-indent:-.5pt;line-height:107%'><b>Name</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:305.1pt;margin-bottom:
1.5pt;margin-left:.25pt;line-height:137%'>xlConditionValuePercent
xlConditionValueNumber xlConditionValuePercentile xlConditionValueFormula</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:2.1pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'><b>Operator:</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:428.2pt;margin-bottom:
10.05pt;margin-left:.25pt;text-indent:21.4pt;line-height:134%'><b>Name Value
</b>xlGreater 5 xlGreaterEqual 7 <b>Value:</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>Returns or sets the threshold value for an icon in a
conditional format.</p>

<h1 style='margin-left:-.25pt'><a name="_Toc152145">Chapter 10: Workbooks</a></h1>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc152146">Section 10.1: When To Use ActiveWorkbook and
ThisWorkbook</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>It's a VBA Best Practice to always specify which workbook
your VBA code refers. If this specification is omitted, then VBA assumes the
code is directed at the currently active workbook (<span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>ActiveWorkbook</span>).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=60
src="Excel%20VBA%20Notes%20for%20Professionals_files/image107.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>However, when several workbooks are open at the same time --
particularly and especially when VBA code is running from an Excel Add-In --
references to the <span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>ActiveWorkbook</span> may be confused or misdirected. For example, an
add-in with a UDF that checks the time of day and compares it to a value stored
on one of the add-in's worksheets (that are typically not readily visible to
the user) will have to explicitly identify which workbook is being referenced.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=79 style='width:59.4pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=79 valign=top style='width:59.4pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>EarlyOrLate</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>In our example, our open (and active) workbook has a formula
in cell A1 <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>=()</span>
and does NOT have any VBA written for that active workbook. In our add-in, we
have the following User Defined Function (UDF):</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=125
src="Excel%20VBA%20Notes%20for%20Professionals_files/image108.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:18.2pt;
margin-left:.25pt'>The code for the UDF is written and stored in the installed
Excel add-in. It uses data stored on a worksheet in the add-in called
&quot;WatchTime&quot;. If the UDF had used <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>ActiveWorkbook</span> instead of <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>ThisWorkbook</span>,
then it would never be able to guarantee which workbook was intended.</p>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc152147">Section 10.2: Changing The Default Number of
Worksheets In A New Workbook</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>The &quot;factory default&quot; number of worksheets created
in a new Excel workbook is generally set to three. Your VBA code can explicitly
set the number of worksheets in a new workbook.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
10.35pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=174
src="Excel%20VBA%20Notes%20for%20Professionals_files/image109.gif"></span></p>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc152148">Section 10.3: Application Workbooks</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>In many Excel applications, the VBA code takes actions
directed at the workbook in which it's contained. You save that workbook with a
&quot;.xlsm&quot; extension and the VBA macros only focus on the worksheets and
data within. However, there are often times when you need to combine or merge
data from other workbooks, or write some of your data to a separate workbook.
Opening, closing, saving, creating, and deleting other workbooks is a common
need for many VBA applications.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:18.2pt;
margin-left:.25pt'>At any time in the VBA Editor, you can view and access any
and all workbooks currently open by that instance of Excel by using the <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Workbooks</span>
property of the <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Application</span>
object. The <a
href="https://msdn.microsoft.com/en-us/library/office/ff820765.aspx"><span
style='color:#02723B'>MSDN Documentation</span></a> explains it with
references.</p>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc152149">Section 10.4: Opening A (New) Workbook, Even If
It's Already Open</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>If you want to access a workbook that's already open, then
getting the assignment from the <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>Workbooks</span> collection is straightforward:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
15.1pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=43
src="Excel%20VBA%20Notes%20for%20Professionals_files/image110.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>If you want to create a new workbook, then use the <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Workbooks</span>
collection object to <span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>Add</span> a new entry.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=43
src="Excel%20VBA%20Notes%20for%20Professionals_files/image111.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:14.1pt;
margin-left:.25pt'>There are times when you may not or (or care) if the
workbook you need is open already or not, or possible does not exist. The
example function shows how to always return a valid workbook object.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Option</span></b><span style='font-size:9.0pt;
line-height:110%'> Explicit</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Function</span></b><span style='font-size:9.0pt;
line-height:110%'> GetWorkbook(</span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;
line-height:110%'> wbFilename </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>As</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:slateblue'>String</span><span style='font-size:9.0pt;line-height:110%'>) </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> Workbook</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.3pt;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><i><span style='font-size:9.0pt;line-height:110%;color:green'>'---
returns a workbook object for the given filename, including checks</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.3pt;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><i><span style='font-size:9.0pt;line-height:110%;color:green'>'
for when the workbook is already open, exists but not open, or</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.3pt;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><i><span style='font-size:9.0pt;line-height:110%;color:green'>'
does not yet exist (and must be created)</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.3pt;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><i><span style='font-size:9.0pt;line-height:110%;color:green'>'
*** wbFilename must be a fully specified pathname</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Dim</span></b><span
style='font-size:9.0pt;line-height:110%'> folderFile </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>String</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Dim</span></b><span
style='font-size:9.0pt;line-height:110%'> returnedWB </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> Workbook</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
margin-left:3.75pt;text-indent:0in;line-height:107%'><span style='font-size:
9.0pt;line-height:107%'> </span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:168.6pt;margin-bottom:
.15pt;margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;
line-height:110%'> </span><i><span style='font-size:9.0pt;line-height:110%;
color:green'>'--- check if the file exists in the directory location </span></i><span
style='font-size:9.0pt;line-height:110%'>folderFile = File(wbFilename)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>If</span></b><span
style='font-size:9.0pt;line-height:110%'> folderFile = </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>&quot;&quot;</span><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Then</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.3pt;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><i><span style='font-size:9.0pt;line-height:110%;
color:green'>'--- the workbook doesn't exist, so create it</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
margin-left:3.75pt;text-indent:0in;line-height:107%'><span style='font-size:
9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
line-height:107%;color:blue'>Dim</span></b><span style='font-size:9.0pt;
line-height:107%'> pos1 </span><b><span style='font-size:9.0pt;line-height:
107%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:107%'> </span><span
style='font-size:9.0pt;line-height:107%;color:slateblue'>Integer</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>Dim</span></b><span style='font-size:9.0pt;line-height:110%'>
fileExt </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>String</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>Dim</span></b><span style='font-size:9.0pt;line-height:110%'>
fileFormatNum </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>As</span></b><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:slateblue'>Long</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.3pt;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><i><span style='font-size:9.0pt;line-height:110%;
color:green'>'--- in order to save the workbook correctly, we need to infer
which workbook</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:222.15pt;margin-bottom:
.2pt;margin-left:3.5pt;text-indent:-.5pt'><span style='position:relative;
z-index:-1895814144'><span style='left:0px;position:absolute;left:0px;
top:-5625px;width:718px;height:1px'><img width=718 height=1
src="Excel%20VBA%20Notes%20for%20Professionals_files/image112.gif"></span></span><span
style='font-size:9.0pt;line-height:110%'> </span><i><span
style='font-size:9.0pt;line-height:110%;color:green'>' type the user
intended from the file extension </span></i><span style='font-size:9.0pt;
line-height:110%'>pos1 = </span><span style='font-size:9.0pt;
line-height:110%;color:#000066'>InStrRev</span><span style='font-size:9.0pt;
line-height:110%'>(sFullName, </span><span style='font-size:9.0pt;line-height:
110%;color:brown'>&quot;.&quot;</span><span style='font-size:9.0pt;line-height:
110%'>, , vbTextCompare) fileExt = </span><span style='font-size:9.0pt;
line-height:110%;color:#000066'>Right</span><span style='font-size:9.0pt;
line-height:110%'>(sFullName, Len(sFullName) - pos1) </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Select</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Case</span></b><span style='font-size:9.0pt;
line-height:110%'> fileExt </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Case</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:brown'>&quot;xlsx&quot;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:329.6pt;margin-bottom:
.2pt;margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;
line-height:110%'> fileFormatNum = </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>51 </span><span
style='font-size:9.0pt;line-height:110%'></span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Case</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:brown'>&quot;xlsm&quot;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:329.6pt;margin-bottom:
.2pt;margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;
line-height:110%'> fileFormatNum = </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>52 </span><span
style='font-size:9.0pt;line-height:110%'></span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Case</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:brown'>&quot;xls&quot;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:329.6pt;margin-bottom:
.2pt;margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;
line-height:110%'> fileFormatNum = </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>56 </span><span
style='font-size:9.0pt;line-height:110%'></span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Case</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:brown'>&quot;xlsb&quot;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> fileFormatNum = </span><span style='font-size:9.0pt;
line-height:110%;color:brown'>50</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>Case</span></b><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Else</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> Err.Raise vbObjectError + </span><span style='font-size:
9.0pt;line-height:110%;color:brown'>1000</span><span style='font-size:9.0pt;
line-height:110%'>, </span><span style='font-size:9.0pt;line-height:110%;
color:brown'>&quot;GetWorkbook function&quot;</span><span style='font-size:
9.0pt;line-height:110%'>, _</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.25pt;
margin-left:3.5pt;text-indent:-.5pt;line-height:110%'><span style='font-size:
9.0pt;line-height:110%'> </span><span style='font-size:
9.0pt;line-height:110%;color:brown'>&quot;The file type you've requested (file
extension) is not recognized. &quot;</span><span style='font-size:9.0pt;
line-height:110%'> &amp; _</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.25pt;
margin-left:3.5pt;text-indent:-.5pt;line-height:110%'><span style='font-size:
9.0pt;line-height:110%'> </span><span style='font-size:
9.0pt;line-height:110%;color:brown'>&quot;Please use a known extension: xlsx,
xlsm, xls, or xlsb.&quot;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>End</span></b><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Select</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:140.55pt;margin-bottom:
.2pt;margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;
line-height:110%'> </span><b><span style='font-size:9.0pt;line-height:
110%;color:blue'>Set</span></b><span style='font-size:9.0pt;line-height:110%'>
returnedWB = Workbooks.Add Application.DisplayAlerts = </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>False </span></b><span
style='font-size:9.0pt;line-height:110%'>returnedWB.SaveAs
filename:=wbFilename, FileFormat:=fileFormatNum</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
10.35pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=202
src="Excel%20VBA%20Notes%20for%20Professionals_files/image113.gif"></span></p>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc152150">Section 10.5: Saving A Workbook Without Asking The
User</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.45pt;
margin-left:.25pt'>Often saving new data in an existing workbook using VBA will
cause a pop-up question noting that the file already exists.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:14.45pt;
margin-left:.25pt'>To prevent this pop-up question, you have to suppress these
types of alerts.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:53.25pt;margin-bottom:
.2pt;margin-left:3.5pt;text-indent:-.5pt'><span style='position:relative;
z-index:-1895813120'><span style='left:0px;position:absolute;left:0px;
top:-6198px;width:718px;height:1px'><img width=718 height=1
src="Excel%20VBA%20Notes%20for%20Professionals_files/image114.gif"></span></span><span
style='font-size:9.0pt;line-height:110%'>Application.DisplayAlerts = </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>False</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><i><span
style='font-size:9.0pt;line-height:110%;color:green'>'disable user prompt to
overwrite file </span></i><span style='font-size:9.0pt;line-height:110%'>myWB.SaveAs
FileName:=</span><span style='font-size:9.0pt;line-height:110%;color:brown'>&quot;NewOrExistingFilename.xlsx&quot;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.3pt;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'>Application.DisplayAlerts = </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>True</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><i><span style='font-size:9.0pt;line-height:
110%;color:green'>'re-enable user prompt to overwrite file</span></i><br
clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc152151">Chapter 11: Working with
Excel Tables in VBA</a></h1>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:18.2pt;
margin-left:.25pt'>This topic is about working with tables in VBA, and assumes
knowledge of Excel Tables. In VBA, or rather the Excel Object Model, tables are
known as ListObjects. The most frequently used properties of a ListObject are
ListRow(s), ListColumn(s), DataBodyRange, Range and HeaderRowRange.</p>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:0in;margin-left:
-.25pt'><a name="_Toc152152">Section 11.1: Instantiating a ListObject</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
10.35pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=207
src="Excel%20VBA%20Notes%20for%20Professionals_files/image115.gif"></span></p>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:0in;margin-left:
-.25pt'><a name="_Toc152153">Section 11.2: Working with ListRows / ListColumns</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
10.35pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=339
src="Excel%20VBA%20Notes%20for%20Professionals_files/image116.gif"></span></p>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:0in;margin-left:
-.25pt'><a name="_Toc152154">Section 11.3: Converting an Excel Table to a
normal range</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=718 height=76
src="Excel%20VBA%20Notes%20for%20Professionals_files/image117.gif"></span></p>

<h1 style='margin-left:-.25pt'><a name="_Toc152155">Chapter 12: Loop through
all Sheets in Active Workbook</a></h1>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:0in;margin-left:
-.25pt'><a name="_Toc152156">Section 12.1: Retrieve all Worksheets Names in
Active Workbook</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
10.35pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=720 height=371
src="Excel%20VBA%20Notes%20for%20Professionals_files/image118.gif"></span></p>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:0in;margin-left:
-.25pt'><a name="_Toc152157">Section 12.2: Loop Through all Sheets in all Files
in a Folder</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=720 height=453
src="Excel%20VBA%20Notes%20for%20Professionals_files/image119.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=718 height=120
src="Excel%20VBA%20Notes%20for%20Professionals_files/image120.gif"></span><br
clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc152158">Chapter 13: Use Worksheet
object and not Sheet object</a></h1>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.8pt;
margin-left:.25pt'>Plenty of VBA users consider Worksheets and Sheets objects
synonyms. They are not.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.55pt;margin-bottom:.25pt;
margin-left:.75pt;text-align:justify;text-justify:inter-ideograph;text-indent:
-.5pt;line-height:133%'>Sheets object consists of both Worksheets and Charts.
Thus, if we have charts in our Excel Workbook, we should be careful, not to use
<span style='font-size:9.0pt;line-height:133%;background:#FAFAFA'>Sheets</span>
and <span style='font-size:9.0pt;line-height:133%;background:#FAFAFA'>Worksheets</span>
as synonyms.</p>

<h2 style='margin-top:0in;margin-right:.55pt;margin-bottom:.25pt;margin-left:
.75pt;text-align:justify;text-justify:inter-ideograph;line-height:133%'><a
name="_Toc152159">Section 13.1: Print the name of the first object</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=237
src="Excel%20VBA%20Notes%20for%20Professionals_files/image121.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>The result:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=718 height=60
src="Excel%20VBA%20Notes%20for%20Professionals_files/image122.gif"></span></p>

<h1 style='margin-left:-.25pt'><a name="_Toc152160">Chapter 14: Methods for
Finding the Last Used Row or Column in a Worksheet</a></h1>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc152161">Section 14.1: Find the Last Non-Empty Cell in a
Column</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.8pt;
margin-left:.25pt'>In this example, we will look at a method for returning the
last non-empty row in a column for a data set.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:13.05pt;
margin-left:.25pt'>This method will work regardless of empty regions within the
data set.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.65pt;
margin-left:.25pt'>However <b><i>caution</i></b><i> should be used if <b>merged
cells</b> are involved</i>, as the <b><span style='font-size:9.0pt;line-height:
110%;color:blue;background:#FAFAFA'>End</span></b> method will be
&quot;stopped&quot; against a merged region, returning the first cell of the
merged region.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>In addition non-empty cells in <b><i>hidden rows</i></b>
will not be taken into account.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=142
src="Excel%20VBA%20Notes%20for%20Professionals_files/image123.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>To address the limitations indicated above, the line:</p>

<p class=MsoNormal style='margin-bottom:13.75pt;text-indent:0in;line-height:
107%;background:#FAFAFA'><span style='font-size:9.0pt;line-height:107%'>LastRow
= wS.Cells(wS.Rows.Count, </span><span style='font-size:9.0pt;line-height:107%;
color:brown'>&quot;A&quot;</span><span style='font-size:9.0pt;line-height:107%'>).</span><b><span
style='font-size:9.0pt;line-height:107%;color:blue'>End</span></b><span
style='font-size:9.0pt;line-height:107%'>(xlUp).Row</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:13.6pt;
margin-left:.25pt'>may be replaced with:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:110%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>for
last used row of <span style='font-size:9.0pt;line-height:110%;color:brown;
background:#FAFAFA'>&quot;Sheet1&quot;</span>:</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=403 style='width:4.2in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=403 valign=top style='width:4.2in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>LastRow = wS.UsedRange.Row - </span><span
  style='font-size:9.0pt;line-height:107%;color:brown'>1</span><span
  style='font-size:9.0pt;line-height:107%'> + wS.UsedRange.Rows.Count</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:0in;
margin-bottom:9.85pt;margin-left:129.45pt;text-align:center;text-indent:-.5pt'>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:3.25pt;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:110%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>for
last non-empty cell of Column <span style='font-size:9.0pt;line-height:110%;
color:brown;background:#FAFAFA'>&quot;A&quot;</span> in <span style='font-size:
9.0pt;line-height:110%;color:brown;background:#FAFAFA'>&quot;Sheet1&quot;</span>:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
18.65pt;margin-left:30.0pt;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=678 height=92
src="Excel%20VBA%20Notes%20for%20Professionals_files/image124.gif"></span></p>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:0in;margin-left:
-.25pt'><a name="_Toc152162">Section 14.2: Find the Last Non-Empty Row in
Worksheet</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=125
src="Excel%20VBA%20Notes%20for%20Professionals_files/image125.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.8pt;
margin-left:.25pt'>You can choose between 2 options, regarding if you want to
know if there is no data in the worksheet :</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=194 style='width:145.8pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=194 valign=top style='width:145.8pt;background:#FAFAFA;padding:
  1.8pt 0in 0in 0in;height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>wS.Cells(LastRow_1(wS),...)</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:126.9pt;margin-bottom:
1.5pt;margin-left:20.9pt'><img width=5 height=1
src="Excel%20VBA%20Notes%20for%20Professionals_files/image126.gif" align=left
hspace=12>NO : Use LastRow_1 : You can use it directly within </p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:4.3pt;
margin-bottom:12.45pt;margin-left:21.4pt;text-align:center;text-indent:-.5pt'>YES
: Use LastRow_0 : You need to test if the result you get from the function is 0
or not before using it</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
10.35pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=437
src="Excel%20VBA%20Notes%20for%20Professionals_files/image127.gif"></span></p>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:0in;margin-left:
-.25pt'><a name="_Toc152163">Section 14.3: Find the Last Non-Empty Column in
Worksheet</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=125
src="Excel%20VBA%20Notes%20for%20Professionals_files/image128.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.85pt;
margin-left:.25pt'>You can choose between 2 options, regarding if you want to
know if there is no data in the worksheet :</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=180 style='width:135.0pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=14 valign=top style='width:.15in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>wS</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;background:#FAFAFA'>.</span></p>
  </td>
  <td width=36 valign=top style='width:27.0pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>Cells</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;background:#FAFAFA'>(</span></p>
  </td>
  <td width=94 valign=top style='width:70.2pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>...,LastCol_1</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;background:#FAFAFA'>(</span></p>
  </td>
  <td width=14 valign=top style='width:.15in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>wS</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:30.0pt'>NO : Use LastCol_1 : You can use it directly within <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>))</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:11.55pt;
margin-left:30.0pt'><span style='position:relative;z-index:-1895811072'><span
style='left:0px;position:absolute;left:0px;top:-10561px;width:718px;height:
1px'><img width=718 height=1
src="Excel%20VBA%20Notes%20for%20Professionals_files/image129.gif"></span></span>YES
: Use LastCol_0 : You need to test if the result you get from the function is 0
or not before using it</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Public</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>Function</span></b><span style='font-size:9.0pt;line-height:110%'>
LastCol_1(wS </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>As</span></b><span style='font-size:9.0pt;line-height:110%'>
Worksheet) </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>Double</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>With</span></b><span
style='font-size:9.0pt;line-height:110%'> wS</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>If</span></b><span style='font-size:9.0pt;line-height:110%'>
Application.WorksheetFunction.CountA(.Cells) &lt;&gt; </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>0</span><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Then</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> LastCol_1 = .Cells.Find(What:=</span><span style='font-size:
9.0pt;line-height:110%;color:brown'>&quot;*&quot;</span><span style='font-size:
9.0pt;line-height:110%'>, _</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> After:=.Range(</span><span
style='font-size:9.0pt;line-height:110%;color:brown'>&quot;A1&quot;</span><span
style='font-size:9.0pt;line-height:110%'>), _</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> Lookat:=xlPart, _</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> LookIn:=xlFormulas, _</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> SearchOrder:=xlByColumns, _</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> SearchDirection:=xlPrevious, _</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> MatchCase:=</span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>False</span></b><span
style='font-size:9.0pt;line-height:110%'>).Column</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>Else</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> LastCol_1 = </span><span style='font-size:9.0pt;line-height:
110%;color:brown'>1</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>End</span></b><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>If</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>End</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>With</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:17.25pt;
margin-left:3.5pt;text-indent:-.5pt'><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>End</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>Function</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>The Err object's properties are automatically reset to zero
upon function exit.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Public</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>Function</span></b><span style='font-size:9.0pt;line-height:110%'>
LastCol_0(wS </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>As</span></b><span style='font-size:9.0pt;line-height:110%'>
Worksheet) </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>Double</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>On</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Error</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>Resume</span></b><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Next</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> LastCol_0 = wS.Cells.Find(What:=</span><span style='font-size:9.0pt;
line-height:110%;color:brown'>&quot;*&quot;</span><span style='font-size:9.0pt;
line-height:110%'>, _</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> After:=ws.Range(</span><span
style='font-size:9.0pt;line-height:110%;color:brown'>&quot;A1&quot;</span><span
style='font-size:9.0pt;line-height:110%'>), _</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> Lookat:=xlPart, _</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> LookIn:=xlFormulas, _</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> SearchOrder:=xlByColumns, _</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='position:relative;z-index:
-1895810048'><span style='left:0px;position:absolute;left:0px;top:-11025px;
width:718px;height:1px'><img width=718 height=1
src="Excel%20VBA%20Notes%20for%20Professionals_files/image130.gif"></span></span><span
style='font-size:9.0pt;line-height:110%'>
SearchDirection:=xlPrevious, _</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> MatchCase:=</span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>False</span></b><span style='font-size:9.0pt;
line-height:110%'>).Column</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:23.0pt;
margin-left:3.5pt;text-indent:-.5pt'><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>End</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>Function</span></b></p>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc152164">Section 14.4: Find the Last Non-Empty Cell in a
Row</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.8pt;
margin-left:.25pt'>In this example, we will look at a method for returning the
last non-empty column in a row.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:13.05pt;
margin-left:.25pt'>This method will work regardless of empty regions within the
data set.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.65pt;
margin-left:.25pt'>However <b><i>caution</i></b><i> should be used if <b>merged
cells</b> are involved</i>, as the <b><span style='font-size:9.0pt;line-height:
110%;color:blue;background:#FAFAFA'>End</span></b> method will be
&quot;stopped&quot; against a merged region, returning the first cell of the
merged region.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>In addition non-empty cells in <b><i>hidden columns</i></b>
will not be taken into account.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
10.35pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=142
src="Excel%20VBA%20Notes%20for%20Professionals_files/image131.gif"></span></p>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:0in;margin-left:
-.25pt'><a name="_Toc152165">Section 14.5: Get the row of the last cell in a
range</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
10.35pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=273
src="Excel%20VBA%20Notes%20for%20Professionals_files/image132.gif"></span></p>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc152166">Section 14.6: Find Last Row Using Named Range</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>In case you have a Named Range in your Sheet, and you want
to dynamically get the last row of that Dynamic Named Range. Also covers cases
where the Named Range doesn't start from the first Row.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=718 height=51
src="Excel%20VBA%20Notes%20for%20Professionals_files/image133.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=218
src="Excel%20VBA%20Notes%20for%20Professionals_files/image134.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>Update:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>A potential loophole was pointed out by @Jeeped for a a
named range with non-contiguous rows as it generates unexpected result. To
addresses that issue, the code is revised as below.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>Asumptions: targes sheet = <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>form</span>, named range = <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>MyNameRange</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
10.35pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=125
src="Excel%20VBA%20Notes%20for%20Professionals_files/image135.gif"></span></p>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:0in;margin-left:
-.25pt'><a name="_Toc152167">Section 14.7: Last cell in Range.CurrentRegion</a></h2>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=711
 style='width:533.4pt;border-collapse:collapse'>
 <tr style='height:.15in'>
  <td width=36 valign=top style='width:27.0pt;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><a
  href="https://msdn.microsoft.com/en-us/library/office/ff196678.aspx"><span
  style='font-size:9.0pt;line-height:107%;color:#02723B'>Range</span></a></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><a
  href="https://msdn.microsoft.com/en-us/library/office/ff196678.aspx"><span
  style='font-size:9.0pt;line-height:107%;color:black;background:#FAFAFA'>.</span></a></p>
  </td>
  <td width=94 valign=top style='width:70.2pt;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><a
  href="https://msdn.microsoft.com/en-us/library/office/ff196678.aspx"><span
  style='font-size:9.0pt;line-height:107%;color:black'>CurrentRegion</span></a></p>
  </td>
  <td width=560 valign=top style='width:420.0pt;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>is a rectangular range
  area surrounded by empty cells. Blank cells with formulas such as <span
  style='font-size:9.0pt;line-height:107%;background:#FAFAFA'>=</span></p>
  </td>
  <td width=14 valign=top style='width:.15in;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:brown'>&quot;&quot;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:14.55pt;
margin-left:.25pt'>or <span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>'</span> are not considered blank (even by the <a
href="https://support.microsoft.com/en-us/kb/823838"><span style='font-size:
9.0pt;line-height:110%;color:#02723B;background:#FAFAFA'>ISBLANK</span></a>
Excel function).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Dim</span></b><span style='font-size:9.0pt;
line-height:110%'> rng </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>As</span></b><span style='font-size:9.0pt;line-height:110%'> Range,
lastCell </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> Range</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:54.05pt;margin-bottom:
22.95pt;margin-left:3.5pt;text-indent:-.5pt'><span style='position:relative;
z-index:-1895809024'><span style='left:0px;position:absolute;left:0px;
top:-12468px;width:718px;height:1px'><img width=718 height=1
src="Excel%20VBA%20Notes%20for%20Professionals_files/image114.gif"></span></span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Set</span></b><span
style='font-size:9.0pt;line-height:110%'> rng = Range(</span><span
style='font-size:9.0pt;line-height:110%;color:brown'>&quot;C3&quot;</span><span
style='font-size:9.0pt;line-height:110%'>).CurrentRegion </span><i><span
style='font-size:9.0pt;line-height:110%;color:green'>' or Set rng =
Sheet1.UsedRange.CurrentRegion </span></i><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Set</span></b><span style='font-size:9.0pt;
line-height:110%'> lastCell = rng(rng.Rows.Count, rng.Columns.Count)</span></p>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc152168">Section 14.8: Find the Last Non-Empty Cell in
Worksheet Performance (Array)</a></h2>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=173 style='width:1.8in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=86 valign=top style='width:.9in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>ThisWorkbook</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;background:#FAFAFA'>.</span></p>
  </td>
  <td width=79 valign=top style='width:59.4pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>ActiveSheet</span></p>
  </td>
 </tr>
</table>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=29 style='width:.3in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>Cell</span></p>
  </td>
 </tr>
</table>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=14 style='width:.15in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=14 valign=top style='width:.15in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>, </span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:20.9pt'><img width=5 height=1
src="Excel%20VBA%20Notes%20for%20Professionals_files/image136.gif" align=left
hspace=12>The first function, using an array, is <b>much faster</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:20.9pt'>If called without the optional parameter, will default to <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.95pt;
margin-left:20.9pt'><span style='position:relative;z-index:-1895806976'><span
style='left:0px;position:absolute;left:280px;top:-12644px;width:43px;
height:1px'><img width=43 height=1
src="Excel%20VBA%20Notes%20for%20Professionals_files/image137.gif"></span></span>If
the range is empty will returns <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>(</span><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:brown;background:#FAFAFA'>11</span><span
style='font-size:9.0pt;line-height:110%'> <span style='background:#FAFAFA'>)</span></span>
as default, instead of <b><span style='font-size:9.0pt;line-height:110%;
color:blue;background:#FAFAFA'>Nothing</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>Speed:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=718 height=213
src="Excel%20VBA%20Notes%20for%20Professionals_files/image138.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
15.05pt;margin-left:-.45pt;text-indent:0in;line-height:107%'><img border=0
width=719 height=531 id="Picture 148667"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image139.gif"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=718 height=478
src="Excel%20VBA%20Notes%20for%20Professionals_files/image140.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=21
src="Excel%20VBA%20Notes%20for%20Professionals_files/image141.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.8pt;
margin-left:.25pt'>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:10.25pt;margin-bottom:
0in;margin-left:.75pt;text-align:justify;text-justify:inter-ideograph;
text-indent:-.5pt;line-height:110%'><a
href="https://msdn.microsoft.com/en-us/library/office/ff700515(v=office.14).aspx#Anchor_5"><span
style='color:#02723B'>MicroTimer</span></a>:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=720 height=240
src="Excel%20VBA%20Notes%20for%20Professionals_files/image142.gif"></span><br
clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc152169">Chapter 15: Creating a
drop-down menu in the Active Worksheet with a Combo Box</a></h1>

<p class=MsoNormal style='margin-top:0in;margin-right:8.5pt;margin-bottom:.25pt;
margin-left:.75pt;text-align:justify;text-justify:inter-ideograph;text-indent:
-.5pt;line-height:133%'>This is a simple example demonstrating how to create a
drop down menu in the Active Sheet of your workbook by inserting a Combo Box
Activex object in the sheet. You'll be able to insert one of five Jimi Hendrix
songs in any activated cell of the sheet and be able to clear it, accordingly.</p>

<h2 style='margin-top:0in;margin-right:8.5pt;margin-bottom:.25pt;margin-left:
.75pt;text-align:justify;text-justify:inter-ideograph;line-height:133%'><a
name="_Toc152170">Section 15.1: Example 2: Options Not Included</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.45pt;
margin-left:.25pt'>This example is used in specifying options that might not be
included in a database of available housing and its attendant amenities.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:13.3pt;
margin-left:.25pt'>It builds on the previous example, with some differences:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:110%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Two
procedures are no longer necessary for a single combo box, done by combining
the code into a single procedure.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:110%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>The
use of the LinkedCell property to allow for the correct input of the user
selection every time</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:110%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>The
inclusion of a backup feature for ensuring the active cell is in the correct
column and an error prevention code, based on previous experience, where
numeric values would formatted as strings when populated to the active cell.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=718 height=604
src="Excel%20VBA%20Notes%20for%20Professionals_files/image143.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=719 height=383
src="Excel%20VBA%20Notes%20for%20Professionals_files/image144.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>The above macro is initiated every time a cell is activated
with the SelectionChange event in the worksheet module:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
10.35pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=240
src="Excel%20VBA%20Notes%20for%20Professionals_files/image145.gif"></span></p>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc152171">Section 15.2: Jimi Hendrix Menu</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.8pt;
margin-left:.25pt'>In general, the code is placed in the module of a sheet.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>This is the Worksheet_SelectionChange event, which fires
each time a different cell is selected in the active sheet. You can select
&quot;Worksheet&quot; from the first drop-down menu above the code window, and
&quot;Selection_Change&quot; from the drop down menu next to it. In this case,
every time you activate a cell, the code is redirected to the Combo Box's code.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=92
src="Excel%20VBA%20Notes%20for%20Professionals_files/image146.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>Here, the routine dedicated to the ComboBox is coded to the
Change event by default. In it, there is a fixed array, populated with all the
options. Not the CLEAR option in the last position, which will be used to clear
the contents of a cell. The array then is handed to to the Combo Box and passed
to the routine that does the work.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=289
src="Excel%20VBA%20Notes%20for%20Professionals_files/image147.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.45pt;
margin-left:.25pt'>The array is passed to the routine that fills the cells with
the song name or null value to empty them. First, an integer variable is given
the value of the position of the choice that the user makes. Then, the Combo
Box is moved to the TOP LEFT corner of the cell the user activates and its
dimensions adjusted to make the experience more fluid. The active cell is then
assigned the value in the position in the integer variable, which tracks the
user choice. In case the user selects CLEAR from the options, the cell is
emptied.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>The entire routine repeats for each selected cell.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=718 height=289
src="Excel%20VBA%20Notes%20for%20Professionals_files/image148.gif"></span></p>

<h1 style='margin-left:-.25pt'><a name="_Toc152172">Chapter 16: File System
Object</a></h1>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:0in;margin-left:
-.25pt'><a name="_Toc152173">Section 16.1: File, folder, drive exists</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=718 height=193
src="Excel%20VBA%20Notes%20for%20Professionals_files/image149.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
4.0pt;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=718 height=158
src="Excel%20VBA%20Notes%20for%20Professionals_files/image150.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:.15pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'><b>Drive exists:</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
10.35pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=158
src="Excel%20VBA%20Notes%20for%20Professionals_files/image151.gif"></span></p>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc152174">Section 16.2: Basic file operations</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:.15pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'><b>Copy:</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
4.0pt;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=720 height=92
src="Excel%20VBA%20Notes%20for%20Professionals_files/image152.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:.15pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'><b>Move:</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
4.0pt;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=718 height=92
src="Excel%20VBA%20Notes%20for%20Professionals_files/image153.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:.15pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'><b>Delete:</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=718 height=95
src="Excel%20VBA%20Notes%20for%20Professionals_files/image154.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
10.35pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=21
src="Excel%20VBA%20Notes%20for%20Professionals_files/image155.gif"></span></p>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc152175">Section 16.3: Basic folder operations</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:.15pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'><b>Create:</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
4.0pt;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=718 height=92
src="Excel%20VBA%20Notes%20for%20Professionals_files/image156.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:.15pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'><b>Copy:</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
4.0pt;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=718 height=92
src="Excel%20VBA%20Notes%20for%20Professionals_files/image157.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:.15pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'><b>Move:</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
4.0pt;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=718 height=92
src="Excel%20VBA%20Notes%20for%20Professionals_files/image158.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:.15pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'><b>Delete:</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
10.35pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=92
src="Excel%20VBA%20Notes%20for%20Professionals_files/image159.gif"></span></p>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:0in;margin-left:
-.25pt'><a name="_Toc152176">Section 16.4: Other operations</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
16.15pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=142
src="Excel%20VBA%20Notes%20for%20Professionals_files/image160.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
16.15pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=142
src="Excel%20VBA%20Notes%20for%20Professionals_files/image161.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=718 height=108
src="Excel%20VBA%20Notes%20for%20Professionals_files/image162.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
15.2pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=21
src="Excel%20VBA%20Notes%20for%20Professionals_files/image163.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=718 height=177
src="Excel%20VBA%20Notes%20for%20Professionals_files/image164.gif"></span><br
clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc152177">Chapter 17: Pivot Tables</a></h1>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc152178">Section 17.1: Adding Fields to a Pivot Table</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>Two important things to note when adding fields to a Pivot
Table are Orientation and Position. Sometimes a developer may assume where a
field is placed, so it's always clearer to explicitly define these parameters.
These actions only affect the given Pivot Table, not the Pivot Cache.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
10.35pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=355
src="Excel%20VBA%20Notes%20for%20Professionals_files/image165.gif"></span></p>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc152179">Section 17.2: Creating a Pivot Table</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.85pt;
margin-left:.25pt'>One of the most powerful capabilities in Excel is the use of
Pivot Tables to sort and analyze data. Using VBA to create and manipulate the
Pivots is easier if you understand the relationship of Pivot Tables to Pivot
Caches and how to reference and use the different parts of the Tables.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>At its most basic, your source data is a <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Range</span> area
of data on a <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Worksheet</span>.
This data area <b>MUST</b> identify the data columns with a header row as the
first row in the range. Once the Pivot Table is created, the user may view and
change the source data at any time. However, changes may not be automatically
or immediately reflected in the Pivot Table itself because there is an
intermediate data storage structure called the Pivot Cache that is directly
connected to the Pivot Table itself.</p>

<p class=MsoNormal style='margin-bottom:14.95pt;text-indent:0in;line-height:
107%'><img border=0 width=706 height=377 id="Picture 10675"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image166.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>If multiple Pivot Tables are needed, based on the same
source data, the Pivot Cache may be re-used as the internal data store for each
of the Pivot Tables. This is a good practice because it saves memory and
reduces the size of the Excel file for storage.<br clear=all style='page-break-before:
always'>
</p>

<p class=MsoNormal style='margin-bottom:14.95pt;text-indent:0in;line-height:
107%'><img border=0 width=706 height=569 id="Picture 10698"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image167.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>As an example, to create a Pivot Table based on the source
data shown in the Figures above:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=718 height=410
src="Excel%20VBA%20Notes%20for%20Professionals_files/image168.gif"></span></p>

<p class=MsoNormal style='margin-bottom:17.9pt;text-indent:0in;line-height:
110%'><span style='font-size:11.0pt;line-height:110%'> <img border=0
width=3 height=37 id="Group 134156"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image169.gif"></span><b> References</b>
<a href="https://msdn.microsoft.com/en-us/library/office/ff837611.aspx"><span
style='color:#02723B'>MSDN Pivot Table Object</span></a></p>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc152180">Section 17.3: Pivot Table Ranges</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:24.25pt;
margin-left:.25pt'>These excellent reference sources provide descriptions and
illustrations of the various ranges in Pivot Tables.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:13.3pt;
margin-left:24.5pt;text-indent:-.5pt;line-height:107%'><img width=45 height=1
src="Excel%20VBA%20Notes%20for%20Professionals_files/image170.gif" align=left
hspace=12><b>References</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:10.25pt;margin-bottom:
1.65pt;margin-left:16.25pt;text-align:justify;text-justify:inter-ideograph;
text-indent:-.5pt;line-height:110%'><a
href="http://peltiertech.com/referencing-pivot-table-ranges-in-vba/"><span
style='color:#02723B'>Referencing Pivot Table Ranges in VBA</span></a> - from
Jon Peltier's Tech Blog</p>

<p class=MsoNormal style='margin-top:0in;margin-right:10.25pt;margin-bottom:
26.9pt;margin-left:16.25pt;text-align:justify;text-justify:inter-ideograph;
text-indent:-.5pt;line-height:110%'><a
href="http://www.globaliconnect.com/excel/index.php?option=com_content&amp;view=article&amp;id=154:referencing-an-excel-pivot-table-range-using-vba&amp;catid=79&amp;Itemid=475"><span
style='color:#02723B'>Referencing an Excel Pivot Table Range using VBA</span></a>
- from globaliconnect Excel VBA</p>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc152181">Section 17.4: Formatting the Pivot Table Data</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.75pt;
margin-left:.25pt'>This example changes/sets several formats in the data range
area (<span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>DataBodyRange</span>)
of the given Pivot Table. All formattable parameters in a standard <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Range</span> are
available. Formatting the data only affects the Pivot Table itself, not the
Pivot Cache.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>NOTE: the property is named <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>TableStyle2</span> because the <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>TableStyle</span>
property is not a member of the <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>PivotTable</span>'s object properties.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=718 height=223
src="Excel%20VBA%20Notes%20for%20Professionals_files/image171.gif"></span></p>

<h1 style='margin-left:-.25pt'><a name="_Toc152182">Chapter 18: Binding</a></h1>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc152183">Section 18.1: Early Binding vs Late Binding</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.45pt;
margin-left:.25pt'>Binding is the process of assigning an object to an
identifier or variable name. Early binding (also known as static binding) is
when an object declared in Excel is of a specific object type, such as a
Worksheet or Workbook. Late binding occurs when general object associations are
made, such as the Object and Variant declaration types.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.8pt;
margin-left:.25pt'>Early binding of references some advantages over late
binding.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:20.9pt'><img width=5 height=1
src="Excel%20VBA%20Notes%20for%20Professionals_files/image172.gif" align=left
hspace=12>Early binding is operationally faster than late binding during
run-time. Creating the object with late binding in run-time takes time that
early binding accomplishes when the VBA project is initially loaded.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:20.9pt'>Early binding offers additional functionality through the
identification of Key/Item pairs by their ordinal position.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:20.9pt'>Depending on code structure, early binding may offer an
additional level of type checking and reduce errors. The VBE's capitalization
correction when typing a bound object's properties and methods is active with
early binding but unavailable with late binding.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=721 height=669
src="Excel%20VBA%20Notes%20for%20Professionals_files/image173.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=399
src="Excel%20VBA%20Notes%20for%20Professionals_files/image174.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.45pt;
margin-left:.25pt'>However, if you are using early binding and the document is
run on a system that lacks one of the libraries you have referenced, you will
encounter problems. Not only will the routines that utilize the missing library
not function properly, but the behavior of all code within the document will
become erratic. It is likely that none of the document's code will function on
that computer.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.45pt;
margin-left:.25pt'>This is where late binding is advantageous. When using late
binding you do not have to add the reference in the Tools&gt;References menu.
On machines that have the appropriate library, the code will still work. On
machines without that library, the commands that reference the library will not
work, but all the other code in your document will continue to function.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>If you are not thoroughly familiar with the library you are
referencing, it may be useful to use early binding while writing the code, then
switch to late binding before deployment. That way you can take advantage of
the VBE's IntelliSense and Object Browser during development.</p>

<h1 style='margin-left:-.25pt'><a name="_Toc152184">Chapter 19: autofilter ;
Uses and best practices</a></h1>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'><b><i>Autofilter</i></b> ultimate goal is to provide in the
quickest way possible data mining from hundreds or thousands of rows data in
order to get the attention in the items we want to focus on. It can receive
parameters such as</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.55pt;margin-bottom:.25pt;
margin-left:.75pt;text-align:justify;text-justify:inter-ideograph;text-indent:
-.5pt;line-height:133%'>&quot;text/values/colors&quot; and they can be stacked
among columns. You may connect up to 2 criteria per column based in logical
connectors and sets of rules. Remark: Autofilter works by filtering rows, there
is no Autofilter to filter columns (at least not natively).</p>

<h2 style='margin-top:0in;margin-right:.55pt;margin-bottom:.25pt;margin-left:
.75pt;text-align:justify;text-justify:inter-ideograph;line-height:133%'><a
name="_Toc152185">Section 19.1: Smartfilter!</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:2.1pt;
margin-left:-.25pt;text-indent:-.5pt;line-height:107%'><b><i>Problem situation</i></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>Warehouse administrator has a sheet (&quot;Record&quot;)
where every logistics movement performed by the facility is stored, he may
filter as needed, although, this is very time consuming and he would like to
improve the process in order to calculate inquiries faster, for example: How
many &quot;pulp&quot; do we have now (in all racks)? How many pulp do we have
now (in rack #5)? Filters are a great tool but, they are somewhat limited to
answer these kind of question in matter of seconds.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
15.2pt;margin-left:0in;text-indent:0in;line-height:107%'><img border=0
width=718 height=514 id="Picture 11400"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image175.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:2.35pt;
margin-left:-.25pt;text-indent:-.5pt;line-height:107%'><b><i>Macro solution:</i></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>The coder knows that <b><i>autofilters are the best, fast
and most reliable solution</i></b> in these kind of scenarios since <b><i>the
data exists already in the worksheet</i></b> and the <b><i>input for them can
be obtained easily</i></b> -in this case, by user input-. The approach used is
to create a sheet called &quot;SmartFilter&quot; where administrator can easily
filter multiple data as needed and calculation will be performed instantly as
well.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>He uses 2 modules and the <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>Worksheet_Change</span> event for this
matter</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>Code For SmartFilter Worksheet:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=158
src="Excel%20VBA%20Notes%20for%20Professionals_files/image176.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>Code for module 1, called &quot;General_Functions&quot;</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
0in;margin-left:-.45pt;text-indent:0in;line-height:107%'><img border=0
width=719 height=786 id="Picture 148675"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image177.gif"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:50.3pt;margin-bottom:
.2pt;margin-left:3.5pt;text-indent:-.5pt'><span style='position:relative;
z-index:-1895803904'><span style='left:0px;position:absolute;left:0px;
top:-25614px;width:718px;height:1px'><img width=718 height=1
src="Excel%20VBA%20Notes%20for%20Professionals_files/image178.gif"></span></span><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>If</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:brown'>1</span><span style='font-size:9.0pt;line-height:110%'> = </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>2</span><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Or</span></b><span style='font-size:9.0pt;
line-height:110%'> DummyRange </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Is</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>Nothing</span></b><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Then</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><i><span style='font-size:
9.0pt;line-height:110%;color:green'>'99. If error </span></i><span
style='font-size:9.0pt;line-height:110%'>Err01General_Functions_Find_Title:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.25pt;
margin-left:3.5pt;text-indent:-.5pt;line-height:110%'><span style='font-size:
9.0pt;line-height:110%'> </span><b><span style='font-size:9.0pt;line-height:
110%;color:blue'>If</span></b><span style='font-size:9.0pt;line-height:110%'>
IsNeededToExist = </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>True</span></b><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Then</span></b><span
style='font-size:9.0pt;line-height:110%'> MsgBox </span><span style='font-size:
9.0pt;line-height:110%;color:brown'>&quot;Err01General_Functions_Find_Title:
Ttile '&quot;</span><span style='font-size:9.0pt;line-height:110%'> &amp;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'>TitleToFind &amp; </span><span style='font-size:9.0pt;line-height:110%;
color:brown'>&quot;' was not found in sheet '&quot;</span><span
style='font-size:9.0pt;line-height:110%'> &amp; InSheet &amp; </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>&quot;'&quot;</span><span
style='font-size:9.0pt;line-height:110%'>, vbCritical: </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Call</span></b><span
style='font-size:9.0pt;line-height:110%'> ExcelNormal: </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>On</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Error</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>GoTo</span></b><span style='font-size:9.0pt;
line-height:110%'> -</span><span style='font-size:9.0pt;line-height:110%;
color:brown'>1</span><span style='font-size:9.0pt;line-height:110%'>: </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>End</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.3pt;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>End</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>If</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><i><span style='font-size:9.0pt;line-height:110%;
color:green'>'99. If error</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:17.25pt;
margin-left:3.5pt;text-indent:-.5pt'><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>End</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>Function</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:14.45pt;
margin-left:.25pt'>Code for module 2, called &quot;Inventory_Handling&quot;</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.25pt;
margin-left:3.5pt;text-indent:-.5pt;line-height:110%'><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Const</span></b><span
style='font-size:9.0pt;line-height:110%'> TitleDesc </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>String</span><span style='font-size:9.0pt;
line-height:110%'> = </span><span style='font-size:9.0pt;line-height:110%;
color:brown'>&quot;DESCRIPTION&quot;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Const</span></b><span style='font-size:9.0pt;
line-height:110%'> TitleLocation </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>As</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:slateblue'>String</span><span style='font-size:9.0pt;line-height:110%'> =
</span><span style='font-size:9.0pt;line-height:110%;color:brown'>&quot;LOCATION&quot;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Const</span></b><span style='font-size:9.0pt;
line-height:110%'> TitleActn </span><b><span style='font-size:9.0pt;line-height:
110%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:slateblue'>String</span><span
style='font-size:9.0pt;line-height:110%'> = </span><span style='font-size:9.0pt;
line-height:110%;color:brown'>&quot;ACTION&quot;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Const</span></b><span style='font-size:9.0pt;
line-height:110%'> TitleQty </span><b><span style='font-size:9.0pt;line-height:
110%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:slateblue'>String</span><span
style='font-size:9.0pt;line-height:110%'> = </span><span style='font-size:9.0pt;
line-height:110%;color:brown'>&quot;QUANTITY&quot;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Const</span></b><span style='font-size:9.0pt;
line-height:110%'> SheetRecords </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>As</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:slateblue'>String</span><span style='font-size:9.0pt;line-height:110%'> =
</span><span style='font-size:9.0pt;line-height:110%;color:brown'>&quot;Record&quot;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Const</span></b><span style='font-size:9.0pt;
line-height:110%'> SheetSmartFilter </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>As</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:slateblue'>String</span><span style='font-size:9.0pt;line-height:110%'> =
</span><span style='font-size:9.0pt;line-height:110%;color:brown'>&quot;SmartFilter&quot;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Const</span></b><span style='font-size:9.0pt;
line-height:110%'> RowFilter </span><b><span style='font-size:9.0pt;line-height:
110%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:slateblue'>Long</span><span
style='font-size:9.0pt;line-height:110%'> = </span><span style='font-size:9.0pt;
line-height:110%;color:brown'>2</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Const</span></b><span style='font-size:9.0pt;
line-height:110%'> ColDataToPaste </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>As</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:110%'> = </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>2</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Const</span></b><span style='font-size:9.0pt;
line-height:110%'> RowDataToPaste </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>As</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:110%'> = </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>7</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Const</span></b><span style='font-size:9.0pt;
line-height:110%'> RangeInResult </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>As</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:slateblue'>String</span><span style='font-size:9.0pt;line-height:110%'> =
</span><span style='font-size:9.0pt;line-height:110%;color:brown'>&quot;K1&quot;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Const</span></b><span style='font-size:9.0pt;
line-height:110%'> RangeOutResult </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>As</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:slateblue'>String</span><span style='font-size:9.0pt;line-height:110%'> =
</span><span style='font-size:9.0pt;line-height:110%;color:brown'>&quot;K2&quot;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Sub</span></b><span style='font-size:9.0pt;
line-height:110%'> Inventory_Filter()</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Dim</span></b><span style='font-size:9.0pt;
line-height:110%'> ColDesc </span><b><span style='font-size:9.0pt;line-height:
110%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:slateblue'>Long</span><span
style='font-size:9.0pt;line-height:110%'>: ColDesc =
General_Functions_Find_Title(SheetSmartFilter, TitleDesc,</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'>IsNeededToExist:=</span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>True</span></b><span style='font-size:9.0pt;line-height:110%'>,
IsWhole:=</span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>True</span></b><span
style='font-size:9.0pt;line-height:110%'>).Column</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Dim</span></b><span style='font-size:9.0pt;
line-height:110%'> ColLocation </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>As</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:110%'>:
ColLocation = General_Functions_Find_Title(SheetSmartFilter,</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'>TitleLocation, IsNeededToExist:=</span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>True</span></b><span style='font-size:9.0pt;
line-height:110%'>, IsWhole:=</span><b><span style='font-size:9.0pt;line-height:
110%;color:blue'>True</span></b><span style='font-size:9.0pt;line-height:110%'>).Column</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Dim</span></b><span style='font-size:9.0pt;
line-height:110%'> ColActn </span><b><span style='font-size:9.0pt;line-height:
110%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:slateblue'>Long</span><span
style='font-size:9.0pt;line-height:110%'>: ColActn =
General_Functions_Find_Title(SheetSmartFilter, TitleActn,</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'>IsNeededToExist:=</span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>True</span></b><span style='font-size:9.0pt;line-height:110%'>,
IsWhole:=</span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>True</span></b><span
style='font-size:9.0pt;line-height:110%'>).Column</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Dim</span></b><span style='font-size:9.0pt;
line-height:110%'> ColQty </span><b><span style='font-size:9.0pt;line-height:
110%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:slateblue'>Long</span><span
style='font-size:9.0pt;line-height:110%'>: ColQty =
General_Functions_Find_Title(SheetSmartFilter, TitleQty,</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'>IsNeededToExist:=</span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>True</span></b><span style='font-size:9.0pt;line-height:110%'>,
IsWhole:=</span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>True</span></b><span
style='font-size:9.0pt;line-height:110%'>).Column</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Dim</span></b><span style='font-size:9.0pt;
line-height:110%'> CounterQty </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>As</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:slateblue'>Long</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Dim</span></b><span style='font-size:9.0pt;
line-height:110%'> TotalQty </span><b><span style='font-size:9.0pt;line-height:
110%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:slateblue'>Long</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Dim</span></b><span style='font-size:9.0pt;
line-height:110%'> TotalIn </span><b><span style='font-size:9.0pt;line-height:
110%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:slateblue'>Long</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Dim</span></b><span style='font-size:9.0pt;
line-height:110%'> TotalOut </span><b><span style='font-size:9.0pt;line-height:
110%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:slateblue'>Long</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Dim</span></b><span style='font-size:9.0pt;
line-height:110%'> RangeFiltered </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>As</span></b><span style='font-size:9.0pt;
line-height:110%'> Range</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Call</span></b><span
style='font-size:9.0pt;line-height:110%'> Select_Sheet(SheetSmartFilter)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>If</span></b><span
style='font-size:9.0pt;line-height:110%'> Cells(Rows.Count, ColDataToPaste).</span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>End</span></b><span
style='font-size:9.0pt;line-height:110%'>(xlUp).Row &gt; RowDataToPaste - </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>1</span><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Then</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'>Rows(RowDataToPaste &amp; </span><span style='font-size:9.0pt;line-height:
110%;color:brown'>&quot;:&quot;</span><span style='font-size:9.0pt;line-height:
110%'> &amp; Cells(Rows.Count, </span><span style='font-size:9.0pt;line-height:
110%;color:brown'>&quot;B&quot;</span><span style='font-size:9.0pt;line-height:
110%'>).</span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>End</span></b><span
style='font-size:9.0pt;line-height:110%'>(xlUp).Row).Delete</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> Sheets(SheetRecords).AutoFilterMode = </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>False</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>If</span></b><span
style='font-size:9.0pt;line-height:110%'> Cells(RowFilter, ColDesc).Value
&lt;&gt; </span><span style='font-size:9.0pt;line-height:110%;color:brown'>&quot;&quot;</span><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Or</span></b><span style='font-size:9.0pt;
line-height:110%'> Cells(RowFilter, ColLocation).Value &lt;&gt; </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>&quot;&quot;</span><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Or</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.3pt;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'>Cells(RowFilter, ColActn).Value &lt;&gt; </span><span style='font-size:
9.0pt;line-height:110%;color:brown'>&quot;&quot;</span><span style='font-size:
9.0pt;line-height:110%'> </span><b><span style='font-size:9.0pt;line-height:
110%;color:blue'>Then</span></b><span style='font-size:9.0pt;line-height:110%'>
</span><i><span style='font-size:9.0pt;line-height:110%;color:green'>' 1. If
Cells(RowFilter, ColDesc).Value &lt;&gt; &quot;&quot; Or</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.3pt;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><i><span style='font-size:9.0pt;
line-height:110%;color:green'>Cells(RowFilter, ColLocation).Value &lt;&gt;
&quot;&quot; Or Cells(RowFilter, ColActn).Value &lt;&gt; &quot;&quot;</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>With</span></b><span
style='font-size:9.0pt;line-height:110%'> Sheets(SheetRecords).UsedRange</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>If</span></b><span
style='font-size:9.0pt;line-height:110%'>
Sheets(SheetSmartFilter).Cells(RowFilter, ColDesc).Value &lt;&gt; </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>&quot;&quot;</span><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Then</span></b><span style='font-size:9.0pt;
line-height:110%'> .AutoFilter</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'>Field:=General_Functions_Find_Title(SheetRecords, TitleDesc,
IsNeededToExist:=</span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>True</span></b><span style='font-size:9.0pt;line-height:110%'>,</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'>IsWhole:=</span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>True</span></b><span style='font-size:9.0pt;line-height:110%'>).Column,
Criteria1:=Sheets(SheetSmartFilter).Cells(RowFilter, ColDesc).Value</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>If</span></b><span
style='font-size:9.0pt;line-height:110%'>
Sheets(SheetSmartFilter).Cells(RowFilter, ColLocation).Value &lt;&gt; </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>&quot;&quot;</span><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Then</span></b><span style='font-size:9.0pt;
line-height:110%'> .AutoFilter</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'>Field:=General_Functions_Find_Title(SheetRecords, TitleLocation,
IsNeededToExist:=</span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>True</span></b><span style='font-size:9.0pt;line-height:110%'>,</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'>IsWhole:=</span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>True</span></b><span style='font-size:9.0pt;line-height:110%'>).Column,
Criteria1:=Sheets(SheetSmartFilter).Cells(RowFilter, ColLocation).Value</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>If</span></b><span
style='font-size:9.0pt;line-height:110%'>
Sheets(SheetSmartFilter).Cells(RowFilter, ColActn).Value &lt;&gt; </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>&quot;&quot;</span><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Then</span></b><span style='font-size:9.0pt;
line-height:110%'> .AutoFilter</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'>Field:=General_Functions_Find_Title(SheetRecords, TitleActn,
IsNeededToExist:=</span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>True</span></b><span style='font-size:9.0pt;line-height:110%'>,</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'>IsWhole:=</span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>True</span></b><span style='font-size:9.0pt;line-height:110%'>).Column,
Criteria1:=Sheets(SheetSmartFilter).Cells(RowFilter, ColActn).Value</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.3pt;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><i><span style='font-size:9.0pt;line-height:110%;color:green'>'If
we don't use a filter we would need to use a cycle For/to or For/Each Cell in
range</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.3pt;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><i><span style='font-size:9.0pt;line-height:110%;color:green'>'to
determine whether or not the row meets the criteria that we are looking and
then</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.3pt;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><i><span style='font-size:9.0pt;line-height:110%;color:green'>'save
it on an array, collection, dictionary, etc</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.3pt;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><i><span style='font-size:9.0pt;line-height:110%;color:green'>'IG:
For CounterRow = 2 To TotalRows</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.3pt;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><i><span style='font-size:9.0pt;line-height:110%;color:green'>'If
Sheets(SheetSmartFilter).Cells(RowFilter, ColDesc).Value &lt;&gt; &quot;&quot;
and</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.3pt;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><i><span style='font-size:9.0pt;
line-height:110%;color:green'>Sheets(SheetRecords).cells(CounterRow,ColDescInRecords).Value=</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.3pt;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><i><span style='font-size:9.0pt;
line-height:110%;color:green'>Sheets(SheetSmartFilter).Cells(RowFilter,
ColDesc).Value then</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.3pt;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><i><span style='font-size:9.0pt;line-height:110%;color:green'>'Redim
Preserve MyUnecessaryArray(UnecessaryNumber) ''Save to array:</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.3pt;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='position:relative;z-index:
-1895802880'><span style='left:0px;position:absolute;left:0px;top:-26657px;
width:718px;height:1px'><img width=718 height=1
src="Excel%20VBA%20Notes%20for%20Professionals_files/image179.gif"></span></span><i><span
style='font-size:9.0pt;line-height:110%;color:green'>(UnecessaryNumber)=MyUnecessaryArray.
Or in a dictionary, etc. At the end, we would transpose this values into the
sheet, at the end</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.3pt;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><i><span style='font-size:9.0pt;line-height:110%;color:green'>'both
are the same, but, just try to see the time invested on each logic.</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>If</span></b><span
style='font-size:9.0pt;line-height:110%'> .Cells(</span><span style='font-size:
9.0pt;line-height:110%;color:brown'>1</span><span style='font-size:9.0pt;
line-height:110%'>, </span><span style='font-size:9.0pt;line-height:110%;
color:brown'>1</span><span style='font-size:9.0pt;line-height:110%'>).</span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>End</span></b><span
style='font-size:9.0pt;line-height:110%'>(xlDown).Value &lt;&gt; </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>&quot;&quot;</span><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Then</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>Set</span></b><span style='font-size:9.0pt;line-height:110%'>
RangeFiltered = .Rows(</span><span style='font-size:9.0pt;line-height:110%;
color:brown'>&quot;2:&quot;</span><span style='font-size:9.0pt;line-height:
110%'> &amp;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:32.95pt;margin-bottom:
.2pt;margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;
line-height:110%'>Sheets(SheetRecords).Cells(Rows.Count, </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>&quot;A&quot;</span><span
style='font-size:9.0pt;line-height:110%'>).</span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>End</span></b><span style='font-size:9.0pt;
line-height:110%'>(xlUp).Row).SpecialCells(xlCellTypeVisible) </span><i><span
style='font-size:9.0pt;line-height:110%;color:green'>'If it is not
&lt;&gt;&quot;&quot; means that there was not filtered data!</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:27.2pt;margin-bottom:
.2pt;margin-left:3.5pt;text-indent:-.5pt'><span style='position:relative;
z-index:-1895801856'><span style='left:0px;position:absolute;left:0px;
top:-26744px;width:718px;height:1px'><img width=718 height=1
src="Excel%20VBA%20Notes%20for%20Professionals_files/image180.gif"></span></span><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>If</span></b><span style='font-size:9.0pt;
line-height:110%'> RangeFiltered </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Is</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>Nothing</span></b><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Then</span></b><span
style='font-size:9.0pt;line-height:110%'> MsgBox </span><span style='font-size:
9.0pt;line-height:110%;color:brown'>&quot;Err01Inventory_Filter: No data was
found with the given criteria!&quot;</span><span style='font-size:9.0pt;
line-height:110%'>, vbCritical: </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Call</span></b><span style='font-size:9.0pt;
line-height:110%'> ExcelNormal: </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>End </span></b><span style='font-size:9.0pt;
line-height:110%'>RangeFiltered.Copy Destination:=Cells(RowDataToPaste,
ColDataToPaste)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> TotalQty = Cells(Rows.Count, ColQty).</span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>End</span></b><span
style='font-size:9.0pt;line-height:110%'>(xlUp).Row</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>For</span></b><span
style='font-size:9.0pt;line-height:110%'> CounterQty = RowDataToPaste + </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>1</span><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>To</span></b><span style='font-size:9.0pt;
line-height:110%'> TotalQty</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.3pt;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>If</span></b><span
style='font-size:9.0pt;line-height:110%'> Cells(CounterQty, ColActn).Value = </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>&quot;In&quot;</span><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Then</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><i><span style='font-size:9.0pt;line-height:110%;
color:green'>' 2. If Cells(CounterQty, ColActn).Value = &quot;In&quot;</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> TotalIn = Cells(CounterQty, ColQty).Value + TotalIn</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.3pt;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>ElseIf</span></b><span
style='font-size:9.0pt;line-height:110%'> Cells(CounterQty, ColActn).Value = </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>&quot;Out&quot;</span><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Then</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><i><span style='font-size:9.0pt;line-height:110%;
color:green'>' 2. If Cells(CounterQty, ColActn).Value = &quot;In&quot;</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> TotalOut = Cells(CounterQty, ColQty).Value + TotalOut</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.3pt;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>End</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>If</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><i><span style='font-size:9.0pt;line-height:110%;
color:green'>' 2. If Cells(CounterQty, ColActn).Value = &quot;In&quot;</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Next</span></b><span
style='font-size:9.0pt;line-height:110%'> CounterQty</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> Range(RangeInResult).Value = TotalIn</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> Range(RangeOutResult).Value = -(TotalOut)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>End</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>With</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.3pt;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>End</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>If</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><i><span style='font-size:9.0pt;line-height:110%;
color:green'>' 1. If Cells(RowFilter, ColDesc).Value &lt;&gt; &quot;&quot; Or
Cells(RowFilter, ColLocation).Value &lt;&gt;</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:291.4pt;margin-bottom:
21.25pt;margin-left:3.5pt;text-indent:-.5pt'><i><span style='font-size:9.0pt;
line-height:110%;color:green'>&quot;&quot; Or Cells(RowFilter, ColActn).Value
&lt;&gt; &quot;&quot; </span></i><b><span style='font-size:9.0pt;line-height:
110%;color:blue'>End</span></b><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Sub</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:-.25pt;text-indent:-.5pt;line-height:107%'><b><i>Testing and
results:</i></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
4.0pt;margin-left:0in;text-indent:0in;line-height:107%'><img border=0
width=717 height=287 id="Picture 12714"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image181.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>As we saw in the previous image, this task has been achieved
easily. By using <b><i>autofilters</i></b> a solution was provided that just <b><i>takes
seconds to compute, is easy to explain to the user</i></b> -since s/he is
familiar with this command- and <b><i>took a few lines to the coder.</i></b></p>

<h1 style='margin-left:-.25pt'><a name="_Toc152186">Chapter 20: Application
object</a></h1>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:0in;margin-left:
-.25pt'><a name="_Toc152187">Section 20.1: Simple Application Object example:
Display Excel and VBE Version</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=109
src="Excel%20VBA%20Notes%20for%20Professionals_files/image182.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:18.2pt;
margin-left:.25pt'>The use of the Application.Version property is useful for
ensuring code only operates on a compatible version of Excel.</p>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc152188">Section 20.2: Simple Application Object example:
Minimize the Excel window</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>This code uses the top level <b>Application</b> object to
minimize the main Excel window.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=718 height=92
src="Excel%20VBA%20Notes%20for%20Professionals_files/image183.gif"></span><br
clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc152189">Chapter 21: Charts and
Charting</a></h1>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc152190">Section 21.1: Creating a Chart with Ranges and a
Fixed Name</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.75pt;
margin-left:.25pt'>Charts can be created by working directly with the <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Series</span>
object that defines the chart data. In order to get to the <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Series</span>
without an exisitng chart, you create a <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>ChartObject</span> on a given <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Worksheet</span>
and then get the <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Chart</span>
object from it. The upside of working with the <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>Series</span> object is that you can set
the <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Values</span>
and <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>XValues</span>
by referring to <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Range</span>
objects. These data properties will properly define the <span style='font-size:
9.0pt;line-height:110%;background:#FAFAFA'>Series</span> with references to
those ranges. The downside to this approach is that the same conversion is not
handled when setting the <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>Name</span>; it is a fixed value. It will not adjust with
the underlying data in the original <span style='font-size:9.0pt;line-height:
110%;background:#FAFAFA'>Range</span>. Checking the <span style='font-size:
9.0pt;line-height:110%;background:#FAFAFA'>SERIES</span> formula and it is
obvious that the name is fixed. This must be handled by creating the <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>SERIES</span>
formula directly.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:13.45pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'><b>Code used to create
chart</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>Note that this code contains extra variable declarations for
the <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Chart</span>
and <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Worksheet</span>.
These can be omitted if they're not used. They can be useful however if you are
modifying the style or any other chart properties.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
15.3pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=720 height=568
src="Excel%20VBA%20Notes%20for%20Professionals_files/image184.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:13.5pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'><b>Original data/ranges
and resulting </b><b><span style='font-size:9.0pt;line-height:107%;background:
#FAFAFA'>Chart</span> after code runs</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>Note that the <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>SERIES</span> formula includes a <span style='font-size:
9.0pt;line-height:110%;color:brown;background:#FAFAFA'>&quot;B&quot;</span> for
the series name instead of a reference to the <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>Range</span> that created it.</p>

<p class=MsoNormal style='margin-bottom:10.35pt;text-indent:0in;line-height:
107%'><img border=0 width=634 height=737 id="Picture 13041"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image185.jpg"></p>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc152191">Section 21.2: Creating an empty Chart</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.6pt;
margin-left:.25pt'>The starting point for the vast majority of charting code is
to create an empty <span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>Chart</span>. Note that this <span style='font-size:9.0pt;line-height:
110%;background:#FAFAFA'>Chart</span> is subject to the default chart template
that is active and may not actually be empty (if the template has been
modified).</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=194 style='width:145.8pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=86 valign=top style='width:.9in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>ChartObjects</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;background:#FAFAFA'>.</span></p>
  </td>
  <td width=22 valign=top style='width:16.2pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>Add</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;background:#FAFAFA'>(</span></p>
  </td>
  <td width=72 valign=top style='width:.75in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>Left, Top,</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:22.25pt;margin-bottom:
1.5pt;margin-left:.25pt'>The key to the <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>ChartObject</span> is determining its
location. The syntax for the call is </p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=94 style='width:70.2pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=94 valign=top style='width:70.2pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>Width, Height</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.8pt;
margin-left:.25pt'><span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>)</span>. Once the <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>ChartObject</span> is created, you can use its <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Chart</span> object
to actually modify the chart. The <span style='font-size:9.0pt;line-height:
110%;background:#FAFAFA'>ChartObject</span> behaves more like a <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Shape</span> to
position the chart on the sheet.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:.15pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'><b>Code to create an
empty chart</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=718 height=68
src="Excel%20VBA%20Notes%20for%20Professionals_files/image186.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
15.2pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=719 height=252
src="Excel%20VBA%20Notes%20for%20Professionals_files/image187.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:.15pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'><b>Resulting Chart</b></p>

<p class=MsoNormal style='margin-bottom:10.35pt;text-indent:0in;line-height:
107%'><img border=0 width=580 height=443 id="Picture 13171"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image188.jpg"></p>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc152192">Section 21.3: Create a Chart by Modifying the
SERIES formula</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.65pt;
margin-left:.25pt'>For complete control over a new <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>Chart</span> and <span style='font-size:
9.0pt;line-height:110%;background:#FAFAFA'>Series</span> object (especially for
a dynamic <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Series</span>
name), you must resort to modifying the <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>SERIES</span> formula directly. The
process to set up the <span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>Range</span> objects is straightforward and the main hurdle is simply
the string building for the <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>SERIES</span> formula.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>The <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>SERIES</span> formula takes the following syntax:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
15.0pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=26
src="Excel%20VBA%20Notes%20for%20Professionals_files/image189.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>These contents can be supplied as references or as array
values for the data items. <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>Order</span> represents the series position within the
chart. Note that the references to the data will not work unless they are fully
qualified with the sheet name. For an example of a working formula, click any
existing series and check the formula bar.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:13.45pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'><b>Code to create a chart
and set up data using the </b><b><span style='font-size:9.0pt;line-height:107%;
background:#FAFAFA'>SERIES</span> formula</b></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=108 style='width:81.0pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=50 valign=top style='width:37.8pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>Address</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;background:#FAFAFA'>(</span></p>
  </td>
  <td width=50 valign=top style='width:37.8pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>,,,</span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>True</span></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>Note that the string building to create the <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>SERIES</span>
formula uses <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>.)</span>.
This ensures that the <i>external </i>Range reference is used so that a fully
qualified address with the sheet name is included. You <b>will get an error if
the sheet name is excluded</b>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
15.2pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=720 height=667
src="Excel%20VBA%20Notes%20for%20Professionals_files/image190.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:13.3pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'><b>Original data and
resulting chart</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>Note that for this chart, the series name is properly set
with a range to the desired cell. This means that updates will propagate to the
<span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Chart</span>.</p>

<p class=MsoNormal style='margin-bottom:10.35pt;text-indent:0in;line-height:
107%'><img border=0 width=672 height=741 id="Picture 13468"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image191.jpg"></p>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc152193">Section 21.4: Arranging Charts into a Grid</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.7pt;
margin-left:.25pt'>A common chore with charts in Excel is standardizing the
size and layout of multiple charts on a single sheet. If done manually, you can
hold down <span style='border:solid black 1.5pt;padding:0in'>ALT </span>while
resizing or moving the chart to &quot;stick&quot; to cell boundaries. This
works for a couple charts, but a VBA approach is much simpler.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:13.3pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'><b>Code to create a grid</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>This code will create a grid of charts starting at a given
(Top, Left) position, with a defined number of columns, and a defined common
chart size. The charts will be placed in the order they were created and wrap
around the edge to form a new row.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=718 height=44
src="Excel%20VBA%20Notes%20for%20Professionals_files/image192.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
15.2pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=580
src="Excel%20VBA%20Notes%20for%20Professionals_files/image193.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:13.3pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'><b>Result with several
charts</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.8pt;
margin-left:.25pt'>These pictures show the original random layout of charts and
the resulting grid from running the code above.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:2.35pt;
margin-left:-.25pt;text-indent:-.5pt;line-height:107%'><i>Before</i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><img border=0
width=719 height=512 id="Picture 13677"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image194.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:2.35pt;
margin-left:-.25pt;text-indent:-.5pt;line-height:107%'><i>After</i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
0in;margin-left:0in;text-indent:0in;line-height:107%'><img border=0 width=718
height=544 id="Picture 13696"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image195.jpg"></p>

<h1 style='margin-left:-.25pt'><a name="_Toc152194">Chapter 22:
CustomDocumentProperties in practice</a></h1>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.45pt;
margin-left:.25pt'>Using CustomDocumentProperties (CDPs) is a good method to
store user defined values in a relatively safe way within the same work book,
but avoiding to show related cell values simply in an unprotected work sheet
*).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.45pt;
margin-left:.25pt'>Note: CDPs represent a separate collection comparable to
BuiltInDocumentProperties, but allow to create user defined property names of
your own instead of a fixed collection.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:88.9pt;margin-bottom:
0in;margin-left:.25pt;line-height:145%'>*) Alternatively, you could enter
values also in a hidden or &quot;very hidden&quot; workbook.</p>

<h2 style='margin-top:0in;margin-right:88.9pt;margin-bottom:0in;margin-left:
.25pt;text-indent:.5pt;line-height:145%'><a name="_Toc152195">Section 22.1:
Organizing new invoice numbers</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.7pt;
margin-left:.25pt'>Incrementing an invoice number and saving its value is a
frequent task. Using CustomDocumentProperties (CDPs) is a good method to store
such numbers in a relatively safe way within the same work book, but avoiding
to show related cell values simply in an unprotected work sheet.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:13.3pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'><b>Additional hint:</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.7pt;
margin-left:.25pt'>Alternatively, you could enter values also in a hidden
worksheet or even a so called &quot;very hidden&quot; worksheet (see Using
xlVeryHidden Sheets. Of course, it's possible to save data also to external
files (e.g. ini file, csv or any other type) or the registry.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:13.3pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'><b>Example content</b>:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.8pt;
margin-left:.25pt'>The example below shows</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.45pt;
margin-left:20.9pt'><img width=5 height=1
src="Excel%20VBA%20Notes%20for%20Professionals_files/image126.gif" align=left
hspace=12>a function NextInvoiceNo that sets and returns the next invoice
number, a procedure DeleteInvoiceNo, that deletes the invoice CDP completely,
as well as a procedure showAllCDPs listing the complete CDPs collection with
all names. Not using VBA, you can also list them via the workbook's
information: Info | Properties [DropDown:] | Advanced Properties | Custom</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>You can get and set the next invoice number (last no plus
one) simply by calling the above mentioned function, returning a string value
in order to facilitate adding prefixes. &quot;InvoiceNo&quot; is implicitly
used as CDP name in all procedures.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
15.2pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=43
src="Excel%20VBA%20Notes%20for%20Professionals_files/image196.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:.15pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'><b>Example code:</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=720 height=235
src="Excel%20VBA%20Notes%20for%20Professionals_files/image197.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.75pt;margin-left:-.45pt;text-indent:0in;line-height:107%'><img border=0
width=719 height=974 id="Picture 148680"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image198.gif"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>End Sub</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=718 height=371
src="Excel%20VBA%20Notes%20for%20Professionals_files/image199.gif"></span><br
clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc152196">Chapter 23: PowerPoint
Integration Through VBA</a></h1>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc152197">Section 23.1: The Basics: Launching PowerPoint
from VBA</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:23.9pt;
margin-left:.25pt'>While there are many parameters that can be changed and
variations that can be added depending on the desired functionality, this
example lays out the basic framework for launching PowerPoint.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:25.0pt;margin-bottom:
23.6pt;margin-left:24.0pt'><img width=3 height=1
src="Excel%20VBA%20Notes%20for%20Professionals_files/image200.gif" align=left
hspace=12><b>Note:</b> This code requires that the PowerPoint reference has
been added to the active VBA Project. See the References Documentation entry to
learn how to enable the reference.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>First, define variables for the Application, Presentation,
and Slide Objects. While this can be done with late binding, it is always best
to use early binding when applicable.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=60
src="Excel%20VBA%20Notes%20for%20Professionals_files/image201.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=144 style='width:1.5in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=144 valign=top style='width:1.5in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>On</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Error</span></b><span style='font-size:9.0pt;line-height:107%'> </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Resume</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Next</span></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>Next, open or create a new instance of the PowerPoint
application. Here, the call is used to avoid an error being thrown by <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>GetObject</span> if
PowerPoint has not yet been opened. See the Error Handling example of the Best
Practices Topic for a more detailed explanation.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=158
src="Excel%20VBA%20Notes%20for%20Professionals_files/image202.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:14.1pt;
margin-left:.25pt'>Once the application has been launched, a new presentation
and subsequently contained slide is generated for use.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.3pt;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><i><span style='font-size:9.0pt;
line-height:110%;color:green'>'Generate new Presentation and slide for graphic
creation</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Set</span></b><span style='font-size:9.0pt;
line-height:110%'> PPPres = PPApp.Presentations.Add</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.55pt;
margin-left:3.5pt;text-indent:-.5pt'><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Set</span></b><span style='font-size:9.0pt;
line-height:110%'> PPSlide = PPPres.Slides.Add(</span><span style='font-size:
9.0pt;line-height:110%;color:brown'>1</span><span style='font-size:9.0pt;
line-height:110%'>, ppLayoutBlank)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.3pt;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='position:relative;z-index:
-1895798784'><span style='left:0px;position:absolute;left:0px;top:-37511px;
width:718px;height:1px'><img width=718 height=1
src="Excel%20VBA%20Notes%20for%20Professionals_files/image203.gif"></span></span><i><span
style='font-size:9.0pt;line-height:110%;color:green'>'Here, the slide type is
set to the 4:3 shape with slide numbers enabled and the window</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.3pt;margin-bottom:12.55pt;
margin-left:3.5pt;text-indent:-.5pt'><i><span style='font-size:9.0pt;
line-height:110%;color:green'>'maximized on the screen. These properties can,
of course, be altered as needed</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'>PPApp.ActiveWindow.ViewType = ppViewSlide</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'>PPPres.PageSetup.SlideOrientation = msoOrientationHorizontal</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'>PPPres.PageSetup.SlideSize = ppSlideSizeOnScreen</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'>PPPres.SlideMaster.HeadersFooters.SlideNumber.Visible = msoTrue</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:17.25pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'>PPApp.ActiveWindow.WindowState = ppWindowMaximized</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>Upon completion of this code, a new PowerPoint window with a
blank slide will be open. By using the object variables, shapes, text,
graphics, and excel ranges can be added as desired</p>

<h1 style='margin-left:-.25pt'><a name="_Toc152198">Chapter 24: How to record a
Macro</a></h1>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:0in;margin-left:
-.25pt'><a name="_Toc152199">Section 24.1: How to record a Macro</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.8pt;
margin-left:.25pt'>The easiest way to record a macro is the button in the lower
left corner of Excel looks like this: <img border=0 width=87 height=66
id="Picture 14408"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image204.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>When you click on this you will get a pop-up asking you to
name the Macro and decide if you want to have a shortcut key. Also, asks where
to store the macro and for a description. You can choose any name you want, no
spaces are allowed.</p>

<p class=MsoNormal style='margin-bottom:14.95pt;text-indent:0in;line-height:
107%'><img border=0 width=360 height=294 id="Picture 14413"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image205.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.45pt;
margin-left:.25pt'>If you want to have a shortcut assigned to your macro for
quick use choose a letter that you will remember so that you can quickly and
easily use the macro over and over.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.45pt;
margin-left:.25pt'>You can store the macro in &quot;This Workbook,&quot;
&quot;New Workbook,&quot; or &quot;Personal Macro Workbook.&quot; If you want
the macro you're about to record to be available only in the current workbook,
choose &quot;This Workbook.&quot; If you want it saved to a brand new workbook,
choose &quot;New Workbook.&quot; And if you want the macro to be available to
any workbook you open, choose &quot;Personal Macro Workbook.&quot;</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.8pt;
margin-left:.25pt'>After you have filled out this pop-up click on
&quot;Ok&quot;.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>Then perform whatever actions you want to repeat with the
macro. When finished click the same button to stop recording. It now looks like
this:</p>

<p class=MsoNormal style='margin-bottom:14.95pt;text-indent:0in;line-height:
107%'><img border=0 width=84 height=63 id="Picture 14424"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image206.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>Now you can go to the Developer Tab and open Visual Basic.
(or use Alt + F11)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.8pt;
margin-left:.25pt'>You will now have a new Module under the Modules folder. <img
border=0 width=165 height=150 id="Picture 14450"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image207.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.8pt;
margin-left:.25pt'>The newest module will contain the macro you just recorded.
Double-click on it to bring it up.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>I did a simple copy and paste:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=174
src="Excel%20VBA%20Notes%20for%20Professionals_files/image208.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>If you don't want it to always paste into &quot;A12&quot;
you can use Relative References by checking the &quot;Use Relative</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.8pt;
margin-left:.25pt'>References&quot; box on the Developer Tab: <img border=0
width=249 height=92 id="Picture 14479"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image209.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>Following the same steps as before will now turn the Macro
into this:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=174
src="Excel%20VBA%20Notes%20for%20Professionals_files/image210.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>Still copying the value from &quot;A1&quot; into a cell 11
rows down, but now you can perform the same macro with any starting cell and
the value from that cell will be copied to the cell 11 rows down.</p>

<h1 style='margin-left:-.25pt'><a name="_Toc152200">Chapter 25: SQL in Excel
VBA - Best Practices</a></h1>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc152201">Section 25.1: How to use ADODB.Connection in VBA?</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:2.7pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'><b>Requirements:</b></p>

<p class=MsoNormal style='margin-bottom:.95pt;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=447 height=503
src="Excel%20VBA%20Notes%20for%20Professionals_files/image211.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
4.0pt;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=718 height=60
src="Excel%20VBA%20Notes%20for%20Professionals_files/image212.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:2.35pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'><b>Create connection</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:3.75pt;
margin-left:12.05pt;text-indent:-11.8pt;line-height:107%'><b><span
style='line-height:107%'>a.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span></b><b>with Windows Authentication</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Private</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>Sub</span></b><span style='font-size:9.0pt;line-height:110%'>
OpenConnection(pServer </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>As</span></b><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:slateblue'>String</span><span
style='font-size:9.0pt;line-height:110%'>, pCatalog </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>String</span><span style='font-size:9.0pt;
line-height:110%'>)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:21.3pt;
margin-left:3.5pt;text-indent:-.5pt;line-height:110%'><span style='position:
relative;z-index:-1895797760'><span style='left:0px;position:absolute;
left:0px;top:-40124px;width:718px;height:1px'><img width=718 height=1
src="Excel%20VBA%20Notes%20for%20Professionals_files/image213.gif"></span></span><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Call</span></b><span style='font-size:9.0pt;
line-height:110%'> mDataBase.Open(</span><span style='font-size:9.0pt;
line-height:110%;color:brown'>&quot;Provider=SQLOLEDB;Initial Catalog=&quot;</span><span
style='font-size:9.0pt;line-height:110%'> &amp; pCatalog &amp; </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>&quot;;Data Source=&quot;</span><span
style='font-size:9.0pt;line-height:110%'> &amp; pServer &amp; </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>&quot;;Integrated
Security=SSPI&quot;</span><span style='font-size:9.0pt;line-height:110%'>)
mCmd.ActiveConnection = mDataBase </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>End</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>Sub</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:3.75pt;
margin-left:12.05pt;text-indent:-11.8pt;line-height:107%'><b><span
style='line-height:107%'>b.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;
</span></span></b><b>with SQL Server Authentication</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Private</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>Sub</span></b><span style='font-size:9.0pt;line-height:110%'>
OpenConnection2(pServer </span><b><span style='font-size:9.0pt;line-height:
110%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:slateblue'>String</span><span
style='font-size:9.0pt;line-height:110%'>, pCatalog </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>String</span><span style='font-size:9.0pt;
line-height:110%'>, pUser </span><b><span style='font-size:9.0pt;line-height:
110%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:slateblue'>String</span><span
style='font-size:9.0pt;line-height:110%'>, pPsw </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>String</span><span style='font-size:9.0pt;
line-height:110%'>)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.25pt;
margin-left:3.5pt;text-indent:-.5pt;line-height:110%'><span style='position:
relative;z-index:-1895796736'><span style='left:0px;position:absolute;
left:0px;top:-40228px;width:718px;height:1px'><img width=718 height=1
src="Excel%20VBA%20Notes%20for%20Professionals_files/image213.gif"></span></span><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Call</span></b><span style='font-size:9.0pt;
line-height:110%'> mDataBase.Open(</span><span style='font-size:9.0pt;
line-height:110%;color:brown'>&quot;Provider=SQLOLEDB;Initial Catalog=&quot;</span><span
style='font-size:9.0pt;line-height:110%'> &amp; pCatalog &amp; </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>&quot;;Data Source=&quot;</span><span
style='font-size:9.0pt;line-height:110%'> &amp; pServer &amp; </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>&quot;;Integrated
Security=SSPI;User ID=&quot;</span><span style='font-size:9.0pt;line-height:
110%'> &amp; pUser &amp; </span><span style='font-size:9.0pt;line-height:110%;
color:brown'>&quot;;Password=&quot;</span><span style='font-size:9.0pt;
line-height:110%'> &amp; pPsw) mCmd.ActiveConnection = mDataBase </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>End</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Sub</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:.15pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'><b>Execute sql command</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
4.0pt;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=718 height=76
src="Excel%20VBA%20Notes%20for%20Professionals_files/image214.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=718 height=160
src="Excel%20VBA%20Notes%20for%20Professionals_files/image215.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
4.0pt;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=718 height=109
src="Excel%20VBA%20Notes%20for%20Professionals_files/image216.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:.15pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'><b>How to use it?</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
4.0pt;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=720 height=142
src="Excel%20VBA%20Notes%20for%20Professionals_files/image217.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:13.3pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'><b>Result</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.8pt;
margin-left:.25pt'>ShipperID: 1 CompanyName: Speedy Express Phone: (503)
555-9831</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.8pt;
margin-left:.25pt'>ShipperID: 2 CompanyName: United Package Phone: (503)
555-3199</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.8pt;
margin-left:.25pt'>ShipperID: 3 CompanyName: Federal Shipping Phone: (503)
555-9931</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>ShipperID: 4 CompanyName: speedy shipping Phone: (503)
555-1234</p>

<h1 style='margin-left:-.25pt'><a name="_Toc152202">Chapter 26: Excel-VBA
Optimization</a></h1>

<p class=MsoNormal style='margin-top:0in;margin-right:6.75pt;margin-bottom:
.25pt;margin-left:.75pt;text-align:justify;text-justify:inter-ideograph;
text-indent:-.5pt;line-height:133%'>Excel-VBA Optimization refers also to
coding better error handling by documentation and additional details. This is
shown here.</p>

<h2 style='margin-top:0in;margin-right:6.75pt;margin-bottom:.25pt;margin-left:
.75pt;text-align:justify;text-justify:inter-ideograph;line-height:133%'><a
name="_Toc152203">Section 26.1: Optimizing Error Search by Extended Debugging</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:13.3pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'><b>Using Line Numbers ...
and documenting them in case of error</b> (&quot;The importance of seeing
Erl&quot;)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.7pt;
margin-left:.25pt'>Detecting which line raises an error is a substantial part
of any debugging and narrows the search for the cause. To document identified
error lines with a short description completes a successful error tracking, at
best together with the names of module and procedure. The example below saves
these data to a log file.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:13.3pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'><b>Back ground</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.4pt;
margin-left:.25pt'>The error object returns error number (Err.Number) and error
description (Err.Description), but doesn't explicitly respond to the question
where to locate the error. The <b>Erl</b> function, however, does, but on
condition that you add *<i>line numbers )</i> to the code (BTW one of several
other concessions to former Basic times).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>If there are no error lines at all, then the Erl function
returns 0, if numbering is incomplete you'll get the procedure's last preceding
line number.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=720 height=599
src="Excel%20VBA%20Notes%20for%20Professionals_files/image218.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
15.2pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=87
src="Excel%20VBA%20Notes%20for%20Professionals_files/image219.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:.15pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'>'<b>Additional Code to
show log file</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
10.35pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=720 height=240
src="Excel%20VBA%20Notes%20for%20Professionals_files/image220.gif"></span></p>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc152204">Section 26.2: Disabling Worksheet Updating</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>Disabling calculation of the worksheet can decrease running
time of the macro significantly. Moreover, disabling events, screen updating
and page breaks would be beneficial. Following <b><span style='font-size:9.0pt;
line-height:110%;color:blue;background:#FAFAFA'>Sub</span></b> can be used in
any macro for this purpose.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=719 height=109
src="Excel%20VBA%20Notes%20for%20Professionals_files/image221.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>For optimization follow the below pseudo-code:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
10.35pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=158
src="Excel%20VBA%20Notes%20for%20Professionals_files/image222.gif"></span></p>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc152205">Section 26.3: Row Deletion - Performance</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:9.1pt;
margin-left:20.9pt'><img width=5 height=1
src="Excel%20VBA%20Notes%20for%20Professionals_files/image136.gif" align=left
hspace=12>Deleting rows is slow, specially when looping through cells and
deleting rows, one by one</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:9.1pt;
margin-left:20.9pt'>A different approach is using an AutoFilter to hide the
rows to be deleted</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:9.1pt;
margin-left:20.9pt'>Copy the visible range and Paste it into a new WorkSheet</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:20.9pt'>Remove the initial sheet entirely</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:20.3pt;
margin-left:20.9pt'><span style='font-size:11.0pt;line-height:110%'><img
border=0 width=5 height=5 id="Group 139214"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image003.gif"></span>With
this method, the more rows to delete, the faster it will be</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>Example:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
10.15pt;margin-left:-.45pt;text-indent:0in;line-height:107%'><img border=0
width=719 height=569 id="Picture 148685"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image223.gif"></p>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc152206">Section 26.4: Disabling All Excel Functionality
Before executing large macros</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.8pt;
margin-left:.25pt'>The procedures bellow will temporarily disable all Excel
features at WorkBook and WorkSheet level</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:9.1pt;
margin-left:20.9pt'><img width=5 height=1
src="Excel%20VBA%20Notes%20for%20Professionals_files/image136.gif" align=left
hspace=12>FastWB() is a toggle that accepts On or Off flags</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:9.1pt;
margin-left:20.9pt'>FastWS() accepts an Optional WorkSheet object, or none</p>

<p class=MsoNormal align=right style='margin-top:0in;margin-right:51.05pt;
margin-bottom:17.4pt;margin-left:21.4pt;text-align:right;text-indent:-.5pt'>If
the ws parameter is missing it will turn all features on and off for all
WorkSheets in the collection</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:51.05pt'><img width=5 height=1
src="Excel%20VBA%20Notes%20for%20Professionals_files/image136.gif" align=left
hspace=12>A custom type can be used to capture all settings before turning them
off</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:34.9pt;
margin-left:51.05pt'>At the end of the process, the initial settings can be
restored</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Public</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>Sub</span></b><span style='font-size:9.0pt;line-height:110%'>
FastWB(</span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Optional</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;
line-height:110%'> opt </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>As</span></b><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:slateblue'>Boolean</span><span
style='font-size:9.0pt;line-height:110%'> = </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>True</span></b><span style='font-size:9.0pt;
line-height:110%'>)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>With</span></b><span
style='font-size:9.0pt;line-height:110%'> Application</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='position:relative;z-index:
-1895792640'><span style='left:0px;position:absolute;left:0px;top:-43873px;
width:718px;height:1px'><img width=718 height=1
src="Excel%20VBA%20Notes%20for%20Professionals_files/image224.gif"></span></span><span
style='font-size:9.0pt;line-height:110%'> .Calculation = </span><span
style='font-size:9.0pt;line-height:110%;color:#000066'>IIf</span><span
style='font-size:9.0pt;line-height:110%'>(opt, xlCalculationManual,
xlCalculationAutomatic)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>If</span></b><span style='font-size:9.0pt;line-height:110%'>
.DisplayAlerts &lt;&gt; </span><b><span style='font-size:9.0pt;line-height:
110%;color:blue'>Not</span></b><span style='font-size:9.0pt;line-height:110%'>
opt </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Then</span></b><span
style='font-size:9.0pt;line-height:110%'> .DisplayAlerts = </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Not</span></b><span
style='font-size:9.0pt;line-height:110%'> opt</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>If</span></b><span style='font-size:9.0pt;line-height:110%'>
.DisplayStatusBar &lt;&gt; </span><b><span style='font-size:9.0pt;line-height:
110%;color:blue'>Not</span></b><span style='font-size:9.0pt;line-height:110%'>
opt </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Then</span></b><span
style='font-size:9.0pt;line-height:110%'> .DisplayStatusBar = </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Not</span></b><span
style='font-size:9.0pt;line-height:110%'> opt</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>If</span></b><span style='font-size:9.0pt;line-height:110%'>
.EnableAnimations &lt;&gt; </span><b><span style='font-size:9.0pt;line-height:
110%;color:blue'>Not</span></b><span style='font-size:9.0pt;line-height:110%'>
opt </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Then</span></b><span
style='font-size:9.0pt;line-height:110%'> .EnableAnimations = </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Not</span></b><span
style='font-size:9.0pt;line-height:110%'> opt</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:167.6pt;margin-bottom:
.2pt;margin-left:3.5pt;text-indent:-.5pt'><span style='position:relative;
z-index:-1895791616'><span style='left:0px;position:absolute;left:0px;
top:-43943px;width:718px;height:1px'><img width=718 height=1
src="Excel%20VBA%20Notes%20for%20Professionals_files/image178.gif"></span></span><span
style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>If</span></b><span
style='font-size:9.0pt;line-height:110%'> .EnableEvents &lt;&gt; </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Not</span></b><span
style='font-size:9.0pt;line-height:110%'> opt </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Then</span></b><span style='font-size:9.0pt;
line-height:110%'> .EnableEvents = </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Not</span></b><span style='font-size:9.0pt;
line-height:110%'> opt </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>If</span></b><span style='font-size:9.0pt;
line-height:110%'> .ScreenUpdating &lt;&gt; </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Not</span></b><span style='font-size:9.0pt;
line-height:110%'> opt </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>Then</span></b><span style='font-size:9.0pt;line-height:110%'>
.ScreenUpdating = </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>Not</span></b><span style='font-size:9.0pt;line-height:110%'> opt</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>End</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>With</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> FastWS , opt</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=327
src="Excel%20VBA%20Notes%20for%20Professionals_files/image225.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>Restore all Excel settings to default</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
10.35pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=322
src="Excel%20VBA%20Notes%20for%20Professionals_files/image226.gif"></span></p>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc152207">Section 26.5: Checking time of execution</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>Different procedures can give out the same result, but they
would use different processing time. In order to check out which one is faster,
a code like this can be used:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=718 height=115
src="Excel%20VBA%20Notes%20for%20Professionals_files/image227.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=169
src="Excel%20VBA%20Notes%20for%20Professionals_files/image228.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:10.25pt;margin-bottom:
0in;margin-left:.75pt;text-align:justify;text-justify:inter-ideograph;
text-indent:-.5pt;line-height:110%'><a
href="https://msdn.microsoft.com/en-us/library/office/ff700515(v=office.14).aspx#Anchor_5"><span
style='color:#02723B'>MicroTimer</span></a>:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
10.35pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=720 height=240
src="Excel%20VBA%20Notes%20for%20Professionals_files/image229.gif"></span></p>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc152208">Section 26.6: Using With blocks</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>Using with blocks can accelerate the process of running a
macro. Instead writing a range, chart name, worksheet, etc. you can use
with-blocks like below;</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=109
src="Excel%20VBA%20Notes%20for%20Professionals_files/image230.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>Which is faster than this:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=76
src="Excel%20VBA%20Notes%20for%20Professionals_files/image231.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:13.3pt;
margin-left:.25pt'>Notes:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:9.5pt;
margin-left:30.0pt;text-indent:-9.1pt'><span style='font-size:11.0pt;
line-height:110%'><img border=0 width=5 height=5 id="Group 140164"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image003.gif"></span>Once
a With block is entered, object can't be changed. As a result, you can't use a
single With statement to affect a number of different objects</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:9.2pt;
margin-left:30.0pt;text-indent:-9.1pt;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=5 height=5 id="Group 140165"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image003.gif"></span><b>Don't
jump into or out of With blocks</b>. If statements in a With block are
executed, but either the With or End With statement is not executed, <b>a
temporary variable containing a reference to the object remains in memory until
you exit the procedure</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:9.1pt;
margin-left:20.9pt'><img width=5 height=1
src="Excel%20VBA%20Notes%20for%20Professionals_files/image232.gif" align=left
hspace=12>Don't Loop inside With statements, especially if the cached object is
used as an iterator</p>

<p class=MsoNormal align=right style='margin-top:0in;margin-right:-.75pt;
margin-bottom:.15pt;margin-left:21.4pt;text-align:right;text-indent:-.5pt'>You
can nest With statements by placing one With block within another. However,
because members of outer</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:19.95pt;
margin-left:30.0pt'>With blocks are masked within the inner With blocks, you
must provide a fully qualified object reference in an inner With block to any
member of an object in an outer With block.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.8pt;
margin-left:.25pt'>Nesting Example:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:100.85pt;margin-bottom:
14.1pt;margin-left:.25pt'>This example uses the With statement to execute a
series of statements on a single object. The object and its properties are
generic names used for illustration purposes only.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>With</span></b><span style='font-size:9.0pt;
line-height:110%'> MyObject</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.3pt;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> .Height = </span><span style='font-size:9.0pt;line-height:110%;
color:brown'>100</span><span style='font-size:9.0pt;line-height:110%'>
</span><i><span style='font-size:9.0pt;line-height:110%;color:green'>'Same as
MyObject.Height = 100.</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.3pt;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> .Caption = </span><span style='font-size:9.0pt;line-height:110%;
color:brown'>&quot;Hello World&quot;</span><span style='font-size:9.0pt;
line-height:110%'> </span><i><span style='font-size:9.0pt;line-height:110%;
color:green'>'Same as MyObject.Caption = &quot;Hello World&quot;.</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>With</span></b><span
style='font-size:9.0pt;line-height:110%'> .Font</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.3pt;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> .Color = Red </span><i><span style='font-size:9.0pt;
line-height:110%;color:green'>'Same as MyObject.Font.Color = Red.</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.3pt;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> .Bold = </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>True</span></b><span style='font-size:9.0pt;line-height:110%'>
</span><i><span style='font-size:9.0pt;line-height:110%;color:green'>'Same as
MyObject.Font.Bold = True.</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.3pt;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='position:relative;z-index:
-1895789568'><span style='left:0px;position:absolute;left:0px;top:-46169px;
width:718px;height:1px'><img width=718 height=1
src="Excel%20VBA%20Notes%20for%20Professionals_files/image233.gif"></span></span><span
style='font-size:9.0pt;line-height:110%'> MyObject.Height = </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>200</span><span
style='font-size:9.0pt;line-height:110%'> </span><i><span style='font-size:
9.0pt;line-height:110%;color:green'>'Inner-most With refers to MyObject.Font
(must be qualified</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>End</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>With</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:17.25pt;
margin-left:3.5pt;text-indent:-.5pt'><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>End</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>With</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>More Info on <a
href="https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/with-statement"><span
style='color:#02723B'>MSDN</span></a><br clear=all style='page-break-before:
always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc152209">Chapter 27: VBA Security</a></h1>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc152210">Section 27.1: Password Protect your VBA</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.45pt;
margin-left:.25pt'>Sometimes you have sensitive information in your VBA (e.g.,
passwords) that you don't want users to have access to. You can achieve basic
security on this information by password-protecting your VBA project.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:13.3pt;
margin-left:.25pt'>Follow these steps:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:110%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Open
your Visual Basic Editor (Alt + F11)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:110%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Navigate
to Tools -&gt; VBAProject Properties...</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:110%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Navigate
to the Protection tab</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:110%'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Check
off the &quot;Lock project for viewing&quot; checkbox</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.8pt;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:110%'>5.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Enter
your desired password in the Password and Confirm Password textboxes</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>Now when someone wants to access your code within an Office
application, they will first need to enter the password. Be aware, however,
that even a strong VBA project password is trivial to break.<br clear=all
style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc152211">Chapter 28: Debugging and
Troubleshooting</a></h1>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc152212">Section 28.1: Immediate Window</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.55pt;
margin-left:.25pt'>If you would like to test a line of macro code without
needing to run an entire sub, you can type commands directly into the Immediate
Window and hit <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>ENTER</span>
to run the line.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.5pt;
margin-left:.25pt'>For testing the output of a line, you can precede it with a
question mark <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>?</span>
to print directly to the Immediate Window. Alternatively, you can also use the <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>print</span>
command to have the output printed.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=58 style='width:.6in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=36 valign=top style='width:27.0pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>CTRL </span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;background:#FAFAFA'>+</span></p>
  </td>
  <td width=14 valign=top style='width:.15in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>G</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>While in the Visual Basic Editor, press to open the
Immediate Window. To rename your currently selected sheet to
&quot;ExampleSheet&quot;, type the following in the Immediate Window and hit <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>ENTER</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=26
src="Excel%20VBA%20Notes%20for%20Professionals_files/image234.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>To print the currently selected sheet's name directly in the
Immediate Window</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=43
src="Excel%20VBA%20Notes%20for%20Professionals_files/image235.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:14.1pt;
margin-left:.25pt'>This method can be very useful to test the functionality of
built in or user defined functions before implementing them in code. The
example below demonstrates how the Immediate Window can be used to test the
output of a function or series of functions to confirm an expected.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.3pt;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><i><span style='font-size:9.0pt;
line-height:110%;color:green'>'In this example, the Immediate Window was used
to confirm that a series of Left and Right</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.3pt;margin-bottom:12.55pt;
margin-left:3.5pt;text-indent:-.5pt'><i><span style='font-size:9.0pt;
line-height:110%;color:green'>'string methods would return the desired string</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:112.85pt;margin-bottom:
17.2pt;margin-left:3.5pt;text-indent:-.5pt'><span style='position:relative;
z-index:-1895788544'><span style='left:0px;position:absolute;left:0px;
top:-47135px;width:718px;height:1px'><img width=718 height=1
src="Excel%20VBA%20Notes%20for%20Professionals_files/image236.gif"></span></span><i><span
style='font-size:9.0pt;line-height:110%;color:green'>'expected output:
&quot;value&quot; </span></i><span style='font-size:9.0pt;line-height:110%'>print
</span><span style='font-size:9.0pt;line-height:110%;color:#000066'>Left</span><span
style='font-size:9.0pt;line-height:110%'>(</span><span style='font-size:9.0pt;
line-height:110%;color:#000066'>Right</span><span style='font-size:9.0pt;
line-height:110%'>(</span><span style='font-size:9.0pt;line-height:110%;
color:brown'>&quot;1111value1111&quot;</span><span style='font-size:9.0pt;
line-height:110%'>,</span><span style='font-size:9.0pt;line-height:110%;
color:brown'>9</span><span style='font-size:9.0pt;line-height:110%'>),</span><span
style='font-size:9.0pt;line-height:110%;color:brown'>5</span><span
style='font-size:9.0pt;line-height:110%'>) </span><i><span style='font-size:
9.0pt;line-height:110%;color:green'>' &lt;---- written code here, ENTER pressed
</span></i><span style='font-size:9.0pt;line-height:110%'>value
</span><i><span style='font-size:9.0pt;line-height:110%;color:green'>' &lt;----
output</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>The Immediate Window can also be used to set or reset
Application, Workbook, or other needed properties. This</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=230 style='width:2.4in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=79 valign=top style='width:59.4pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>Application</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;background:#FAFAFA'>.</span></p>
  </td>
  <td width=94 valign=top style='width:70.2pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>EnableEvents </span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;background:#FAFAFA'>=</span></p>
  </td>
  <td width=43 valign=top style='width:.45in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'></span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>False</span></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>can be useful if you have in a subroutine that unexpectedly
throws an error,</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:14.1pt;
margin-left:.25pt'>causing it to close without resetting the value to <b><span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>True</span></b>
(which can cause frustrating and unexpected functionality. In that case, the
commands can be typed directly into the Immediate Window and run:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.3pt;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'>? Application.EnableEvents </span><i><span style='font-size:9.0pt;
line-height:110%;color:green'>' &lt;---- Testing the current state of
&quot;EnableEvents&quot;</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.3pt;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>False</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><i><span style='font-size:
9.0pt;line-height:110%;color:green'>' &lt;---- Output</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.3pt;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'>Application.EnableEvents = </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>True</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><i><span style='font-size:9.0pt;line-height:110%;
color:green'>' &lt;---- Resetting the property value to True</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:65.55pt;margin-bottom:
17.2pt;margin-left:3.5pt;text-indent:-.5pt'><span style='position:relative;
z-index:-1895787520'><span style='left:0px;position:absolute;left:0px;
top:-47344px;width:718px;height:1px'><img width=718 height=1
src="Excel%20VBA%20Notes%20for%20Professionals_files/image213.gif"></span></span><span
style='font-size:9.0pt;line-height:110%'>? Application.EnableEvents </span><i><span
style='font-size:9.0pt;line-height:110%;color:green'>' &lt;---- Testing the
current state of &quot;EnableEvents&quot; </span></i><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>True</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><i><span
style='font-size:9.0pt;line-height:110%;color:green'>' &lt;---- Output</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>For more advanced debugging techniques, a colon <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>:</span> can be
used as a line separator. This can be used for multi-line expressions such as
looping in the example below.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=719 height=92
src="Excel%20VBA%20Notes%20for%20Professionals_files/image237.gif"></span></p>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc152213">Section 28.2: Use Timer to Find Bottlenecks in
Performance</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>The first step in optimizing for speed is finding the
slowest sections of code. The <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>Timer</span> VBA function returns the number of seconds
elapsed since midnight with a precision of 1/256th of a second (3.90625
milliseconds) on Windows based PCs. The VBA functions <span style='font-size:
9.0pt;line-height:110%;background:#FAFAFA'>Now</span> and <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Time</span> are
only accurate to a second.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
10.35pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=720 height=142
src="Excel%20VBA%20Notes%20for%20Professionals_files/image238.gif"></span></p>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc152214">Section 28.3: Debugger Locals Window</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.45pt;
margin-left:.25pt'>The Locals window provides easy access to the current value
of variables and objects within the scope of the function or subroutine you are
running. It is an essential tool to debugging your code and stepping through
changes in order to find issues. It also allows you to explore properties you
might not have known existed.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>Take the following example,</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=142
src="Excel%20VBA%20Notes%20for%20Professionals_files/image239.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>In the VBA Editor, click View --&gt; Locals Window</p>

<p class=MsoNormal style='margin-bottom:14.95pt;text-indent:0in;line-height:
107%'><img border=0 width=216 height=242 id="Picture 16649"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image240.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>Then by stepping through the code using F8 after clicking
inside the subroutine, we have stopped before getting to assigning
findMeinLocals. Below you can see the value is 0 --- and this is what would be
used if you never assigned it a value. The range object is 'Nothing'.</p>

<p class=MsoNormal style='margin-bottom:11.2pt;text-indent:0in;line-height:
107%'><img border=0 width=648 height=160 id="Picture 16672"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image241.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><img border=0
width=718 height=86 id="Picture 16674"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image242.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>If we stop right before the subroutine ends, we can see the
final values of the variables.</p>

<p class=MsoNormal style='margin-bottom:14.95pt;text-indent:0in;line-height:
107%'><img border=0 width=598 height=145 id="Picture 16677"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image243.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>We can see findMeInLocals with a value of 1 and type of
Integer, and FindMeInLocals2 with a type of Range/Range. If we click the + sign
we can expand the object and see its properties, such as count or column.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
10.35pt;margin-left:0in;text-indent:0in;line-height:107%'><img border=0
width=718 height=277 id="Picture 16681"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image244.jpg"></p>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc152215">Section 28.4: Debug.Print</a></h2>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=79 style='width:59.4pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=36 valign=top style='width:27.0pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>Debug</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;background:#FAFAFA'>.</span></p>
  </td>
  <td width=36 valign=top style='width:27.0pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>Print</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>To print a listing of the Error Code descriptions to the
Immediate Window, pass it to the function:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=718 height=125
src="Excel%20VBA%20Notes%20for%20Professionals_files/image245.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:13.05pt;
margin-left:.25pt'>You can show the Immediate Window by:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:248.3pt;margin-bottom:
.25pt;margin-left:.25pt;text-align:justify;text-justify:inter-ideograph;
text-indent:5.5pt;line-height:133%'><img width=5 height=1
src="Excel%20VBA%20Notes%20for%20Professionals_files/image136.gif" align=left
hspace=12>Selecting <b>V</b>iew | <b>I</b>mmediate Window from the menu bar
Using the keyboard shortcut <b>Ctrl-G</b></p>

<h2 style='margin-top:0in;margin-right:248.3pt;margin-bottom:.25pt;margin-left:
.25pt;text-align:justify;text-justify:inter-ideograph;text-indent:5.5pt;
line-height:133%'><a name="_Toc152216">Section 28.5: Stop</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>The Stop command will pause the execution when called. From
there, the process can be resumed or be executed step by step.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
10.35pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=720 height=109
src="Excel%20VBA%20Notes%20for%20Professionals_files/image246.gif"></span></p>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc152217">Section 28.6: Adding a Breakpoint to your code</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.45pt;
margin-left:.25pt'>You can easily add a breakpoint to your code by clicking on
the grey column to the left of the line of your VBA code where you want
execution to stop. A red dot appears in the column and the breakpoint code is
also highlighted in red.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>You can add multiple breakpoints throughout your code and
resuming execution is achieved by pressing the &quot;play&quot; icon in your
menu bar. Not all code can be a breakpoint as variable definition lines, the
first or last line of a procedure and comment lines cannot be selected as a
breakpoint.</p>

<p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><img
border=0 width=482 height=353 id="Picture 16807"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image247.jpg"></p>

<h1 style='margin-left:-.25pt'><a name="_Toc152218">Chapter 29: VBA Best
Practices</a></h1>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc152219">Section 29.1: ALWAYS Use &quot;Option
Explicit&quot;</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>In the VBA Editor window, from the Tools menu select
&quot;Options&quot;:</p>

<p class=MsoNormal style='margin-bottom:14.95pt;text-indent:0in;line-height:
107%'><img border=0 width=553 height=189 id="Picture 16828"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image248.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>Then in the &quot;Editor&quot; tab, make sure that
&quot;Require Variable Declaration&quot; is checked:</p>

<p class=MsoNormal style='margin-bottom:14.95pt;text-indent:0in;line-height:
107%'><img border=0 width=421 height=369 id="Picture 16831"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image249.jpg"></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=108 style='width:81.0pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=108 valign=top style='width:81.0pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Option</span></b><span style='font-size:
  9.0pt;line-height:107%'> Explicit</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:24.25pt;
margin-left:.25pt'>Selecting this option will automatically put at the top of
every VBA module.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:4.7pt;margin-bottom:23.95pt;
margin-left:24.0pt'><img width=3 height=1
src="Excel%20VBA%20Notes%20for%20Professionals_files/image200.gif" align=left
hspace=12><b>Small note:</b> This is true for the modules, class modules, etc.
that haven't been opened so far. So if you already had a look at e.g. the code
of <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Sheet1</span>
before activating the option &quot;Require Variable Declaration&quot;, <b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Option</span></b><span
style='font-size:9.0pt;line-height:110%'> Explicit</span> will not be added!</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=108 style='width:81.0pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=108 valign=top style='width:81.0pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Option</span></b><span style='font-size:
  9.0pt;line-height:107%'> Explicit</span></p>
  </td>
 </tr>
</table>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=108 style='width:81.0pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=108 valign=top style='width:81.0pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Option</span></b><span style='font-size:
  9.0pt;line-height:107%'> Explicit</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>requires that every variable has to be defined before use,
e.g. with a <b><span style='font-size:9.0pt;line-height:110%;color:blue;
background:#FAFAFA'>Dim</span></b> statement. Without enabled, any
unrecognized word will be assumed by the VBA compiler to be a new variable of
the</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=108 style='width:81.0pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=108 valign=top style='width:81.0pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Option</span></b><span style='font-size:
  9.0pt;line-height:107%'> Explicit</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:59.55pt;margin-bottom:
12.7pt;margin-left:.25pt'><span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>Variant</span> type, causing extremely difficult-to-spot
bugs related to typographical errors. With enabled, any unrecognized words will
cause a compile error to be thrown, indicating the offending line.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:.15pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'><b>Example :</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>If you run the following code :</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=76
src="Excel%20VBA%20Notes%20for%20Professionals_files/image250.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>You will get the following message :</p>

<p class=MsoNormal style='margin-bottom:15.15pt;text-indent:0in;line-height:
107%'><img border=0 width=143 height=151 id="Picture 16912"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image251.jpg"></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=108 style='width:81.0pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=108 valign=top style='width:81.0pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Option</span></b><span style='font-size:
  9.0pt;line-height:107%'> Explicit</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>You have made an error by writing <span style='font-size:
9.0pt;line-height:110%;background:#FAFAFA'>myvariable</span> instead of <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>my_variable</span>,
then the message box displays an empty variable. If you use , this error is
not possible because you will get a compile error message indicating the
problem.</p>

<p class=MsoNormal style='margin-bottom:14.95pt;text-indent:0in;line-height:
107%'><img border=0 width=349 height=298 id="Picture 16928"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image252.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>Now if you add the correct declaration :</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
15.1pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=92
src="Excel%20VBA%20Notes%20for%20Professionals_files/image253.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>You will obtain an error message indicating precisely the
error with <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>myvariable</span>
:</p>

<p class=MsoNormal style='margin-bottom:52.65pt;text-indent:0in;line-height:
107%'><img border=0 width=387 height=325 id="Picture 16976"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image254.jpg"></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=122 style='width:91.8pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=50 valign=top style='width:37.8pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Dim</span></b><span style='font-size:9.0pt;
  line-height:107%'> arr</span></p>
  </td>
  <td width=14 valign=top style='width:.15in;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;background:#FAFAFA'>()</span></p>
  </td>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'></span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>as</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><span style='font-size:9.0pt;line-height:107%;color:slateblue'>Long</span></p>
  </td>
 </tr>
</table>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=495 style='width:371.1pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>ReDim</span></b><span style='font-size:
  9.0pt;line-height:107%'> ar</span></p>
  </td>
  <td width=14 valign=top style='width:.15in;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;background:#FAFAFA'>()</span></p>
  </td>
  <td width=423 valign=top style='width:317.1pt;background:#FAFAFA;padding:
  1.8pt 0in 0in 0in;height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'></span><i><span style='font-size:9.0pt;line-height:
  107%;color:green'>'creates new array &quot;ar&quot; - &quot;ReDim ar()&quot;
  acts like &quot;Dim ar()&quot;</span></i></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:13.3pt;
margin-left:24.5pt;text-indent:-.5pt;line-height:107%'><img width=45 height=1
src="Excel%20VBA%20Notes%20for%20Professionals_files/image255.gif" align=left
hspace=12><b>Note on Option Explicit and Arrays</b> (<a
href="https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/declaring-arrays#declaring-a-dynamic-array"><span
style='color:#02723B'>Declaring a Dynamic Array</span></a>):</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.8pt;
margin-left:24.0pt'>You can use the ReDim statement to declare an array
implicitly within a procedure.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:9.1pt;
margin-left:15.75pt'>Be careful not to misspell the name of the array when you
use the ReDim statement</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:16.8pt;
margin-bottom:19.9pt;margin-left:21.4pt;text-align:center;text-indent:-.5pt'>Even
if the Option Explicit statement is included in the module, a new array will be
created</p>

<h2 style='margin-top:38.9pt;margin-right:1.3pt;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc152220">Section 29.2: Work with Arrays, Not With Ranges</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:10.25pt;margin-bottom:
12.9pt;margin-left:.75pt;text-align:justify;text-justify:inter-ideograph;
text-indent:-.5pt;line-height:110%'><a
href="https://blogs.office.com/2009/03/12/excel-vba-performance-coding-best-practices/"><span
style='color:#02723B'>Office Blog - Excel VBA Performance Coding Best Practices</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>Often, best performance is achieved by avoiding the use of <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Range</span> as
much as possible. In this example we read in an entire <span style='font-size:
9.0pt;line-height:110%;background:#FAFAFA'>Range</span> object into an array,
square each number in the array, and then return the array back to the <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Range</span>. This
accesses <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Range</span>
only twice, whereas a loop would access it 20 times for the read/writes.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=720 height=240
src="Excel%20VBA%20Notes%20for%20Professionals_files/image256.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=719 height=54
src="Excel%20VBA%20Notes%20for%20Professionals_files/image257.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:10.25pt;margin-bottom:
0in;margin-left:.75pt;text-align:justify;text-justify:inter-ideograph;
text-indent:-.5pt;line-height:134%'>More tips and info with timed examples can
be found in <a
href="https://fastexcel.wordpress.com/2011/05/25/writing-efficient-vba-udfs-part-1/"><span
style='color:#02723B'>Charles Williams's Writing efficient VBA UDFs (Part 1)</span></a>
and <a href="https://fastexcel.wordpress.com/page/2/?s=writing+efficient"><span
style='color:#02723B'>other articles in the series</span></a>.</p>

<h2 style='margin-top:0in;margin-right:10.25pt;margin-bottom:0in;margin-left:
.75pt;text-align:justify;text-justify:inter-ideograph;line-height:134%'><a
name="_Toc152221">Section 29.3: Switch o&#57379; properties during macro
execution</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>It is best practice in any programming language to <b>avoid
premature optimization.</b> However, if testing reveals that your code is
running too slowly, you may gain some speed by switching off some of the
application<span style='font-family:"Arial",sans-serif'></span>s properties
while it runs. Add this code to a standard module:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=339
src="Excel%20VBA%20Notes%20for%20Professionals_files/image258.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:208.35pt;margin-bottom:
0in;margin-left:0in;text-indent:0in;line-height:214%'><i>More info on </i><a
href="https://blogs.office.com/2009/03/12/excel-vba-performance-coding-best-practices/"><i><span
style='color:#02723B'>Office Blog - Excel VBA Performance Coding Best Practices
</span></i></a>And just call it at beginning and end of macros:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=720 height=223
src="Excel%20VBA%20Notes%20for%20Professionals_files/image259.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=72 style='width:.75in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=72 valign=top style='width:.75in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Public</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Sub</span></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>While these can largely be considered
&quot;enhancements&quot; for regular procedures, disabling event</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=230 style='width:2.4in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=79 valign=top style='width:59.4pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>Application</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;background:#FAFAFA'>.</span></p>
  </td>
  <td width=94 valign=top style='width:70.2pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>EnableEvents </span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;background:#FAFAFA'>=</span></p>
  </td>
  <td width=43 valign=top style='width:.45in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'></span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>False</span></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>handling with should be considered mandatory for <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Worksheet_Change</span>
and</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'><span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>Workbook_SheetChange</span> private event macros that change values on
one or more worksheets. Failure to disable event triggers will cause the event
macro to recursively run on top of itself when a value changes and can lead to
a &quot;frozen&quot; workbook. Remember to turn events back on before leaving
the event macro, possibly through a &quot;safe exit&quot; error handler.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
15.2pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=223
src="Excel%20VBA%20Notes%20for%20Professionals_files/image260.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=86 style='width:.9in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=86 valign=top style='width:.9in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>SpeedUp </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>True</span></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.55pt;margin-bottom:10.15pt;
margin-left:.75pt;text-align:justify;text-justify:inter-ideograph;text-indent:
-.5pt;line-height:133%'><b>One caveat:</b> While disabling these settings will
improve run time, they may make debugging your application much more difficult.
If your code is <i>not</i> functioning correctly, comment out the call until
you figure out the problem.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=151 style='width:113.4pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=79 valign=top style='width:59.4pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>Application</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;background:#FAFAFA'>.</span></p>
  </td>
  <td width=65 valign=top style='width:48.6pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>Calculate</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.8pt;
margin-left:.25pt'>This is particularly important if you are writing to cells
in a worksheet and then reading back in calculated results from worksheet
functions since the <span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>xlCalculationManual</span> prevents the workbook from calculating. To
get around this without disabling <span style='font-size:9.0pt;line-height:
110%;background:#FAFAFA'>SpeedUp</span>, you may want to include to run a
calculation at specific points.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'><b>NOTE:</b> Since these are properties of the <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Application</span>
itself, you need to ensure that they are enabled again before your macro exits.
This makes it particularly important to use error handlers and to avoid
multiple exit points (i.e.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=65 style='width:48.6pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=65 valign=top style='width:48.6pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>Unload </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Me</span></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:13.1pt;
margin-left:.25pt'><b><span style='font-size:9.0pt;line-height:110%;color:blue;
background:#FAFAFA'>End</span></b> or ).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>With error handling:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
10.35pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=289
src="Excel%20VBA%20Notes%20for%20Professionals_files/image261.gif"></span></p>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:0in;margin-left:
-.25pt'><a name="_Toc152222">Section 29.4: Use VB constants when available</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=26
src="Excel%20VBA%20Notes%20for%20Professionals_files/image262.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>can be used in place of</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=26
src="Excel%20VBA%20Notes%20for%20Professionals_files/image263.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>in order to improve readability.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>Use <i>Object Browser</i> to find available VB constants. <i>View
</i><span style='font-family:"Arial",sans-serif'>&#8594;</span><i> Object
Browser</i> or <span style='border:solid black 1.5pt;padding:0in'>F2 </span>from
VB Editor.</p>

<p class=MsoNormal style='margin-bottom:14.95pt;text-indent:0in;line-height:
107%'><img border=0 width=320 height=213 id="Picture 17620"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image264.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>Enter class to search</p>

<p class=MsoNormal style='margin-bottom:14.95pt;text-indent:0in;line-height:
107%'><img border=0 width=310 height=57 id="Picture 17623"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image265.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>View members available</p>

<p class=MsoNormal style='margin-bottom:10.35pt;text-indent:0in;line-height:
107%'><img border=0 width=640 height=386 id="Picture 17626"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image266.jpg"></p>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc152223">Section 29.5: Avoid using SELECT or ACTIVATE</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.4pt;
margin-left:.25pt'>It is <b>very</b> rare that you'll ever want to use <b><span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>SELECT</span></b>
or <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Activate</span>
in your code, but some Excel methods do require a worksheet or workbook to be
activated before they'll work as expected.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>If you're just starting to learn VBA, you'll often be
suggested to record your actions using the macro recorder, then go look at the
code. For example, I recorded actions taken to enter a value in cell D3 on
Sheet2, and the macro code looks like this:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=718 height=49
src="Excel%20VBA%20Notes%20for%20Professionals_files/image267.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=169
src="Excel%20VBA%20Notes%20for%20Professionals_files/image268.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=166 style='width:124.2pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=43 valign=top style='width:.45in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>Sheets</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;background:#FAFAFA'>(</span></p>
  </td>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:brown'>&quot;Sheet2&quot;</span></p>
  </td>
  <td width=14 valign=top style='width:.15in;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;background:#FAFAFA'>).</span></p>
  </td>
  <td width=43 valign=top style='width:.45in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Select</span></b></p>
  </td>
 </tr>
</table>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=130 style='width:1.35in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=36 valign=top style='width:27.0pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>Range</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;background:#FAFAFA'>(</span></p>
  </td>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:brown'>&quot;D3&quot;</span></p>
  </td>
  <td width=14 valign=top style='width:.15in;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;background:#FAFAFA'>).</span></p>
  </td>
  <td width=43 valign=top style='width:.45in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Select</span></b></p>
  </td>
 </tr>
</table>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=130 style='width:1.35in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=36 valign=top style='width:27.0pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>Range</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;background:#FAFAFA'>(</span></p>
  </td>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:brown'>&quot;D4&quot;</span></p>
  </td>
  <td width=14 valign=top style='width:.15in;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;background:#FAFAFA'>).</span></p>
  </td>
  <td width=43 valign=top style='width:.45in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Select</span></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:6.45pt;margin-bottom:
12.5pt;margin-left:.25pt'>Remember though, the macro recorder creates a line of
code for EACH of your (user) actions. This includes clicking on the worksheet
tab to select Sheet2 (), clicking on cell D3 before entering the value (), and
using the Enter key (which is effectively &quot;selecting&quot; the cell below
the currently selected cell: ).</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=43 style='width:.45in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=43 valign=top style='width:.45in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Select</span></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:13.05pt;
margin-left:.25pt'>There are multiple issues with using <span style='font-size:
9.0pt;line-height:110%;background:#FAFAFA'>.</span> here:</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=345 style='width:258.5pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=43 valign=top style='width:.45in;background:#FAFAFA;padding:1.0pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Select</span></b></p>
  </td>
  <td width=114 valign=top style='width:85.7pt;padding:1.0pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;background:#FAFAFA'>()</span> is slow.</b> Even if </p>
  </td>
  <td width=79 valign=top style='width:59.4pt;background:#FAFAFA;padding:1.0pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>Application</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.0pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;background:#FAFAFA'>.</span></p>
  </td>
  <td width=101 valign=top style='width:1.05in;background:#FAFAFA;padding:1.0pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>ScreenUpdating</span></p>
  </td>
 </tr>
</table>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=325 style='width:244.05pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=43 valign=top style='width:.45in;background:#FAFAFA;padding:1.05pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Select</span></b></p>
  </td>
  <td width=95 valign=top style='width:71.25pt;padding:1.05pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;background:#FAFAFA'>()</span> is unruly.</b> If </p>
  </td>
  <td width=79 valign=top style='width:59.4pt;background:#FAFAFA;padding:1.05pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>Application</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.05pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;background:#FAFAFA'>.</span></p>
  </td>
  <td width=101 valign=top style='width:1.05in;background:#FAFAFA;padding:1.05pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>ScreenUpdating</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:20.9pt'><img width=5 height=1
src="Excel%20VBA%20Notes%20for%20Professionals_files/image172.gif" align=left
hspace=12><b>The worksheet is not always specified.</b> This happens if you
don't switch worksheets while recording, and means that the code will yield
different results for different active worksheets.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:20.9pt'><b><span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>.</span></b> is set to <b><span style='font-size:9.0pt;
line-height:110%;color:blue;background:#FAFAFA'>False</span></b>, this is an
unneccessary operation to be processed.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:20.9pt'><b><span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>.</span></b> is left to <b><span style='font-size:9.0pt;
line-height:110%;color:blue;background:#FAFAFA'>True</span></b>, Excel will
actually select the cells, the</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:30.0pt'>worksheet, the form... whatever it is you're working with.
This is stressful to the eyes and really unpleasant to watch.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=43 style='width:.45in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=43 valign=top style='width:.45in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Select</span></b></p>
  </td>
 </tr>
</table>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=180 style='width:135.0pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=180 valign=top style='width:135.0pt;background:#FAFAFA;padding:
  1.8pt 0in 0in 0in;height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>Worksheet_SelectionChange</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:10.15pt;margin-bottom:
12.55pt;margin-left:165.0pt;text-indent:-144.1pt'><span style='font-size:11.0pt;
line-height:110%'><img border=0 width=5 height=5 id="Group 147431"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image003.gif"></span><b><span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>. ()</span>
will trigger listeners.</b> This is a bit advanced already, but unless worked
around, functions like <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>()</span> will be triggered.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>When you're coding in VBA, all of the &quot;typing&quot;
actions (i.e. <b><span style='font-size:9.0pt;line-height:110%;color:blue;
background:#FAFAFA'>SELECT</span></b> statements) are no longer necessary. Your
code may be reduced to a single statement to put the value in the cell:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=223
src="Excel%20VBA%20Notes%20for%20Professionals_files/image269.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.45pt;
margin-left:.25pt'>(The BETTER example above shows using intermediate variables
to separate different parts of the cell reference. The GOOD example will always
work just fine, but can be very cumbersome in much longer code modules and more
difficult to debug if one of the references is mistyped.)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.6pt;
margin-left:.25pt'>**NOTE: the macro recorder makes many assumptions about the
type of data you're entering, in this case entering a string value as a formula
to create the value. Your code doesn't have to do this and can simply assign a
numerical value directly to the cell as shown above.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:18.2pt;
margin-left:.25pt'>**NOTE2: the recommended practice is to set your local
workbook variable to <span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>ThisWorkbook</span> instead of <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>ActiveWorkbook</span> (unless you
explicitly need it). The reason is your macro will generally need/use resources
in whatever workbook the VBA code originates and will NOT look outside of that
workbook -- again, unless you explicitly direct your code to work with another
workbook. When you have multiple workbooks open in Excel, the <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>ActiveWorkbook</span>
is the one with the focus <i>which may be different from the workbook being
viewed in your VBA Editor</i>. So you think you're executing in a one workbook
when you're really referencing another. <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>ThisWorkbook</span> refers to the workbook
containing the code being executed.</p>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc152224">Section 29.6: Always define and set references to
all Workbooks and Sheets</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:13.0pt;
margin-left:.25pt'>When working with multiple open Workbooks, each of which may
have multiple Sheets, it<span style='font-family:"Arial",sans-serif'></span>s
safest to define and set reference to all Workbooks and Sheets.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:13.5pt;
margin-left:.25pt'><b>Don't rely</b> on <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>ActiveWorkbook</span> or <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>ActiveSheet</span>
as they might be changed by the user.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.5pt;
margin-left:.25pt'>The following code example demonstrates how to copy a range
from <span style='font-family:"Arial",sans-serif'></span><i>Raw_Data</i><span
style='font-family:"Arial",sans-serif'></span> sheet in the <span
style='font-family:"Arial",sans-serif'></span><i>Data.xlsx</i><span
style='font-family:"Arial",sans-serif'></span> workbook to <span
style='font-family:"Arial",sans-serif'></span><i>Refined_Data</i><span
style='font-family:"Arial",sans-serif'></span> sheet in the <span
style='font-family:"Arial",sans-serif'></span><i>Results.xlsx</i><span
style='font-family:"Arial",sans-serif'></span> workbook.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>The procedure also demonstrates how to copy and paste
without using the <b><span style='font-size:9.0pt;line-height:110%;color:blue;
background:#FAFAFA'>SELECT</span></b> method.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
10.35pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=720 height=388
src="Excel%20VBA%20Notes%20for%20Professionals_files/image270.gif"></span></p>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc152225">Section 29.7: Use descriptive variable naming</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>Descriptive names and structure in your code help make
comments unnecessary</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=92
src="Excel%20VBA%20Notes%20for%20Professionals_files/image271.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>is better than</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=718 height=60
src="Excel%20VBA%20Notes%20for%20Professionals_files/image272.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>This is especially helpful when you are copying data from
one place to another, whether it's a cell, range, worksheet, or workbook. Help
yourself by using names such as these:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=207
src="Excel%20VBA%20Notes%20for%20Professionals_files/image273.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>If you declare multiple variables in one line make sure to
specify a type for <i>every</i> variable like:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
15.05pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=26
src="Excel%20VBA%20Notes%20for%20Professionals_files/image274.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>The following will only declare the last variable and the
first ones will remain <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>Variant</span>:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
10.35pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=26
src="Excel%20VBA%20Notes%20for%20Professionals_files/image275.gif"></span></p>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc152226">Section 29.8: Document Your Work</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>It's good practice to document your work for later use,
especially if you are coding for a dynamic workload. Good comments should
explain why the code is doing something, not what the code is doing.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=125
src="Excel%20VBA%20Notes%20for%20Professionals_files/image276.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>If your code is so obscure that it requires comments to
explain what it is doing, consider rewriting it to be more clear instead of
explaining it through comments. For example, instead of:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=720 height=142
src="Excel%20VBA%20Notes%20for%20Professionals_files/image277.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>Clarify the code to be easier to follow, such as:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=718 height=115
src="Excel%20VBA%20Notes%20for%20Professionals_files/image278.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
10.35pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=104
src="Excel%20VBA%20Notes%20for%20Professionals_files/image279.gif"></span></p>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc152227">Section 29.9: Error Handling</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.45pt;
margin-left:.25pt'>Good error handling prevents end users from seeing VBA
runtime errors and helps the developer easily diagnose and correct errors.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>There are three main methods of Error Handling in VBA, two
of which should be avoided for distributed programs unless specifically
required in the code.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=26
src="Excel%20VBA%20Notes%20for%20Professionals_files/image280.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>or</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=26
src="Excel%20VBA%20Notes%20for%20Professionals_files/image281.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>Prefer using:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
19.05pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=26
src="Excel%20VBA%20Notes%20for%20Professionals_files/image282.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:13.05pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'><b>On Error GoTo 0</b></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=101 style='width:1.05in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=101 valign=top style='width:1.05in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>On</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Error</span></b><span style='font-size:9.0pt;line-height:107%'> </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>GoTo</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:27.75pt;
margin-left:.25pt'>If no error handling is set in your code, <span
style='font-size:9.0pt;line-height:110%;color:brown;background:#FAFAFA'>0</span>
is the default error handler. In this mode, any runtime errors will launch the
typical VBA error message, allowing you to either end the code or enter <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>debug</span> mode,
identifying the source. While writing code, this method is the simplest and
most useful, but it should always be avoided for code that is distributed to
end users, as this method is very unsightly and difficult for end users to
understand.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:13.5pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'><b>On Error Resume Next</b></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=122 style='width:91.8pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=122 valign=top style='width:91.8pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Error</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Resume</span></b><span style='font-size:9.0pt;line-height:
  107%'> </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Next</span></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'><b><span style='font-size:9.0pt;line-height:110%;color:blue'>On</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Error</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>Resume</span></b><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Next</span></b> will cause
VBA to ignore any errors that are thrown at runtime for all lines following the
error call until the error handler has been changed. In very specific
instances, this line can be useful, but it should be avoided outside of these
cases. For example, when launching a separate program from an Excel Macro, the <b><span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>On </span></b>call
can be useful if you are unsure whether or not the program is already open:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=720 height=240
src="Excel%20VBA%20Notes%20for%20Professionals_files/image283.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=144 style='width:1.5in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=144 valign=top style='width:1.5in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>On</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Error</span></b><span style='font-size:9.0pt;line-height:107%'> </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Resume</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Next</span></b></p>
  </td>
 </tr>
</table>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=144 style='width:1.5in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=144 valign=top style='width:1.5in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>On</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Error</span></b><span style='font-size:9.0pt;line-height:107%'> </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Resume</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Next</span></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.7pt;
margin-left:.25pt'>Had we not used the call and the Powerpoint application was
not already open, the <span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>GetObject</span> method would throw an error. Thus, was necessary to
avoid creating two instances of the application.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=58 style='width:.6in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>On</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Error</span></b></p>
  </td>
 </tr>
</table>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=79 style='width:59.4pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=79 valign=top style='width:59.4pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Resume</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Next</span></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:13.8pt;margin-bottom:
27.7pt;margin-left:59.65pt;text-indent:-59.4pt'><b>Note:</b> It is also a best
practice to <i>immediately</i> reset the error handler as soon as you no longer
need the call</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:13.3pt;
margin-left:.75pt;text-indent:-.5pt;line-height:107%'><b>On Error GoTo
&lt;line&gt;</b></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=137 style='width:102.6pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=101 valign=top style='width:1.05in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>On</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Error</span></b><span style='font-size:9.0pt;line-height:107%'> </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>GoTo</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;background:#FAFAFA'>&lt;</span>&nbsp;</p>
  </td>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>line</span></p>
  </td>
 </tr>
</table>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=137 style='width:102.6pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=101 valign=top style='width:1.05in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>On</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Error</span></b><span style='font-size:9.0pt;line-height:107%'> </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>GoTo</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;background:#FAFAFA'>&lt;</span>&nbsp;</p>
  </td>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>line</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.7pt;
margin-left:.25pt'>This method of error handling is recommended for all code
that is distributed to other users. This allows the programmer to control
exactly how VBA handles an error by sending the code to the specified line. The
tag can be filled with any string (including numeric strings), and will send
the code to the corresponding string that is followed by a colon. Multiple
error handling blocks can be used by making different calls of <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>&gt;</span>. The
subroutine below demonstrates the syntax of an <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>&gt;</span> call.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=58 style='width:.6in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Exit</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Sub</span></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'><b>Note:</b> It is essential that the line is placed above
the first error handler and before every subsequent error handler to prevent
the code from naturally progressing into the block <i>without</i> an error
being called. Thus, it is best practice for function and readability to place
error handlers at the end of a code block.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=720 height=453
src="Excel%20VBA%20Notes%20for%20Professionals_files/image284.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.8pt;
margin-left:.25pt'>If you exit your method with your error handling code,
ensure that you clean up:</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=50 style='width:37.8pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=50 valign=top style='width:37.8pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>End</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Sub</span></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:20.9pt'><img width=5 height=1
src="Excel%20VBA%20Notes%20for%20Professionals_files/image136.gif" align=left
hspace=12>Undo anything that is partially completed</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:20.9pt'>Close files</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:20.9pt'>Reset screen updating</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:20.9pt'>Reset calculation mode</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:20.9pt'>Reset events</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:20.9pt'>Reset mouse pointer</p>

<p class=MsoNormal style='margin-top:0in;margin-right:167.05pt;margin-bottom:
1.5pt;margin-left:20.9pt'>Call unload method on instances of objects, that
persist after the </p>

<p class=MsoNormal style='margin-top:0in;margin-right:158.7pt;margin-bottom:
0in;margin-left:-.75pt;text-indent:20.9pt;line-height:145%'><span
style='font-size:11.0pt;line-height:145%'><img border=0 width=5 height=5
id="Group 141734"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image003.gif"></span>Reset
status bar</p>

<h2 style='margin-top:0in;margin-right:158.7pt;margin-bottom:0in;margin-left:
-.75pt;text-indent:20.9pt;line-height:145%'><a name="_Toc152228">Section 29.10:
Never Assume The Worksheet</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.45pt;
margin-left:.25pt'>Even when all your work is directed at a single worksheet,
it's still a very good practice to explicitly specify the worksheet in your
code. This habit makes it much easier to expand your code later, or to lift
parts (or all) of a <b><span style='font-size:9.0pt;line-height:110%;
color:blue;background:#FAFAFA'>Sub</span></b> or <b><span style='font-size:
9.0pt;line-height:110%;color:blue;background:#FAFAFA'>Function</span></b> to be
re-used someplace else. Many developers establish a habit of (re)using the same
local variable name for a worksheet in their code, making re-use of that code
even more straightforward.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>As an example, the following code is ambiguous -- but works!
-- as long the developer doesn't activate or change to a different worksheet:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
15.0pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=92
src="Excel%20VBA%20Notes%20for%20Professionals_files/image285.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.45pt;
margin-left:.25pt'>If <span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>Sheet1</span> is active, then cell A1 on Sheet1 will be filled with
the current date and time. But if the user changes worksheets for any reason,
then the code will update whatever the worksheet is currently active. The
destination worksheet is ambiguous.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>The best practice is to always identify which worksheet to
which your code refers:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=158
src="Excel%20VBA%20Notes%20for%20Professionals_files/image286.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:18.2pt;
margin-left:.25pt'>The code above is clear in identifying both the workbook and
the worksheet. While it may seem like overkill, creating a good habit
concerning target references will save you from future problems.</p>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc152229">Section 29.11: Avoid re-purposing the names of
Properties or Methods as your variables</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.7pt;
margin-left:.25pt'>It is generally not considered 'best practice' to re-purpose
the reserved names of Properties or Methods as the name(s) of your own
procedures and variables.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'><b>Bad Form</b> - While the following is (strictly speaking)
legal, working code the re-purposing of the <a
href="https://msdn.microsoft.com/en-us/library/office/ff839746.aspx"><span
style='color:#02723B'>Find</span></a> method as well as the <a
href="https://msdn.microsoft.com/en-us/library/office/ff196952.aspx"><span
style='color:#02723B'>Row</span></a>, <a
href="https://msdn.microsoft.com/en-us/library/office/ff198200.aspx"><span
style='color:#02723B'>Column</span></a> and <a
href="https://msdn.microsoft.com/en-us/library/office/ff837625.aspx"><span
style='color:#02723B'>Address</span></a> properties can cause
problems/conflicts with name ambiguity and is just plain confusing in general.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=718 height=161
src="Excel%20VBA%20Notes%20for%20Professionals_files/image287.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:52.4pt;margin-bottom:
.2pt;margin-left:3.5pt;text-indent:-.5pt'><span style='position:relative;
z-index:-1895781376'><span style='left:0px;position:absolute;left:0px;
top:-62008px;width:718px;height:1px'><img width=718 height=1
src="Excel%20VBA%20Notes%20for%20Professionals_files/image178.gif"></span></span><span
style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Set</span></b><span
style='font-size:9.0pt;line-height:110%'> address =
.SpecialCells(xlCellTypeLastCell) row = .find(what:=find,
after:=address).row </span><i><span style='font-size:9.0pt;line-height:
110%;color:green'>'&lt; note .row not capitalized </span></i><span
style='font-size:9.0pt;line-height:110%'>column = .find(what:=find,
after:=address).column </span><i><span style='font-size:9.0pt;line-height:
110%;color:green'>'&lt; note .column not capitalized </span></i><span
style='font-size:9.0pt;line-height:110%'></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> Debug.Print </span><span style='font-size:9.0pt;line-height:110%;
color:brown'>&quot;The first 'something' is in &quot;</span><span
style='font-size:9.0pt;line-height:110%'> &amp; .Cells(row, column).address(</span><span
style='font-size:9.0pt;line-height:110%;color:brown'>0</span><span
style='font-size:9.0pt;line-height:110%'>, </span><span style='font-size:9.0pt;
line-height:110%;color:brown'>0</span><span style='font-size:9.0pt;line-height:
110%'>)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>End</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>With</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:17.5pt;
margin-left:3.5pt;text-indent:-.5pt'><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>End</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>Sub</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'><b>Good Form</b> - With all of the reserved words renamed
into close but unique approximations of the originals, any potential naming
conflicts have been avoided.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=277
src="Excel%20VBA%20Notes%20for%20Professionals_files/image288.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:44.45pt;
margin-left:.25pt'>While there may come a time when you want to intentionally
rewrite a standard method or property to your own specifications, those
situations are few and far between. For the most part, stay away from reusing
reserved names for your own constructs.</p>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc152230">Section 29.12: Avoid using ActiveCell or
ActiveSheet in Excel</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:14.1pt;
margin-left:.25pt'>Using <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>ActiveCell</span> or <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>ActiveSheet</span> can be source of
mistakes if (for any reason) the code is executed in the wrong place.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'>ActiveCell.Value = </span><span style='font-size:9.0pt;line-height:110%;
color:brown'>&quot;Hello&quot;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.3pt;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><i><span style='font-size:9.0pt;
line-height:110%;color:green'>'will place &quot;Hello&quot; in the cell that is
currently selected</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'>Cells(</span><span style='font-size:9.0pt;line-height:110%;color:brown'>1</span><span
style='font-size:9.0pt;line-height:110%'>, </span><span style='font-size:9.0pt;
line-height:110%;color:brown'>1</span><span style='font-size:9.0pt;line-height:
110%'>).Value = </span><span style='font-size:9.0pt;line-height:110%;
color:brown'>&quot;Hello&quot;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.3pt;margin-bottom:12.55pt;
margin-left:3.5pt;text-indent:-.5pt'><i><span style='font-size:9.0pt;
line-height:110%;color:green'>'will always place &quot;Hello&quot; in A1 of the
currently selected sheet</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'>ActiveSheet.Cells(</span><span style='font-size:9.0pt;line-height:110%;
color:brown'>1</span><span style='font-size:9.0pt;line-height:110%'>, </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>1</span><span
style='font-size:9.0pt;line-height:110%'>).Value = </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>&quot;Hello&quot;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.3pt;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><i><span style='font-size:9.0pt;
line-height:110%;color:green'>'will place &quot;Hello&quot; in A1 of the
currently selected sheet</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'>Sheets(</span><span style='font-size:9.0pt;line-height:110%;color:brown'>&quot;MySheetName&quot;</span><span
style='font-size:9.0pt;line-height:110%'>).Cells(</span><span style='font-size:
9.0pt;line-height:110%;color:brown'>1</span><span style='font-size:9.0pt;
line-height:110%'>, </span><span style='font-size:9.0pt;line-height:110%;
color:brown'>1</span><span style='font-size:9.0pt;line-height:110%'>).Value = </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>&quot;Hello&quot;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.3pt;margin-bottom:.2in;
margin-left:3.5pt;text-indent:-.5pt'><i><span style='font-size:9.0pt;
line-height:110%;color:green'>'will always place &quot;Hello&quot; in A1 of the
sheet named &quot;MySheetName&quot;</span></i></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=43 style='width:.45in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=43 valign=top style='width:.45in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>Active</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:30.0pt'><span style='position:relative;z-index:-1895780352'><span
style='left:0px;position:absolute;left:0px;top:-62804px;width:718px;height:
1px'><img width=718 height=1
src="Excel%20VBA%20Notes%20for%20Professionals_files/image289.gif"></span></span>The
use of <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>*</span>
can create problems in long running macros if your user gets bored and clicks
on another worksheet or opens another workbook.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:30.0pt'>It can create problems if your code opens or creates
another workbook.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=209 style='width:156.6pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=43 valign=top style='width:.45in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>Sheets</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;background:#FAFAFA'>(</span></p>
  </td>
  <td width=101 valign=top style='width:1.05in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:brown'>&quot;MyOtherSheet&quot;</span></p>
  </td>
  <td width=14 valign=top style='width:.15in;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;background:#FAFAFA'>).</span></p>
  </td>
  <td width=43 valign=top style='width:.45in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Select</span></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:30.0pt'>It can create problems if your code uses and you've
forgotten which sheet you were on before you start reading from or writing to
it.</p>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc152231">Section 29.13: WorksheetFunction object executes
faster than a UDF equivalent</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.45pt;
margin-left:.25pt'>VBA is compiled in run-time, which has a huge negative
impact on it's performance, everything built-in will be faster, try to use
them.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.45pt;
margin-left:.25pt'>As an example I'm comparing SUM and COUNTIF functions, but
you can use if for anything you can solve with WorkSheetFunctions.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>A first attempt for those would be to loop through the range
and process it cell by cell (using a range):</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=256
src="Excel%20VBA%20Notes%20for%20Professionals_files/image290.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>One improvement can be to store the range values in an array
and process that:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=289
src="Excel%20VBA%20Notes%20for%20Professionals_files/image291.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=209 style='width:156.6pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=79 valign=top style='width:59.4pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>Application</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;background:#FAFAFA'>.</span></p>
  </td>
  <td width=122 valign=top style='width:91.8pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>Worksheetfunction</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>But instead of writing any loop you can use which is very
handy for executing simple formulas:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=718 height=157
src="Excel%20VBA%20Notes%20for%20Professionals_files/image292.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=38
src="Excel%20VBA%20Notes%20for%20Professionals_files/image293.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=144 style='width:1.5in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=79 valign=top style='width:59.4pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>Application</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;background:#FAFAFA'>.</span></p>
  </td>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>Evaluate</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>Or, for more complex calculations you can even use :</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=207
src="Excel%20VBA%20Notes%20for%20Professionals_files/image294.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:13.0pt;
margin-left:.25pt'>And finally, running above Subs 25,000 times each, here is
the average (5 tests) time in milliseconds (of course it'll be different on
each pc, but compared to each other they'll behave similarly):</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:110%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>UseWorksheetFunction:
2156 ms</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:110%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>UseArray:
2219 ms (+ 3 %)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:110%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>UseEvaluate:
4693 ms (+ 118 %)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:110%'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>UseRange:
6530 ms (+ 203 %)<br clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc152232">Chapter 30: Excel VBA Tips
and Tricks</a></h1>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc152233">Section 30.1: Using xlVeryHidden Sheets</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:13.55pt;
margin-left:.25pt'>Worksheets in excel have three options for the <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Visible</span>
property. These options are represented by constants in the <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>xlSheetVisibility</span>
enumeration and are as follows:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:2.9pt;
margin-left:29.25pt;text-indent:-13.9pt'><span style='line-height:110%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>xlVisible</span> or
<span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>xlSheetVisible</span>
value: <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>-1</span>
(the default for new sheets)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:3.65pt;
margin-left:29.25pt;text-indent:-13.9pt;line-height:107%'><span
style='line-height:107%'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-size:9.0pt;line-height:107%;background:#FAFAFA'>xlHidden</span>
or <span style='font-size:9.0pt;line-height:107%;background:#FAFAFA'>xlSheetHidden</span>
value: <span style='font-size:9.0pt;line-height:107%;background:#FAFAFA'>0</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.6pt;
margin-left:29.25pt;text-indent:-13.9pt;line-height:107%'><span
style='line-height:107%'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span style='font-size:9.0pt;line-height:107%;background:#FAFAFA'>xlVeryHidden</span>
<span style='font-size:9.0pt;line-height:107%;background:#FAFAFA'>xlSheetVeryHidden</span>
value: <span style='font-size:9.0pt;line-height:107%;background:#FAFAFA'>2</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.45pt;
margin-left:.25pt'>Visible sheets represent the default visibility for sheets.
They are visible in the sheet tab bar and can be freely selected and viewed.
Hidden sheets are hidden from the sheet tab bar and are thus not selectable.
However, hidden sheets can be unhidden from the excel window by right clicking
on the sheet tabs and selecting &quot;Unhide&quot;</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.45pt;
margin-left:.25pt'>Very Hidden sheets, on the other hand, are <i>only</i>
accessible through the Visual Basic Editor. This makes them an incredibly
useful tool for storing data across instances of excel as well as storing data
that should be hidden from end users. The sheets can be accessed by named
reference within VBA code, allowing easy use of the stored data.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:29.3pt;margin-bottom:
1.5pt;margin-left:.25pt'>To manually change a worksheet's .Visible property to
xlSheetVeryHidden, open the VBE's Properties window (<span style='border:solid black 1.5pt;
padding:0in'> F4 </span>), select the worksheet you want to change and use the
drop-down in the thirteenth row to make your selection.</p>

<p class=MsoNormal style='margin-bottom:15.2pt;text-indent:0in;line-height:
107%'><img border=0 width=375 height=395 id="Picture 19822"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image295.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>To change a worksheet's .Visible property to
xlSheetVeryHidden<span style='font-family:"Arial",sans-serif'></span> in code,
similarly access the .Visible property and assign a new value.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
15.2pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=60
src="Excel%20VBA%20Notes%20for%20Professionals_files/image296.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'><span style='font-family:"Arial",sans-serif'></span> Both <b>xlVeryHidden</b>
and <b>xlSheetVeryHidden</b> return a numerical value of <b>2</b> (they are
interchangeable).</p>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc152234">Section 30.2: Using Strings with Delimiters in
Place of Dynamic Arrays</a></h2>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=101 style='width:1.05in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=101 valign=top style='width:1.05in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>ReDim</span></b><span style='font-size:
  9.0pt;line-height:107%'> Preserve</span></p>
  </td>
 </tr>
</table>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=36 style='width:27.0pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=36 valign=top style='width:27.0pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:#000066'>Split</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>Using Dynamic Arrays in VBA can be quite clunky and time
intensive over very large data sets. When storing simple data types in a
dynamic array (Strings, Numbers, Booleans etc.), one can avoid the statements
required of dynamic arrays in VBA by using the <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>()</span> function with some clever string
procedures. For example, we will look at a loop that adds a series of values
from a range to a string based on some conditions, then uses that string to
populate the values of a ListBox.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
15.05pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=720 height=256
src="Excel%20VBA%20Notes%20for%20Professionals_files/image297.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.7pt;
margin-left:.25pt'>The <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>Delimiter</span> string itself can be set to any value, but
it is prudent to choose a value which will not naturally occur within the set.
Say, for example, you were processing a column of dates. In that case, using <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>.</span>, <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>-</span>, or <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>/</span> would be
unwise as delimiters, as the dates could be formatted to use any one of these,
generating more data points than you anticipated.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.8pt;margin-bottom:.25pt;
margin-left:.75pt;text-align:justify;text-justify:inter-ideograph;text-indent:
-.5pt;line-height:133%'><b>Note:</b> There are limitations to using this method
(namely the maximum length of strings), so it should be used with caution in
cases of very large datasets. This is not necessarily the fastest or most
effective method for creating dynamic arrays in VBA, but it is a viable
alternative.</p>

<h2 style='margin-top:0in;margin-right:3.8pt;margin-bottom:.25pt;margin-left:
.75pt;text-align:justify;text-justify:inter-ideograph;line-height:133%'><a
name="_Toc152235">Section 30.3: Worksheet .Name, .Index or .CodeName</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.45pt;
margin-left:.25pt'>We know that 'best practise' dictates that a range object
should have its parent worksheet explicitly referenced. A worksheet can be
referred to by its .Name property, numerical .Index property or its .CodeName
property but a user can reorder the worksheet queue by simply dragging a name
tab or rename the worksheet with a double-click on the same tab and some typing
in an unprotected workbook.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:8.35pt;
margin-left:.25pt'>Consider a standard three worksheet. You have renamed the
three worksheets Monday, Tuesday and Wednesday in that order and coded VBA sub
procedures that reference these. Now consider that one user comes along and
decides that Monday belongs at the end of the worksheet queue then another
comes along and decides that the worksheet names look better in French. You now
have a workbook with a worksheet name tab queue that looks something like the
following.</p>

<p class=MsoNormal style='margin-bottom:13.85pt;text-indent:0in;line-height:
107%'><span style='font-family:"Arial",sans-serif'> </span><img border=0
width=317 height=50 id="Picture 20017"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image298.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>If you had used either of the following worksheet reference
methods, your code would now be broken.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=718 height=52
src="Excel%20VBA%20Notes%20for%20Professionals_files/image299.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=153
src="Excel%20VBA%20Notes%20for%20Professionals_files/image300.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>Both the original order and the original worksheet name have
been compromised. However, if you had used the worksheet's .CodeName property,
your sub procedure would still be operational</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=76
src="Excel%20VBA%20Notes%20for%20Professionals_files/image301.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:8.35pt;
margin-left:.25pt'>The following image shows the VBA Project window ([Ctrl]+R)
which lists the worksheets by .CodeName then by .Name (in brackets). The order
they are displayed does not change; the ordinal .Index is taken by the order
they are displayed in the name tab queue in the worksheet window.</p>

<p class=MsoNormal style='margin-bottom:13.85pt;text-indent:0in;line-height:
107%'><span style='font-family:"Arial",sans-serif'> </span><img border=0
width=272 height=293 id="Picture 20176"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image302.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>While it is uncommon to rename a .CodeName, it is not
impossible. Simply open the VBE's Properties window ([F4]).</p>

<p class=MsoNormal style='margin-bottom:14.95pt;text-indent:0in;line-height:
107%'><img border=0 width=314 height=328 id="Picture 20197"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image303.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt;line-height:145%'>The worksheet .CodeName is in the first
row. The worksheet's .Name is in the tenth. Both are editable.</p>

<h2 style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;margin-left:
.25pt;text-indent:.5pt;line-height:145%'><a name="_Toc152236">Section 30.4:
Double Click Event for Excel Shapes</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>By default, Shapes in Excel do not have a specific way to
handle single vs. double clicks, containing only the &quot;OnAction&quot;
property to allow you to handle clicks. However, there may be instances where
your code requires you to act differently (or exclusively) on a double click.
The following subroutine can be added into your VBA project and, when set as
the <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>OnAction</span>
routine for your shape, allow you to act on double clicks.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=404
src="Excel%20VBA%20Notes%20for%20Professionals_files/image304.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>This routine will cause the shape to functionally ignore the
first click, only running your desired code on the second click within the
specified time span.</p>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc152237">Section 30.5: Open File Dialog - Multiple Files</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>This subroutine is a quick example on how to allow a user to
select multiple files and then do something with those file paths, such as get
the file names and send it to the console via debug.print.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=720 height=470
src="Excel%20VBA%20Notes%20for%20Professionals_files/image305.gif"></span></p>

<h1 style='margin-left:-.25pt'><a name="_Toc152238">Chapter 31: Common Mistakes</a></h1>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc152239">Section 31.1: Qualifying References</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.95pt;
margin-left:.25pt'>When referring to a <span style='font-size:9.0pt;line-height:
110%;background:#FAFAFA'>worksheet</span>, a <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>range</span> or individual <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>cells</span>, it is
important to fully qualify the reference.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:14.45pt;
margin-left:.25pt'>For example:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:17.3pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='position:relative;z-index:
-1895779328'><span style='left:0px;position:absolute;left:0px;top:-68664px;
width:718px;height:1px'><img width=718 height=1
src="Excel%20VBA%20Notes%20for%20Professionals_files/image306.gif"></span></span><span
style='font-size:9.0pt;line-height:110%'>ThisWorkbook.Worksheets(</span><span
style='font-size:9.0pt;line-height:110%;color:brown'>&quot;Sheet1&quot;</span><span
style='font-size:9.0pt;line-height:110%'>).Range(Cells(</span><span
style='font-size:9.0pt;line-height:110%;color:brown'>1</span><span
style='font-size:9.0pt;line-height:110%'>, </span><span style='font-size:9.0pt;
line-height:110%;color:brown'>2</span><span style='font-size:9.0pt;line-height:
110%'>), Cells(</span><span style='font-size:9.0pt;line-height:110%;color:brown'>2</span><span
style='font-size:9.0pt;line-height:110%'>, </span><span style='font-size:9.0pt;
line-height:110%;color:brown'>3</span><span style='font-size:9.0pt;line-height:
110%'>)).Copy</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.7pt;
margin-left:.25pt'>Is not fully qualified: The <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>Cells</span> references do not have a
workbook and worksheet associated with them. Without an explicit reference,
Cells refers to the <span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>ActiveSheet</span> by default. So this code will fail (produce
incorrect results) if a worksheet other than <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>Sheet1</span> is the current <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>ActiveSheet</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>The easiest way to correct this is to use a <b><span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>With</span></b>
statement as follows:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=60
src="Excel%20VBA%20Notes%20for%20Professionals_files/image307.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>Alternatively, you can use a Worksheet variable. (This will
most likely be preferred method if your code needs to reference multiple
Worksheets, like copying data from one sheet to another.)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=60
src="Excel%20VBA%20Notes%20for%20Professionals_files/image308.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>Another frequent problem is referencing the Worksheets
collection without qualifying the Workbook. For example:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
15.0pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=26
src="Excel%20VBA%20Notes%20for%20Professionals_files/image309.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:14.1pt;
margin-left:.25pt'>The worksheet <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>Sheet1</span> is not fully qualified, and lacks a workbook.
This could fail if multiple workbooks are referenced in the code. Instead, use
one of the following:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.3pt;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'>ThisWorkbook.Worksheets(</span><span style='font-size:9.0pt;line-height:
110%;color:brown'>&quot;Sheet1&quot;</span><span style='font-size:9.0pt;
line-height:110%'>) </span><i><span style='font-size:9.0pt;line-height:
110%;color:green'>'&lt;--ThisWorkbook refers to the workbook containing</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.3pt;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><i><span style='font-size:
9.0pt;line-height:110%;color:green'>'the running VBA code</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:15.95pt;margin-bottom:
.15pt;margin-left:0in;text-indent:3.75pt;line-height:240%'><span
style='position:relative;z-index:-1895778304'><span style='left:0px;position:
absolute;left:0px;top:-69159px;width:718px;height:1px'><img width=718 height=1
src="Excel%20VBA%20Notes%20for%20Professionals_files/image114.gif"></span></span><span
style='font-size:9.0pt;line-height:240%'>Workbooks(</span><span
style='font-size:9.0pt;line-height:240%;color:brown'>&quot;Book1&quot;</span><span
style='font-size:9.0pt;line-height:240%'>).Worksheets(</span><span
style='font-size:9.0pt;line-height:240%;color:brown'>&quot;Sheet1&quot;</span><span
style='font-size:9.0pt;line-height:240%'>) </span><i><span style='font-size:
9.0pt;line-height:240%;color:green'>'&lt;--Where Book1 is the workbook
containing Sheet1 </span></i>However, avoid using the following:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.3pt;margin-bottom:.15pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='position:relative;z-index:
-1895777280'><span style='left:0px;position:absolute;left:0px;top:-69201px;
width:718px;height:1px'><img width=718 height=1
src="Excel%20VBA%20Notes%20for%20Professionals_files/image310.gif"></span></span><span
style='font-size:9.0pt;line-height:110%'>ActiveWorkbook.Worksheets(</span><span
style='font-size:9.0pt;line-height:110%;color:brown'>&quot;Sheet1&quot;</span><span
style='font-size:9.0pt;line-height:110%'>) </span><i><span
style='font-size:9.0pt;line-height:110%;color:green'>'&lt;--Valid, but if
another workbook is activated</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.3pt;margin-bottom:17.35pt;
margin-left:3.5pt;text-indent:-.5pt'><span style='font-size:9.0pt;line-height:
110%'> </span><i><span style='font-size:
9.0pt;line-height:110%;color:green'>'the reference will be changed</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>Similarly for <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>range</span> objects, if not explicitly qualified, the <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>range</span> will
refer to the currently active sheet:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=26
src="Excel%20VBA%20Notes%20for%20Professionals_files/image311.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>Is the same as:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=718 height=26
src="Excel%20VBA%20Notes%20for%20Professionals_files/image312.gif"></span></p>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc152240">Section 31.2: Deleting rows or columns in a loop</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>If you want to delete rows (or columns) in a loop, you
should always loop starting from the end of range and move back in every step.
In case of using the code:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=109
src="Excel%20VBA%20Notes%20for%20Professionals_files/image313.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.45pt;
margin-left:.25pt'>You will miss some rows. For example, if the code deletes
row 3, then row 4 becomes row 3. However, variable <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>i </span>will change to 4. So, in this
case the code will miss one row and check another, which wasn't in range
previously.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>The right code would be</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
10.35pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=109
src="Excel%20VBA%20Notes%20for%20Professionals_files/image314.gif"></span></p>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:2.7pt;margin-left:
-.25pt'><a name="_Toc152241">Section 31.3: ActiveWorkbook vs. ThisWorkbook</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.6pt;
margin-left:.25pt'><span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>ActiveWorkbook</span> and <span style='font-size:9.0pt;line-height:
110%;background:#FAFAFA'>ThisWorkbook</span> sometimes get used interchangeably
by new users of VBA without fully understanding which each object relates to,
this can cause undesired behaviour at run-time. Both of these objects belong to
the Application Object</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>The <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>ActiveWorkbook</span> object refers to the workbook that is
currently in the top-most view of the Excel application object at the time of
execution. <i>(e.g. The workbook that you can see and interact with at the
point when this object is referenced)</i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
15.05pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=240
src="Excel%20VBA%20Notes%20for%20Professionals_files/image315.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>The <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>ThisWorkbook</span> object refers to the workbook in which
the code belongs to at the time it is being executed.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=720 height=114
src="Excel%20VBA%20Notes%20for%20Professionals_files/image316.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
10.35pt;margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=104
src="Excel%20VBA%20Notes%20for%20Professionals_files/image317.gif"></span></p>

<h2 style='margin-top:0in;margin-right:1.3pt;margin-bottom:13.7pt;margin-left:
-.25pt'><a name="_Toc152242">Section 31.4: Single Document Interface Versus
Multiple Document Interfaces</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:23.9pt;
margin-left:24.0pt'><img width=3 height=1
src="Excel%20VBA%20Notes%20for%20Professionals_files/image200.gif" align=left
hspace=12>Be aware that Microsoft Excel 2013 (and higher) uses Single Document
Interface (SDI) and that Excel 2010 (And below) uses Multiple Document
Interfaces (MDI).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:.25pt'>This implies that for Excel 2013 (SDI), each workbook in a
single instance of Excel contains its <b>own</b> ribbon UI:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
15.2pt;margin-left:0in;text-indent:0in;line-height:107%'><img border=0
width=718 height=450 id="Picture 21075"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image318.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>Conversely for Excel 2010, each workbook in a single
instance of Excel utilized a <b>common</b> ribbon UI (MDI):</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.95pt;margin-left:0in;text-indent:0in;line-height:107%'><img border=0
width=718 height=486 id="Picture 21099"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image319.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:24.0pt;
margin-left:.25pt'>This raise some important issues if you want to migrate a
VBA code (2010 &lt;-&gt;2013) that interact with the Ribbon.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:16.7pt;margin-bottom:
23.65pt;margin-left:24.0pt'><img width=3 height=1
src="Excel%20VBA%20Notes%20for%20Professionals_files/image200.gif" align=left
hspace=12>A procedure has to be created to update ribbon UI controls in the
same state across all workbooks for Excel 2013 and Higher.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:13.3pt;
margin-left:.25pt'>Note that :</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:110%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>All
Excel application-level window methods, events, and properties remain
unaffected.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=316 style='width:237.25pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=79 valign=top style='width:59.4pt;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>Application</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;background:#FAFAFA'>.</span></p>
  </td>
  <td width=86 valign=top style='width:.9in;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>ActiveWindow</span></p>
  </td>
  <td width=7 valign=top style='width:5.05pt;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>, </p>
  </td>
  <td width=79 valign=top style='width:59.4pt;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>Application</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;background:#FAFAFA'>.</span></p>
  </td>
  <td width=50 valign=top style='width:37.8pt;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>Windows</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:30.0pt'>( ... )</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:0in;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:110%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>In
Excel 2013 and higher (SDI) all of the workbook-level window methods, events,
and properties now operate on the top level window. It is possible to retrieve
the handle of this top level window with</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=115
 style='width:1.2in;margin-left:30.0pt;border-collapse:collapse'>
 <tr style='height:.15in'>
  <td width=79 valign=top style='width:59.4pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>Application</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;background:#FAFAFA'>.</span></p>
  </td>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>Hwnd</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:12.8pt;
margin-left:.25pt'>To get more details, see the source of this example: <a
href="https://msdn.microsoft.com/fr-fr/library/office/dn251093.aspx"><span
style='color:#02723B'>MSDN</span></a>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:1.5pt;
margin-left:.25pt'>This also causes some trouble with modeless userforms. See <a
href="http://www.jkp-ads.com/Articles/keepuserformontop.asp"><span
style='color:#02723B'>Here</span></a> for a solution.</p>

<h1 style='margin-left:-.25pt'><a name="_Toc152243">Credits</a></h1>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:20.85pt;
margin-bottom:1.7pt;margin-left:21.4pt;text-align:center;text-indent:-.5pt'>Thank
you greatly to all the people from Stack Overflow Documentation who helped
provide this content, more changes can be sent to <u><span style='color:#02723B'>web@petercv.com</span></u>
for new content to be published or updated</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=371
 style='width:278.4pt;margin-left:1.0pt;border-collapse:collapse'>
 <tr style='height:12.55pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:12.55pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1126985/"><span style='color:#02723B'>Adam</span></a></p>
  </td>
  <td width=201 colspan=2 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:12.55pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  4</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/765226/"><span style='color:#02723B'>Alexis
  Olson</span></a></p>
  </td>
  <td width=201 colspan=2 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  29</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/908624/"><span style='color:#02723B'>Alon
  Adler</span></a></p>
  </td>
  <td width=201 colspan=2 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  2</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/447485/"><span style='color:#02723B'>Andy
  Terra</span></a></p>
  </td>
  <td width=201 colspan=2 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapters
  5 and 30</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/4636801/"><span style='color:#02723B'>Branislav
  Kollr</span></a></p>
  </td>
  <td width=201 colspan=2 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapters
  1, 4 and 29</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/4288101/"><span style='color:#02723B'>Byron
  Wall</span></a></p>
  </td>
  <td width=201 colspan=2 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  21</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/6803420/"><span style='color:#02723B'>Captain
  Grumpy</span></a></p>
  </td>
  <td width=201 colspan=2 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapters
  18 and 20</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/2146688/"><span style='color:#02723B'>Chel</span></a></p>
  </td>
  <td width=201 colspan=2 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapters
  27 and 29</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/2446254/"><span style='color:#02723B'>Cody
  G.</span></a></p>
  </td>
  <td width=201 colspan=2 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapters
  1, 28, 29 and 30</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/4088852/"><span style='color:#02723B'>Comintern</span></a></p>
  </td>
  <td width=201 colspan=2 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  29</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/6037536/"><span style='color:#02723B'>curious</span></a></p>
  </td>
  <td width=201 colspan=2 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  14</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/5009293/"><span style='color:#02723B'>Doug
  Coats</span></a></p>
  </td>
  <td width=201 colspan=2 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapters
  1, 4 and 12</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/4892468/"><span style='color:#02723B'>EEM</span></a></p>
  </td>
  <td width=201 colspan=2 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  1</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/5722505/"><span style='color:#02723B'>Egan
  Wolf</span></a></p>
  </td>
  <td width=201 colspan=2 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  31</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/4927169/"><span style='color:#02723B'>Etheur</span></a></p>
  </td>
  <td width=201 colspan=2 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  28</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1523914/"><span style='color:#02723B'>Excel
  Developers</span></a></p>
  </td>
  <td width=201 colspan=2 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  11</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/2344413/"><span style='color:#02723B'>FreeMan</span></a></p>
  </td>
  <td width=201 colspan=2 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  29</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/4293613/"><span style='color:#02723B'>genespos</span></a></p>
  </td>
  <td width=201 colspan=2 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  29</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/16473/"><span style='color:#02723B'>Gordon
  Bell</span></a></p>
  </td>
  <td width=201 colspan=2 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapters
  1 and 31</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/4496560/"><span style='color:#02723B'>Gregor
  y</span></a></p>
  </td>
  <td width=201 colspan=2 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  28</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1365754/"><span style='color:#02723B'>Hubisan</span></a></p>
  </td>
  <td width=201 colspan=2 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapters
  2, 14 and 29</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/4039065/"><span style='color:#02723B'>Jeeped</span></a></p>
  </td>
  <td width=201 colspan=2 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapters
  8, 18, 29 and 30</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/5216265/"><span style='color:#02723B'>jlookup</span></a></p>
  </td>
  <td width=201 colspan=2 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  18</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/4/"><span style='color:#02723B'>Joel
  Spolsky</span></a></p>
  </td>
  <td width=201 colspan=2 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapters
  1, 4 and 20</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/6588969/"><span style='color:#02723B'>Julian
  Kuchlbauer</span></a></p>
  </td>
  <td width=201 colspan=2 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  28</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/4169411/"><span style='color:#02723B'>Kaz</span></a></p>
  </td>
  <td width=201 colspan=2 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  1</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/4043845/"><span style='color:#02723B'>Kyle</span></a></p>
  </td>
  <td width=201 colspan=2 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapters
  28 and 29</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/4721734/"><span style='color:#02723B'>Mt
  Juhsz</span></a></p>
  </td>
  <td width=201 colspan=2 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  29</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/4240221/"><span style='color:#02723B'>Macro
  Man</span></a></p>
  </td>
  <td width=201 colspan=2 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapters
  1, 29, 30 and 31</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/3205529/"><span style='color:#02723B'>Malick</span></a></p>
  </td>
  <td width=201 colspan=2 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapters
  1, 8, 18, 29 and 31</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/6461462/"><span style='color:#02723B'>Masoud</span></a></p>
  </td>
  <td width=201 colspan=2 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  26</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/3005534/"><span style='color:#02723B'>Miguel_Ryu</span></a></p>
  </td>
  <td width=201 colspan=2 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  2</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/2911241/"><span style='color:#02723B'>Mike</span></a></p>
  </td>
  <td width=201 colspan=2 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  24</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/3648187/"><span style='color:#02723B'>Miqi180</span></a></p>
  </td>
  <td width=201 colspan=2 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  14</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/2992687/"><span style='color:#02723B'>Munkeeface</span></a></p>
  </td>
  <td width=201 colspan=2 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  29</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/4914662/"><span style='color:#02723B'>paul
  bica</span></a></p>
  </td>
  <td width=201 colspan=2 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapters
  14, 26 and 29</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/4717755/"><span style='color:#02723B'>PeterT</span></a></p>
  </td>
  <td width=201 colspan=2 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapters
  10, 17 and 29</p>
  </td>
 </tr>
 <tr style='height:14.55pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.55pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/2521004/"><span style='color:#02723B'>Portland
  Runner</span></a></p>
  </td>
  <td width=201 colspan=2 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.55pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapters
  5 and 29</p>
  </td>
 </tr>
 <tr style='height:14.6pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.6pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/3219613/"><span style='color:#02723B'>P</span></a><u><span
  style='color:#02723B'> </span></u><a
  href="https://stackoverflow.com/users/3219613/"><span style='font-family:
  "Arial",sans-serif;color:#02723B'>&#668;</span></a></p>
  </td>
  <td width=201 colspan=2 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.6pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  29</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/6254385/"><span style='color:#02723B'>quadrature</span></a></p>
  </td>
  <td width=201 colspan=2 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapters
  7 and 15</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/4628637/"><span style='color:#02723B'>R3uK</span></a></p>
  </td>
  <td width=201 colspan=2 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapters
  6 and 14</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/6408573/"><span style='color:#02723B'>RGA</span></a></p>
  </td>
  <td width=201 colspan=2 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>Chapters 1, 14, 23, 28, 29
  and 30</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/5298189/"><span style='color:#02723B'>Robby</span></a></p>
  </td>
  <td width=201 colspan=2 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  24</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/2205331/"><span style='color:#02723B'>Ron
  McMahon</span></a></p>
  </td>
  <td width=201 colspan=2 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  28</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/3221380/"><span style='color:#02723B'>Sgdva</span></a></p>
  </td>
  <td width=201 colspan=2 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  19</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/7769242/"><span style='color:#02723B'>Shahin</span></a></p>
  </td>
  <td width=201 colspan=2 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  2</p>
  </td>
 </tr>
 <tr style='height:12.55pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:12.55pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/6344363/"><span style='color:#02723B'>Shai
  Rado</span></a></p>
  </td>
  <td width=201 colspan=2 valign=top style='width:150.9pt;padding:0in 0in 0in 0in;
  height:12.55pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapters
  1, 12, 14 and 29</p>
  </td>
 </tr>
 <tr style='height:12.55pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:12.55pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1383168/"><span style='color:#02723B'>Slai</span></a></p>
  </td>
  <td width=135 valign=top style='width:101.4pt;padding:0in 0in 0in 0in;
  height:12.55pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapters
  8 and 14</p>
  </td>
  <td style='border:none;padding:0in 0in 0in 0in' width=66><p class='MsoNormal'>&nbsp;</td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/5776000/"><span style='color:#02723B'>Stefan
  Pinnow</span></a></p>
  </td>
  <td width=135 valign=top style='width:101.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  29</p>
  </td>
  <td style='border:none;padding:0in 0in 0in 0in' width=66><p class='MsoNormal'>&nbsp;</td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/7648526/"><span style='color:#02723B'>SteveES</span></a></p>
  </td>
  <td width=135 valign=top style='width:101.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  3</p>
  </td>
  <td style='border:none;padding:0in 0in 0in 0in' width=66><p class='MsoNormal'>&nbsp;</td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1197635/"><span style='color:#02723B'>Steven
  Schroeder</span></a></p>
  </td>
  <td width=135 valign=top style='width:101.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapters
  28 and 29</p>
  </td>
  <td style='border:none;padding:0in 0in 0in 0in' width=66><p class='MsoNormal'>&nbsp;</td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1240154/"><span style='color:#02723B'>SWa</span></a></p>
  </td>
  <td width=135 valign=top style='width:101.4pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'>Chapter
  31</p>
  </td>
  <td style='border:none;padding:0in 0in 0in 0in' width=66><p class='MsoNormal'>&nbsp;</td>
 </tr>
 <tr style='height:12.55pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:12.55pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/6460297/"><span style='color:#02723B'>T.M.</span></a></p>
  </td>
  <td width=135 valign=top style='width:101.4pt;padding:0in 0in 0in 0in;
  height:12.55pt'>
  <p class=MsoNormal style='margin-bottom:0in;text-align:justify;text-justify:
  inter-ideograph;text-indent:0in;line-height:107%'>Chapters 7, 22 and 26</p>
  </td>
  <td style='border:none;padding:0in 0in 0in 0in' width=66><p class='MsoNormal'>&nbsp;</td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:10.25pt;margin-bottom:
1.65pt;margin-left:.75pt;text-align:justify;text-justify:inter-ideograph;
text-indent:-.5pt;line-height:110%'><a
href="https://stackoverflow.com/users/3918993/"><span style='color:#02723B'>TheGuyThatDoesn'tKnowMuch</span></a><u><span
style='color:#02723B'> </span></u>Chapter 27</p>

<p class=MsoNormal style='margin-top:0in;margin-right:308.65pt;margin-bottom:
.25pt;margin-left:.75pt;text-align:justify;text-justify:inter-ideograph;
text-indent:-.5pt;line-height:133%'><a
href="https://stackoverflow.com/users/5757159/"><span style='color:#02723B'>ThunderFrame</span></a><u><span
style='color:#02723B'> </span></u>Chapter 29 <a
href="https://stackoverflow.com/users/4747836/"><span style='color:#02723B'>Toast</span></a><u><span
style='color:#02723B'> </span></u>Chapters 1, 28 and 31 <a
href="https://stackoverflow.com/users/3561813/"><span style='color:#02723B'>user3561813</span></a><u><span
style='color:#02723B'> </span></u>Chapter 8 <a
href="https://stackoverflow.com/users/4604845/"><span style='color:#02723B'>Vegard</span></a><u><span
style='color:#02723B'> </span></u>Chapters 4 and 8</p>

<p class=MsoNormal style='margin-top:0in;margin-right:326.95pt;margin-bottom:
1.5pt;margin-left:.25pt'><a href="https://stackoverflow.com/users/4600127/"><span
style='color:#02723B'>Verzweifler</span></a><u><span style='color:#02723B'> </span></u>Chapter
29 <a href="https://stackoverflow.com/users/5448626/"><span style='color:#02723B'>Vityata</span></a><u><span
style='color:#02723B'> </span></u>Chapter 13</p>

<p class=MsoNormal style='text-indent:0in'><a
href="https://stackoverflow.com/users/5829910/"><span style='color:#02723B'>Zsmaster</span></a><u><span
style='color:#02723B'> </span></u>Chapters
9, 16 and 25</p>

</div>

<span style='font-size:10.0pt;line-height:110%;font-family:"Calibri",sans-serif;
color:black'><br clear=all style='page-break-before:always'>
</span>

<div class=WordSection3>

<h1 style='margin-left:-43.15pt'><a name="_Toc152244">You may also like</a></h1>

<p class=MsoNormal style='margin-top:0in;margin-right:-45.95pt;margin-bottom:
0in;margin-left:-47.25pt;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=726 height=992
id="Group 139785"
src="Excel%20VBA%20Notes%20for%20Professionals_files/image320.gif"></span></p>

</div>

</body>

</html>
