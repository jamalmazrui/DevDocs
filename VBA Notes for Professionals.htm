<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=Generator content="Microsoft Word 15 (filtered)">
<title>VBA Notes for Professionals</title>
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Helvetica;
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:Courier;
	panose-1:2 7 4 9 2 2 5 2 4 4;}
@font-face
	{font-family:"Tms Rmn";
	panose-1:2 2 6 3 4 5 5 2 3 4;}
@font-face
	{font-family:Helv;
	panose-1:2 11 6 4 2 2 2 3 2 4;}
@font-face
	{font-family:"New York";
	panose-1:2 4 5 3 6 5 6 2 3 4;}
@font-face
	{font-family:System;
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"MS Mincho";
	panose-1:2 2 6 9 4 2 5 8 3 4;}
@font-face
	{font-family:Batang;
	panose-1:2 3 6 0 0 1 1 1 1 1;}
@font-face
	{font-family:SimSun;
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:PMingLiU;
	panose-1:2 1 6 1 0 1 1 1 1 1;}
@font-face
	{font-family:"MS Gothic";
	panose-1:2 11 6 9 7 2 5 8 2 4;}
@font-face
	{font-family:Dotum;
	panose-1:2 11 6 0 0 1 1 1 1 1;}
@font-face
	{font-family:SimHei;
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:MingLiU;
	panose-1:2 1 6 9 0 1 1 1 1 1;}
@font-face
	{font-family:Mincho;
	panose-1:2 2 6 9 4 3 5 8 3 5;}
@font-face
	{font-family:Gulim;
	panose-1:2 11 6 0 0 1 1 1 1 1;}
@font-face
	{font-family:Century;
	panose-1:2 4 6 4 5 5 5 2 3 4;}
@font-face
	{font-family:"Angsana New";
	panose-1:2 2 6 3 5 4 5 2 3 4;}
@font-face
	{font-family:"Cordia New";
	panose-1:2 11 3 4 2 2 2 2 2 4;}
@font-face
	{font-family:Mangal;
	panose-1:0 0 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:Latha;
	panose-1:2 0 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:Sylfaen;
	panose-1:1 10 5 2 5 3 6 3 3 3;}
@font-face
	{font-family:Vrinda;
	panose-1:0 0 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:Raavi;
	panose-1:2 0 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:Shruti;
	panose-1:2 0 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:Sendnya;
	panose-1:0 0 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:Gautami;
	panose-1:2 0 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:Tunga;
	panose-1:0 0 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Estrangelo Edessa";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:"Yu Gothic";
	panose-1:2 11 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:DengXian;
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:"Calibri Light";
	panose-1:2 15 3 2 2 2 4 3 2 4;}
@font-face
	{font-family:"Palatino Linotype";
	panose-1:2 4 5 2 5 5 5 3 3 4;}
@font-face
	{font-family:Verdana;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
	{font-family:"Arial Unicode MS";
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:"Aptos Display";}
@font-face
	{font-family:Aptos;}
@font-face
	{font-family:"Segoe UI Emoji";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"DejaVu Sans Mono";
	panose-1:2 11 6 9 3 8 4 2 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:1.5pt;
	margin-left:.5pt;
	text-indent:-.5pt;
	line-height:110%;
	font-size:10.0pt;
	font-family:"Calibri",sans-serif;
	color:black;}
h1
	{mso-style-link:"Heading 1 Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:.15pt;
	margin-left:.5pt;
	text-indent:-.5pt;
	line-height:110%;
	page-break-after:avoid;
	font-size:26.0pt;
	font-family:"Calibri",sans-serif;
	color:#193C96;}
h2
	{mso-style-link:"Heading 2 Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:2.75pt;
	margin-left:.5pt;
	text-indent:-.5pt;
	line-height:107%;
	page-break-after:avoid;
	font-size:18.0pt;
	font-family:"Calibri",sans-serif;
	color:#193C96;}
h3
	{mso-style-link:"Heading 3 Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:2.75pt;
	margin-left:.5pt;
	text-indent:-.5pt;
	line-height:107%;
	page-break-after:avoid;
	font-size:18.0pt;
	font-family:"Calibri",sans-serif;
	color:#193C96;}
h4
	{mso-style-link:"Heading 4 Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:13.2pt;
	margin-left:11.65pt;
	text-indent:-.5pt;
	line-height:110%;
	page-break-after:avoid;
	font-size:10.0pt;
	font-family:"Calibri",sans-serif;
	color:black;}
h5
	{mso-style-link:"Heading 5 Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:13.3pt;
	margin-left:0in;
	line-height:107%;
	page-break-after:avoid;
	font-size:10.0pt;
	font-family:"Calibri",sans-serif;
	color:black;
	font-style:italic;}
p.MsoToc1, li.MsoToc1, div.MsoToc1
	{margin-top:0in;
	margin-right:.75pt;
	margin-bottom:1.5pt;
	margin-left:1.25pt;
	text-indent:-.5pt;
	line-height:110%;
	font-size:10.0pt;
	font-family:"Calibri",sans-serif;
	color:black;}
p.MsoToc2, li.MsoToc2, div.MsoToc2
	{margin-top:0in;
	margin-right:.75pt;
	margin-bottom:3.0pt;
	margin-left:21.25pt;
	text-indent:-.5pt;
	line-height:110%;
	font-size:10.0pt;
	font-family:"Calibri",sans-serif;
	color:black;}
span.Heading5Char
	{mso-style-name:"Heading 5 Char";
	mso-style-link:"Heading 5";
	font-family:"Calibri",sans-serif;
	color:black;
	font-weight:bold;
	font-style:italic;}
span.Heading3Char
	{mso-style-name:"Heading 3 Char";
	mso-style-link:"Heading 3";
	font-family:"Calibri",sans-serif;
	color:#193C96;
	font-weight:bold;}
span.Heading4Char
	{mso-style-name:"Heading 4 Char";
	mso-style-link:"Heading 4";
	font-family:"Calibri",sans-serif;
	color:black;
	font-weight:bold;}
span.Heading1Char
	{mso-style-name:"Heading 1 Char";
	mso-style-link:"Heading 1";
	font-family:"Calibri",sans-serif;
	color:#193C96;
	font-weight:bold;}
span.Heading2Char
	{mso-style-name:"Heading 2 Char";
	mso-style-link:"Heading 2";
	font-family:"Calibri",sans-serif;
	color:#193C96;
	font-weight:bold;}
span.msoIns
	{mso-style-name:"";
	text-decoration:underline;
	color:#65B4B4;}
span.msoDel
	{mso-style-name:"";
	text-decoration:line-through;
	color:#FF4B4B;}
.MsoChpDefault
	{font-size:12.0pt;}
.MsoPapDefault
	{margin-bottom:8.0pt;
	line-height:115%;}
 /* Page Definitions */
 @page WordSection1
	{size:595.3pt 841.9pt;
	margin:23.8pt 41.95pt 45.0pt 28.35pt;}
div.WordSection1
	{page:WordSection1;}
@page WordSection2
	{size:595.3pt 841.9pt;
	margin:23.8pt 28.35pt 42.35pt 28.35pt;}
div.WordSection2
	{page:WordSection2;}
@page WordSection3
	{size:595.3pt 841.9pt;
	margin:28.35pt 28.55pt 42.5pt 28.35pt;}
div.WordSection3
	{page:WordSection3;}
@page WordSection4
	{size:595.3pt 841.9pt;
	margin:28.35pt 53.0pt 42.5pt 28.35pt;}
div.WordSection4
	{page:WordSection4;}
@page WordSection5
	{size:595.3pt 841.9pt;
	margin:63.75pt 1.0in 34.15pt 1.0in;}
div.WordSection5
	{page:WordSection5;}
 /* List Definitions */
 ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>

</head>

<body lang=EN-US style='word-wrap:break-word'>

<div class=WordSection1>

<p class=MsoNormal style='margin-top:0in;margin-right:553.35pt;margin-bottom:
0in;margin-left:-28.35pt;text-indent:0in;line-height:107%'><img width=792
height=1120 src="VBA%20Notes%20for%20Professionals_files/image001.jpg"><br
clear=ALL>
<br clear=all style='page-break-before:always'>
</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:2.0pt;
margin-left:-.25pt'><b><span style='font-size:26.0pt;line-height:110%;
color:#193C96'>Contents</span></b></p>

<p class=MsoToc1><a href="#_Toc308640"><b><span style='font-size:12.0pt;
line-height:110%;color:#193C96'>About</span></b><span style='color:black;
text-decoration:none'>........................................................................................................................................................................................................................ </span><span style='color:black;text-decoration:none'>1</span></a></p>

<p class=MsoToc1><a href="#_Toc308641"><b><span style='font-size:12.0pt;
line-height:110%;color:#193C96'>Chapter 1: Getting started with VBA</span></b><span
style='color:black;text-decoration:none'>....................................................................................................................................................... </span><span style='color:black;text-decoration:none'>2</span></a></p>

<p class=MsoToc2><a href="#_Toc308642"><span style='color:#193C96'>Section 1.1:
Accessing the Visual Basic Editor in Microsoft O&#57380;ce</span><span
style='color:black;text-decoration:none'>........................................................................................................... </span><span style='color:black;text-decoration:none'>2</span></a></p>

<p class=MsoToc2><a href="#_Toc308643"><span style='color:#193C96'>Section 1.2:
Debugging</span><span style='color:black;text-decoration:none'>................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>3</span></a></p>

<p class=MsoToc2><a href="#_Toc308644"><span style='color:#193C96'>Section 1.3:
First Module and Hello World</span><span style='color:black;text-decoration:
none'>.................................................................................................................................................. </span><span style='color:black;text-decoration:none'>4</span></a></p>

<p class=MsoToc1><a href="#_Toc308645"><b><span style='font-size:12.0pt;
line-height:110%;color:#193C96'>Chapter 2: Declaring Variables</span></b><span
style='color:black;text-decoration:none'>................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>6</span></a></p>

<p class=MsoToc2><a href="#_Toc308646"><span style='color:#193C96'>Section 2.1:
Type Hints</span><span style='color:black;text-decoration:none'>.................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>6</span></a></p>

<p class=MsoToc2><a href="#_Toc308647"><span style='color:#193C96'>Section 2.2:
Variables</span><span style='color:black;text-decoration:none'>...................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>7</span></a></p>

<p class=MsoToc2><a href="#_Toc308648"><span style='color:#193C96'>Section 2.3:
Constants (Const)</span><span style='color:black;text-decoration:none'>.................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>10</span></a></p>

<p class=MsoToc2><a href="#_Toc308649"><span style='color:#193C96'>Section 2.4:
Declaring Fixed-Length Strings</span><span style='color:black;text-decoration:
none'>.............................................................................................................................................. </span><span style='color:black;text-decoration:none'>11</span></a></p>

<p class=MsoToc2><a href="#_Toc308650"><span style='color:#193C96'>Section 2.5:
When to use a Static variable</span><span style='color:black;text-decoration:
none'>................................................................................................................................................ </span><span style='color:black;text-decoration:none'>12</span></a></p>

<p class=MsoToc2><a href="#_Toc308651"><span style='color:#193C96'>Section 2.6:
Implicit And Explicit Declaration</span><span style='color:black;text-decoration:
none'>........................................................................................................................................... </span><span style='color:black;text-decoration:none'>14</span></a></p>

<p class=MsoToc2><a href="#_Toc308652"><span style='color:#193C96'>Section 2.7:
Access Modifiers</span><span style='color:black;text-decoration:none'>...................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>14</span></a></p>

<p class=MsoToc1><a href="#_Toc308653"><b><span style='font-size:12.0pt;
line-height:110%;color:#193C96'>Chapter 3: Scripting.FileSystemObject</span></b><span
style='color:black;text-decoration:none'>................................................................................................................................................ </span><span style='color:black;text-decoration:none'>16</span></a></p>

<p class=MsoToc2><a href="#_Toc308654"><span style='color:#193C96'>Section 3.1:
Retrieve only the path from a file path</span><span style='color:black;
text-decoration:none'>................................................................................................................................ </span><span style='color:black;text-decoration:none'>16</span></a></p>

<p class=MsoToc2><a href="#_Toc308655"><span style='color:#193C96'>Section 3.2:
Retrieve just the extension from a file name</span><span style='color:black;
text-decoration:none'>..................................................................................................................... </span><span style='color:black;text-decoration:none'>16</span></a></p>

<p class=MsoToc2><a href="#_Toc308656"><span style='color:#193C96'>Section 3.3:
Recursively enumerate folders and files</span><span style='color:black;
text-decoration:none'>.............................................................................................................................. </span><span style='color:black;text-decoration:none'>16</span></a></p>

<p class=MsoToc2><a href="#_Toc308657"><span style='color:#193C96'>Section 3.4:
Strip file extension from a file name</span><span style='color:black;
text-decoration:none'>.................................................................................................................................... </span><span style='color:black;text-decoration:none'>17</span></a></p>

<p class=MsoToc2><a href="#_Toc308658"><span style='color:#193C96'>Section 3.5:
Enumerate files in a directory using FileSystemObject</span><span
style='color:black;text-decoration:none'>..................................................................................................... </span><span style='color:black;text-decoration:none'>17</span></a></p>

<p class=MsoToc2><a href="#_Toc308659"><span style='color:#193C96'>Section 3.6:
Creating a FileSystemObject</span><span style='color:black;text-decoration:
none'>.................................................................................................................................................. </span><span style='color:black;text-decoration:none'>18</span></a></p>

<p class=MsoToc2><a href="#_Toc308660"><span style='color:#193C96'>Section 3.7:
Reading a text file using a FileSystemObject</span><span style='color:black;
text-decoration:none'>...................................................................................................................... </span><span style='color:black;text-decoration:none'>18</span></a></p>

<p class=MsoToc2><a href="#_Toc308661"><span style='color:#193C96'>Section 3.8:
Creating a text file with FileSystemObject</span><span style='color:black;
text-decoration:none'>.......................................................................................................................... </span><span style='color:black;text-decoration:none'>19</span></a></p>

<p class=MsoToc2><a href="#_Toc308662"><span style='color:#193C96'>Section 3.9:
Using FSO.BuildPath to build a Full Path from folder path and file name</span><span
style='color:black;text-decoration:none'>..................................................................... </span><span style='color:black;text-decoration:none'>19</span></a></p>

<p class=MsoToc2><a href="#_Toc308663"><span style='color:#193C96'>Section
3.10: Writing to an existing file with FileSystemObject</span><span
style='color:black;text-decoration:none'>............................................................................................................ </span><span style='color:black;text-decoration:none'>19</span></a></p>

<p class=MsoToc1><a href="#_Toc308664"><b><span style='font-size:12.0pt;
line-height:110%;color:#193C96'>Chapter 4: Procedure Calls</span></b><span
style='color:black;text-decoration:none'>......................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>21</span></a></p>

<p class=MsoToc2><a href="#_Toc308665"><span style='color:#193C96'>Section 4.1:
This is confusing. Why not just always use parentheses?</span><span
style='color:black;text-decoration:none'>................................................................................................ </span><span style='color:black;text-decoration:none'>21</span></a></p>

<p class=MsoToc2><a href="#_Toc308666"><span style='color:#193C96'>Section 4.2:
Implicit Call Syntax</span><span style='color:black;text-decoration:none'>.................................................................................................................................................................. </span><span style='color:black;text-decoration:none'>21</span></a></p>

<p class=MsoToc2><a href="#_Toc308667"><span style='color:#193C96'>Section 4.3:
Optional Arguments</span><span style='color:black;text-decoration:none'>................................................................................................................................................................ </span><span style='color:black;text-decoration:none'>22</span></a></p>

<p class=MsoToc2><a href="#_Toc308668"><span style='color:#193C96'>Section 4.4:
Explicit Call Syntax</span><span style='color:black;text-decoration:none'>................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>22</span></a></p>

<p class=MsoToc2><a href="#_Toc308669"><span style='color:#193C96'>Section 4.5:
Return Values</span><span style='color:black;text-decoration:none'>........................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>23</span></a></p>

<p class=MsoToc1><a href="#_Toc308670"><b><span style='font-size:12.0pt;
line-height:110%;color:#193C96'>Chapter 5: Naming Conventions</span></b><span
style='color:black;text-decoration:none'>............................................................................................................................................................. </span><span style='color:black;text-decoration:none'>24</span></a></p>

<p class=MsoToc2><a href="#_Toc308671"><span style='color:#193C96'>Section 5.1:
Variable Names</span><span style='color:black;text-decoration:none'>........................................................................................................................................................................ </span><span style='color:black;text-decoration:none'>24</span></a></p>

<p class=MsoToc2><a href="#_Toc308672"><span style='color:#193C96'>Section 5.2:
Procedure Names</span><span style='color:black;text-decoration:none'>.................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>27</span></a></p>

<p class=MsoToc1><a href="#_Toc308673"><b><span style='font-size:12.0pt;
line-height:110%;color:#193C96'>Chapter 6: Creating a procedure</span></b><span
style='color:black;text-decoration:none'>............................................................................................................................................................. </span><span style='color:black;text-decoration:none'>29</span></a></p>

<p class=MsoToc2><a href="#_Toc308674"><span style='color:#193C96'>Section 6.1:
Introduction to procedures</span><span style='color:black;text-decoration:none'>.................................................................................................................................................... </span><span style='color:black;text-decoration:none'>29</span></a></p>

<p class=MsoToc2><a href="#_Toc308675"><span style='color:#193C96'>Section 6.2:
Function With Examples</span><span style='color:black;text-decoration:none'>......................................................................................................................................................... </span><span style='color:black;text-decoration:none'>29</span></a></p>

<p class=MsoToc1><a href="#_Toc308676"><b><span style='font-size:12.0pt;
line-height:110%;color:#193C96'>Chapter 7: Flow control structures</span></b><span
style='color:black;text-decoration:none'>........................................................................................................................................................ </span><span style='color:black;text-decoration:none'>31</span></a></p>

<p class=MsoToc2><a href="#_Toc308677"><span style='color:#193C96'>Section 7.1:
For loop</span><span style='color:black;text-decoration:none'>..................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>31</span></a></p>

<p class=MsoToc2><a href="#_Toc308678"><span style='color:#193C96'>Section 7.2:
Select Case</span><span style='color:black;text-decoration:none'>................................................................................................................................................................................ </span><span style='color:black;text-decoration:none'>32</span></a></p>

<p class=MsoToc2><a href="#_Toc308679"><span style='color:#193C96'>Section 7.3:
For Each loop</span><span style='color:black;text-decoration:none'>............................................................................................................................................................................ </span><span style='color:black;text-decoration:none'>33</span></a></p>

<p class=MsoToc2><a href="#_Toc308680"><span style='color:#193C96'>Section 7.4:
Do loop</span><span style='color:black;text-decoration:none'>...................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>34</span></a></p>

<p class=MsoToc2><a href="#_Toc308681"><span style='color:#193C96'>Section 7.5:
While loop</span><span style='color:black;text-decoration:none'>................................................................................................................................................................................. </span><span style='color:black;text-decoration:none'>34</span></a></p>

<p class=MsoToc1><a href="#_Toc308682"><b><span style='font-size:12.0pt;
line-height:110%;color:#193C96'>Chapter 8: Comments</span></b><span
style='color:black;text-decoration:none'>................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>35</span></a></p>

<p class=MsoToc2><a href="#_Toc308683"><span style='color:#193C96'>Section 8.1:
Apostrophe Comments</span><span style='color:black;text-decoration:none'>........................................................................................................................................................... </span><span style='color:black;text-decoration:none'>35</span></a></p>

<p class=MsoToc2><a href="#_Toc308684"><span style='color:#193C96'>Section 8.2:
REM Comments</span><span style='color:black;text-decoration:none'>....................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>35</span></a></p>

<p class=MsoToc1><a href="#_Toc308685"><b><span style='font-size:12.0pt;
line-height:110%;color:#193C96'>Chapter 9: Arrays</span></b><span
style='color:black;text-decoration:none'>............................................................................................................................................................................................. </span><span style='color:black;text-decoration:none'>36</span></a></p>

<p class=MsoToc2><a href="#_Toc308686"><span style='color:#193C96'>Section 9.1:
Multidimensional Arrays</span><span style='color:black;text-decoration:none'>........................................................................................................................................................ </span><span style='color:black;text-decoration:none'>36</span></a></p>

<p class=MsoToc2><a href="#_Toc308687"><span style='color:#193C96'>Section 9.2:
Dynamic Arrays (Array Resizing and Dynamic Handling)</span><span
style='color:black;text-decoration:none'>.................................................................................................. </span><span style='color:black;text-decoration:none'>41</span></a></p>

<p class=MsoToc2><a href="#_Toc308688"><span style='color:#193C96'>Section 9.3:
Jagged Arrays (Arrays of Arrays)</span><span style='color:black;text-decoration:
none'>........................................................................................................................................... </span><span style='color:black;text-decoration:none'>42</span></a></p>

<p class=MsoToc2><a href="#_Toc308689"><span style='color:#193C96'>Section 9.4:
Declaring an Array in VBA</span><span style='color:black;text-decoration:none'>...................................................................................................................................................... </span><span style='color:black;text-decoration:none'>45</span></a></p>

<p class=MsoToc2><a href="#_Toc308690"><span style='color:#193C96'>Section 9.5:
Use of Split to create an array from a string</span><span style='color:black;
text-decoration:none'>....................................................................................................................... </span><span style='color:black;text-decoration:none'>46</span></a></p>

<p class=MsoToc2><a href="#_Toc308691"><span style='color:#193C96'>Section 9.6:
Iterating elements of an array</span><span style='color:black;text-decoration:
none'>............................................................................................................................................... </span><span style='color:black;text-decoration:none'>47</span></a></p>

<p class=MsoToc1><a href="#_Toc308692"><b><span style='font-size:12.0pt;
line-height:110%;color:#193C96'>Chapter 10: Error Handling</span></b><span
style='color:black;text-decoration:none'>......................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>49</span></a></p>

<p class=MsoToc2><a href="#_Toc308693"><span style='color:#193C96'>Section
10.1: Avoiding error conditions</span><span style='color:black;text-decoration:
none'>..................................................................................................................................................... </span><span style='color:black;text-decoration:none'>49</span></a></p>

<p class=MsoToc2><a href="#_Toc308694"><span style='color:#193C96'>Section
10.2: Custom Errors</span><span style='color:black;text-decoration:none'>......................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>49</span></a></p>

<p class=MsoToc2><a href="#_Toc308695"><span style='color:#193C96'>Section
10.3: Resume keyword</span><span style='color:black;text-decoration:none'>................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>50</span></a></p>

<p class=MsoToc2><a href="#_Toc308696"><span style='color:#193C96'>Section
10.4: On Error statement</span><span style='color:black;text-decoration:none'>............................................................................................................................................................... </span><span style='color:black;text-decoration:none'>52</span></a></p>

<p class=MsoToc1><a href="#_Toc308697"><b><span style='font-size:12.0pt;
line-height:110%;color:#193C96'>Chapter 11: Recursion</span></b><span
style='color:black;text-decoration:none'>................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>55</span></a></p>

<p class=MsoToc2><a href="#_Toc308698"><span style='color:#193C96'>Section
11.1: Factorials</span><span style='color:black;text-decoration:none'>................................................................................................................................................................................. </span><span style='color:black;text-decoration:none'>55</span></a></p>

<p class=MsoToc2><a href="#_Toc308699"><span style='color:#193C96'>Section
11.2: Folder Recursion</span><span style='color:black;text-decoration:none'>.................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>55</span></a></p>

<p class=MsoToc1><a href="#_Toc308700"><b><span style='font-size:12.0pt;
line-height:110%;color:#193C96'>Chapter 12: Conditional Compilation</span></b><span
style='color:black;text-decoration:none'>................................................................................................................................................... </span><span style='color:black;text-decoration:none'>57</span></a></p>

<p class=MsoToc2><a href="#_Toc308701"><span style='color:#193C96'>Section
12.1: Changing code behavior at compile time</span><span style='color:black;
text-decoration:none'>.......................................................................................................................... </span><span style='color:black;text-decoration:none'>57</span></a></p>

<p class=MsoToc2><a href="#_Toc308702"><span style='color:#193C96'>Section
12.2: Using Declare Imports that work on all versions of O&#57380;ce</span><span
style='color:black;text-decoration:none'>.............................................................................................. </span><span style='color:black;text-decoration:none'>58</span></a></p>

<p class=MsoToc1><a href="#_Toc308703"><b><span style='font-size:12.0pt;
line-height:110%;color:#193C96'>Chapter 13: Data Types and Limits</span></b><span
style='color:black;text-decoration:none'>........................................................................................................................................................ </span><span style='color:black;text-decoration:none'>60</span></a></p>

<p class=MsoToc2><a href="#_Toc308704"><span style='color:#193C96'>Section
13.1: Variant</span><span style='color:black;text-decoration:none'>..................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>60</span></a></p>

<p class=MsoToc2><a href="#_Toc308705"><span style='color:#193C96'>Section
13.2: Boolean</span><span style='color:black;text-decoration:none'>................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>61</span></a></p>

<p class=MsoToc2><a href="#_Toc308706"><span style='color:#193C96'>Section
13.3: String</span><span style='color:black;text-decoration:none'>....................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>61</span></a></p>

<p class=MsoToc2><a href="#_Toc308707"><span style='color:#193C96'>Section
13.4: Byte</span><span style='color:black;text-decoration:none'>.......................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>62</span></a></p>

<p class=MsoToc2><a href="#_Toc308708"><span style='color:#193C96'>Section
13.5: Currency</span><span style='color:black;text-decoration:none'>.................................................................................................................................................................................. </span><span style='color:black;text-decoration:none'>63</span></a></p>

<p class=MsoToc2><a href="#_Toc308709"><span style='color:#193C96'>Section
13.6: Decimal</span><span style='color:black;text-decoration:none'>................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>63</span></a></p>

<p class=MsoToc2><a href="#_Toc308710"><span style='color:#193C96'>Section
13.7: Integer</span><span style='color:black;text-decoration:none'>..................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>63</span></a></p>

<p class=MsoToc2><a href="#_Toc308711"><span style='color:#193C96'>Section
13.8: Long</span><span style='color:black;text-decoration:none'>......................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>63</span></a></p>

<p class=MsoToc2><a href="#_Toc308712"><span style='color:#193C96'>Section
13.9: Single</span><span style='color:black;text-decoration:none'>....................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>64</span></a></p>

<p class=MsoToc2><a href="#_Toc308713"><span style='color:#193C96'>Section
13.10: Double</span><span style='color:black;text-decoration:none'>................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>64</span></a></p>

<p class=MsoToc2><a href="#_Toc308714"><span style='color:#193C96'>Section
13.11: Date</span><span style='color:black;text-decoration:none'>....................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>64</span></a></p>

<p class=MsoToc2><a href="#_Toc308715"><span style='color:#193C96'>Section
13.12: LongLong</span><span style='color:black;text-decoration:none'>............................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>65</span></a></p>

<p class=MsoToc2><a href="#_Toc308716"><span style='color:#193C96'>Section
13.13: LongPtr</span><span style='color:black;text-decoration:none'>.................................................................................................................................................................................. </span><span style='color:black;text-decoration:none'>65</span></a></p>

<p class=MsoToc1><a href="#_Toc308717"><b><span style='font-size:12.0pt;
line-height:110%;color:#193C96'>Chapter 14: String Literals - Escaping,
non-printable characters and line-continuations</span></b><span
style='color:black;text-decoration:none'> ...................................... </span><span style='color:black;text-decoration:none'>66</span></a></p>

<p class=MsoToc2><a href="#_Toc308718"><span style='color:#193C96'>Section
14.1: Escaping the &quot; character</span><span style='color:black;text-decoration:
none'>...................................................................................................................................................... </span><span style='color:black;text-decoration:none'>66</span></a></p>

<p class=MsoToc2><a href="#_Toc308719"><span style='color:#193C96'>Section
14.2: Assigning long string literals</span><span style='color:black;text-decoration:
none'>................................................................................................................................................ </span><span style='color:black;text-decoration:none'>66</span></a></p>

<p class=MsoToc2><a href="#_Toc308720"><span style='color:#193C96'>Section
14.3: Using VBA string constants</span><span style='color:black;text-decoration:
none'>.................................................................................................................................................. </span><span style='color:black;text-decoration:none'>66</span></a></p>

<p class=MsoToc1><a href="#_Toc308721"><b><span style='font-size:12.0pt;
line-height:110%;color:#193C96'>Chapter 15: Declaring and assigning strings</span></b><span
style='color:black;text-decoration:none'>..................................................................................................................................... </span><span style='color:black;text-decoration:none'>68</span></a></p>

<p class=MsoToc2><a href="#_Toc308722"><span style='color:#193C96'>Section
15.1: Assignment to and from a byte array</span><span style='color:black;
text-decoration:none'>................................................................................................................................ </span><span style='color:black;text-decoration:none'>68</span></a></p>

<p class=MsoToc2><a href="#_Toc308723"><span style='color:#193C96'>Section
15.2: Declare a string constant</span><span style='color:black;text-decoration:
none'>..................................................................................................................................................... </span><span style='color:black;text-decoration:none'>68</span></a></p>

<p class=MsoToc2><a href="#_Toc308724"><span style='color:#193C96'>Section
15.3: Declare a variable-width string variable</span><span style='color:black;
text-decoration:none'>............................................................................................................................ </span><span style='color:black;text-decoration:none'>68</span></a></p>

<p class=MsoToc2><a href="#_Toc308725"><span style='color:#193C96'>Section
15.4: Declare and assign a fixed-width string</span><span style='color:black;
text-decoration:none'>............................................................................................................................. </span><span style='color:black;text-decoration:none'>68</span></a></p>

<p class=MsoToc2><a href="#_Toc308726"><span style='color:#193C96'>Section
15.5: Declare and assign a string array</span><span style='color:black;
text-decoration:none'>........................................................................................................................................ </span><span style='color:black;text-decoration:none'>68</span></a></p>

<p class=MsoToc2><a href="#_Toc308727"><span style='color:#193C96'>Section
15.6: Assign specific characters within a string using Mid statement</span><span
style='color:black;text-decoration:none'>.................................................................................... </span><span style='color:black;text-decoration:none'>69</span></a></p>

<p class=MsoToc1><a href="#_Toc308728"><b><span style='font-size:12.0pt;
line-height:110%;color:#193C96'>Chapter 16: Converting other types to strings</span></b><span
style='color:black;text-decoration:none'>................................................................................................................................ </span><span style='color:black;text-decoration:none'>70</span></a></p>

<p class=MsoToc2><a href="#_Toc308729"><span style='color:#193C96'>Section
16.1: Use CStr to convert a numeric type to a string</span><span
style='color:black;text-decoration:none'>................................................................................................................ </span><span style='color:black;text-decoration:none'>70</span></a></p>

<p class=MsoToc2><a href="#_Toc308730"><span style='color:#193C96'>Section
16.2: Use Format to convert and format a numeric type as a string</span><span
style='color:black;text-decoration:none'>..................................................................................... </span><span style='color:black;text-decoration:none'>70</span></a></p>

<p class=MsoToc2><a href="#_Toc308731"><span style='color:#193C96'>Section
16.3: Use StrConv to convert a byte-array of single-byte characters to a string</span><span
style='color:black;text-decoration:none'>.................................................................. </span><span style='color:black;text-decoration:none'>70</span></a></p>

<p class=MsoToc2><a href="#_Toc308732"><span style='color:#193C96'>Section
16.4: Implicitly convert a byte array of multi-byte-characters to a string</span><span
style='color:black;text-decoration:none'>............................................................................. </span><span style='color:black;text-decoration:none'>70</span></a></p>

<p class=MsoToc1><a href="#_Toc308733"><b><span style='font-size:12.0pt;
line-height:110%;color:#193C96'>Chapter 17: Searching within strings for the
presence of substrings</span></b><span style='color:black;text-decoration:none'>................................................................................. </span><span style='color:black;text-decoration:none'>71</span></a></p>

<p class=MsoToc2><a href="#_Toc308734"><span style='color:#193C96'>Section
17.1: Use InStr to determine if a string contains a substring</span><span
style='color:black;text-decoration:none'>................................................................................................... </span><span style='color:black;text-decoration:none'>71</span></a></p>

<p class=MsoToc2><a href="#_Toc308735"><span style='color:#193C96'>Section
17.2: Use InStrRev to find the position of the last instance of a substring</span><span
style='color:black;text-decoration:none'>........................................................................... </span><span style='color:black;text-decoration:none'>71</span></a></p>

<p class=MsoToc2><a href="#_Toc308736"><span style='color:#193C96'>Section
17.3: Use InStr to find the position of the first instance of a substring</span><span
style='color:black;text-decoration:none'>................................................................................. </span><span style='color:black;text-decoration:none'>71</span></a></p>

<p class=MsoToc1><a href="#_Toc308737"><b><span style='font-size:12.0pt;
line-height:110%;color:#193C96'>Chapter 18: Substrings</span></b><span
style='color:black;text-decoration:none'>.................................................................................................................................................................................. </span><span style='color:black;text-decoration:none'>72</span></a></p>

<p class=MsoToc2><a href="#_Toc308738"><span style='color:#193C96'>Section
18.1: Use Left or Left$ to get the 3 left-most characters in a string</span><span
style='color:black;text-decoration:none'>....................................................................................... </span><span style='color:black;text-decoration:none'>72</span></a></p>

<p class=MsoToc2><a href="#_Toc308739"><span style='color:#193C96'>Section
18.2: Use Right or Right$ to get the 3 right-most characters in a string</span><span
style='color:black;text-decoration:none'>................................................................................ </span><span style='color:black;text-decoration:none'>72</span></a></p>

<p class=MsoToc2><a href="#_Toc308740"><span style='color:#193C96'>Section
18.3: Use Mid or Mid$ to get specific characters from within a string</span><span
style='color:black;text-decoration:none'>.................................................................................. </span><span style='color:black;text-decoration:none'>72</span></a></p>

<p class=MsoToc2><a href="#_Toc308741"><span style='color:#193C96'>Section
18.4: Use Trim to get a copy of the string without any leading or trailing
spaces</span><span style='color:black;text-decoration:none'>............................................................... </span><span style='color:black;text-decoration:none'>72</span></a></p>

<p class=MsoToc1><a href="#_Toc308742"><b><span style='font-size:12.0pt;
line-height:110%;color:#193C96'>Chapter 19: Measuring the length of strings</span></b><span
style='color:black;text-decoration:none'>................................................................................................................................... </span><span style='color:black;text-decoration:none'>73</span></a></p>

<p class=MsoToc2><a href="#_Toc308743"><span style='color:#193C96'>Section
19.1: Use the Len function to determine the number of characters in a string</span><span
style='color:black;text-decoration:none'>................................................................... </span><span style='color:black;text-decoration:none'>73</span></a></p>

<p class=MsoToc2><a href="#_Toc308744"><span style='color:#193C96'>Section
19.2: Use the LenB function to determine the number of bytes in a string</span><span
style='color:black;text-decoration:none'>......................................................................... </span><span style='color:black;text-decoration:none'>73</span></a></p>

<p class=MsoToc2><a href="#_Toc308745"><span style='color:#193C96'>Section
19.3: Prefer `If Len(myString) = 0 Then` over `If myString = &quot;&quot; Then`</span><span
style='color:black;text-decoration:none'>.................................................................................... </span><span style='color:black;text-decoration:none'>73</span></a></p>

<p class=MsoToc1><a href="#_Toc308746"><b><span style='font-size:12.0pt;
line-height:110%;color:#193C96'>Chapter 20: Working with ADO</span></b><span
style='color:black;text-decoration:none'>............................................................................................................................................................... </span><span style='color:black;text-decoration:none'>74</span></a></p>

<p class=MsoToc2><a href="#_Toc308747"><span style='color:#193C96'>Section
20.1: Making a connection to a data source</span><span style='color:black;
text-decoration:none'>.............................................................................................................................. </span><span style='color:black;text-decoration:none'>74</span></a></p>

<p class=MsoToc2><a href="#_Toc308748"><span style='color:#193C96'>Section
20.2: Creating parameterized commands</span><span style='color:black;
text-decoration:none'>................................................................................................................................... </span><span style='color:black;text-decoration:none'>74</span></a></p>

<p class=MsoToc2><a href="#_Toc308749"><span style='color:#193C96'>Section
20.3: Retrieving records with a query</span><span style='color:black;
text-decoration:none'>.......................................................................................................................................... </span><span style='color:black;text-decoration:none'>75</span></a></p>

<p class=MsoToc2><a href="#_Toc308750"><span style='color:#193C96'>Section
20.4: Executing non-scalar functions</span><span style='color:black;text-decoration:
none'>........................................................................................................................................... </span><span style='color:black;text-decoration:none'>77</span></a></p>

<p class=MsoToc1><a href="#_Toc308751"><b><span style='font-size:12.0pt;
line-height:110%;color:#193C96'>Chapter 21: Concatenating strings</span></b><span
style='color:black;text-decoration:none'>......................................................................................................................................................... </span><span style='color:black;text-decoration:none'>78</span></a></p>

<p class=MsoToc2><a href="#_Toc308752"><span style='color:#193C96'>Section
21.1: Concatenate an array of strings using the Join function</span><span
style='color:black;text-decoration:none'>................................................................................................ </span><span style='color:black;text-decoration:none'>78</span></a></p>

<p class=MsoToc2><a href="#_Toc308753"><span style='color:#193C96'>Section
21.2: Concatenate strings using the &amp; operator</span><span
style='color:black;text-decoration:none'>........................................................................................................................ </span><span style='color:black;text-decoration:none'>78</span></a></p>

<p class=MsoToc1><a href="#_Toc308754"><b><span style='font-size:12.0pt;
line-height:110%;color:#193C96'>Chapter 22: Assigning strings with repeated
characters</span></b><span style='color:black;text-decoration:none'>........................................................................................................... </span><span style='color:black;text-decoration:none'>79</span></a></p>

<p class=MsoToc2><a href="#_Toc308755"><span style='color:#193C96'>Section
22.1: Use the String function to assign a string with n repeated characters</span><span
style='color:black;text-decoration:none'>........................................................................ </span><span style='color:black;text-decoration:none'>79</span></a></p>

<p class=MsoToc2><a href="#_Toc308756"><span style='color:#193C96'>Section
22.2: Use the String and Space functions to assign an n-character string</span><span
style='color:black;text-decoration:none'>............................................................................ </span><span style='color:black;text-decoration:none'>79</span></a></p>

<p class=MsoToc1><a href="#_Toc308757"><b><span style='font-size:12.0pt;
line-height:110%;color:#193C96'>Chapter 23: Scripting.Dictionary object</span></b><span
style='color:black;text-decoration:none'>.............................................................................................................................................. </span><span style='color:black;text-decoration:none'>80</span></a></p>

<p class=MsoToc2><a href="#_Toc308758"><span style='color:#193C96'>Section
23.1: Properties and Methods</span><span style='color:black;text-decoration:
none'>...................................................................................................................................................... </span><span style='color:black;text-decoration:none'>80</span></a></p>

<p class=MsoToc1><a href="#_Toc308759"><b><span style='font-size:12.0pt;
line-height:110%;color:#193C96'>Chapter 24: VBA Option Keyword</span></b><span
style='color:black;text-decoration:none'>.......................................................................................................................................................... </span><span style='color:black;text-decoration:none'>82</span></a></p>

<p class=MsoToc2><a href="#_Toc308760"><span style='color:#193C96'>Section
24.1: Option Explicit</span><span style='color:black;text-decoration:none'>........................................................................................................................................................................ </span><span style='color:black;text-decoration:none'>82</span></a></p>

<p class=MsoToc2><a href="#_Toc308761"><span style='color:#193C96'>Section
24.2: Option Base {0 | 1}</span><span style='color:black;text-decoration:none'>................................................................................................................................................................ </span><span style='color:black;text-decoration:none'>83</span></a></p>

<p class=MsoToc2><a href="#_Toc308762"><span style='color:#193C96'>Section
24.3: Option Compare {Binary | Text | Database}</span><span style='color:black;
text-decoration:none'>..................................................................................................................... </span><span style='color:black;text-decoration:none'>85</span></a></p>

<p class=MsoToc1><a href="#_Toc308763"><b><span style='font-size:12.0pt;
line-height:110%;color:#193C96'>Chapter 25: Date Time Manipulation</span></b><span
style='color:black;text-decoration:none'>................................................................................................................................................... </span><span style='color:black;text-decoration:none'>87</span></a></p>

<p class=MsoToc2><a href="#_Toc308764"><span style='color:#193C96'>Section
25.1: Calendar</span><span style='color:black;text-decoration:none'>.................................................................................................................................................................................. </span><span style='color:black;text-decoration:none'>87</span></a></p>

<p class=MsoToc2><a href="#_Toc308765"><span style='color:#193C96'>Section
25.2: Base functions</span><span style='color:black;text-decoration:none'>........................................................................................................................................................................ </span><span style='color:black;text-decoration:none'>87</span></a></p>

<p class=MsoToc2><a href="#_Toc308766"><span style='color:#193C96'>Section
25.3: Extraction functions</span><span style='color:black;text-decoration:none'>.............................................................................................................................................................. </span><span style='color:black;text-decoration:none'>89</span></a></p>

<p class=MsoToc2><a href="#_Toc308767"><span style='color:#193C96'>Section
25.4: Calculation functions</span><span style='color:black;text-decoration:
none'>............................................................................................................................................................ </span><span style='color:black;text-decoration:none'>90</span></a></p>

<p class=MsoToc2><a href="#_Toc308768"><span style='color:#193C96'>Section
25.5: Conversion and Creation</span><span style='color:black;text-decoration:
none'>...................................................................................................................................................... </span><span style='color:black;text-decoration:none'>92</span></a></p>

<p class=MsoToc1><a href="#_Toc308769"><b><span style='font-size:12.0pt;
line-height:110%;color:#193C96'>Chapter 26: Creating a Custom Class</span></b><span
style='color:black;text-decoration:none'>.................................................................................................................................................... </span><span style='color:black;text-decoration:none'>94</span></a></p>

<p class=MsoToc2><a href="#_Toc308770"><span style='color:#193C96'>Section
26.1: Adding a Property to a Class</span><span style='color:black;text-decoration:
none'>................................................................................................................................................ </span><span style='color:black;text-decoration:none'>94</span></a></p>

<p class=MsoToc2><a href="#_Toc308771"><span style='color:#193C96'>Section
26.2: Class module scope, instancing and re-use</span><span style='color:black;
text-decoration:none'>...................................................................................................................... </span><span style='color:black;text-decoration:none'>95</span></a></p>

<p class=MsoToc2><a href="#_Toc308772"><span style='color:#193C96'>Section
26.3: Adding Functionality to a Class</span><span style='color:black;
text-decoration:none'>........................................................................................................................................... </span><span style='color:black;text-decoration:none'>95</span></a></p>

<p class=MsoToc1><a href="#_Toc308773"><b><span style='font-size:12.0pt;
line-height:110%;color:#193C96'>Chapter 27: Events</span></b><span
style='color:black;text-decoration:none'>.......................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>97</span></a></p>

<p class=MsoToc2><a href="#_Toc308774"><span style='color:#193C96'>Section
27.1: Sources and Handlers</span><span style='color:black;text-decoration:none'>........................................................................................................................................................... </span><span style='color:black;text-decoration:none'>97</span></a></p>

<p class=MsoToc2><a href="#_Toc308775"><span style='color:#193C96'>Section
27.2: Passing data back to the event source</span><span style='color:black;
text-decoration:none'>.............................................................................................................................. </span><span style='color:black;text-decoration:none'>99</span></a></p>

<p class=MsoToc1><a href="#_Toc308776"><b><span style='font-size:12.0pt;
line-height:110%;color:#193C96'>Chapter 28: Attributes</span></b><span
style='color:black;text-decoration:none'>................................................................................................................................................................................ </span><span style='color:black;text-decoration:none'>101</span></a></p>

<p class=MsoToc2><a href="#_Toc308777"><span style='color:#193C96'>Section
28.1: VB_PredeclaredId</span><span style='color:black;text-decoration:none'>............................................................................................................................................................... </span><span style='color:black;text-decoration:none'>101</span></a></p>

<p class=MsoToc2><a href="#_Toc308778"><span style='color:#193C96'>Section
28.2: VB_[Var]UserMemId</span><span style='color:black;text-decoration:none'>.......................................................................................................................................................... </span><span style='color:black;text-decoration:none'>101</span></a></p>

<p class=MsoToc2><a href="#_Toc308779"><span style='color:#193C96'>Section
28.3: VB_Exposed</span><span style='color:black;text-decoration:none'>......................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>102</span></a></p>

<p class=MsoToc2><a href="#_Toc308780"><span style='color:#193C96'>Section
28.4: VB_Description</span><span style='color:black;text-decoration:none'>.................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>103</span></a></p>

<p class=MsoToc2><a href="#_Toc308781"><span style='color:#193C96'>Section
28.5: VB_Name</span><span style='color:black;text-decoration:none'>.............................................................................................................................................................................. </span><span style='color:black;text-decoration:none'>103</span></a></p>

<p class=MsoToc2><a href="#_Toc308782"><span style='color:#193C96'>Section
28.6: VB_GlobalNameSpace</span><span style='color:black;text-decoration:none'>....................................................................................................................................................... </span><span style='color:black;text-decoration:none'>103</span></a></p>

<p class=MsoToc2><a href="#_Toc308783"><span style='color:#193C96'>Section
28.7: VB_Createable</span><span style='color:black;text-decoration:none'>..................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>104</span></a></p>

<p class=MsoToc1><a href="#_Toc308784"><b><span style='font-size:12.0pt;
line-height:110%;color:#193C96'>Chapter 29: User Forms</span></b><span
style='color:black;text-decoration:none'>............................................................................................................................................................................. </span><span style='color:black;text-decoration:none'>105</span></a></p>

<p class=MsoToc2><a href="#_Toc308785"><span style='color:#193C96'>Section
29.1: Best Practices</span><span style='color:black;text-decoration:none'>....................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>105</span></a></p>

<p class=MsoToc2><a href="#_Toc308786"><span style='color:#193C96'>Section
29.2: Handling QueryClose</span><span style='color:black;text-decoration:none'>.......................................................................................................................................................... </span><span style='color:black;text-decoration:none'>107</span></a></p>

<p class=MsoToc1><a href="#_Toc308787"><b><span style='font-size:12.0pt;
line-height:110%;color:#193C96'>Chapter 30: Object-Oriented VBA</span></b><span
style='color:black;text-decoration:none'>........................................................................................................................................................ </span><span style='color:black;text-decoration:none'>109</span></a></p>

<p class=MsoToc2><a href="#_Toc308788"><span style='color:#193C96'>Section
30.1: Abstraction</span><span style='color:black;text-decoration:none'>........................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>109</span></a></p>

<p class=MsoToc2><a href="#_Toc308789"><span style='color:#193C96'>Section
30.2: Encapsulation</span><span style='color:black;text-decoration:none'>....................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>109</span></a></p>

<p class=MsoToc2><a href="#_Toc308790"><span style='color:#193C96'>Section
30.3: Polymorphism</span><span style='color:black;text-decoration:none'>...................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>113</span></a></p>

<p class=MsoToc1><a href="#_Toc308791"><b><span style='font-size:12.0pt;
line-height:110%;color:#193C96'>Chapter 31: Working With Files and Directories
Without Using FileSystemObject</span></b><span style='color:black;text-decoration:
none'>................................................. </span><sub><span style='font-size:15.5pt;line-height:110%;color:black;text-decoration:none'>116</span></sub></a></p>

<p class=MsoToc2><a href="#_Toc308792"><span style='color:#193C96'>Section
31.1: Determining If Folders and Files Exist</span><span style='color:black;
text-decoration:none'>............................................................................................................................. </span><span style='color:black;text-decoration:none'>116</span></a></p>

<p class=MsoToc2><a href="#_Toc308793"><span style='color:#193C96'>Section
31.2: Creating and Deleting File Folders</span><span style='color:black;
text-decoration:none'>................................................................................................................................... </span><span style='color:black;text-decoration:none'>117</span></a></p>

<p class=MsoToc1><a href="#_Toc308794"><b><span style='font-size:12.0pt;
line-height:110%;color:#193C96'>Chapter 32: Operators</span></b><span
style='color:black;text-decoration:none'>................................................................................................................................................................................ </span><span style='color:black;text-decoration:none'>118</span></a></p>

<p class=MsoToc2><a href="#_Toc308795"><span style='color:#193C96'>Section
32.1: Concatenation Operators</span><span style='color:black;text-decoration:
none'>.................................................................................................................................................. </span><span style='color:black;text-decoration:none'>118</span></a></p>

<p class=MsoToc2><a href="#_Toc308796"><span style='color:#193C96'>Section
32.2: Comparison Operators</span><span style='color:black;text-decoration:none'>....................................................................................................................................................... </span><span style='color:black;text-decoration:none'>118</span></a></p>

<p class=MsoToc2><a href="#_Toc308797"><span style='color:#193C96'>Section
32.3: Bitwise \ Logical Operators</span><span style='color:black;text-decoration:
none'>................................................................................................................................................ </span><span style='color:black;text-decoration:none'>120</span></a></p>

<p class=MsoToc2><a href="#_Toc308798"><span style='color:#193C96'>Section
32.4: Mathematical Operators</span><span style='color:black;text-decoration:
none'>.................................................................................................................................................... </span><span style='color:black;text-decoration:none'>122</span></a></p>

<p class=MsoToc1><a href="#_Toc308799"><b><span style='font-size:12.0pt;
line-height:110%;color:#193C96'>Chapter 33: Collections</span></b><span
style='color:black;text-decoration:none'>.............................................................................................................................................................................. </span><span style='color:black;text-decoration:none'>123</span></a></p>

<p class=MsoToc2><a href="#_Toc308800"><span style='color:#193C96'>Section
33.1: Getting the Item Count of a Collection</span><span style='color:black;
text-decoration:none'>........................................................................................................................... </span><span style='color:black;text-decoration:none'>123</span></a></p>

<p class=MsoToc2><a href="#_Toc308801"><span style='color:#193C96'>Section
33.2: Determining if a Key or Item Exists in a Collection</span><span
style='color:black;text-decoration:none'>....................................................................................................... </span><span style='color:black;text-decoration:none'>123</span></a></p>

<p class=MsoToc2><a href="#_Toc308802"><span style='color:#193C96'>Section
33.3: Adding Items to a Collection</span><span style='color:black;text-decoration:
none'>............................................................................................................................................. </span><span style='color:black;text-decoration:none'>124</span></a></p>

<p class=MsoToc2><a href="#_Toc308803"><span style='color:#193C96'>Section
33.4: Removing Items From a Collection</span><span style='color:black;
text-decoration:none'>.................................................................................................................................. </span><span style='color:black;text-decoration:none'>125</span></a></p>

<p class=MsoToc2><a href="#_Toc308804"><span style='color:#193C96'>Section
33.5: Retrieving Items From a Collection</span><span style='color:black;
text-decoration:none'>.................................................................................................................................. </span><span style='color:black;text-decoration:none'>126</span></a></p>

<p class=MsoToc2><a href="#_Toc308805"><span style='color:#193C96'>Section
33.6: Clearing All Items From a Collection</span><span style='color:black;
text-decoration:none'>................................................................................................................................ </span><span style='color:black;text-decoration:none'>127</span></a></p>

<p class=MsoToc1><a href="#_Toc308806"><b><span style='font-size:12.0pt;
line-height:110%;color:#193C96'>Chapter 34: Passing Arguments ByRef or ByVal</span></b><span
style='color:black;text-decoration:none'>........................................................................................................................... </span><span style='color:black;text-decoration:none'>129</span></a></p>

<p class=MsoToc2><a href="#_Toc308807"><span style='color:#193C96'>Section
34.1: Passing Simple Variables ByRef And ByVal</span><span style='color:black;
text-decoration:none'>..................................................................................................................... </span><span style='color:black;text-decoration:none'>129</span></a></p>

<p class=MsoToc2><a href="#_Toc308808"><span style='color:#193C96'>Section
34.2: ByRef</span><span style='color:black;text-decoration:none'>..................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>130</span></a></p>

<p class=MsoToc2><a href="#_Toc308809"><span style='color:#193C96'>Section
34.3: ByVal</span><span style='color:black;text-decoration:none'>...................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>131</span></a></p>

<p class=MsoToc1><a href="#_Toc308810"><b><span style='font-size:12.0pt;
line-height:110%;color:#193C96'>Chapter 35: CreateObject vs. GetObject</span></b><span
style='color:black;text-decoration:none'>.......................................................................................................................................... </span><span style='color:black;text-decoration:none'>133</span></a></p>

<p class=MsoToc2><a href="#_Toc308811"><span style='color:#193C96'>Section
35.1: Demonstrating GetObject and CreateObject</span><span style='color:black;
text-decoration:none'>................................................................................................................. </span><span style='color:black;text-decoration:none'>133</span></a></p>

<p class=MsoToc1><a href="#_Toc308812"><b><span style='font-size:12.0pt;
line-height:110%;color:#193C96'>Chapter 36: Macro security and signing of
VBA-projects/-modules</span></b><span style='color:black;text-decoration:none'>................................................................................ </span><span style='color:black;text-decoration:none'>134</span></a></p>

<p class=MsoToc2><a href="#_Toc308813"><span style='color:#193C96'>Section
36.1: Create a valid digital self-signed certificate SELFCERT.EXE</span><span
style='color:black;text-decoration:none'>.......................................................................................... </span><span style='color:black;text-decoration:none'>134</span></a></p>

<p class=MsoToc1><a href="#_Toc308814"><b><span style='font-size:12.0pt;
line-height:110%;color:#193C96'>Chapter 37: Data Structures</span></b><span
style='color:black;text-decoration:none'>.................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>144</span></a></p>

<p class=MsoToc2><a href="#_Toc308815"><span style='color:#193C96'>Section
37.1: Linked List</span><span style='color:black;text-decoration:none'>............................................................................................................................................................................. </span><span style='color:black;text-decoration:none'>144</span></a></p>

<p class=MsoToc2><a href="#_Toc308816"><span style='color:#193C96'>Section
37.2: Binary Tree</span><span style='color:black;text-decoration:none'>........................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>145</span></a></p>

<p class=MsoToc1><a href="#_Toc308817"><b><span style='font-size:12.0pt;
line-height:110%;color:#193C96'>Chapter 38: Interfaces</span></b><span
style='color:black;text-decoration:none'>................................................................................................................................................................................ </span><span style='color:black;text-decoration:none'>146</span></a></p>

<p class=MsoToc2><a href="#_Toc308818"><span style='color:#193C96'>Section
38.1: Multiple Interfaces in One Class - Flyable and Swimable</span><span
style='color:black;text-decoration:none'>............................................................................................ </span><span style='color:black;text-decoration:none'>146</span></a></p>

<p class=MsoToc2><a href="#_Toc308819"><span style='color:#193C96'>Section
38.2: Simple Interface - Flyable</span><span style='color:black;text-decoration:
none'>.................................................................................................................................................. </span><span style='color:black;text-decoration:none'>147</span></a></p>

<p class=MsoToc1><a href="#_Toc308820"><b><span style='font-size:12.0pt;
line-height:110%;color:#193C96'>Chapter 39: Reading 2GB+ files in binary in VBA
and File Hashes</span></b><span style='color:black;text-decoration:none'>..................................................................................... </span><span style='color:black;text-decoration:none'>149</span></a></p>

<p class=MsoToc2><a href="#_Toc308821"><span style='color:#193C96'>Section
39.1: This have to be in a Class module, examples later referred as
&quot;Random&quot;</span><span style='color:black;text-decoration:none'>................................................................ </span><span style='color:black;text-decoration:none'>149</span></a></p>

<p class=MsoToc2><a href="#_Toc308822"><span style='color:#193C96'>Section
39.2: Code for Calculating File Hash in a Standard module</span><span
style='color:black;text-decoration:none'>................................................................................................... </span><span style='color:black;text-decoration:none'>152</span></a></p>

<p class=MsoToc2><a href="#_Toc308823"><span style='color:#193C96'>Section
39.3: Calculating all Files Hash from a root Folder</span><span
style='color:black;text-decoration:none'>.................................................................................................................. </span><span style='color:black;text-decoration:none'>154</span></a></p>

<p class=MsoToc1><a href="#_Toc308824"><b><span style='font-size:12.0pt;
line-height:110%;color:#193C96'>Chapter 40: Sorting</span></b><span
style='color:black;text-decoration:none'>...................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>158</span></a></p>

<p class=MsoToc2><a href="#_Toc308825"><span style='color:#193C96'>Section
40.1: Algorithm Implementation - Quick Sort on a One-Dimensional Array</span><span
style='color:black;text-decoration:none'>...................................................................... </span><span style='color:black;text-decoration:none'>158</span></a></p>

<p class=MsoToc2><a href="#_Toc308826"><span style='color:#193C96'>Section
40.2: Using the Excel Library to Sort a One-Dimensional Array</span><span
style='color:black;text-decoration:none'>............................................................................................ </span><span style='color:black;text-decoration:none'>158</span></a></p>

<p class=MsoToc1><a href="#_Toc308827"><b><span style='font-size:12.0pt;
line-height:110%;color:#193C96'>Chapter 41: Frequently used string manipulation</span></b><span
style='color:black;text-decoration:none'>...................................................................................................................... </span><span style='color:black;text-decoration:none'>161</span></a></p>

<p class=MsoToc2><a href="#_Toc308828"><span style='color:#193C96'>Section
41.1: String manipulation frequently used examples</span><span
style='color:black;text-decoration:none'>............................................................................................................. </span><span style='color:black;text-decoration:none'>161</span></a></p>

<p class=MsoToc1><a href="#_Toc308829"><b><span style='font-size:12.0pt;
line-height:110%;color:#193C96'>Chapter 42: Automation or Using other
applications Libraries</span></b><span style='color:black;text-decoration:none'>........................................................................................... </span><span style='color:black;text-decoration:none'>163</span></a></p>

<p class=MsoToc2><a href="#_Toc308830"><span style='color:#193C96'>Section
42.1: VBScript Regular Expressions</span><span style='color:black;text-decoration:
none'>............................................................................................................................................ </span><span style='color:black;text-decoration:none'>163</span></a></p>

<p class=MsoToc2><a href="#_Toc308831"><span style='color:#193C96'>Section
42.2: Scripting File System Object</span><span style='color:black;text-decoration:
none'>.............................................................................................................................................. </span><span style='color:black;text-decoration:none'>164</span></a></p>

<p class=MsoToc2><a href="#_Toc308832"><span style='color:#193C96'>Section
42.3: Scripting Dictionary object</span><span style='color:black;text-decoration:
none'>................................................................................................................................................ </span><span style='color:black;text-decoration:none'>164</span></a></p>

<p class=MsoToc2><a href="#_Toc308833"><span style='color:#193C96'>Section
42.4: Internet Explorer Object</span><span style='color:black;text-decoration:
none'>.................................................................................................................................................... </span><span style='color:black;text-decoration:none'>165</span></a></p>

<p class=MsoToc1><a href="#_Toc308834"><b><span style='font-size:12.0pt;
line-height:110%;color:#193C96'>Chapter 43: VBA Run-Time Errors</span></b><span
style='color:black;text-decoration:none'>........................................................................................................................................................ </span><span style='color:black;text-decoration:none'>168</span></a></p>

<p class=MsoToc2><a href="#_Toc308835"><span style='color:#193C96'>Section
43.1: Run-time error '6': Overflow</span><span style='color:black;text-decoration:
none'>............................................................................................................................................. </span><span style='color:black;text-decoration:none'>168</span></a></p>

<p class=MsoToc2><a href="#_Toc308836"><span style='color:#193C96'>Section
43.2: Run-time error '9': Subscript out of range</span><span style='color:black;
text-decoration:none'>...................................................................................................................... </span><span style='color:black;text-decoration:none'>168</span></a></p>

<p class=MsoToc2><a href="#_Toc308837"><span style='color:#193C96'>Section
43.3: Run-time error '13': Type mismatch</span><span style='color:black;
text-decoration:none'>................................................................................................................................ </span><span style='color:black;text-decoration:none'>169</span></a></p>

<p class=MsoToc2><a href="#_Toc308838"><span style='color:#193C96'>Section
43.4: Run-time error '91': Object variable or With block variable not set</span><span
style='color:black;text-decoration:none'>.......................................................................... </span><span style='color:black;text-decoration:none'>169</span></a></p>

<p class=MsoToc2><a href="#_Toc308839"><span style='color:#193C96'>Section
43.5: Run-time error '20': Resume without error</span><span style='color:black;
text-decoration:none'>................................................................................................................... </span><span style='color:black;text-decoration:none'>170</span></a></p>

<p class=MsoToc2><a href="#_Toc308840"><span style='color:#193C96'>Section
43.6: Run-time error '3': Return without GoSub</span><span style='color:black;
text-decoration:none'>..................................................................................................................... </span><span style='color:black;text-decoration:none'>171</span></a></p>

<p class=MsoToc1><a href="#_Toc308841"><b><span style='font-size:12.0pt;
line-height:110%;color:#193C96'>Chapter 44: Copying, returning and passing
arrays</span></b><span style='color:black;text-decoration:none'>................................................................................................................... </span><span style='color:black;text-decoration:none'>173</span></a></p>

<p class=MsoToc2><a href="#_Toc308842"><span style='color:#193C96'>Section
44.1: Passing Arrays to Proceedures</span><span style='color:black;text-decoration:
none'>.......................................................................................................................................... </span><span style='color:black;text-decoration:none'>173</span></a></p>

<p class=MsoToc2><a href="#_Toc308843"><span style='color:#193C96'>Section
44.2: Copying Arrays</span><span style='color:black;text-decoration:none'>..................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>173</span></a></p>

<p class=MsoToc2><a href="#_Toc308844"><span style='color:#193C96'>Section
44.3: Returning Arrays from Functions</span><span style='color:black;
text-decoration:none'>..................................................................................................................................... </span><span style='color:black;text-decoration:none'>175</span></a></p>

<p class=MsoToc1><a href="#_Toc308845"><b><span style='font-size:12.0pt;
line-height:110%;color:#193C96'>Chapter 45: Non-Latin Characters</span></b><span
style='color:black;text-decoration:none'>........................................................................................................................................................ </span><span style='color:black;text-decoration:none'>177</span></a></p>

<p class=MsoToc2><a href="#_Toc308846"><span style='color:#193C96'>Section
45.1: Non-Latin Text in VBA Code</span><span style='color:black;text-decoration:
none'>............................................................................................................................................... </span><span style='color:black;text-decoration:none'>177</span></a></p>

<p class=MsoToc2><a href="#_Toc308847"><span style='color:#193C96'>Section
45.2: Non-Latin Identifiers and Language Coverage</span><span style='color:
black;text-decoration:none'>............................................................................................................... </span><span style='color:black;text-decoration:none'>178</span></a></p>

<p class=MsoToc1><a href="#_Toc308848"><b><span style='font-size:12.0pt;
line-height:110%;color:#193C96'>Chapter 46: API Calls</span></b><span
style='color:black;text-decoration:none'>................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>179</span></a></p>

<p class=MsoToc2><a href="#_Toc308849"><span style='color:#193C96'>Section
46.1: Mac APIs</span><span style='color:black;text-decoration:none'>............................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>179</span></a></p>

<p class=MsoToc2><a href="#_Toc308850"><span style='color:#193C96'>Section
46.2: Get total monitors and screen resolution</span><span style='color:black;
text-decoration:none'>....................................................................................................................... </span><span style='color:black;text-decoration:none'>179</span></a></p>

<p class=MsoToc2><a href="#_Toc308851"><span style='color:#193C96'>Section
46.3: FTP and Regional APIs</span><span style='color:black;text-decoration:
none'>........................................................................................................................................................ </span><span style='color:black;text-decoration:none'>180</span></a></p>

<p class=MsoToc2><a href="#_Toc308852"><span style='color:#193C96'>Section
46.4: API declaration and usage</span><span style='color:black;text-decoration:
none'>................................................................................................................................................. </span><span style='color:black;text-decoration:none'>183</span></a></p>

<p class=MsoToc2><a href="#_Toc308853"><span style='color:#193C96'>Section
46.5: Windows API - Dedicated Module (1 of 2)</span><span style='color:black;
text-decoration:none'>..................................................................................................................... </span><span style='color:black;text-decoration:none'>185</span></a></p>

<p class=MsoToc2><a href="#_Toc308854"><span style='color:#193C96'>Section
46.6: Windows API - Dedicated Module (2 of 2)</span><span style='color:black;
text-decoration:none'>..................................................................................................................... </span><span style='color:black;text-decoration:none'>189</span></a></p>

<p class=MsoToc1><a href="#_Toc308855"><b><span style='font-size:12.0pt;
line-height:110%;color:#193C96'>Credits</span></b><span style='color:black;
text-decoration:none'>................................................................................................................................................................................................................. </span><span style='color:black;text-decoration:none'>194</span></a></p>

<p class=MsoToc1><a href="#_Toc308856"><b><span style='font-size:12.0pt;
line-height:110%;color:#193C96'>You may also like</span></b><span
style='color:black;text-decoration:none'>........................................................................................................................................................................................... </span><span style='color:black;text-decoration:none'>196</span></a></p>

<p class=MsoNormal>&nbsp;</p>

</div>

<span style='font-size:10.0pt;line-height:110%;font-family:"Calibri",sans-serif;
color:black'><br clear=all style='page-break-before:always'>
</span>

<div class=WordSection2>

<h1 style='margin-top:0in;margin-right:0in;margin-bottom:105.15pt;margin-left:
-.25pt'><a name="_Toc308640">About</a></h1>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:116.5pt;
margin-bottom:29.9pt;margin-left:116.5pt;text-align:center;text-indent:0in;
line-height:123%'><span style='font-size:11.0pt;line-height:123%'>Please feel
free to share this PDF with anyone for free, latest version of this book can be
downloaded from: </span><a href="https://goalkicker.com/VBABook"><span
style='font-size:11.0pt;line-height:123%;color:#193C96'>https://goalkicker.com/VBABook</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:109.1pt'>This <i>VBA Notes for Professionals</i> book is compiled
from <a href="https://archive.org/details/documentation-dump.7z"><span
style='color:#193C96'>Stack Overflow</span></a></p>

<p class=MsoNormal align=right style='margin-top:0in;margin-right:82.4pt;
margin-bottom:2.0pt;margin-left:.5pt;text-align:right;line-height:107%'><a
href="https://archive.org/details/documentation-dump.7z"><span
style='color:#193C96'>Documentation</span></a>, the content is written by the
beautiful people at Stack Overflow.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:80.8pt;
margin-bottom:13.35pt;margin-left:81.3pt;text-align:center;line-height:103%'>Text
content is released under Creative Commons BY-SA, see credits at the end of
this book whom contributed to the various chapters. Images may be copyright of
their respective owners unless otherwise specified</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:77.8pt;
margin-bottom:13.35pt;margin-left:78.3pt;text-align:center;line-height:103%'><span
style='position:relative;z-index:-1895824384'><span style='left:0px;position:
absolute;left:87px;top:-275px;width:545px;height:476px'><img width=545
height=476 src="VBA%20Notes%20for%20Professionals_files/image002.gif"></span></span>This
is an unofficial free book created for educational purposes and is not
affiliated with official VBA group(s) or company(s) nor Stack Overflow. All
trademarks and registered trademarks are the property of their respective
company owners</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:74.2pt;
margin-bottom:13.35pt;margin-left:74.7pt;text-align:center;line-height:103%'>The
information presented in this book is not guaranteed to be correct nor
accurate, use at your own risk</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:131.55pt'>Please send feedback and corrections to <u><span
style='color:#193C96'>web@petercv.com</span></u></p>

<h1 style='margin-left:-.25pt'><a name="_Toc308641">Chapter 1: Getting started
with VBA</a></h1>

<h3 style='margin-top:0in;margin-right:0in;margin-bottom:1.1pt;margin-left:
0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;line-height:
110%;color:black;font-weight:normal'> </span><span style='font-size:10.0pt;
line-height:110%;color:black'>Version Office Versions Release
Date Notes Release Date</span></h3>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:3.85pt;
margin-left:0in;text-indent:0in'>Vba6 ? - 2007 [Sometime
after][1] 1992-06-30</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:3.85pt;
margin-left:0in;text-indent:0in'>Vba7 2010 - 2016 [blog.techkit.com][2]
2010-04-15</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:20.8pt;
margin-left:0in;text-indent:0in'>VBA for Mac 2004, 2011 - 2016 2004-05-11</p>

<h2 style='margin-left:-.25pt'><a name="_Toc308642">Section 1.1: Accessing the
Visual Basic Editor in Microsoft O&#57380;ce</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.45pt;
margin-left:.75pt'>You can open the VB editor in any of the Microsoft Office
applications by pressing <span style='border:solid black 1.5pt;padding:0in'>Alt
</span>+<span style='border:solid black 1.5pt;padding:0in'> F11 </span>or
going to the Developer tab and clicking on the &quot;Visual Basic&quot; button.
If you don't see the Developer tab in the Ribbon, check if this is enabled.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>By default the Developer tab is disabled. To enable the
Developer tab go to File -&gt; Options, select Customize Ribbon in the list on
the left. In the right &quot;Customize the Ribbon&quot; treeview find the
Developer tree item and set the check for the Developer checkbox to checked.
Click Ok to close the Options dialog.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><img border=0 width=718
height=498 id="Picture 2184"
src="VBA%20Notes%20for%20Professionals_files/image003.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>The Developer tab is now visible in the Ribbon on which you
can click on &quot;Visual Basic&quot; to open the Visual Basic Editor.
Alternatively you can click on &quot;View Code&quot; to directly view the code
pane of the currently active element, e.g. WorkSheet, Chart, Shape.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:11.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><img border=0 width=718
height=170 id="Picture 2208"
src="VBA%20Notes%20for%20Professionals_files/image004.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><img border=0 width=717
height=404 id="Picture 2210"
src="VBA%20Notes%20for%20Professionals_files/image005.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.55pt;margin-bottom:.25pt;
margin-left:.75pt;text-align:justify;text-justify:inter-ideograph;line-height:
135%'>You can use VBA to automate almost any action that can be performed
interactively (manually) and also provide functionality that is not available
in Microsoft Office. VBA can create a document, add text to it, format it, edit
it, and save it, all without human intervention.</p>

<h2 style='margin-top:0in;margin-right:.55pt;margin-bottom:.25pt;margin-left:
.75pt;text-align:justify;text-justify:inter-ideograph;line-height:135%'><a
name="_Toc308643">Section 1.2: Debugging</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:13.05pt;
margin-left:.75pt'>Debugging is a very powerful way to have a closer look and
fix incorrectly working (or non working) code.</p>

<h4 style='margin-left:.75pt'>Run code step by step</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.5pt;
margin-left:.75pt'>First thing you need to do during debugging is to stop the
code at specific locations and then run it line by line to see whether that
happens what's expected.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:21.4pt'><img width=5 height=165
src="VBA%20Notes%20for%20Professionals_files/image006.gif" align=left
hspace=12>Breakpoint (<span style='border:solid black 1.5pt;padding:0in'> F9 </span>,
Debug - Toggle breakpoint): You can add a breakpoint to any executed line (e.g.
not to declarations), when execution reaches that point it stops, and gives
control to user.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:21.4pt'>You can also add the <b><span style='font-size:9.0pt;
line-height:110%;color:blue;background:#FAFAFA'>Stop</span></b> keyword to a
blank line to have the code stop at that location on runtime. This is useful
if, for example, before declaration lines to which you can't add a breakpoint
with <span style='border:solid black 1.5pt;padding:0in'>F9 </span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:21.4pt'>Step into (<span style='border:solid black 1.5pt;
padding:0in'> F8 </span>, Debug - Step into): executes only one line of code,
if that's a call of a user defined sub / function, then that's executed line by
line.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:21.4pt'>Step over (<span style='border:solid black 1.5pt;
padding:0in'> Shift </span>+<span style='border:solid black 1.5pt;padding:0in'>
F8 </span>, Debug - Step over): executes one line of code, doesn't enter user
defined subs / functions.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:21.4pt'>Step out (<span style='border:solid black 1.5pt;padding:
0in'> Ctrl </span>+<span style='border:solid black 1.5pt;padding:0in'> Shift </span>+<span
style='border:solid black 1.5pt;padding:0in'> F8 </span>, Debug - Step out):
Exit current sub / function (run code until its end).</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=49 style='width:36.75pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:12.75pt'>
  <td width=49 valign=top style='width:36.75pt;border:solid black 1.0pt;
  padding:2.4pt .4pt 0in .4pt;height:12.75pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'>Ctrl </p>
  </td>
 </tr>
</table>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=563 style='width:422.45pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=36 valign=top style='width:27.0pt;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Debug</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;background:#FAFAFA'>.</span></p>
  </td>
  <td width=36 valign=top style='width:27.0pt;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Print</span></p>
  </td>
  <td width=434 valign=top style='width:325.25pt;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'>to print lines to the Immediate Window at
  runtime. You may also use </p>
  </td>
  <td width=50 valign=top style='width:37.8pt;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Debug.?</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:21.4pt'><img width=5 height=25
src="VBA%20Notes%20for%20Professionals_files/image007.gif" align=left
hspace=12>Run to cursor (+<span style='border:solid black 1.5pt;padding:0in'>
F8 </span>, Debug - Run to cursor): run code until reaching the line with the
cursor.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=79 style='width:59.4pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=36 valign=top style='width:27.0pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Debug</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;background:#FAFAFA'>.</span></p>
  </td>
  <td width=36 valign=top style='width:27.0pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Print</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:9.8pt;
margin-left:21.4pt'>You can use as a shortcut for </p>

<h4 style='margin-left:.75pt'>Watches window</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.45pt;
margin-left:.75pt'>Running code line by line is only the first step, we need to
know more details and one tool for that is the watch window (View - Watch
window), here you can see values of defined expressions. To add a variable to
the watch window, either:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:21.4pt'><img width=5 height=45
src="VBA%20Notes%20for%20Professionals_files/image008.gif" align=left
hspace=12>Right-click on it then select &quot;Add watch&quot;.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.8in;margin-bottom:12.45pt;
margin-left:21.4pt'>Right-click in watch window, select &quot;Add watch&quot;.
Go to Debug - Add watch.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.7pt;
margin-left:.75pt'>When you add a new expression you can choose whether you
just want to see it's value, or also break code execution when it's true or
when its value changes.</p>

<h4 style='margin-left:.75pt'>Immediate Window</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.55pt;
margin-left:.75pt'>The immediate window allows you to execute arbitrary code or
print items by preceeding them with either the <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>Print</span> keyword or a single question
mark &quot;<span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>?</span>&quot;</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.85pt;
margin-left:.75pt'>Some examples:</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=122 style='width:91.8pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=86 valign=top style='width:.9in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>ActiveSheet</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;background:#FAFAFA'>.</span></p>
  </td>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Name</span></p>
  </td>
 </tr>
</table>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=158 style='width:1.65in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=122 valign=top style='width:91.8pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Print ActiveSheet</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;background:#FAFAFA'>.</span></p>
  </td>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Name</span></p>
  </td>
 </tr>
</table>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=29 style='width:.3in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>foo</span></p>
  </td>
 </tr>
</table>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=43 style='width:.45in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=14 valign=top style='width:.15in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>x </span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;background:#FAFAFA'>=</span></p>
  </td>
  <td width=22 valign=top style='width:16.2pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'></span><span style='font-size:9.0pt;line-height:107%;color:brown'>10</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:21.4pt'><img width=5 height=65
src="VBA%20Notes%20for%20Professionals_files/image009.gif" align=left
hspace=12><span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>?</span>
- returns name of the active sheet</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:21.4pt'>- returns the name of the active sheet</p>

<p class=MsoNormal style='margin-top:0in;margin-right:338.45pt;margin-bottom:
12.5pt;margin-left:53.3pt;text-indent:-.45in'><span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>?</span> - returns the value of <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>foo</span>* sets <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>x</span> to 10*</p>

<p class=MsoNormal style='margin-top:0in;margin-right:32.55pt;margin-bottom:
0in;margin-left:.75pt;line-height:217%'>* Getting/Setting values for variables
via the Immediate Window can only be done during runtime <b>Debugging best
practices</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.45pt;
margin-left:.75pt'>Whenever your code doesn't work as expected first thing you
should do is to read it again carefully, looking for mistakes.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.45pt;
margin-left:.75pt'>If that doesn't help, then start debugging it; for short
procedures it can be efficient to just execute it line by line, for longer ones
you probably need to set breakpoints or breaks on watched expressions, the goal
here is to find the line not working as expected.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.45pt;
margin-left:.75pt'>Once you have the line which gives the incorrect result, but
the reason is not yet clear, try to simplify expressions, or replace variables
with constants, that can help understanding whether variables' value are wrong.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.8pt;
margin-left:.75pt'>If you still can't solve it, and ask for help:</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=463 style='width:347.35pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=43 valign=top style='width:.45in;background:#FAFAFA;padding:1.05pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Sheets</span></p>
  </td>
  <td width=86 valign=top style='width:.9in;padding:1.05pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;background:#FAFAFA'>(a*b*c+d^</span><span style='font-size:9.0pt;
  line-height:107%;color:brown;background:#FAFAFA'>2</span><span
  style='font-size:9.0pt;line-height:107%;background:#FAFAFA'>).</span></p>
  </td>
  <td width=36 valign=top style='width:27.0pt;background:#FAFAFA;padding:1.05pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Range</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.05pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;background:#FAFAFA'>(</span></p>
  </td>
  <td width=101 valign=top style='width:1.05in;background:#FAFAFA;padding:1.05pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>addressOfRange</span></p>
  </td>
  <td width=46 valign=top style='width:34.15pt;padding:1.05pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;background:#FAFAFA'>)</span> write </p>
  </td>
  <td width=43 valign=top style='width:.45in;background:#FAFAFA;padding:1.05pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Sheets</span></p>
  </td>
  <td width=29 valign=top style='width:.3in;padding:1.05pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;background:#FAFAFA'>(</span><span style='font-size:9.0pt;line-height:
  107%;color:brown;background:#FAFAFA'>4</span><span style='font-size:9.0pt;
  line-height:107%;background:#FAFAFA'>).</span></p>
  </td>
  <td width=36 valign=top style='width:27.0pt;background:#FAFAFA;padding:1.05pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Range</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.05pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;background:#FAFAFA'>(</span></p>
  </td>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:1.05pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:brown'>&quot;A2&quot;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:21.4pt'><img width=5 height=65
src="VBA%20Notes%20for%20Professionals_files/image010.gif" align=left
hspace=12>Include as small part of your code as possible for understanding of
your problem</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:21.4pt'>If the problem is not related to the value of variables,
then replace them by constants. (so, instead of</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:0in;
margin-bottom:2.3pt;margin-left:20.9pt;text-align:center;text-indent:0in;
line-height:107%'><span style='font-size:9.0pt;line-height:107%;background:
#FAFAFA'>)</span>)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:57.5pt;margin-bottom:
0in;margin-left:.25pt;text-indent:5.5pt;line-height:145%'>Describe which line
gives the wrong behaviour, and what it is (error, wrong result...)</p>

<h2 style='margin-top:0in;margin-right:57.5pt;margin-bottom:0in;margin-left:
.25pt;text-indent:5.5pt;line-height:145%'><a name="_Toc308644">Section 1.3:
First Module and Hello World</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>To start coding in the first place, you have to right click
your VBA Project in the left list and add a new Module. Your first <i>Hello-World</i>
Code could look like this:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="VBA%20Notes%20for%20Professionals_files/image011.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>To test it, hit the <i>Play</i>-Button in your Toolbar or
simply hit the <span style='border:solid black 1.5pt;padding:0in'>F5 </span>key.
Congratulations! You've built your first own VBA Module.<br clear=all
style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc308645">Chapter 2: Declaring
Variables</a></h1>

<h2 style='margin-left:-.25pt'><a name="_Toc308646">Section 2.1: Type Hints</a></h2>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=86 style='width:.9in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=22 valign=top style='width:16.2pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;background:#FAFAFA'>[</span></p>
  </td>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>DataType</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Type Hints are <b>heavily</b> discouraged. They exist and
are documented here for historical and backward-compatibility reasons. You
should use the <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>]</span>
syntax instead.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=191
src="VBA%20Notes%20for%20Professionals_files/image012.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Type hints significantly decrease code readability and
encourage a legacy <a href="https://en.wikipedia.org/wiki/Hungarian_notation"><span
style='color:#193C96'>Hungarian Notation</span></a> which <i>also</i> hinders
readability:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src="VBA%20Notes%20for%20Professionals_files/image013.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>Instead, declare variables closer to their usage and name
things for what they're used, not after their type:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src="VBA%20Notes%20for%20Professionals_files/image014.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Type hints can also be used on literals, to enforce a
specific type. By default, a numeric literal smaller than 32,768 will be
interpreted as an <span style='font-size:9.0pt;line-height:110%;color:slateblue;
background:#FAFAFA'>Integer</span> literal, but with a type hint you can
control that:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=76
src="VBA%20Notes%20for%20Professionals_files/image015.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Type hints are usually not needed on literals, because they
would be assigned to a variable declared with an explicit type, or implicitly
converted to the appropriate type when passed as parameters. Implicit
conversions can be avoided using one of the explicit type conversion functions:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:19.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=720 height=92
src="VBA%20Notes%20for%20Professionals_files/image016.gif"></span></p>

<h4 style='margin-left:.75pt'>String-returning built-in functions</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>The majority of the built-in functions that handle strings
come in two versions: A loosely typed version that returns a <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Variant</span>, and
a strongly typed version (ending with <span style='font-size:9.0pt;line-height:
110%;background:#FAFAFA'>$</span>) that returns a <span style='font-size:9.0pt;
line-height:110%;color:slateblue;background:#FAFAFA'>String</span>. Unless you
are assigning the return value to a <span style='font-size:9.0pt;line-height:
110%;background:#FAFAFA'>Variant</span>, you should prefer the version that
returns a <span style='font-size:9.0pt;line-height:110%;color:slateblue;
background:#FAFAFA'>String</span> - otherwise there is an implicit conversion
of the return value.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src="VBA%20Notes%20for%20Professionals_files/image017.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.8pt;
margin-left:.75pt'>These functions are:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:21.4pt'><img width=5 height=526
src="VBA%20Notes%20for%20Professionals_files/image018.gif" align=left
hspace=12>VBA.Conversion.Error -&gt; VBA.Conversion.Error$</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:21.4pt'>VBA.Conversion.Hex -&gt; VBA.Conversion.Hex$</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:21.4pt'>VBA.Conversion.Oct -&gt; VBA.Conversion.Oct$</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:21.4pt'>VBA.Conversion.Str -&gt; VBA.Conversion.Str$</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:21.4pt'>VBA.FileSystem.CurDir -&gt; VBA.FileSystem.CurDir$</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:21.4pt'>VBA.[_HiddenModule].Input -&gt; VBA.[_HiddenModule].Input$</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:21.4pt'>VBA.[_HiddenModule].InputB -&gt;
VBA.[_HiddenModule].InputB$</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:21.4pt'>VBA.Interaction.Command -&gt; VBA.Interaction.Command$</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:21.4pt'>VBA.Interaction.Environ -&gt; VBA.Interaction.Environ$</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:21.4pt'>VBA.Strings.Chr -&gt; VBA.Strings.Chr$</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:21.4pt'>VBA.Strings.ChrB -&gt; VBA.Strings.ChrB$</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:21.4pt'>VBA.Strings.ChrW -&gt; VBA.Strings.ChrW$</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:21.4pt'>VBA.Strings.Format -&gt; VBA.Strings.Format$</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:21.4pt'>VBA.Strings.LCase -&gt; VBA.Strings.LCase$</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:21.4pt'>VBA.Strings.Left -&gt; VBA.Strings.Left$</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:21.4pt'>VBA.Strings.LeftB -&gt; VBA.Strings.LeftB$</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:21.4pt'>VBA.Strings.LTtrim -&gt; VBA.Strings.LTrim$</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:21.4pt'>VBA.Strings.Mid -&gt; VBA.Strings.Mid$</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:21.4pt'>VBA.Strings.MidB -&gt; VBA.Strings.MidB$</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:21.4pt'>VBA.Strings.Right -&gt; VBA.Strings.Right$</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:21.4pt'>VBA.Strings.RightB -&gt; VBA.Strings.RightB$</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:21.4pt'>VBA.Strings.RTrim -&gt; VBA.Strings.RTrim$</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:21.4pt'>VBA.Strings.Space -&gt; VBA.Strings.Space$</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:21.4pt'>VBA.Strings.Str -&gt; VBA.Strings.Str$</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:21.4pt'>VBA.Strings.String -&gt; VBA.Strings.String$</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:21.4pt'>VBA.Strings.Trim -&gt; VBA.Strings.Trim$</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.95pt;
margin-left:21.4pt'>VBA.Strings.UCase -&gt; VBA.Strings.UCase$</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.55pt;
margin-left:.75pt'>Note that these are function <i>aliases</i>, not quite <i>type
hints</i>. The <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Left</span>
function corresponds to the hidden <span style='font-size:9.0pt;line-height:
110%;background:#FAFAFA'>B_Var_Left </span>function, while the <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Left$</span>
version corresponds to the hidden <span style='font-size:9.0pt;line-height:
110%;background:#FAFAFA'>B_Str_Left</span> function.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:26.8pt;margin-bottom:
.25pt;margin-left:.75pt;text-align:justify;text-justify:inter-ideograph;
line-height:135%'>In very early versions of VBA the <span style='font-size:
9.0pt;line-height:135%;background:#FAFAFA'>$</span> sign isn't an allowed
character and the function name had to be enclosed in square brackets. In Word
Basic, there were many, many more functions that returned strings that ended in
$.</p>

<h2 style='margin-top:0in;margin-right:26.8pt;margin-bottom:.25pt;margin-left:
.75pt;text-align:justify;text-justify:inter-ideograph;line-height:135%'><a
name="_Toc308647">Section 2.2: Variables</a></h2>

<h4 style='margin-left:.75pt'>Scope</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.85pt;
margin-left:.75pt'>A variable can be declared (in increasing visibility level):</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:21.4pt'><img width=5 height=85
src="VBA%20Notes%20for%20Professionals_files/image019.gif" align=left
hspace=12>At procedure level, using the <b><span style='font-size:9.0pt;
line-height:110%;color:blue;background:#FAFAFA'>Dim</span></b> keyword in any
procedure; a <i>local variable</i>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:21.4pt'>At module level, using the <b><span style='font-size:9.0pt;
line-height:110%;color:blue;background:#FAFAFA'>Private</span></b> keyword in
any type of module; a <i>private field</i>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:21.4pt'>At instance level, using the <b><span style='font-size:
9.0pt;line-height:110%;color:blue;background:#FAFAFA'>Friend</span></b> keyword
in any type of class module; a <i>friend field</i>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:74.2pt;margin-bottom:
12.5pt;margin-left:21.4pt'>At instance level, using the <b><span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>Public</span></b>
keyword in any type of class module; a <i>public field</i>. Globally, using the
<b><span style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>Public</span></b>
keyword in a <i>standard module</i>; a <i>global variable</i>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Variables should always be declared with the smallest
possible scope: prefer passing parameters to procedures, rather than declaring
global variables.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:28.1pt;
margin-left:.75pt'>See Access Modifiers for more information.</p>

<h4 style='margin-left:.75pt'>Local variables</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>Use the <b><span style='font-size:9.0pt;line-height:110%;
color:blue;background:#FAFAFA'>Dim</span></b> keyword to declare a <i>local
variable</i>:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="VBA%20Notes%20for%20Professionals_files/image020.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=50 style='width:37.8pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=50 valign=top style='width:37.8pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:107%'>
  Type</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>The <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>[]</span> part of the declaration syntax is optional. When
specified, it sets the variable's data type, which determines how much memory
will be allocated to that variable. This declares a <span style='font-size:
9.0pt;line-height:110%;color:slateblue;background:#FAFAFA'>String</span>
variable:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.1pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="VBA%20Notes%20for%20Professionals_files/image021.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>When a type is not specified, the type is implicitly <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Variant</span>:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="VBA%20Notes%20for%20Professionals_files/image022.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>The VBA syntax also supports declaring multiple variables in
a single statement:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="VBA%20Notes%20for%20Professionals_files/image023.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=50 style='width:37.8pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=50 valign=top style='width:37.8pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:107%'>
  Type</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:14.1pt;
margin-left:.75pt'>Notice that the <span style='font-size:9.0pt;line-height:
110%;background:#FAFAFA'>[]</span> has to be specified for each variable (other
than 'Variant' ones). This is a relatively common trap:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:122.9pt;margin-bottom:
6.25pt;margin-left:3.5pt'><span style='position:relative;z-index:-1895816192'><span
style='left:0px;position:absolute;left:0px;top:-9px;width:718px;height:43px'><img
width=718 height=43 src="VBA%20Notes%20for%20Professionals_files/image024.gif"></span></span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Dim</span></b><span
style='font-size:9.0pt;line-height:110%'> integer1, integer2, integer3 </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>Integer</span><span style='font-size:9.0pt;
line-height:110%'> </span><i><span style='font-size:9.0pt;line-height:110%;
color:green'>'Only integer3 is an Integer. </span></i><span style='font-size:
9.0pt;line-height:110%'></span><i><span
style='font-size:9.0pt;line-height:110%;color:green'>'The rest are Variant.</span></i></p>

<h4 style='margin-left:.75pt'>Static variables</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Local variables can also be <b><span style='font-size:9.0pt;
line-height:110%;color:blue;background:#FAFAFA'>Static</span></b>. In VBA the <b><span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>Static</span></b>
keyword is used to make a variable &quot;remember&quot; the value it had, last
time a procedure was called:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.15pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=158
src="VBA%20Notes%20for%20Professionals_files/image025.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.85pt;
margin-left:.75pt'>Here the <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>values</span> collection is declared as a <b><span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>Static</span></b>
local; because it's an <i>object variable</i>, it is initialized to <b><span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>Nothing</span></b>.
The condition that follows the declaration verifies if the object reference was
<b><span style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>Set</span></b>
before - if it's the first time the procedure runs, the collection gets
initialized. <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>DoSomethingElse</span>
might be adding or removing items, and they'll still be in the collection next
time <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>DoSomething</span>
is called.</p>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:24.3pt;margin-left:
.75pt'>Alternative</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:22.05pt;margin-bottom:
1.5pt;margin-left:24.5pt'><img width=3 height=111
src="VBA%20Notes%20for%20Professionals_files/image026.gif" align=left
hspace=12>VBA's <b><span style='font-size:9.0pt;line-height:110%;color:blue;
background:#FAFAFA'>Static</span></b> keyword can easily be misunderstood - <i>especially</i>
by seasoned programmers that usually work in other languages. In many
languages, <b><span style='font-size:9.0pt;line-height:110%;color:blue;
background:#FAFAFA'>static</span></b> is used to make a class member (field,
property, method, ...) belong to the <i>type</i> rather than to the <i>instance</i>.
Code in <b><span style='font-size:9.0pt;line-height:110%;color:blue;background:
#FAFAFA'>static</span></b> context cannot reference code in <i>instance</i>
context. The VBA <b><span style='font-size:9.0pt;line-height:110%;color:blue;
background:#FAFAFA'>Static</span></b> keyword means something wildly different.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.7pt;
margin-left:.75pt'>Often, a <b><span style='font-size:9.0pt;line-height:110%;
color:blue;background:#FAFAFA'>Static</span></b> local could just as well be
implemented as a <b><span style='font-size:9.0pt;line-height:110%;color:blue;
background:#FAFAFA'>Private</span></b>, module-level variable (field) - however
this challenges the principle by which a variable should be declared with the
smallest possible scope; trust your instincts, use whichever you prefer - both
will work... but using <b><span style='font-size:9.0pt;line-height:110%;
color:blue;background:#FAFAFA'>Static</span></b> without understanding what it
does could lead to interesting bugs.</p>

<h4 style='margin-left:.75pt'>Dim vs. Private</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>The <b><span style='font-size:9.0pt;line-height:110%;
color:blue;background:#FAFAFA'>Dim</span></b> keyword is legal at procedure and
module levels; its usage at module level is equivalent to using the <b><span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>Private</span></b>
keyword:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="VBA%20Notes%20for%20Professionals_files/image027.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.45pt;
margin-left:.75pt'>The <b><span style='font-size:9.0pt;line-height:110%;
color:blue;background:#FAFAFA'>Private</span></b> keyword is only legal at
module level; this invites reserving <b><span style='font-size:9.0pt;
line-height:110%;color:blue;background:#FAFAFA'>Dim</span></b> for local
variables and declaring module variables with <b><span style='font-size:9.0pt;
line-height:110%;color:blue;background:#FAFAFA'>Private</span></b>, especially
with the contrasting <b><span style='font-size:9.0pt;line-height:110%;
color:blue;background:#FAFAFA'>Public</span></b> keyword that would have to be
used anyway to declare a public member. Alternatively use <b><span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>Dim</span></b>
<i>everywhere</i> - what matters is <i>consistency</i>:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:13.2pt;
margin-left:.75pt'>&quot;Private fields&quot;</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:21.4pt'><img width=5 height=46
src="VBA%20Notes%20for%20Professionals_files/image028.gif" align=left
hspace=12><b>DO</b> use <b><span style='font-size:9.0pt;line-height:110%;
color:blue;background:#FAFAFA'>Private</span></b> to declare a module-level
variable.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:21.4pt'><b>DO</b> use <b><span style='font-size:9.0pt;line-height:
110%;color:blue;background:#FAFAFA'>Dim</span></b> to declare a local variable.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:13.1pt;
margin-left:21.4pt'><b>DO NOT</b> use <b><span style='font-size:9.0pt;
line-height:110%;color:blue;background:#FAFAFA'>Dim</span></b> to declare a
module-level variable.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:13.1pt;
margin-left:.75pt'>&quot;Dim everywhere&quot;</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:21.4pt'><img width=5 height=46
src="VBA%20Notes%20for%20Professionals_files/image028.gif" align=left
hspace=12><b>DO</b> use <b><span style='font-size:9.0pt;line-height:110%;
color:blue;background:#FAFAFA'>Dim</span></b> to declare anything
private/local.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:214.8pt;margin-bottom:
12.9pt;margin-left:21.4pt'><b>DO NOT</b> use <b><span style='font-size:9.0pt;
line-height:110%;color:blue;background:#FAFAFA'>Private</span></b> to declare a
module-level variable. <b>AVOID</b> declaring <b><span style='font-size:9.0pt;
line-height:110%;color:blue;background:#FAFAFA'>Public</span></b> fields.*</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:28.2pt;
margin-left:.75pt'>*In general, one should avoid declaring <b><span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>Public</span></b>
or <b><span style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>Global</span></b>
fields anyway.</p>

<h4 style='margin-left:.75pt'>Fields</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>A variable declared at module level, in the <i>declarations
section</i> at the top of the module body, is a <i>field</i>. A <b><span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>Public</span></b>
field declared in a <i>standard module</i> is a <i>global variable</i>:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="VBA%20Notes%20for%20Professionals_files/image029.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.55pt;
margin-left:.75pt'>A variable with a global scope can be accessed from
anywhere, including other VBA projects that would reference the project it's
declared in.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>To make a variable global/public, but only visible from
within the project, use the <b><span style='font-size:9.0pt;line-height:110%;
color:blue;background:#FAFAFA'>Friend</span></b> modifier:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="VBA%20Notes%20for%20Professionals_files/image030.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:14.1pt;
margin-left:.75pt'>This is especially useful in add-ins, where the intent is
that other VBA projects reference the add-in project and can consume the public
API.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:97.75pt;margin-bottom:
17.2pt;margin-left:3.5pt'><span style='position:relative;z-index:-1895812096'><span
style='left:0px;position:absolute;left:0px;top:-8px;width:718px;height:43px'><img
width=718 height=43 src="VBA%20Notes%20for%20Professionals_files/image024.gif"></span></span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Friend</span></b><span
style='font-size:9.0pt;line-height:110%'> FriendField </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>Long</span><span style='font-size:9.0pt;
line-height:110%'> </span><i><span style='font-size:9.0pt;line-height:110%;
color:green'>'public within the project, aka for &quot;friend&quot; code </span></i><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Public</span></b><span
style='font-size:9.0pt;line-height:110%'> PublicField </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>Long</span><span style='font-size:9.0pt;
line-height:110%'> </span><i><span style='font-size:9.0pt;line-height:110%;
color:green'>'public within and beyond the project</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Friend fields are not available in standard modules.</p>

<h4 style='margin-left:.75pt'>Instance Fields</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>A variable declared at module level, in the <i>declarations
section</i> at the top of the body of a class module (including</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'><span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>ThisWorkbook</span>, <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>ThisDocument</span>, <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>Worksheet</span>, <span style='font-size:
9.0pt;line-height:110%;background:#FAFAFA'>UserForm</span> and <i>class modules</i>),
is an <i>instance field</i>: it only exists as long as there's an <i>instance</i>
of the class around.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:19.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=217
src="VBA%20Notes%20for%20Professionals_files/image031.gif"></span></p>

<h4 style='margin-left:.75pt'>Encapsulating fields</h4>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=86 style='width:.9in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=86 valign=top style='width:.9in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Property</span></b><span style='font-size:9.0pt;line-height:
  107%'> </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Get</span></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Instance data is often kept <b><span style='font-size:9.0pt;
line-height:110%;color:blue;background:#FAFAFA'>Private</span></b>, and dubbed <i>encapsulated</i>.
A private field can be exposed using a <b><span style='font-size:9.0pt;
line-height:110%;color:blue;background:#FAFAFA'>Property </span></b>procedure.
To expose a private variable publicly without giving write access to the
caller, a class module (or a standard module) implements a member:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=174
src="VBA%20Notes%20for%20Professionals_files/image032.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.55pt;
margin-left:.75pt'>The class itself can modify the encapsulated value, but the
calling code can only access the <b><span style='font-size:9.0pt;line-height:
110%;color:blue;background:#FAFAFA'>Public</span></b> members (and <b><span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>Friend</span></b>
members, if the caller is in the same project).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:13.05pt;
margin-left:.75pt'>To allow the caller to modify:</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=86 style='width:.9in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=86 valign=top style='width:.9in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Property</span></b><span style='font-size:9.0pt;line-height:
  107%'> </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Let</span></b></p>
  </td>
 </tr>
</table>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=86 style='width:.9in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=86 valign=top style='width:.9in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Property</span></b><span style='font-size:9.0pt;line-height:
  107%'> </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Set</span></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:21.4pt'><img width=5 height=26
src="VBA%20Notes%20for%20Professionals_files/image033.gif" align=left
hspace=12>An encapsulated <b>value</b>, a module exposes a member.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:72.15pt;margin-bottom:
0in;margin-left:.25pt;text-indent:5.5pt;line-height:146%'>An encapsulated <b>object
reference</b>, a module exposes a member.</p>

<h2 style='margin-top:0in;margin-right:72.15pt;margin-bottom:0in;margin-left:
.25pt;text-indent:5.5pt;line-height:146%'><a name="_Toc308648">Section 2.3:
Constants (Const)</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.45pt;
margin-left:.75pt'>If you have a value that never changes in your application,
you can define a named constant and use it in place of a literal value.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>You can use Const only at module or procedure level. This
means the declaration context for a variable must be a class, structure,
module, procedure, or block, and cannot be a source file, namespace, or
interface.</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=81
src="VBA%20Notes%20for%20Professionals_files/image034.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=87
src="VBA%20Notes%20for%20Professionals_files/image035.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:14.1pt;
margin-left:.75pt'>Whilst it can be considered good practice to specify
Constant types, it isn't strictly required. Not specifying the type will still
result in the correct type:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:77.6pt;margin-bottom:
12.45pt;margin-left:3.5pt'><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>Public</span></b><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Const</span></b><span
style='font-size:9.0pt;line-height:110%'> GLOBAL_CONSTANT = </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>&quot;Project Version
#1.000.000.001&quot;</span><span style='font-size:9.0pt;line-height:110%'> </span><i><span
style='font-size:9.0pt;line-height:110%;color:green'>'Still a string </span></i><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Public</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Sub</span></b><span style='font-size:9.0pt;
line-height:110%'> ExampleDeclaration()</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Const</span></b><span
style='font-size:9.0pt;line-height:110%'> SOME_CONSTANT = </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>&quot;Hello World&quot;</span><span
style='font-size:9.0pt;line-height:110%'> </span><i><span
style='font-size:9.0pt;line-height:110%;color:green'>'Still a string</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Const</span></b><span
style='font-size:9.0pt;line-height:110%'> DERIVED_CONSTANT =
SOME_CONSTANT </span><i><span style='font-size:9.0pt;line-height:110%;
color:green'>'DERIVED_CONSTANT is also a string</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:101.05pt;margin-bottom:
.2pt;margin-left:3.5pt'><span style='position:relative;z-index:-1895810048'><span
style='left:0px;position:absolute;left:0px;top:-90px;width:718px;height:207px'><img
width=718 height=207 src="VBA%20Notes%20for%20Professionals_files/image036.gif"></span></span><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Const</span></b><span style='font-size:9.0pt;
line-height:110%'> VAR_CONSTANT </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>As</span></b><span style='font-size:9.0pt;
line-height:110%'> Variant = SOME_CONSTANT </span><i><span style='font-size:
9.0pt;line-height:110%;color:green'>'VAR_CONSTANT is Variant/String </span></i><span
style='font-size:9.0pt;line-height:110%'></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.05pt;margin-bottom:.25pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Const</span></b><span
style='font-size:9.0pt;line-height:110%'> PI = </span><span style='font-size:
9.0pt;line-height:110%;color:brown'>3.141592653</span><span style='font-size:
9.0pt;line-height:110%'> </span><i><span style='font-size:9.0pt;
line-height:110%;color:green'>'Still a double</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.05pt;margin-bottom:.25pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Const</span></b><span
style='font-size:9.0pt;line-height:110%'> DERIVED_PI = PI </span><i><span
style='font-size:9.0pt;line-height:110%;color:green'>'DERIVED_PI is also a
double</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.05pt;margin-bottom:.25pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Const</span></b><span
style='font-size:9.0pt;line-height:110%'> VAR_PI </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> Variant = PI </span><i><span
style='font-size:9.0pt;line-height:110%;color:green'>'VAR_PI is Variant/Double</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
margin-left:3.75pt;text-indent:0in;line-height:107%'><span style='font-size:
9.0pt;line-height:107%'> </span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:17.25pt;
margin-left:3.5pt'><b><span style='font-size:9.0pt;line-height:110%;color:blue'>End</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Sub</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.45pt;
margin-left:.75pt'>Note that this is specific to Constants and in contrast to
variables where not specifying the type results in a Variant type.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>While it is possible to explicitly declare a constant as a
String, it is not possible to declare a constant as a string using fixed-width
string syntax</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=92
src="VBA%20Notes%20for%20Professionals_files/image037.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc308649">Section 2.4: Declaring
Fixed-Length Strings</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>In VBA, Strings can be declared with a specific length; they
are automatically padded or truncated to maintain that length as declared.</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=256
src="VBA%20Notes%20for%20Professionals_files/image038.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc308650">Section 2.5: When to use a
Static variable</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.45pt;
margin-left:.75pt'>A Static variable declared locally is not destructed and
does not lose its value when the Sub procedure is exited. Subsequent calls to
the procedure do not require re-initialization or assignment although you may
want to 'zero' any remembered value(s).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:13.05pt;
margin-left:.75pt'>These are particularly useful when late binding an object in
a 'helper' sub that is called repeatedly.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'><b>Snippet 1:</b> Reuse a Scripting.Dictionary object across
many worksheets</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=568
src="VBA%20Notes%20for%20Professionals_files/image039.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'><b>Snippet 2:</b> Create a worksheet UDF that late binds the
VBScript.RegExp object</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=224
src="VBA%20Notes%20for%20Professionals_files/image040.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=719 height=760
src="VBA%20Notes%20for%20Professionals_files/image041.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.45pt;
margin-left:.75pt'>Remember that a UDF is not calculated once in the lifetime
of a workbook. Even a non-volatile UDF will recalculate whenever the values
within the range(s) it references are subject to change. Each subsequent
recalculation event only increases the benefits of a statically declared
variable.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:21.4pt'><img width=5 height=65
src="VBA%20Notes%20for%20Professionals_files/image042.gif" align=left
hspace=12>A Static variable is available for the lifetime of the module, not
the procedure or function in which it was declared and assigned.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:21.4pt'>Static variables can only be declared locally.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.45pt;
margin-left:21.4pt'>Static variable hold many of the same properties of a
private module level variable but with a more restricted scope.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.9in;margin-bottom:1.45pt;
margin-left:-.25pt'>Related reference: <a
href="https://msdn.microsoft.com/en-us/library/z2cty7t8.aspx"><span
style='color:#193C96'>Static (Visual Basic)</span></a></p>

<h2 style='margin-left:-.25pt'><a name="_Toc308651">Section 2.6: Implicit And
Explicit Declaration</a></h2>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=108 style='width:81.0pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=108 valign=top style='width:81.0pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Option</span></b><span style='font-size:9.0pt;line-height:
  107%'> Explicit</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>If a code module does not contain at the top of the module,
then the compiler will automatically (that is, &quot;implicitly&quot;) create
variables for you when you use them. They will default to variable type <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Variant</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=125
src="VBA%20Notes%20for%20Professionals_files/image043.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=108 style='width:81.0pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=108 valign=top style='width:81.0pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Option</span></b><span style='font-size:9.0pt;line-height:
  107%'> Explicit</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>In the above code, if is specified, the code will interrupt
because it is missing the required <b><span style='font-size:9.0pt;line-height:
110%;color:blue;background:#FAFAFA'>Dim</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=221
src="VBA%20Notes%20for%20Professionals_files/image044.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.8pt;
margin-left:.75pt'>It is considered best practice to use Option Explicit in
code modules, to ensure that you declare all variables.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:213.7pt;margin-bottom:
0in;margin-left:.75pt;line-height:145%'>See VBA Best Practices how to set this
option by default.</p>

<h2 style='margin-top:0in;margin-right:213.7pt;margin-bottom:0in;margin-left:
.75pt;line-height:145%'><a name="_Toc308652">Section 2.7: Access Modifiers</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.9pt;
margin-left:.75pt'>The <b><span style='font-size:9.0pt;line-height:110%;
color:blue;background:#FAFAFA'>Dim</span></b> statement should be reserved for
local variables. At module-level, prefer explicit access modifiers:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:21.4pt'><img width=5 height=85
src="VBA%20Notes%20for%20Professionals_files/image045.gif" align=left
hspace=12><b><span style='font-size:9.0pt;line-height:110%;color:blue;
background:#FAFAFA'>Private</span></b> for private fields, which can only be
accessed within the module they're declared in.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:21.4pt'><b><span style='font-size:9.0pt;line-height:110%;
color:blue;background:#FAFAFA'>Public</span></b> for public fields and global
variables, which can be accessed by any calling code.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:21.4pt'><b><span style='font-size:9.0pt;line-height:110%;
color:blue;background:#FAFAFA'>Friend</span></b> for variables public within
the project, but inaccessible to other referencing VBA projects (relevant for
add-ins)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.5pt;
margin-left:21.4pt'><b><span style='font-size:9.0pt;line-height:110%;
color:blue;background:#FAFAFA'>Global</span></b> can also be used for <b><span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>Public</span></b>
fields in standard modules, but is illegal in class modules and is obsolete
anyway - prefer the <b><span style='font-size:9.0pt;line-height:110%;
color:blue;background:#FAFAFA'>Public</span></b> modifier instead. This
modifier isn't legal for procedures either.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>Access modifiers are applicable to variables and procedures
alike.</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=215
src="VBA%20Notes%20for%20Professionals_files/image046.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:4.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=21
src="VBA%20Notes%20for%20Professionals_files/image047.gif"></span></p>

<h4 style='margin-left:.75pt'>Option Private Module</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.55pt;
margin-left:.75pt'>Public parameterless <b><span style='font-size:9.0pt;
line-height:110%;color:blue;background:#FAFAFA'>Sub</span></b> procedures in
standard modules are exposed as macros and can be attached to controls and
keyboard shortcuts in the host document.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.45pt;
margin-left:.75pt'>Conversely, public <b><span style='font-size:9.0pt;
line-height:110%;color:blue;background:#FAFAFA'>Function</span></b> procedures
in standard modules are exposed as user-defined functions (UDF's) in the host
application.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=151 style='width:113.4pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=151 valign=top style='width:113.4pt;background:#FAFAFA;padding:
  1.8pt 0in 0in 0in;height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Option</span></b><span style='font-size:9.0pt;line-height:
  107%'> </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Private</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Module</span></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Specifying at the top of a standard module prevents its
members from being exposed as macros and UDF's to the host application.<br
clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc308653">Chapter 3:
Scripting.FileSystemObject</a></h1>

<h2 style='margin-left:-.25pt'><a name="_Toc308654">Section 3.1: Retrieve only
the path from a file path</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:14.1pt;
margin-left:.75pt'>The GetParentFolderName method returns the parent folder for
any path. While this can also be used with folders, it is arguably more useful
for extracting the path from an absolute file path:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Dim</span></b><span
style='font-size:9.0pt;line-height:110%'> fso </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>As</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>New</span></b><span style='font-size:9.0pt;line-height:110%'>
Scripting.FileSystemObject</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:17.25pt;
margin-left:3.5pt'><span style='position:relative;z-index:-1895806976'><span
style='left:0px;position:absolute;left:0px;top:-24px;width:718px;height:43px'><img
width=718 height=43 src="VBA%20Notes%20for%20Professionals_files/image024.gif"></span></span><span
style='font-size:9.0pt;line-height:110%'>Debug.Print fso.GetParentFolderName(</span><span
style='font-size:9.0pt;line-height:110%;color:brown'>&quot;C:\Users\Me\My
Documents\SomeFile.txt&quot;</span><span style='font-size:9.0pt;line-height:
110%'>)</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=173 style='width:1.8in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=173 valign=top style='width:1.8in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>C:\Users\</span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Me</span></b><span style='font-size:9.0pt;line-height:107%'>\My
  Documents</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:379.3pt;margin-bottom:
12.8pt;margin-left:.75pt'>Prints </p>

<p class=MsoNormal style='margin-top:0in;margin-right:55.15pt;margin-bottom:
0in;margin-left:.75pt;line-height:145%'>Note that the trailing path separator
is not included in the returned string.</p>

<h2 style='margin-top:0in;margin-right:55.15pt;margin-bottom:0in;margin-left:
.75pt;line-height:145%'><a name="_Toc308655">Section 3.2: Retrieve just the
extension from a file name</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src="VBA%20Notes%20for%20Professionals_files/image048.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=130 style='width:1.35in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=130 valign=top style='width:1.35in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>GetExtensionName()</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt;line-height:145%'>Prints <span style='font-size:9.0pt;
line-height:145%;background:#FAFAFA'>txt</span> Note that the method already
handles multiple periods in a file name.</p>

<h2 style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;margin-left:
.75pt;line-height:145%'><a name="_Toc308656">Section 3.3: Recursively enumerate
folders and files</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>Early Bound (with a reference to <span style='font-size:
9.0pt;line-height:110%;background:#FAFAFA'>Microsoft Scripting Runtime</span>)</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=538
src="VBA%20Notes%20for%20Professionals_files/image049.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.4pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=71
src="VBA%20Notes%20for%20Professionals_files/image050.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>Output when called with arguments like: <span
style='font-size:9.0pt;line-height:110%'>EnumerateFilesAndFolders </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>&quot;C:\Test&quot;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.4pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=174
src="VBA%20Notes%20for%20Professionals_files/image051.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>Output when called with arguments like: <span
style='font-size:9.0pt;line-height:110%'>EnumerateFilesAndFolders </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>&quot;C:\Test&quot;</span><span
style='font-size:9.0pt;line-height:110%'>, </span><span style='font-size:9.0pt;
line-height:110%;color:brown'>0</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.45pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=76
src="VBA%20Notes%20for%20Professionals_files/image052.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>Output when called with arguments like: <span
style='font-size:9.0pt;line-height:110%'>EnumerateFilesAndFolders </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>&quot;C:\Test&quot;</span><span
style='font-size:9.0pt;line-height:110%'>, </span><span style='font-size:9.0pt;
line-height:110%;color:brown'>1</span><span style='font-size:9.0pt;line-height:
110%'>, </span><span style='font-size:9.0pt;line-height:110%;color:brown'>4</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=125
src="VBA%20Notes%20for%20Professionals_files/image053.gif"></span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:0in;margin-left:-.25pt'><a
name="_Toc308657">Section 3.4: Strip file extension from a file name</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src="VBA%20Notes%20for%20Professionals_files/image054.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=115 style='width:1.2in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=115 valign=top style='width:1.2in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>MyFile.something</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:422.5pt;margin-bottom:
12.8pt;margin-left:.75pt'>Prints </p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=94 style='width:70.2pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=94 valign=top style='width:70.2pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>GetBaseName()</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:18.55pt;
margin-left:.75pt'>Note that the method already handles multiple periods in a
file name.</p>

<h2 style='margin-left:-.25pt'><a name="_Toc308658">Section 3.5: Enumerate
files in a directory using FileSystemObject</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>Early bound (requires a reference to Microsoft Scripting
Runtime):</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=149
src="VBA%20Notes%20for%20Professionals_files/image055.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=71
src="VBA%20Notes%20for%20Professionals_files/image056.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>Late bound:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=207
src="VBA%20Notes%20for%20Professionals_files/image057.gif"></span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:0in;margin-left:-.25pt'><a
name="_Toc308659">Section 3.6: Creating a FileSystemObject</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=720 height=306
src="VBA%20Notes%20for%20Professionals_files/image058.gif"></span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:0in;margin-left:-.25pt'><a
name="_Toc308660">Section 3.7: Reading a text file using a FileSystemObject</a></h2>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=720 height=280
src="VBA%20Notes%20for%20Professionals_files/image059.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=719 height=186
src="VBA%20Notes%20for%20Professionals_files/image060.gif"></span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:0in;margin-left:-.25pt'><a
name="_Toc308661">Section 3.8: Creating a text file with FileSystemObject</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=720 height=273
src="VBA%20Notes%20for%20Professionals_files/image061.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc308662">Section 3.9: Using
FSO.BuildPath to build a Full Path from folder path and file name</a></h2>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=94 style='width:70.2pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=94 valign=top style='width:70.2pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>FSO.BuildPath</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>If you're accepting user input for folder paths, you might
need to check for trailing backslashes (<span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>\</span>) before building a file path.
The method makes this simpler:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=174
src="VBA%20Notes%20for%20Professionals_files/image062.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>Output:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src="VBA%20Notes%20for%20Professionals_files/image063.gif"></span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:0in;margin-left:-.25pt'><a
name="_Toc308663">Section 3.10: Writing to an existing file with
FileSystemObject</a></h2>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=53
src="VBA%20Notes%20for%20Professionals_files/image064.gif"></span></p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=719 height=465
src="VBA%20Notes%20for%20Professionals_files/image065.gif"></span><br
clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc308664">Chapter 4: Procedure Calls</a></h1>

<h3 style='margin-top:0in;margin-right:0in;margin-bottom:1.1pt;margin-left:
0in;text-indent:0in;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;color:black'>Parameter Info</span></h3>

<p class=MsoNormal style='margin-top:0in;margin-right:142.7pt;margin-bottom:
16.95pt;margin-left:.75pt;line-height:141%'>IdentifierName The name of the
procedure to call. arguments A comma-separated list of arguments to be passed
to the procedure.</p>

<h2 style='margin-left:-.25pt'><a name="_Toc308665">Section 4.1: This is
confusing. Why not just always use parentheses?</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.45pt;
margin-left:.75pt'>Parentheses are used to enclose the arguments of <i>function
calls</i>. Using them for <i>procedure calls</i> can cause unexpected problems.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.7pt;
margin-left:.75pt'>Because they can introduce bugs, both at run-time by passing
a possibly unintended value to the procedure, and at compile-time by simply
being invalid syntax.</p>

<h3 style='margin-top:0in;margin-right:0in;margin-bottom:13.2pt;margin-left:
.75pt;line-height:110%'><span style='font-size:10.0pt;line-height:110%;
color:black'>Run-time</span></h3>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>Redundant parentheses can introduce bugs. Given a procedure
that takes an object reference as a parameter...</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src="VBA%20Notes%20for%20Professionals_files/image066.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>...and called with parentheses:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="VBA%20Notes%20for%20Professionals_files/image067.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>This will raise an &quot;Object Required&quot; runtime error
#424. Other errors are possible in other circumstances: here the</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=158 style='width:1.65in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=79 valign=top style='width:59.4pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Application</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;background:#FAFAFA'>.</span></p>
  </td>
  <td width=72 valign=top style='width:.75in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>ActiveCell</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:119.3pt'><span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>Range</span> object reference is being <i>evaluated</i> and passed by
value <b>regardless</b> of the</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=202 style='width:2.1in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=79 valign=top style='width:59.4pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Application</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;background:#FAFAFA'>.</span></p>
  </td>
  <td width=72 valign=top style='width:.75in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>ActiveCell</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;background:#FAFAFA'>.</span></p>
  </td>
  <td width=36 valign=top style='width:27.0pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Value</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.5pt;
margin-left:.75pt'>procedure's signature specifying that <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>target</span> would
be passed <b><span style='font-size:9.0pt;line-height:110%;color:blue;
background:#FAFAFA'>ByRef</span></b>. The actual value passed <b><span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>ByVal</span></b>
to <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>DoSomething
</span>in the above snippet, is .</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.7pt;
margin-left:.75pt'>Parentheses force VBA to evaluate the value of the bracketed
expression, and pass the result <b><span style='font-size:9.0pt;line-height:
110%;color:blue;background:#FAFAFA'>ByVal</span></b> to the called procedure.
When the type of the evaluated result mismatches the procedure's expected type
and cannot be implicitly converted, a runtime error is raised.</p>

<h3 style='margin-top:0in;margin-right:0in;margin-bottom:13.2pt;margin-left:
.75pt;line-height:110%'><span style='font-size:10.0pt;line-height:110%;
color:black'>Compile-time</span></h3>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>This code will fail to compile:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="VBA%20Notes%20for%20Professionals_files/image068.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=194 style='width:145.8pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=194 valign=top style='width:145.8pt;background:#FAFAFA;padding:
  1.8pt 0in 0in 0in;height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:brown'>&quot;Invalid Code!&quot;</span><span style='font-size:
  9.0pt;line-height:107%'>, vbCritical</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.85pt;
margin-left:.75pt'>Because the expression <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>()</span> cannot be <i>evaluated</i> to a
value.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>This would compile and work:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="VBA%20Notes%20for%20Professionals_files/image069.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:18.55pt;
margin-left:.75pt'>But would definitely look silly. Avoid redundant
parentheses.</p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:0in;margin-left:-.25pt'><a
name="_Toc308666">Section 4.2: Implicit Call Syntax</a></h2>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=45
src="VBA%20Notes%20for%20Professionals_files/image070.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=21
src="VBA%20Notes%20for%20Professionals_files/image071.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:28.1pt;
margin-left:.75pt'>Call a procedure by its name without any parentheses.</p>

<h4 style='margin-left:.75pt'>Edge case</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>The <b><span style='font-size:9.0pt;line-height:110%;
color:blue;background:#FAFAFA'>Call</span></b> keyword is only required in one
edge case:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.25pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="VBA%20Notes%20for%20Professionals_files/image072.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'><span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>DoSomething</span> and <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>DoSomethingElse</span> are procedures being called. If the <b><span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>Call</span></b>
keyword was removed, then <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>DoSomething</span> would be parsed as a <i>line label</i>
rather than a procedure call, which would break the code:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="VBA%20Notes%20for%20Professionals_files/image073.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc308667">Section 4.3: Optional
Arguments</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.75pt;
margin-left:.75pt'>Some procedures have optional arguments. Optional arguments
always come after required arguments, but the procedure can be called without
them.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>For example, if the function, <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>ProcedureName</span> were to have two
required arguments (<span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>argument1</span>, <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>argument2</span>), and one optional argument, <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>optArgument3</span>,
it could be called at least four ways:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=191
src="VBA%20Notes%20for%20Professionals_files/image074.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>The structure of the function header being called here would
look something like this:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src="VBA%20Notes%20for%20Professionals_files/image075.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.65pt;
margin-left:.75pt'>The <b><span style='font-size:9.0pt;line-height:110%;
color:blue;background:#FAFAFA'>Optional</span></b> keyword indicates that this
argument can be omitted. As mentioned before - any optional arguments
introduced in the header <b>must</b> appear at the end, after any required
arguments.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:14.45pt;
margin-left:.75pt'>You can also provide a <i>default</i> value for the argument
in the case that a value isn't passed to the function:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><span style='position:relative;z-index:-1895805952'><span
style='left:0px;position:absolute;left:0px;top:-8px;width:718px;height:43px'><img
width=718 height=43 src="VBA%20Notes%20for%20Professionals_files/image024.gif"></span></span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Function</span></b><span
style='font-size:9.0pt;line-height:110%'> ProcedureName(argument1 </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>String</span><span style='font-size:9.0pt;
line-height:110%'>, argument2 </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>As</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:slateblue'>String</span><span style='font-size:9.0pt;line-height:110%'>, </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Optional</span></b><span
style='font-size:9.0pt;line-height:110%'> optArgument3 </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>String</span><span style='font-size:9.0pt;
line-height:110%'> =</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:17.3pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%;color:brown'>&quot;C&quot;</span><span
style='font-size:9.0pt;line-height:110%'>) </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>As</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:slateblue'>String</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:18.2pt;
margin-left:.75pt'>In this function, if the argument for <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>c</span> isn't
supplied it's value will default to <span style='font-size:9.0pt;line-height:
110%;color:brown;background:#FAFAFA'>&quot;C&quot;</span>. If a value <i>is</i>
supplied then this will override the default value.</p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:0in;margin-left:-.25pt'><a
name="_Toc308668">Section 4.4: Explicit Call Syntax</a></h2>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=31
src="VBA%20Notes%20for%20Professionals_files/image076.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=21
src="VBA%20Notes%20for%20Professionals_files/image077.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:12.7pt;margin-bottom:
.25pt;margin-left:.75pt;text-align:justify;text-justify:inter-ideograph;
line-height:135%'>The explicit call syntax requires the <b><span
style='font-size:9.0pt;line-height:135%;color:blue;background:#FAFAFA'>Call</span></b>
keyword and parentheses around the argument list; parentheses are redundant if
there are no parameters. This syntax was made obsolete when the more modern
implicit call syntax was added to VB.</p>

<h2 style='margin-top:0in;margin-right:12.7pt;margin-bottom:.25pt;margin-left:
.75pt;text-align:justify;text-justify:inter-ideograph;line-height:135%'><a
name="_Toc308669">Section 4.5: Return Values</a></h2>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=86 style='width:.9in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=86 valign=top style='width:.9in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Property</span></b><span style='font-size:9.0pt;line-height:
  107%'> </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Get</span></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>To retrieve the result of a procedure call (e.g. <b><span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>Function</span></b>
or procedures), put the call on the right-hand side of an assignment:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src="VBA%20Notes%20for%20Professionals_files/image078.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Parentheses must be present if there are parameters. If the
procedure has no parameters, the parentheses are redundant.<br clear=all
style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc308670">Chapter 5: Naming
Conventions</a></h1>

<h2 style='margin-left:-.25pt'><a name="_Toc308671">Section 5.1: Variable Names</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.85pt;
margin-left:.75pt'>Variables hold data. Name them after what they're used for, <b>not
after their data type</b> or scope, using a <b>noun</b>. If you feel compelled
to <i>number</i> your variables (e.g. <span style='font-size:9.0pt;line-height:
110%;background:#FAFAFA'>thing1, thing2, thing3</span>), then consider using an
appropriate data structure instead (e.g. an array, a <span style='font-size:
9.0pt;line-height:110%;background:#FAFAFA'>Collection</span>, or a <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Dictionary</span>).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.45pt;
margin-left:.75pt'>Names of variables that represent an iteratable <i>set</i>
of values - e.g. an array, a <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>Collection</span>, a <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>Dictionary</span>, or a <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Range </span>of
cells, should be plural.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:13.05pt;
margin-left:.75pt'>Some common VBA naming conventions go thus:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:1.3pt;
margin-left:.75pt'><b>For procedure-level Variables</b>:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=136
src="VBA%20Notes%20for%20Professionals_files/image079.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.95pt;
margin-left:.75pt'><b>For module-level Variables:</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:17.75pt;margin-bottom:
.1pt;margin-left:-.25pt;line-height:107%'><span style='font-size:9.0pt;
line-height:107%;background:#FAFAFA'>PascalCase</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src="VBA%20Notes%20for%20Professionals_files/image080.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.2pt;
margin-left:.75pt'><b>For Constants:</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'><span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>SHOUTY_SNAKE_CASE</span> is commonly used to differentiate constants
from variables:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=142
src="VBA%20Notes%20for%20Professionals_files/image081.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>However <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>PascalCase</span> names make cleaner-looking code and are
just as good, given IntelliSense uses different icons for variables and
constants:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:30.25pt;
margin-left:0in;text-indent:0in;line-height:107%'><img border=0 width=317
height=172 id="Picture 5897"
src="VBA%20Notes%20for%20Professionals_files/image082.jpg"></p>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:9.8pt;margin-left:
.75pt'>Hungarian Notation</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.35pt;
margin-left:0in;text-indent:0in'><span style='font-size:11.0pt;line-height:
110%'> <img border=0 width=3 height=52 id="Group 263049"
src="VBA%20Notes%20for%20Professionals_files/image083.gif"></span> Name
them after what they're used for, <b>not after their data type</b> or scope.</p>

<h5>&quot;Hungarian Notation makes it easier to see what the type of a variable
is&quot;</h5>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.5pt;
margin-left:.75pt'>If you write your code such as procedures adhere to the <i>Single
Responsibility Principle</i> (as it should), you should never be looking at a
screenful of variable declarations at the top of any procedure; declare
variables as close as possible to their first usage, and their data type will
always be in plain sight if you declare them with an explicit type. The VBE's <span
style='border:solid black 1.5pt;padding:0in'>Ctrl </span>+<span
style='border:solid black 1.5pt;padding:0in'> i </span>shortcut can be used to
display a variable's type in a tooltip, too.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.75pt;
margin-left:.75pt'>What a variable is used for is much more useful information
than its data type, <i>especially</i> in a language such as VBA which happily
and implicitly converts a type into another as needed.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>Consider <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>iFile</span> and <span style='font-size:9.0pt;line-height:
110%;background:#FAFAFA'>strFile</span> in this example:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=339
src="VBA%20Notes%20for%20Professionals_files/image084.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>Compare to:</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=111
src="VBA%20Notes%20for%20Professionals_files/image085.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=235
src="VBA%20Notes%20for%20Professionals_files/image086.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.65pt;
margin-left:.75pt'><span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>strData</span> is passed <b><span style='font-size:9.0pt;line-height:
110%;color:blue;background:#FAFAFA'>ByRef</span></b> in the top example, but
beside the fact that we're lucky enough to see that it's <i>explicitly </i>passed
as such, there's no indication that <span style='font-size:9.0pt;line-height:
110%;background:#FAFAFA'>strData</span> is actually <i>returned</i> by the
function.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.5pt;
margin-left:.75pt'>The bottom example names it <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>outContent</span>; this <b><span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>out</span></b>
prefix is what Hungarian Notation was invented for: to help clarify <i>what a
variable is used for</i>, in this case to clearly identify it as an
&quot;out&quot; parameter.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>This is useful, because IntelliSense by itself doesn't
display <b><span style='font-size:9.0pt;line-height:110%;color:blue;background:
#FAFAFA'>ByRef</span></b>, even when the parameter is <i>explicitly</i> passed
by reference:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><img border=0 width=469
height=64 id="Picture 6134"
src="VBA%20Notes%20for%20Professionals_files/image087.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:13.05pt;
margin-left:.75pt'>Which leads to...</p>

<h4 style='margin-left:.75pt'>Hungarian Done Right</h4>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=72 style='width:.75in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=72 valign=top style='width:.75in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><span style='font-size:9.0pt;line-height:107%;color:slateblue'>Integer</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'><a href="http://www.joelonsoftware.com/articles/Wrong.html"><span
style='color:#193C96'>Hungarian Notation originally didn't have anything to do
with variable types</span></a>. In fact, Hungarian Notation <i>done right </i>is
actually useful. Consider this small example (<b><span style='font-size:9.0pt;
line-height:110%;color:blue;background:#FAFAFA'>ByVal</span></b> and removed
for brevety):</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src="VBA%20Notes%20for%20Professionals_files/image088.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>Compare to:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src="VBA%20Notes%20for%20Professionals_files/image089.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.45pt;
margin-left:.75pt'><span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>src</span> and <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>dst</span> are <i>Hungarian Notation</i> prefixes here, and
they convey <i>useful</i> information that cannot otherwise already be inferred
from the parameter names or IntelliSense showing us the declared type.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Of course there's a better way to convey it all, using
proper <i>abstraction</i> and real words that can be pronounced out loud and
make sense - as a contrived example:</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=125
src="VBA%20Notes%20for%20Professionals_files/image090.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc308672">Section 5.2: Procedure
Names</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.45pt;
margin-left:.75pt'>Procedures <i>do something</i>. Name them after what they're
doing, using a <b>verb</b>. If accurately naming a procedure is not possible,
likely the procedure is <i>doing too many things</i> and needs to be broken
down into smaller, more specialized procedures.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:13.05pt;
margin-left:.75pt'>Some common VBA naming conventions go thus:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:1.3pt;
margin-left:.75pt'><b>For all Procedures:</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=153
src="VBA%20Notes%20for%20Professionals_files/image091.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:1.3pt;
margin-left:.75pt'><b>For event handler procedures:</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=153
src="VBA%20Notes%20for%20Professionals_files/image092.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.7pt;
margin-left:.75pt'>Event handlers are usually automatically named by the VBE;
renaming them without renaming the object and/or the handled event will break
the code - the code will run and compile, but the handler procedure will be
orphaned and will never be executed.</p>

<h4 style='margin-left:.75pt'>Boolean Members</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>Consider a Boolean-returning function:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src="VBA%20Notes%20for%20Professionals_files/image093.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>Compare to:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src="VBA%20Notes%20for%20Professionals_files/image094.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>The <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>Can</span> prefix <i>does</i> serve the same purpose as the
<span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>b</span>
prefix: it identifies the function's return value as a <span style='font-size:
9.0pt;line-height:110%;color:slateblue;background:#FAFAFA'>Boolean</span>. But <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Can</span> reads
better than <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>b</span>:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="VBA%20Notes%20for%20Professionals_files/image095.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>Compared to:</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=26
src="VBA%20Notes%20for%20Professionals_files/image096.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Consider using prefixes such as <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>Can</span>, <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>Is</span> or <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>Has</span> in front of Boolean-returning
members (functions and properties), but only when it adds value. This conforms
with the <a
href="https://msdn.microsoft.com/en-us/library/ms229012(v=vs.110).aspx"><span
style='color:#193C96'>current Microsoft naming guidelines</span></a>.<br
clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc308673">Chapter 6: Creating a
procedure</a></h1>

<h2 style='margin-left:-.25pt'><a name="_Toc308674">Section 6.1: Introduction
to procedures</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>A <b><span style='font-size:9.0pt;line-height:110%;
color:blue;background:#FAFAFA'>Sub</span></b> is a procedure that performs a
specific task but does not return a specific value.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="VBA%20Notes%20for%20Professionals_files/image097.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.95pt;
margin-left:.75pt'>If no access modifier is specified, a procedure is <b><span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>Public</span></b>
by default.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>A <b><span style='font-size:9.0pt;line-height:110%;
color:blue;background:#FAFAFA'>Function</span></b> is a procedure that is given
data and returns a value, ideally without global or module-scope sideeffects.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="VBA%20Notes%20for%20Professionals_files/image098.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>A <b><span style='font-size:9.0pt;line-height:110%;
color:blue;background:#FAFAFA'>Property</span></b> is a procedure that <i>encapsulates</i>
module data. A property can have up to 3 accessors: <b><span style='font-size:
9.0pt;line-height:110%;color:blue;background:#FAFAFA'>Get</span></b> to return
a value or object reference, <b><span style='font-size:9.0pt;line-height:110%;
color:blue;background:#FAFAFA'>Let</span></b> to assign a value, and/or <b><span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>Set</span></b>
to assign an object reference.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="VBA%20Notes%20for%20Professionals_files/image099.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.75pt;
margin-left:.75pt'>Properties are usually used in class modules (although they
are allowed in standard modules as well), exposing accessor to data that is
otherwise inaccessible to the calling code. A property that only exposes a <b><span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>Get</span></b>
accessor is &quot;read-only&quot;; a property that would only expose a <b><span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>Let</span></b>
and/or <b><span style='font-size:9.0pt;line-height:110%;color:blue;background:
#FAFAFA'>Set</span></b> accessor is &quot;write-only&quot;. Write-only
properties are not considered a good programming practice - if the client code
can <i>write</i> a value, it should be able to <i>read</i> it back. Consider
implementing a <b><span style='font-size:9.0pt;line-height:110%;color:blue;
background:#FAFAFA'>Sub</span></b> procedure instead of making a write-only
property.</p>

<h4 style='margin-left:.75pt'>Returning a value</h4>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=86 style='width:.9in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=86 valign=top style='width:.9in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Property</span></b><span style='font-size:9.0pt;line-height:
  107%'> </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Get</span></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>A <b><span style='font-size:9.0pt;line-height:110%;
color:blue;background:#FAFAFA'>Function</span></b> or procedure can (and
should!) return a value to its caller. This is done by assigning the identifier
of the procedure:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="VBA%20Notes%20for%20Professionals_files/image100.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc308675">Section 6.2: Function With
Examples</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.45pt;
margin-left:.75pt'>As stated above Functions are smaller procedures that
contain small pieces of code which may be repetitive inside a Procedure.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.8pt;
margin-left:.75pt'>Functions are used to reduce redundancy in code.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.8pt;
margin-left:.75pt'>Similar to a Procedure, A function can be declared with or
without an arguments list.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Function is declared as a return type, as all functions
return a value. The Name and the Return Variable of a function are the Same.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:3.05pt;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:110%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Function
With Parameter:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.05pt;
margin-left:30.0pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=678 height=125
src="VBA%20Notes%20for%20Professionals_files/image101.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:3.05pt;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:110%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Function
Without Parameter:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:23.25pt;
margin-left:30.0pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=678 height=60
src="VBA%20Notes%20for%20Professionals_files/image102.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.45pt;
margin-left:.75pt'>The Function can be called in various ways inside a
function. Since a Function declared with a return type is basically a variable.
it is used similar to a variable.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:14.45pt;
margin-left:.75pt'>Functional Calls:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.05pt;margin-bottom:.25pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>call</span></b><span
style='font-size:9.0pt;line-height:110%'> greet() </span><i><span
style='font-size:9.0pt;line-height:110%;color:green'>'Similar to a Procedural
call just allows the Procedure to use the</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:136.15pt;margin-bottom:
17.2pt;margin-left:3.5pt'><span style='position:relative;z-index:-1895804928'><span
style='left:0px;position:absolute;left:0px;top:-25px;width:718px;height:76px'><img
width=718 height=76 src="VBA%20Notes%20for%20Professionals_files/image103.gif"></span></span><span
style='font-size:9.0pt;line-height:110%'> </span><i><span
style='font-size:9.0pt;line-height:110%;color:green'>'variable greet </span></i><span
style='font-size:9.0pt;line-height:110%'>string_1=greet() </span><i><span
style='font-size:9.0pt;line-height:110%;color:green'>'The Return value of the
function is used for variable </span></i><span style='font-size:9.0pt;
line-height:110%'></span><i><span style='font-size:9.0pt;
line-height:110%;color:green'>'assignment</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>Further the function can also be used as conditions for if
and other conditional statements.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=125
src="VBA%20Notes%20for%20Professionals_files/image104.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Further more Functions can have modifiers such as By ref and
By val for their arguments.</p>

<h1 style='margin-left:-.25pt'><a name="_Toc308676">Chapter 7: Flow control
structures</a></h1>

<h2 style='margin-left:-.25pt'><a name="_Toc308677">Section 7.1: For loop</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:14.1pt;
margin-left:.75pt'>The <b><span style='font-size:9.0pt;line-height:110%;
color:blue;background:#FAFAFA'>For</span></b> loop is used to repeat the
enclosed section of code a given number of times. The following simple example
illustrates the basic syntax:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.05pt;margin-bottom:.25pt;
margin-left:3.5pt'><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Dim</span></b><span
style='font-size:9.0pt;line-height:110%'> i </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>as</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:slateblue'>Integer</span><span style='font-size:9.0pt;line-height:110%'>
</span><i><span style='font-size:9.0pt;line-height:110%;color:green'>'Declaration
of i</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.05pt;margin-bottom:.25pt;
margin-left:3.5pt'><span style='position:relative;z-index:-1895803904'><span
style='left:0px;position:absolute;left:0px;top:-25px;width:718px;height:76px'><img
width=718 height=76 src="VBA%20Notes%20for%20Professionals_files/image103.gif"></span></span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>For</span></b><span
style='font-size:9.0pt;line-height:110%'> i = </span><span style='font-size:
9.0pt;line-height:110%;color:brown'>1</span><span style='font-size:9.0pt;
line-height:110%'> </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>to</span></b><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>10</span><span
style='font-size:9.0pt;line-height:110%'> </span><i><span
style='font-size:9.0pt;line-height:110%;color:green'>'Declare how many times
the loop shall be executed</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.05pt;margin-bottom:.25pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'>
Debug.Print i </span><i><span style='font-size:9.0pt;line-height:110%;
color:green'>'The piece of code which is repeated</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:17.3pt;
margin-left:3.5pt'><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Next</span></b><span
style='font-size:9.0pt;line-height:110%'> i </span><i><span
style='font-size:9.0pt;line-height:110%;color:green'>'The end of the loop</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>The code above declares an Integer <span style='font-size:
9.0pt;line-height:110%;background:#FAFAFA'>i</span>. The <b><span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>For</span></b>
loop assigns every value between 1 and 10 to <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>i</span> and then executes</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=94 style='width:70.2pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=36 valign=top style='width:27.0pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Debug</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;background:#FAFAFA'>.</span></p>
  </td>
  <td width=50 valign=top style='width:37.8pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Print i</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:70.7pt'>- i.e. the code prints the numbers 1 through 10 to the
immediate window. Note that the loop</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.5pt;
margin-left:.75pt'>variable is incremented by the <b><span style='font-size:
9.0pt;line-height:110%;color:blue;background:#FAFAFA'>Next</span></b>
statement, that is after the enclosed code executes as opposed to before it
executes.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>By default, the counter will be incremented by 1 each time
the loop executes. However, a <b><span style='font-size:9.0pt;line-height:110%;
color:blue;background:#FAFAFA'>Step</span></b> can be specified to change the
amount of the increment as either a literal or the return value of a function.
If the starting value, ending value, or <b><span style='font-size:9.0pt;
line-height:110%;color:blue;background:#FAFAFA'>Step</span></b> value is a
floating point number, it will be rounded to the nearest integer value. <b><span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>Step</span></b>
can be either a positive or negative value.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=76
src="VBA%20Notes%20for%20Professionals_files/image105.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>In general a <b><span style='font-size:9.0pt;line-height:
110%;color:blue;background:#FAFAFA'>For</span></b> loop would be used in
situations where it is known before the loop starts how many times to execute
the enclosed code (otherwise a <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>Do</span> or <b><span style='font-size:9.0pt;line-height:
110%;color:blue;background:#FAFAFA'>While</span></b> loop may be more
appropriate). This is because the exit condition is fixed after the first entry
into loop, as this code demonstrates:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=174
src="VBA%20Notes%20for%20Professionals_files/image106.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=58 style='width:.6in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Exit</span></b><span style='font-size:9.0pt;line-height:
  107%'> </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>For</span></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>A <b><span style='font-size:9.0pt;line-height:110%;
color:blue;background:#FAFAFA'>For</span></b> loop can be exited early with
the statement:</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=142
src="VBA%20Notes%20for%20Professionals_files/image107.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc308678">Section 7.2: Select Case</a></h2>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=79 style='width:59.4pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=79 valign=top style='width:59.4pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>SELECT</span></b><span style='font-size:9.0pt;line-height:
  107%'> </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>CASE</span></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal align=right style='margin-top:0in;margin-right:22.1pt;
margin-bottom:2.0pt;margin-left:.5pt;text-align:right;line-height:107%'>can be
used when many different conditions are possible. The conditions are checked
from top to</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>bottom and only the first case that match will be executed.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=437
src="VBA%20Notes%20for%20Professionals_files/image108.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=79 style='width:59.4pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=79 valign=top style='width:59.4pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>SELECT</span></b><span style='font-size:9.0pt;line-height:
  107%'> </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>CASE</span></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>The logic of the block can be inverted to support testing
of different variables too, in this kind of scenario we can also use logical
operators:</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=404
src="VBA%20Notes%20for%20Professionals_files/image109.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Case statements can also use arithmetic operators. Where an
arithmetic operator is being used against the <b><span style='font-size:9.0pt;
line-height:110%;color:blue;background:#FAFAFA'>SELECT CASE</span></b> value it
should be preceded with the <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>Is</span> keyword:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=306
src="VBA%20Notes%20for%20Professionals_files/image110.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc308679">Section 7.3: For Each loop</a></h2>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=58 style='width:.6in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>For</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Each</span></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>The loop construct is ideal for iterating all elements of a
collection.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=191
src="VBA%20Notes%20for%20Professionals_files/image111.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=58 style='width:.6in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>For</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Each</span></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>Use when iterating object collections:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=76
src="VBA%20Notes%20for%20Professionals_files/image112.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=58 style='width:.6in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>For</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Each</span></b></p>
  </td>
 </tr>
</table>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=58 style='width:.6in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>For</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Each</span></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.8pt;
margin-left:.75pt'>Avoid when iterating arrays; a <b><span style='font-size:
9.0pt;line-height:110%;color:blue;background:#FAFAFA'>For</span></b> loop will
offer significantly better performance with arrays. Conversely, a loop will
offer better performance when iterating a <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>Collection</span>.</p>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:0in;margin-left:.75pt'>Syntax</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="VBA%20Notes%20for%20Professionals_files/image113.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>The <b><span style='font-size:9.0pt;line-height:110%;
color:blue;background:#FAFAFA'>Next</span></b> keyword may optionally be
followed by the iterator variable; this can help clarify nested loops, although
there are better ways to clarify nested code, such as extracting the inner loop
into its own procedure.</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=40
src="VBA%20Notes%20for%20Professionals_files/image114.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=120
src="VBA%20Notes%20for%20Professionals_files/image115.gif"></span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:0in;margin-left:-.25pt'><a
name="_Toc308680">Section 7.4: Do loop</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=720 height=585
src="VBA%20Notes%20for%20Professionals_files/image116.gif"></span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:0in;margin-left:-.25pt'><a
name="_Toc308681">Section 7.5: While loop</a></h2>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=191
src="VBA%20Notes%20for%20Professionals_files/image117.gif"></span></p>

<h1 style='margin-left:-.25pt'><a name="_Toc308682">Chapter 8: Comments</a></h1>

<h2 style='margin-left:-.25pt'><a name="_Toc308683">Section 8.1: Apostrophe
Comments</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.45pt;
margin-left:.75pt'>A comment is marked by an apostrophe (<span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>'</span>), and
ignored when the code executes. Comments help explain your code to future
readers, including yourself.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Since all lines starting with a comment are ignored, they
can also be used to prevent code from executing (while you debug or refactor).
Placing an apostrophe <span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>'</span> before your code turns it into a comment. (This is called <i>commenting
out</i> the line.)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=720 height=453
src="VBA%20Notes%20for%20Professionals_files/image118.gif"></span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:4.2pt;margin-left:
-.25pt'><a name="_Toc308684">Section 8.2: REM Comments</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Sub</span></b><span
style='font-size:9.0pt;line-height:110%'> RemComments()</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Rem</span></b><span
style='font-size:9.0pt;line-height:110%'> Comments start </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>with</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:brown'>&quot;Rem&quot;</span><span style='font-size:
9.0pt;line-height:110%'> (VBA will change any alternate casing </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>to</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:brown'>&quot;Rem&quot;</span><span style='font-size:
9.0pt;line-height:110%'>)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Rem</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>is</span></b><span style='font-size:9.0pt;
line-height:110%'> an abbreviation </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>of</span></b><span style='font-size:9.0pt;
line-height:110%'> Remark, </span><b><span style='font-size:9.0pt;line-height:
110%;color:blue'>and</span></b><span style='font-size:9.0pt;line-height:110%'>
similar </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>to</span></b><span
style='font-size:9.0pt;line-height:110%'> DOS syntax</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:12.55pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Rem</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Is</span></b><span style='font-size:9.0pt;
line-height:110%'> a legacy approach </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>to</span></b><span style='font-size:9.0pt;
line-height:110%'> adding comments, </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>and</span></b><span style='font-size:9.0pt;
line-height:110%'> apostrophes should be preferred</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Rem</span></b><span
style='font-size:9.0pt;line-height:110%'> Comments CANNOT appear after a
statement, use the apostrophe syntax instead</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Rem</span></b><span
style='font-size:9.0pt;line-height:110%'> Unless they are preceded </span><b><span
style='font-size:9.0pt;line-height:110%;color:#CD6A5A'>by</span></b><span
style='font-size:9.0pt;line-height:110%'> the instruction separator token</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'> Debug.Print
</span><span style='font-size:9.0pt;line-height:110%;color:brown'>&quot;Hello
World&quot;</span><span style='font-size:9.0pt;line-height:110%'>: </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Rem</span></b><span
style='font-size:9.0pt;line-height:110%'> prints a welcome message</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.05pt;margin-bottom:12.55pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'> Debug.Print
</span><span style='font-size:9.0pt;line-height:110%;color:brown'>&quot;Hello
World&quot;</span><span style='font-size:9.0pt;line-height:110%'> </span><i><span
style='font-size:9.0pt;line-height:110%;color:green'>'Prints a welcome message</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:74.95pt;margin-bottom:
12.45pt;margin-left:3.5pt'><span style='position:relative;z-index:-1895802880'><span
style='left:0px;position:absolute;left:0px;top:-3548px;width:718px;height:1px'><img
width=718 height=1 src="VBA%20Notes%20for%20Professionals_files/image119.gif"></span></span><span
style='font-size:9.0pt;line-height:110%'> </span><i><span style='font-size:
9.0pt;line-height:110%;color:green'>'Rem cannot be immediately followed by the
following characters &quot;!,@,#,$,%,&amp;&quot; </span></i><span
style='font-size:9.0pt;line-height:110%'></span><i><span style='font-size:
9.0pt;line-height:110%;color:green'>'Whereas the apostrophe syntax can be
followed by any printable character.</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:12.55pt;
margin-left:3.5pt'><b><span style='font-size:9.0pt;line-height:110%;color:blue'>End</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Sub</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Rem</span></b><span
style='font-size:9.0pt;line-height:110%'> Comments can appear inside </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>or</span></b><span
style='font-size:9.0pt;line-height:110%'> outside a procedure</span></p>

<h1 style='margin-left:-.25pt'><a name="_Toc308685">Chapter 9: Arrays</a></h1>

<h2 style='margin-left:-.25pt'><a name="_Toc308686">Section 9.1:
Multidimensional Arrays</a></h2>

<h4 style='margin-left:.75pt'>Multidimensional Arrays</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.45pt;
margin-left:.75pt'>As the name indicates, multi dimensional arrays are arrays
that contain more than one dimension, usually two or three but it can have up
to 32 dimensions.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.45pt;
margin-left:.75pt'>A multi array works like a matrix with various levels, take
in example a comparison between one, two, and three Dimensions.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>One Dimension is your typical array, it looks like a list of
elements.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=109
src="VBA%20Notes%20for%20Professionals_files/image120.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Two Dimensions would look like a Sudoku Grid or an Excel
sheet, when initializing the array you would define how many rows and columns
the array would have.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=125
src="VBA%20Notes%20for%20Professionals_files/image121.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:14.1pt;
margin-left:.75pt'>Three Dimensions would start to look like Rubik's Cube, when
initializing the array you would define rows and columns and layers/depths the
array would have.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Dim</span></b><span
style='font-size:9.0pt;line-height:110%'> 3D(</span><span style='font-size:
9.0pt;line-height:110%;color:brown'>3</span><span style='font-size:9.0pt;
line-height:110%'>,</span><span style='font-size:9.0pt;line-height:110%;
color:brown'>3</span><span style='font-size:9.0pt;line-height:110%'>,</span><span
style='font-size:9.0pt;line-height:110%;color:brown'>2</span><span
style='font-size:9.0pt;line-height:110%'>) </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>as</span></b><span style='font-size:9.0pt;
line-height:110%'> Variant</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.05pt;margin-bottom:12.55pt;
margin-left:3.5pt'><i><span style='font-size:9.0pt;line-height:110%;color:green'>'this
would result in a 3x3x3 grid</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'>*3D -
Visually*</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:135.95pt;margin-bottom:
2.2pt;margin-left:3.5pt'><span style='position:relative;z-index:-1895801856'><span
style='left:0px;position:absolute;left:0px;top:-4325px;width:718px;height:1px'><img
width=718 height=1 src="VBA%20Notes%20for%20Professionals_files/image122.gif"></span></span><span
style='font-size:9.0pt;line-height:110%'> 1st layer 2nd
layer 3rd layer front
middle back (</span><span style='font-size:9.0pt;
line-height:110%;color:brown'>0</span><span style='font-size:9.0pt;line-height:
110%'>,</span><span style='font-size:9.0pt;line-height:110%;color:brown'>0</span><span
style='font-size:9.0pt;line-height:110%'>,</span><span style='font-size:9.0pt;
line-height:110%;color:brown'>0</span><span style='font-size:9.0pt;line-height:
110%'>) (</span><span style='font-size:9.0pt;line-height:110%;color:brown'>0</span><span
style='font-size:9.0pt;line-height:110%'>,</span><span style='font-size:9.0pt;
line-height:110%;color:brown'>0</span><span style='font-size:9.0pt;line-height:
110%'>,</span><span style='font-size:9.0pt;line-height:110%;color:brown'>1</span><span
style='font-size:9.0pt;line-height:110%'>) (</span><span style='font-size:9.0pt;
line-height:110%;color:brown'>0</span><span style='font-size:9.0pt;line-height:
110%'>,</span><span style='font-size:9.0pt;line-height:110%;color:brown'>0</span><span
style='font-size:9.0pt;line-height:110%'>,</span><span style='font-size:9.0pt;
line-height:110%;color:brown'>2</span><span style='font-size:9.0pt;line-height:
110%'>) </span><span style='font-size:9.0pt;line-height:110%;font-family:"Arial",sans-serif'></span><span
style='font-size:9.0pt;line-height:110%'> (</span><span style='font-size:9.0pt;
line-height:110%;color:brown'>1</span><span style='font-size:9.0pt;line-height:
110%'>,</span><span style='font-size:9.0pt;line-height:110%;color:brown'>0</span><span
style='font-size:9.0pt;line-height:110%'>,</span><span style='font-size:9.0pt;
line-height:110%;color:brown'>0</span><span style='font-size:9.0pt;line-height:
110%'>) (</span><span style='font-size:9.0pt;line-height:110%;color:brown'>1</span><span
style='font-size:9.0pt;line-height:110%'>,</span><span style='font-size:9.0pt;
line-height:110%;color:brown'>0</span><span style='font-size:9.0pt;line-height:
110%'>,</span><span style='font-size:9.0pt;line-height:110%;color:brown'>1</span><span
style='font-size:9.0pt;line-height:110%'>) (</span><span style='font-size:9.0pt;
line-height:110%;color:brown'>1</span><span style='font-size:9.0pt;line-height:
110%'>,</span><span style='font-size:9.0pt;line-height:110%;color:brown'>0</span><span
style='font-size:9.0pt;line-height:110%'>,</span><span style='font-size:9.0pt;
line-height:110%;color:brown'>2</span><span style='font-size:9.0pt;line-height:
110%'>) </span><span style='font-size:9.0pt;line-height:110%;font-family:"Arial",sans-serif'></span><span
style='font-size:9.0pt;line-height:110%'> (</span><span style='font-size:9.0pt;
line-height:110%;color:brown'>2</span><span style='font-size:9.0pt;line-height:
110%'>,</span><span style='font-size:9.0pt;line-height:110%;color:brown'>0</span><span
style='font-size:9.0pt;line-height:110%'>,</span><span style='font-size:9.0pt;
line-height:110%;color:brown'>0</span><span style='font-size:9.0pt;line-height:
110%'>) (</span><span style='font-size:9.0pt;line-height:110%;color:brown'>2</span><span
style='font-size:9.0pt;line-height:110%'>,</span><span style='font-size:9.0pt;
line-height:110%;color:brown'>0</span><span style='font-size:9.0pt;line-height:
110%'>,</span><span style='font-size:9.0pt;line-height:110%;color:brown'>1</span><span
style='font-size:9.0pt;line-height:110%'>) (</span><span style='font-size:9.0pt;
line-height:110%;color:brown'>2</span><span style='font-size:9.0pt;line-height:
110%'>,</span><span style='font-size:9.0pt;line-height:110%;color:brown'>0</span><span
style='font-size:9.0pt;line-height:110%'>,</span><span style='font-size:9.0pt;
line-height:110%;color:brown'>2</span><span style='font-size:9.0pt;line-height:
110%'>)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:2.3pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'>(</span><span
style='font-size:9.0pt;line-height:110%;color:brown'>0</span><span
style='font-size:9.0pt;line-height:110%'>,</span><span style='font-size:9.0pt;
line-height:110%;color:brown'>1</span><span style='font-size:9.0pt;line-height:
110%'>,</span><span style='font-size:9.0pt;line-height:110%;color:brown'>0</span><span
style='font-size:9.0pt;line-height:110%'>) (</span><span style='font-size:9.0pt;
line-height:110%;color:brown'>0</span><span style='font-size:9.0pt;line-height:
110%'>,</span><span style='font-size:9.0pt;line-height:110%;color:brown'>1</span><span
style='font-size:9.0pt;line-height:110%'>,</span><span style='font-size:9.0pt;
line-height:110%;color:brown'>1</span><span style='font-size:9.0pt;line-height:
110%'>) (</span><span style='font-size:9.0pt;line-height:110%;color:brown'>0</span><span
style='font-size:9.0pt;line-height:110%'>,</span><span style='font-size:9.0pt;
line-height:110%;color:brown'>1</span><span style='font-size:9.0pt;line-height:
110%'>,</span><span style='font-size:9.0pt;line-height:110%;color:brown'>2</span><span
style='font-size:9.0pt;line-height:110%'>) </span><span style='font-size:9.0pt;
line-height:110%;font-family:"Arial",sans-serif'></span><span
style='font-size:9.0pt;line-height:110%'> (</span><span style='font-size:9.0pt;
line-height:110%;color:brown'>1</span><span style='font-size:9.0pt;line-height:
110%'>,</span><span style='font-size:9.0pt;line-height:110%;color:brown'>1</span><span
style='font-size:9.0pt;line-height:110%'>,</span><span style='font-size:9.0pt;
line-height:110%;color:brown'>0</span><span style='font-size:9.0pt;line-height:
110%'>) (</span><span style='font-size:9.0pt;line-height:110%;color:brown'>1</span><span
style='font-size:9.0pt;line-height:110%'>,</span><span style='font-size:9.0pt;
line-height:110%;color:brown'>1</span><span style='font-size:9.0pt;line-height:
110%'>,</span><span style='font-size:9.0pt;line-height:110%;color:brown'>1</span><span
style='font-size:9.0pt;line-height:110%'>) (</span><span style='font-size:9.0pt;
line-height:110%;color:brown'>1</span><span style='font-size:9.0pt;line-height:
110%'>,</span><span style='font-size:9.0pt;line-height:110%;color:brown'>1</span><span
style='font-size:9.0pt;line-height:110%'>,</span><span style='font-size:9.0pt;
line-height:110%;color:brown'>2</span><span style='font-size:9.0pt;line-height:
110%'>) </span><span style='font-size:9.0pt;line-height:110%;font-family:"Arial",sans-serif'></span><span
style='font-size:9.0pt;line-height:110%'> (</span><span style='font-size:9.0pt;
line-height:110%;color:brown'>2</span><span style='font-size:9.0pt;line-height:
110%'>,</span><span style='font-size:9.0pt;line-height:110%;color:brown'>1</span><span
style='font-size:9.0pt;line-height:110%'>,</span><span style='font-size:9.0pt;
line-height:110%;color:brown'>0</span><span style='font-size:9.0pt;line-height:
110%'>) (</span><span style='font-size:9.0pt;line-height:110%;color:brown'>2</span><span
style='font-size:9.0pt;line-height:110%'>,</span><span style='font-size:9.0pt;
line-height:110%;color:brown'>1</span><span style='font-size:9.0pt;line-height:
110%'>,</span><span style='font-size:9.0pt;line-height:110%;color:brown'>1</span><span
style='font-size:9.0pt;line-height:110%'>) (</span><span style='font-size:9.0pt;
line-height:110%;color:brown'>2</span><span style='font-size:9.0pt;line-height:
110%'>,</span><span style='font-size:9.0pt;line-height:110%;color:brown'>1</span><span
style='font-size:9.0pt;line-height:110%'>,</span><span style='font-size:9.0pt;
line-height:110%;color:brown'>2</span><span style='font-size:9.0pt;line-height:
110%'>)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:17.8pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'>(</span><span
style='font-size:9.0pt;line-height:110%;color:brown'>0</span><span
style='font-size:9.0pt;line-height:110%'>,</span><span style='font-size:9.0pt;
line-height:110%;color:brown'>2</span><span style='font-size:9.0pt;line-height:
110%'>,</span><span style='font-size:9.0pt;line-height:110%;color:brown'>0</span><span
style='font-size:9.0pt;line-height:110%'>) (</span><span style='font-size:9.0pt;
line-height:110%;color:brown'>0</span><span style='font-size:9.0pt;line-height:
110%'>,</span><span style='font-size:9.0pt;line-height:110%;color:brown'>2</span><span
style='font-size:9.0pt;line-height:110%'>,</span><span style='font-size:9.0pt;
line-height:110%;color:brown'>1</span><span style='font-size:9.0pt;line-height:
110%'>) (</span><span style='font-size:9.0pt;line-height:110%;color:brown'>0</span><span
style='font-size:9.0pt;line-height:110%'>,</span><span style='font-size:9.0pt;
line-height:110%;color:brown'>2</span><span style='font-size:9.0pt;line-height:
110%'>,</span><span style='font-size:9.0pt;line-height:110%;color:brown'>2</span><span
style='font-size:9.0pt;line-height:110%'>) </span><span style='font-size:9.0pt;
line-height:110%;font-family:"Arial",sans-serif'></span><span
style='font-size:9.0pt;line-height:110%'> (</span><span style='font-size:9.0pt;
line-height:110%;color:brown'>1</span><span style='font-size:9.0pt;line-height:
110%'>,</span><span style='font-size:9.0pt;line-height:110%;color:brown'>2</span><span
style='font-size:9.0pt;line-height:110%'>,</span><span style='font-size:9.0pt;
line-height:110%;color:brown'>0</span><span style='font-size:9.0pt;line-height:
110%'>) (</span><span style='font-size:9.0pt;line-height:110%;color:brown'>1</span><span
style='font-size:9.0pt;line-height:110%'>,</span><span style='font-size:9.0pt;
line-height:110%;color:brown'>2</span><span style='font-size:9.0pt;line-height:
110%'>,</span><span style='font-size:9.0pt;line-height:110%;color:brown'>1</span><span
style='font-size:9.0pt;line-height:110%'>) (</span><span style='font-size:9.0pt;
line-height:110%;color:brown'>1</span><span style='font-size:9.0pt;line-height:
110%'>,</span><span style='font-size:9.0pt;line-height:110%;color:brown'>2</span><span
style='font-size:9.0pt;line-height:110%'>,</span><span style='font-size:9.0pt;
line-height:110%;color:brown'>2</span><span style='font-size:9.0pt;line-height:
110%'>) </span><span style='font-size:9.0pt;line-height:110%;font-family:"Arial",sans-serif'></span><span
style='font-size:9.0pt;line-height:110%'> (</span><span style='font-size:9.0pt;
line-height:110%;color:brown'>2</span><span style='font-size:9.0pt;line-height:
110%'>,</span><span style='font-size:9.0pt;line-height:110%;color:brown'>2</span><span
style='font-size:9.0pt;line-height:110%'>,</span><span style='font-size:9.0pt;
line-height:110%;color:brown'>0</span><span style='font-size:9.0pt;line-height:
110%'>) (</span><span style='font-size:9.0pt;line-height:110%;color:brown'>2</span><span
style='font-size:9.0pt;line-height:110%'>,</span><span style='font-size:9.0pt;
line-height:110%;color:brown'>2</span><span style='font-size:9.0pt;line-height:
110%'>,</span><span style='font-size:9.0pt;line-height:110%;color:brown'>1</span><span
style='font-size:9.0pt;line-height:110%'>) (</span><span style='font-size:9.0pt;
line-height:110%;color:brown'>2</span><span style='font-size:9.0pt;line-height:
110%'>,</span><span style='font-size:9.0pt;line-height:110%;color:brown'>2</span><span
style='font-size:9.0pt;line-height:110%'>,</span><span style='font-size:9.0pt;
line-height:110%;color:brown'>2</span><span style='font-size:9.0pt;line-height:
110%'>)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:27.75pt;
margin-left:.75pt'>Further dimensions could be thought as the multiplication of
the 3D, so a 4D(1,3,3,3) would be two side-by-side 3D arrays.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.2pt;
margin-left:.75pt'><b>Two-Dimension Array</b></p>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:17.4pt;margin-left:
.75pt'>Creating</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>The example below will be a compilation of a list of
employees, each employee will have a set of information on the list (First
Name, Surname, Address, Email, Phone ...), the example will essentially be
storing on the array (employee,information) being the (0,0) is the first
employee's first name.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=720 height=503
src="VBA%20Notes%20for%20Professionals_files/image123.gif"></span></p>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:17.4pt;margin-left:
.75pt'>Resizing</h4>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=101 style='width:1.05in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=101 valign=top style='width:1.05in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>ReDim</span></b><span style='font-size:9.0pt;line-height:
  107%'> Preserve</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Resizing or a Multi-Array like the norm for a One-Dimension
array would get an error, instead the information needs to be transferred into
a Temporary array with the same size as the original plus the number of
row/columns to add. In the example below we'll see how to initialize a Temp
Array, transfer the information over from the original array, fill the
remaining empty elements, and replace the temp array by the original array.</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=720 height=339
src="VBA%20Notes%20for%20Professionals_files/image124.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=719 height=268
src="VBA%20Notes%20for%20Professionals_files/image125.gif"></span></p>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:17.4pt;margin-left:
.75pt'>Changing Element Values</h4>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=79 style='width:59.4pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=79 valign=top style='width:59.4pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'></span><span style='font-size:9.0pt;line-height:107%;color:brown'>&quot;NewValue&quot;</span></p>
  </td>
 </tr>
</table>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=94 style='width:70.2pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=65 valign=top style='width:48.6pt;background:#FAFAFA;padding:1.45pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Employees</span></p>
  </td>
  <td width=14 valign=top style='width:.15in;padding:1.45pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;background:#FAFAFA'>(</span><span style='font-size:9.0pt;line-height:
  107%;color:brown;background:#FAFAFA'>0</span></p>
  </td>
  <td width=14 valign=top style='width:.15in;background:#FAFAFA;padding:1.45pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>, </span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.85pt;
margin-left:.75pt'><span style='position:relative;z-index:-1895800832'><span
style='left:0px;position:absolute;left:189px;top:-5936px;width:7px;height:1px'><img
width=7 height=1 src="VBA%20Notes%20for%20Professionals_files/image126.gif"></span></span>To
change/alter the values in a certain element can be done by simply calling the
coordinate to change and giving it a new value: <span style='font-size:9.0pt;
line-height:110%;color:brown;background:#FAFAFA'>0</span><span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>)</span><span
style='font-size:9.0pt;line-height:110%'> <span style='background:#FAFAFA'>=</span></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Alternatively iterate through the coordinates use conditions
to match values corresponding to the parameters needed:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=142
src="VBA%20Notes%20for%20Professionals_files/image127.gif"></span></p>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:28.6pt;margin-left:
.75pt'>Reading</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Accessing the elements in the array can be done with a
Nested Loop (iterating every element), Loop and Coordinate (iterate Rows and
accessing columns directly), or accessing directly with both coordinates.</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=720 height=326
src="VBA%20Notes%20for%20Professionals_files/image128.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=21
src="VBA%20Notes%20for%20Professionals_files/image129.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:9.75pt;margin-bottom:
27.65pt;margin-left:.75pt'><b><i>Remember</i></b><i>, it's always handy to keep
an array map when using Multidimensional arrays, they can easily become
confusion.</i></p>

<h4 style='margin-left:.75pt'>Three-Dimension Array</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.45pt;
margin-left:.75pt'>For the 3D array, we'll use the same premise as the 2D
array, with the addition of not only storing the Employee and Information but
as well Building they work in.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.95pt;
margin-left:.75pt'>The 3D array will have the Employees (can be thought of as
Rows), the Information (Columns), and Building that can be thought of as
different sheets on an excel document, they have the same size between them,
but every sheets has a different set of information in its cells/elements. The
3D array will contain <b><i>n</i></b> number of 2D arrays.</p>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:17.4pt;margin-left:
.75pt'>Creating</h4>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=209 style='width:156.6pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=79 valign=top style='width:59.4pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Dim</span></b><span style='font-size:9.0pt;line-height:107%'>
  3Darray</span></p>
  </td>
  <td width=50 valign=top style='width:37.8pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;background:#FAFAFA'>(</span><span style='font-size:9.0pt;line-height:
  107%;color:brown;background:#FAFAFA'>2</span><span style='font-size:9.0pt;
  line-height:107%;background:#FAFAFA'>,</span><span style='font-size:9.0pt;
  line-height:107%;color:brown;background:#FAFAFA'>5</span><span
  style='font-size:9.0pt;line-height:107%;background:#FAFAFA'>,</span><span
  style='font-size:9.0pt;line-height:107%;color:brown;background:#FAFAFA'>5</span><span
  style='font-size:9.0pt;line-height:107%;background:#FAFAFA'>)</span></p>
  </td>
  <td width=79 valign=top style='width:59.4pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'></span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> Variant</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>A 3D array needs 3 coordinates to be initialized the first
coordinate on the array</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>will be the number of Building/Sheets (different sets of
rows and columns), second coordinate will define Rows and third Columns. The <b><span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>Dim</span></b>
above will result in a 3D array with 108 elements (<span style='font-size:9.0pt;
line-height:110%;color:brown;background:#FAFAFA'>3</span><span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>*</span><span
style='font-size:9.0pt;line-height:110%;color:brown;background:#FAFAFA'>6</span><span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>*</span><span
style='font-size:9.0pt;line-height:110%;color:brown;background:#FAFAFA'>6</span>),
effectively having 3 different sets of 2D arrays.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=720 height=355
src="VBA%20Notes%20for%20Professionals_files/image130.gif"></span></p>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:28.6pt;margin-left:
.75pt'>Resizing</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.45pt;
margin-left:.75pt'>Resizing a 3D array is similar to resizing a 2D, first
create a Temporary array with the same size of the original adding one in the
coordinate of the parameter to increase, the first coordinate will increase the
number of sets in the array, the second and third coordinates will increase the
number of Rows or Columns in each set.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:14.1pt;
margin-left:.75pt'>The example below increases the number of Rows in each set
by one, and fills those recently added elements with new information.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Dim</span></b><span
style='font-size:9.0pt;line-height:110%'> TempEmp </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> Variant</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.05pt;margin-bottom:.25pt;
margin-left:3.5pt'><i><span style='font-size:9.0pt;line-height:110%;color:green'>'initialise
your temp array as variant</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><span style='position:relative;z-index:-1895799808'><span
style='left:0px;position:absolute;left:0px;top:-7570px;width:718px;height:1px'><img
width=718 height=1 src="VBA%20Notes%20for%20Professionals_files/image131.gif"></span></span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>ReDim</span></b><span
style='font-size:9.0pt;line-height:110%'> TempEmp(</span><span
style='font-size:9.0pt;line-height:110%;color:#000066'>UBound</span><span
style='font-size:9.0pt;line-height:110%'>(ThreeDArray, </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>1</span><span
style='font-size:9.0pt;line-height:110%'>), </span><span style='font-size:9.0pt;
line-height:110%;color:#000066'>UBound</span><span style='font-size:9.0pt;
line-height:110%'>(ThreeDArray, </span><span style='font-size:9.0pt;line-height:
110%;color:brown'>2</span><span style='font-size:9.0pt;line-height:110%'>) + </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>1</span><span
style='font-size:9.0pt;line-height:110%'>, </span><span style='font-size:9.0pt;
line-height:110%;color:#000066'>UBound</span><span style='font-size:9.0pt;
line-height:110%'>(ThreeDArray, </span><span style='font-size:9.0pt;line-height:
110%;color:brown'>3</span><span style='font-size:9.0pt;line-height:110%'>))</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=720 height=563
src="VBA%20Notes%20for%20Professionals_files/image132.gif"></span></p>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:17.4pt;margin-left:
.75pt'>Changing Element Values and Reading</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Reading and changing the elements on the 3D array can be
done similarly to the way we do the 2D array, just adjust for the extra level
in the loops and coordinates.</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=354
src="VBA%20Notes%20for%20Professionals_files/image133.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=719 height=301
src="VBA%20Notes%20for%20Professionals_files/image134.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc308687">Section 9.2: Dynamic Arrays
(Array Resizing and Dynamic Handling)</a></h2>

<h4 style='margin-left:.75pt'>Dynamic Arrays</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.7pt;
margin-left:.75pt'>Adding and reducing variables on an array dynamically is a
huge advantage for when the information you are treating does not have a set
number of variables.</p>

<h4 style='margin-left:.75pt'>Adding Values Dynamically</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.55pt;
margin-left:.75pt'>You can simply resize the Array with the <b><span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>ReDim</span></b>
Statement, this will resize the array but to if you which to retain the
information already stored in the array you'll need the part <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Preserve</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>In the example below we create an array and increase it by
one more variable in each iteration while preserving the values already in the
array.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:19.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=720 height=355
src="VBA%20Notes%20for%20Professionals_files/image135.gif"></span></p>

<h4 style='margin-left:.75pt'>Removing Values Dynamically</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>We can utilise the same logic to to decrease the the array.
In the example the value &quot;last&quot; will be removed from the array.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:19.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=92
src="VBA%20Notes%20for%20Professionals_files/image136.gif"></span></p>

<h4 style='margin-left:.75pt'>Resetting an Array and Reusing Dynamically</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.65pt;
margin-left:.75pt'>We can as well re-utilise the arrays we create as not to
have many on memory, which would make the run time slower. This is useful for
arrays of various sizes. One snippet you could use to re-utilise the array is
to <b><span style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>ReDim</span></b>
the array back to <span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>(</span><span style='font-size:9.0pt;line-height:110%;color:brown;
background:#FAFAFA'>0</span><span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>)</span>, attribute one variable to to the array and freely
increase the array again.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>In the snippet below I construct an array with the values 1
to 40, empty the array, and refill the array with values 40 to 100, all this
done dynamically.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=371
src="VBA%20Notes%20for%20Professionals_files/image137.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc308688">Section 9.3: Jagged Arrays
(Arrays of Arrays)</a></h2>

<h4 style='margin-left:.75pt'>Jagged Arrays NOT Multidimensional Arrays</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.45pt;
margin-left:.75pt'>Arrays of Arrays(Jagged Arrays) are not the same as
Multidimensional Arrays if you think about them visually Multidimensional
Arrays would look like Matrices (Rectangular) with defined number of elements
on their dimensions(inside arrays), while Jagged array would be like a yearly
calendar with the inside arrays having different number of elements, like days
in on different months.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.7pt;
margin-left:.75pt'>Although Jagged Arrays are quite messy and tricky to use due
to their nested levels and don't have much type safety, but they are very
flexible, allow you to manipulate different types of data quite easily, and
don't need to contain unused or empty elements.</p>

<h4 style='margin-left:.75pt'>Creating a Jagged Array</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>In the below example we will initialise a jagged array
containing two arrays one for Names and another for Numbers, and then accessing
one element of each</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:19.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=720 height=240
src="VBA%20Notes%20for%20Professionals_files/image138.gif"></span></p>

<h4 style='margin-left:.75pt'>Dynamically Creating and Reading Jagged Arrays</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>We can as well be more dynamic in our approx to construct
the arrays, imagine that we have a customer data sheet in excel and we want to
construct an array to output the customer details.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=109
src="VBA%20Notes%20for%20Professionals_files/image139.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>We will Dynamically construct an Header array and a
Customers array, the Header will contain the column titles and the Customers
array will contain the information of each customer/row as arrays.</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=720 height=464
src="VBA%20Notes%20for%20Professionals_files/image140.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.75pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=415
src="VBA%20Notes%20for%20Professionals_files/image141.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
margin-left:0in;text-indent:0in;line-height:107%;background:#FAFAFA'><b><i><span
style='font-size:9.0pt;line-height:107%;color:blue'>To</span></i></b><i><span
style='font-size:9.0pt;line-height:107%'> better understand the way </span></i><b><i><span
style='font-size:9.0pt;line-height:107%;color:blue'>to</span></i></b><i><span
style='font-size:9.0pt;line-height:107%'> Dynamically construct a one
dimensional array please check Dynamic</span></i></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=507 style='width:380.4pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=49 valign=top style='width:37.0pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><i><span style='font-size:9.0pt;line-height:
  107%'>Arrays </span></i></p>
  </td>
  <td width=7 valign=top style='width:5.3pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><i><span style='font-size:9.0pt;line-height:
  107%;background:#FAFAFA'>(</span></i></p>
  </td>
  <td width=247 valign=top style='width:184.9pt;background:#FAFAFA;padding:
  1.8pt 0in 0in 0in;height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><i><span style='font-size:9.0pt;line-height:
  107%'>Array Resizing </span></i><b><i><span style='font-size:9.0pt;
  line-height:107%;color:blue'>and</span></i></b><i><span style='font-size:
  9.0pt;line-height:107%'> Dynamic Handling</span></i></p>
  </td>
  <td width=7 valign=top style='width:5.3pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><i><span style='font-size:9.0pt;line-height:
  107%;background:#FAFAFA'>)</span></i></p>
  </td>
  <td width=197 valign=top style='width:147.9pt;background:#FAFAFA;padding:
  1.8pt 0in 0in 0in;height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><i><span style='font-size:9.0pt;line-height:
  107%'></span></i><b><i><span style='font-size:9.0pt;line-height:107%;
  color:blue'>on</span></i></b><i><span style='font-size:9.0pt;line-height:
  107%'> the Arrays documentation</span></i></p>
  </td>
 </tr>
</table>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:0in;
margin-bottom:13.75pt;margin-left:227.45pt;text-align:center;text-indent:0in;
line-height:107%'><i><span style='font-size:9.0pt;line-height:107%;background:
#FAFAFA'>.</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:14.1pt;
margin-left:.75pt'>The Result of the above snippet is an Jagged Array with two
arrays one of those arrays with 4 elements, 2 indention levels, and the other
being itself another Jagged Array containing 5 arrays of 4 elements each and 3
indention levels, see below the structure:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'>Main_Array(</span><span
style='font-size:9.0pt;line-height:110%;color:brown'>0</span><span
style='font-size:9.0pt;line-height:110%'>) - Headers - </span><span
style='font-size:9.0pt;line-height:110%;color:#000066'>Array</span><span
style='font-size:9.0pt;line-height:110%'>(</span><span style='font-size:9.0pt;
line-height:110%;color:brown'>&quot;Name&quot;</span><span style='font-size:
9.0pt;line-height:110%'>,</span><span style='font-size:9.0pt;line-height:110%;
color:brown'>&quot;Phone&quot;</span><span style='font-size:9.0pt;line-height:
110%'>,</span><span style='font-size:9.0pt;line-height:110%;color:brown'>&quot;Email&quot;</span><span
style='font-size:9.0pt;line-height:110%'>,</span><span style='font-size:9.0pt;
line-height:110%;color:brown'>&quot;Customer Number&quot;</span><span
style='font-size:9.0pt;line-height:110%'>)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:86.6pt;margin-bottom:
.2pt;margin-left:3.5pt'><span style='position:relative;z-index:-1895798784'><span
style='left:0px;position:absolute;left:0px;top:-12102px;width:718px;height:
1px'><img width=718 height=1
src="VBA%20Notes%20for%20Professionals_files/image142.gif"></span></span><span
style='font-size:9.0pt;line-height:110%'> (</span><span
style='font-size:9.0pt;line-height:110%;color:brown'>1</span><span
style='font-size:9.0pt;line-height:110%'>) - Customers(</span><span
style='font-size:9.0pt;line-height:110%;color:brown'>0</span><span
style='font-size:9.0pt;line-height:110%'>) - </span><span style='font-size:
9.0pt;line-height:110%;color:#000066'>Array</span><span style='font-size:9.0pt;
line-height:110%'>(</span><span style='font-size:9.0pt;line-height:110%;
color:brown'>&quot;Person1&quot;</span><span style='font-size:9.0pt;line-height:
110%'>,</span><span style='font-size:9.0pt;line-height:110%;color:brown'>153486231</span><span
style='font-size:9.0pt;line-height:110%'>,</span><span style='font-size:9.0pt;
line-height:110%;color:brown'>&quot;1@STACK&quot;</span><span style='font-size:
9.0pt;line-height:110%'>,001) Customers(</span><span
style='font-size:9.0pt;line-height:110%;color:brown'>1</span><span
style='font-size:9.0pt;line-height:110%'>) - </span><span style='font-size:
9.0pt;line-height:110%;color:#000066'>Array</span><span style='font-size:9.0pt;
line-height:110%'>(</span><span style='font-size:9.0pt;line-height:110%;
color:brown'>&quot;Person2&quot;</span><span style='font-size:9.0pt;line-height:
110%'>,</span><span style='font-size:9.0pt;line-height:110%;color:brown'>153486242</span><span
style='font-size:9.0pt;line-height:110%'>,</span><span style='font-size:9.0pt;
line-height:110%;color:brown'>&quot;2@STACK&quot;</span><span style='font-size:
9.0pt;line-height:110%'>,002)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'>
...</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:17.25pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'>
Customers(</span><span style='font-size:9.0pt;line-height:110%;color:brown'>4</span><span
style='font-size:9.0pt;line-height:110%'>) - </span><span style='font-size:
9.0pt;line-height:110%;color:#000066'>Array</span><span style='font-size:9.0pt;
line-height:110%'>(</span><span style='font-size:9.0pt;line-height:110%;
color:brown'>&quot;Person5&quot;</span><span style='font-size:9.0pt;line-height:
110%'>,</span><span style='font-size:9.0pt;line-height:110%;color:brown'>153486275</span><span
style='font-size:9.0pt;line-height:110%'>,</span><span style='font-size:9.0pt;
line-height:110%;color:brown'>&quot;5@STACK&quot;</span><span style='font-size:
9.0pt;line-height:110%'>,005)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.6pt;
margin-left:.75pt'>To access the information you'll have to bear in mind the
structure of the Jagged Array you create, in the above example you can see that
the <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Main
Array</span> contains an Array of <span style='font-size:9.0pt;line-height:
110%;background:#FAFAFA'>Headers</span> and an Array of Arrays (<span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Customers</span>)
hence with different ways of accessing the elements.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>Now we'll read the information of the <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Main Array</span>
and print out each of the Customers information as <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>Info Type:</span></p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=720 height=254
src="VBA%20Notes%20for%20Professionals_files/image143.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>REMEMBER to keep track of the structure of your Jagged
Array, in the example above to access the Name of a</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=353 style='width:264.65pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=353 valign=top style='width:264.65pt;background:#FAFAFA;padding:
  1.8pt 0in 0in 0in;height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Main_Array -&gt; Customers -&gt; CustomerNumber -&gt; Name</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>customer is by accessing which is three levels, to return</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=72 style='width:.75in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=72 valign=top style='width:.75in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Main_Array</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'><span style='font-size:9.0pt;line-height:110%;color:brown;
background:#FAFAFA'>&quot;Person4&quot;</span> you'll need the location of
Customers in the Main_Array, then the Location of customer four on the
Customers Jagged array and lastly the location of the element you need, in this
case <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>(</span><span
style='font-size:9.0pt;line-height:110%;color:brown;background:#FAFAFA'>1</span><span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>)(</span><span
style='font-size:9.0pt;line-height:110%;color:brown;background:#FAFAFA'>3</span><span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>)(</span><span
style='font-size:9.0pt;line-height:110%;color:brown;background:#FAFAFA'>0</span><span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>)</span> which is</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=302 style='width:3.15in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=72 valign=top style='width:.75in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Main_Array</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;background:#FAFAFA'>(</span></p>
  </td>
  <td width=65 valign=top style='width:48.6pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Customers</span></p>
  </td>
  <td width=14 valign=top style='width:.15in;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;background:#FAFAFA'>)(</span></p>
  </td>
  <td width=101 valign=top style='width:1.05in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>CustomerNumber</span></p>
  </td>
  <td width=14 valign=top style='width:.15in;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;background:#FAFAFA'>)(</span></p>
  </td>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Name</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:208.35pt;margin-bottom:
0in;margin-left:-.75pt;text-indent:3.15in;line-height:147%'><span
style='font-size:9.0pt;line-height:147%;background:#FAFAFA'>)</span>.</p>

<h2 style='margin-top:0in;margin-right:208.35pt;margin-bottom:0in;margin-left:
-.75pt;text-indent:3.15in;line-height:147%'><a name="_Toc308689">Section 9.4:
Declaring an Array in VBA</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:14.1pt;
margin-left:.75pt'>Declaring an array is very similar to declaring a variable,
except you need to declare the dimension of the Array right after its name:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.05pt;margin-bottom:17.5pt;
margin-left:3.5pt'><span style='position:relative;z-index:-1895797760'><span
style='left:0px;position:absolute;left:0px;top:-12818px;width:718px;height:
1px'><img width=718 height=1
src="VBA%20Notes%20for%20Professionals_files/image144.gif"></span></span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Dim</span></b><span
style='font-size:9.0pt;line-height:110%'> myArray(</span><span
style='font-size:9.0pt;line-height:110%;color:brown'>9</span><span
style='font-size:9.0pt;line-height:110%'>) </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>As</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:slateblue'>String</span><span style='font-size:9.0pt;line-height:110%'> </span><i><span
style='font-size:9.0pt;line-height:110%;color:green'>'Declaring an array that
will contain up to 10 strings</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.85pt;
margin-left:.75pt'>By default, Arrays in VBA are <b>indexed from ZERO</b>,
thus, the number inside the parenthesis doesn't refer to the size of the array,
but rather to <b>the index of the last element</b></p>

<h4 style='margin-left:.75pt'>Accessing Elements</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Accessing an element of the Array is done by using the name
of the Array, followed by the index of the element, inside parenthesis:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:19.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="VBA%20Notes%20for%20Professionals_files/image145.gif"></span></p>

<h4 style='margin-left:.75pt'>Array Indexing</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>You can change Arrays indexing by placing this line at the
top of a module:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="VBA%20Notes%20for%20Professionals_files/image146.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:13.3pt;
margin-left:.75pt'>With this line, all Arrays declared in the module will be <b>indexed
from ONE</b>.</p>

<h4 style='margin-left:.75pt'>Specific Index</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:14.1pt;
margin-left:.75pt'>You can also declare each Array with its own index by using
the <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>To</span>
keyword, and the lower and upper bound (= index):</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.05pt;margin-bottom:.25pt;
margin-left:3.5pt'><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Dim</span></b><span
style='font-size:9.0pt;line-height:110%'> mySecondArray(</span><span
style='font-size:9.0pt;line-height:110%;color:brown'>1</span><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>To</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:brown'>12</span><span style='font-size:9.0pt;line-height:110%'>) </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>String</span><span style='font-size:9.0pt;
line-height:110%'> </span><i><span style='font-size:9.0pt;line-height:110%;
color:green'>'Array of 12 strings indexed from 1 to 12</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.05pt;margin-bottom:21.35pt;
margin-left:3.5pt'><span style='position:relative;z-index:-1895796736'><span
style='left:0px;position:absolute;left:0px;top:-13310px;width:718px;height:
1px'><img width=718 height=1
src="VBA%20Notes%20for%20Professionals_files/image147.gif"></span></span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Dim</span></b><span
style='font-size:9.0pt;line-height:110%'> myThirdArray(</span><span
style='font-size:9.0pt;line-height:110%;color:brown'>13</span><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>To</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:brown'>24</span><span style='font-size:9.0pt;line-height:110%'>) </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>String</span><span style='font-size:9.0pt;
line-height:110%'> </span><i><span style='font-size:9.0pt;line-height:110%;
color:green'>'Array of 12 strings indexed from 13 to 24</span></i></p>

<h4 style='margin-left:.75pt'>Dynamic Declaration</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:14.3pt;
margin-left:.75pt'>When you do not know the size of your Array prior to its
declaration, you can use the dynamic declaration, and the <b><span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>ReDim</span></b>
keyword:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:76.15pt;margin-bottom:
17.25pt;margin-left:3.5pt'><span style='position:relative;z-index:-1895795712'><span
style='left:0px;position:absolute;left:0px;top:-13450px;width:718px;height:
1px'><img width=718 height=1
src="VBA%20Notes%20for%20Professionals_files/image147.gif"></span></span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Dim</span></b><span
style='font-size:9.0pt;line-height:110%'> myDynamicArray() </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> Strings </span><i><span
style='font-size:9.0pt;line-height:110%;color:green'>'Creates an Array of an
unknown number of strings </span></i><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>ReDim</span></b><span style='font-size:9.0pt;
line-height:110%'> myDynamicArray(</span><span style='font-size:9.0pt;
line-height:110%;color:brown'>5</span><span style='font-size:9.0pt;line-height:
110%'>) </span><i><span style='font-size:9.0pt;line-height:110%;color:green'>'This
resets the array to 6 elements</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Note that using the <b><span style='font-size:9.0pt;
line-height:110%;color:blue;background:#FAFAFA'>ReDim</span></b> keyword will
wipe out any previous content of your Array. To prevent this, you can use the <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Preserve</span>
keyword after <b><span style='font-size:9.0pt;line-height:110%;color:blue;
background:#FAFAFA'>ReDim</span></b>:</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=43
src="VBA%20Notes%20for%20Professionals_files/image148.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.05pt;margin-bottom:.25pt;
margin-left:3.5pt'><span style='position:relative;z-index:-1895794688'><span
style='left:0px;position:absolute;left:0px;top:-13592px;width:718px;height:
1px'><img width=718 height=1
src="VBA%20Notes%20for%20Professionals_files/image149.gif"></span></span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>ReDim</span></b><span
style='font-size:9.0pt;line-height:110%'> Preserve myDynamicArray(</span><span
style='font-size:9.0pt;line-height:110%;color:brown'>8</span><span
style='font-size:9.0pt;line-height:110%'>) </span><i><span style='font-size:
9.0pt;line-height:110%;color:green'>'Expand the size to up to 9 strings</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:23.0pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'>Debug.Print
myDynamicArray(</span><span style='font-size:9.0pt;line-height:110%;color:brown'>0</span><span
style='font-size:9.0pt;line-height:110%'>) </span><i><span style='font-size:
9.0pt;line-height:110%;color:green'>' still prints the element</span></i></p>

<h2 style='margin-left:-.25pt'><a name="_Toc308690">Section 9.5: Use of Split
to create an array from a string</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:122.7pt;margin-bottom:
0in;margin-left:.75pt;line-height:217%'><b>Split Function </b>returns a
zero-based, one dimensional array containing a specified number of substrings.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.2pt;
margin-left:.75pt'><b>Syntax</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.2pt;
margin-left:.75pt'><b>Split(expression</b> [, <b>delimiter</b> [, <b>limit</b>
[, <b>compare</b>]]]<b>)</b></p>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:.6pt;margin-left:0in;
text-indent:0in'><span style='font-size:11.0pt;line-height:110%;font-weight:
normal'> </span>Part Description</h4>

<p class=MsoNormal align=right style='margin-top:0in;margin-right:8.2pt;
margin-bottom:0in;margin-left:.5pt;text-align:right;line-height:107%'>Required.
String expression containing substrings and delimiters. If <i>expression</i> is
a zero-length string(&quot;&quot;</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:54.45pt;text-indent:-54.2pt'><b><i>expression </i></b>or
vbNullString), <b>Split</b> returns an empty array containing no elements and
no data. In this case, the returned array will have a LBound of 0 and a UBound
of -1.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=698
 style='width:523.6pt;margin-left:1.0pt;border-collapse:collapse'>
 <tr style='height:37.65pt'>
  <td width=72 style='width:54.2pt;padding:0in 0in 0in 0in;height:37.65pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><b><i>delimiter</i></b></p>
  </td>
  <td width=626 valign=top style='width:469.45pt;padding:0in 0in 0in 0in;
  height:37.65pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Optional.
  String character used to identify substring limits. If omitted, the space
  character (&quot; &quot;) is assumed to be the delimiter. If <b><i>delimiter</i></b>
  is a zero-length string, a single-element array containing the entire <b><i>expression</i></b>
  string is returned.</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=72 valign=top style='width:54.2pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><b><i>limit</i></b></p>
  </td>
  <td width=626 valign=top style='width:469.45pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Optional.
  Number of substrings to be returned; -1 indicates that all substrings are
  returned.</p>
  </td>
 </tr>
 <tr style='height:19.65pt'>
  <td width=72 valign=bottom style='width:54.2pt;padding:0in 0in 0in 0in;
  height:19.65pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><b><i>compare</i></b></p>
  </td>
  <td width=626 valign=top style='width:469.45pt;padding:0in 0in 0in 0in;
  height:19.65pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Optional.
  Numeric value indicating the kind of comparison to use when evaluating
  substrings. See</p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:15.3pt;
margin-left:55.7pt'>Settings section for values.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.2pt;
margin-left:.75pt'><b>Settings</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:13.05pt;
margin-left:.75pt'>The <b><i>compare</i></b> argument can have the following
values:</p>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:1.1pt;margin-left:
0in;text-indent:0in'><span style='font-size:11.0pt;line-height:110%;font-weight:
normal'> </span>Constant Value Description</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:4.55pt;margin-bottom:
11.3pt;margin-left:.75pt;line-height:142%'>Description -1 Performs
a comparison using the setting of the <b>Option Compare</b> statement.
vbBinaryCompare 0 Performs a binary comparison.
vbTextCompare 1 Performs a textual comparison.
vbDatabaseCompare 2 Microsoft Access only. Performs a comparison
based on information in your database.</p>

<h4 style='margin-left:.75pt'>Example</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>In this example it is demonstrated how Split works by
showing several styles. The comments will show the result set for each of the
different performed Split options. Finally it is demonstrated how to loop over
the returned string array.</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=283
src="VBA%20Notes%20for%20Professionals_files/image150.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=268
src="VBA%20Notes%20for%20Professionals_files/image151.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc308691">Section 9.6: Iterating
elements of an array</a></h2>

<h4 style='margin-left:.75pt'>For...Next</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>Using the iterator variable as the index number is the
fastest way to iterate the elements of an array:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=142
src="VBA%20Notes%20for%20Professionals_files/image152.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>Nested loops can be used to iterate multi-dimensional
arrays:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:19.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=240
src="VBA%20Notes%20for%20Professionals_files/image153.gif"></span></p>

<h4 style='margin-left:.75pt'>For Each...Next</h4>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=108 style='width:81.0pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=108 valign=top style='width:81.0pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>For</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Each</span></b><span
  style='font-size:9.0pt;line-height:107%'>...</span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Next</span></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>A loop can also be used to iterate arrays, if performance
doesn't matter:</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=111
src="VBA%20Notes%20for%20Professionals_files/image154.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=38
src="VBA%20Notes%20for%20Professionals_files/image155.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=58 style='width:.6in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>For</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Each</span></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>A loop will iterate all dimensions from outer to inner (the
same order as the elements are laid out in memory), so there is no need for
nested loops:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.1pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=191
src="VBA%20Notes%20for%20Professionals_files/image156.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=58 style='width:.6in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>For</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Each</span></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.9pt;
margin-left:.75pt'>Note that loops are best used to iterate <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Collection</span>
objects, if performance matters.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>All 4 snippets above produce the same output:</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=76
src="VBA%20Notes%20for%20Professionals_files/image157.gif"></span><br
clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc308692">Chapter 10: Error Handling</a></h1>

<h2 style='margin-left:-.25pt'><a name="_Toc308693">Section 10.1: Avoiding
error conditions</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.45pt;
margin-left:.75pt'>When a runtime error occurs, good code should handle it. The
best error handling strategy is to write code that checks for error conditions
and simply avoids executing code that results in a runtime error.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.7pt;
margin-left:.75pt'>One key element in reducing runtime errors, is writing small
procedures that <i>do one thing</i>. The fewer reasons procedures have to fail,
the easier the code as a whole is to debug.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.2pt;
margin-left:.75pt'><b>Avoiding runtime error 91 - Object or With block variable
not set:</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>This error will be raised when an object is used before its
reference is assigned. One might have a procedure that receives an object
parameter:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="VBA%20Notes%20for%20Professionals_files/image158.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>If <span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>target</span> isn't assigned a reference, the above code will raise an
error that is easily avoided by checking if the object contains an actual
object reference:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=76
src="VBA%20Notes%20for%20Professionals_files/image159.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.85pt;
margin-left:.75pt'>If <span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>target</span> isn't assigned a reference, then the unassigned
reference is never used, and no error occurs.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:13.05pt;
margin-left:.75pt'>This way of early-exiting a procedure when one or more
parameter isn't valid, is called a <i>guard clause</i>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.2pt;
margin-left:.75pt'><b>Avoiding runtime error 9 - Subscript out of range:</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>This error is raised when an array is accessed outside of
its boundaries.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.1pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="VBA%20Notes%20for%20Professionals_files/image160.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Given an index greater than the number of worksheets in the <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>ActiveWorkbook</span>,
the above code will raise a runtime error. A simple guard clause can avoid
that:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=76
src="VBA%20Notes%20for%20Professionals_files/image161.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.55pt;margin-bottom:.25pt;
margin-left:.75pt;text-align:justify;text-justify:inter-ideograph;line-height:
135%'>Most runtime errors can be avoided by carefully verifying the values
we're using <i>before</i> we use them, and branching on another execution path
accordingly using a simple <span style='font-size:9.0pt;line-height:135%;
background:#FAFAFA'>If</span> statement - in guard clauses that makes no
assumptions and validates a procedure's parameters, or even in the body of
larger procedures.</p>

<h2 style='margin-top:0in;margin-right:.55pt;margin-bottom:.25pt;margin-left:
.75pt;text-align:justify;text-justify:inter-ideograph;line-height:135%'><a
name="_Toc308694">Section 10.2: Custom Errors</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>Often when writing a specialized class, you'll want it to
raise its own specific errors, and you'll want a clean way for user/calling
code to handle these custom errors. A neat way to achieve this is by defining a
dedicated <b><span style='font-size:9.0pt;line-height:110%;color:blue;
background:#FAFAFA'>Enum</span></b> type:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=109
src="VBA%20Notes%20for%20Professionals_files/image162.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Using the <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>vbObjectError</span> built-in constant ensures the custom
error codes don't overlap with reserved/existing error codes. Only the first
enum value needs to be explicitly specified, for the underlying value of each <b><span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>Enum </span></b>member
is <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>1</span>
greater than the previous member, so the underlying value of <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Err_BarNotInitialized</span>
is implicitly</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=144 style='width:1.5in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=101 valign=top style='width:1.05in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>vbObjectError </span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;background:#FAFAFA'>+</span></p>
  </td>
  <td width=36 valign=top style='width:27.0pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'></span><span style='font-size:9.0pt;line-height:107%;color:brown'>1025</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:13.05pt;
margin-left:108.5pt'>.</p>

<h4 style='margin-left:.75pt'>Raising your own runtime errors</h4>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=65 style='width:48.6pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=22 valign=top style='width:16.2pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Err</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;background:#FAFAFA'>.</span></p>
  </td>
  <td width=36 valign=top style='width:27.0pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Raise</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>A runtime error can be raised using the statement, so the
custom <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Err_FooWasNotBarred</span>
error can be raised as follows:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.1pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="VBA%20Notes%20for%20Professionals_files/image163.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=65 style='width:48.6pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=22 valign=top style='width:16.2pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Err</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;background:#FAFAFA'>.</span></p>
  </td>
  <td width=36 valign=top style='width:27.0pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Raise</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:14.1pt;
margin-left:.75pt'>The method can also take custom <span style='font-size:
9.0pt;line-height:110%;background:#FAFAFA'>Description</span> and <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Source</span>
parameters - for this reason it's a good idea to also define constants to hold
each custom error's description:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt'><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Private</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Const</span></b><span style='font-size:9.0pt;
line-height:110%'> Msg_FooWasNotBarred </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>As</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:slateblue'>String</span><span style='font-size:9.0pt;line-height:110%'> =
</span><span style='font-size:9.0pt;line-height:110%;color:brown'>&quot;The foo
was not barred.&quot;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:95.05pt;margin-bottom:
0in;margin-left:.25pt;text-indent:3.75pt;line-height:240%'><span
style='position:relative;z-index:-1895793664'><span style='left:0px;position:
absolute;left:0px;top:-17462px;width:718px;height:1px'><img width=718 height=1
src="VBA%20Notes%20for%20Professionals_files/image147.gif"></span></span><b><span
style='font-size:9.0pt;line-height:240%;color:blue'>Private</span></b><span
style='font-size:9.0pt;line-height:240%'> </span><b><span style='font-size:
9.0pt;line-height:240%;color:blue'>Const</span></b><span style='font-size:9.0pt;
line-height:240%'> Msg_BarNotInitialized </span><b><span style='font-size:9.0pt;
line-height:240%;color:blue'>As</span></b><span style='font-size:9.0pt;
line-height:240%'> </span><span style='font-size:9.0pt;line-height:240%;
color:slateblue'>String</span><span style='font-size:9.0pt;line-height:240%'> =
</span><span style='font-size:9.0pt;line-height:240%;color:brown'>&quot;The bar
was not initialized.&quot; </span>And then create a dedicated private method to
raise each error:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=125
src="VBA%20Notes%20for%20Professionals_files/image164.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>The class' implementation can then simply call these
specialized procedures to raise the error:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.15pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=720 height=92
src="VBA%20Notes%20for%20Professionals_files/image165.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.5pt;
margin-left:.75pt'>The client code can then handle <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>Err_BarNotInitialized</span> as it would
any other error, inside its own error-handling subroutine.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=65 style='width:48.6pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=22 valign=top style='width:16.2pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Err</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;background:#FAFAFA'>.</span></p>
  </td>
  <td width=36 valign=top style='width:27.0pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Raise</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:7.1pt;margin-bottom:0in;
margin-left:.75pt;line-height:145%'>Note: the legacy <b><span style='font-size:
9.0pt;line-height:145%;color:blue;background:#FAFAFA'>Error</span></b> keyword
can also be used in place of , but it's obsolete/deprecated.</p>

<h2 style='margin-top:0in;margin-right:7.1pt;margin-bottom:0in;margin-left:
.75pt;line-height:145%'><a name="_Toc308695">Section 10.3: Resume keyword</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.8pt;
margin-left:.75pt'>An error-handling subroutine will either:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:74.85pt;margin-bottom:
1.5pt;margin-left:21.4pt'><img width=5 height=1
src="VBA%20Notes%20for%20Professionals_files/image166.gif" align=left
hspace=12>run to the end of the procedure, in which case execution resumes in
the calling procedure. or, use the <b><span style='font-size:9.0pt;line-height:
110%;color:blue;background:#FAFAFA'>Resume</span></b> keyword to <i>resume</i>
execution inside the same procedure.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.6pt;
margin-left:.75pt'>The <b><span style='font-size:9.0pt;line-height:110%;
color:blue;background:#FAFAFA'>Resume</span></b> keyword should only ever be
used inside an error handling subroutine, because if VBA encounters <b><span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>Resume</span></b>
without being in an error state, runtime error 20 &quot;Resume without
error&quot; is raised.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:13.15pt;
margin-left:.75pt'>There are several ways an error-handling subroutine may use
the <b><span style='font-size:9.0pt;line-height:110%;color:blue;background:
#FAFAFA'>Resume</span></b> keyword:</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=79 style='width:59.4pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=79 valign=top style='width:59.4pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Resume</span></b><span style='font-size:9.0pt;line-height:
  107%'> </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Next</span></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:5.85pt;margin-bottom:
1.5pt;margin-left:21.4pt'><span style='font-size:11.0pt;line-height:110%'><img
border=0 width=5 height=5 id="Group 286903"
src="VBA%20Notes%20for%20Professionals_files/image167.gif"></span><b><span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>Resume</span></b>
used alone, execution continues <b>on the statement that caused the error</b>.
If the error isn't <i>actually </i>handled before doing that, then the same
error will be raised again, and execution might enter an infinite loop. <span
style='font-size:11.0pt;line-height:110%'><img border=0 width=5 height=5
id="Group 286905" src="VBA%20Notes%20for%20Professionals_files/image167.gif"></span> continues
execution <b>on the statement immediately following</b> the statement that
caused the</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:30.5pt'>error. If the error isn't <i>actually</i> handled before
doing that, then execution is permitted to continue with potentially invalid
data, which may result in logical errors and unexpected behavior.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=130 style='width:1.35in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=50 valign=top style='width:37.8pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Resume</span></b><span style='font-size:9.0pt;line-height:
  107%'> </span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;background:#FAFAFA'>[</span></p>
  </td>
  <td width=72 valign=top style='width:.75in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>line label</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:2.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'> <img border=0 width=5 height=5 id="Group 286906"
src="VBA%20Notes%20for%20Professionals_files/image167.gif"></span><span
style='font-size:9.0pt;line-height:107%;background:#FAFAFA'> ]</span>
continues execution <b>at the specified line label</b> (or line number, if
you're using legacy-</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:24.85pt;
margin-left:30.5pt'>style line numbers). This would typically allow executing
some cleanup code before cleanly exiting the procedure, such as ensuring a
database connection is closed before returning to the caller.</p>

<h4 style='margin-left:.75pt'>On Error Resume Next</h4>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=58 style='width:.6in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>On</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Error</span></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:24.05pt;
margin-left:.75pt'>The statement itself can use the <b><span style='font-size:
9.0pt;line-height:110%;color:blue;background:#FAFAFA'>Resume</span></b> keyword
to instruct the VBA runtime to effectively <b>ignore all errors</b>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:9.75pt;margin-bottom:
24.05pt;margin-left:24.5pt'><img width=3 height=1
src="VBA%20Notes%20for%20Professionals_files/image168.gif" align=left
hspace=12><i>If the error isn't <b>actually handled</b> before doing that, then
execution is permitted to continue with potentially invalid data, which may
result in <b>logical errors and unexpected behavior</b>.</i></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=144 style='width:1.5in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=144 valign=top style='width:1.5in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>On</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Error</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Resume</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Next</span></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.9pt;
margin-left:.75pt'>The emphasis above cannot be emphasized enough. <b><i>On
Error Resume Next</i> effectively ignores all errors and shoves them under the
carpet</b>. A program that blows up with a runtime error given invalid input is
a better program than one that keeps running with unknown/unintended data - be
it only because the bug is much more easily identifiable. can easily <b>hide
bugs</b>.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=681 style='width:511.05pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>On</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Error</span></b></p>
  </td>
  <td width=566 valign=top style='width:424.65pt;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'>statement is procedure-scoped - that's why
  there should <i>normally</i> be only <b>one</b>, single such </p>
  </td>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>On</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Error</span></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:390.35pt;margin-bottom:
12.4pt;margin-left:.75pt'>The statement in a given procedure.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=79 style='width:59.4pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=79 valign=top style='width:59.4pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Resume</span></b><span style='font-size:9.0pt;line-height:
  107%'> </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Next</span></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:59.65pt;text-indent:-59.4pt'>However <i>sometimes</i> an error
condition can't quite be avoided, and jumping to an error-handling subroutine
only to just doesn't feel right. In this specific case, the
known-to-possibly-fail statement can be <b>wrapped</b></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=58 style='width:.6in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>On</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Error</span></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>between two statements:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=76
src="VBA%20Notes%20for%20Professionals_files/image169.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=101 style='width:1.05in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=101 valign=top style='width:1.05in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>On</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Error</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>GoTo</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>The <span style='font-size:9.0pt;line-height:110%;
color:brown;background:#FAFAFA'>0</span> instruction resets error handling in
the current procedure, such that any further instruction causing a runtime
error <i>would be unhandled within that procedure</i> and instead passed up the
call stack until it is caught by an active error handler. If there is no active
error handler in the call stack, it will be treated as an unhandled exception.</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=132
src="VBA%20Notes%20for%20Professionals_files/image170.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=252
src="VBA%20Notes%20for%20Professionals_files/image171.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc308696">Section 10.4: On Error
statement</a></h2>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=94 style='width:70.2pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=94 valign=top style='width:70.2pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>On</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Error</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>GoTo</span></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.65pt;
margin-left:.75pt'>Even with <i>guard clauses</i>, one cannot realistically <i>always</i>
account for all possible error conditions that could be raised in the body of a
procedure. The statement instructs VBA to jump to a <i>line label</i> and
enter &quot;error handling mode&quot; whenever an unexpected error occurs at
runtime. After handling an error, code can <i>resume</i> back into
&quot;normal&quot; execution using the <b><span style='font-size:9.0pt;
line-height:110%;color:blue;background:#FAFAFA'>Resume</span></b> keyword.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.7pt;
margin-left:.75pt'><i>Line labels</i> denote <i>subroutines</i>: because
subroutines originate from legacy BASIC code and uses <b><span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>GoTo</span></b>
and <b><span style='font-size:9.0pt;line-height:110%;color:blue;background:
#FAFAFA'>GoSub </span></b>jumps and <b><span style='font-size:9.0pt;line-height:
110%;color:blue;background:#FAFAFA'>Return</span></b> statements to jump back
to the &quot;main&quot; routine, it's fairly easy to write hard-to-follow <i>spaghetti
code</i> if things aren't rigorously structured. For this reason, it's best
that:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:205.25pt;margin-bottom:
12.65pt;margin-left:21.4pt'><img width=5 height=1
src="VBA%20Notes%20for%20Professionals_files/image172.gif" align=left
hspace=12>a procedure has <b>one and only one</b> error-handling subroutine the
error-handling subroutine <b>only ever runs in an error state</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>This means a procedure that handles its errors, should be
structured like this:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:19.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=223
src="VBA%20Notes%20for%20Professionals_files/image173.gif"></span></p>

<h4 style='margin-left:.75pt'>Error Handling Strategies</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Sometimes you want to handle different errors with different
actions. In that case you will inspect the global <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>Err </span>object, which will contain
information about the error that was raised - and act accordingly:</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=124
src="VBA%20Notes%20for%20Professionals_files/image174.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=719 height=169
src="VBA%20Notes%20for%20Professionals_files/image175.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>As a general guideline, consider turning on the error
handling for entire subroutine or function, and handle all the errors that may
occur within its scope. If you need to only handle errors in the small section
section of the code -turn error handling on and off a the same level:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:19.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=289
src="VBA%20Notes%20for%20Professionals_files/image176.gif"></span></p>

<h4 style='margin-left:.75pt'>Line numbers</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>VBA supports legacy-style (e.g. QBASIC) line numbers. The <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Erl</span> hidden
property can be used to identify the line number that raised the last error. If
you're not using line numbers, <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>Erl</span> will only ever return 0.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=125
src="VBA%20Notes%20for%20Professionals_files/image177.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>If you <i>are</i> using line numbers, but not consistently,
then <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Erl</span>
will return <i>the last line number before the instruction that raised the
error</i>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=125
src="VBA%20Notes%20for%20Professionals_files/image178.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>Keep in mind that <span style='font-size:9.0pt;line-height:
110%;background:#FAFAFA'>Erl</span> also only has <span style='font-size:9.0pt;
line-height:110%;color:slateblue;background:#FAFAFA'>Integer</span> precision,
and will silently overflow. This means that line numbers outside of the integer
range will give incorrect results:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=109
src="VBA%20Notes%20for%20Professionals_files/image179.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>The line number isn't quite as relevant as the statement
that caused the error, and numbering lines quickly becomes tedious and not
quite maintenance-friendly.<br clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc308697">Chapter 11: Recursion</a></h1>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.45pt;
margin-left:.75pt'>A function that calls itself is said to be <i>recursive</i>.
Recursive logic can often be implemented as a loop, too. Recursion must be
controlled with a parameter, so that the function knows when to stop recursing
and deepening the call stack. <i>Infinite recursion</i> eventually causes a
run-time error '28': &quot;Out of stack space&quot;.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:18.55pt;
margin-left:.75pt'>See Recursion.</p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:0in;margin-left:-.25pt'><a
name="_Toc308698">Section 11.1: Factorials</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=125
src="VBA%20Notes%20for%20Professionals_files/image180.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc308699">Section 11.2: Folder
Recursion</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>Early Bound (with a reference to <span style='font-size:
9.0pt;line-height:110%;background:#FAFAFA'>Microsoft Scripting Runtime</span>)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
0in;margin-left:-.45pt;text-indent:0in;line-height:107%'><img border=0
width=719 height=604 id="Picture 302177"
src="VBA%20Notes%20for%20Professionals_files/image181.gif"></p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=21
src="VBA%20Notes%20for%20Professionals_files/image182.gif"></span><br
clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc308700">Chapter 12: Conditional
Compilation</a></h1>

<h2 style='margin-left:-.25pt'><a name="_Toc308701">Section 12.1: Changing code
behavior at compile time</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>The <b><span style='font-size:9.0pt;line-height:110%;
color:slateblue;background:#FAFAFA'>#Const</span></b> directive is used to
define a custom preprocessor constant. These can later be used by <b><span
style='font-size:9.0pt;line-height:110%;color:slateblue;background:#FAFAFA'>#If</span></b>
to control which blocks of code get compiled and executed.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.9pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=199
src="VBA%20Notes%20for%20Professionals_files/image183.gif"></span></p>

<h4 style='margin-left:.75pt'>#Const Scope</h4>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=65 style='width:48.6pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=65 valign=top style='width:48.6pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>constName</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'><span style='position:relative;z-index:-1895789568'><span
style='left:0px;position:absolute;left:601px;top:-22616px;width:61px;
height:1px'><img width=61 height=1
src="VBA%20Notes%20for%20Professionals_files/image184.gif"></span></span>The <b><span
style='font-size:9.0pt;line-height:110%;color:slateblue;background:#FAFAFA'>#Const</span></b>
directive is only effective for a single code file (module or class). It must
be declared for each and every file you wish to use your custom constant in.
Alternatively, you can declare a <b><span style='font-size:9.0pt;line-height:
110%;color:slateblue;background:#FAFAFA'>#Const</span></b> globally for your
project by going to Tools &gt;&gt; [Your Project Name] Project Properties. This
will bring up the project properties dialog box where we<span style='font-family:
"Arial",sans-serif'></span>ll enter the constant declaration. In the <span
style='font-family:"Arial",sans-serif'></span>Conditional Compilation
Arguments<span style='font-family:"Arial",sans-serif'></span> box, type in <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>[]</span><span
style='font-size:9.0pt;line-height:110%'> <span style='background:#FAFAFA'>=</span></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=586 style='width:439.8pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=36 valign=top style='width:27.0pt;background:#FAFAFA;padding:.95pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>value</span></p>
  </td>
  <td width=478 valign=top style='width:358.8pt;padding:.95pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;background:#FAFAFA'>]</span>. You can enter more than 1 constant by
  separating them with a colon, like <span style='font-size:9.0pt;line-height:
  107%;background:#FAFAFA'>[</span></p>
  </td>
  <td width=72 valign=top style='width:.75in;background:#FAFAFA;padding:.95pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>constName1</span></p>
  </td>
 </tr>
</table>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=65 style='width:48.6pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=43 valign=top style='width:.45in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>value1</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;background:#FAFAFA'>]</span></p>
  </td>
  <td width=14 valign=top style='width:.15in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>:</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:17.75pt;margin-bottom:
1.35pt;margin-left:-.25pt;line-height:107%'><span style='font-size:9.0pt;
line-height:107%;background:#FAFAFA'>[]</span><span style='font-size:9.0pt;
line-height:107%'> <span style='background:#FAFAFA'>=</span> <span
style='background:#FAFAFA'>[</span></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:17.75pt;margin-bottom:
13.85pt;margin-left:-.25pt;line-height:107%'><span style='font-size:9.0pt;
line-height:107%;background:#FAFAFA'>[</span><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=418 height=406
src="VBA%20Notes%20for%20Professionals_files/image185.gif"></span></p>

<h4 style='margin-left:.75pt'>Pre-defined Constants</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Some compilation constants are already pre-defined. Which
ones exist will depend on the bitness of the office version you're running VBA
in. Note that Vba7 was introduced alongside Office 2010 to support 64 bit
versions of Office.</p>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:0in;margin-left:.75pt'>Constant
16 bit 32 bit 64 bit</h4>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=188
 style='width:140.65pt;margin-left:1.0pt;border-collapse:collapse'>
 <tr style='height:13.65pt'>
  <td width=63 valign=top style='width:47.4pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Vba6</p>
  </td>
  <td width=124 valign=top style='width:93.25pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'>False If Vba6 False</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=63 valign=top style='width:47.4pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Vba7</p>
  </td>
  <td width=124 valign=top style='width:93.25pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>False
  If Vba7 True</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=63 valign=top style='width:47.4pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Win16</p>
  </td>
  <td width=124 valign=top style='width:93.25pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>True False False</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=63 valign=top style='width:47.4pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Win32</p>
  </td>
  <td width=124 valign=top style='width:93.25pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>False
  True True</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=63 valign=top style='width:47.4pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Win64</p>
  </td>
  <td width=124 valign=top style='width:93.25pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>False
  False True</p>
  </td>
 </tr>
 <tr style='height:13.65pt'>
  <td width=63 valign=top style='width:47.4pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Mac</p>
  </td>
  <td width=124 valign=top style='width:93.25pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'>False If Mac If Mac</p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:18.2pt;
margin-left:.75pt'>Note that Win64/Win32 refer to the Office version, not the
Windows version. For example Win32 = TRUE in 32-bit Office, even if the OS is a
64-bit version of Windows.</p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:0in;margin-left:-.25pt'><a
name="_Toc308702">Section 12.2: Using Declare Imports that work on all versions
of O&#57380;ce</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=322
src="VBA%20Notes%20for%20Professionals_files/image186.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>This can be simplified a bit depending on what versions of
office you need to support. For example, not many people are still supporting
16 bit versions of Office. <a
href="https://en.wikipedia.org/wiki/History_of_Microsoft_Office"><span
style='color:#193C96'>The last version of 16 bit office was version 4.3,
released in </span></a><a
href="https://en.wikipedia.org/wiki/History_of_Microsoft_Office"><span
style='color:#193C96'>1994</span></a>, so the following declaration is
sufficient for nearly all modern cases (including Office 2007).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=240
src="VBA%20Notes%20for%20Professionals_files/image187.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>If you don't have to support anything older than Office
2010, this declaration works just fine.</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=40
src="VBA%20Notes%20for%20Professionals_files/image188.gif"></span></p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=87
src="VBA%20Notes%20for%20Professionals_files/image189.gif"></span><br
clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc308703">Chapter 13: Data Types and
Limits</a></h1>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:0in;margin-left:-.25pt'><a
name="_Toc308704">Section 13.1: Variant</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src="VBA%20Notes%20for%20Professionals_files/image190.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=58 style='width:.6in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=22 valign=top style='width:16.2pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;background:#FAFAFA'>[</span></p>
  </td>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Type</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.45pt;
margin-left:.75pt'>A Variant is a COM data type that is used for storing and
exchanging values of arbitrary types, and any other type in VBA can be assigned
to a Variant. Variables declared without an explicit type specified by <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>]</span> default to
Variant.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Variants are stored in memory as a <a
href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms221627(v=vs.85).aspx"><span
style='color:#193C96'>VARIANT structure</span></a> that consists of a byte type
descriptor (<a
href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms221170(v=vs.85).aspx"><span
style='color:#193C96'>VARTYPE</span></a>) followed by 6 reserved bytes then an
8 byte data area. For numeric types (including Date and Boolean), the
underlying value is stored in the Variant itself. For all other types, the data
area contains a pointer to the underlying value.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><img border=0 width=718
height=42 id="Picture 12934"
src="VBA%20Notes%20for%20Professionals_files/image191.jpg"></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=50 style='width:37.8pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=50 valign=top style='width:37.8pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>VarType</span></p>
  </td>
 </tr>
</table>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=58 style='width:.6in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#000066'>TypeName</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>The underlying type of a Variant can be determined with
either the <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>()</span>
function which returns the numeric value stored in the type descriptor, or the <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>()</span> function
which returns the string representation:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=125
src="VBA%20Notes%20for%20Professionals_files/image192.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Because Variants can store values of any type, assignments
from literals without type hints will be implicitly cast to a Variant of the
appropriate type according to the table below. Literals with type hints will be
cast to a Variant of the hinted type.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=412
 style='width:309.0pt;margin-left:1.0pt;border-collapse:collapse'>
 <tr style='height:12.3pt'>
  <td width=317 valign=top style='width:237.45pt;padding:0in 0in 0in 0in;
  height:12.3pt'>
  <p class=MsoNormal align=center style='margin-top:0in;margin-right:2.0pt;
  margin-bottom:0in;margin-left:0in;text-align:center;text-indent:0in;
  line-height:107%'><b>Value</b></p>
  </td>
  <td width=95 valign=top style='width:71.6pt;padding:0in 0in 0in 0in;
  height:12.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><b>Resulting type</b></p>
  </td>
 </tr>
 <tr style='height:15.4pt'>
  <td width=317 valign=top style='width:237.45pt;padding:0in 0in 0in 0in;
  height:15.4pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>String
  values</p>
  </td>
  <td width=95 valign=top style='width:71.6pt;padding:0in 0in 0in 0in;
  height:15.4pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>String</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=317 valign=top style='width:237.45pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Non-floating
  point numbers in Integer range</p>
  </td>
  <td width=95 valign=top style='width:71.6pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Integer</p>
  </td>
 </tr>
 <tr style='height:13.65pt'>
  <td width=317 valign=top style='width:237.45pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Non-floating
  point numbers in Long range</p>
  </td>
  <td width=95 valign=top style='width:71.6pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Long</p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:3.85pt;
margin-left:.75pt'>Non-floating point numbers outside of Long range Double</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.3pt;
margin-left:0in;text-indent:0in'>All floating point numbers Double</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.4pt;
margin-left:.75pt'><b>Note:</b> Unless there is a specific reason to use a
Variant (i.e. an iterator in a For Each loop or an API requirement), the type
should generally be avoided for routine tasks for the following reasons:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:21.4pt'><img width=5 height=1
src="VBA%20Notes%20for%20Professionals_files/image193.gif" align=left
hspace=12>They are not type safe, increasing the possibility of runtime errors.
For example, a Variant holding an Integer value will silently change itself
into a Long instead of overflowing.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:21.4pt'>They introduce processing overhead by requiring at least
one additional pointer dereference.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.45pt;
margin-left:21.4pt'>The memory requirement for a Variant is always <b><i>at
least</i></b> 8 bytes higher than needed to store the underlying type.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=29 style='width:.3in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>CVar</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>The casting function to convert to a Variant is <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>()</span>.</p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:0in;margin-left:-.25pt'><a
name="_Toc308705">Section 13.2: Boolean</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="VBA%20Notes%20for%20Professionals_files/image194.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.45pt;
margin-left:.75pt'>A Boolean is used to store values that can be represented as
either True or False. Internally, the data type is stored as a 16 bit value
with 0 representing False and any other value representing True.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>It should be noted that when a Boolean is cast to a numeric
type, all of the bits are set to 1. This results in an internal representation
of -1 for signed types and the maximum value for an unsigned type (Byte).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=92
src="VBA%20Notes%20for%20Professionals_files/image195.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=36 style='width:27.0pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=36 valign=top style='width:27.0pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#CD6A5A'>CBool</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>The casting function to convert to a Boolean is <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>()</span>. Even
though it is represented internally as a 16 bit number, casting to a Boolean
from values outside of that range is safe from overflow, although it sets all
16 bits to 1:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=76
src="VBA%20Notes%20for%20Professionals_files/image196.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc308706">Section 13.3: String</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>A String represents a sequence of characters, and comes in
two flavors:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=42
src="VBA%20Notes%20for%20Professionals_files/image197.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.5pt;
margin-left:.75pt'>A variable length String allows appending and truncation and
is stored in memory as a COM <a
href="https://msdn.microsoft.com/en-us/library/windows/desktop/ms221069(v=vs.85).aspx"><span
style='color:#193C96'>BSTR</span></a>. This consists of a 4 byte unsigned
integer that stores the length of the String in bytes followed by the string
data itself as wide characters (2 bytes per character) and terminated with 2
null bytes. Thus, the maximum string length that can be handled by VBA is
2,147,483,647 characters.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=43 style='width:.45in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=43 valign=top style='width:.45in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>StrPtr</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.45pt;
margin-left:.75pt'>The internal pointer to the structure (retrievable by the <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>()</span> function)
points to the memory location of the <i>data</i>, not the length prefix. This
means that a VBA String can be passed directly API functions that require a
pointer to a character array.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.7pt;
margin-left:.75pt'>Because the length can change, VBA reallocates memory for a
String <i>every time the variable is assigned to</i>, which can impose
performance penalties for procedures that alter them repeatedly.</p>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:3.5pt;margin-left:
.75pt'>Fixed length</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:.05pt;margin-bottom:17.25pt;
margin-left:3.5pt'><span style='position:relative;z-index:-1895787520'><span
style='left:0px;position:absolute;left:0px;top:-25942px;width:718px;height:
1px'><img width=718 height=1
src="VBA%20Notes%20for%20Professionals_files/image144.gif"></span></span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Dim</span></b><span
style='font-size:9.0pt;line-height:110%'> Value </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>String</span><span style='font-size:9.0pt;
line-height:110%'> * </span><span style='font-size:9.0pt;line-height:110%;
color:brown'>1024</span><span style='font-size:9.0pt;line-height:110%'> </span><i><span
style='font-size:9.0pt;line-height:110%;color:green'>'Declares a fixed length
string of 1024 characters.</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.45pt;
margin-left:.75pt'>Fixed length strings are allocated 2 bytes for each
character and are stored in memory as a simple byte array. Once allocated, the
length of the String is immutable. They are <b><i>not</i></b> null terminated
in memory, so a string that fills the memory allocated with non-null characters
is unsuitable for passing to API functions expecting a null terminated string.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Fixed length strings carry over a legacy 16 bit index
limitation, so can only be up to 65,535 characters in length. Attempting to
assign a value longer than the available memory space will not result in a
runtime error - instead the resulting value will simply be truncated:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="VBA%20Notes%20for%20Professionals_files/image198.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=29 style='width:.3in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#CD6A5A'>CStr</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:168.1pt;margin-bottom:
0in;margin-left:.75pt;line-height:145%'>The casting function to convert to a
String of either type is <span style='font-size:9.0pt;line-height:145%;
background:#FAFAFA'>()</span>.</p>

<h2 style='margin-top:0in;margin-right:168.1pt;margin-bottom:0in;margin-left:
.75pt;line-height:145%'><a name="_Toc308707">Section 13.4: Byte</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="VBA%20Notes%20for%20Professionals_files/image199.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.45pt;
margin-left:.75pt'>A Byte is an unsigned 8 bit data type. It can represent
integer numbers between 0 and 255 and attempting to store a value outside of
that range will result in <a
href="https://msdn.microsoft.com/en-us/library/aa264525"><span
style='color:#193C96'>runtime error 6: </span></a><a
href="https://msdn.microsoft.com/en-us/library/aa264525"><span
style='font-size:9.0pt;line-height:110%;color:#193C96;background:#FAFAFA'>Overflow</span></a>.
Byte is the only intrinsic unsigned type available in VBA.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=36 style='width:27.0pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=36 valign=top style='width:27.0pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><a
  href="https://msdn.microsoft.com/en-us/library/office/gg278896.aspx"><span
  style='font-size:9.0pt;line-height:107%;color:#CD6A5A'>CByte</span></a></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.7pt;
margin-left:.75pt'>The casting function to convert to a Byte is <a
href="https://msdn.microsoft.com/en-us/library/office/gg278896.aspx"><span
style='font-size:9.0pt;line-height:110%;color:black;background:#FAFAFA'>(</span></a><a
href="https://msdn.microsoft.com/en-us/library/office/gg278896.aspx"><span
style='font-size:9.0pt;line-height:110%;color:black;background:#FAFAFA'>)</span></a>.
For casts from floating point types, the result is rounded to the nearest
integer value with .5 rounding up.</p>

<h4 style='margin-left:.75pt'>Byte Arrays and Strings</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.45pt;
margin-left:.75pt'>Strings and byte arrays can be substituted for one another
through simple assignment (no conversion functions necessary).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>For example:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=273
src="VBA%20Notes%20for%20Professionals_files/image200.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>In order to be able to encode <a href="http://unicode.org/"><span
style='color:#193C96'>Unicode</span></a> characters, each character in the
string takes up two bytes in the array, with the least significant byte first.
For example:</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=191
src="VBA%20Notes%20for%20Professionals_files/image201.gif"></span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:0in;margin-left:-.25pt'><a
name="_Toc308708">Section 13.5: Currency</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="VBA%20Notes%20for%20Professionals_files/image202.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>A Currency is a signed 64 bit floating point data type
similar to a Double, but scaled by 10,000 to give greater precision to the 4
digits to the right of the decimal point. A Currency variable can store values
from</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.5pt;
margin-left:.75pt'>-922,337,203,685,477.5808 to 922,337,203,685,477.5807,
giving it the largest capacity of any intrinsic type in a 32 bit application.
As the name of the data type implies, it is considered best practice to use
this data type when representing monetary calculations as the scaling helps to
avoid rounding errors.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=29 style='width:.3in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>CCur</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:218.2pt;margin-bottom:
0in;margin-left:.75pt;line-height:145%'>The casting function to convert to a
Currency is <span style='font-size:9.0pt;line-height:145%;background:#FAFAFA'>()</span>.</p>

<h2 style='margin-top:0in;margin-right:218.2pt;margin-bottom:0in;margin-left:
.75pt;line-height:145%'><a name="_Toc308709">Section 13.6: Decimal</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.1pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=92
src="VBA%20Notes%20for%20Professionals_files/image203.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.5pt;
margin-left:.75pt'>The <span style='font-size:9.0pt;line-height:110%;
color:slateblue;background:#FAFAFA'>Decimal</span> data-type is <i>only</i>
available as a sub-type of <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>Variant</span>, so you must declare any variable that needs
to contain a <span style='font-size:9.0pt;line-height:110%;color:slateblue;
background:#FAFAFA'>Decimal</span> as a <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>Variant</span> and <i>then</i> assign a <span
style='font-size:9.0pt;line-height:110%;color:slateblue;background:#FAFAFA'>Decimal</span>
value using the <span style='font-size:9.0pt;line-height:110%;color:#CD6A5A;
background:#FAFAFA'>CDec</span> function. The keyword <span style='font-size:
9.0pt;line-height:110%;color:slateblue;background:#FAFAFA'>Decimal</span> is a
reserved word (which suggests that VBA was eventually going to add first-class
support for the type), so <span style='font-size:9.0pt;line-height:110%;
color:slateblue;background:#FAFAFA'>Decimal </span>cannot be used as a variable
or procedure name.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:8.4pt;margin-bottom:.25pt;
margin-left:.75pt;text-align:justify;text-justify:inter-ideograph;line-height:
135%'>The <span style='font-size:9.0pt;line-height:135%;color:slateblue;
background:#FAFAFA'>Decimal</span> type requires 14 bytes of memory (in
addition to the bytes required by the parent Variant) and can store numbers
with up to 28 decimal places. For numbers without any decimal places, the range
of allowed values is -79,228,162,514,264,337,593,543,950,335 to
+79,228,162,514,264,337,593,543,950,335 inclusive. For numbers with the maximum
28 decimal places, the range of allowed values is
-7.9228162514264337593543950335 to +7.9228162514264337593543950335 inclusive.</p>

<h2 style='margin-top:0in;margin-right:8.4pt;margin-bottom:.25pt;margin-left:
.75pt;text-align:justify;text-justify:inter-ideograph;line-height:135%'><a
name="_Toc308710">Section 13.7: Integer</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="VBA%20Notes%20for%20Professionals_files/image204.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.45pt;
margin-left:.75pt'>An Integer is a signed 16 bit data type. It can store
integer numbers in the range of -32,768 to 32,767 and attempting to store a
value outside of that range will result in runtime error 6: Overflow.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.8pt;
margin-left:.75pt'>Integers are stored in memory as <a
href="https://en.wikipedia.org/wiki/Endianness"><span style='color:#193C96'>little-endian</span></a>
values with negatives represented as a <a
href="https://en.wikipedia.org/wiki/Two%27s_complement"><span style='color:
#193C96'>two's complement</span></a>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.5pt;
margin-left:.75pt'>Note that in general, it is better practice to use a Long
rather than an Integer unless the smaller type is a member of a Type or is
required (either by an API calling convention or some other reason) to be 2
bytes. In most cases VBA treats Integers as 32 bit internally, so there is
usually no advantage to using the smaller type. Additionally, there is a
performance penalty incurred every time an Integer type is used as it is
silently cast as a Long.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=29 style='width:.3in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#CD6A5A'>CInt</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:8.6pt;margin-bottom:.25pt;
margin-left:.75pt;text-align:justify;text-justify:inter-ideograph;line-height:
135%'>The casting function to convert to an Integer is <span style='font-size:
9.0pt;line-height:135%;background:#FAFAFA'>()</span>. For casts from floating
point types, the result is rounded to the nearest integer value with .5
rounding up.</p>

<h2 style='margin-top:0in;margin-right:8.6pt;margin-bottom:.25pt;margin-left:
.75pt;text-align:justify;text-justify:inter-ideograph;line-height:135%'><a
name="_Toc308711">Section 13.8: Long</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="VBA%20Notes%20for%20Professionals_files/image205.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.8pt;
margin-left:.75pt'>A Long is a signed 32 bit data type. It can store integer
numbers in the range of -2,147,483,648 to 2,147,483,647 and attempting to store
a value outside of that range will result in runtime error 6: Overflow.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.8pt;
margin-left:.75pt'>Longs are stored in memory as <a
href="https://en.wikipedia.org/wiki/Endianness"><span style='color:#193C96'>little-endian</span></a>
values with negatives represented as a <a
href="https://en.wikipedia.org/wiki/Two%27s_complement"><span style='color:
#193C96'>two's complement</span></a>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.5pt;
margin-left:.75pt'>Note that since a Long matches the width of a pointer in a
32 bit operating system, Longs are commonly used for storing and passing
pointers to and from API functions.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=29 style='width:.3in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#CD6A5A'>CLng</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:7.25pt;margin-bottom:
.25pt;margin-left:.75pt;text-align:justify;text-justify:inter-ideograph;
line-height:135%'>The casting function to convert to a Long is <span
style='font-size:9.0pt;line-height:135%;background:#FAFAFA'>()</span>. For
casts from floating point types, the result is rounded to the nearest integer
value with .5 rounding up.</p>

<h2 style='margin-top:0in;margin-right:7.25pt;margin-bottom:.25pt;margin-left:
.75pt;text-align:justify;text-justify:inter-ideograph;line-height:135%'><a
name="_Toc308712">Section 13.9: Single</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="VBA%20Notes%20for%20Professionals_files/image206.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.45pt;
margin-left:.75pt'>A Single is a signed 32 bit floating point data type. It is
stored internally using a <a href="https://en.wikipedia.org/wiki/Endianness"><span
style='color:#193C96'>little-endian</span></a> <a
href="https://en.wikipedia.org/wiki/Single-precision_floating-point_format"><span
style='color:#193C96'>IEEE 754</span></a> memory layout. As such, there is not
a fixed range of values that can be represented by the data type - what is
limited is the precision of value stored. A Single can store a value <b><i>integer</i></b>
values in the range of -16,777,216 to 16,777,216 without a loss of precision.
The precision of floating point numbers depends on the exponent.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.45pt;
margin-left:.75pt'>A Single will overflow if assigned a value greater than
roughly 2128. It will not overflow with negative exponents, although the usable
precision will be questionable before the upper limit is reached.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.5pt;
margin-left:.75pt'>As with all floating point numbers, care should be taken
when making equality comparisons. Best practice is to include a delta value
appropriate to the required precision.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=29 style='width:.3in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#CD6A5A'>CSng</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:232.6pt;margin-bottom:
0in;margin-left:.75pt;line-height:145%'>The casting function to convert to a
Single is <span style='font-size:9.0pt;line-height:145%;background:#FAFAFA'>()</span>.</p>

<h2 style='margin-top:0in;margin-right:232.6pt;margin-bottom:0in;margin-left:
.75pt;line-height:145%'><a name="_Toc308713">Section 13.10: Double</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="VBA%20Notes%20for%20Professionals_files/image207.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.45pt;
margin-left:.75pt'>A Double is a signed 64 bit floating point data type. Like
the Single, it is stored internally using a <a
href="https://en.wikipedia.org/wiki/Endianness"><span style='color:#193C96'>little-endian</span></a>
<a href="https://en.wikipedia.org/wiki/Double-precision_floating-point_format"><span
style='color:#193C96'>IEEE </span></a><a
href="https://en.wikipedia.org/wiki/Double-precision_floating-point_format"><span
style='color:#193C96'>754</span></a> memory layout and the same precautions
regarding precision should be taken. A Double can store <b><i>integer </i></b>values
in the range of -9,007,199,254,740,992 to 9,007,199,254,740,992 without a loss
of precision. The precision of floating point numbers depends on the exponent.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.5pt;
margin-left:.75pt'>A Double will overflow if assigned a value greater than
roughly 21024. It will not overflow with negative exponents, although the
usable precision will be questionable before the upper limit is reached.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=29 style='width:.3in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#CD6A5A'>CDbl</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:226.65pt;margin-bottom:
0in;margin-left:.75pt;line-height:145%'>The casting function to convert to a
Double is <span style='font-size:9.0pt;line-height:145%;background:#FAFAFA'>()</span>.</p>

<h2 style='margin-top:0in;margin-right:226.65pt;margin-bottom:0in;margin-left:
.75pt;line-height:145%'><a name="_Toc308714">Section 13.11: Date</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="VBA%20Notes%20for%20Professionals_files/image208.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.45pt;
margin-left:.75pt'>A Date type is represented internally as a signed 64 bit
floating point data type with the value to the left of the decimal representing
the number of days from the epoch date of December 30th, 1899 (although see the
note below). The value to the right of the decimal represents the time as a
fractional day. Thus, an integer Date would have a time component of 12:00:00AM
and x.5 would have a time component of 12:00:00PM.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Valid values for Dates are between January 1st 100 and
December 31st 9999. Since a Double has a larger range, it is possible to
overflow a Date by assigning values outside of that range.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>As such, it can be used interchangeably with a Double for
Date calculations:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=92
src="VBA%20Notes%20for%20Professionals_files/image209.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=36 style='width:27.0pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=36 valign=top style='width:27.0pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#CD6A5A'>CDate</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:12.55pt;margin-bottom:
.25pt;margin-left:.75pt;text-align:justify;text-justify:inter-ideograph;
line-height:135%'>The casting function to convert to a Date is <span
style='font-size:9.0pt;line-height:135%;background:#FAFAFA'>()</span>, which
accepts any numeric type string date/time representation. It is important to
note that string representations of dates will be converted based on the
current locale setting in use, so direct casts should be avoided if the code is
meant to be portable.</p>

<h2 style='margin-top:0in;margin-right:12.55pt;margin-bottom:.25pt;margin-left:
.75pt;text-align:justify;text-justify:inter-ideograph;line-height:135%'><a
name="_Toc308715">Section 13.12: LongLong</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="VBA%20Notes%20for%20Professionals_files/image210.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>A LongLong is a signed 64 bit data type and is only
available in 64 bit applications. It is <b>not</b> available in 32 bit
applications running on 64 bit operating systems. It can store integer values
in the range of</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.45pt;
margin-left:.75pt'>-9,223,372,036,854,775,808 to 9,223,372,036,854,775,807 and
attempting to store a value outside of that range will result in runtime error
6: Overflow.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.8pt;
margin-left:.75pt'>LongLongs are stored in memory as <a
href="https://en.wikipedia.org/wiki/Endianness"><span style='color:#193C96'>little-endian</span></a>
values with negatives represented as a <a
href="https://en.wikipedia.org/wiki/Two%27s_complement"><span style='color:
#193C96'>two's complement</span></a>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.5pt;
margin-left:.75pt'>The LongLong data type was introduced as part of VBA's 64
bit operating system support. In 64 bit applications, this value can be used to
store and pass pointers to 64 bit APIs.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=50 style='width:37.8pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=50 valign=top style='width:37.8pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>CLngLng</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:41.1pt;margin-bottom:
.25pt;margin-left:.75pt;text-align:justify;text-justify:inter-ideograph;
line-height:135%'>The casting function to convert to a LongLong is <span
style='font-size:9.0pt;line-height:135%;background:#FAFAFA'>()</span>. For
casts from floating point types, the result is rounded to the nearest integer
value with .5 rounding up.</p>

<h2 style='margin-top:0in;margin-right:41.1pt;margin-bottom:.25pt;margin-left:
.75pt;text-align:justify;text-justify:inter-ideograph;line-height:135%'><a
name="_Toc308716">Section 13.13: LongPtr</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="VBA%20Notes%20for%20Professionals_files/image211.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.45pt;
margin-left:.75pt'>The LongPtr was introduced into VBA in order to support 64
bit platforms. On a 32 bit system, it is treated as a Long and on 64 bit
systems it is treated as a LongLong.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.45pt;
margin-left:.75pt'>It's primary use is in providing a portable way to store and
pass pointers on both architectures (See Changing code behavior at compile
time.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.5pt;
margin-left:.75pt'>Although it is treated by the operating system as a memory
address when used in API calls, it should be noted that VBA treats it like
signed type (and therefore subject to unsigned to signed overflow). For this
reason, any pointer arithmetic performed using LongPtrs should not use <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>&gt;</span> or <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>&lt;</span>
comparisons. This &quot;quirk&quot; also makes it possible that adding simple
offsets pointing to valid addresses in memory can cause overflow errors, so
caution should be taken when working with pointers in VBA.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=50 style='width:37.8pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=50 valign=top style='width:37.8pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>CLngPtr</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>The casting function to convert to a LongPtr is <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>()</span>. For
casts from floating point types, the result is rounded to the nearest integer
value with .5 rounding up (although since it is usually a memory address, using
it as an assignment target for a floating point calculation is dangerous at
best).</p>

<h1 style='margin-left:-.25pt'><a name="_Toc308717">Chapter 14: String Literals
- Escaping, nonprintable characters and linecontinuations</a></h1>

<h2 style='margin-left:-.25pt'><a name="_Toc308718">Section 14.1: Escaping the
&quot; character</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>VBA syntax requires that a string-literal appear within <span
style='font-size:9.0pt;line-height:110%;color:brown;background:#FAFAFA'>&quot;</span>
marks, so when your string needs to <i>contain</i> quotation marks, you'll need
to escape/prepend the <span style='font-size:9.0pt;line-height:110%;color:brown;
background:#FAFAFA'>&quot;</span> character with an extra <span
style='font-size:9.0pt;line-height:110%;color:brown;background:#FAFAFA'>&quot;</span>
so that VBA understands that you intend the <span style='font-size:9.0pt;
line-height:110%;color:brown;background:#FAFAFA'>&quot;&quot;</span> to be
interpreted as a <span style='font-size:9.0pt;line-height:110%;color:brown;
background:#FAFAFA'>&quot;</span> string.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=125
src="VBA%20Notes%20for%20Professionals_files/image212.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc308719">Section 14.2: Assigning
long string literals</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:14.1pt;
margin-left:.75pt'>The VBA editor only allows 1023 characters per line, but
typically only the first 100-150 characters are visible without scrolling. If
you need to assign long string literals, but you want to keep your code
readable, you'll need to use line-continuations and concatenation to assign
your string.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'>Debug.Print </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>&quot;Lorem ipsum dolor
sit amet, consectetur adipiscing elit. &quot;</span><span style='font-size:
9.0pt;line-height:110%'> &amp; _</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>&quot;Integer hendrerit
maximus arcu, ut elementum odio varius &quot;</span><span style='font-size:
9.0pt;line-height:110%'> &amp; _</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>&quot;nec. Integer ipsum
enim, iaculis et egestas ac, condiment&quot;</span><span style='font-size:9.0pt;
line-height:110%'> &amp; _</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:48.8pt;margin-bottom:
17.2pt;margin-left:3.5pt'><span style='position:relative;z-index:-1895786496'><span
style='left:0px;position:absolute;left:0px;top:-30381px;width:718px;height:
1px'><img width=718 height=1
src="VBA%20Notes%20for%20Professionals_files/image213.gif"></span></span><span
style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>&quot;um ut tellus.&quot; </span><i><span
style='font-size:9.0pt;line-height:110%;color:green'>'Output: 'Lorem ipsum
dolor sit amet, consectetur adipiscing elit. Integer hendrerit maximus arcu, ut
elementum odio varius nec. Integer ipsum enim, iaculis et egestas ac,
condimentum ut tellus.</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>VBA will let you use a limited number of line-continuations
(the actual number varies by the length of each line within the
continued-block), so if you have very long strings, you'll need to assign and
re-assign with concatenation.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=720 height=256
src="VBA%20Notes%20for%20Professionals_files/image214.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc308720">Section 14.3: Using VBA
string constants</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>VBA defines a number of string constants for special
characters like:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:226.5pt;margin-bottom:
1.5pt;margin-left:21.4pt'><img width=5 height=1
src="VBA%20Notes%20for%20Professionals_files/image166.gif" align=left
hspace=12>vbCr : Carriage-Return 'Same as &quot;\r&quot; in C style languages.
vbLf : Line-Feed 'Same as &quot;\n&quot; in C style languages.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:195.0pt;margin-bottom:
1.5pt;margin-left:21.4pt'>vbCrLf : Carriage-Return &amp; Line-Feed (a new-line
in Windows) vbTab: Tab Character</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.8pt;
margin-left:21.4pt'>vbNullString: an empty string, like &quot;&quot;</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>You can use these constants with concatenation and other
string functions to build string-literals with specialcharacters.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.1pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=240
src="VBA%20Notes%20for%20Professionals_files/image215.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Using <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>vbNullString</span> is considered better practice than the
equivalent value of <span style='font-size:9.0pt;line-height:110%;color:brown;
background:#FAFAFA'>&quot;&quot;</span> due to differences in how the code is
compiled. Strings are accessed via a pointer to an allocated area of memory,
and the VBA compiler is smart enough to use a null pointer to represent <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>vbNullString</span>.
The literal <span style='font-size:9.0pt;line-height:110%;color:brown;
background:#FAFAFA'>&quot;&quot;</span> is allocated memory as if it were a
String typed Variant, making the use of the constant much more efficient:</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=43
src="VBA%20Notes%20for%20Professionals_files/image216.gif"></span></p>

<h1 style='margin-top:0in;margin-right:6.85pt;margin-bottom:.15pt;margin-left:
-.25pt'><a name="_Toc308721">Chapter 15: Declaring and assigning strings</a></h1>

<h2 style='margin-left:-.25pt'><a name="_Toc308722">Section 15.1: Assignment to
and from a byte array</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Strings can be assigned directly to byte arrays and
visa-versa. Remember that Strings are stored in a Multi-Byte Character Set (see
Remarks below) so only every other index of the resulting array will be the
portion of the character that falls within the ASCII range.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=256
src="VBA%20Notes%20for%20Professionals_files/image217.gif"></span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:0in;margin-left:-.25pt'><a
name="_Toc308723">Section 15.2: Declare a string constant</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="VBA%20Notes%20for%20Professionals_files/image218.gif"></span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:0in;margin-left:-.25pt'><a
name="_Toc308724">Section 15.3: Declare a variable-width string variable</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="VBA%20Notes%20for%20Professionals_files/image219.gif"></span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:0in;margin-left:-.25pt'><a
name="_Toc308725">Section 15.4: Declare and assign a fixed-width string</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=142
src="VBA%20Notes%20for%20Professionals_files/image220.gif"></span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:0in;margin-left:-.25pt'><a
name="_Toc308726">Section 15.5: Declare and assign a string array</a></h2>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=114
src="VBA%20Notes%20for%20Professionals_files/image221.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=169
src="VBA%20Notes%20for%20Professionals_files/image222.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc308727">Section 15.6: Assign
specific characters within a string using Mid statement</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.5pt;
margin-left:.75pt'>VBA offers a Mid function for <i>returning</i> substrings
within a string, but it also offers the Mid <i>Statement</i> which can be used
to assign substrings or individual characters withing a string.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>The <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>Mid</span> function will typically appear on the
right-hand-side of an assignment statement or in a condition, but the <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Mid</span>
Statement typically appears on the left hand side of an assignment statement.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=158
src="VBA%20Notes%20for%20Professionals_files/image223.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=29 style='width:.3in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'></span><span style='font-size:9.0pt;line-height:107%;color:brown'>&quot;y&quot;</span></p>
  </td>
 </tr>
</table>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=122 style='width:91.8pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#000066'>MidB</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;background:#FAFAFA'>(</span></p>
  </td>
  <td width=65 valign=top style='width:48.6pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>surname, </span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:brown;background:#FAFAFA'>5</span></p>
  </td>
  <td width=14 valign=top style='width:.15in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>, </span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'><span style='position:relative;z-index:251699200'><span
style='left:0px;position:absolute;left:430px;top:-32794px;width:7px;height:
1px'><img width=7 height=1
src="VBA%20Notes%20for%20Professionals_files/image126.gif"></span></span>Note:
If you need to assign to individual <i>bytes</i> in a string instead of
individual <i>characters</i> within a string (see the Remarks below regarding
the Multi-Byte Character Set), the <span style='font-size:9.0pt;line-height:
110%;background:#FAFAFA'>MidB</span> statement can be used. In this instance,
the second argument for the <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>MidB</span> statement is the 1-based position of the byte
where the replacement will start so the equivalent line to the example above
would be <span style='font-size:9.0pt;line-height:110%;color:brown;background:
#FAFAFA'>2</span><span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>)</span><span
style='font-size:9.0pt;line-height:110%'> <span style='background:#FAFAFA'>=</span></span>.</p>

<h1 style='margin-left:-.25pt'><a name="_Toc308728">Chapter 16: Converting
other types to strings</a></h1>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:0in;margin-left:-.25pt'><a
name="_Toc308729">Section 16.1: Use CStr to convert a numeric type to a string</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=92
src="VBA%20Notes%20for%20Professionals_files/image224.gif"></span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:0in;margin-left:-.25pt'><a
name="_Toc308730">Section 16.2: Use Format to convert and format a numeric type
as a string</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=76
src="VBA%20Notes%20for%20Professionals_files/image225.gif"></span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:0in;margin-left:-.25pt'><a
name="_Toc308731">Section 16.3: Use StrConv to convert a byte-array of
singlebyte characters to a string</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=720 height=174
src="VBA%20Notes%20for%20Professionals_files/image226.gif"></span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:0in;margin-left:-.25pt'><a
name="_Toc308732">Section 16.4: Implicitly convert a byte array of
multi-bytecharacters to a string</a></h2>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=720 height=273
src="VBA%20Notes%20for%20Professionals_files/image227.gif"></span></p>

<h1 style='margin-left:-.25pt'><a name="_Toc308733">Chapter 17: Searching
within strings for the presence of substrings</a></h1>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:0in;margin-left:-.25pt'><a
name="_Toc308734">Section 17.1: Use InStr to determine if a string contains a
substring</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=174
src="VBA%20Notes%20for%20Professionals_files/image228.gif"></span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:0in;margin-left:-.25pt'><a
name="_Toc308735">Section 17.2: Use InStrRev to find the position of the last
instance of a substring</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=142
src="VBA%20Notes%20for%20Professionals_files/image229.gif"></span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:0in;margin-left:-.25pt'><a
name="_Toc308736">Section 17.3: Use InStr to find the position of the first
instance of a substring</a></h2>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=109
src="VBA%20Notes%20for%20Professionals_files/image230.gif"></span></p>

<h1 style='margin-left:-.25pt'><a name="_Toc308737">Chapter 18: Substrings</a></h1>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:0in;margin-left:-.25pt'><a
name="_Toc308738">Section 18.1: Use Left or Left$ to get the 3 left-most
characters in a string</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=92
src="VBA%20Notes%20for%20Professionals_files/image231.gif"></span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:0in;margin-left:-.25pt'><a
name="_Toc308739">Section 18.2: Use Right or Right$ to get the 3 right-most
characters in a string</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=76
src="VBA%20Notes%20for%20Professionals_files/image232.gif"></span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:0in;margin-left:-.25pt'><a
name="_Toc308740">Section 18.3: Use Mid or Mid$ to get specific characters from
within a string</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=109
src="VBA%20Notes%20for%20Professionals_files/image233.gif"></span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:0in;margin-left:-.25pt'><a
name="_Toc308741">Section 18.4: Use Trim to get a copy of the string without
any leading or trailing spaces</a></h2>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=92
src="VBA%20Notes%20for%20Professionals_files/image234.gif"></span></p>

<h1 style='margin-left:-.25pt'><a name="_Toc308742">Chapter 19: Measuring the
length of strings</a></h1>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:0in;margin-left:-.25pt'><a
name="_Toc308743">Section 19.1: Use the Len function to determine the number of
characters in a string</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=109
src="VBA%20Notes%20for%20Professionals_files/image235.gif"></span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:0in;margin-left:-.25pt'><a
name="_Toc308744">Section 19.2: Use the LenB function to determine the number
of bytes in a string</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=109
src="VBA%20Notes%20for%20Professionals_files/image236.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc308745">Section 19.3: Prefer `If
Len(myString) = 0 Then` over `If myString = &quot;&quot; Then`</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>When checking if a string is zero-length, it is better
practice, and more efficient, to inspect the length of the string rather than
comparing the string to an empty string.</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=191
src="VBA%20Notes%20for%20Professionals_files/image237.gif"></span></p>

<h1 style='margin-left:-.25pt'><a name="_Toc308746">Chapter 20: Working with
ADO</a></h1>

<h2 style='margin-left:-.25pt'><a name="_Toc308747">Section 20.1: Making a
connection to a data source</a></h2>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=29 style='width:.3in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Open</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.45pt;
margin-left:.75pt'>The first step in accessing a data source via ADO is
creating an ADO <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Connection</span>
object. This is typically done using a connection string to specify the data
source parameters, although it is also possible to open a DSN connection by
passing the DSN, user ID, and password to the <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>.</span> method.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Note that a DSN is not required to connect to a data source
via ADO - any data source that has an ODBC provider can be connected to with
the appropriate connection string. While specific connection strings for
different providers are outside of the scope of this topic, <a
href="https://www.connectionstrings.com/"><span style='color:#193C96'>ConnectionStrings.com</span></a>
is an excellent reference for finding the appropriate string for your provider.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=470
src="VBA%20Notes%20for%20Professionals_files/image238.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:17.5pt;margin-bottom:
.25pt;margin-left:.75pt;text-align:justify;text-justify:inter-ideograph;
line-height:135%'>Note that the database password is included in the connection
string in the example above only for the sake of clarity. Best practices would
dictate <b><i>not</i></b> storing database passwords in code. This can be
accomplished by taking the password via user input or using Windows
authentication.</p>

<h2 style='margin-top:0in;margin-right:17.5pt;margin-bottom:.25pt;margin-left:
.75pt;text-align:justify;text-justify:inter-ideograph;line-height:135%'><a
name="_Toc308748">Section 20.2: Creating parameterized commands</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:13.05pt;
margin-left:.75pt'>Any time SQL executed through an ADO connection needs to
contain user input, it is considered best practice to parameterize it in order
to minimize the chance of SQL injection. This method is also more readable than
long concatenations and facilitates more robust and maintainable code (i.e. by
using a function that returns an array of <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>Parameter</span>).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>In standard ODBC syntax, parameters are given <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>?</span>
&quot;placeholders&quot; in the query text, and then parameters are appended to
the <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Command</span>
in the same order that they appear in the query.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Note that the example below uses the <span style='font-size:
9.0pt;line-height:110%;background:#FAFAFA'>OpenDatabaseConnection</span>
function from the Making a connection to a data source for brevity.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.9pt;margin-left:-.45pt;text-indent:0in;line-height:107%'><img border=0
width=719 height=634 id="Picture 302185"
src="VBA%20Notes%20for%20Professionals_files/image239.gif"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:9.95pt;margin-bottom:
.25pt;margin-left:.75pt;text-align:justify;text-justify:inter-ideograph;
line-height:135%'>Note: The example above demonstrates a parameterized UPDATE
statement, but any SQL statement can be given parameters.</p>

<h2 style='margin-top:0in;margin-right:9.95pt;margin-bottom:.25pt;margin-left:
.75pt;text-align:justify;text-justify:inter-ideograph;line-height:135%'><a
name="_Toc308749">Section 20.3: Retrieving records with a query</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.45pt;
margin-left:.75pt'>Queries can be performed in two ways, both of which return
an ADO <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Recordset</span>
object which is a collection of returned rows. Note that both of the examples
below use the <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>OpenDatabaseConnection</span>
function from the Making a connection to a data source example for the purpose
of brevity. Remember that the syntax of the SQL passed to the data source is
provider specific.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>The first method is to pass the SQL statement directly to
the Connection object, and is the easiest method for executing simple queries:</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=76
src="VBA%20Notes%20for%20Professionals_files/image240.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=719 height=383
src="VBA%20Notes%20for%20Professionals_files/image241.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>The second method is to create an ADO <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Command</span>
object for the query you want to execute. This requires a little more code, but
is necessary in order to use parametrized queries:</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=552
src="VBA%20Notes%20for%20Professionals_files/image242.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:8.4pt;margin-bottom:.25pt;
margin-left:.75pt;text-align:justify;text-justify:inter-ideograph;line-height:
135%'>Note that commands sent to the data source are <b>vulnerable to SQL
injection</b>, either intentional or unintentional. In general, queries should
not be created by concatenating user input of any kind. Instead, they should be
parameterized (see Creating parameterized commands).</p>

<h2 style='margin-top:0in;margin-right:8.4pt;margin-bottom:.25pt;margin-left:
.75pt;text-align:justify;text-justify:inter-ideograph;line-height:135%'><a
name="_Toc308750">Section 20.4: Executing non-scalar functions</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>ADO connections can be used to perform pretty much any
database function that the provider supports via SQL. In this case it isn't
always necessary to use the <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>Recordset</span> returned by the <span style='font-size:
9.0pt;line-height:110%;background:#FAFAFA'>Execute</span> function, although it
can be useful for obtaining key assignments after INSERT statements with
@@Identity or similar SQL commands. Note that the example below uses the <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>OpenDatabaseConnection</span>
function from the Making a connection to a data source example for the purpose
of brevity.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=421
src="VBA%20Notes%20for%20Professionals_files/image243.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Note that commands sent to the data source are <b>vulnerable
to SQL injection</b>, either intentional or unintentional. In general, SQL
statements should not be created by concatenating user input of any kind.
Instead, they should be parameterized (see Creating parameterized commands).</p>

<h1 style='margin-left:-.25pt'><a name="_Toc308751">Chapter 21: Concatenating
strings</a></h1>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:0in;margin-left:-.25pt'><a
name="_Toc308752">Section 21.1: Concatenate an array of strings using the Join
function</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=223
src="VBA%20Notes%20for%20Professionals_files/image244.gif"></span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:0in;margin-left:-.25pt'><a
name="_Toc308753">Section 21.2: Concatenate strings using the &amp; operator</a></h2>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=207
src="VBA%20Notes%20for%20Professionals_files/image245.gif"></span></p>

<h1 style='margin-left:-.25pt'><a name="_Toc308754">Chapter 22: Assigning
strings with repeated characters</a></h1>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:0in;margin-left:-.25pt'><a
name="_Toc308755">Section 22.1: Use the String function to assign a string with
n repeated characters</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="VBA%20Notes%20for%20Professionals_files/image246.gif"></span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:0in;margin-left:-.25pt'><a
name="_Toc308756">Section 22.2: Use the String and Space functions to assign an
n-character string</a></h2>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=125
src="VBA%20Notes%20for%20Professionals_files/image247.gif"></span><br
clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc308757">Chapter 23:
Scripting.Dictionary object</a></h1>

<p class=MsoNormal style='margin-top:0in;margin-right:.55pt;margin-bottom:.25pt;
margin-left:.75pt;text-align:justify;text-justify:inter-ideograph;line-height:
135%'>You must add Microsoft Scripting Runtime to the VBA project through the
VBE's Tools <span style='font-family:"Arial",sans-serif'>&#8594;</span>
References command in order to implement early binding of the Scripting
Dictionary object. This library reference is carried with the project; it does
not have to be re-referenced when the VBA project is distributed and run on
another computer.</p>

<h2 style='margin-top:0in;margin-right:.55pt;margin-bottom:.25pt;margin-left:
.75pt;text-align:justify;text-justify:inter-ideograph;line-height:135%'><a
name="_Toc308758">Section 23.1: Properties and Methods</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.45pt;
margin-left:.75pt'>A <a
href="https://msdn.microsoft.com/en-us/library/x4k5wbx4(v=vs.84).aspx"><span
style='color:#193C96'>Scripting Dictionary object</span></a> stores information
in Key/Item pairs. The Keys must be unique and not an array but the associated
Items can be repeated (their uniqueness is held by the companion Key) and can
be of any type of variant or object.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>A dictionary can be thought of as a two field in-memory
database with a primary unique index on the first 'field'</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:13.05pt;
margin-left:.75pt'>(the <i>Key</i>). This unique index on the Keys property
allows very fast 'lookups' to retrieve a Key's associated Item value.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.2pt;
margin-left:.75pt'><b>Properties</b></p>

<h3 style='margin-top:0in;margin-right:0in;margin-bottom:.55pt;margin-left:
0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;line-height:
110%;color:black;font-weight:normal'> </span><span style='font-size:
10.0pt;line-height:110%;color:black'>name read/write type description</span></h3>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:145.75pt;text-indent:89.4pt'>Setting the CompareMode can only be
performed on an empty CompareMode</p>

<p class=MsoNormal style='margin-top:0in;margin-right:6.8pt;margin-bottom:0in;
margin-left:159.7pt;text-indent:-159.45pt'>CompareMode <i>read / write </i>dictionary.
Accepted values are 0 (vbBinaryCompare), 1 constant</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:3.3pt;
margin-left:235.65pt'>(vbTextCompare), 2 (vbDatabaseCompare).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:235.65pt'>A one-based count of the key/item pairs in the scripting</p>

<p class=MsoNormal style='margin:0in;text-indent:0in'>Count <i>read
only </i>unsigned long integer</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:.2pt;
margin-bottom:4.55pt;margin-left:12.65pt;text-align:center;line-height:103%'>dictionary
object.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:3.3pt;
margin-left:0in;text-indent:0in'>Key <i>read / write </i>non-array
variant Each individual unique key in the dictionary.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:7.45pt;
margin-bottom:0in;margin-left:228.0pt;text-align:center;line-height:103%'>Default
property. Each individual item associated with a key in the dictionary. Note
that attempting to retrieve an item with a</p>

<p class=MsoNormal style='margin:0in;text-indent:0in'>Item(<i>Key</i>) <i>read
/ write </i>any variant</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:15.5pt;
margin-left:235.65pt'>key that does not exist in the dictionary will <i>implicitly
add</i> the passed key.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.2pt;
margin-left:.75pt'><b>Methods</b></p>

<h3 style='margin-top:0in;margin-right:0in;margin-bottom:.55pt;margin-left:
0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;line-height:
110%;color:black;font-weight:normal'> </span><span style='font-size:
10.0pt;line-height:110%;color:black'>name description</span></h3>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:66.45pt'>Adds a new Key and Item to the dictionary. The new key
must not exist in the dictionary's current</p>

<p class=MsoNormal style='margin-top:0in;margin-right:9.75pt;margin-bottom:
0in;margin-left:.75pt'>Add(<i>Key</i>,<i>Item</i>)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:3.85pt;
margin-left:66.45pt'>Keys collection but an item can be repeated among many
unique keys.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:3.85pt;
margin-left:0in;text-indent:0in'>Exists(<i>Key</i>) Boolean
test to determine if a Key already exists in the dictionary.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:3.85pt;
margin-left:0in;text-indent:0in'>Keys Returns the
array or collection of unique keys.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:3.85pt;
margin-left:0in;text-indent:0in'>Items Returns the
array or collection of associated items.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:3.85pt;
margin-left:.75pt'>Remove(<i>Key</i>) Removes an individual dictionary key and
its associated item.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.3pt;
margin-left:0in;text-indent:0in'>RemoveAll Clears all of a
dictionary object's keys and items.</p>

<h3 style='margin-top:0in;margin-right:0in;margin-bottom:0in;margin-left:.75pt;
line-height:110%'><span style='font-size:10.0pt;line-height:110%;color:black'>Sample
Code</span></h3>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=720 height=216
src="VBA%20Notes%20for%20Professionals_files/image248.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
0in;margin-left:-.45pt;text-indent:0in;line-height:107%'><img border=0
width=719 height=958 id="Picture 302187"
src="VBA%20Notes%20for%20Professionals_files/image249.gif"></p>

<h1 style='margin-left:-.25pt'><a name="_Toc308759">Chapter 24: VBA Option
Keyword</a></h1>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=700
 style='width:524.85pt;margin-left:1.0pt;border-collapse:collapse'>
 <tr style='height:12.3pt'>
  <td width=124 valign=top style='width:93.05pt;padding:0in 0in 0in 0in;
  height:12.3pt'>
  <p class=MsoNormal align=center style='margin-top:0in;margin-right:2.0pt;
  margin-bottom:0in;margin-left:0in;text-align:center;text-indent:0in;
  line-height:107%'><b>Option</b></p>
  </td>
  <td width=576 valign=top style='width:431.8pt;padding:0in 0in 0in 0in;
  height:12.3pt'>
  <p class=MsoNormal align=center style='margin-top:0in;margin-right:0in;
  margin-bottom:0in;margin-left:11.75pt;text-align:center;text-indent:0in;
  line-height:107%'><b>Detail</b></p>
  </td>
 </tr>
 <tr style='height:27.4pt'>
  <td width=124 style='width:93.05pt;padding:0in 0in 0in 0in;height:27.4pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Explicit</p>
  </td>
  <td width=576 valign=top style='width:431.8pt;padding:0in 0in 0in 0in;
  height:27.4pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><i>Require
  variable declaration</i> in the module it's specified in (ideally all of
  them); with this option specified, using an undeclared (/mispelled) variable
  becomes a compilation error.</p>
  </td>
 </tr>
 <tr style='height:28.75pt'>
  <td width=124 style='width:93.05pt;padding:0in 0in 0in 0in;height:28.75pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Compare<span
  style='font-family:"Arial",sans-serif'> </span>Text</p>
  </td>
  <td width=576 valign=top style='width:431.8pt;padding:0in 0in 0in 0in;
  height:28.75pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Makes
  the module's string comparisons be case-insensitive, based on system locale,
  prioritizing alphabetical equivalency (e.g. &quot;a&quot; = &quot;A&quot;).</p>
  </td>
 </tr>
 <tr style='height:37.65pt'>
  <td width=124 style='width:93.05pt;padding:0in 0in 0in 0in;height:37.65pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Compare<span
  style='font-family:"Arial",sans-serif'> </span>Binary</p>
  </td>
  <td width=576 valign=top style='width:431.8pt;padding:0in 0in 0in 0in;
  height:37.65pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Default
  string comparison mode. Makes the module's string comparisons be case
  sensitive, comparing strings using the binary representation / numeric value
  of each character (e.g. ASCII).</p>
  </td>
 </tr>
</table>

<p class=MsoNormal align=right style='margin-top:0in;margin-right:14.25pt;
margin-bottom:0in;margin-left:.5pt;text-align:right;line-height:107%'>(MS-Access
only) Makes the module's string comparisons work the way they would in an SQL</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=713 style='width:535.0pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:37.8pt'>
  <td width=124 style='width:93.05pt;padding:.05pt 0in 0in 0in;height:37.8pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Private<span
  style='font-family:"Arial",sans-serif'> </span>Module</p>
  </td>
  <td width=589 valign=top style='width:441.9pt;padding:.05pt 0in 0in 0in;
  height:37.8pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Prevents
  the module's <b><span style='font-size:9.0pt;line-height:107%;color:blue;
  background:#FAFAFA'>Public</span></b> member from being accessed from outside
  of the project that the module resides in, effectively hiding procedures from
  the host application (i.e. not available to use as macros or user-defined
  functions).</p>
  </td>
 </tr>
 <tr style='height:28.95pt'>
  <td width=124 style='width:93.05pt;padding:.05pt 0in 0in 0in;height:28.95pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Option<span
  style='font-family:"Arial",sans-serif'> </span>Base<span style='font-family:
  "Arial",sans-serif'> </span>0</p>
  </td>
  <td width=589 valign=top style='width:441.9pt;padding:.05pt 0in 0in 0in;
  height:28.95pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Default
  setting. Sets the implicit array lower bound to <span style='font-size:9.0pt;
  line-height:107%;background:#FAFAFA'>0</span> in a module. When an array is
  declared without an explicit lower boundary value, <span style='font-size:
  9.0pt;line-height:107%;background:#FAFAFA'>0</span> will be used.</p>
  </td>
 </tr>
 <tr style='height:19.9pt'>
  <td width=124 valign=bottom style='width:93.05pt;padding:.05pt 0in 0in 0in;
  height:19.9pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Option<span
  style='font-family:"Arial",sans-serif'> </span>Base<span style='font-family:
  "Arial",sans-serif'> </span>1</p>
  </td>
  <td width=589 valign=top style='width:441.9pt;padding:.05pt 0in 0in 0in;
  height:19.9pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Sets
  the implicit array lower bound to <span style='font-size:9.0pt;line-height:
  107%;background:#FAFAFA'>1</span> in a module. When an array is declared
  without an</p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:237.05pt;margin-bottom:
.25pt;margin-left:93.3pt;text-align:justify;text-justify:inter-ideograph;
text-indent:-93.05pt;line-height:429%'>Compare<span style='font-family:"Arial",sans-serif'>
</span>Database statement. explicit lower boundary value, <span
style='font-size:9.0pt;line-height:429%;background:#FAFAFA'>1</span> will be
used.</p>

<h2 style='margin-left:-.25pt'><a name="_Toc308760">Section 24.1: Option
Explicit</a></h2>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=108 style='width:81.0pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=108 valign=top style='width:81.0pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Option</span></b><span style='font-size:9.0pt;line-height:
  107%'> Explicit</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>It is deemed best practice to always use in VBA as it
forces the developer to declare all their variables before use. This has other
benefits too, such as auto-capitalization for declared variable names and
IntelliSense.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=125
src="VBA%20Notes%20for%20Professionals_files/image250.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Setting <b>Require Variable Declaration</b> within the VBE's
Tools <span style='font-family:"Arial",sans-serif'>&#9658;</span> Options <span
style='font-family:"Arial",sans-serif'>&#9658;</span> Editor property page will
put the <a href="https://msdn.microsoft.com/en-us/library/y9341s4f.aspx"><b><span
style='color:#193C96'>Option </span></b></a><a
href="https://msdn.microsoft.com/en-us/library/y9341s4f.aspx"><b><span
style='color:#193C96'>Explicit</span></b></a> statement at the top of each
newly created code sheet.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><img border=0 width=449
height=328 id="Picture 16818"
src="VBA%20Notes%20for%20Professionals_files/image251.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:18.2pt;
margin-left:.75pt'>This will avoid silly coding mistakes like misspellings as
well as influencing you to use the correct variable type in the variable
declaration. (Some more examples are given at ALWAYS Use &quot;Option
Explicit&quot;.)</p>

<h2 style='margin-left:-.25pt'><a name="_Toc308761">Section 24.2: Option Base
{0 | 1}</a></h2>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=79 style='width:59.4pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=79 valign=top style='width:59.4pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Option</span></b><span style='font-size:9.0pt;line-height:
  107%'> Base</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:59.9pt'>is used to declare the default lower bound of <b>array</b>
elements. It is declared at module level and is</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.8pt;
margin-left:.75pt'>valid only for the current module.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.5pt;
margin-left:.75pt'>By default (and thus if no Option Base is specified), the
Base is 0. Which means that the first element of any array declared in the
module has an index of 0.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=86 style='width:.9in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=86 valign=top style='width:.9in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Option</span></b><span style='font-size:9.0pt;line-height:
  107%'> Base </span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:180.5pt;margin-bottom:
0in;margin-left:.75pt;line-height:217%'>If <span style='font-size:9.0pt;
line-height:217%;color:brown;background:#FAFAFA'>1</span> is specified, the
first array element has the index 1 <b>Example in Base 0 :</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:19.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=720 height=339
src="VBA%20Notes%20for%20Professionals_files/image252.gif"></span></p>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:0in;margin-left:.75pt'>Same
Example with Base 1</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:.5pt'><span style='font-size:11.0pt;line-height:110%'><img
border=0 width=718 height=42 id="Group 276082"
src="VBA%20Notes%20for%20Professionals_files/image253.gif"></span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Option</span></b><span
style='font-size:9.0pt;line-height:110%'> Base </span><span style='font-size:
9.0pt;line-height:110%;color:brown'>1</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=719 height=301
src="VBA%20Notes%20for%20Professionals_files/image254.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=36 style='width:27.0pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=36 valign=top style='width:27.0pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Base </span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:12.45pt;margin-bottom:
0in;margin-left:.75pt;line-height:170%'>The second example generated a <a
href="https://msdn.microsoft.com/en-us/library/aa264519.aspx"><span
style='color:#193C96'>Subscript out of range (Error 9)</span></a> at the first
loop stage because an attempt to access the index 0 of the array was made, and
this index doesn't exists as the module is declared with <span
style='font-size:9.0pt;line-height:170%;color:brown;background:#FAFAFA'>1 </span><b>The
correct code with Base 1 is :</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=720 height=92
src="VBA%20Notes%20for%20Professionals_files/image255.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=79 style='width:59.4pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=79 valign=top style='width:59.4pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Option</span></b><span style='font-size:9.0pt;line-height:
  107%'> Base</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.65pt;
margin-left:.75pt'>It should be noted that the <a
href="https://msdn.microsoft.com/en-us/library/aa263365.aspx"><span
style='color:#193C96'>Split function</span></a> <b>always</b> creates an array
with a zero-based element index regardless of any setting. Examples on how to
use the <b>Split</b> function can be found here</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:24.5pt'><img width=3 height=1
src="VBA%20Notes%20for%20Professionals_files/image168.gif" align=left
hspace=12>Split Function</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:24.15pt;
margin-bottom:13.35pt;margin-left:12.65pt;text-align:center;line-height:103%'>Returns
a zero-based, one-dimensional array containing a specified number of
substrings.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=204 style='width:152.65pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=36 valign=top style='width:27.0pt;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Range</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;background:#FAFAFA'>.</span></p>
  </td>
  <td width=36 valign=top style='width:27.0pt;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Value</span></p>
  </td>
  <td width=31 valign=top style='width:23.05pt;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'>and </p>
  </td>
  <td width=36 valign=top style='width:27.0pt;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Range</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;background:#FAFAFA'>.</span></p>
  </td>
  <td width=50 valign=top style='width:37.8pt;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Formula</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>In Excel, the properties for a multi-celled range <i>always</i>
returns a 1-based 2D</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.8pt;
margin-left:.75pt'>Variant array.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=122 style='width:91.8pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=65 valign=top style='width:48.6pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Recordset</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;background:#FAFAFA'>.</span></p>
  </td>
  <td width=50 valign=top style='width:37.8pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>GetRows</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.8pt;
margin-left:.75pt'>Likewise, in ADO, the method <i>always</i> returns a
1-based 2D array.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>One recommended 'best practice' is to always use the <a
href="https://msdn.microsoft.com/en-us/library/t9a7w1ac.aspx"><span
style='color:#193C96'>LBound</span></a> and <a
href="https://msdn.microsoft.com/en-us/library/office/gg278658.aspx"><span
style='color:#193C96'>UBound</span></a> functions to determine the extents of
an array.</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=273
src="VBA%20Notes%20for%20Professionals_files/image256.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=21
src="VBA%20Notes%20for%20Professionals_files/image257.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=86 style='width:.9in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=86 valign=top style='width:.9in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Option</span></b><span style='font-size:9.0pt;line-height:
  107%'> Base </span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:6.3pt;margin-bottom:.25pt;
margin-left:.75pt;text-align:justify;text-justify:inter-ideograph;line-height:
135%'>The <span style='font-size:9.0pt;line-height:135%;color:brown;background:
#FAFAFA'>1</span> must be at the top of every code module where an array is
created or re-dimensioned if arrays are to be consistently created with an
lower boundary of 1.</p>

<h2 style='margin-top:0in;margin-right:6.3pt;margin-bottom:.25pt;margin-left:
.75pt;text-align:justify;text-justify:inter-ideograph;line-height:135%'><a
name="_Toc308762">Section 24.3: Option Compare {Binary | Text | Database}</a></h2>

<h4 style='margin-left:.75pt'>Option Compare Binary</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:9.25pt;
margin-left:.75pt'>Binary comparison makes all checks for string equality
within a module/class case <i>sensitive</i>. Technically, with this option,
string comparisons are performed using sort order of the binary representations
of each character.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.1pt;
margin-left:0in;text-indent:0in'><span style='font-size:11.0pt;line-height:
110%'> <img border=0 width=3 height=51 id="Group 274729"
src="VBA%20Notes%20for%20Professionals_files/image258.gif"></span> A &lt;
B &lt; E &lt; Z &lt; a &lt; b &lt; e &lt; z</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>If no Option Compare is specified in a module, Binary is
used by default.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:19.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=541
src="VBA%20Notes%20for%20Professionals_files/image259.gif"></span></p>

<h4 style='margin-left:.75pt'>Option Compare Text</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:27.8pt;margin-bottom:
1.5pt;margin-left:16.0pt;text-indent:-15.75pt;line-height:188%'>Option Compare
Text makes all string comparisons within a module/class use a case <i>insensitive</i>
comparison. <span style='font-size:11.0pt;line-height:188%'><img border=0
width=3 height=51 id="Group 274730"
src="VBA%20Notes%20for%20Professionals_files/image258.gif"></span> (A
| a) &lt; (B | b) &lt; (Z | z)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:19.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=443
src="VBA%20Notes%20for%20Professionals_files/image260.gif"></span></p>

<h4 style='margin-left:.75pt'>Option Compare Database</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.45pt;
margin-left:.75pt'>Option Compare Database is only available within MS Access.
It sets the module/class to use the current database settings to determine
whether to use Text or Binary mode.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:9.75pt;margin-bottom:
0in;margin-left:.75pt'><i>Note: The use of this setting is discouraged unless
the module is used for writing custom Access UDFs (User defined functions) that
should treat text comparisons in the same manner as SQL queries in that
database.</i></p>

<h1 style='margin-left:-.25pt'><a name="_Toc308763">Chapter 25: Date Time
Manipulation</a></h1>

<h2 style='margin-left:-.25pt'><a name="_Toc308764">Section 25.1: Calendar</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.9pt;
margin-left:.75pt'>VBA supports 2 calendars : <a
href="https://en.wikipedia.org/wiki/Gregorian_calendar"><span style='color:
#193C96'>Gregorian</span></a> and <a
href="https://en.wikipedia.org/wiki/Islamic_calendar"><span style='color:#193C96'>Hijri</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.9pt;
margin-left:.75pt'>The <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>Calendar</span> property is used to modify or display the
current calendar.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.8pt;
margin-left:.75pt'>The 2 values for the Calendar are:</p>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:1.3pt;margin-left:
0in;text-indent:0in'>Value Constant Description</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:4.0pt;
margin-left:30.3pt;text-indent:-30.05pt'><span style='line-height:110%'>0<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>vbCalGreg Gregorian calendar (default)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:4.1pt;
margin-left:30.3pt;text-indent:-30.05pt'><span style='line-height:110%'>1<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>vbCalHijri Hijri calendar</p>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:0in;margin-left:.75pt'>Example</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=371
src="VBA%20Notes%20for%20Professionals_files/image261.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>This Sub prints the following ;</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=94
src="VBA%20Notes%20for%20Professionals_files/image262.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc308765">Section 25.2: Base
functions</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.2pt;
margin-left:.75pt'><b>Retrieve System DateTime</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.8pt;
margin-left:.75pt'>VBA supports 3 built-in functions to retrieve the date
and/or time from the system's clock.</p>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:1.1pt;margin-left:
0in;text-indent:0in'>Function Return Type Return
Value</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:3.85pt;
margin-left:0in;text-indent:0in'>Now Date Returns
the current date and time</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:3.85pt;
margin-left:0in;text-indent:0in'>Date Date Returns
the date portion of the current date and time</p>

<p class=MsoNormal style='margin-left:0in;text-indent:0in'>Time Date Returns
the time portion of the current date and time</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:34.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=720 height=273
src="VBA%20Notes%20for%20Professionals_files/image263.gif"></span></p>

<h4 style='margin-left:.75pt'>Timer Function</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>The <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>Timer</span> function returns a Single representing the
number of seconds elapsed since midnight. The precision is one hundredth of a
second.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=109
src="VBA%20Notes%20for%20Professionals_files/image264.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Because <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>Now</span> and <span style='font-size:9.0pt;line-height:
110%;background:#FAFAFA'>Time</span> functions are only precise to seconds, <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Timer</span> offers
a convenient way to increase accuracy of time measurement:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:34.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=720 height=273
src="VBA%20Notes%20for%20Professionals_files/image265.gif"></span></p>

<h4 style='margin-left:.75pt'>IsDate()</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>IsDate() tests whether an expression is a valid date or not.
Returns a <span style='font-size:9.0pt;line-height:110%;color:slateblue;
background:#FAFAFA'>Boolean</span>.</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=63
src="VBA%20Notes%20for%20Professionals_files/image266.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=301
src="VBA%20Notes%20for%20Professionals_files/image267.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc308766">Section 25.3: Extraction
functions</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.45pt;
margin-left:.75pt'>These functions take a <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>Variant</span> that can be cast to a <span
style='font-size:9.0pt;line-height:110%;color:slateblue;background:#FAFAFA'>Date</span>
as a parameter and return an <span style='font-size:9.0pt;line-height:110%;
color:slateblue;background:#FAFAFA'>Integer</span> representing a portion of a
date or time. If the parameter can not be cast to a <span style='font-size:
9.0pt;line-height:110%;color:slateblue;background:#FAFAFA'>Date</span>, it will
result in a run-time error 13: Type mismatch.</p>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:1.1pt;margin-left:
0in;text-indent:0in'>Function Description Returned
value</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:3.85pt;
margin-left:0in;text-indent:0in'>Year() Returns the year
portion of the date argument. Integer
(100 to 9999)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:3.85pt;
margin-left:0in;text-indent:0in'>Month() Returns the month
portion of the date argument. Integer
(1 to 12)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:3.3pt;
margin-left:0in;text-indent:0in'>Day() Returns the day
portion of the date argument. Integer
(1 to 31)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:54.3pt'>Returns the day of the week of the date argument. Accepts
an optional second</p>

<p class=MsoNormal style='margin:0in;text-indent:0in'>WeekDay() Integer
(1 to 7)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:3.85pt;
margin-left:54.3pt'>argument definining the first day of the week</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:3.85pt;
margin-left:0in;text-indent:0in'>Hour() Returns the hour
portion of the date argument. Integer
(0 to 23)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:3.85pt;
margin-left:0in;text-indent:0in'>Minute() Returns the minute
portion of the date argument. Integer
(0 to 59)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.3pt;
margin-left:0in;text-indent:0in'>Second() Returns the second
portion of the date argument. Integer
(0 to 59)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.7pt;
margin-left:.75pt'><b>Examples:</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:12.55pt;
margin-left:3.5pt'><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Sub</span></b><span
style='font-size:9.0pt;line-height:110%'> ExtractionExamples()</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Dim</span></b><span
style='font-size:9.0pt;line-height:110%'> MyDate </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>Date</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
margin-left:3.75pt;text-indent:0in;line-height:107%'><span style='font-size:
9.0pt;line-height:107%'> </span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:12.55pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'> MyDate = </span><span
style='font-size:9.0pt;line-height:110%;color:#000066'>DateSerial</span><span
style='font-size:9.0pt;line-height:110%'>(</span><span style='font-size:9.0pt;
line-height:110%;color:brown'>2016</span><span style='font-size:9.0pt;
line-height:110%'>, </span><span style='font-size:9.0pt;line-height:110%;
color:brown'>7</span><span style='font-size:9.0pt;line-height:110%'>, </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>28</span><span
style='font-size:9.0pt;line-height:110%'>) + </span><span style='font-size:
9.0pt;line-height:110%;color:#000066'>TimeSerial</span><span style='font-size:
9.0pt;line-height:110%'>(</span><span style='font-size:9.0pt;line-height:110%;
color:brown'>12</span><span style='font-size:9.0pt;line-height:110%'>, </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>34</span><span
style='font-size:9.0pt;line-height:110%'>, </span><span style='font-size:9.0pt;
line-height:110%;color:brown'>56</span><span style='font-size:9.0pt;line-height:
110%'>)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.05pt;margin-bottom:12.55pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'>
Debug.Print </span><span style='font-size:9.0pt;line-height:110%;color:#000066'>Format$</span><span
style='font-size:9.0pt;line-height:110%'>(MyDate, </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>&quot;yyyy-mm-dd
hh:nn:ss&quot;</span><span style='font-size:9.0pt;line-height:110%'>) </span><i><span
style='font-size:9.0pt;line-height:110%;color:green'>' prints 2016-07-28
12:34:56</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'>
Debug.Print </span><span style='font-size:9.0pt;line-height:110%;color:#000066'>Year</span><span
style='font-size:9.0pt;line-height:110%'>(MyDate) </span><i><span
style='font-size:9.0pt;line-height:110%;color:green'>' prints 2016</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'>
Debug.Print </span><span style='font-size:9.0pt;line-height:110%;color:#000066'>Month</span><span
style='font-size:9.0pt;line-height:110%'>(MyDate) </span><i><span
style='font-size:9.0pt;line-height:110%;color:green'>' prints 7</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'>
Debug.Print </span><span style='font-size:9.0pt;line-height:110%;color:#000066'>Day</span><span
style='font-size:9.0pt;line-height:110%'>(MyDate) </span><i><span
style='font-size:9.0pt;line-height:110%;color:green'>' prints 28</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'>
Debug.Print </span><span style='font-size:9.0pt;line-height:110%;color:#000066'>Hour</span><span
style='font-size:9.0pt;line-height:110%'>(MyDate) </span><i><span
style='font-size:9.0pt;line-height:110%;color:green'>' prints 12</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:179.7pt;margin-bottom:
.2pt;margin-left:3.5pt'><span style='position:relative;z-index:-1895782400'><span
style='left:0px;position:absolute;left:0px;top:-49969px;width:718px;height:
1px'><img width=718 height=1
src="VBA%20Notes%20for%20Professionals_files/image268.gif"></span></span><span
style='font-size:9.0pt;line-height:110%'> Debug.Print </span><span
style='font-size:9.0pt;line-height:110%;color:#000066'>Minute</span><span
style='font-size:9.0pt;line-height:110%'>(MyDate) </span><i><span
style='font-size:9.0pt;line-height:110%;color:green'>' prints 34 </span></i><span
style='font-size:9.0pt;line-height:110%'>Debug.Print </span><span
style='font-size:9.0pt;line-height:110%;color:#000066'>Second</span><span
style='font-size:9.0pt;line-height:110%'>(MyDate) </span><i><span
style='font-size:9.0pt;line-height:110%;color:green'>' prints 56 </span></i><span
style='font-size:9.0pt;line-height:110%'></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'>
Debug.Print </span><span style='font-size:9.0pt;line-height:110%;color:#000066'>Weekday</span><span
style='font-size:9.0pt;line-height:110%'>(MyDate) </span><i><span
style='font-size:9.0pt;line-height:110%;color:green'>' prints 5</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.05pt;margin-bottom:.25pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'> </span><i><span
style='font-size:9.0pt;line-height:110%;color:green'>'Varies by locale - i.e.
will print 4 in the EU and 5 in the US</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'>
Debug.Print </span><span style='font-size:9.0pt;line-height:110%;color:#000066'>Weekday</span><span
style='font-size:9.0pt;line-height:110%'>(MyDate, vbUseSystemDayOfWeek)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:185.0pt;margin-bottom:
.2pt;margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'>
Debug.Print </span><span style='font-size:9.0pt;line-height:110%;color:#000066'>Weekday</span><span
style='font-size:9.0pt;line-height:110%'>(MyDate, vbMonday) </span><i><span
style='font-size:9.0pt;line-height:110%;color:green'>' prints 4 </span></i><span
style='font-size:9.0pt;line-height:110%'>Debug.Print </span><span
style='font-size:9.0pt;line-height:110%;color:#000066'>Weekday</span><span
style='font-size:9.0pt;line-height:110%'>(MyDate, vbSunday) </span><i><span
style='font-size:9.0pt;line-height:110%;color:green'>' prints 5 </span></i><span
style='font-size:9.0pt;line-height:110%'></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:19.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=21
src="VBA%20Notes%20for%20Professionals_files/image269.gif"></span></p>

<h4 style='margin-left:.75pt'>DatePart() Function</h4>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=58 style='width:.6in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#000066'>DatePart</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal align=right style='margin-top:0in;margin-right:10.55pt;
margin-bottom:2.0pt;margin-left:.5pt;text-align:right;line-height:107%'><span
style='font-size:9.0pt;line-height:107%;background:#FAFAFA'>()</span> is also a
function returning a portion of a date, but works differently and allow more
possibilities than</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:13.05pt;
margin-left:.75pt'>the functions above. It can for instance return the Quarter
of the year or the Week of the year.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.7pt;
margin-left:.75pt'><b>Syntax:</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:139.75pt;margin-bottom:
.2pt;margin-left:0in;text-indent:3.75pt;line-height:240%'><span
style='position:relative;z-index:-1895781376'><span style='left:0px;position:
absolute;left:0px;top:-50273px;width:718px;height:1px'><img width=718 height=1
src="VBA%20Notes%20for%20Professionals_files/image144.gif"></span></span><span
style='font-size:9.0pt;line-height:240%;color:#000066'>DatePart</span><span
style='font-size:9.0pt;line-height:240%'> ( interval, </span><span
style='font-size:9.0pt;line-height:240%;color:slateblue'>date</span><span
style='font-size:9.0pt;line-height:240%'> [, firstdayofweek] [,
firstweekofyear] ) </span><i>interval</i> argument can be :</p>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:1.1pt;margin-left:
0in;text-indent:0in'>Interval Description</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:3.85pt;
margin-left:0in;text-indent:0in'>&quot;yyyy&quot; Year (100 to 9999)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:3.85pt;
margin-left:0in;text-indent:0in'>&quot;y&quot; Day of the year
(1 to 366)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:410.65pt;margin-bottom:
0in;margin-left:.75pt;line-height:141%'>&quot;m&quot; Month (1 to 12)
&quot;q&quot; Quarter (1 to 4)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:3.85pt;
margin-left:0in;text-indent:0in'>&quot;ww&quot; Week (1 to 53)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:3.85pt;
margin-left:0in;text-indent:0in'>&quot;w&quot; Day of the week (1
to 7)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:3.85pt;
margin-left:0in;text-indent:0in'>&quot;d&quot; Day of the month
(1 to 31)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:3.85pt;
margin-left:0in;text-indent:0in'>&quot;h&quot; Hour (0 to 23)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:409.9pt;margin-bottom:
11.3pt;margin-left:.75pt;line-height:141%'>&quot;n&quot; Minute (0 to
59) &quot;s&quot; Second (0 to 59)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.45pt;
margin-left:.75pt'><i>firstdayofweek</i> is optional. it is a constant that
specifies the first day of the week. If not specified, <span style='font-size:
9.0pt;line-height:110%;background:#FAFAFA'>vbSunday</span> is assumed.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.7pt;
margin-left:.75pt'><i>firstweekofyear</i> is optional. it is a constant that
specifies the first week of the year. If not specified, the first week is
assumed to be the week in which January 1 occurs.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:.75pt'><b>Examples:</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=273
src="VBA%20Notes%20for%20Professionals_files/image270.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc308767">Section 25.4: Calculation
functions</a></h2>

<h4 style='margin-left:.75pt'>DateDiff()</h4>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=58 style='width:.6in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#000066'>DateDiff</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:13.1pt;
margin-left:.75pt'><span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>()</span> returns a <span style='font-size:9.0pt;line-height:110%;
color:slateblue;background:#FAFAFA'>Long</span> representing the number of time
intervals between two specified dates.</p>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:14.7pt;margin-left:
.75pt'>Syntax</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2in;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%;color:#000066'>DateDiff</span><span
style='font-size:9.0pt;line-height:110%'> ( interval, date1, date2 [,
firstdayofweek] [, firstweekofyear] )</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=58 style='width:.6in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#000066'>DatePart</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:160.05pt;margin-bottom:
1.5pt;margin-left:30.5pt'><span style='position:relative;z-index:-1895780352'><span
style='left:0px;position:absolute;left:0px;top:-51177px;width:718px;height:
1px'><img width=718 height=1
src="VBA%20Notes%20for%20Professionals_files/image271.gif"></span></span><i>interval</i>
can be any of the intervals defined in the <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>()</span> function <i>date1</i> and <i>date2</i>
are the two dates you want to use in the calculation</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=58 style='width:.6in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#000066'>DatePart</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:29.6pt;margin-bottom:
0in;margin-left:.25pt;text-indent:30.0pt;line-height:217%'><i>firstdayofweek</i>
and <i>firstweekofyear</i> are optional. Refer to <span style='font-size:9.0pt;
line-height:217%;background:#FAFAFA'>()</span> function for explanations <b>Examples</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:19.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=306
src="VBA%20Notes%20for%20Professionals_files/image272.gif"></span></p>

<h4 style='margin-left:.75pt'>DateAdd()</h4>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=50 style='width:37.8pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=50 valign=top style='width:37.8pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#000066'>DateAdd</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:13.1pt;
margin-left:.75pt'><span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>()</span> returns a <span style='font-size:9.0pt;line-height:110%;
color:slateblue;background:#FAFAFA'>Date</span> to which a specified date or
time interval has been added.</p>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:14.7pt;margin-left:
.75pt'>Syntax</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2in;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%;color:#000066'>DateAdd</span><span
style='font-size:9.0pt;line-height:110%'> ( interval, number, </span><span
style='font-size:9.0pt;line-height:110%;color:slateblue'>date</span><span
style='font-size:9.0pt;line-height:110%'> )</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=58 style='width:.6in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#000066'>DatePart</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.75pt;
margin-left:30.5pt'><span style='position:relative;z-index:-1895779328'><span
style='left:0px;position:absolute;left:0px;top:-51736px;width:718px;height:
1px'><img width=718 height=1
src="VBA%20Notes%20for%20Professionals_files/image273.gif"></span></span><i>interval</i>
can be any of the intervals defined in the <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>()</span> function <i>number</i> Numeric
expression that is the number of intervals you want to add. It can be positive
(to get dates in the future) or negative (to get dates in the past). <i>date</i>
is a <span style='font-size:9.0pt;line-height:110%;color:slateblue;background:
#FAFAFA'>Date</span> or literal representing date to which the interval is
added</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:.75pt'><b>Examples :</b></p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=209
src="VBA%20Notes%20for%20Professionals_files/image274.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=169
src="VBA%20Notes%20for%20Professionals_files/image275.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc308768">Section 25.5: Conversion
and Creation</a></h2>

<h4 style='margin-left:.75pt'>CDate()</h4>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=36 style='width:27.0pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=36 valign=top style='width:27.0pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#CD6A5A'>CDate</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:27.5pt'><span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>()</span> converts something from any datatype to a <span
style='font-size:9.0pt;line-height:110%;color:slateblue;background:#FAFAFA'>Date</span>
datatype</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=388
src="VBA%20Notes%20for%20Professionals_files/image276.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=332 style='width:249.0pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=43 valign=top style='width:.45in;background:#FAFAFA;padding:.95pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#000066'>CVDate</span></p>
  </td>
  <td width=253 valign=top style='width:189.6pt;padding:.95pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;background:#FAFAFA'>()</span> that functions in the same way as the </p>
  </td>
  <td width=36 valign=top style='width:27.0pt;background:#FAFAFA;padding:.95pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#CD6A5A'>CDate</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Note that VBA also has a loosely typed <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>()</span> function
other than</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=36 style='width:27.0pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=36 valign=top style='width:27.0pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#CD6A5A'>CDate</span></p>
  </td>
 </tr>
</table>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=43 style='width:.45in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=43 valign=top style='width:.45in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#000066'>CVDate</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:27.8pt;
margin-left:.75pt'>returning a date typed <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>Variant</span> instead of a strongly typed
<span style='font-size:9.0pt;line-height:110%;color:slateblue;background:#FAFAFA'>Date</span>.
The <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>()</span>
version should be preferred when passing to a <span style='font-size:9.0pt;
line-height:110%;color:slateblue;background:#FAFAFA'>Date</span> parameter or
assigning to a <span style='font-size:9.0pt;line-height:110%;color:slateblue;
background:#FAFAFA'>Date</span> variable, and the <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>()</span> version should be preferred when
when passing to a <span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>Variant</span> parameter or assigning to a <span style='font-size:
9.0pt;line-height:110%;background:#FAFAFA'>Variant</span> variable. This avoids
implicit type casting.</p>

<h4 style='margin-left:.75pt'>DateSerial()</h4>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=72 style='width:.75in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=72 valign=top style='width:.75in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#000066'>DateSerial</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:13.1pt;
margin-left:54.5pt'><span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>()</span> function is used to create a date. It returns a <span
style='font-size:9.0pt;line-height:110%;color:slateblue;background:#FAFAFA'>Date</span>
for a specified year, month, and day.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:.75pt'><b>Syntax:</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="VBA%20Notes%20for%20Professionals_files/image277.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>With year, month and day arguments being valid Integers
(Year from 100 to 9999, Month from 1 to 12, Day from 1 to 31).</p>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:0in;margin-left:.75pt'>Examples</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=273
src="VBA%20Notes%20for%20Professionals_files/image278.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=72 style='width:.75in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=72 valign=top style='width:.75in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#000066'>DateSerial</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.7pt;
margin-left:.75pt'>Note that <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>()</span> will accept &quot;invalid&quot; dates and
calculate a valid date from it. This can be used creatively for good:</p>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:0in;margin-left:.75pt'>Positive
Example</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=174
src="VBA%20Notes%20for%20Professionals_files/image279.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:13.05pt;
margin-left:.75pt'>However, it is more likely to cause grief when attempting to
create a date from unvalidated user input:</p>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:0in;margin-left:.75pt'>Negative
Example</h4>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=273
src="VBA%20Notes%20for%20Professionals_files/image280.gif"></span></p>

<h1 style='margin-left:-.25pt'><a name="_Toc308769">Chapter 26: Creating a
Custom Class</a></h1>

<h2 style='margin-left:-.25pt'><a name="_Toc308770">Section 26.1: Adding a
Property to a Class</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.85pt;
margin-left:.75pt'>A <b><span style='font-size:9.0pt;line-height:110%;
color:blue;background:#FAFAFA'>Property</span></b> procedure is a series of
statement that retrieves or modifies a custom property on a module.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:13.35pt;
margin-left:.75pt'>There are three types of property accessors:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:110%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>A <b><span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>Get</span></b>
procedure that returns the value of a property.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:110%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>A <b><span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>Let</span></b>
procedure that assigns a (non-<span style='font-size:9.0pt;line-height:110%;
color:slateblue;background:#FAFAFA'>Object</span>) value to an object.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:13.0pt;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:110%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>A <b><span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>Set</span></b>
procedure that assigns an <span style='font-size:9.0pt;line-height:110%;
color:slateblue;background:#FAFAFA'>Object</span> reference.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.6pt;
margin-left:.75pt'>Property accessors are often defined in pairs, using both a <b><span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>Get</span></b>
and <b><span style='font-size:9.0pt;line-height:110%;color:blue;background:
#FAFAFA'>Let</span></b>/<b><span style='font-size:9.0pt;line-height:110%;
color:blue;background:#FAFAFA'>Set</span></b> for each property. A property
with only a <b><span style='font-size:9.0pt;line-height:110%;color:blue;
background:#FAFAFA'>Get</span></b> procedure would be read-only, while a
property with only a <b><span style='font-size:9.0pt;line-height:110%;
color:blue;background:#FAFAFA'>Let</span></b>/<b><span style='font-size:9.0pt;
line-height:110%;color:blue;background:#FAFAFA'>Set</span></b> procedure would
be write-only.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:13.5pt;
margin-left:.75pt'>In the following example, four property accessors are
defined for the <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>DateRange</span>
class:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:110%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>StartDate</span> (<i>read/write</i>).
Date value representing the earlier date in a range. Each procedure uses the
value of the module variable, <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>mStartDate</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:110%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>EndDate</span> (<i>read/write</i>).
Date value representing the later date in a range. Each procedure uses the
value of the module variable, <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>mEndDate</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:110%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>DaysBetween</span>
(<i>read-only</i>). Calculated Integer value representing the number of days
between the two dates. Because there is only a <b><span style='font-size:9.0pt;
line-height:110%;color:blue;background:#FAFAFA'>Get</span></b> procedure, this
property cannot be modified directly.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:110%'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span><span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>RangeToCopy</span>
(<i>write-only</i>). A <b><span style='font-size:9.0pt;line-height:110%;
color:blue;background:#FAFAFA'>Set</span></b> procedure used to copy the values
of an existing <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>DateRange</span>
object.</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=548
src="VBA%20Notes%20for%20Professionals_files/image281.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=21
src="VBA%20Notes%20for%20Professionals_files/image282.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc308771">Section 26.2: Class module
scope, instancing and re-use</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>By default, a new class module is a Private class, so it is <i>only</i>
available for instantiation and use within the VBProject in which it is
defined. You can declare, instantiate and use the class anywhere in the <i>same</i>
project:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=92
src="VBA%20Notes%20for%20Professionals_files/image283.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:13.15pt;
margin-left:.75pt'>But often you'll write classes that you'd like to use in
other projects <i>without</i> copying the module between projects. If you
define a class called <span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>List</span> in <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>ProjectA</span>, and want to use that class in <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>ProjectB</span>,
then you'll need to perform 4 actions:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:10.3pt;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:110%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Change
the instancing property of the <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>List</span> class in <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>ProjectA</span> in the Properties window,
from <b><span style='font-size:9.0pt;line-height:110%;color:blue;background:
#FAFAFA'>Private</span></b> to <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>PublicNotCreatable</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:3.05pt;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:110%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>Create
a public &quot;factory&quot; function in <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>ProjectA</span> that creates and returns
an instance of a <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>List</span>
class. Typically the factory function would include arguments for the
initialization of the class instance. The factory function is required because
the class can be used by <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>ProjectB</span> but <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>ProjectB</span> cannot directly create an
instance of <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>ProjectA</span>'s
class.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.35pt;
margin-left:30.0pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=678 height=158
src="VBA%20Notes%20for%20Professionals_files/image284.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=144 style='width:1.5in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=144 valign=top style='width:1.5in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Tools..References...</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:10.0pt;
margin-left:30.0pt;text-indent:-13.9pt'><span style='line-height:110%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp; </span></span>In <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>ProjectB</span> add
a reference to <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>ProjectA</span>
using the menu.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:3.95pt;
margin-left:30.0pt;text-indent:-13.9pt;line-height:103%'><span
style='line-height:103%'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>In <span style='font-size:9.0pt;line-height:103%;background:#FAFAFA'>ProjectB</span>,
declare a variable and assign it an instance of <span style='font-size:9.0pt;
line-height:103%;background:#FAFAFA'>List</span> using the factory function
from <span style='font-size:9.0pt;line-height:103%;background:#FAFAFA'>ProjectA</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:18.65pt;
margin-left:30.0pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=678 height=142
src="VBA%20Notes%20for%20Professionals_files/image285.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc308772">Section 26.3: Adding
Functionality to a Class</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Any public <b><span style='font-size:9.0pt;line-height:110%;
color:blue;background:#FAFAFA'>Sub</span></b>, <b><span style='font-size:9.0pt;
line-height:110%;color:blue;background:#FAFAFA'>Function</span></b>, or <b><span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>Property</span></b>
inside a class module can be called by preceding the call with an object
reference:</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=26
src="VBA%20Notes%20for%20Professionals_files/image286.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>In a <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>DateRange</span> class, a <b><span style='font-size:9.0pt;
line-height:110%;color:blue;background:#FAFAFA'>Sub</span></b> could be used to
add a number of days to the end date:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="VBA%20Notes%20for%20Professionals_files/image287.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>A <b><span style='font-size:9.0pt;line-height:110%;
color:blue;background:#FAFAFA'>Function</span></b> could return the last day of
the next month-end (note that <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>GetFirstDayOfMonth</span> would not be visible outside the
class because it is private):</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=125
src="VBA%20Notes%20for%20Professionals_files/image288.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.9pt;
margin-left:.75pt'>Procedures can accept arguments of any type, including
references to objects of the class being defined.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:14.2pt;
margin-left:.75pt'>The following example tests whether the current <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>DateRange</span>
object has a starting date and ending date that includes the starting and
ending date of another <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>DateRange</span> object.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Public</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Function</span></b><span style='font-size:
9.0pt;line-height:110%'> ContainsRange(</span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>ByRef</span></b><span style='font-size:9.0pt;
line-height:110%'> TheRange </span><b><span style='font-size:9.0pt;line-height:
110%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:110%'>
DateRange) </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>Boolean</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><span style='position:relative;z-index:-1895778304'><span
style='left:0px;position:absolute;left:0px;top:-56176px;width:718px;height:
1px'><img width=718 height=1
src="VBA%20Notes%20for%20Professionals_files/image289.gif"></span></span><span
style='font-size:9.0pt;line-height:110%'> ContainsRange = TheRange.StartDate
&gt;= </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Me</span></b><span
style='font-size:9.0pt;line-height:110%'>.StartDate </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>And</span></b><span
style='font-size:9.0pt;line-height:110%'> TheRange.EndDate &lt;= </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Me</span></b><span
style='font-size:9.0pt;line-height:110%'>.EndDate</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:17.3pt;
margin-left:3.5pt'><b><span style='font-size:9.0pt;line-height:110%;color:blue'>End</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Function</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Note the use of the <span style='font-size:9.0pt;line-height:
110%;background:#FAFAFA'>Me</span> notation as a way to access the value of the
object running the code.<br clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc308773">Chapter 27: Events</a></h1>

<h2 style='margin-left:-.25pt'><a name="_Toc308774">Section 27.1: Sources and
Handlers</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.2pt;
margin-left:.75pt'><b>What are events?</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.45pt;
margin-left:.75pt'>VBA is <i>event-driven</i>: VBA code runs in response to
events raised by the host application or the host document understanding events
is fundamental to understanding VBA.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=122 style='width:91.8pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=36 valign=top style='width:27.0pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Excel</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;background:#FAFAFA'>.</span></p>
  </td>
  <td width=79 valign=top style='width:59.4pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Application</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:14.3pt;margin-bottom:
1.5pt;margin-left:92.05pt;text-indent:-91.8pt'>APIs often expose objects that
raise a number of <i>events</i> in response to various states. For example an
object raises an event whenever a new workbook is created, opened, activated,
or closed. Or</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.45pt;
margin-left:.75pt'>whenever a worksheet gets calculated. Or just before a file
is saved. Or immediately after. A button on a form raises a <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Click</span> event
when the user clicks it, the user form itself raises an event just after it's
activated, and another just before it's closed.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.45pt;
margin-left:.75pt'>From an API perspective, events are <i>extension points</i>:
the client code can chose to implement code that <i>handles </i>these events,
and execute custom code whenever these events are fired: that's how you can
execute your custom code automatically every time the selection changes on any
worksheet - by handling the event that gets fired when the selection changes on
any worksheet.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:28.1pt;
margin-left:.75pt'>An object that exposes events is an <i>event source</i>. A
method that handles an event is a <i>handler</i>.</p>

<h4 style='margin-left:.75pt'>Handlers</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>VBA document modules (e.g. <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>ThisDocument</span>, <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>ThisWorkbook</span>,
<span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Sheet1</span>,
etc.) and <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>UserForm</span>
modules are <i>class modules </i>that <i>implement</i> special interfaces that
expose a number of <i>events</i>. You can browse these interfaces in the
left-side dropdown at the top of the code pane:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><img border=0 width=676
height=77 id="Picture 19962"
src="VBA%20Notes%20for%20Professionals_files/image290.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>The right-side dropdown lists the members of the interface
selected in the left-side dropdown:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><img border=0 width=674
height=237 id="Picture 19965"
src="VBA%20Notes%20for%20Professionals_files/image291.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.6pt;
margin-left:.75pt'>The VBE automatically generates an event handler stub when
an item is selected on the right-side list, or navigates there if the handler
exists.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>You can define a module-scoped <b><span style='font-size:
9.0pt;line-height:110%;color:blue;background:#FAFAFA'>WithEvents</span></b>
variable in any module:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src="VBA%20Notes%20for%20Professionals_files/image292.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Each <b><span style='font-size:9.0pt;line-height:110%;
color:blue;background:#FAFAFA'>WithEvents</span></b> declaration becomes
available to select from the left-side dropdown. When an event is selected in
the right-side dropdown, the VBE generates an event handler stub named after
the <b><span style='font-size:9.0pt;line-height:110%;color:blue;background:
#FAFAFA'>WithEvents</span></b> object and the name of the event, joined with an
underscore:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.15pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=174
src="VBA%20Notes%20for%20Professionals_files/image293.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Only types that expose at least one event can be used with <b><span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>WithEvents</span></b>,
and <b><span style='font-size:9.0pt;line-height:110%;color:blue;background:
#FAFAFA'>WithEvents</span></b> declarations cannot be assigned a reference
on-the-spot with the <b><span style='font-size:9.0pt;line-height:110%;
color:blue;background:#FAFAFA'>New</span></b> keyword. This code is illegal:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="VBA%20Notes%20for%20Professionals_files/image294.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>The object reference must be <b><span style='font-size:9.0pt;
line-height:110%;color:blue;background:#FAFAFA'>Set</span></b> explicitly; in a
class module, a good place to do that is often in the</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:28.2pt;
margin-left:.75pt'><span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>Class_Initialize</span> handler, because then the class handles that
object's events for as long as its instance exists.</p>

<h4 style='margin-left:.75pt'>Sources</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Any class module (or document module, or user form) can be
an event source. Use the <b><span style='font-size:9.0pt;line-height:110%;
color:blue;background:#FAFAFA'>Event</span></b> keyword to define the <i>signature</i>
for the event, in the <i>declarations section</i> of the module:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="VBA%20Notes%20for%20Professionals_files/image295.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.8pt;
margin-left:.75pt'>The signature of the event determines how the event is
raised, and what the event handlers will look like.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Events can only be <i>raised</i> within the class they're
defined in - client code can only <i>handle</i> them. Events are raised with
the <b><span style='font-size:9.0pt;line-height:110%;color:blue;background:
#FAFAFA'>RaiseEvent</span></b> keyword; the event's arguments are provided at
that point:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="VBA%20Notes%20for%20Professionals_files/image296.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=115 style='width:1.2in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>test</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;background:#FAFAFA'>.</span></p>
  </td>
  <td width=79 valign=top style='width:59.4pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>DoSomething</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Without code that handles the <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>SomethingHappened</span> event, running
the <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>DoSomething</span>
procedure will still raise the event, but nothing will happen. Assuming the
event source is the above code in a class named <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>Something</span>, this code in <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>ThisWorkbook</span>
would show a message box saying &quot;hello&quot; whenever gets called:</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=163
src="VBA%20Notes%20for%20Professionals_files/image297.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=38
src="VBA%20Notes%20for%20Professionals_files/image298.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc308775">Section 27.2: Passing data
back to the event source</a></h2>

<h4 style='margin-left:.75pt'>Using parameters passed by reference</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>An event may define a <b><span style='font-size:9.0pt;
line-height:110%;color:blue;background:#FAFAFA'>ByRef</span></b> parameter
meant to be returned to the caller:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=207
src="VBA%20Notes%20for%20Professionals_files/image299.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>If the <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>BeforeSomething</span> event has a handler that sets its <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>cancel</span>
parameter to <b><span style='font-size:9.0pt;line-height:110%;color:blue;
background:#FAFAFA'>True</span></b>, then when execution returns from the
handler, <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>cancel</span>
will be <b><span style='font-size:9.0pt;line-height:110%;color:blue;background:
#FAFAFA'>True</span></b> and <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>AfterSomething</span> will never be raised.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=158
src="VBA%20Notes%20for%20Professionals_files/image300.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=108 style='width:81.0pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=22 valign=top style='width:16.2pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>foo</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;background:#FAFAFA'>.</span></p>
  </td>
  <td width=79 valign=top style='width:59.4pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>DoSomething</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:27.75pt;
margin-left:.75pt'>Assuming the <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>foo</span> object reference is assigned somewhere, when
runs, a message box prompts whether to cancel, and a second message box says
&quot;didn't cancel&quot; only when <span style='border:solid black 1.5pt;
padding:0in'>No </span>was selected.</p>

<h4 style='margin-left:.75pt'>Using mutable objects</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>You could also pass a copy of a mutable object <b><span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>ByVal</span></b>,
and let handlers modify that object's properties; the caller can then read the
modified property values and act accordingly.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=207
src="VBA%20Notes%20for%20Professionals_files/image301.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Combined with the <span style='font-size:9.0pt;line-height:
110%;background:#FAFAFA'>Variant</span> type, this can be used to create rather
non-obvious ways to return a value to the caller:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=240
src="VBA%20Notes%20for%20Professionals_files/image302.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:14.45pt;
margin-left:.75pt'>The handler would look like this:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:37.15pt;margin-bottom:
.25pt;margin-left:3.5pt'><span style='position:relative;z-index:-1895777280'><span
style='left:0px;position:absolute;left:0px;top:-59517px;width:718px;height:
1px'><img width=718 height=1
src="VBA%20Notes%20for%20Professionals_files/image289.gif"></span></span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Private</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Sub</span></b><span style='font-size:9.0pt;
line-height:110%'> source_SomeEvent(</span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;
line-height:110%'> foo </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>As</span></b><span style='font-size:9.0pt;line-height:110%'>
Variant) </span><i><span style='font-size:9.0pt;line-height:110%;color:green'>'foo
is actually a ReturnBoolean object </span></i><span style='font-size:9.0pt;
line-height:110%'>foo = </span><b><span style='font-size:9.0pt;line-height:
110%;color:blue'>True</span></b><span style='font-size:9.0pt;line-height:110%'>
</span><i><span style='font-size:9.0pt;line-height:110%;color:green'>'True is
actually assigned to foo.ReturnValue, the class' default member</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><b><span style='font-size:9.0pt;line-height:110%;color:blue'>End</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Sub</span></b><br clear=all
style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc308776">Chapter 28: Attributes</a></h1>

<h2 style='margin-left:-.25pt'><a name="_Toc308777">Section 28.1:
VB_PredeclaredId</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Creates a Global Default Instance of a class. The default
instance is accessed via the name of the class.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:19.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=255
src="VBA%20Notes%20for%20Professionals_files/image303.gif"></span></p>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:0in;margin-left:.75pt'>Call</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="VBA%20Notes%20for%20Professionals_files/image304.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>In some ways, this simulates the behavior of static classes
in other languages, but unlike other languages, you can still create an
instance of the class.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="VBA%20Notes%20for%20Professionals_files/image305.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc308778">Section 28.2:
VB_[Var]UserMemId</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.65pt;
margin-left:.75pt'><span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>VB_VarUserMemId</span> (for module-scope variables) and <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>VB_UserMemId</span>
(for procedures) attributes are used in VBA mostly for two things.</p>

<h4 style='margin-left:.75pt'>Specifying the default member of a class</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>A <span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>List</span> class that would encapsulate a <span style='font-size:
9.0pt;line-height:110%;background:#FAFAFA'>Collection</span> would want to have
an <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Item</span>
property, so the client code can do this:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.15pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="VBA%20Notes%20for%20Professionals_files/image306.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>But with a <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>VB_UserMemId</span> attribute set to 0 on the <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Item</span>
property, the client code can do this:</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=721 height=113
src="VBA%20Notes%20for%20Professionals_files/image307.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:19.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=470
src="VBA%20Notes%20for%20Professionals_files/image308.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=58 style='width:.6in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>For</span></b><b><span style='font-size:9.0pt;line-height:
  107%'> </span></b><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Each</span></b></p>
  </td>
 </tr>
</table>

<h4 style='margin-left:.75pt'>Making a class iteratable with a loop construct</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>With the magic value <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>-4</span>, the <span style='font-size:
9.0pt;line-height:110%;background:#FAFAFA'>VB_UserMemId</span> attribute tells
VBA that this member yields an enumerator - which allows the client code to do
this:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=76
src="VBA%20Notes%20for%20Professionals_files/image309.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=58 style='width:.6in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>_NewEnum</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:14.1pt;
margin-left:.75pt'>The easiest way to implement this method is by calling the
hidden <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>[]</span>
property getter on an internal/encapsulated <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>Collection</span>; the identifier needs to
be enclosed in square brackets because of the leading underscore that makes it
an illegal VBA identifier:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Public</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Property</span></b><span style='font-size:
9.0pt;line-height:110%'> </span><b><span style='font-size:9.0pt;line-height:
110%;color:blue'>Get</span></b><span style='font-size:9.0pt;line-height:110%'>
NewEnum() </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> IUnknown</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'>Attribute
NewEnum.VB_Description = </span><span style='font-size:9.0pt;line-height:110%;
color:brown'>&quot;Gets an enumerator that iterates through the List.&quot;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'>Attribute
NewEnum.VB_UserMemId = -</span><span style='font-size:9.0pt;line-height:110%;
color:brown'>4</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:17.7pt;margin-bottom:
.25pt;margin-left:3.5pt'><span style='position:relative;z-index:-1895776256'><span
style='left:0px;position:absolute;left:0px;top:-61323px;width:718px;height:
1px'><img width=718 height=1
src="VBA%20Notes%20for%20Professionals_files/image213.gif"></span></span><span
style='font-size:9.0pt;line-height:110%'>Attribute NewEnum.VB_MemberFlags = </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>&quot;40&quot;</span><span
style='font-size:9.0pt;line-height:110%'> </span><i><span style='font-size:
9.0pt;line-height:110%;color:green'>'would hide the member in VB6. not
supported in VBA. 'Gets an enumerator that iterates through the List.</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Set</span></b><span
style='font-size:9.0pt;line-height:110%'> NewEnum = internal.[_NewEnum] </span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:23.0pt;
margin-left:3.5pt'><b><span style='font-size:9.0pt;line-height:110%;color:blue'>End</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Property</span></b></p>

<h2 style='margin-left:-.25pt'><a name="_Toc308779">Section 28.3: VB_Exposed</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>Controls the instancing characteristics of a class.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="VBA%20Notes%20for%20Professionals_files/image310.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Makes the class <b><span style='font-size:9.0pt;line-height:
110%;color:blue;background:#FAFAFA'>Private</span></b>. It cannot be accessed
outside of the current project.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.1pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="VBA%20Notes%20for%20Professionals_files/image311.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Exposes the class <b><span style='font-size:9.0pt;
line-height:110%;color:blue;background:#FAFAFA'>Public</span></b>ly, outside of
the project. However, since <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>VB_Createable</span> is ignored in VBA, instances of the
class can not be created directly. This is equivalent to a the following VB.Net
class.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=76
src="VBA%20Notes%20for%20Professionals_files/image312.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>In order to get an instance from outside the project, you
must expose a factory to create instances. One way of doing this is with a
regular <b><span style='font-size:9.0pt;line-height:110%;color:blue;background:
#FAFAFA'>Public</span></b> module.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="VBA%20Notes%20for%20Professionals_files/image313.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=86 style='width:.9in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=50 valign=top style='width:37.8pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Public</span></b><span style='font-size:9.0pt;line-height:
  107%'> </span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;background:#FAFAFA'>-</span></p>
  </td>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'></span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Not</span></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.55pt;margin-bottom:.25pt;
margin-left:.75pt;text-align:justify;text-justify:inter-ideograph;line-height:
135%'>Since public modules are accessible from other projects, this allows us
to create new instances of our <span style='font-size:9.0pt;line-height:135%;
background:#FAFAFA'>Createable</span> classes.</p>

<h2 style='margin-top:0in;margin-right:.55pt;margin-bottom:.25pt;margin-left:
.75pt;text-align:justify;text-justify:inter-ideograph;line-height:135%'><a
name="_Toc308780">Section 28.4: VB_Description</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Adds a text description to a class or module member that
becomes visible in the Object Explorer. Ideally, all public members of a public
interface / API should have a description.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=161
src="VBA%20Notes%20for%20Professionals_files/image314.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:92.8pt;margin-bottom:
0in;margin-left:.75pt;line-height:145%'>Note: all accessor members of a
property (<b><span style='font-size:9.0pt;line-height:145%;color:blue;
background:#FAFAFA'>Get</span></b>, <b><span style='font-size:9.0pt;line-height:
145%;color:blue;background:#FAFAFA'>Let</span></b>, <b><span style='font-size:
9.0pt;line-height:145%;color:blue;background:#FAFAFA'>Set</span></b>) use the
same description.</p>

<h2 style='margin-top:0in;margin-right:92.8pt;margin-bottom:0in;margin-left:
.75pt;line-height:145%'><a name="_Toc308781">Section 28.5: VB_Name</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>VB_Name specifies the class or module name.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="VBA%20Notes%20for%20Professionals_files/image315.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>A new instance of this class would be created with</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src="VBA%20Notes%20for%20Professionals_files/image316.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc308782">Section 28.6:
VB_GlobalNameSpace</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.2pt;
margin-left:.75pt'><b>In VBA, this attribute is ignored.</b> It was not ported
over from VB6.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=328 style='width:245.9pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>DateTime</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;background:#FAFAFA'>.</span></p>
  </td>
  <td width=22 valign=top style='width:16.2pt;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Now</span></p>
  </td>
  <td width=141 valign=top style='width:105.5pt;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'>) is actually part of the </p>
  </td>
  <td width=22 valign=top style='width:16.2pt;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>VBA</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;background:#FAFAFA'>.</span></p>
  </td>
  <td width=72 valign=top style='width:.75in;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Conversion</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>In VB6, it creates a Default Global Instance of the class (a
&quot;shortcut&quot;) so that class members can be accessed without using the
class name. For example, <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>DateTime</span> (as in </p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>class.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src="VBA%20Notes%20for%20Professionals_files/image317.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc308783">Section 28.7: VB_Createable</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:13.15pt;
margin-left:.75pt'><b>This attribute is ignored.</b> It was not ported over
from VB6.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>In VB6, it was used in combination with the <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>VB_Exposed</span>
attribute to control accessibility of classes outside of the current project.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src="VBA%20Notes%20for%20Professionals_files/image318.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=86 style='width:.9in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=86 valign=top style='width:.9in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Public</span></b><span style='font-size:9.0pt;line-height:
  107%'> </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Class</span></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Would result in a , that could be accessed from other
projects, but this functionality does not exist in VBA.<br clear=all
style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc308784">Chapter 29: User Forms</a></h1>

<h2 style='margin-left:-.25pt'><a name="_Toc308785">Section 29.1: Best
Practices</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>A <span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>UserForm</span> is a class module with a designer and a <b>default
instance</b>. The <i>designer</i> can be accessed by pressing</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=57 style='width:42.4pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:12.75pt'>
  <td width=57 valign=top style='width:42.4pt;border:solid black 1.0pt;
  border-left:none;padding:2.4pt .4pt 0in 0in;height:12.75pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'>Shift </p>
  </td>
 </tr>
</table>

<p class=MsoNormal align=right style='margin-top:0in;margin-right:.8pt;
margin-bottom:2.0pt;margin-left:.5pt;text-align:right;line-height:107%'>+<span
style='border:solid black 1.5pt;padding:0in'> F7 </span>while viewing the <i>code-behind</i>,
and the <i>code-behind</i> can be accessed by pressing <span style='border:
solid black 1.5pt;padding:0in'>F7 </span>while viewing</p>

<p class=MsoNormal style='margin-top:0in;margin-right:9.75pt;margin-bottom:
28.1pt;margin-left:.75pt'>the <i>designer</i>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.2pt;
margin-left:.75pt'><b>Work with a new instance every time.</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Being a <i>class module</i>, a form is therefore a <i>blueprint</i>
for an <i>object</i>. Because a form can hold state and data, it's a better
practice to work with a new <i>instance</i> of the class, rather than with the
default/global one:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=109
src="VBA%20Notes%20for%20Professionals_files/image319.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>Instead of:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=76
src="VBA%20Notes%20for%20Professionals_files/image320.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=65 style='width:48.6pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=65 valign=top style='width:48.6pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Unload </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Me</span></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:27.75pt;
margin-left:.75pt'>Working with the default instance can lead to subtle bugs
when the form is closed with the red &quot;X&quot; button and/or when is used
in the code-behind.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.2pt;
margin-left:.75pt'><b>Implement the logic elsewhere.</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.65pt;
margin-left:.75pt'>A form should be concerned with nothing but <i>presentation</i>:
a button <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Click</span>
handler that connects to a database and runs a parameterized query based on
user input, is <b>doing too many things</b>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.45pt;
margin-left:.75pt'>Instead, implement the <i>applicative logic</i> in the code
that's responsible for displaying the form, or even better, in dedicated
modules and procedures.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:27.75pt;
margin-left:.75pt'>Write the code in such a way that the UserForm is only ever
responsible for knowing how to display and collect data: where the data comes
from, or what happens with the data afterwards, is none of its concern.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.2pt;
margin-left:.75pt'><b>Caller shouldn't be bothered with controls.</b></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=86 style='width:.9in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=86 valign=top style='width:.9in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Property</span></b><span style='font-size:9.0pt;line-height:
  107%'> </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Get</span></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.45pt;
margin-left:.75pt'>Make a well-defined <i>model</i> for the form to work with,
either in its own dedicated class module, or encapsulated within the form's
code-behind itself - expose the <i>model</i> with procedures, and have the
client code work with these: this makes the form an <i>abstraction</i> over
controls and their nitty-gritty details, exposing only the relevant data to the
client code.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>This means code that looks like this:</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=37
src="VBA%20Notes%20for%20Professionals_files/image321.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=87
src="VBA%20Notes%20for%20Professionals_files/image322.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>Instead of this:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:19.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=109
src="VBA%20Notes%20for%20Professionals_files/image323.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.2pt;
margin-left:.75pt'><b>Handle the QueryClose event.</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Forms typically have a <span style='border:solid black 1.5pt;
padding:0in'>Close </span>button, and prompts/dialogs have <span
style='border:solid black 1.5pt;padding:0in'>Ok </span>and <span
style='border:solid black 1.5pt;padding:0in'>Cancel </span>buttons; the user
may close the form using the form's <i>control box</i> (the red &quot;X&quot;
button), which destroys the form instance by default (another good reason to <i>work
with a new instance every time</i>).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.15pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=720 height=109
src="VBA%20Notes%20for%20Professionals_files/image324.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>The simplest way to handle the <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>QueryClose</span> event is to set the <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Cancel</span>
parameter to <b><span style='font-size:9.0pt;line-height:110%;color:blue;
background:#FAFAFA'>True</span></b>, and then to <i>hide</i> the form instead
of <i>closing</i> it:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=76
src="VBA%20Notes%20for%20Professionals_files/image325.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:28.1pt;
margin-left:.75pt'>That way the &quot;X&quot; button will never destroy the
instance, and the caller can safely access all the public members.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.2pt;
margin-left:.75pt'><b>Hide, don't close.</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.45pt;
margin-left:.75pt'>The code that creates an object should be responsible for
destroying it: it's not the form's responsibility to unload and terminate
itself.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=299 style='width:224.05pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=65 valign=top style='width:48.6pt;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Unload </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Me</span></b></p>
  </td>
  <td width=184 valign=top style='width:137.65pt;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'>in a form's code-behind. Call </p>
  </td>
  <td width=14 valign=top style='width:.15in;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Me</span></b></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;background:#FAFAFA'>.</span></p>
  </td>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:.9pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Hide</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:27.75pt;
margin-left:.75pt'>Avoid using instead, so that the calling code can still use
the object it created when the form closes.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.2pt;
margin-left:.75pt'><b>Name things.</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.6pt;
margin-left:.75pt'>Use the <i>properties</i> toolwindow (<span
style='border:solid black 1.5pt;padding:0in'> F4 </span>) to carefully name
each control on a form. The name of a control is used in the code-behind, so
unless you're using a refactoring tool that can handle this, <b>renaming a
control will break the code</b> - so it's much easier to do things right in the
first place, than try to puzzle out exactly which of the 20 textboxes <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>TextBox12</span>
stands for.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Traditionally, UserForm controls are named with
Hungarian-style prefixes:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:166.05pt;margin-bottom:
1.5pt;margin-left:21.4pt'><img width=5 height=1
src="VBA%20Notes%20for%20Professionals_files/image166.gif" align=left
hspace=12><span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>lblUserName</span>
for a <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Label</span>
control that indicates a user name. <span style='font-size:9.0pt;line-height:
110%;background:#FAFAFA'>txtUserName</span> for a <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>TextBox</span> control where the user can
enter a user name.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:126.65pt;margin-bottom:
12.8pt;margin-left:21.4pt'><span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>cboUserName</span> for a <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>ComboBox</span> control where the user can
enter or pick a user name. <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>lstUserName</span> for a <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>ListBox</span> control where the user can
pick a user name. <span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>btnOk</span> or <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>cmdOk</span> for a <span style='font-size:9.0pt;line-height:
110%;background:#FAFAFA'>Button</span> control labelled &quot;Ok&quot;.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.65pt;
margin-left:.75pt'>The problem is that when e.g. the UI gets redesigned and a <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>ComboBox</span>
changes to a <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>ListBox</span>,
the name needs to change to reflect the new control type: it's better to name
controls for what they represent, rather than after their control type - to <i>decouple</i>
the code from the UI as much as possible.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:21.4pt'><img width=5 height=1
src="VBA%20Notes%20for%20Professionals_files/image166.gif" align=left
hspace=12><span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>UserNameLabel</span>
for a read-only label that indicates a user name.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:118.45pt;margin-bottom:
12.55pt;margin-left:21.4pt'><span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>UserNameInput</span> for a control where the user can enter
or pick a user name. <span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>OkButton</span> for a command button labelled &quot;Ok&quot;.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:15.8pt;margin-bottom:
.25pt;margin-left:.75pt;text-align:justify;text-justify:inter-ideograph;
line-height:135%'>Whichever style is chosen, anything is better than leaving
all controls their default names. Consistency in naming style is ideal, too.</p>

<h2 style='margin-top:0in;margin-right:15.8pt;margin-bottom:.25pt;margin-left:
.75pt;text-align:justify;text-justify:inter-ideograph;line-height:135%'><a
name="_Toc308786">Section 29.2: Handling QueryClose</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.4pt;
margin-left:.75pt'>The <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>QueryClose</span> event is raised whenever a form is about
to be closed, whether it's via user action or programmatically. The <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>CloseMode</span>
parameter contains a <span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>VbQueryClose</span> enum value that indicates how the form was closed:</p>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:.75pt;margin-left:
0in;text-indent:0in'><span style='font-size:11.0pt;line-height:110%;font-weight:
normal'> </span>Constant Description Value</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:129.4pt;margin-bottom:
11.5pt;margin-left:.75pt;line-height:145%'><span style='font-size:9.0pt;
line-height:145%;background:#FAFAFA'>vbFormControlMenu </span>Form is closing
in response to user action 0 <span style='font-size:9.0pt;line-height:145%;
background:#FAFAFA'>vbFormCode </span>Form is closing in response to an
<span style='font-size:9.0pt;line-height:145%;background:#FAFAFA'>Unload</span>
statement 1 <span style='font-size:9.0pt;line-height:145%;background:#FAFAFA'>vbAppWindows </span>Windows
session is ending 2 <span style='font-size:9.0pt;line-height:
145%;background:#FAFAFA'>vbAppTaskManager </span>Windows Task Manager is
closing the host application 3 <span style='font-size:9.0pt;line-height:145%;
background:#FAFAFA'>vbFormMDIForm </span>Not supported in VBA 4</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:28.1pt;
margin-left:.75pt'>For better readability, it's best to use these constants
instead of using their value directly.</p>

<h4 style='margin-left:.75pt'>A Cancellable UserForm</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>Given a form with a <span style='border:solid black 1.5pt;
padding:0in'>Cancel </span>button</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><img border=0 width=370
height=253 id="Picture 21697"
src="VBA%20Notes%20for%20Professionals_files/image326.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>The form's code-behind could look like this:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=634
src="VBA%20Notes%20for%20Professionals_files/image327.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>The calling code could then display the form, and know
whether it was cancelled:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.1pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=191
src="VBA%20Notes%20for%20Professionals_files/image328.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>The <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>IsCancelled</span> property returns <b><span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>True</span></b>
when the <span style='border:solid black 1.5pt;padding:0in'>Cancel </span>button
is clicked, or when the user closes the form using the <i>control box</i>.</p>

<h1 style='margin-left:-.25pt'><a name="_Toc308787">Chapter 30: Object-Oriented
VBA</a></h1>

<h2 style='margin-left:-.25pt'><a name="_Toc308788">Section 30.1: Abstraction</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.2pt;
margin-left:.75pt'><b>Abstraction levels help determine when to split things
up.</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Abstraction is achieved by implementing functionality with
increasingly detailed code. The entry point of a macro should be a small
procedure with a <i>high abstraction level</i> that makes it easy to grasp at a
glance what's going on:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=142
src="VBA%20Notes%20for%20Professionals_files/image329.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>The <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>DoSomething</span> procedure has a high <i>abstraction
level</i>: we can tell that it's displaying a form and creating some model, and
passing that object to some <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>ProcessUserData</span> procedure that knows what to do with
it - how the model is created is the job of another procedure:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=109
src="VBA%20Notes%20for%20Professionals_files/image330.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>The <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>CreateViewModel</span> function is only responsible for
creating some <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>ISomeModel</span>
instance. Part of that responsibility is to acquire an array of <i>available
items</i> - how these items are acquired is an implementation detail that's
abstracted behind the <span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>GetAvailableItems</span> procedure:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="VBA%20Notes%20for%20Professionals_files/image331.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:8.9pt;margin-bottom:.25pt;
margin-left:.75pt;text-align:justify;text-justify:inter-ideograph;line-height:
135%'>Here the procedure is reading the available values from a named range on
a <span style='font-size:9.0pt;line-height:135%;background:#FAFAFA'>DataSheet</span>
worksheet. It could just as well be reading them from a database, or the values
could be hard-coded: it's an <i>implementation detail</i> that's none of a
concern for any of the higher abstraction levels.</p>

<h2 style='margin-top:0in;margin-right:8.9pt;margin-bottom:.25pt;margin-left:
.75pt;text-align:justify;text-justify:inter-ideograph;line-height:135%'><a
name="_Toc308789">Section 30.2: Encapsulation</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.2pt;
margin-left:.75pt'><b>Encapsulation hides implementation details from client
code.</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.45pt;
margin-left:.75pt'>The Handling QueryClose example demonstrates encapsulation:
the form has a checkbox control, but its client code doesn't work with it
directly - the checkbox is an <i>implementation detail</i>, what the client
code needs to know is whether the setting is enabled or not.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>When the checkbox value changes, the handler assigns a
private field member:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:15.75pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=668 height=77
src="VBA%20Notes%20for%20Professionals_files/image332.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:15.75pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=668 height=138
src="VBA%20Notes%20for%20Professionals_files/image333.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>And when the client code wants to read that value, it
doesn't need to worry about a checkbox - instead it simply uses the <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>SomeOtherSetting</span>
property:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.1pt;
margin-left:15.75pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=668 height=61
src="VBA%20Notes%20for%20Professionals_files/image334.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:27.7pt;
margin-left:.75pt'>The <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>SomeOtherSetting</span> property <i>encapsulates</i> the
checkbox' state; client code doesn't need to know that there's a checkbox
involved, only that there's a setting with a Boolean value. By <i>encapsulating</i>
the <span style='font-size:9.0pt;line-height:110%;color:slateblue;background:
#FAFAFA'>Boolean</span> value, we've added an <i>abstraction layer</i> around
the checkbox.</p>

<h4 style='margin-left:.75pt'>Using interfaces to enforce immutability</h4>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=563 style='width:422.55pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=108 valign=top style='width:81.0pt;background:#FAFAFA;padding:1.2pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Public</span></b><span style='font-size:9.0pt;line-height:
  107%'> </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Property</span></b></p>
  </td>
  <td width=369 valign=top style='width:276.75pt;padding:1.2pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'>for the <span style='font-size:9.0pt;
  line-height:107%;background:#FAFAFA'>UserName</span> and <span
  style='font-size:9.0pt;line-height:107%;background:#FAFAFA'>Timestamp</span>,
  we would have to expose </p>
  </td>
  <td width=86 valign=top style='width:.9in;background:#FAFAFA;padding:1.2pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Property</span></b><span style='font-size:9.0pt;line-height:
  107%'> </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Let</span></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.95pt;
margin-left:.75pt'>Let's push that a step further by <i>encapsulating</i> the
form's <i>model</i> in a dedicated class module. But if we made a accessors,
making the properties mutable, and we don't want the client code to have the
ability to change these values after they're set.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>The <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>CreateViewModel</span> function in the <b>Abstraction</b>
example returns an <span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>ISomeModel</span> class: that's our <i>interface</i>, and it looks
something like this:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.25pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=421
src="VBA%20Notes%20for%20Professionals_files/image335.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=86 style='width:.9in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=86 valign=top style='width:.9in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Property</span></b><span style='font-size:9.0pt;line-height:
  107%'> </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Get</span></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Notice <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>Timestamp</span> and <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>UserName</span> properties only expose a
accessor. Now the <span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>SomeModel</span> class can implement that interface:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
0in;margin-left:-.45pt;text-indent:0in;line-height:107%'><img border=0
width=719 height=1029 id="Picture 302192"
src="VBA%20Notes%20for%20Professionals_files/image336.gif"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=350
src="VBA%20Notes%20for%20Professionals_files/image337.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:28.0pt;
margin-left:.75pt'>The interface members are all <b><span style='font-size:
9.0pt;line-height:110%;color:blue;background:#FAFAFA'>Private</span></b>, and
all members of the interface must be implemented for the code to compile. The <b><span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>Public</span></b>
members are not part of the interface, and are therefore not exposed to code
written against the <span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>ISomeModel</span> interface.</p>

<h4 style='margin-left:.75pt'>Using a Factory Method to simulate a constructor</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Using a VB_PredeclaredId attribute, we can make the <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>SomeModel</span>
class have a <i>default instance</i>, and write a function that works like a
type-level (<b><span style='font-size:9.0pt;line-height:110%;color:blue;
background:#FAFAFA'>Shared</span></b> in VB.NET, <b><span style='font-size:
9.0pt;line-height:110%;color:blue;background:#FAFAFA'>static</span></b> in C#)
member that the client code can call without needing to first create an
instance, like we did here:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.05pt;
margin-left:15.75pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=668 height=110
src="VBA%20Notes%20for%20Professionals_files/image338.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>This <i>factory method</i> assigns the property values that
are read-only when accessed from the <span style='font-size:9.0pt;line-height:
110%;background:#FAFAFA'>ISomeModel</span> interface,</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=221
src="VBA%20Notes%20for%20Professionals_files/image339.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>And now we can code against the <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>ISomeModel</span> interface, which exposes
<span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Timestamp</span>
and <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>UserName</span>
as read-only properties that can never be reassigned (as long as the code is
written against the interface).</p>

<h2 style='margin-left:-.25pt'><a name="_Toc308790">Section 30.3: Polymorphism</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.2pt;
margin-left:.75pt'><b>Polymorphism is the ability to present the same interface
for different underlying implementations.</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.6pt;
margin-left:.75pt'>The ability to implement interfaces allows completely
decoupling the application logic from the UI, or from the database, or from
this or that worksheet.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>Say you have an <span style='font-size:9.0pt;line-height:
110%;background:#FAFAFA'>ISomeView</span> interface that the form itself
implements:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=223
src="VBA%20Notes%20for%20Professionals_files/image340.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>The form's code-behind could look like this:</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=590
src="VBA%20Notes%20for%20Professionals_files/image341.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=202
src="VBA%20Notes%20for%20Professionals_files/image342.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>But then, nothing forbids creating another class module that
implements the <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>ISomeView</span>
interface <i>without being a user form</i> - this could be a <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>SomeViewMock</span>
class:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.1pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=535
src="VBA%20Notes%20for%20Professionals_files/image343.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>And now we can change the code that works with a <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>UserForm</span> and
make it work off the <span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>ISomeView</span> interface, e.g. by giving it the form as a parameter
instead of instantiating it:</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=142
src="VBA%20Notes%20for%20Professionals_files/image344.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=115 style='width:1.2in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>view</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;background:#FAFAFA'>.</span></p>
  </td>
  <td width=79 valign=top style='width:59.4pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>IsCancelled</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:9.65pt;margin-bottom:
28.0pt;margin-left:.75pt'>Because the <span style='font-size:9.0pt;line-height:
110%;background:#FAFAFA'>DoSomething</span> method depends on an interface
(i.e. an <i>abstraction</i>) and not a <i>concrete class</i> (e.g. a specific <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>UserForm</span>),
we can write an automated unit test that ensures that <span style='font-size:
9.0pt;line-height:110%;background:#FAFAFA'>ProcessUserData</span> isn't
executed when is <b><span style='font-size:9.0pt;line-height:110%;color:blue;
background:#FAFAFA'>True</span></b>, by making our test create a <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>SomeViewMock</span>
instance, setting its <span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>IsCancelled</span> property to <b><span style='font-size:9.0pt;
line-height:110%;color:blue;background:#FAFAFA'>True</span></b>, and passing it
to <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>DoSomething</span>.</p>

<h4 style='margin-left:.75pt'>Testable code depends on abstractions</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.45pt;
margin-left:.75pt'>Writing unit tests in VBA can be done, there are add-ins out
there that even integrate it into the IDE. But when code is <i>tightly coupled</i>
with a worksheet, a database, a form, or the file system, then the unit test
starts requiring an actual worksheet, database, form, or file system - and
these <i>dependencies</i> are new out-of-control failure points that testable
code should isolate, so that unit tests <i>don't</i> require an actual
worksheet, database, form, or file system.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>By writing code against interfaces, in a way that allows
test code to <i>inject</i> stub/mock implementations (like the above <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>SomeViewMock</span>
example), you can write tests in a &quot;controlled environment&quot;, and
simulate what happens when every single one of the 42 possible permutations of
user interactions on the form's data, without even once displaying a form and
manually clicking on a form control.<br clear=all style='page-break-before:
always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc308791">Chapter 31: Working With
Files and Directories Without Using FileSystemObject</a></h1>

<h2 style='margin-left:-.25pt'><a name="_Toc308792">Section 31.1: Determining
If Folders and Files Exist</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.2pt;
margin-left:.75pt'><b>Files:</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>To determine if a file exists, simply pass the filename to
the <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Dir$</span>
function and test to see if it returns a result. Note that <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Dir$</span>
supports wild-cards, so to test for a <i>specific</i> file, the passed <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>pathName</span>
should to be tested to ensure that it does not contain them. The sample below
raises an error - if this isn't the desired behavior, the function can be
changed to simply return <b><span style='font-size:9.0pt;line-height:110%;
color:blue;background:#FAFAFA'>False</span></b>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=125
src="VBA%20Notes%20for%20Professionals_files/image345.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.2pt;
margin-left:.75pt'><b>Folders (Dir$ method):</b></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=29 style='width:.3in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:#000066'>Dir$</span></p>
  </td>
 </tr>
</table>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=144 style='width:1.5in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=144 valign=top style='width:1.5in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>On</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Error</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Resume</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Next</span></b></p>
  </td>
 </tr>
</table>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=72 style='width:.75in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=72 valign=top style='width:.75in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>..\Foo\Bar</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>The <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>()</span> function can also be used to determine if a
folder exists by specifying passing <span style='font-size:9.0pt;line-height:
110%;background:#FAFAFA'>vbDirectory</span> for the optional <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>attributes</span>
parameter. In this case, the passed <span style='font-size:9.0pt;line-height:
110%;background:#FAFAFA'>pathName</span> value must end with a path separator (<span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>\</span>), as
matching <i>filenames</i> will cause false positives. Keep in mind that
wild-cards are only allowed after the last path separator, so the example
function below will throw a run-time error 52 - &quot;Bad file name or
number&quot; if the input contains a wild-card. If this isn't the desired
behavior, uncomment at the top of the function. Also remember that <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Dir$</span>
supports relative file paths (i.e. ), so results are only guaranteed to be
valid as long as the current working directory is not changed.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=720 height=158
src="VBA%20Notes%20for%20Professionals_files/image346.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.2pt;
margin-left:.75pt'><b>Folders (ChDir method):</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>The <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>ChDir</span> statement can also be used to test if a folder
exists. Note that this method will temporarily change the environment that VBA
is running in, so if that is a consideration, the <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>Dir$</span> method should be used instead.
It does have the advantage of being much less forgiving with its parameter.
This method also supports relative file paths, so has the same caveat as the <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Dir$</span> method.</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=107
src="VBA%20Notes%20for%20Professionals_files/image347.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=104
src="VBA%20Notes%20for%20Professionals_files/image348.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc308793">Section 31.2: Creating and
Deleting File Folders</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.75pt;
margin-left:.75pt'><b>NOTE:</b> For brevity, the examples below use the
FolderExists function from the <b>Determining If Folders and Files Exist</b>
example in this topic.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=43 style='width:.45in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=43 valign=top style='width:.45in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>..\Foo</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.6pt;
margin-left:.75pt'>The <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>MkDir</span> statement can be used to create a new folder.
It accepts paths containing drive letters (<span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>C:\Foo</span>), UNC names (<span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>\\Server\Foo</span>),
relative paths (), or the current working directory (<span style='font-size:
9.0pt;line-height:110%;background:#FAFAFA'>Foo</span>).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>If the drive or UNC name is omitted (i.e. <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>\Foo</span>), the
folder is created on the current drive. This may or may not be the same drive
as the current working directory.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=109
src="VBA%20Notes%20for%20Professionals_files/image349.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>The <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>RmDir</span> statement can be used to delete existing
folders. It accepts paths in the same forms as <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>MkDir</span> and uses the same
relationship to the current working directory and drive. Note that the
statement is similar to the Windows <span style='font-size:9.0pt;line-height:
110%;background:#FAFAFA'>rd</span> shell command, so will throw a run-time
error 75: &quot;Path/File access error&quot; if the target directory is not
empty.</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=339
src="VBA%20Notes%20for%20Professionals_files/image350.gif"></span></p>

<h1 style='margin-left:-.25pt'><a name="_Toc308794">Chapter 32: Operators</a></h1>

<h2 style='margin-left:-.25pt'><a name="_Toc308795">Section 32.1: Concatenation
Operators</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.7pt;
margin-left:.75pt'>VBA supports 2 different concatenation operators, <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>+</span> and <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>&amp;</span> and
both perform the exact same function when used with <span style='font-size:
9.0pt;line-height:110%;color:slateblue;background:#FAFAFA'>String</span> types
- the right-hand <span style='font-size:9.0pt;line-height:110%;color:slateblue;
background:#FAFAFA'>String</span> is appended to the end of the left-hand <span
style='font-size:9.0pt;line-height:110%;color:slateblue;background:#FAFAFA'>String</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.5pt;
margin-left:.75pt'>If the <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>&amp;</span> operator is used with a variable type other
than a <span style='font-size:9.0pt;line-height:110%;color:slateblue;
background:#FAFAFA'>String</span>, it is implicitly cast to a <span
style='font-size:9.0pt;line-height:110%;color:slateblue;background:#FAFAFA'>String</span>
before being concatenated.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Note that the <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>+</span> concatenation operator is an overload of the <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>+</span> addition
operator. The behavior of <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>+</span> is determined by the variable types of the
operands and precedence of operator types. If both operands are typed as a <span
style='font-size:9.0pt;line-height:110%;color:slateblue;background:#FAFAFA'>String</span>
or <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Variant</span>
with a sub-type of <span style='font-size:9.0pt;line-height:110%;color:slateblue;
background:#FAFAFA'>String</span>, they are concatenated:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=158
src="VBA%20Notes%20for%20Professionals_files/image351.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>If <i>either</i> side is a numeric type and the other side
is a <span style='font-size:9.0pt;line-height:110%;color:slateblue;background:
#FAFAFA'>String</span> that can be coerced into a number, the type precedence
of mathematical operators causes the operator to be treated as the addition
operator and the numeric values are added:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=158
src="VBA%20Notes%20for%20Professionals_files/image352.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:18.2pt;
margin-left:.75pt'>This behavior can lead to subtle, hard to debug errors -
especially if <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Variant</span>
types are being used, so only the <span style='font-size:9.0pt;line-height:
110%;background:#FAFAFA'>&amp; </span>operator should typically be used for
concatenation.</p>

<h2 style='margin-left:-.25pt'><a name="_Toc308796">Section 32.2: Comparison
Operators</a></h2>

<h4 style='margin:0in;text-indent:0in'>Token Name<span style='font-family:"Arial",sans-serif;
font-weight:normal'>  </span>Description</h4>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=711
 style='width:533.5pt;margin-left:1.0pt;border-collapse:collapse'>
 <tr style='height:25.8pt'>
  <td width=44 style='width:32.65pt;padding:.05pt 0in 0in 0in;height:25.8pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:9.0pt;line-height:107%;background:#FAFAFA'>=</span></p>
  </td>
  <td width=668 valign=top style='width:500.85pt;padding:.05pt 0in 0in 0in;
  height:25.8pt'>
  <p class=MsoNormal align=right style='margin-top:0in;margin-right:3.45pt;
  margin-bottom:0in;margin-left:0in;text-align:right;text-indent:0in;
  line-height:107%'>Returns <b><span style='font-size:9.0pt;line-height:107%;
  color:blue;background:#FAFAFA'>True</span></b> if the left-hand and
  right-hand operands are equal. Note that this is an</p>
  <p class=MsoNormal style='margin-top:0in;margin-right:220.25pt;margin-bottom:
  0in;margin-left:106.95pt;text-indent:-106.95pt;line-height:107%'>Equal to
  overload of the assignment operator.</p>
  </td>
 </tr>
 <tr style='height:16.85pt'>
  <td width=44 valign=top style='width:32.65pt;padding:.05pt 0in 0in 0in;
  height:16.85pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:9.0pt;line-height:107%;color:#666666;background:#FAFAFA'>&lt;</span><b><span
  style='font-size:9.0pt;line-height:107%;background:#FAFAFA'>&gt;</span></b>&nbsp;</p>
  </td>
  <td width=668 valign=top style='width:500.85pt;padding:.05pt 0in 0in 0in;
  height:16.85pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Not
  equal to Returns <b><span style='font-size:
  9.0pt;line-height:107%;color:blue;background:#FAFAFA'>True</span></b> if the
  left-hand and right-hand operands are not equal.</p>
  </td>
 </tr>
 <tr style='height:16.9pt'>
  <td width=44 valign=top style='width:32.65pt;padding:.05pt 0in 0in 0in;
  height:16.9pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:9.0pt;line-height:107%;background:#FAFAFA'>&gt;</span>&nbsp;</p>
  </td>
  <td width=668 valign=top style='width:500.85pt;padding:.05pt 0in 0in 0in;
  height:16.9pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Greater
  than Returns <b><span style='font-size:
  9.0pt;line-height:107%;color:blue;background:#FAFAFA'>True</span></b> if the
  left-hand operand is greater than the right-hand operand.</p>
  </td>
 </tr>
 <tr style='height:16.9pt'>
  <td width=44 valign=top style='width:32.65pt;padding:.05pt 0in 0in 0in;
  height:16.9pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:9.0pt;line-height:107%;background:#FAFAFA'>&lt;</span>&nbsp;</p>
  </td>
  <td width=668 valign=top style='width:500.85pt;padding:.05pt 0in 0in 0in;
  height:16.9pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Less
  than Returns <b><span
  style='font-size:9.0pt;line-height:107%;color:blue;background:#FAFAFA'>True</span></b>
  if the left-hand operand is less than the right-hand operand.</p>
  </td>
 </tr>
 <tr style='height:28.9pt'>
  <td width=44 style='width:32.65pt;padding:.05pt 0in 0in 0in;height:28.9pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:9.0pt;line-height:107%;background:#FAFAFA'>&gt;=</span></p>
  </td>
  <td width=668 valign=top style='width:500.85pt;padding:.05pt 0in 0in 0in;
  height:28.9pt'>
  <p class=MsoNormal align=right style='margin:0in;text-align:right;text-indent:
  0in;line-height:107%'>Returns <b><span style='font-size:9.0pt;line-height:
  107%;color:blue;background:#FAFAFA'>True</span></b> if the if the left-hand
  operand is greater than or equal to the right-hand</p>
  <p class=MsoNormal style='margin-top:0in;margin-right:351.55pt;margin-bottom:
  0in;margin-left:106.95pt;text-indent:-106.95pt;line-height:107%'>Greater than
  or equal operand.</p>
  </td>
 </tr>
 <tr style='height:25.8pt'>
  <td width=44 style='width:32.65pt;padding:.05pt 0in 0in 0in;height:25.8pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:9.0pt;line-height:107%;background:#FAFAFA'>&lt;=</span></p>
  </td>
  <td width=668 valign=top style='width:500.85pt;padding:.05pt 0in 0in 0in;
  height:25.8pt'>
  <p class=MsoNormal align=right style='margin-top:0in;margin-right:16.25pt;
  margin-bottom:0in;margin-left:0in;text-align:right;text-indent:0in;
  line-height:107%'>Returns <b><span style='font-size:9.0pt;line-height:107%;
  color:blue;background:#FAFAFA'>True</span></b> if the if the left-hand
  operand is less than or equal to the right-hand</p>
  <p class=MsoNormal style='margin-top:0in;margin-right:351.55pt;margin-bottom:
  0in;margin-left:106.95pt;text-indent:-106.95pt;line-height:107%'>Less than or
  equal operand.</p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:141.1pt'>Returns <b><span style='font-size:9.0pt;line-height:110%;
color:blue;background:#FAFAFA'>True</span></b> if the left-hand object
reference is the same instance as the right-hand object reference. It can also
be used with <b><span style='font-size:9.0pt;line-height:110%;color:blue;
background:#FAFAFA'>Nothing</span></b> (the null object reference) on either
side. <b>Note:</b> The <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>Is</span> operator will attempt to coerce both operands
into an</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:141.1pt'><span style='font-size:9.0pt;line-height:110%;color:slateblue;
background:#FAFAFA'>Object</span> before performing the comparison. If either
side is a primitive type <i>or</i> a</p>

<p class=MsoNormal style='margin-top:0in;margin-right:4.8pt;margin-bottom:0in;
margin-left:139.85pt;text-indent:-139.6pt'><span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>Is </span>Reference
equity <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Variant</span>
that does not contain an object (either a non-object subtype or <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>vtEmpty</span>),
the comparison will result in a Run-time error 424 - &quot;Object
required&quot;. If either operand belongs to a different <i>interface</i> of
the same object, the comparison will return <b><span style='font-size:9.0pt;
line-height:110%;color:blue;background:#FAFAFA'>True</span></b>. If you need to
test for equity of both the instance <i>and</i> the interface, use</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=79 style='width:59.4pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=43 valign=top style='width:.45in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>ObjPtr</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;background:#FAFAFA'>(</span></p>
  </td>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>left</span></p>
  </td>
 </tr>
</table>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=94 style='width:70.2pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=50 valign=top style='width:37.8pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>ObjPtr</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;background:#FAFAFA'>(</span></p>
  </td>
  <td width=36 valign=top style='width:27.0pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>right</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:19.35pt;
margin-bottom:20.2pt;margin-left:12.65pt;text-align:center;line-height:103%'><span
style='position:relative;z-index:-1895773184'><span style='left:0px;position:
absolute;left:274px;top:-75841px;width:7px;height:1px'><img width=7 height=1
src="VBA%20Notes%20for%20Professionals_files/image126.gif"></span></span><span
style='font-size:9.0pt;line-height:103%;background:#FAFAFA'>)</span><span
style='font-size:9.0pt;line-height:103%'> <span style='background:#FAFAFA'>=)</span></span>
instead.</p>

<h4 style='margin-left:.75pt'>Notes</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>The VBA syntax allows for &quot;chains&quot; of comparison
operators, but these constructs should generally be avoided. Comparisons are
always performed from left to right on only 2 operands at a time, and each
comparison results in a <span style='font-size:9.0pt;line-height:110%;
color:slateblue;background:#FAFAFA'>Boolean</span>. For example, the
expression...</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src="VBA%20Notes%20for%20Professionals_files/image353.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>...may be read in some contexts as a test of whether <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>b</span> is between
<span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>a</span> and <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>c</span>. In VBA,
this evaluates as follows:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=109
src="VBA%20Notes%20for%20Professionals_files/image354.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.5pt;
margin-left:.75pt'>Any comparison operator other than <span style='font-size:
9.0pt;line-height:110%;background:#FAFAFA'>Is</span> used with an <span
style='font-size:9.0pt;line-height:110%;color:slateblue;background:#FAFAFA'>Object</span>
as an operand will be performed on the return value of the <span
style='font-size:9.0pt;line-height:110%;color:slateblue;background:#FAFAFA'>Object</span>'s
default member. If the object does not have a default member, the comparison
will result in a Runtime error 438 - &quot;Object doesn't support his property
or method&quot;.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.55pt;
margin-left:.75pt'>If the <span style='font-size:9.0pt;line-height:110%;
color:slateblue;background:#FAFAFA'>Object</span> is unintitialized, the
comparison will result in a Run-time error 91 - &quot;Object variable or With
block variable not set&quot;.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.55pt;
margin-left:.75pt'>If the literal <b><span style='font-size:9.0pt;line-height:
110%;color:blue;background:#FAFAFA'>Nothing</span></b> is used with any
comparison operator other than <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>Is</span>, it will result in a Compile error -
&quot;Invalid use of object&quot;.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>If the default member of the <span style='font-size:9.0pt;
line-height:110%;color:slateblue;background:#FAFAFA'>Object</span> is <i>another
</i><i><span style='font-size:9.0pt;line-height:110%;color:slateblue;
background:#FAFAFA'>Object</span></i>, VBA will continually call the default
member of each successive return value until a primitive type is returned or an
error is raised. For example, assume <span style='font-size:9.0pt;line-height:
110%;background:#FAFAFA'>SomeClass</span> has a default member of <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Value</span>, which
is an instance of <span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>ChildClass</span> with a default member of <span style='font-size:
9.0pt;line-height:110%;background:#FAFAFA'>ChildValue</span>. The comparison...</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src="VBA%20Notes%20for%20Professionals_files/image355.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>...will be evaluated as:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.15pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src="VBA%20Notes%20for%20Professionals_files/image356.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.85pt;
margin-left:.75pt'>If either operand is a numeric type and the <i>other</i>
operand is a <span style='font-size:9.0pt;line-height:110%;color:slateblue;
background:#FAFAFA'>String</span> or <span style='font-size:9.0pt;line-height:
110%;background:#FAFAFA'>Variant</span> of subtype <span style='font-size:9.0pt;
line-height:110%;color:slateblue;background:#FAFAFA'>String</span>, a numeric
comparison will be performed. In this case, if the <span style='font-size:9.0pt;
line-height:110%;color:slateblue;background:#FAFAFA'>String</span> cannot be
cast to a number, a Run-time error 13 - &quot;Type mismatch&quot; will result
from the comparison.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.55pt;margin-bottom:.25pt;
margin-left:.75pt;text-align:justify;text-justify:inter-ideograph;line-height:
135%'>If <b><i>both</i></b> operands are a <span style='font-size:9.0pt;
line-height:135%;color:slateblue;background:#FAFAFA'>String</span> or a <span
style='font-size:9.0pt;line-height:135%;background:#FAFAFA'>Variant</span> of
subtype <span style='font-size:9.0pt;line-height:135%;color:slateblue;
background:#FAFAFA'>String</span>, a string comparison will be performed based
on the Option Compare setting of the code module. These comparisons are
performed on a character by character basis. Note that the <i>character
representation</i> of a <span style='font-size:9.0pt;line-height:135%;
color:slateblue;background:#FAFAFA'>String</span> containing a number is <b><i>not</i></b>
the same as a comparison of the numeric values:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.1pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=158
src="VBA%20Notes%20for%20Professionals_files/image357.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.5pt;
margin-left:.75pt'>For this reason, make sure that <span style='font-size:9.0pt;
line-height:110%;color:slateblue;background:#FAFAFA'>String</span> or <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Variant</span>
variables are cast to numbers before performing numeric inequity comparisons on
them.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.65pt;
margin-left:.75pt'>If one operand is a <span style='font-size:9.0pt;line-height:
110%;color:slateblue;background:#FAFAFA'>Date</span>, a numeric comparison on
the underlying Double value will be performed if the other operand is numeric
or can be cast to a numeric type.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.55pt;
margin-left:.75pt'>If the other operand is a <span style='font-size:9.0pt;
line-height:110%;color:slateblue;background:#FAFAFA'>String</span> or a <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Variant</span> of
subtype <span style='font-size:9.0pt;line-height:110%;color:slateblue;
background:#FAFAFA'>String</span> that can be cast to a <span style='font-size:
9.0pt;line-height:110%;color:slateblue;background:#FAFAFA'>Date</span> using
the current locale, the <span style='font-size:9.0pt;line-height:110%;
color:slateblue;background:#FAFAFA'>String</span> will be cast to a <span
style='font-size:9.0pt;line-height:110%;color:slateblue;background:#FAFAFA'>Date</span>.
If it cannot be cast to a <span style='font-size:9.0pt;line-height:110%;
color:slateblue;background:#FAFAFA'>Date</span> in the current locale, a
Run-time error 13 - &quot;Type mismatch&quot; will result from the comparison.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Care should be taken when making comparisons between <span
style='font-size:9.0pt;line-height:110%;color:slateblue;background:#FAFAFA'>Double</span>
or <span style='font-size:9.0pt;line-height:110%;color:slateblue;background:
#FAFAFA'>Single</span> values and Booleans. Unlike other numeric types,
non-zero values cannot be assumed to be <b><span style='font-size:9.0pt;
line-height:110%;color:blue;background:#FAFAFA'>True</span></b> due to VBA's
behavior of promoting the data type of a comparison involving a floating point
number to <span style='font-size:9.0pt;line-height:110%;color:slateblue;
background:#FAFAFA'>Double</span>:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=191
src="VBA%20Notes%20for%20Professionals_files/image358.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc308797">Section 32.3: Bitwise \
Logical Operators</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.45pt;
margin-left:.75pt'>All of the logical operators in VBA can be thought of as
&quot;overrides&quot; of the bitwise operators of the same name. Technically,
they are <i>always</i> treated as bitwise operators. All of the comparison
operators in VBA return a Boolean, which will always have none of its bits set
(<b><span style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>False</span></b>)
or <i>all</i> of its bits set (<b><span style='font-size:9.0pt;line-height:
110%;color:blue;background:#FAFAFA'>True</span></b>). But it will treat a value
with <i>any</i> bit set as <b><span style='font-size:9.0pt;line-height:110%;
color:blue;background:#FAFAFA'>True</span></b>. This means that the result of
the casting the bitwise result of an expression to a <span style='font-size:
9.0pt;line-height:110%;color:slateblue;background:#FAFAFA'>Boolean</span> (see
Comparison Operators) will always be the same as treating it as a logical
expression.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:4.3pt;margin-bottom:6.75pt;
margin-left:.75pt;line-height:172%'>Assigning the result of an expression using
one of these operators will give the bitwise result. Note that in the truth
tables below, <span style='font-size:9.0pt;line-height:172%;background:#FAFAFA'>0</span>
is equivalent to <b><span style='font-size:9.0pt;line-height:172%;color:blue;
background:#FAFAFA'>False</span></b> and <span style='font-size:9.0pt;
line-height:172%;background:#FAFAFA'>1</span> is equivalent to <b><span
style='font-size:9.0pt;line-height:172%;color:blue;background:#FAFAFA'>True</span></b>.
<b><span style='font-size:9.0pt;line-height:172%;color:blue;background:#FAFAFA'>And</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.9pt;
margin-left:.75pt'>Returns <b><span style='font-size:9.0pt;line-height:110%;
color:blue;background:#FAFAFA'>True</span></b> if the expressions on both sides
evaluate to <b><span style='font-size:9.0pt;line-height:110%;color:blue;
background:#FAFAFA'>True</span></b>.</p>

<h4 style='margin-left:.75pt'>Left-hand Operand Right-hand Operand Result</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:4.1pt;
margin-left:0in;text-indent:0in'>0 0 0</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:4.2pt;
margin-left:97.05pt;text-indent:-96.8pt'><span style='line-height:110%'>0<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>1 0</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:4.3pt;
margin-left:97.05pt;text-indent:-96.8pt'><span style='line-height:110%'>1<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>0 0</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.95pt;
margin-left:0in;text-indent:0in'>1 1 1</p>

<p class=MsoNormal style='margin-top:0in;margin-right:17.75pt;margin-bottom:
13.85pt;margin-left:-.25pt;line-height:107%'><span style='font-size:9.0pt;
line-height:107%;background:#FAFAFA'>Or</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.9pt;
margin-left:.75pt'>Returns <b><span style='font-size:9.0pt;line-height:110%;
color:blue;background:#FAFAFA'>True</span></b> if either side of the expression
evaluates to <b><span style='font-size:9.0pt;line-height:110%;color:blue;
background:#FAFAFA'>True</span></b>.</p>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:.7pt;margin-left:.75pt'>Left-hand
Operand Right-hand Operand Result</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:4.3pt;
margin-left:0in;text-indent:0in'>0 0 0</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:4.2pt;
margin-left:97.05pt;text-indent:-96.8pt'><span style='line-height:110%'>0<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>1 1</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:4.1pt;
margin-left:97.05pt;text-indent:-96.8pt'><span style='line-height:110%'>1<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>0 1</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.95pt;
margin-left:0in;text-indent:0in'>1 1 1</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><b><span style='font-size:
9.0pt;line-height:107%;color:blue;background:#FAFAFA'>Not</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.95pt;
margin-left:.75pt'>Returns <b><span style='font-size:9.0pt;line-height:110%;
color:blue;background:#FAFAFA'>True</span></b> if the expression evaluates to <b><span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>False</span></b>
and <b><span style='font-size:9.0pt;line-height:110%;color:blue;background:
#FAFAFA'>False</span></b> if the expression evaluations to <b><span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>True</span></b>.</p>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:1.0pt;margin-left:
.75pt'>Right-hand Operand Result</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:3.95pt;
margin-left:103.45pt;text-indent:-103.2pt'><span style='line-height:110%'>0<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>1</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:15.4pt;
margin-left:103.45pt;text-indent:-103.2pt'><span style='line-height:110%'>1<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>0</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'><b><span style='font-size:9.0pt;line-height:110%;color:blue;
background:#FAFAFA'>Not</span></b> is the only operand without a Left-hand
operand. The Visual Basic Editor will automatically simplify expressions with a
left hand argument. If you type...</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="VBA%20Notes%20for%20Professionals_files/image359.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>...the VBE will change the line to:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="VBA%20Notes%20for%20Professionals_files/image360.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:6.35pt;margin-bottom:
6.2pt;margin-left:.75pt;line-height:177%'>Similar simplifications will be made
to any expression that contains a left-hand operand (including expressions) for
<b><span style='font-size:9.0pt;line-height:177%;color:blue;background:#FAFAFA'>Not</span></b>.
<b><span style='font-size:9.0pt;line-height:177%;color:blue;background:#FAFAFA'>Xor</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.8pt;
margin-left:.75pt'>Also known as &quot;exclusive or&quot;. Returns <b><span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>True</span></b>
if both expressions evaluate to different results.</p>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:.7pt;margin-left:.75pt'>Left-hand
Operand Right-hand Operand Result</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:4.3pt;
margin-left:0in;text-indent:0in'>0 0 0</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:4.2pt;
margin-left:97.05pt;text-indent:-96.8pt'><span style='line-height:110%'>0<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>1 1</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:3.9pt;
margin-left:97.05pt;text-indent:-96.8pt'><span style='line-height:110%'>1<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>0 1</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.25pt;
margin-left:0in;text-indent:0in'>1 1 0</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:10.4pt;
margin-left:.75pt'>Note that although the <b><span style='font-size:9.0pt;
line-height:110%;color:blue;background:#FAFAFA'>Xor</span></b> operator can be <i>used</i>
like a logical operator, there is absolutely no reason to do so as it gives the
same result as the comparison operator <span style='font-size:9.0pt;line-height:
110%;color:#666666;background:#FAFAFA'>&lt;</span><b><span style='font-size:
9.0pt;line-height:110%;background:#FAFAFA'>&gt;</span></b>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:17.75pt;margin-bottom:
13.85pt;margin-left:-.25pt;line-height:107%'><span style='font-size:9.0pt;
line-height:107%;background:#FAFAFA'>Eqv</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.8pt;
margin-left:.75pt'>Also known as &quot;equivalence&quot;. Returns <b><span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>True</span></b>
when both expressions evaluate to the same result.</p>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:.9pt;margin-left:.75pt'>Left-hand
Operand Right-hand Operand Result</h4>

<p class=MsoNormal style='margin-left:0in;text-indent:0in'>0 0 1</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:4.2pt;
margin-left:97.05pt;text-indent:-96.8pt'><span style='line-height:110%'>0<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>1 0</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:4.3pt;
margin-left:97.05pt;text-indent:-96.8pt'><span style='line-height:110%'>1<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>0 0</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.15pt;
margin-left:0in;text-indent:0in'>1 1 1</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=86 style='width:.9in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Not</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;background:#FAFAFA'>(</span></p>
  </td>
  <td width=50 valign=top style='width:37.8pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>x </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Xor</span></b><span
  style='font-size:9.0pt;line-height:107%'> y</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:.15in;
margin-left:.75pt'>Note that the <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>Eqv</span> function is <i>very</i> rarely used as <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>x Eqv y</span> is
equivalent to the much more readable <span style='font-size:9.0pt;line-height:
110%;background:#FAFAFA'>)</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:17.75pt;margin-bottom:
13.85pt;margin-left:-.25pt;line-height:107%'><span style='font-size:9.0pt;
line-height:107%;background:#FAFAFA'>Imp</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.85pt;
margin-left:.75pt'>Also known as &quot;implication&quot;. Returns <b><span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>True</span></b>
if both operands are the same <i>or</i> the second operand is <b><span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>True</span></b>.</p>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:.9pt;margin-left:.75pt'>Left-hand
Operand Right-hand Operand Result</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:4.5pt;
margin-left:0in;text-indent:0in'>0 0 1</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:4.0pt;
margin-left:97.05pt;text-indent:-96.8pt'><span style='line-height:110%'>0<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>1 1</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:4.3pt;
margin-left:97.05pt;text-indent:-96.8pt'><span style='line-height:110%'>1<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>0 0</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.05pt;
margin-left:0in;text-indent:0in'>1 1 1</p>

<p class=MsoNormal style='margin-top:0in;margin-right:13.6pt;margin-bottom:
.25pt;margin-left:.75pt;text-align:justify;text-justify:inter-ideograph;
line-height:135%'>Note that the <span style='font-size:9.0pt;line-height:135%;
background:#FAFAFA'>Imp</span> function is very rarely used. A good rule of
thumb is that if you can't explain what it means, you should use another
construct.</p>

<h2 style='margin-top:0in;margin-right:13.6pt;margin-bottom:.25pt;margin-left:
.75pt;text-align:justify;text-justify:inter-ideograph;line-height:135%'><a
name="_Toc308798">Section 32.4: Mathematical Operators</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Listed in order of precedence:</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=702
 style='width:526.85pt;margin-left:1.0pt;border-collapse:collapse'>
 <tr style='height:14.05pt'>
  <td width=702 colspan=2 valign=top style='width:526.85pt;padding:0in 0in 0in 0in;
  height:14.05pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><b>Token
  Name</b><span style='font-family:"Arial",sans-serif'>  </span><b>Description</b></p>
  </td>
 </tr>
 <tr style='height:49.8pt'>
  <td width=44 style='width:32.65pt;padding:0in 0in 0in 0in;height:49.8pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:9.0pt;line-height:107%;background:#FAFAFA'>^</span></p>
  </td>
  <td width=659 valign=top style='width:494.2pt;padding:0in 0in 0in 0in;
  height:49.8pt'>
  <p class=MsoNormal align=right style='margin:0in;text-align:right;text-indent:
  0in;line-height:107%'>Return the result of raising the left-hand operand to
  the power of the right-hand operand.</p>
  <p class=MsoNormal align=right style='margin-top:0in;margin-right:1.2pt;
  margin-bottom:0in;margin-left:0in;text-align:right;text-indent:0in;
  line-height:107%'>Note that the value returned by exponentiation is <i>always</i>
  a <span style='font-size:9.0pt;line-height:107%;color:slateblue;background:
  #FAFAFA'>Double</span>, regardless of the value</p>
  <p class=MsoNormal style='margin-top:0in;margin-right:13.45pt;margin-bottom:
  0in;margin-left:75.95pt;text-indent:-75.95pt;line-height:107%'>Exponentiation
  types being divided. Any coercion of the result into a variable type takes
  place <b><i>after</i></b> the calculation is performed.</p>
  </td>
 </tr>
 <tr style='height:52.9pt'>
  <td width=44 style='width:32.65pt;padding:0in 0in 0in 0in;height:52.9pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:9.0pt;line-height:107%;background:#FAFAFA'>/</span></p>
  </td>
  <td width=659 valign=top style='width:494.2pt;padding:0in 0in 0in 0in;
  height:52.9pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
  margin-left:75.95pt;text-indent:0in;line-height:99%'>Returns the result of
  dividing the left-hand operand by the right-hand operand. Note that the value
  returned by division is <i>always</i> a <span style='font-size:9.0pt;
  line-height:99%;color:slateblue;background:#FAFAFA'>Double</span>, regardless
  of the value types being</p>
  <p class=MsoNormal style='margin-top:0in;margin-right:7.05pt;margin-bottom:
  0in;margin-left:75.95pt;text-align:justify;text-justify:inter-ideograph;
  text-indent:-75.95pt;line-height:107%'>Division1 divided. Any coercion of the
  result into a variable type takes place <b><i>after</i></b> the calculation
  is performed.</p>
  </td>
 </tr>
 <tr style='height:13.65pt'>
  <td width=44 valign=top style='width:32.65pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:9.0pt;line-height:107%;background:#FAFAFA'>*</span></p>
  </td>
  <td width=659 valign=top style='width:494.2pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Multiplication1
  Returns the product of 2 operands.</p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:4.65pt;margin-bottom:
0in;margin-left:110.1pt'>Returns the integer result of dividing the left-hand
operand by the right-hand operand <b><i>after</i></b> rounding both sides with
.5 rounding down. Any remainder of the division is ignored.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=43 style='width:.45in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=43 valign=top style='width:.45in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>\ </span><span style='font-size:9.0pt;line-height:107%;color:brown'>0.4</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:3.45pt;
margin-left:108.85pt;text-indent:-108.6pt'><span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>\ </span>Integer
Division If the right-hand operand (the divisor) is <span style='font-size:
9.0pt;line-height:110%;background:#FAFAFA'>0</span>, a Run-time error 11:
Division by zero will result. Note that this is <b><i>after</i></b> all
rounding is performed - expressions such as <span style='font-size:9.0pt;
line-height:110%;color:brown;background:#FAFAFA'>3</span> will also result in a
division by zero error.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:110.1pt'>Returns the integer remainder of dividing the left-hand
operand by the right-hand operand. The operand on each side is rounded to an
integer <i>before</i> the division, with .5 rounding</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=168 style='width:125.65pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:1.05pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:brown'>8.6</span><span style='font-size:9.0pt;line-height:107%'> </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Mod</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span></p>
  </td>
  <td width=38 valign=top style='width:28.45pt;padding:1.05pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:brown;background:#FAFAFA'>3</span> and </p>
  </td>
  <td width=72 valign=top style='width:.75in;background:#FAFAFA;padding:1.05pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:brown'>12</span><span style='font-size:9.0pt;line-height:107%'> </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Mod</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:brown'>2.6</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:110.1pt'>down. For example, both result in <span style='font-size:
9.0pt;line-height:110%;background:#FAFAFA'>0</span>. If the right-hand operand</p>

<p class=MsoNormal style='margin:0in;text-indent:0in'><b><span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>Mod </span></b>Modulo</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=58 style='width:.6in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'></span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Mod</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:brown'>0.4</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:3.7pt;
margin-left:110.1pt'>(the divisor) is <span style='font-size:9.0pt;line-height:
110%;background:#FAFAFA'>0</span>, a Run-time error 11: Division by zero will
result. Note that this is <b><i>after</i></b> all rounding is performed -
expressions such as <span style='font-size:9.0pt;line-height:110%;color:brown;
background:#FAFAFA'>3</span> will also result in a division by zero error.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:3.65pt;
margin-left:0in;text-indent:0in'><span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>- </span>Subtraction2 Returns
the result of subtracting the right-hand operand from the left-hand operand.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:110.1pt'>Returns the sum of 2 operands. Note that this token also
treated as a concatenation</p>

<p class=MsoNormal style='margin:0in;text-indent:0in'><span style='font-size:
9.0pt;line-height:110%;background:#FAFAFA'>+ </span>Addition2</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:15.25pt;
margin-left:110.1pt'>operator when it is applied to a <span style='font-size:
9.0pt;line-height:110%;color:slateblue;background:#FAFAFA'>String</span>. See <b>Concatenation
Operators</b>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.8pt;
margin-left:8.55pt;text-indent:-8.3pt'><span style='line-height:110%'>1<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span>Multiplication and
division are treated as having the same precedence.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:8.55pt;text-indent:-8.3pt'><span style='line-height:110%'>2<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span>Addition and
subtraction are treated as having the same precedence.</p>

<h1 style='margin-left:-.25pt'><a name="_Toc308799">Chapter 33: Collections</a></h1>

<h2 style='margin-left:-.25pt'><a name="_Toc308800">Section 33.1: Getting the
Item Count of a Collection</a></h2>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=43 style='width:.45in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=43 valign=top style='width:.45in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>.Count</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:13.15pt;
margin-left:.75pt'>The number of items in a <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>Collection</span> can be obtained by
calling its function:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:.75pt'><b>Syntax:</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="VBA%20Notes%20for%20Professionals_files/image361.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:.75pt'><b>Sample Usage:</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=207
src="VBA%20Notes%20for%20Professionals_files/image362.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc308801">Section 33.2: Determining
if a Key or Item Exists in a Collection</a></h2>

<h4 style='margin-left:.75pt'>Keys</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Unlike a Scripting.Dictionary, a <span style='font-size:
9.0pt;line-height:110%;background:#FAFAFA'>Collection</span> does not have a
method for determining if a given key exists <i>or</i> a way to retrieve keys
that are present in the <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>Collection</span>. The only method to determine if a key is
present is to use the error handler:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:19.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=273
src="VBA%20Notes%20for%20Professionals_files/image363.gif"></span></p>

<h4 style='margin-left:.75pt'>Items</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>The only way to determine if an item is contained in a <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Collection</span>
is to iterate over the <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>Collection</span> until the item is located. Note that
because a <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Collection</span>
can contain either primitives or objects, some extra handling is needed to
avoid run-time errors during the comparisons:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=339
src="VBA%20Notes%20for%20Professionals_files/image364.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc308802">Section 33.3: Adding Items
to a Collection</a></h2>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=22 style='width:16.2pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=22 valign=top style='width:16.2pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Add</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:13.2pt;
margin-left:.75pt'>Items are added to a <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>Collection</span> by calling its <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>.</span> method:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:.75pt'><b>Syntax:</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:3.25pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="VBA%20Notes%20for%20Professionals_files/image365.gif"></span></p>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:.7pt;margin-left:0in;
text-indent:0in'>Parameter Description</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:15.0pt;margin-bottom:
6.15pt;margin-left:.25pt;text-align:justify;text-justify:inter-ideograph;
text-indent:55.4pt;line-height:90%'>The item to store in the <span
style='font-size:9.0pt;line-height:90%;background:#FAFAFA'>Collection</span>.
This can be essentially any value that a variable can be assigned <i>item </i>to,
including primitive types, arrays, objects, and <b><span style='font-size:9.0pt;
line-height:90%;color:blue;background:#FAFAFA'>Nothing</span></b>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:56.9pt'>Optional. A <span style='font-size:9.0pt;line-height:110%;
color:slateblue;background:#FAFAFA'>String</span> that serves as a unique
identifier for retrieving items from the <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>Collection</span>. If the</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:3.55pt;
margin-left:55.65pt;text-indent:-55.4pt'><i>key </i>specified
key already exists in the <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>Collection</span>, it will result in a Run-time error 457:
&quot;This key is already associated with an element of this collection&quot;.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:56.9pt'>Optional. An existing key (<span style='font-size:9.0pt;
line-height:110%;color:slateblue;background:#FAFAFA'>String</span> value) <i>or</i>
index (numeric value) to insert the item before in the</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:56.9pt'><span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>Collection</span>. If a value is given, the <i>after</i> parameter <b><i>must</i></b>
be empty or a Run-time error 5: &quot;Invalid</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:3.8pt;
margin-left:55.65pt;text-indent:-55.4pt'><i>before </i>procedure
call or argument&quot; will result. If a <span style='font-size:9.0pt;
line-height:110%;color:slateblue;background:#FAFAFA'>String</span> key is
passed that does not exist in the <span style='font-size:9.0pt;line-height:
110%;background:#FAFAFA'>Collection</span>, a Run-time error 5: &quot;Invalid
procedure call or argument&quot; will result. If a numeric index is passed that
is does not exist in the <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>Collection</span>, a Run-time error 9: &quot;Subscript out
of range&quot; will result.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:56.9pt'>Optional. An existing key (<span style='font-size:9.0pt;
line-height:110%;color:slateblue;background:#FAFAFA'>String</span> value) <i>or</i>
index (numeric value) to insert the item after in the</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:15.45pt;
margin-left:55.65pt;text-indent:-55.4pt'><i>after </i><span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Collection</span>.
If a value is given, the <i>before</i> parameter <b><i>must</i></b> be empty.
Errors raised are identical to the <i>before</i> parameter.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.2pt;
margin-left:.75pt'><b>Notes:</b></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=268 style='width:201.25pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=115 valign=top style='width:1.2in;background:#FAFAFA;padding:1.05pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Add </span><span style='font-size:9.0pt;line-height:107%;color:brown'>&quot;Bar&quot;</span><span
  style='font-size:9.0pt;line-height:107%'>, </span><span style='font-size:
  9.0pt;line-height:107%;color:brown'>&quot;Foo&quot;</span></p>
  </td>
  <td width=38 valign=top style='width:28.45pt;padding:1.05pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'>and <span style='font-size:9.0pt;
  line-height:107%;background:#FAFAFA'>.</span></p>
  </td>
  <td width=115 valign=top style='width:1.2in;background:#FAFAFA;padding:1.05pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Add </span><span style='font-size:9.0pt;line-height:107%;color:brown'>&quot;Baz&quot;</span><span
  style='font-size:9.0pt;line-height:107%'>, </span><span style='font-size:
  9.0pt;line-height:107%;color:brown'>&quot;foo&quot;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:9.35pt;
margin-left:21.4pt'><img width=5 height=1
src="VBA%20Notes%20for%20Professionals_files/image366.gif" align=left
hspace=12>Keys are <b><i>not</i></b> case-sensitive. <span style='font-size:
9.0pt;line-height:110%;background:#FAFAFA'>.</span> will result in a key
collision.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:9.75pt;
margin-left:21.4pt'>If neither of the optional <i>before</i> or <i>after</i>
parameters are given, the item will be added after the last item in the <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Collection</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:20.2pt;
margin-left:30.0pt;text-indent:-9.1pt'><span style='font-size:11.0pt;
line-height:110%'><img border=0 width=5 height=5 id="Group 287096"
src="VBA%20Notes%20for%20Professionals_files/image167.gif"></span>Insertions
made by specifying a <i>before</i> or <i>after</i> parameter will alter the
numeric indexes of existing members to match thier new position. This means
that care should be taken when making insertions in loops using numeric
indexes.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:.75pt'><b>Sample Usage:</b></p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=29
src="VBA%20Notes%20for%20Professionals_files/image367.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=235
src="VBA%20Notes%20for%20Professionals_files/image368.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc308803">Section 33.4: Removing
Items From a Collection</a></h2>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=43 style='width:.45in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=43 valign=top style='width:.45in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Remove</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:13.2pt;
margin-left:.75pt'>Items are removed from a <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>Collection</span> by calling its <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>.</span> method:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.4pt;
margin-left:.75pt'><b>Syntax:</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:1.55pt;
margin-left:.5pt'><span style='font-size:11.0pt;line-height:110%'><img
border=0 width=718 height=26 id="Group 287300"
src="VBA%20Notes%20for%20Professionals_files/image369.gif"></span><span
style='font-size:9.0pt;line-height:110%'>.Remove(index)</span></p>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:.75pt;margin-left:
0in;text-indent:0in'>Parameter Description</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:56.9pt'>The item to remove from the <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>Collection</span>. If the value passed is
a numeric type or <span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>Variant</span> with a numeric sub-type, it will be interpreted as a
numeric index. If the value passed is a <span style='font-size:9.0pt;
line-height:110%;color:slateblue;background:#FAFAFA'>String</span> or <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Variant</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:15.65pt;
margin-left:55.65pt;text-indent:-55.4pt'><i>index </i>containing
a string, it will be interpreted as the a key. If a String key is passed that
does not exist in the <span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>Collection</span>, a Run-time error 5: &quot;Invalid procedure call or
argument&quot; will result. If a numeric index is passed that is does not exist
in the <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Collection</span>,
a Run-time error 9: &quot;Subscript out of range&quot; will result.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.2pt;
margin-left:.75pt'><b>Notes:</b></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=36 style='width:27.0pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=36 valign=top style='width:27.0pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Step</span></b><span style='font-size:9.0pt;line-height:
  107%'> </span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:30.0pt;text-indent:-9.1pt'><span style='font-size:11.0pt;
line-height:110%'><img border=0 width=5 height=5 id="Group 287302"
src="VBA%20Notes%20for%20Professionals_files/image167.gif"></span>Removing an
item from a <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Collection</span>
will change the numeric indexes of all the items after it in the <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Collection</span>. <b><span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>For</span></b>
loops that use numeric indexes and remove items should run <i>backwards</i> (<span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>-</span><span
style='font-size:9.0pt;line-height:110%;color:brown;background:#FAFAFA'>1</span>)
to prevent subscript exceptions and skipped items.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=58 style='width:.6in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>For</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Each</span></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.65pt;
margin-left:30.0pt;text-indent:-9.1pt'><span style='font-size:11.0pt;
line-height:110%'><img border=0 width=5 height=5 id="Group 287303"
src="VBA%20Notes%20for%20Professionals_files/image167.gif"></span>Items should
generally <b><i>not</i></b> be removed from a <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>Collection</span> from inside of a  loop
as it can give unpredictable results.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:.75pt'><b>Sample Usage:</b></p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=322
src="VBA%20Notes%20for%20Professionals_files/image370.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc308804">Section 33.5: Retrieving
Items From a Collection</a></h2>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=29 style='width:.3in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Item</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:13.15pt;
margin-left:.75pt'>Items can be retrieved from a <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>Collection</span> by calling the <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>.</span> function.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.4pt;
margin-left:.75pt'><b>Syntax:</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:1.55pt;
margin-left:.5pt'><span style='font-size:11.0pt;line-height:110%'><img
border=0 width=718 height=26 id="Group 288490"
src="VBA%20Notes%20for%20Professionals_files/image369.gif"></span><span
style='font-size:9.0pt;line-height:110%'>.Item(index)</span></p>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:.75pt;margin-left:
0in;text-indent:0in'>Parameter Description</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:56.9pt'>The item to retrieve from the <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>Collection</span>. If the value passed is
a numeric type or <span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>Variant</span> with a numeric sub-type, it will be interpreted as a
numeric index. If the value passed is a <span style='font-size:9.0pt;
line-height:110%;color:slateblue;background:#FAFAFA'>String</span> or <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Variant</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:15.65pt;
margin-left:55.65pt;text-indent:-55.4pt'><i>index </i>containing
a string, it will be interpreted as the a key. If a String key is passed that
does not exist in the <span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>Collection</span>, a Run-time error 5: &quot;Invalid procedure call or
argument&quot; will result. If a numeric index is passed that is does not exist
in the <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Collection</span>,
a Run-time error 9: &quot;Subscript out of range&quot; will result.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.2pt;
margin-left:.75pt'><b>Notes:</b></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=29 style='width:.3in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Item</span></p>
  </td>
 </tr>
</table>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=189 style='width:141.85pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:1.2pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Item</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.2pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;background:#FAFAFA'>(</span></p>
  </td>
  <td width=36 valign=top style='width:27.0pt;background:#FAFAFA;padding:1.2pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:brown'>&quot;Foo&quot;</span></p>
  </td>
  <td width=45 valign=top style='width:33.85pt;padding:1.2pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;background:#FAFAFA'>)</span> and <span style='font-size:9.0pt;
  line-height:107%;background:#FAFAFA'>.</span></p>
  </td>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:1.2pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Item</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.2pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;background:#FAFAFA'>(</span></p>
  </td>
  <td width=36 valign=top style='width:27.0pt;background:#FAFAFA;padding:1.2pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:brown'>&quot;foo&quot;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:21.4pt'><img width=5 height=1
src="VBA%20Notes%20for%20Professionals_files/image172.gif" align=left
hspace=12><span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>.</span>
is the default member of <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>Collection</span>. This allows flexibility in syntax as
demonstrated in the sample usage below.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:21.4pt'>Numeric indexes are 1-based.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:21.4pt'>Keys are <b><i>not</i></b> case-sensitive. <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>.)</span> refer to
the same key.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:21.4pt'>The <i>index</i> parameter is <b><i>not</i></b> implicitly
cast to a number from a <span style='font-size:9.0pt;line-height:110%;
color:slateblue;background:#FAFAFA'>String</span> or visa-versa. It is entirely
possible that</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=146 style='width:109.45pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:1.35pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Item</span></p>
  </td>
  <td width=60 valign=top style='width:44.65pt;padding:1.35pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;background:#FAFAFA'>(</span><span style='font-size:9.0pt;line-height:
  107%;color:brown;background:#FAFAFA'>1</span><span style='font-size:9.0pt;
  line-height:107%;background:#FAFAFA'>)</span> and <span style='font-size:
  9.0pt;line-height:107%;background:#FAFAFA'>.</span></p>
  </td>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:1.35pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Item</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.35pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;background:#FAFAFA'>(</span></p>
  </td>
  <td width=22 valign=top style='width:16.2pt;background:#FAFAFA;padding:1.35pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:brown'>&quot;1&quot;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:13.25pt;
margin-left:30.5pt'><span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>.)</span> refer to different items of the <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>Collection</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:.75pt'><b>Sample Usage (Indexes):</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=256
src="VBA%20Notes%20for%20Professionals_files/image371.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:.75pt'><b>Sample Usage (Keys):</b></p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=240
src="VBA%20Notes%20for%20Professionals_files/image372.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:.75pt'><b>Sample Usage (Alternate Syntax):</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=240
src="VBA%20Notes%20for%20Professionals_files/image373.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=29 style='width:.3in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Item</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:10.45pt;margin-bottom:
.25pt;margin-left:.75pt;text-align:justify;text-justify:inter-ideograph;
line-height:135%'>Note that bang (<span style='font-size:9.0pt;line-height:
135%;background:#FAFAFA'>!</span>) syntax is allowed because <span
style='font-size:9.0pt;line-height:135%;background:#FAFAFA'>.</span> is the
default member and can take a single <span style='font-size:9.0pt;line-height:
135%;color:slateblue;background:#FAFAFA'>String</span> argument. The utility of
this syntax is questionable.</p>

<h2 style='margin-top:0in;margin-right:10.45pt;margin-bottom:.25pt;margin-left:
.75pt;text-align:justify;text-justify:inter-ideograph;line-height:135%'><a
name="_Toc308805">Section 33.6: Clearing All Items From a Collection</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>The easiest way to clear all of the items from a <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Collection</span>
is to simply replace it with a new <span style='font-size:9.0pt;line-height:
110%;background:#FAFAFA'>Collection</span> and let the old one go out of scope:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=223
src="VBA%20Notes%20for%20Professionals_files/image374.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>However, if there are multiple references to the <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Collection</span>
held, this method will only give you an empty <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>Collection</span> <i>for the variable that
is assigned</i>.</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=273
src="VBA%20Notes%20for%20Professionals_files/image375.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>In this case, the easiest way to clear the contents is by
looping through the number of items in the <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>Collection</span> and repeatedly remove
the lowest item:</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=109
src="VBA%20Notes%20for%20Professionals_files/image376.gif"></span><br
clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc308806">Chapter 34: Passing
Arguments ByRef or ByVal</a></h1>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.75pt;
margin-left:.75pt'>The <b><span style='font-size:9.0pt;line-height:110%;
color:blue;background:#FAFAFA'>ByRef</span></b> and <b><span style='font-size:
9.0pt;line-height:110%;color:blue;background:#FAFAFA'>ByVal</span></b>
modifiers are part of a procedure's signature and indicate how an argument is
passed to a procedure. In VBA a parameter is passed <b><span style='font-size:
9.0pt;line-height:110%;color:blue;background:#FAFAFA'>ByRef</span></b> unless
specified otherwise (i.e. <b><span style='font-size:9.0pt;line-height:110%;
color:blue;background:#FAFAFA'>ByRef</span></b> is implicit if absent).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:20.8pt;margin-bottom:
.25pt;margin-left:.75pt;text-align:justify;text-justify:inter-ideograph;
line-height:135%'><b>Note</b> In many other programming languages (including
VB.NET), parameters are implicitly passed by value if no modifier is specified:
consider specifying <b><span style='font-size:9.0pt;line-height:135%;
color:blue;background:#FAFAFA'>ByRef</span></b> modifiers explicitly to avoid
possible confusion.</p>

<h2 style='margin-top:0in;margin-right:20.8pt;margin-bottom:.25pt;margin-left:
.75pt;text-align:justify;text-justify:inter-ideograph;line-height:135%'><a
name="_Toc308807">Section 34.1: Passing Simple Variables ByRef And ByVal</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:13.2pt;
margin-left:.75pt'>Passing <b><span style='font-size:9.0pt;line-height:110%;
color:blue;background:#FAFAFA'>ByRef</span></b> or <b><span style='font-size:
9.0pt;line-height:110%;color:blue;background:#FAFAFA'>ByVal</span></b>
indicates whether the actual value of an argument is passed to the <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>CalledProcedure</span>
by the <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>CallingProcedure</span>,
or whether a reference (called a pointer in some other languages) is passed to
the <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>CalledProcedure</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.8pt;
margin-left:.75pt'>If an argument is passed <b><span style='font-size:9.0pt;
line-height:110%;color:blue;background:#FAFAFA'>ByRef</span></b>, the memory
address of the argument is passed to the <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>CalledProcedure</span> and any
modification to that parameter by the <span style='font-size:9.0pt;line-height:
110%;background:#FAFAFA'>CalledProcedure</span> is made to the value in the <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>CallingProcedure</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.95pt;
margin-left:.75pt'>If an argument is passed <b><span style='font-size:9.0pt;
line-height:110%;color:blue;background:#FAFAFA'>ByVal</span></b>, the actual
value, not a reference to the variable, is passed to the <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>CalledProcedure</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>A simple example will illustrate this clearly:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=322
src="VBA%20Notes%20for%20Professionals_files/image377.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>Another example:</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=720 height=217
src="VBA%20Notes%20for%20Professionals_files/image378.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Sub</span></b><span
style='font-size:9.0pt;line-height:110%'> SubChangeArguments(</span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>ByVal</span></b><span
style='font-size:9.0pt;line-height:110%'> ParameterByVal </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>Integer</span><span style='font-size:9.0pt;
line-height:110%'>, </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>ByRef</span></b><span style='font-size:9.0pt;line-height:110%'>
ParameterByRef </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>As</span></b><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:slateblue'>Integer</span><span
style='font-size:9.0pt;line-height:110%'>)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.05pt;margin-bottom:.25pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'>
ParameterByVal = ParameterByVal + </span><span style='font-size:9.0pt;
line-height:110%;color:brown'>2</span><span style='font-size:9.0pt;line-height:
110%'> </span><i><span style='font-size:9.0pt;line-height:110%;color:green'>' 5
+ 2 = 7 (changed only inside this Sub)</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.05pt;margin-bottom:.25pt;
margin-left:3.5pt'><span style='position:relative;z-index:-1895770112'><span
style='left:0px;position:absolute;left:0px;top:-85675px;width:718px;height:
1px'><img width=718 height=1
src="VBA%20Notes%20for%20Professionals_files/image379.gif"></span></span><span
style='font-size:9.0pt;line-height:110%'> ParameterByRef = ParameterByRef + </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>89</span><span
style='font-size:9.0pt;line-height:110%'> </span><i><span style='font-size:
9.0pt;line-height:110%;color:green'>' 10 + 89 = 99 (changes the IntVarByRef
itself - in the</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.05pt;margin-bottom:.25pt;
margin-left:3.5pt'><i><span style='font-size:9.0pt;line-height:110%;color:green'>Main
Sub)</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:23.0pt;
margin-left:3.5pt'><b><span style='font-size:9.0pt;line-height:110%;color:blue'>End</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Sub</span></b></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:17.8pt;margin-left:
-.25pt'><a name="_Toc308808">Section 34.2: ByRef</a></h2>

<h4 style='margin-left:.75pt'>Default modifier</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>If no modifier is specified for a parameter, that parameter
is implicitly passed by reference.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.4pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=86
src="VBA%20Notes%20for%20Professionals_files/image380.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:24.55pt;
margin-left:.75pt'>The <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>foo</span> parameter is passed <b><span style='font-size:
9.0pt;line-height:110%;color:blue;background:#FAFAFA'>ByRef</span></b> in both <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>DoSomething1</span>
and <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>DoSomething2</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:18.15pt;margin-bottom:
28.35pt;margin-left:24.5pt'><img width=3 height=1
src="VBA%20Notes%20for%20Professionals_files/image168.gif" align=left
hspace=12><b>Watch out!</b> If you're coming to VBA with experience from other
languages, this is very likely the exact opposite behavior to the one you're
used to. In many other programming languages (including VB.NET), the
implicit/default modifier passes parameters by value.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.15pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=243
src="VBA%20Notes%20for%20Professionals_files/image381.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:10.4pt;
margin-left:30.5pt'>Calling the above <span style='font-size:9.0pt;line-height:
110%;background:#FAFAFA'>Test</span> procedure outputs 84. <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>DoSomething</span>
is given <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>foo</span>
and receives a <i>reference</i> to the value, and therefore works with the same
memory address as the caller.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:20.9pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=690 height=197
src="VBA%20Notes%20for%20Professionals_files/image382.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.0pt;
margin-left:30.0pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=678 height=38
src="VBA%20Notes%20for%20Professionals_files/image383.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:44.3pt;
margin-left:30.5pt'>The above code raises run-time error 91, because the caller
is calling the <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Count</span>
member of an object that no longer exists, because <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>DoSomething</span> was given a <i>reference</i>
to the object pointer and assigned it to <b><span style='font-size:9.0pt;
line-height:110%;color:blue;background:#FAFAFA'>Nothing </span></b>before
returning.</p>

<h4 style='margin-left:.75pt'>Forcing ByVal at call site</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>Using parentheses at the call site, you can override <b><span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>ByRef</span></b>
and force an argument to be passed <b><span style='font-size:9.0pt;line-height:
110%;color:blue;background:#FAFAFA'>ByVal</span></b>:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=174
src="VBA%20Notes%20for%20Professionals_files/image384.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:24.3pt;
margin-left:.75pt'>The above code outputs 42, regardless of whether <b><span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>ByRef</span></b>
is specified implicitly or explicitly.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:16.3pt;margin-bottom:
14.1pt;margin-left:24.5pt'><span style='position:relative;z-index:-1895768064'><span
style='left:0px;position:absolute;left:20px;top:-87101px;width:668px;
height:1px'><img width=668 height=1
src="VBA%20Notes%20for%20Professionals_files/image385.gif"></span></span><b>Watch
out!</b> Because of this, using extraneous parentheses in procedure calls can
easily introduce bugs. Pay attention to the whitespace between the procedure
name and the argument list:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.05pt;margin-bottom:.25pt;
margin-left:28.25pt'><span style='font-size:9.0pt;line-height:110%'>bar =
DoSomething(foo) </span><i><span style='font-size:9.0pt;line-height:110%;
color:green'>'function call, no whitespace; parens are part of args list</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.05pt;margin-bottom:22.95pt;
margin-left:28.25pt'><span style='font-size:9.0pt;line-height:110%'>DoSomething
(foo) </span><i><span style='font-size:9.0pt;line-height:110%;color:green'>'procedure
call, notice whitespace; parens are NOT part of args list </span></i><span
style='font-size:9.0pt;line-height:110%'>DoSomething foo </span><i><span
style='font-size:9.0pt;line-height:110%;color:green'>'procedure call does not
force the foo parameter to be ByVal</span></i></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:0in;margin-left:-.25pt'><a
name="_Toc308809">Section 34.3: ByVal</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=243
src="VBA%20Notes%20for%20Professionals_files/image386.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:21.5pt;
margin-left:30.5pt'>Calling the above <span style='font-size:9.0pt;line-height:
110%;background:#FAFAFA'>Test</span> procedure outputs 42. <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>DoSomething</span>
is given <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>foo</span>
and receives <b>a copy</b> of the value. The copy is multiplied by 2, and then
discarded when the procedure exits; the caller's copy was never altered.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:21.4pt'><span style='font-size:11.0pt;line-height:110%'><img
border=0 width=5 height=5 id="Group 296460"
src="VBA%20Notes%20for%20Professionals_files/image167.gif"></span>When a <i>reference</i>
is passed <b><span style='font-size:9.0pt;line-height:110%;color:blue;
background:#FAFAFA'>ByVal</span></b>, the procedure receives <b>a copy</b> of
the pointer.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.35pt;
margin-left:30.0pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=678 height=191
src="VBA%20Notes%20for%20Professionals_files/image387.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:30.5pt'>Calling the above <span style='font-size:9.0pt;line-height:
110%;background:#FAFAFA'>Test</span> procedure outputs 1. <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>DoSomething</span>
is given <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>foo</span>
and receives <i>a copy</i> of <b>the pointer</b> to the <span style='font-size:
9.0pt;line-height:110%;background:#FAFAFA'>Collection</span> object. Because
the <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>foo</span>
object variable in the <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>Test</span> scope points to the same object, adding an item
in <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>DoSomething</span>
adds the item to the same object. Because it's <i>a copy</i> of the pointer,
setting its reference to <b><span style='font-size:9.0pt;line-height:110%;
color:blue;background:#FAFAFA'>Nothing</span></b> does not affect the caller's
own copy.<br clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc308810">Chapter 35: CreateObject
vs. GetObject</a></h1>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:0in;margin-left:-.25pt'><a
name="_Toc308811">Section 35.1: Demonstrating GetObject and CreateObject</a></h2>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=719 height=752
src="VBA%20Notes%20for%20Professionals_files/image388.gif"></span></p>

<h1 style='margin-left:-.25pt'><a name="_Toc308812">Chapter 36: Macro security
and signing of VBA-projects/-modules</a></h1>

<h2 style='margin-left:-.25pt'><a name="_Toc308813">Section 36.1: Create a
valid digital self-signed certificate SELFCERT.EXE</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>To run macros and maintain the security Office applications
provide against malicious code, it is necessary to digitally sign the
VBAProject.OTM from the <i>VBA editor &gt; Tools &gt; Digital Signature</i>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><img border=0 width=718
height=142 id="Picture 27489"
src="VBA%20Notes%20for%20Professionals_files/image389.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.7pt;
margin-left:.75pt'>Office comes with a utility to create a self-signed digital
certificate that you can employ on the PC to sign your projects.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:13.05pt;
margin-left:.75pt'>This utility <b>SELFCERT.EXE</b> is in the Office program
folder,</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.8pt;
margin-left:.75pt'>Click on Digital Certificate for VBA Projects to open the
certificate <i>wizard</i>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>In the dialog enter a suitable name for the certificate and
click OK.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><img border=0 width=430
height=349 id="Picture 27500"
src="VBA%20Notes%20for%20Professionals_files/image390.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>If all goes well you will see a confirmation:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><img border=0 width=430
height=349 id="Picture 27514"
src="VBA%20Notes%20for%20Professionals_files/image391.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:13.05pt;
margin-left:.75pt'>You can now close the <b>SELFCERT</b> wizard and turn your
attention to the certificate you have created.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>If you try to employ the certificate you have just created
and you check its properties</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><img
border=0 width=439 height=303 id="Picture 27520"
src="VBA%20Notes%20for%20Professionals_files/image392.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><img border=0 width=419
height=521 id="Picture 27533"
src="VBA%20Notes%20for%20Professionals_files/image393.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.8pt;
margin-left:.75pt'>You will see that the certificate is not trusted and the
reason is indicated in the dialog.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:9.85pt;
margin-left:.75pt'>The certificate has been created in the Current User &gt;
Personal &gt; Certificates store. It needs to go in Local Computer &gt; Trusted
Root Certificate Authorities &gt; Certificates store, so you need to export
from the former and import to the latter.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.1pt;
margin-left:.75pt'>Pressing the Windows <span style='font-size:11.0pt;
line-height:110%'><img border=0 width=413 height=266
src="VBA%20Notes%20for%20Professionals_files/image394.gif"></span><span
style='border:solid black 1.5pt;padding:0in'><b>Key+R</b> </span>which will
open the 'Run' Window. then Enter 'mmc' in the window as shown</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>The Microsoft Management Console will open and look like the
following.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><img border=0 width=719
height=374 id="Picture 27576"
src="VBA%20Notes%20for%20Professionals_files/image395.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>From the File menu, select Add/Remove Snap-in... Then from
the ensuing dialog, double click Certificates and then click OK</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><img border=0 width=688
height=483 id="Picture 27580"
src="VBA%20Notes%20for%20Professionals_files/image396.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Expand the dropdown in the left window for <i>Certificates -
Current User</i>' and select certificates as shown below. The center panel will
then show the certificates in that location, which will include the certificate
you created earlier:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><img border=0 width=719
height=374 id="Picture 27597"
src="VBA%20Notes%20for%20Professionals_files/image397.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>Right click the certificate and select All Tasks &gt;
Export:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><img border=0 width=718
height=373 id="Picture 27600"
src="VBA%20Notes%20for%20Professionals_files/image398.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Export Wizard</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><img border=0 width=513
height=466 id="Picture 27614"
src="VBA%20Notes%20for%20Professionals_files/image399.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>Click Next</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><img border=0 width=513
height=466 id="Picture 27617"
src="VBA%20Notes%20for%20Professionals_files/image400.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>the Only one pre-selected option will be available, so click
'Next' again:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><img border=0 width=513
height=466 id="Picture 27631"
src="VBA%20Notes%20for%20Professionals_files/image401.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>The top item will already be pre-selected. Click Next again
and choose a name and location to save the exported certificate.</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><img
border=0 width=513 height=466 id="Picture 27635"
src="VBA%20Notes%20for%20Professionals_files/image402.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.8pt;
margin-left:.75pt'>Click Next again to save the certificate</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.8pt;
margin-left:.75pt'>Once focus is returned to the Management Console.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>Expand the <i>Certificates</i> menu and from the Trusted
Root Certification Authorities menu, select <i>Certificates</i>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><img border=0 width=718
height=329 id="Picture 27655"
src="VBA%20Notes%20for%20Professionals_files/image403.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>Right click. Select <i>All Tasks</i> and <i>Import</i></p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><img
border=0 width=718 height=330 id="Picture 27661"
src="VBA%20Notes%20for%20Professionals_files/image404.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><img border=0 width=513
height=466 id="Picture 27674"
src="VBA%20Notes%20for%20Professionals_files/image405.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:9.75pt;margin-bottom:
0in;margin-left:.75pt'>Click next and Save to the <i>Trusted Root Certification
Authorities store</i>:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><img border=0 width=513
height=466 id="Picture 27679"
src="VBA%20Notes%20for%20Professionals_files/image406.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Then Next &gt; Finish, now close the Console.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>If you now use the certificate and check its properties, you
will see that it is a trusted certificate and you can use it to sign your
project:</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><img
border=0 width=419 height=521 id="Picture 27695"
src="VBA%20Notes%20for%20Professionals_files/image407.jpg"></p>

<h1 style='margin-left:-.25pt'><a name="_Toc308814">Chapter 37: Data Structures</a></h1>

<p class=MsoNormal style='margin-top:0in;margin-right:10.4pt;margin-bottom:
.25pt;margin-left:.75pt;text-align:justify;text-justify:inter-ideograph;
line-height:135%'>[TODO: This topic should be an example of all the basic CS
101 data structures along with some explanation as an overview of how data
structures can be implemented in VBA. This would be a good opportunity to tie
in and reinforce concepts introduced in Class-related topics in VBA
documentation.]</p>

<h2 style='margin-top:0in;margin-right:10.4pt;margin-bottom:.25pt;margin-left:
.75pt;text-align:justify;text-justify:inter-ideograph;line-height:135%'><a
name="_Toc308815">Section 37.1: Linked List</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:13.05pt;
margin-left:.75pt'>This linked list example implements <a
href="https://en.wikipedia.org/wiki/Set_(abstract_data_type)"><span
style='color:#193C96'>Set abstract data type</span></a> operations.</p>

<h3 style='margin-top:0in;margin-right:0in;margin-bottom:0in;margin-left:.75pt;
line-height:110%'><span style='font-size:10.0pt;line-height:110%;color:black'>SinglyLinkedNode</span><span
style='font-size:10.0pt;line-height:110%;color:black;font-weight:normal'> class</span></h3>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=720 height=92
src="VBA%20Notes%20for%20Professionals_files/image408.gif"></span></p>

<h3 style='margin-top:0in;margin-right:0in;margin-bottom:0in;margin-left:.75pt;
line-height:110%'><span style='font-size:10.0pt;line-height:110%;color:black'>LinkedList</span><span
style='font-size:10.0pt;line-height:110%;color:black;font-weight:normal'> class</span></h3>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=643
src="VBA%20Notes%20for%20Professionals_files/image409.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=399
src="VBA%20Notes%20for%20Professionals_files/image410.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc308816">Section 37.2: Binary Tree</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>This is an example of an unbalanced <a
href="https://en.wikipedia.org/wiki/Binary_search_tree"><span style='color:
#193C96'>binary search tree</span></a>. A binary tree is structured
conceptually as a hierarchy of nodes descending downward from a common root,
where each node has two children: left and right. For example, suppose the
numbers 7, 5, 9, 3, 11, 6, 12, 14 and 15 were inserted into a BinaryTree. The
structure would be as below. Note that this binary tree is not <a
href="https://en.wikipedia.org/wiki/Self-balancing_binary_search_tree"><span
style='color:#193C96'>balanced</span></a>, which can be a desirable
characteristic for guaranteeing the performance of lookups - see <a
href="https://en.wikipedia.org/wiki/AVL_tree"><span style='color:#193C96'>AVL
trees</span></a> for an example of a self-balancing binary search tree.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=191
src="VBA%20Notes%20for%20Professionals_files/image411.gif"></span></p>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:0in;margin-left:.75pt'>BinaryTreeNode<span
style='font-weight:normal'> class</span></h4>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=109
src="VBA%20Notes%20for%20Professionals_files/image412.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.2pt;
margin-left:.75pt'><b>BinaryTree</b> class</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>[TODO]</p>

<h1 style='margin-left:-.25pt'><a name="_Toc308817">Chapter 38: Interfaces</a></h1>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.45pt;
margin-left:.75pt'>An <b>Interface</b> is a way to define a set of behaviors
that a class will perform. The definition of an interface is a list of method
signatures (name, parameters, and return type). A class having all of the
methods is said to &quot;implement&quot; that interface.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:18.2pt;
margin-left:.75pt'>In VBA, using interfaces lets the compiler check that a
module implements all of its methods. A variable or parameter can be defined in
terms of an interface instead of a specific class.</p>

<h2 style='margin-left:-.25pt'><a name="_Toc308818">Section 38.1: Multiple
Interfaces in One Class - Flyable and Swimable</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>Using the <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>Flyable</span> example as a starting point, we can add a
second interface, <span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>Swimmable</span>, with the following code:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="VBA%20Notes%20for%20Professionals_files/image413.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>The <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>Duck</span> object can <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>Implement</span> both flying and swimming:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.25pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=240
src="VBA%20Notes%20for%20Professionals_files/image414.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>A <span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>Fish</span> class can implement <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>Swimmable</span>, too:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.15pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=92
src="VBA%20Notes%20for%20Professionals_files/image415.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Now, we can see that the <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>Duck</span> object can be passed to a Sub
as a <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Flyable</span>
on one hand, and a <span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>Swimmable</span> on the other:</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=183
src="VBA%20Notes%20for%20Professionals_files/image416.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=252
src="VBA%20Notes%20for%20Professionals_files/image417.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:24.0pt;
margin-left:.75pt'>The output of this code is:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.8pt;
margin-left:24.5pt'><img width=3 height=1
src="VBA%20Notes%20for%20Professionals_files/image168.gif" align=left
hspace=12>Fly Check...</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.8pt;
margin-left:24.5pt'>Flying With Wings!</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.8pt;
margin-left:24.5pt'>30</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.8pt;
margin-left:24.5pt'>Flying With Jet Engines!</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.8pt;
margin-left:24.5pt'>10000</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.8pt;
margin-left:24.5pt'>Swim Check...</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.8pt;
margin-left:24.5pt'>Floating on the water</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:29.75pt;
margin-left:24.5pt'>Swimming under the water</p>

<h2 style='margin-left:-.25pt'><a name="_Toc308819">Section 38.2: Simple
Interface - Flyable</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>The interface <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>Flyable</span> is a class module with the following code:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.1pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=125
src="VBA%20Notes%20for%20Professionals_files/image418.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=298 style='width:223.65pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=79 valign=top style='width:59.4pt;background:#FAFAFA;padding:1.05pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Flyable_Fly</span></p>
  </td>
  <td width=82 valign=top style='width:61.65pt;padding:1.05pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;background:#FAFAFA'>()</span> sub and a </p>
  </td>
  <td width=137 valign=top style='width:102.6pt;background:#FAFAFA;padding:
  1.05pt 0in 0in 0in;height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Flyable_GetAltitude</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>A class module, <span style='font-size:9.0pt;line-height:
110%;background:#FAFAFA'>Airplane</span>, uses the <b><span style='font-size:
9.0pt;line-height:110%;color:blue;background:#FAFAFA'>Implements</span></b>
keyword to tell the compiler to raise an error unless it has two methods: a <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>()</span> function
that returns a <span style='font-size:9.0pt;line-height:110%;color:slateblue;
background:#FAFAFA'>Long</span>.</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=145
src="VBA%20Notes%20for%20Professionals_files/image419.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=21
src="VBA%20Notes%20for%20Professionals_files/image420.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=188
src="VBA%20Notes%20for%20Professionals_files/image421.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>We can write a routine that accepts any <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Flyable</span>
value, knowing that it will respond to a command of <span style='font-size:
9.0pt;line-height:110%;background:#FAFAFA'>Fly</span> or</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.1pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=106
src="VBA%20Notes%20for%20Professionals_files/image422.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.9pt;
margin-left:.75pt'>Because the interface is defined, the IntelliSense popup
window will show <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Fly</span>
and <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>GetAltitude</span>
for <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>F</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>When we run the following code:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=92
src="VBA%20Notes%20for%20Professionals_files/image423.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>The output is:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=94
src="VBA%20Notes%20for%20Professionals_files/image424.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Note that even though the subroutine is named <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Flyable_Fly</span>
in both <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Airplane</span>
and <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Duck</span>,
it can be called as <span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>Fly </span>when the variable or parameter is defined as <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Flyable</span>. If
the variable is defined specifically as a <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>Duck</span>, it would have to be called as
<span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Flyable_Fly</span>.</p>

<h1 style='margin-left:-.25pt'><a name="_Toc308820">Chapter 39: Reading 2GB+
files in binary in VBA and File Hashes</a></h1>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.45pt;
margin-left:.75pt'>There is a built in easy way to read files in binary within
VBA, however it has a restriction of 2GB (2,147,483,647 bytes - max of Long
data type). As technology evolves, this 2GB limit is easily breached. e.g. an
ISO image of Operating System install DVD disc. Microsoft does provide a way to
overcome this via low level Windows API and here is a backup of it.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=58 style='width:.6in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>fciv.exe</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:18.55pt;
margin-left:.75pt'>Also demonstrate (Read part) for calculating File Hashes
without external program like from Microsoft.</p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:0in;margin-left:-.25pt'><a
name="_Toc308821">Section 39.1: This have to be in a Class module, examples
later referred as &quot;Random&quot;</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
0in;margin-left:-.45pt;text-indent:0in;line-height:107%'><img border=0
width=719 height=749 id="Picture 302197"
src="VBA%20Notes%20for%20Professionals_files/image425.gif"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:566.95pt;margin-bottom:
0in;margin-left:-28.35pt;text-indent:0in;line-height:107%'>&nbsp;</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=718
 style='width:538.6pt;border-collapse:collapse'>
 <tr style='height:771.0pt'>
  <td width=718 valign=top style='width:538.6pt;background:#FAFAFA;padding:
  2.55pt 5.75pt 0in 3.75pt;height:771.0pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:345.45pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:112%'><span style='font-size:
  9.0pt;line-height:112%'> </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;
  line-height:112%'> hFile </span><b><span style='font-size:9.0pt;line-height:
  112%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:112%'>
  </span><span style='font-size:9.0pt;line-height:112%;color:slateblue'>Long</span><span
  style='font-size:9.0pt;line-height:112%'>, _ lpBuffer </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> Any, _</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:183.45pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:112%'><span style='font-size:
  9.0pt;line-height:112%'> </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;
  line-height:112%'> nNumberOfBytesToWrite </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:112%'>,
  _ lpNumberOfBytesWritten </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:112%'>,
  _</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;
  line-height:107%'> lpOverlapped </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:107%'>) </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Private</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Declare</span></b><span style='font-size:9.0pt;line-height:
  107%'> </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Function</span></b><span
  style='font-size:9.0pt;line-height:107%'> CreateFile </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Lib</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:brown'>&quot;kernel32&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Alias</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;line-height:
  107%;color:brown'>&quot;CreateFileA&quot;</span><span style='font-size:9.0pt;
  line-height:107%'> ( _</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;
  line-height:107%'> lpFileName </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>String</span><span style='font-size:9.0pt;line-height:107%'>,
  _</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;
  line-height:107%'> dwDesiredAccess </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:107%'>,
  _</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;
  line-height:107%'> dwShareMode </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:107%'>,
  _</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;
  line-height:107%'> lpSecurityAttributes </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:107%'>,
  _</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;
  line-height:107%'> dwCreationDisposition </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:107%'>,
  _</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;
  line-height:107%'> dwFlagsAndAttributes </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:107%'>,
  _</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;
  line-height:107%'> hTemplateFile </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:107%'>) </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Private</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Declare</span></b><span style='font-size:9.0pt;line-height:
  107%'> </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Function</span></b><span
  style='font-size:9.0pt;line-height:107%'> SetFilePointer </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Lib</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:brown'>&quot;kernel32&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> ( _</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:318.5pt;margin-bottom:
  12.3pt;margin-left:0in;text-indent:0in;line-height:112%'><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>ByVal</span></b><span
  style='font-size:9.0pt;line-height:112%'> hFile </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:112%'>, _ </span><b><span style='font-size:9.0pt;line-height:
  112%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:
  112%'> lDistanceToMove </span><b><span style='font-size:9.0pt;line-height:
  112%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:112%'>
  </span><span style='font-size:9.0pt;line-height:112%;color:slateblue'>Long</span><span
  style='font-size:9.0pt;line-height:112%'>, _ lpDistanceToMoveHigh </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:112%'>, _ </span><b><span style='font-size:9.0pt;line-height:
  112%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:
  112%'> dwMoveMethod </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:slateblue'>Long</span><span
  style='font-size:9.0pt;line-height:112%'>) </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Private</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Declare</span></b><span style='font-size:9.0pt;line-height:
  107%'> </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Function</span></b><span
  style='font-size:9.0pt;line-height:107%'> FlushFileBuffers </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Lib</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:brown'>&quot;kernel32&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> (</span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>ByVal</span></b><span style='font-size:
  9.0pt;line-height:107%'> hFile </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:107%'>) </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Private</span></b><span style='font-size:
  9.0pt;line-height:107%'> hFile </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:107%'>,
  sFName </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>String</span><span style='font-size:9.0pt;
  line-height:107%'>, fAutoFlush </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Boolean</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Public</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Property</span></b><span style='font-size:9.0pt;line-height:
  107%'> </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Get</span></b><span
  style='font-size:9.0pt;line-height:107%'> FileHandle() </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>If</span></b><span style='font-size:9.0pt;
  line-height:107%'> hFile = INVALID_HANDLE_VALUE </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Then</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> RaiseError W32F_FILE_ALREADY_CLOSED</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>End</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>If</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> FileHandle = hFile</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>End</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Property</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Public</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Property</span></b><span style='font-size:9.0pt;line-height:
  107%'> </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Get</span></b><span
  style='font-size:9.0pt;line-height:107%'> FileName() </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>String</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>If</span></b><span style='font-size:9.0pt;
  line-height:107%'> hFile = INVALID_HANDLE_VALUE </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Then</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> RaiseError W32F_FILE_ALREADY_CLOSED</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>End</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>If</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> FileName = sFName</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>End</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Property</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Public</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Property</span></b><span style='font-size:9.0pt;line-height:
  107%'> </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Get</span></b><span
  style='font-size:9.0pt;line-height:107%'> IsOpen() </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>Boolean</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> IsOpen = hFile &lt;&gt; INVALID_HANDLE_VALUE</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>End</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Property</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Public</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Property</span></b><span style='font-size:9.0pt;line-height:
  107%'> </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Get</span></b><span
  style='font-size:9.0pt;line-height:107%'> AutoFlush() </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>Boolean</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>If</span></b><span style='font-size:9.0pt;
  line-height:107%'> hFile = INVALID_HANDLE_VALUE </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Then</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> RaiseError W32F_FILE_ALREADY_CLOSED</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>End</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>If</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> AutoFlush = fAutoFlush</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>End</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Property</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Public</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Property</span></b><span style='font-size:9.0pt;line-height:
  107%'> </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Let</span></b><span
  style='font-size:9.0pt;line-height:107%'> AutoFlush(</span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>ByVal</span></b><span
  style='font-size:9.0pt;line-height:107%'> NewVal </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>Boolean</span><span style='font-size:9.0pt;
  line-height:107%'>)</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>If</span></b><span style='font-size:9.0pt;
  line-height:107%'> hFile = INVALID_HANDLE_VALUE </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Then</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:280.7pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:112%'><span style='font-size:
  9.0pt;line-height:112%'> RaiseError W32F_FILE_ALREADY_CLOSED </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>End</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>If</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> fAutoFlush = NewVal</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>End</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Property</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Public</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Sub</span></b><span style='font-size:9.0pt;line-height:107%'>
  OpenFile(</span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>ByVal</span></b><span
  style='font-size:9.0pt;line-height:107%'> sFileName </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>String</span><span style='font-size:9.0pt;
  line-height:107%'>)</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>If</span></b><span style='font-size:9.0pt;
  line-height:107%'> hFile &lt;&gt; INVALID_HANDLE_VALUE </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Then</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:80.9pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> RaiseError W32F_FILE_ALREADY_OPEN, sFName
  </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>End</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>If </span></b><span style='font-size:9.0pt;
  line-height:107%'>hFile = CreateFile(sFileName, GENERIC_WRITE </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Or</span></b><span
  style='font-size:9.0pt;line-height:107%'> GENERIC_READ, </span><span
  style='font-size:9.0pt;line-height:107%;color:brown'>0</span><span
  style='font-size:9.0pt;line-height:107%'>, </span><span style='font-size:
  9.0pt;line-height:107%;color:brown'>0</span><span style='font-size:9.0pt;
  line-height:107%'>, OPEN_ALWAYS,</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:566.95pt;margin-bottom:
0in;margin-left:-28.35pt;text-indent:0in;line-height:107%'>&nbsp;</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=718
 style='width:538.6pt;border-collapse:collapse'>
 <tr style='height:771.0pt'>
  <td width=718 valign=top style='width:538.6pt;background:#FAFAFA;padding:
  2.55pt 5.75pt 0in 3.75pt;height:771.0pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>FILE_ATTRIBUTE_NORMAL, </span><span style='font-size:
  9.0pt;line-height:107%;color:brown'>0</span><span style='font-size:9.0pt;
  line-height:107%'>)</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>If</span></b><span style='font-size:9.0pt;
  line-height:107%'> hFile = INVALID_HANDLE_VALUE </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Then</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:215.9pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:112%'><span style='font-size:
  9.0pt;line-height:112%'> RaiseError W32F_PROBLEM_OPENING_FILE,
  sFileName </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>End</span></b><span style='font-size:9.0pt;line-height:112%'> </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>If</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:394.1pt;margin-bottom:
  12.3pt;margin-left:0in;text-indent:0in;line-height:112%'><span
  style='font-size:9.0pt;line-height:112%'> sFName = sFileName </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>End</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Sub</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Public</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Sub</span></b><span style='font-size:9.0pt;line-height:107%'>
  CloseFile()</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>If</span></b><span style='font-size:9.0pt;
  line-height:107%'> hFile = INVALID_HANDLE_VALUE </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Then</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> RaiseError W32F_FILE_ALREADY_CLOSED</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:410.25pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:112%'><span style='font-size:
  9.0pt;line-height:112%'> </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>End</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>If </span></b><span style='font-size:9.0pt;line-height:112%'>CloseHandle
  hFile sFName = </span><span style='font-size:9.0pt;line-height:112%;
  color:brown'>&quot;&quot; </span><span style='font-size:9.0pt;line-height:
  112%'>fAutoFlush = </span><b><span style='font-size:9.0pt;line-height:
  112%;color:blue'>False</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:340.1pt;margin-bottom:
  12.3pt;margin-left:0in;text-indent:0in;line-height:112%'><span
  style='font-size:9.0pt;line-height:112%'> hFile = INVALID_HANDLE_VALUE </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>End</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Sub</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Public</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Function</span></b><span style='font-size:9.0pt;line-height:
  107%'> ReadBytes(</span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:107%'>
  ByteCount </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:107%'>) </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:107%'>
  Variant</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Dim</span></b><span style='font-size:9.0pt;
  line-height:107%'> BytesRead </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:107%'>,
  Bytes() </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>Byte</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>If</span></b><span style='font-size:9.0pt;
  line-height:107%'> hFile = INVALID_HANDLE_VALUE </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Then</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> RaiseError W32F_FILE_ALREADY_CLOSED</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>End</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>If</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>ReDim</span></b><span style='font-size:9.0pt;
  line-height:107%'> Bytes(</span><span style='font-size:9.0pt;line-height:
  107%;color:brown'>0</span><span style='font-size:9.0pt;line-height:107%'> </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>To</span></b><span
  style='font-size:9.0pt;line-height:107%'> ByteCount - </span><span
  style='font-size:9.0pt;line-height:107%;color:brown'>1</span><span
  style='font-size:9.0pt;line-height:107%'>) </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Byte</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> ReadFile hFile, Bytes(</span><span
  style='font-size:9.0pt;line-height:107%;color:brown'>0</span><span
  style='font-size:9.0pt;line-height:107%'>), ByteCount, BytesRead, </span><span
  style='font-size:9.0pt;line-height:107%;color:brown'>0</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> ReadBytes = Bytes</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>End</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Function</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Public</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Sub</span></b><span style='font-size:9.0pt;line-height:107%'>
  WriteBytes(DataBytes() </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><span style='font-size:9.0pt;line-height:107%;color:slateblue'>Byte</span><span
  style='font-size:9.0pt;line-height:107%'>)</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Dim</span></b><span style='font-size:9.0pt;
  line-height:107%'> fSuccess </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:107%'>,
  BytesToWrite </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:107%'> </span><span
  style='font-size:9.0pt;line-height:107%;color:slateblue'>Long</span><span
  style='font-size:9.0pt;line-height:107%'>, BytesWritten </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>If</span></b><span style='font-size:9.0pt;
  line-height:107%'> hFile = INVALID_HANDLE_VALUE </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Then</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> RaiseError W32F_FILE_ALREADY_CLOSED</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>End</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>If</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> BytesToWrite = </span><span style='font-size:
  9.0pt;line-height:107%;color:#000066'>UBound</span><span style='font-size:
  9.0pt;line-height:107%'>(DataBytes) - </span><span style='font-size:9.0pt;
  line-height:107%;color:#000066'>LBound</span><span style='font-size:9.0pt;
  line-height:107%'>(DataBytes) + </span><span style='font-size:9.0pt;
  line-height:107%;color:brown'>1</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> fSuccess = WriteFile(hFile, DataBytes(</span><span
  style='font-size:9.0pt;line-height:107%;color:#000066'>LBound</span><span
  style='font-size:9.0pt;line-height:107%'>(DataBytes)), BytesToWrite,
  BytesWritten, </span><span style='font-size:9.0pt;line-height:107%;
  color:brown'>0</span><span style='font-size:9.0pt;line-height:107%'>)</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>If</span></b><span style='font-size:9.0pt;
  line-height:107%'> fAutoFlush </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Then</span></b><span style='font-size:9.0pt;
  line-height:107%'> Flush</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>End</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Sub</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Public</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Sub</span></b><span style='font-size:9.0pt;line-height:107%'>
  Flush()</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>If</span></b><span style='font-size:9.0pt;
  line-height:107%'> hFile = INVALID_HANDLE_VALUE </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Then</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> RaiseError W32F_FILE_ALREADY_CLOSED</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>End</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>If</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> FlushFileBuffers hFile</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>End</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Sub</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Public</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Sub</span></b><span style='font-size:9.0pt;line-height:107%'>
  SeekAbsolute(</span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:107%'>
  HighPos </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:107%'>, </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:107%'>
  LowPos </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:107%'>)</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>If</span></b><span style='font-size:9.0pt;
  line-height:107%'> hFile = INVALID_HANDLE_VALUE </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Then</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> RaiseError W32F_FILE_ALREADY_CLOSED</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>End</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>If</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> LowPos = SetFilePointer(hFile, LowPos, HighPos,
  FILE_BEGIN)</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>End</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Sub</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Public</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Sub</span></b><span style='font-size:9.0pt;line-height:107%'>
  SeekRelative(</span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:107%'>
  Offset </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:107%'>)</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Dim</span></b><span style='font-size:9.0pt;
  line-height:107%'> TempLow </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><span style='font-size:9.0pt;line-height:107%;color:slateblue'>Long</span><span
  style='font-size:9.0pt;line-height:107%'>, TempErr </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>If</span></b><span style='font-size:9.0pt;
  line-height:107%'> hFile = INVALID_HANDLE_VALUE </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Then</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> RaiseError W32F_FILE_ALREADY_CLOSED</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>End</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>If</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> TempLow = SetFilePointer(hFile, Offset, </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>ByVal</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:brown'>0</span><span style='font-size:9.0pt;
  line-height:107%'>&amp;, FILE_CURRENT)</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>If</span></b><span style='font-size:9.0pt;
  line-height:107%'> TempLow = -</span><span style='font-size:9.0pt;line-height:
  107%;color:brown'>1</span><span style='font-size:9.0pt;line-height:107%'> </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Then</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> TempErr = Err.LastDllError</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>If</span></b><span style='font-size:9.0pt;
  line-height:107%'> TempErr </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Then</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> RaiseError W32F_Problem_seeking, </span><span
  style='font-size:9.0pt;line-height:107%;color:brown'>&quot;Error &quot;</span><span
  style='font-size:9.0pt;line-height:107%'> &amp; TempErr &amp; </span><span
  style='font-size:9.0pt;line-height:107%;color:brown'>&quot;.&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> &amp; vbCrLf &amp; </span><span
  style='font-size:9.0pt;line-height:107%;color:#CD6A5A'>CStr</span><span
  style='font-size:9.0pt;line-height:107%'>(TempErr)</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>End</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>If</span></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
10.35pt;margin-left:-.45pt;text-indent:0in;line-height:107%'><img border=0
width=719 height=744 id="Picture 302205"
src="VBA%20Notes%20for%20Professionals_files/image426.gif"></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:4.9pt;margin-left:
-.25pt'><a name="_Toc308822">Section 39.2: Code for Calculating File Hash in a
Standard module</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.05pt;margin-bottom:.25pt;
margin-left:3.5pt'><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Private</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Const</span></b><span style='font-size:9.0pt;
line-height:110%'> HashTypeMD5 </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>As</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:slateblue'>String</span><span style='font-size:9.0pt;line-height:110%'> =
</span><span style='font-size:9.0pt;line-height:110%;color:brown'>&quot;MD5&quot;</span><span
style='font-size:9.0pt;line-height:110%'> </span><i><span style='font-size:
9.0pt;line-height:110%;color:green'>'
https://msdn.microsoft.com/en-us/library/system.security.cryptography.md5cryptoserviceprovider(v=vs.1
10).aspx</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.05pt;margin-bottom:.25pt;
margin-left:3.5pt'><span style='position:relative;z-index:-1895766016'><span
style='left:0px;position:absolute;left:0px;top:-106100px;width:718px;
height:1px'><img width=718 height=1
src="VBA%20Notes%20for%20Professionals_files/image427.gif"></span></span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Private</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Const</span></b><span style='font-size:9.0pt;
line-height:110%'> HashTypeSHA1 </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>As</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:slateblue'>String</span><span style='font-size:9.0pt;line-height:110%'> =
</span><span style='font-size:9.0pt;line-height:110%;color:brown'>&quot;SHA1&quot;</span><span
style='font-size:9.0pt;line-height:110%'> </span><i><span style='font-size:
9.0pt;line-height:110%;color:green'>' https://msdn.microsoft.com/en-us/library/system.security.cryptography.sha1cryptoserviceprovider(v=vs.
110).aspx</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.05pt;margin-bottom:.25pt;
margin-left:3.5pt'><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Private</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Const</span></b><span style='font-size:9.0pt;
line-height:110%'> HashTypeSHA256 </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>As</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:slateblue'>String</span><span style='font-size:9.0pt;line-height:110%'> =
</span><span style='font-size:9.0pt;line-height:110%;color:brown'>&quot;SHA256&quot;</span><span
style='font-size:9.0pt;line-height:110%'> </span><i><span style='font-size:
9.0pt;line-height:110%;color:green'>'
https://msdn.microsoft.com/en-us/library/system.security.cryptography.sha256cryptoserviceprovider(v=v
s.110).aspx</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.05pt;margin-bottom:.25pt;
margin-left:3.5pt'><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Private</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Const</span></b><span style='font-size:9.0pt;
line-height:110%'> HashTypeSHA384 </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>As</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:slateblue'>String</span><span style='font-size:9.0pt;line-height:110%'> =
</span><span style='font-size:9.0pt;line-height:110%;color:brown'>&quot;SHA384&quot;</span><span
style='font-size:9.0pt;line-height:110%'> </span><i><span style='font-size:
9.0pt;line-height:110%;color:green'>'
https://msdn.microsoft.com/en-us/library/system.security.cryptography.sha384cryptoserviceprovider(v=v
s.110).aspx</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:566.95pt;margin-bottom:
0in;margin-left:-28.35pt;text-indent:0in;line-height:107%'>&nbsp;</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=718
 style='width:538.6pt;border-collapse:collapse'>
 <tr style='height:771.0pt'>
  <td width=718 valign=top style='width:538.6pt;background:#FAFAFA;padding:
  2.55pt .25pt 0in 3.75pt;height:771.0pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.3pt;
  margin-left:0in;text-indent:0in;line-height:112%'><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Private</span></b><span style='font-size:
  9.0pt;line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:
  112%;color:blue'>Const</span></b><span style='font-size:9.0pt;line-height:
  112%'> HashTypeSHA512 </span><b><span style='font-size:9.0pt;line-height:
  112%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:112%'>
  </span><span style='font-size:9.0pt;line-height:112%;color:slateblue'>String</span><span
  style='font-size:9.0pt;line-height:112%'> = </span><span style='font-size:
  9.0pt;line-height:112%;color:brown'>&quot;SHA512&quot;</span><span
  style='font-size:9.0pt;line-height:112%'> </span><i><span style='font-size:
  9.0pt;line-height:112%;color:green'>'
  https://msdn.microsoft.com/en-us/library/system.security.cryptography.sha512cryptoserviceprovider(v=v
  s.110).aspx</span></i></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Private</span></b><span style='font-size:
  9.0pt;line-height:107%'> uFileSize </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Double</span><span style='font-size:9.0pt;line-height:107%'>
  </span><i><span style='font-size:9.0pt;line-height:107%;color:green'>'
  Comment out if not testing performance by FileHashes()</span></i></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Sub</span></b><span style='font-size:9.0pt;
  line-height:107%'> FileHashes()</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Dim</span></b><span style='font-size:9.0pt;
  line-height:107%'> tStart </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><span style='font-size:9.0pt;line-height:107%;color:slateblue'>Date</span><span
  style='font-size:9.0pt;line-height:107%'>, tFinish </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>Date</span><span style='font-size:9.0pt;
  line-height:107%'>, sHash </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><span style='font-size:9.0pt;line-height:107%;color:slateblue'>String</span><span
  style='font-size:9.0pt;line-height:107%'>, aTestFiles </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> Variant, oTestFile </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>Variant, aBlockSizes </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> Variant, oBlockSize </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> Variant</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Dim</span></b><span style='font-size:9.0pt;
  line-height:107%'> BLOCKSIZE </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Double</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:32.35pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:112%'><span style='font-size:
  9.0pt;line-height:112%'> </span><i><span style='font-size:9.0pt;
  line-height:112%;color:green'>' This performs performance testing on
  different file sizes and block sizes </span></i><span style='font-size:9.0pt;
  line-height:112%'>aBlockSizes = </span><span style='font-size:9.0pt;
  line-height:112%;color:#000066'>Array</span><span style='font-size:9.0pt;
  line-height:112%'>(</span><span style='font-size:9.0pt;line-height:112%;
  color:brown'>&quot;2^12-1&quot;</span><span style='font-size:9.0pt;
  line-height:112%'>, </span><span style='font-size:9.0pt;line-height:112%;
  color:brown'>&quot;2^13-1&quot;</span><span style='font-size:9.0pt;
  line-height:112%'>, </span><span style='font-size:9.0pt;line-height:112%;
  color:brown'>&quot;2^14-1&quot;</span><span style='font-size:9.0pt;
  line-height:112%'>, </span><span style='font-size:9.0pt;line-height:112%;
  color:brown'>&quot;2^15-1&quot;</span><span style='font-size:9.0pt;
  line-height:112%'>, </span><span style='font-size:9.0pt;line-height:112%;
  color:brown'>&quot;2^16-1&quot;</span><span style='font-size:9.0pt;
  line-height:112%'>, </span><span style='font-size:9.0pt;line-height:112%;
  color:brown'>&quot;2^17-1&quot;</span><span style='font-size:9.0pt;
  line-height:112%'>, </span><span style='font-size:9.0pt;line-height:112%;
  color:brown'>&quot;2^18-1&quot;</span><span style='font-size:9.0pt;
  line-height:112%'>,</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:53.95pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:112%'><span style='font-size:
  9.0pt;line-height:112%;color:brown'>&quot;2^19-1&quot;</span><span
  style='font-size:9.0pt;line-height:112%'>, </span><span style='font-size:
  9.0pt;line-height:112%;color:brown'>&quot;2^20-1&quot;</span><span
  style='font-size:9.0pt;line-height:112%'>, </span><span style='font-size:
  9.0pt;line-height:112%;color:brown'>&quot;2^21-1&quot;</span><span
  style='font-size:9.0pt;line-height:112%'>, </span><span style='font-size:
  9.0pt;line-height:112%;color:brown'>&quot;2^22-1&quot;</span><span
  style='font-size:9.0pt;line-height:112%'>, </span><span style='font-size:
  9.0pt;line-height:112%;color:brown'>&quot;2^23-1&quot;</span><span
  style='font-size:9.0pt;line-height:112%'>, </span><span style='font-size:
  9.0pt;line-height:112%;color:brown'>&quot;2^24-1&quot;</span><span
  style='font-size:9.0pt;line-height:112%'>, </span><span style='font-size:
  9.0pt;line-height:112%;color:brown'>&quot;2^25-1&quot;</span><span
  style='font-size:9.0pt;line-height:112%'>, </span><span style='font-size:
  9.0pt;line-height:112%;color:brown'>&quot;2^26-1&quot;</span><span
  style='font-size:9.0pt;line-height:112%'>) aTestFiles = </span><span
  style='font-size:9.0pt;line-height:112%;color:#000066'>Array</span><span
  style='font-size:9.0pt;line-height:112%'>(</span><span style='font-size:9.0pt;
  line-height:112%;color:brown'>&quot;C:\ISO\clonezilla-live-2.2.2-37-amd64.iso&quot;</span><span
  style='font-size:9.0pt;line-height:112%'>,</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:brown'>&quot;C:\ISO\HPIP201.2014_0902.29.iso&quot;</span><span
  style='font-size:9.0pt;line-height:107%'>, </span><span style='font-size:
  9.0pt;line-height:107%;color:brown'>&quot;C:\ISO\SW_DVD5_Windows_Vista_Business_W32_32BIT_English.ISO&quot;</span><span
  style='font-size:9.0pt;line-height:107%'>,</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:brown'>&quot;C:\ISO\Win10_1607_English_x64.iso&quot;</span><span
  style='font-size:9.0pt;line-height:107%'>,</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:brown'>&quot;C:\ISO\SW_DVD9_Windows_Svr_Std_and_DataCtr_2012_R2_64Bit_English.ISO&quot;</span><span
  style='font-size:9.0pt;line-height:107%'>)</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> Debug.Print </span><span style='font-size:9.0pt;
  line-height:107%;color:brown'>&quot;Test files: &quot;</span><span
  style='font-size:9.0pt;line-height:107%'> &amp; </span><span
  style='font-size:9.0pt;line-height:107%;color:#000066'>Join</span><span
  style='font-size:9.0pt;line-height:107%'>(aTestFiles, </span><span
  style='font-size:9.0pt;line-height:107%;color:brown'>&quot; | &quot;</span><span
  style='font-size:9.0pt;line-height:107%'>)</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> Debug.Print </span><span style='font-size:9.0pt;
  line-height:107%;color:brown'>&quot;BlockSizes: &quot;</span><span
  style='font-size:9.0pt;line-height:107%'> &amp; </span><span
  style='font-size:9.0pt;line-height:107%;color:#000066'>Join</span><span
  style='font-size:9.0pt;line-height:107%'>(aBlockSizes, </span><span
  style='font-size:9.0pt;line-height:107%;color:brown'>&quot; | &quot;</span><span
  style='font-size:9.0pt;line-height:107%'>)</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>For</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Each</span></b><span style='font-size:9.0pt;line-height:107%'>
  oTestFile </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>In</span></b><span
  style='font-size:9.0pt;line-height:107%'> aTestFiles</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> Debug.Print oTestFile</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:145.8pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:112%'><span style='font-size:
  9.0pt;line-height:112%'> </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>For</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>Each</span></b><span style='font-size:9.0pt;line-height:112%'>
  oBlockSize </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>In</span></b><span style='font-size:9.0pt;line-height:112%'>
  aBlockSizes BLOCKSIZE = Evaluate(oBlockSize) tStart =
  Now sHash = GetFileHash(</span><span style='font-size:9.0pt;
  line-height:112%;color:#CD6A5A'>CStr</span><span style='font-size:9.0pt;
  line-height:112%'>(oTestFile), BLOCKSIZE, HashTypeMD5) tFinish =
  Now</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-align:justify;text-justify:inter-ideograph;text-indent:
  0in;line-height:107%'><span style='font-size:9.0pt;line-height:107%'>
  Debug.Print sHash, uFileSize, </span><span style='font-size:9.0pt;line-height:
  107%;color:#000066'>Format</span><span style='font-size:9.0pt;line-height:
  107%'>(tFinish - tStart, </span><span style='font-size:9.0pt;line-height:
  107%;color:brown'>&quot;hh:mm:ss&quot;</span><span style='font-size:9.0pt;
  line-height:107%'>), oBlockSize &amp; </span><span style='font-size:9.0pt;
  line-height:107%;color:brown'>&quot; (&quot;</span><span style='font-size:
  9.0pt;line-height:107%'> &amp;</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>BLOCKSIZE &amp; </span><span style='font-size:9.0pt;
  line-height:107%;color:brown'>&quot;)&quot;</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Next</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Next</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>End</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Sub</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Private</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Function</span></b><span style='font-size:9.0pt;line-height:
  107%'> GetFileHash(</span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:107%'>
  sFile </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>String</span><span style='font-size:9.0pt;
  line-height:107%'>, </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:107%'>
  uBlockSize </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:107%'> </span><span
  style='font-size:9.0pt;line-height:107%;color:slateblue'>Double</span><span
  style='font-size:9.0pt;line-height:107%'>, </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>ByVal</span></b><span style='font-size:
  9.0pt;line-height:107%'> sHashType </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:slateblue'>String</span><span style='font-size:
  9.0pt;line-height:107%'>) </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><span style='font-size:9.0pt;line-height:107%;color:slateblue'>String</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Dim</span></b><span style='font-size:9.0pt;
  line-height:107%'> oFSO </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><span style='font-size:9.0pt;line-height:107%;color:slateblue'>Object</span><span
  style='font-size:9.0pt;line-height:107%'> </span><i><span style='font-size:
  9.0pt;line-height:107%;color:green'>' &quot;Scripting.FileSystemObject&quot;</span></i></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Dim</span></b><span style='font-size:9.0pt;
  line-height:107%'> oCSP </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><span style='font-size:9.0pt;line-height:107%;color:slateblue'>Object</span><span
  style='font-size:9.0pt;line-height:107%'> </span><i><span style='font-size:
  9.0pt;line-height:107%;color:green'>' One of the
  &quot;CryptoServiceProvider&quot;</span></i></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Dim</span></b><span style='font-size:9.0pt;
  line-height:107%'> oRnd </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:107%'>
  Random </span><i><span style='font-size:9.0pt;line-height:107%;color:green'>'
  &quot;Random&quot; Class by Microsoft, must be in the same file</span></i></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Dim</span></b><span style='font-size:9.0pt;
  line-height:107%'> uBytesRead </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Double</span><span style='font-size:9.0pt;line-height:107%'>,
  uBytesToRead </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:107%'> </span><span
  style='font-size:9.0pt;line-height:107%;color:slateblue'>Double</span><span
  style='font-size:9.0pt;line-height:107%'>, bDone </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>Boolean</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Dim</span></b><span style='font-size:9.0pt;
  line-height:107%'> aBlock() </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Byte</span><span style='font-size:9.0pt;line-height:107%'>,
  aBytes </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> Variant </span><i><span
  style='font-size:9.0pt;line-height:107%;color:green'>' Arrays to store bytes</span></i></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Dim</span></b><span style='font-size:9.0pt;
  line-height:107%'> aHash() </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><span style='font-size:9.0pt;line-height:107%;color:slateblue'>Byte</span><span
  style='font-size:9.0pt;line-height:107%'>, sHash </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>String</span><span style='font-size:9.0pt;
  line-height:107%'>, i </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><span style='font-size:9.0pt;line-height:107%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:85.1pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:112%'><span style='font-size:
  9.0pt;line-height:112%'> </span><i><span style='font-size:9.0pt;
  line-height:112%;color:green'>'Dim uFileSize As Double ' Un-Comment if
  GetFileHash() is to be used individually </span></i><span style='font-size:
  9.0pt;line-height:112%'></span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Set</span></b><span style='font-size:9.0pt;
  line-height:107%'> oRnd = </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>New</span></b><span style='font-size:9.0pt;line-height:107%'>
  Random </span><i><span style='font-size:9.0pt;line-height:107%;color:green'>'
  Class by Microsoft: Random</span></i></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Set</span></b><span style='font-size:9.0pt;
  line-height:107%'> oFSO = </span><span style='font-size:9.0pt;line-height:
  107%;color:#000066'>CreateObject</span><span style='font-size:9.0pt;
  line-height:107%'>(</span><span style='font-size:9.0pt;line-height:107%;
  color:brown'>&quot;Scripting.FileSystemObject&quot;</span><span
  style='font-size:9.0pt;line-height:107%'>)</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Set</span></b><span style='font-size:9.0pt;
  line-height:107%'> oCSP = </span><span style='font-size:9.0pt;line-height:
  107%;color:#000066'>CreateObject</span><span style='font-size:9.0pt;
  line-height:107%'>(</span><span style='font-size:9.0pt;line-height:107%;
  color:brown'>&quot;System.Security.Cryptography.&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> &amp; sHashType &amp; </span><span
  style='font-size:9.0pt;line-height:107%;color:brown'>&quot;CryptoServiceProvider&quot;</span><span
  style='font-size:9.0pt;line-height:107%'>)</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>If</span></b><span style='font-size:9.0pt;
  line-height:107%'> oFSO </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Is</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Nothing</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Or</span></b><span style='font-size:9.0pt;
  line-height:107%'> oRnd </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Is</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Nothing</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Or</span></b><span style='font-size:9.0pt;
  line-height:107%'> oCSP </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Is</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Nothing</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Then</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> MsgBox </span><span style='font-size:9.0pt;
  line-height:107%;color:brown'>&quot;One or more required objects cannot be
  created&quot;</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>GoTo</span></b><span style='font-size:9.0pt;
  line-height:107%'> CleanUp</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:186.4pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:112%'><span style='font-size:
  9.0pt;line-height:112%'> </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>End</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>If </span></b><span style='font-size:9.0pt;line-height:112%'>uFileSize
  = oFSO.GetFile(sFile).Size </span><i><span style='font-size:9.0pt;line-height:
  112%;color:green'>' FILELEN() has 2GB max!</span></i></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:149.2pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:112%'><span style='font-size:
  9.0pt;line-height:112%'> uBytesRead = </span><span style='font-size:9.0pt;
  line-height:112%;color:brown'>0 </span><span style='font-size:9.0pt;
  line-height:112%'>bDone = </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>False </span></b><span style='font-size:9.0pt;
  line-height:112%'>sHash = </span><span style='font-size:9.0pt;line-height:
  112%;color:slateblue'>String</span><span style='font-size:9.0pt;line-height:
  112%'>(oCSP.HashSize / </span><span style='font-size:9.0pt;line-height:112%;
  color:brown'>4</span><span style='font-size:9.0pt;line-height:112%'>, </span><span
  style='font-size:9.0pt;line-height:112%;color:brown'>&quot;0&quot;</span><span
  style='font-size:9.0pt;line-height:112%'>) </span><i><span style='font-size:
  9.0pt;line-height:112%;color:green'>' Each hexadecimal has 4 bits </span></i><span
  style='font-size:9.0pt;line-height:112%'></span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> Application.ScreenUpdating = </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>False</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><i><span style='font-size:9.0pt;
  line-height:107%;color:green'>' Process the file in chunks of uBlockSize or
  less</span></i></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:4.05in;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>If</span></b><span style='font-size:9.0pt;
  line-height:107%'> uFileSize = </span><span style='font-size:9.0pt;
  line-height:107%;color:brown'>0</span><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Then </span></b><span style='font-size:9.0pt;line-height:107%'></span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>ReDim</span></b><span
  style='font-size:9.0pt;line-height:107%'> aBlock(</span><span
  style='font-size:9.0pt;line-height:107%;color:brown'>0</span><span
  style='font-size:9.0pt;line-height:107%'>) oCSP.TransformFinalBlock
  aBlock, </span><span style='font-size:9.0pt;line-height:107%;color:brown'>0</span><span
  style='font-size:9.0pt;line-height:107%'>, </span><span style='font-size:
  9.0pt;line-height:107%;color:brown'>0</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
3.95pt;margin-left:-.45pt;text-indent:0in;line-height:107%'><img border=0
width=719 height=833 id="Picture 302210"
src="VBA%20Notes%20for%20Professionals_files/image428.gif"></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=534
 style='width:400.6pt;margin-left:1.0pt;border-collapse:collapse'>
 <tr style='height:13.65pt'>
  <td width=104 valign=top style='width:78.05pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>146,800,640</p>
  </td>
  <td width=430 valign=top style='width:322.5pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>clonezilla-live-2.2.2-37-amd64.iso</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=104 valign=top style='width:78.05pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>798,210,048</p>
  </td>
  <td width=430 valign=top style='width:322.5pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>HPIP201.2014_0902.29.iso</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=104 valign=top style='width:78.05pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>2,073,016,320</p>
  </td>
  <td width=430 valign=top style='width:322.5pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>SW_DVD5_Windows_Vista_Business_W32_32BIT_English.ISO</p>
  </td>
 </tr>
 <tr style='height:16.75pt'>
  <td width=104 valign=top style='width:78.05pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>4,380,387,328</p>
  </td>
  <td width=430 valign=top style='width:322.5pt;padding:0in 0in 0in 0in;
  height:16.75pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Win10_1607_English_x64.iso</p>
  </td>
 </tr>
 <tr style='height:13.65pt'>
  <td width=104 valign=top style='width:78.05pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>5,400,115,200</p>
  </td>
  <td width=430 valign=top style='width:322.5pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'>SW_DVD9_Windows_Svr_Std_and_DataCtr_2012_R2_64Bit_English.ISO</p>
  </td>
 </tr>
</table>

<h2 style='margin-left:-.25pt'><a name="_Toc308823">Section 39.3: Calculating
all Files Hash from a root Folder</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:13.05pt;
margin-left:.75pt'>Another variation from the code above gives you more
performance when you want to get hash codes of all files from a root folder
including all sub folders.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:.75pt'><b>Example of Worksheet:</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><img border=0 width=719
height=28 id="Picture 30564"
src="VBA%20Notes%20for%20Professionals_files/image429.jpg"></p>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:0in;margin-left:.75pt'>Code</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
0in;margin-left:-.45pt;text-indent:0in;line-height:107%'><img border=0
width=719 height=894 id="Picture 302212"
src="VBA%20Notes%20for%20Professionals_files/image430.gif"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:566.95pt;margin-bottom:
0in;margin-left:-28.35pt;text-indent:0in;line-height:107%'>&nbsp;</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=718
 style='width:538.6pt;border-collapse:collapse'>
 <tr style='height:771.0pt'>
  <td width=718 valign=top style='width:538.6pt;background:#FAFAFA;padding:
  2.55pt 5.65pt 0in 3.75pt;height:771.0pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> ProcessFolder oFSO.GetFolder(sRootFDR)</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:329.4pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:112%'><span style='font-size:
  9.0pt;line-height:112%'> Application.StatusBar = </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>False </span></b><span
  style='font-size:9.0pt;line-height:112%'>Application.ScreenUpdating = </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>True </span></b><span
  style='font-size:9.0pt;line-height:112%'>oCSP.Clear </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>Set</span></b><span
  style='font-size:9.0pt;line-height:112%'> oCSP = </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>Nothing</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Set</span></b><span style='font-size:9.0pt;
  line-height:107%'> oRng = </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Nothing</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Set</span></b><span style='font-size:9.0pt;
  line-height:107%'> oFSO = </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Nothing</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Set</span></b><span style='font-size:9.0pt;
  line-height:107%'> oRnd = </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Nothing</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> Debug.Print </span><span style='font-size:9.0pt;
  line-height:107%;color:brown'>&quot;Total file count: &quot;</span><span
  style='font-size:9.0pt;line-height:107%'> &amp; uFileCount</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>End</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Sub</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Private</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Sub</span></b><span style='font-size:9.0pt;line-height:107%'>
  ProcessFolder(</span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>ByRef</span></b><span style='font-size:9.0pt;line-height:107%'>
  oFDR </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>Object</span><span style='font-size:9.0pt;
  line-height:107%'>)</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Dim</span></b><span style='font-size:9.0pt;
  line-height:107%'> oFile </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><span style='font-size:9.0pt;line-height:107%;color:slateblue'>Object</span><span
  style='font-size:9.0pt;line-height:107%'>, oSubFDR </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>Object</span><span style='font-size:9.0pt;
  line-height:107%'>, sHash </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><span style='font-size:9.0pt;line-height:107%;color:slateblue'>String</span><span
  style='font-size:9.0pt;line-height:107%'>, dStart </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>Date</span><span style='font-size:9.0pt;
  line-height:107%'>, dFinish </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Date</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:307.8pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:112%'><span style='font-size:
  9.0pt;line-height:112%'> Application.ScreenUpdating = </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>False </span></b><span
  style='font-size:9.0pt;line-height:112%'></span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>For</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Each</span></b><span style='font-size:
  9.0pt;line-height:112%'> oFile </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>In</span></b><span style='font-size:9.0pt;
  line-height:112%'> oFDR.Files uFileCount = uFileCount + </span><span
  style='font-size:9.0pt;line-height:112%;color:brown'>1</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:.15in;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:112%'><span style='font-size:
  9.0pt;line-height:112%'> Application.StatusBar = uFileCount &amp; </span><span
  style='font-size:9.0pt;line-height:112%;color:brown'>&quot;: &quot;</span><span
  style='font-size:9.0pt;line-height:112%'> &amp; </span><span
  style='font-size:9.0pt;line-height:112%;color:#000066'>Right</span><span
  style='font-size:9.0pt;line-height:112%'>(oFile.Path, </span><span
  style='font-size:9.0pt;line-height:112%;color:brown'>255</span><span
  style='font-size:9.0pt;line-height:112%'> - Len(uFileCount) - </span><span
  style='font-size:9.0pt;line-height:112%;color:brown'>2</span><span
  style='font-size:9.0pt;line-height:112%'>) oCSP.Initialize </span><i><span
  style='font-size:9.0pt;line-height:112%;color:green'>' Reinitialize the
  CryptoServiceProvider </span></i><span style='font-size:9.0pt;line-height:
  112%'>dStart = Now sHash = GetFileHash(oFile, BLOCKSIZE,
  sHashType) dFinish = Now </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>With</span></b><span style='font-size:
  9.0pt;line-height:112%'> oRng</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> .Value = sHash</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> .Offset(</span><span style='font-size:
  9.0pt;line-height:107%;color:brown'>0</span><span style='font-size:9.0pt;
  line-height:107%'>, </span><span style='font-size:9.0pt;line-height:107%;
  color:brown'>1</span><span style='font-size:9.0pt;line-height:107%'>).Value =
  oFile.Size </span><i><span style='font-size:9.0pt;line-height:107%;
  color:green'>' File Size in bytes</span></i></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> .Offset(</span><span style='font-size:
  9.0pt;line-height:107%;color:brown'>0</span><span style='font-size:9.0pt;
  line-height:107%'>, </span><span style='font-size:9.0pt;line-height:107%;
  color:brown'>2</span><span style='font-size:9.0pt;line-height:107%'>).Value =
  oFile.Name </span><i><span style='font-size:9.0pt;line-height:107%;
  color:green'>' File name with extension</span></i></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> .Offset(</span><span style='font-size:
  9.0pt;line-height:107%;color:brown'>0</span><span style='font-size:9.0pt;
  line-height:107%'>, </span><span style='font-size:9.0pt;line-height:107%;
  color:brown'>3</span><span style='font-size:9.0pt;line-height:107%'>).Value =
  oFile.Path </span><i><span style='font-size:9.0pt;line-height:107%;
  color:green'>' Full File name and Path</span></i></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> .Offset(</span><span style='font-size:
  9.0pt;line-height:107%;color:brown'>0</span><span style='font-size:9.0pt;
  line-height:107%'>, </span><span style='font-size:9.0pt;line-height:107%;
  color:brown'>4</span><span style='font-size:9.0pt;line-height:107%'>).Value =
  FileDateTime(oFile.Path) </span><i><span style='font-size:9.0pt;line-height:
  107%;color:green'>' Last modification timestamp of file</span></i></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:36.8pt;margin-bottom:
  0in;margin-left:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:112%'><span style='font-size:9.0pt;line-height:
  112%'> .Offset(</span><span style='font-size:9.0pt;line-height:
  112%;color:brown'>0</span><span style='font-size:9.0pt;line-height:112%'>, </span><span
  style='font-size:9.0pt;line-height:112%;color:brown'>5</span><span
  style='font-size:9.0pt;line-height:112%'>).Value = dFinish - dStart </span><i><span
  style='font-size:9.0pt;line-height:112%;color:green'>' Time required to
  calculate hash code </span></i><span style='font-size:9.0pt;line-height:112%'></span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>End</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>With</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>If</span></b><span style='font-size:9.0pt;
  line-height:107%'> oRng.Row = Rows.Count </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Then</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><i><span style='font-size:9.0pt;
  line-height:107%;color:green'>' Max rows reached, start on Next sheet</span></i></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>If</span></b><span style='font-size:9.0pt;
  line-height:107%'> oRng.Worksheet.Index + </span><span style='font-size:9.0pt;
  line-height:107%;color:brown'>1</span><span style='font-size:9.0pt;
  line-height:107%'> &gt; ThisWorkbook.Worksheets.Count </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Then</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> MsgBox </span><span style='font-size:
  9.0pt;line-height:107%;color:brown'>&quot;All rows in all worksheets have
  been used, please create more sheets&quot;</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>End</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:1.35in;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:112%'><span style='font-size:
  9.0pt;line-height:112%'> </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>End</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>If </span></b><span style='font-size:9.0pt;line-height:112%'></span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>Set</span></b><span
  style='font-size:9.0pt;line-height:112%'> oRng =
  ThisWorkbook.Sheets(oRng.Worksheet.Index + </span><span style='font-size:
  9.0pt;line-height:112%;color:brown'>1</span><span style='font-size:9.0pt;
  line-height:112%'>).Range(</span><span style='font-size:9.0pt;line-height:
  112%;color:brown'>&quot;A3&quot;</span><span style='font-size:9.0pt;
  line-height:112%'>) oRng.Worksheet.Activate </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>Else</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><i><span style='font-size:9.0pt;
  line-height:107%;color:green'>' Move to next row otherwise</span></i></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Set</span></b><span style='font-size:9.0pt;
  line-height:107%'> oRng = oRng.Offset(</span><span style='font-size:9.0pt;
  line-height:107%;color:brown'>1</span><span style='font-size:9.0pt;
  line-height:107%'>)</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>End</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>If</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Next</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:318.6pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:112%'><span style='font-size:
  9.0pt;line-height:112%'> </span><i><span style='font-size:9.0pt;
  line-height:112%;color:green'>'Application.StatusBar = False </span></i><span
  style='font-size:9.0pt;line-height:112%'>Application.ScreenUpdating = </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>True </span></b><span
  style='font-size:9.0pt;line-height:112%'>oRng.Activate </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>For</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Each</span></b><span style='font-size:
  9.0pt;line-height:112%'> oSubFDR </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>In</span></b><span style='font-size:9.0pt;
  line-height:112%'> oFDR.SubFolders</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> ProcessFolder oSubFDR</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Next</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>End</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Sub</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Private</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Function</span></b><span style='font-size:9.0pt;line-height:
  107%'> GetFileHash(</span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:107%'>
  sFile </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>String</span><span style='font-size:9.0pt;
  line-height:107%'>, </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:107%'>
  uBlockSize </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:107%'> </span><span
  style='font-size:9.0pt;line-height:107%;color:slateblue'>Double</span><span
  style='font-size:9.0pt;line-height:107%'>, </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>ByVal</span></b><span style='font-size:
  9.0pt;line-height:107%'> sHashType </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:slateblue'>String</span><span style='font-size:
  9.0pt;line-height:107%'>) </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><span style='font-size:9.0pt;line-height:107%;color:slateblue'>String</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Dim</span></b><span style='font-size:9.0pt;
  line-height:107%'> uBytesRead </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Double</span><span style='font-size:9.0pt;line-height:107%'>,
  uBytesToRead </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:107%'> </span><span
  style='font-size:9.0pt;line-height:107%;color:slateblue'>Double</span><span
  style='font-size:9.0pt;line-height:107%'>, bDone </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>Boolean</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Dim</span></b><span style='font-size:9.0pt;
  line-height:107%'> aBlock() </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Byte</span><span style='font-size:9.0pt;line-height:107%'>,
  aBytes </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> Variant </span><i><span
  style='font-size:9.0pt;line-height:107%;color:green'>' Arrays to store bytes</span></i></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Dim</span></b><span style='font-size:9.0pt;
  line-height:107%'> aHash() </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><span style='font-size:9.0pt;line-height:107%;color:slateblue'>Byte</span><span
  style='font-size:9.0pt;line-height:107%'>, sHash </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>String</span><span style='font-size:9.0pt;
  line-height:107%'>, i </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><span style='font-size:9.0pt;line-height:107%;color:slateblue'>Long</span><span
  style='font-size:9.0pt;line-height:107%'>, oTmp </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> Variant</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:82.15pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:112%'><span style='font-size:
  9.0pt;line-height:112%'> </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Dim</span></b><span style='font-size:9.0pt;
  line-height:112%'> uFileSize </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Double</span><span style='font-size:9.0pt;line-height:112%'>
  </span><i><span style='font-size:9.0pt;line-height:112%;color:green'>'
  Un-Comment if GetFileHash() is to be used individually </span></i><span
  style='font-size:9.0pt;line-height:112%'></span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>If</span></b><span style='font-size:9.0pt;
  line-height:107%'> oRnd </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Is</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Nothing</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Then</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Set</span></b><span style='font-size:9.0pt;line-height:107%'>
  oRnd = </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>New</span></b><span
  style='font-size:9.0pt;line-height:107%'> Random </span><i><span
  style='font-size:9.0pt;line-height:107%;color:green'>' Class by Microsoft:
  Random</span></i></p>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:112%'><span style='font-size:9.0pt;line-height:
  112%'> </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>If</span></b><span
  style='font-size:9.0pt;line-height:112%'> oFSO </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>Is</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Nothing</span></b><span style='font-size:
  9.0pt;line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:
  112%;color:blue'>Then</span></b><span style='font-size:9.0pt;line-height:
  112%'> </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>Set</span></b><span
  style='font-size:9.0pt;line-height:112%'> oFSO = </span><span
  style='font-size:9.0pt;line-height:112%;color:#000066'>CreateObject</span><span
  style='font-size:9.0pt;line-height:112%'>(</span><span style='font-size:9.0pt;
  line-height:112%;color:brown'>&quot;Scripting.FileSystemObject&quot;</span><span
  style='font-size:9.0pt;line-height:112%'>) </span><i><span style='font-size:
  9.0pt;line-height:112%;color:green'>' Just to get correct FileSize</span></i></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>If</span></b><span
  style='font-size:9.0pt;line-height:107%'> oCSP </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Is</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Nothing</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Then</span></b><span style='font-size:9.0pt;line-height:
  107%'> </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Set</span></b><span
  style='font-size:9.0pt;line-height:107%'> oCSP = </span><span
  style='font-size:9.0pt;line-height:107%;color:#000066'>CreateObject</span><span
  style='font-size:9.0pt;line-height:107%'>(</span><span style='font-size:9.0pt;
  line-height:107%;color:brown'>&quot;System.Security.Cryptography.&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> &amp; sHashType &amp;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
0in;margin-left:-.45pt;text-indent:0in;line-height:107%'><img border=0
width=719 height=941 id="Picture 302217"
src="VBA%20Notes%20for%20Professionals_files/image431.gif"></p>

<h1 style='margin-left:-.25pt'><a name="_Toc308824">Chapter 40: Sorting</a></h1>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.8pt;
margin-left:.75pt'>Unlike the .NET framework, the Visual Basic for Applications
library does not include routines to sort arrays.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:18.2pt;
margin-left:.75pt'>There are two types of workarounds: 1) implementing a
sorting algorithm from scratch, or 2) using sorting routines in other
commonly-available libraries.</p>

<h2 style='margin-left:-.25pt'><a name="_Toc308825">Section 40.1: Algorithm
Implementation - Quick Sort on a One-Dimensional Array</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.9in;margin-bottom:0in;
margin-left:-.25pt'>From <a
href="http://stackoverflow.com/questions/152319/vba-array-sort-function"><span
style='color:#193C96'>VBA array sort function?</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=601
src="VBA%20Notes%20for%20Professionals_files/image432.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc308826">Section 40.2: Using the
Excel Library to Sort a OneDimensional Array</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.85pt;
margin-left:.75pt'>This code takes advantage of the <span style='font-size:
9.0pt;line-height:110%;background:#FAFAFA'>Sort</span> class in the Microsoft
Excel Object Library.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:13.3pt;
margin-left:.75pt'>For further reading, see:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.9in;margin-bottom:1.45pt;
margin-left:21.4pt'><span style='font-size:11.0pt;line-height:110%'><img
border=0 width=5 height=5 id="Group 294998"
src="VBA%20Notes%20for%20Professionals_files/image167.gif"></span><u><span
style='color:#193C96'></span></u><a
href="http://stackoverflow.com/questions/28616373/copy-a-range-to-a-virtual-range"><span
style='color:#193C96'>Copy a range to a virtual range</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
0in;margin-left:-.45pt;text-indent:0in;line-height:107%'><img border=0
width=719 height=1024 id="Picture 302222"
src="VBA%20Notes%20for%20Professionals_files/image433.gif"></p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=202
src="VBA%20Notes%20for%20Professionals_files/image434.gif"></span><br
clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc308827">Chapter 41: Frequently used
string manipulation</a></h1>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.8pt;
margin-left:.75pt'>Quick examples for MID LEFT and RIGHT string functions using
INSTR FIND and LEN.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:11.55pt;margin-bottom:
.25pt;margin-left:.75pt;text-align:justify;text-justify:inter-ideograph;
line-height:135%'>How do you find the text between two search terms (Say: after
a colon and before a comma)? How do you get the remainder of a word (using MID
or using RIGHT)? Which of these functions use Zero-based params and return
codes vs One-based? What happens when things go wrong? How do they handle empty
strings, unfound results and negative numbers?</p>

<h2 style='margin-top:0in;margin-right:11.55pt;margin-bottom:.25pt;margin-left:
.75pt;text-align:justify;text-justify:inter-ideograph;line-height:135%'><a
name="_Toc308828">Section 41.1: String manipulation frequently used examples</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Better MID() and other string extraction examples, currently
lacking from the web. Please help me make a good example, or complete this one
here. Something like this:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
0in;margin-left:-.45pt;text-indent:0in;line-height:107%'><img border=0
width=719 height=715 id="Picture 302230"
src="VBA%20Notes%20for%20Professionals_files/image435.gif"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=54
src="VBA%20Notes%20for%20Professionals_files/image436.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Please feel free to edit this example and make it better. As
long as it remains clear, and has in it common usage practices.<br clear=all
style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc308829">Chapter 42: Automation or
Using other applications Libraries</a></h1>

<p class=MsoNormal style='margin-top:0in;margin-right:5.0pt;margin-bottom:.25pt;
margin-left:.75pt;text-align:justify;text-justify:inter-ideograph;line-height:
135%'>If you use the objects in other applications as part of your Visual Basic
application, you may want to establish a reference to the object libraries of
those applications. This Documentation provides a list, sources and examples of
how to use libraries of different softwares, like Windows Shell, Internet
Explorer, XML HttpRequest, and others.</p>

<h2 style='margin-top:0in;margin-right:5.0pt;margin-bottom:.25pt;margin-left:
.75pt;text-align:justify;text-justify:inter-ideograph;line-height:135%'><a
name="_Toc308830">Section 42.1: VBScript Regular Expressions</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="VBA%20Notes%20for%20Professionals_files/image437.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Tools&gt; References&gt; Microsoft VBScript Regular
Expressions #.#</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Associated DLL: VBScript.dll</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.8pt;
margin-left:.75pt'>Source: Internet Explorer 1.0 and 5.5</p>

<p class=MsoNormal style='margin-top:0in;margin-right:158.65pt;margin-bottom:
1.45pt;margin-left:21.4pt'><img width=5 height=1
src="VBA%20Notes%20for%20Professionals_files/image172.gif" align=left
hspace=12><a href="https://msdn.microsoft.com/en-us/library/ms974570.aspx"><span
style='color:#193C96'>MSDN-Microsoft Beefs Up VBScript with Regular Expressions
</span></a><a
href="https://msdn.microsoft.com/en-us/library/1400241x(VS.85).aspx"><span
style='color:#193C96'>MSDN-Regular Expression Syntax (Scripting)</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.9in;margin-bottom:9.8pt;
margin-left:21.4pt'><a
href="https://www.experts-exchange.com/articles/1336/Using-Regular-Expressions-in-Visual-Basic-for-Applications-and-Visual-Basic-6.html"><span
style='color:#193C96'>experts-exchange - Using Regular Expressions in Visual
Basic for Applications and Visual Basic 6 </span></a><a
href="http://stackoverflow.com/q/22542834/4636801"><span style='color:#193C96'>How
to use Regular Expressions (Regex) in Microsoft Excel both in-cell and loops</span></a>
on SO. <a href="http://www.regular-expressions.info/vbscript.html"><span
style='color:#193C96'>regular-expressions.info/vbscript </span></a><a
href="http://www.regular-expressions.info/vbscriptexample.html"><span
style='color:#193C96'>regular-expressions.info/vbscriptexample </span></a><a
href="https://en.wikipedia.org/wiki/Regular_expression"><span style='color:
#193C96'>WIKI-Regular expression</span></a></p>

<h3 style='margin-top:0in;margin-right:0in;margin-bottom:13.2pt;margin-left:
.75pt;line-height:110%'><span style='font-size:10.0pt;line-height:110%;
color:black'>Code</span></h3>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>You can use this functions to get RegEx results, concatenate
all matches (if more than 1) into 1 string, and display result in excel cell.</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=720 height=467
src="VBA%20Notes%20for%20Professionals_files/image438.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=317
src="VBA%20Notes%20for%20Professionals_files/image439.gif"></span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:4.2pt;margin-left:
-.25pt'><a name="_Toc308831">Section 42.2: Scripting File System Object</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:17.25pt;
margin-left:3.5pt'><span style='position:relative;z-index:-1895763968'><span
style='left:0px;position:absolute;left:0px;top:-115929px;width:718px;
height:1px'><img width=718 height=1
src="VBA%20Notes%20for%20Professionals_files/image144.gif"></span></span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Set</span></b><span
style='font-size:9.0pt;line-height:110%'> createScriptingFileSystemObject = </span><span
style='font-size:9.0pt;line-height:110%;color:#000066'>CreateObject</span><span
style='font-size:9.0pt;line-height:110%'>(</span><span style='font-size:9.0pt;
line-height:110%;color:brown'>&quot;Scripting.FileSystemObject&quot;</span><span
style='font-size:9.0pt;line-height:110%'>)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Tools&gt; References&gt; Microsoft Scripting Runtime</p>

<p class=MsoNormal style='margin-top:0in;margin-right:5.3in;margin-bottom:12.45pt;
margin-left:.75pt'>Associated DLL: ScrRun.dll Source: Windows OS</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.9in;margin-bottom:24.0pt;
margin-left:-.25pt'><a
href="https://msdn.microsoft.com/en-us/library/aa711216(v=vs.71).aspx"><span
style='color:#193C96'>MSDN-Accessing Files with FileSystemObject</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:13.45pt;margin-bottom:
34.85pt;margin-left:24.5pt'><img width=3 height=1
src="VBA%20Notes%20for%20Professionals_files/image168.gif" align=left
hspace=12>The File System Object (FSO) model provides an object-based tool for
working with folders and files. It allows you to use the familiar object.method
syntax with a rich set of properties, methods, and events to process folders
and files. You can also employ the traditional Visual Basic statements and
commands.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:24.95pt;margin-bottom:
23.65pt;margin-left:24.5pt'>The FSO model gives your application the ability to
create, alter, move, and delete folders, or to determine if and where
particular folders exist. It also enables you to get information about folders,
such as their names and the date they were created or last modified.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:9.75pt;margin-bottom:
1.85pt;margin-left:.75pt'><a
href="https://msdn.microsoft.com/en-us/library/6kxy1a51(v=vs.84).aspx"><span
style='color:#193C96'>MSDN-FileSystemObject topics</span></a>: &quot;<i>...explain
the concept of the FileSystemObject and how to use it.</i>&quot; <a
href="http://www.exceltrick.com/formulas_macros/filesystemobject-in-vba/"><span
style='color:#193C96'>exceltrick-</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.9in;margin-bottom:1.45pt;
margin-left:-.25pt'><a
href="http://www.exceltrick.com/formulas_macros/filesystemobject-in-vba/"><span
style='color:#193C96'>FileSystemObject in VBA </span></a><a
href="http://www.exceltrick.com/formulas_macros/filesystemobject-in-vba/"><span
style='font-family:"Arial",sans-serif;color:#193C96'></span></a><a
href="http://www.exceltrick.com/formulas_macros/filesystemobject-in-vba/"><span
style='color:#193C96'> Explained</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:192.7pt;margin-bottom:
0in;margin-left:-.25pt;line-height:145%'>Scripting.FileSystemObject</p>

<h2 style='margin-top:0in;margin-right:192.7pt;margin-bottom:0in;margin-left:
-.25pt;line-height:145%'><a name="_Toc308832">Section 42.3: Scripting
Dictionary object</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=26
src="VBA%20Notes%20for%20Professionals_files/image440.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Tools&gt; References&gt; Microsoft Scripting Runtime</p>

<p class=MsoNormal style='margin-top:0in;margin-right:5.3in;margin-bottom:12.45pt;
margin-left:.75pt'>Associated DLL: ScrRun.dll Source: Windows OS</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Scripting.Dictionary object</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.9in;margin-bottom:1.45pt;
margin-left:-.25pt'><a
href="https://msdn.microsoft.com/en-us/library/x4k5wbx4(v=vs.84).aspx"><span
style='color:#193C96'>MSDN-Dictionary Object</span></a></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:4.2pt;margin-left:
-.25pt'><a name="_Toc308833">Section 42.4: Internet Explorer Object</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:17.25pt;
margin-left:3.5pt'><span style='position:relative;z-index:-1895761920'><span
style='left:0px;position:absolute;left:0px;top:-116606px;width:718px;
height:1px'><img width=718 height=1
src="VBA%20Notes%20for%20Professionals_files/image144.gif"></span></span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Set</span></b><span
style='font-size:9.0pt;line-height:110%'> createInternetExplorerObject = </span><span
style='font-size:9.0pt;line-height:110%;color:#000066'>CreateObject</span><span
style='font-size:9.0pt;line-height:110%'>(</span><span style='font-size:9.0pt;
line-height:110%;color:brown'>&quot;InternetExplorer.Application&quot;</span><span
style='font-size:9.0pt;line-height:110%'>)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Tools&gt; References&gt; Microsoft Internet Controls</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Associated DLL: ieframe.dll</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.8pt;
margin-left:.75pt'>Source: Internet Explorer Browser</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.9in;margin-bottom:9.55pt;
margin-left:-.25pt'><a
href="https://msdn.microsoft.com/en-us/library/aa752084(v=vs.85).aspx"><span
style='color:#193C96'>MSDN-InternetExplorer object</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.35pt;
margin-left:0in;text-indent:0in'><span style='font-size:11.0pt;line-height:
110%'> <img border=0 width=3 height=51 id="Group 297250"
src="VBA%20Notes%20for%20Professionals_files/image441.gif"></span> Controls
an instance of Windows Internet Explorer through automation.</p>

<h4 style='margin-left:.75pt'>Internet Explorer Objec Basic Members</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:14.1pt;
margin-left:.75pt'>The code below should introduce how the IE object works and
how to manipulate it through VBA. I recommend stepping through it, otherwise it
might error out during multiple navigations.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Sub</span></b><span
style='font-size:9.0pt;line-height:110%'> IEGetToKnow()</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.05pt;margin-bottom:.25pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Dim</span></b><span
style='font-size:9.0pt;line-height:110%'> IE </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>As</span></b><span style='font-size:9.0pt;
line-height:110%'> InternetExplorer </span><i><span style='font-size:9.0pt;
line-height:110%;color:green'>'Reference to Microsoft Internet Controls</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Set</span></b><span
style='font-size:9.0pt;line-height:110%'> IE = </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>New</span></b><span
style='font-size:9.0pt;line-height:110%'> InternetExplorer</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
margin-left:3.75pt;text-indent:0in;line-height:107%'><span style='font-size:
9.0pt;line-height:107%'> </span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>With</span></b><span
style='font-size:9.0pt;line-height:110%'> IE</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.05pt;margin-bottom:.25pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'>
.Visible = </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>True</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><i><span style='font-size:
9.0pt;line-height:110%;color:green'>'Sets or gets a value that indicates
whether the object is visible or hidden.</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
margin-left:3.75pt;text-indent:0in;line-height:107%'><span style='font-size:
9.0pt;line-height:107%'> </span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.05pt;margin-bottom:.25pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'> </span><i><span
style='font-size:9.0pt;line-height:110%;color:green'>'Navigation</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.05pt;margin-bottom:.25pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'>
.Navigate2 </span><span style='font-size:9.0pt;line-height:110%;color:brown'>&quot;http://www.example.com&quot;</span><span
style='font-size:9.0pt;line-height:110%'> </span><i><span style='font-size:
9.0pt;line-height:110%;color:green'>'Navigates the browser to a location that
might not be expressed as a URL, such as a PIDL for an entity in the Windows
Shell namespace.</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.05pt;margin-bottom:.25pt;
margin-left:3.5pt'><span style='position:relative;z-index:-1895760896'><span
style='left:0px;position:absolute;left:0px;top:-117099px;width:718px;
height:1px'><img width=718 height=1
src="VBA%20Notes%20for%20Professionals_files/image442.gif"></span></span><span
style='font-size:9.0pt;line-height:110%'> Debug.Print .Busy </span><i><span
style='font-size:9.0pt;line-height:110%;color:green'>'Gets a value that
indicates whether the object is engaged in a navigation or downloading
operation.</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.05pt;margin-bottom:.25pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'>
Debug.Print .ReadyState </span><i><span style='font-size:9.0pt;line-height:
110%;color:green'>'Gets the ready state of the object.</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'>
.Navigate2 </span><span style='font-size:9.0pt;line-height:110%;color:brown'>&quot;http://www.example.com/2&quot;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.05pt;margin-bottom:.25pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'>
.GoBack </span><i><span style='font-size:9.0pt;line-height:110%;color:green'>'Navigates
backward one item in the history list</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.05pt;margin-bottom:.25pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'>
.GoForward </span><i><span style='font-size:9.0pt;line-height:110%;color:green'>'Navigates
forward one item in the history list.</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.05pt;margin-bottom:.25pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'>
.GoHome </span><i><span style='font-size:9.0pt;line-height:110%;color:green'>'Navigates
to the current home or start page.</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.05pt;margin-bottom:.25pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'> .</span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Stop</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><i><span style='font-size:
9.0pt;line-height:110%;color:green'>'Cancels a pending navigation or download,
and stops dynamic page elements, such as background sounds and animations.</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.05pt;margin-bottom:.25pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'>
.Refresh </span><i><span style='font-size:9.0pt;line-height:110%;color:green'>'Reloads
the file that is currently displayed in the object.</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
margin-left:3.75pt;text-indent:0in;line-height:107%'><span style='font-size:
9.0pt;line-height:107%'> </span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.05pt;margin-bottom:.25pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'>
Debug.Print .Silent </span><i><span style='font-size:9.0pt;line-height:110%;
color:green'>'Sets or gets a value that indicates whether the object can
display dialog boxes.</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:88.0pt;margin-bottom:
.25pt;margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'>
Debug.Print .Type </span><i><span style='font-size:9.0pt;line-height:110%;
color:green'>'Gets the user type name of the contained document object. </span></i><span
style='font-size:9.0pt;line-height:110%'></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.05pt;margin-bottom:.25pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'>
Debug.Print .Top </span><i><span style='font-size:9.0pt;line-height:110%;
color:green'>'Sets or gets the coordinate of the top edge of the object.</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.05pt;margin-bottom:.25pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'>
Debug.Print .Left </span><i><span style='font-size:9.0pt;line-height:110%;
color:green'>'Sets or gets the coordinate of the left edge of the object.</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:118.2pt;margin-bottom:
.25pt;margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'>
Debug.Print .Height </span><i><span style='font-size:9.0pt;line-height:110%;
color:green'>'Sets or gets the height of the object. </span></i><span
style='font-size:9.0pt;line-height:110%'>Debug.Print .Width </span><i><span
style='font-size:9.0pt;line-height:110%;color:green'>'Sets or gets the width of
the object.</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>End</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>With</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
margin-left:3.75pt;text-indent:0in;line-height:107%'><span style='font-size:
9.0pt;line-height:107%'> </span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:300.6pt;margin-bottom:
21.25pt;margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'>
IE.Quit </span><i><span style='font-size:9.0pt;line-height:110%;color:green'>'close
the application window </span></i><b><span style='font-size:9.0pt;line-height:
110%;color:blue'>End</span></b><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Sub</span></b></p>

<h4 style='margin-left:.75pt'>Web Scraping</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>The most common thing to do with IE is to scrape some
information of a website, or to fill a website form and submit information. We
will look at how to do it.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>Let us consider <a href="http://www.example.com/"><i><span
style='color:#193C96'>example.com</span></i></a> source code:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=720 height=339
src="VBA%20Notes%20for%20Professionals_files/image443.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:14.45pt;
margin-left:.75pt'>We can use code like below to get and set information:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Sub</span></b><span
style='font-size:9.0pt;line-height:110%'> IEWebScrape1()</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.05pt;margin-bottom:.25pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Dim</span></b><span
style='font-size:9.0pt;line-height:110%'> IE </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>As</span></b><span style='font-size:9.0pt;
line-height:110%'> InternetExplorer </span><i><span style='font-size:9.0pt;
line-height:110%;color:green'>'Reference to Microsoft Internet Controls</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Set</span></b><span
style='font-size:9.0pt;line-height:110%'> IE = </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>New</span></b><span
style='font-size:9.0pt;line-height:110%'> InternetExplorer</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
margin-left:3.75pt;text-indent:0in;line-height:107%'><span style='font-size:
9.0pt;line-height:107%'> </span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>With</span></b><span
style='font-size:9.0pt;line-height:110%'> IE</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'>
.Visible = </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>True</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.2pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'>
.Navigate2 </span><span style='font-size:9.0pt;line-height:110%;color:brown'>&quot;http://www.example.com&quot;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
margin-left:3.75pt;text-indent:0in;line-height:107%'><span style='font-size:
9.0pt;line-height:107%'> </span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.05pt;margin-bottom:.25pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'> </span><i><span
style='font-size:9.0pt;line-height:110%;color:green'>'we add a loop to be sure
the website is loaded and ready.</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.05pt;margin-bottom:.25pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'> </span><i><span
style='font-size:9.0pt;line-height:110%;color:green'>'Does not work
consistently. Cannot be relied upon.</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.05pt;margin-bottom:.25pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Do</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>While</span></b><span style='font-size:9.0pt;
line-height:110%'> .Busy = </span><b><span style='font-size:9.0pt;line-height:
110%;color:blue'>True</span></b><span style='font-size:9.0pt;line-height:110%'>
</span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Or</span></b><span
style='font-size:9.0pt;line-height:110%'> .ReadyState &lt;&gt;
READYSTATE_COMPLETE </span><i><span style='font-size:9.0pt;line-height:110%;
color:green'>'Equivalent = .ReadyState &lt;&gt; 4 </span></i><span
style='font-size:9.0pt;line-height:110%'></span><i><span
style='font-size:9.0pt;line-height:110%;color:green'>' DoEvents - worth
considering. Know implications before you use it.</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'>
Application.Wait (Now + </span><span style='font-size:9.0pt;line-height:110%;
color:#000066'>TimeValue</span><span style='font-size:9.0pt;line-height:110%'>(</span><span
style='font-size:9.0pt;line-height:110%;color:brown'>&quot;00:00:01&quot;</span><span
style='font-size:9.0pt;line-height:110%'>)) </span><i><span style='font-size:
9.0pt;line-height:110%;color:green'>'Wait 1 second, then check again.</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Loop</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
margin-left:3.75pt;text-indent:0in;line-height:107%'><span style='font-size:
9.0pt;line-height:107%'> </span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.05pt;margin-bottom:.25pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'> </span><i><span
style='font-size:9.0pt;line-height:110%;color:green'>'Print info in immediate
window</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.05pt;margin-bottom:.25pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>With</span></b><span
style='font-size:9.0pt;line-height:110%'> .Document </span><i><span
style='font-size:9.0pt;line-height:110%;color:green'>'the source code HTML
&quot;below&quot; the displayed page.</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.05pt;margin-bottom:.25pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Stop</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><i><span style='font-size:
9.0pt;line-height:110%;color:green'>'VBE Stop. Continue line by line to see
what happens.</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'>
Debug.Print .GetElementsByTagName(</span><span style='font-size:9.0pt;
line-height:110%;color:brown'>&quot;title&quot;</span><span style='font-size:
9.0pt;line-height:110%'>)(</span><span style='font-size:9.0pt;line-height:110%;
color:brown'>0</span><span style='font-size:9.0pt;line-height:110%'>).innerHtml
</span><i><span style='font-size:9.0pt;line-height:110%;color:green'>'prints
&quot;Example Domain&quot;</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:57.05pt;margin-bottom:
0in;margin-left:3.75pt;text-align:justify;text-justify:inter-ideograph;
text-indent:0in;line-height:112%'><span style='font-size:9.0pt;line-height:
112%'> Debug.Print .GetElementsByTagName(</span><span
style='font-size:9.0pt;line-height:112%;color:brown'>&quot;h1&quot;</span><span
style='font-size:9.0pt;line-height:112%'>)(</span><span style='font-size:9.0pt;
line-height:112%;color:brown'>0</span><span style='font-size:9.0pt;line-height:
112%'>).innerHtml </span><i><span style='font-size:9.0pt;line-height:112%;
color:green'>'prints &quot;Example Domain&quot; </span></i><span
style='font-size:9.0pt;line-height:112%'>Debug.Print
.GetElementsByTagName(</span><span style='font-size:9.0pt;line-height:112%;
color:brown'>&quot;p&quot;</span><span style='font-size:9.0pt;line-height:112%'>)(</span><span
style='font-size:9.0pt;line-height:112%;color:brown'>0</span><span
style='font-size:9.0pt;line-height:112%'>).innerHtml </span><i><span
style='font-size:9.0pt;line-height:112%;color:green'>'prints &quot;This domain
is established...&quot;</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.05pt;margin-bottom:.25pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'>
Debug.Print .GetElementsByTagName(</span><span style='font-size:9.0pt;
line-height:110%;color:brown'>&quot;p&quot;</span><span style='font-size:9.0pt;
line-height:110%'>)(</span><span style='font-size:9.0pt;line-height:110%;
color:brown'>1</span><span style='font-size:9.0pt;line-height:110%'>).innerHtml
</span><i><span style='font-size:9.0pt;line-height:110%;color:green'>'prints
&quot;&lt;a href=&quot;http://www.iana.org/domains/example&quot;&gt;More
information...&lt;/a&gt;&quot;</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.5in;margin-bottom:.2pt;
margin-left:3.5pt'><span style='position:relative;z-index:-1895759872'><span
style='left:0px;position:absolute;left:0px;top:-118341px;width:718px;
height:1px'><img width=718 height=1
src="VBA%20Notes%20for%20Professionals_files/image444.gif"></span></span><span
style='font-size:9.0pt;line-height:110%'> Debug.Print
.GetElementsByTagName(</span><span style='font-size:9.0pt;line-height:110%;
color:brown'>&quot;p&quot;</span><span style='font-size:9.0pt;line-height:110%'>)(</span><span
style='font-size:9.0pt;line-height:110%;color:brown'>1</span><span
style='font-size:9.0pt;line-height:110%'>).innerText </span><i><span
style='font-size:9.0pt;line-height:110%;color:green'>'prints &quot;More
information...&quot; </span></i><span style='font-size:9.0pt;line-height:110%'>Debug.Print
.GetElementsByTagName(</span><span style='font-size:9.0pt;line-height:110%;
color:brown'>&quot;a&quot;</span><span style='font-size:9.0pt;line-height:110%'>)(</span><span
style='font-size:9.0pt;line-height:110%;color:brown'>0</span><span
style='font-size:9.0pt;line-height:110%'>).innerText </span><i><span
style='font-size:9.0pt;line-height:110%;color:green'>'prints &quot;More
information...&quot; </span></i><span style='font-size:9.0pt;line-height:110%'></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.05pt;margin-bottom:.25pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'> </span><i><span
style='font-size:9.0pt;line-height:110%;color:green'>'We can change the localy
displayed website. Don't worry about breaking the site.</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'>
.GetElementsByTagName(</span><span style='font-size:9.0pt;line-height:110%;
color:brown'>&quot;title&quot;</span><span style='font-size:9.0pt;line-height:
110%'>)(</span><span style='font-size:9.0pt;line-height:110%;color:brown'>0</span><span
style='font-size:9.0pt;line-height:110%'>).innerHtml = </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>&quot;Psst,
scraping...&quot;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.05pt;margin-bottom:.25pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'>
.GetElementsByTagName(</span><span style='font-size:9.0pt;line-height:110%;
color:brown'>&quot;h1&quot;</span><span style='font-size:9.0pt;line-height:
110%'>)(</span><span style='font-size:9.0pt;line-height:110%;color:brown'>0</span><span
style='font-size:9.0pt;line-height:110%'>).innerHtml = </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>&quot;Let me try something
fishy.&quot;</span><span style='font-size:9.0pt;line-height:110%'> </span><i><span
style='font-size:9.0pt;line-height:110%;color:green'>'You have just changed the
local HTML of the site.</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'>
.GetElementsByTagName(</span><span style='font-size:9.0pt;line-height:110%;
color:brown'>&quot;p&quot;</span><span style='font-size:9.0pt;line-height:110%'>)(</span><span
style='font-size:9.0pt;line-height:110%;color:brown'>0</span><span
style='font-size:9.0pt;line-height:110%'>).innerHtml = </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>&quot;Lorem
ipsum........... The End&quot;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'>
.GetElementsByTagName(</span><span style='font-size:9.0pt;line-height:110%;
color:brown'>&quot;a&quot;</span><span style='font-size:9.0pt;line-height:110%'>)(</span><span
style='font-size:9.0pt;line-height:110%;color:brown'>0</span><span
style='font-size:9.0pt;line-height:110%'>).innerText = </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>&quot;iana.org&quot;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.05pt;margin-bottom:.25pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>End</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>With</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><i><span style='font-size:9.0pt;line-height:110%;
color:green'>'.document</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
margin-left:3.75pt;text-indent:0in;line-height:107%'><span style='font-size:
9.0pt;line-height:107%'> </span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.05pt;margin-bottom:.25pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'> .Quit
</span><i><span style='font-size:9.0pt;line-height:110%;color:green'>'close the
application window</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.2pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=54
src="VBA%20Notes%20for%20Professionals_files/image445.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>What is going on? The key player here is the <b>.Document</b>,
that is the HTML source code. We can apply some queries to get the Collections
or Object we want.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=389 style='width:4.05in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=14 valign=top style='width:.15in;background:#FAFAFA;padding:1.65pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>IE</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.65pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;background:#FAFAFA'>.</span></p>
  </td>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:1.65pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Document</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.65pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;background:#FAFAFA'>.</span></p>
  </td>
  <td width=144 valign=top style='width:1.5in;background:#FAFAFA;padding:1.65pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>GetElementsByTagName</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.65pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;background:#FAFAFA'>(</span></p>
  </td>
  <td width=50 valign=top style='width:37.8pt;background:#FAFAFA;padding:1.65pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:brown'>&quot;title&quot;</span></p>
  </td>
  <td width=36 valign=top style='width:27.0pt;padding:1.65pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;background:#FAFAFA'>)(</span><span style='font-size:9.0pt;line-height:
  107%;color:brown;background:#FAFAFA'>0</span><span style='font-size:9.0pt;
  line-height:107%;background:#FAFAFA'>).</span></p>
  </td>
  <td width=65 valign=top style='width:48.6pt;background:#FAFAFA;padding:1.65pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>innerHtml</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>For example the . <span style='font-size:9.0pt;line-height:
110%;background:#FAFAFA'>GetElementsByTagName</span> returns a</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.65pt;
margin-left:.75pt'><b>Collection</b> of HTML Elements, that have the &quot;<i>title</i>&quot;
tag. There is only one such tag in the source code. The <b>Collection </b>is
0-based. So to get the first element we add <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>(</span><span style='font-size:9.0pt;
line-height:110%;color:brown;background:#FAFAFA'>0</span><span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>)</span>. Now, in
our case, we want only the <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>innerHtml</span> (a String), not the Element Object itself.
So we specify the property we want.</p>

<h4 style='margin-left:.75pt'>Click</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>To follow a link on a site, we can use multiple methods:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:19.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=404
src="VBA%20Notes%20for%20Professionals_files/image446.gif"></span></p>

<h4 style='margin-left:.75pt'>Microsoft HTML Object Library or IE Best friend</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.7pt;
margin-left:.75pt'>To get the most out of the HTML that gets loaded into the
IE, you can (or should) use another Library, i.e. <i>Microsoft HTML Object
Library</i>. More about this in another example.</p>

<h4 style='margin-left:.75pt'>IE Main issues</h4>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=79 style='width:59.4pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=79 valign=top style='width:59.4pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Do</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>While</span></b><span
  style='font-size:9.0pt;line-height:107%'>...</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.55pt;
margin-left:.75pt'>The main issue with IE is verifying that the page is done
loading and is ready to be interacted with. The <b><span style='font-size:9.0pt;
line-height:110%;color:blue;background:#FAFAFA'>Loop</span></b> helps, but is
not reliable.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Also, using IE just to scrape HTML content is OVERKILL. Why?
Because the Browser is meant for browsing, i.e.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>displaying the web page with all the CSS, JavaScripts,
Pictures, Popups, etc. If you only need the raw data, consider different
approach. E.g. using <a href="https://en.wikipedia.org/wiki/XMLHttpRequest"><span
style='color:#193C96'>XML HTTPRequest</span></a>. More about this in another
example.</p>

<h1 style='margin-left:-.25pt'><a name="_Toc308834">Chapter 43: VBA Run-Time
Errors</a></h1>

<p class=MsoNormal style='margin-top:0in;margin-right:14.9pt;margin-bottom:
.25pt;margin-left:.75pt;text-align:justify;text-justify:inter-ideograph;
line-height:135%'>Code that compiles can still run into errors, at run-time.
This topic lists the most common ones, their causes, and how to avoid them.</p>

<h2 style='margin-top:0in;margin-right:14.9pt;margin-bottom:.25pt;margin-left:
.75pt;text-align:justify;text-justify:inter-ideograph;line-height:135%'><a
name="_Toc308835">Section 43.1: Run-time error '6': Overflow</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:4.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=124
src="VBA%20Notes%20for%20Professionals_files/image447.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.2pt;
margin-left:.75pt'><b>Why doesn't this work?</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>The <span style='font-size:9.0pt;line-height:110%;
color:slateblue;background:#FAFAFA'>Integer</span> data type is a 16-bit signed
integer with a maximum value of 32,767; assigning it to anything larger than
that will <i>overflow</i> the type and raise this error.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:4.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=124
src="VBA%20Notes%20for%20Professionals_files/image448.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.2pt;
margin-left:.75pt'><b>Why does this work?</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.7pt;
margin-left:.75pt'>By using a <span style='font-size:9.0pt;line-height:110%;
color:slateblue;background:#FAFAFA'>Long</span> (32-bit) integer instead, we
can now make a loop that iterates more than 32,767 times without overflowing
the counter variable's type.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.2pt;
margin-left:.75pt'><b>Other notes</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:66.2pt;margin-bottom:
0in;margin-left:-.25pt;line-height:145%'>See Data Types and Limits for more
information.</p>

<h2 style='margin-top:0in;margin-right:66.2pt;margin-bottom:0in;margin-left:
-.25pt;line-height:145%'><a name="_Toc308836">Section 43.2: Run-time error '9':
Subscript out of range</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:4.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=140
src="VBA%20Notes%20for%20Professionals_files/image449.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.2pt;
margin-left:.75pt'><b>Why doesn't this work?</b></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=22 style='width:16.2pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=22 valign=top style='width:16.2pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>foo</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'><span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>foo</span> is an array that contains 10 items. When the <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>i</span> loop
counter reaches a value of 11, <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>(i)</span> is <i>out of range</i>. This error occurs
whenever an array or collection is accessed with an index that doesn't exist in
that array or collection.</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=81
src="VBA%20Notes%20for%20Professionals_files/image450.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:4.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=71
src="VBA%20Notes%20for%20Professionals_files/image451.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.2pt;
margin-left:.75pt'><b>Why does this work?</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:13.15pt;
margin-left:.75pt'>Use <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>LBound</span> and <span style='font-size:9.0pt;line-height:
110%;background:#FAFAFA'>UBound</span> functions to determine the lower and
upper boundaries of an array, respectively.</p>

<h4 style='margin-left:.75pt'>Other notes</h4>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=281 style='width:210.6pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=86 valign=top style='width:.9in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>ThisWorkbook</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;background:#FAFAFA'>.</span></p>
  </td>
  <td width=72 valign=top style='width:.75in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Worksheets</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;background:#FAFAFA'>(</span></p>
  </td>
  <td width=108 valign=top style='width:81.0pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;color:brown'>&quot;I don't exist&quot;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.55pt;
margin-left:.75pt'>When the index is a string, e.g. <span style='font-size:
9.0pt;line-height:110%;background:#FAFAFA'>)</span>, this error means the
supplied name doesn't exist in the queried collection.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>The actual error is implementation-specific though; <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Collection</span>
will raise run-time error 5 &quot;Invalid procedure call or argument&quot;
instead:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=92
src="VBA%20Notes%20for%20Professionals_files/image452.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc308837">Section 43.3: Run-time
error '13': Type mismatch</a></h2>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:0in;margin-left:.75pt'>Incorrect
code</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:4.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=125
src="VBA%20Notes%20for%20Professionals_files/image453.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.2pt;
margin-left:.75pt'><b>Why doesn't this work?</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt;line-height:155%'>VBA is trying really hard to convert the <span
style='font-size:9.0pt;line-height:155%;color:brown;background:#FAFAFA'>&quot;42?&quot;</span>
argument into a <span style='font-size:9.0pt;line-height:155%;color:slateblue;
background:#FAFAFA'>Date</span> value. When it fails, the call to <span
style='font-size:9.0pt;line-height:155%;background:#FAFAFA'>DoSomethingElse </span>cannot
be executed, because VBA doesn't know what date to pass, so it raises run-time
error 13 <i>type mismatch</i>, because the type of the argument doesn't match
the expected type (and can't be implicitly converted either). <b>Correct code</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:4.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=125
src="VBA%20Notes%20for%20Professionals_files/image454.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.2pt;
margin-left:.75pt'><b>Why does this work?</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:18.6pt;
margin-left:.75pt'>By passing a <span style='font-size:9.0pt;line-height:110%;
color:slateblue;background:#FAFAFA'>Date</span> argument to a procedure that
expects a <span style='font-size:9.0pt;line-height:110%;color:slateblue;
background:#FAFAFA'>Date</span> parameter, the call can succeed.</p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:0in;margin-left:-.25pt'><a
name="_Toc308838">Section 43.4: Run-time error '91': Object variable or With
block variable not set</a></h2>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=49
src="VBA%20Notes%20for%20Professionals_files/image455.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:4.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=104
src="VBA%20Notes%20for%20Professionals_files/image456.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.2pt;
margin-left:.75pt'><b>Why doesn't this work?</b></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=22 style='width:16.2pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=22 valign=top style='width:16.2pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Add</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Object variables hold a <i>reference</i>, and references
need to be <i>set</i> using the <b><span style='font-size:9.0pt;line-height:
110%;color:blue;background:#FAFAFA'>Set</span></b> keyword. This error occurs
whenever a member call is made on an object whose reference is <b><span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>Nothing</span></b>.
In this case <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>foo</span>
is a <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>Collection</span>
reference, but it's not initialized, so the reference contains <b><span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>Nothing</span></b>
- and we can't call <span style='font-size:9.0pt;line-height:110%;background:
#FAFAFA'>.</span> on <b><span style='font-size:9.0pt;line-height:110%;
color:blue;background:#FAFAFA'>Nothing</span></b>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=176
src="VBA%20Notes%20for%20Professionals_files/image457.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=22 style='width:16.2pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=22 valign=top style='width:16.2pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Add</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:13.1pt;
margin-left:.75pt'>By assigning the object variable a valid reference using the
<b><span style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>Set</span></b>
keyword, the <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>.</span>
calls succeed.</p>

<h4 style='margin-left:.75pt'>Other notes</h4>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=72 style='width:.75in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=36 valign=top style='width:27.0pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Range</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;background:#FAFAFA'>.</span></p>
  </td>
  <td width=29 valign=top style='width:.3in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Find</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Often, a function or property can return an object reference
- a common example is Excel's method, which returns a <span style='font-size:
9.0pt;line-height:110%;background:#FAFAFA'>Range</span> object:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=43
src="VBA%20Notes%20for%20Professionals_files/image458.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=22 style='width:16.2pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=22 valign=top style='width:16.2pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Row</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.25in;margin-bottom:12.5pt;
margin-left:.75pt'>However the function can very well return <b><span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>Nothing</span></b>
(if the search term isn't found), so it's likely that the chained <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>.</span> member
call fails.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=158 style='width:1.65in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=158 valign=top style='width:1.65in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>If</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Not</span></b><span
  style='font-size:9.0pt;line-height:107%'> xxxx </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Is</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Nothing</span></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>Before calling object members, verify that the reference is
set with a condition:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=92
src="VBA%20Notes%20for%20Professionals_files/image459.gif"></span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:0in;margin-left:-.25pt'><a
name="_Toc308839">Section 43.5: Run-time error '20': Resume without error</a></h2>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=176
src="VBA%20Notes%20for%20Professionals_files/image460.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=79 style='width:59.4pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=79 valign=top style='width:59.4pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Resume</span></b><span style='font-size:9.0pt;line-height:
  107%'> </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Next</span></b></p>
  </td>
 </tr>
</table>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=79 style='width:59.4pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=36 valign=top style='width:27.0pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Debug</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;background:#FAFAFA'>.</span></p>
  </td>
  <td width=36 valign=top style='width:27.0pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>Print</span></p>
  </td>
 </tr>
</table>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=79 style='width:59.4pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=79 valign=top style='width:59.4pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Resume</span></b><span style='font-size:9.0pt;line-height:
  107%'> </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Next</span></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>If the <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>DoSomethingElse</span> procedure raises an error, execution
jumps to the <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>CleanFail</span>
line label, prints the error number, and the instruction jumps back to the
instruction that immediately follows the line where the error occurred, which
in this case is the instruction: the error-handling subroutine is executing
without an error context, and when the instruction is reached, run-time error
20 is raised because there is nowhere to resume to.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:4.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=173
src="VBA%20Notes%20for%20Professionals_files/image461.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.2pt;
margin-left:.75pt'><b>Why does this work?</b></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=58 style='width:.6in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Exit</span></b><span style='font-size:9.0pt;line-height:
  107%'> </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Sub</span></b></p>
  </td>
 </tr>
</table>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=58 style='width:.6in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>On</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Error</span></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.7pt;
margin-left:.75pt'>By introducing an instruction before the <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>CleanFail</span>
line label, we have segregated the <span style='font-size:9.0pt;line-height:
110%;background:#FAFAFA'>CleanFail</span> errorhandling subroutine from the
rest of the procedure body - the only way to execute the error-handling
subroutine is via an jump; therefore, no execution path reaches the <b><span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>Resume</span></b>
instruction outside of an error context, which avoids run-time error 20.</p>

<h4 style='margin-left:.75pt'>Other notes</h4>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=72 style='width:.75in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=72 valign=top style='width:.75in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Error</span></b><span style='font-size:9.0pt;line-height:
  107%'> </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>GoTo</span></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:4.5pt;margin-bottom:.25pt;
margin-left:.75pt;text-align:justify;text-justify:inter-ideograph;line-height:
135%'>This is very similar to Run-time error '3': Return without GoSub; in both
situations, the solution is to ensure that the <i>normal execution path</i>
cannot enter a sub-routine (identified by a line label) without an explicit
jump (assuming <b><span style='font-size:9.0pt;line-height:135%;color:blue;
background:#FAFAFA'>On </span></b>is considered an <i>explicit jump</i>).</p>

<h2 style='margin-top:0in;margin-right:4.5pt;margin-bottom:.25pt;margin-left:
.75pt;text-align:justify;text-justify:inter-ideograph;line-height:135%'><a
name="_Toc308840">Section 43.6: Run-time error '3': Return without GoSub</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:4.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=124
src="VBA%20Notes%20for%20Professionals_files/image462.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.2pt;
margin-left:.75pt'><b>Why doesn't this work?</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Execution enters the <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>DoSomething</span> procedure, jumps to the
<span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>DoThis</span>
label, prints &quot;Hi!&quot; to the debug output, <i>returns</i> to the
instruction immediately after the <b><span style='font-size:9.0pt;line-height:
110%;color:blue;background:#FAFAFA'>GoSub</span></b> call, prints
&quot;Hi!&quot; again, and then encounters a <b><span style='font-size:9.0pt;
line-height:110%;color:blue;background:#FAFAFA'>Return</span></b> statement,
but there's nowhere to <i>return</i> to now, because we didn't get here with a <b><span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>GoSub</span></b>
statement.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:4.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=140
src="VBA%20Notes%20for%20Professionals_files/image463.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.2pt;
margin-left:.75pt'><b>Why does this work?</b></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=58 style='width:.6in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=58 valign=top style='width:.6in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Exit</span></b><span style='font-size:9.0pt;line-height:
  107%'> </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Sub</span></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:13.15pt;
margin-left:.75pt'>By introducing an instruction <i>before</i> the <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>DoThis</span> line
label, we have segregated the <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>DoThis</span> subroutine from the rest of the procedure
body - the only way to execute the <span style='font-size:9.0pt;line-height:
110%;background:#FAFAFA'>DoThis</span> subroutine is via the <b><span
style='font-size:9.0pt;line-height:110%;color:blue;background:#FAFAFA'>GoSub</span></b>
jump.</p>

<h4 style='margin-left:.75pt'>Other notes</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.45pt;
margin-left:.75pt'><b><span style='font-size:9.0pt;line-height:110%;color:blue;
background:#FAFAFA'>GoSub</span></b>/<b><span style='font-size:9.0pt;
line-height:110%;color:blue;background:#FAFAFA'>Return</span></b> is
deprecated, and should be avoided in favor of actual procedure calls. A
procedure should not contain subroutines, other than error handlers.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=72 style='width:.75in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=72 valign=top style='width:.75in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Error</span></b><span style='font-size:9.0pt;line-height:
  107%'> </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>GoTo</span></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>This is very similar to Run-time error '20': Resume without
error; in both situations, the solution is to ensure that the <i>normal
execution path</i> cannot enter a sub-routine (identified by a line label)
without an explicit jump (assuming <b><span style='font-size:9.0pt;line-height:
110%;color:blue;background:#FAFAFA'>On </span></b>is considered an <i>explicit
jump</i>).<br clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc308841">Chapter 44: Copying,
returning and passing arrays</a></h1>

<h2 style='margin-left:-.25pt'><a name="_Toc308842">Section 44.1: Passing
Arrays to Proceedures</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>Arrays can be passed to proceedures by putting <span
style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>()</span> after the
name of the array variable.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.0pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="VBA%20Notes%20for%20Professionals_files/image464.gif"></span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=101 style='width:1.05in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=72 valign=top style='width:.75in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>myFunction</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;background:#FAFAFA'>(</span></p>
  </td>
  <td width=22 valign=top style='width:16.2pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>arr</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Arrays <i>must</i> be passed by reference. If no passing
mechanism is specified, e.g. <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>())</span>, then VBA will assume <b><span style='font-size:
9.0pt;line-height:110%;color:blue;background:#FAFAFA'>ByRef</span></b> by
default, however it is good coding practice to make it explicit. Trying to pass
an array by value, e.g.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=144 style='width:1.5in;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:.15in'>
  <td width=72 valign=top style='width:.75in;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%'>myFunction</span></p>
  </td>
  <td width=7 valign=top style='width:5.4pt;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:9.0pt;line-height:
  107%;background:#FAFAFA'>(</span></p>
  </td>
  <td width=65 valign=top style='width:48.6pt;background:#FAFAFA;padding:1.8pt 0in 0in 0in;
  height:.15in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:
  107%'> arr</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal align=right style='margin-top:0in;margin-right:11.3pt;
margin-bottom:2.0pt;margin-left:.5pt;text-align:right;line-height:107%'><span
style='font-size:9.0pt;line-height:107%;background:#FAFAFA'>())</span> will
result in an &quot;Array argument must be ByRef&quot; compilation error (or a
&quot;Syntax error&quot;</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:13.0pt;
margin-left:.75pt'>compilation error if <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>Auto Syntax Check</span> is not checked in
the VBE options).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>Passing by reference means that any changes to the array
will be preserved in the calling proceedure.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=240
src="VBA%20Notes%20for%20Professionals_files/image465.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>If you want to avoid changing the original array then be
careful to write the function so that it doesn't change any elements.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=60
src="VBA%20Notes%20for%20Professionals_files/image466.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>Alternatively create a working copy of the array and work
with the copy.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=158
src="VBA%20Notes%20for%20Professionals_files/image467.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc308843">Section 44.2: Copying
Arrays</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>You can copy a VBA array into an array of the same type
using the <span style='font-size:9.0pt;line-height:110%;background:#FAFAFA'>=</span>
operator. The arrays must be of the same type otherwise the code will throw a
&quot;Can't assign to array&quot; compilation error.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=109
src="VBA%20Notes%20for%20Professionals_files/image468.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>The source array can be fixed or dynamic, but the
destination array must be dynamic. Trying to copy to a fixed array will throw a
&quot;Can't assign to array&quot; compilation error. Any preexisting data in
the receiving array is lost and its bounds and dimenions are changed to the
same as the source array.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=223
src="VBA%20Notes%20for%20Professionals_files/image469.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Once the copy is made the two arrays are separate in memory,
i.e. the two variables are not references to same underlying data, so changes
made to one array do not appear in the other.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:19.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=207
src="VBA%20Notes%20for%20Professionals_files/image470.gif"></span></p>

<h4 style='margin-left:.75pt'>Copying Arrays of Objects</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>With arrays of objects the <i>references</i> to those
objects are copied, not the objects themselves. If a change is made to an
object in one array it will also appear to be changed in the other array - they
are both referencing the same object. However, setting an element to a
different object in one array won't set it to that object the other array.</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=163
src="VBA%20Notes%20for%20Professionals_files/image471.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.05pt;margin-bottom:12.55pt;
margin-left:3.5pt'><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Set</span></b><span
style='font-size:9.0pt;line-height:110%'> destination(</span><span
style='font-size:9.0pt;line-height:110%;color:brown'>0</span><span
style='font-size:9.0pt;line-height:110%'>) = Range(</span><span
style='font-size:9.0pt;line-height:110%;color:brown'>&quot;A4&quot;</span><span
style='font-size:9.0pt;line-height:110%'>) </span><i><span style='font-size:
9.0pt;line-height:110%;color:green'>'reference changed in destination but not
source</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:37.1pt;margin-bottom:
12.45pt;margin-left:3.5pt'><span style='position:relative;z-index:-1895758848'><span
style='left:0px;position:absolute;left:0px;top:-125599px;width:718px;
height:1px'><img width=718 height=1
src="VBA%20Notes%20for%20Professionals_files/image472.gif"></span></span><span
style='font-size:9.0pt;line-height:110%'>destination(</span><span
style='font-size:9.0pt;line-height:110%;color:brown'>0</span><span
style='font-size:9.0pt;line-height:110%'>).Value = </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>2</span><span
style='font-size:9.0pt;line-height:110%'> </span><i><span
style='font-size:9.0pt;line-height:110%;color:green'>'affects an object only in
destination </span></i><span style='font-size:9.0pt;line-height:110%'>destination(</span><span
style='font-size:9.0pt;line-height:110%;color:brown'>1</span><span
style='font-size:9.0pt;line-height:110%'>).Value = </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>5</span><span
style='font-size:9.0pt;line-height:110%'> </span><i><span
style='font-size:9.0pt;line-height:110%;color:green'>'affects an object in both
source and destination</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'>Debug.Print
source(</span><span style='font-size:9.0pt;line-height:110%;color:brown'>0</span><span
style='font-size:9.0pt;line-height:110%'>); source(</span><span
style='font-size:9.0pt;line-height:110%;color:brown'>1</span><span
style='font-size:9.0pt;line-height:110%'>); source(</span><span
style='font-size:9.0pt;line-height:110%;color:brown'>2</span><span
style='font-size:9.0pt;line-height:110%'>) </span><i><span
style='font-size:9.0pt;line-height:110%;color:green'>' outputs 3 5 4</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:21.35pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'>Debug.Print
destination(</span><span style='font-size:9.0pt;line-height:110%;color:brown'>0</span><span
style='font-size:9.0pt;line-height:110%'>); destination(</span><span
style='font-size:9.0pt;line-height:110%;color:brown'>1</span><span
style='font-size:9.0pt;line-height:110%'>); destination(</span><span
style='font-size:9.0pt;line-height:110%;color:brown'>2</span><span
style='font-size:9.0pt;line-height:110%'>) </span><i><span style='font-size:
9.0pt;line-height:110%;color:green'>' outputs 2 5 4</span></i></p>

<h4 style='margin-left:.75pt'>Variants Containing an Array</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>You can also copy an array into and from a variant variable.
When copying from a variant, it must contain an array of the same type as the
receiving array otherwise it will throw a &quot;Type mismatch&quot; runtime
error.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.35pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=158
src="VBA%20Notes%20for%20Professionals_files/image473.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc308844">Section 44.3: Returning
Arrays from Functions</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>A function in a normal module (but not a Class module) can
return an array by putting <span style='font-size:9.0pt;line-height:110%;
background:#FAFAFA'>()</span> after the data type.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=158
src="VBA%20Notes%20for%20Professionals_files/image474.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>The result of the function can then be put into a dynamic
array of the same type or a variant. The elements can also be accessed directly
by using a second set of brackets, however this will call the function each
time, so its best to store the results in a new array if you plan to use them
more than once</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=223
src="VBA%20Notes%20for%20Professionals_files/image475.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Note that what is returned is actually a copy of the array
inside the function, not a reference. So if the function returns the contents
of a Static array its data can't be changed by the calling procedure.</p>

<h4 style='margin-left:.75pt'>Outputting an Array via an output argument</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>It is normally good coding practice for a procedure's
arguments to be inputs and to output via the return value.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:13.1pt;
margin-left:.75pt'>However, the limitations of VBA sometimes make it necessary
for a procedure to output data via a <b><span style='font-size:9.0pt;
line-height:110%;color:blue;background:#FAFAFA'>ByRef</span></b> argument.</p>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:0in;margin-left:.75pt'>Outputting
to a fixed array</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:19.05pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=207
src="VBA%20Notes%20for%20Professionals_files/image476.gif"></span></p>

<h4 style='margin-left:.75pt'>Outputting an Array from a Class method</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>An output argument can also be used to output an array from
a method/proceedure in a Class module</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=289
src="VBA%20Notes%20for%20Professionals_files/image477.gif"></span></p>

<h1 style='margin-left:-.25pt'><a name="_Toc308845">Chapter 45: Non-Latin
Characters</a></h1>

<p class=MsoNormal style='margin-top:0in;margin-right:.55pt;margin-bottom:.25pt;
margin-left:.75pt;text-align:justify;text-justify:inter-ideograph;line-height:
135%'>VBA can read and write strings in any language or script using <a
href="http://www.unicode.org/"><span style='color:#193C96'>Unicode</span></a>.
However, there are stricter rules in place for <a
href="https://msdn.microsoft.com/en-us/library/ee200272.aspx"><span
style='color:#193C96'>Identifier Tokens</span></a>.</p>

<h2 style='margin-top:0in;margin-right:.55pt;margin-bottom:.25pt;margin-left:
.75pt;text-align:justify;text-justify:inter-ideograph;line-height:135%'><a
name="_Toc308846">Section 45.1: Non-Latin Text in VBA Code</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:13.35pt;
margin-left:.75pt'>In spreadsheet cell A1, we have the following Arabic
pangram:</p>

<p class=MsoNormal align=right dir=RTL style='margin-top:0in;margin-right:0in;
margin-bottom:13.4pt;margin-left:0in;text-align:left;text-indent:0in;
line-height:107%;direction:rtl;unicode-bidi:embed'><span lang=AR-SA
style='line-height:107%;font-family:"Arial",sans-serif'>&#1589;&#1616;&#1601;</span><span
lang=AR-SA style='line-height:107%'> </span><span lang=AR-SA style='line-height:
107%;font-family:"Arial",sans-serif'>&#1582;&#1614;&#1604;&#1602;&#1614;</span><span
lang=AR-SA style='line-height:107%'> </span><span lang=AR-SA style='line-height:
107%;font-family:"Arial",sans-serif'>&#1582;&#1614;&#1608;&#1583;&#1616;</span><span
lang=AR-SA style='line-height:107%'> </span><span lang=AR-SA style='line-height:
107%;font-family:"Arial",sans-serif'>&#1603;&#1605;&#1614;&#1579;&#1604;&#1616;</span><span
lang=AR-SA style='line-height:107%'> </span><span lang=AR-SA style='line-height:
107%;font-family:"Arial",sans-serif'>&#1575;&#1604;&#1588;&#1614;&#1605;&#1587;&#1616;</span><span
lang=AR-SA style='line-height:107%'> </span><span lang=AR-SA style='line-height:
107%;font-family:"Arial",sans-serif'>&#1573;&#1616;&#1584;</span><span
lang=AR-SA style='line-height:107%'> </span><span lang=AR-SA style='line-height:
107%;font-family:"Arial",sans-serif'>&#1576;&#1614;&#1586;&#1614;&#1594;&#1578;&#1614;</span><span
lang=AR-SA style='line-height:107%'> </span><span lang=AR-SA style='line-height:
107%;font-family:"Arial",sans-serif'></span><span lang=AR-SA style='line-height:
107%'> </span><span lang=AR-SA style='line-height:107%;font-family:"Arial",sans-serif'>&#1610;&#1581;&#1614;&#1592;&#1609;</span><span
lang=AR-SA style='line-height:107%'> </span><span lang=AR-SA style='line-height:
107%;font-family:"Arial",sans-serif'>&#1575;&#1604;&#1590;&#1614;&#1580;&#1610;&#1593;&#1615;</span><span
lang=AR-SA style='line-height:107%'> </span><span lang=AR-SA style='line-height:
107%;font-family:"Arial",sans-serif'>&#1576;&#1616;&#1607;&#1575;</span><span
lang=AR-SA style='line-height:107%'> </span><span lang=AR-SA style='line-height:
107%;font-family:"Arial",sans-serif'>&#1606;&#1614;&#1580;&#1604;&#1575;&#1569;&#1614;</span><span
lang=AR-SA style='line-height:107%'> </span><span lang=AR-SA style='line-height:
107%;font-family:"Arial",sans-serif'>&#1605;&#1616;&#1593;&#1591;&#1575;&#1585;&#1616;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>VBA provides the <span style='font-size:9.0pt;line-height:
110%;background:#FAFAFA'>AscW</span> and <span style='font-size:9.0pt;
line-height:110%;background:#FAFAFA'>ChrW</span> functions to work with
multi-byte character codes. We can also use <span style='font-size:9.0pt;
line-height:110%;color:slateblue;background:#FAFAFA'>Byte</span> arrays to
manipulate the string variable directly:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.9pt;margin-left:-.45pt;text-indent:0in;line-height:107%'><img border=0
width=719 height=634 id="Picture 302232"
src="VBA%20Notes%20for%20Professionals_files/image478.gif"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:24.0pt;
margin-left:.75pt'>This produces the following output for the <a
href="http://www.fileformat.info/info/unicode/char/0635/index.htm"><span
style='color:#193C96'>Arabic Letter Sad</span></a>:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:24.5pt'><img width=3 height=1
src="VBA%20Notes%20for%20Professionals_files/image168.gif" align=left
hspace=12>First char (ChrW): 1589</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:24.5pt'>First char (binary): 00011000110101</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:24.5pt'><img width=3 height=1
src="VBA%20Notes%20for%20Professionals_files/image168.gif" align=left
hspace=12>String value (text): ?</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:24.5pt'>String value (AscW): 1589</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:24.5pt'>Byte values (in decimal): 53|6</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.8pt;
margin-left:24.5pt'>Byte values (binary): 00110101|00000110</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:24.5pt'>Whole String</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:24.05pt;
margin-left:24.5pt'>??? ????? ????? ??????? ??????? ??? ??????? <span
style='font-family:"Arial",sans-serif'></span> ????? ???????? ???? ???????
???????</p>

<p class=MsoNormal style='margin-top:0in;margin-right:22.15pt;margin-bottom:
.25pt;margin-left:.75pt;text-align:justify;text-justify:inter-ideograph;
line-height:135%'>Note that VBA is unable to print non-Latin text to the
immediate window even though the string functions work correctly. This is a
limitation of the IDE and not the language.</p>

<h2 style='margin-top:0in;margin-right:22.15pt;margin-bottom:.25pt;margin-left:
.75pt;text-align:justify;text-justify:inter-ideograph;line-height:135%'><a
name="_Toc308847">Section 45.2: Non-Latin Identifiers and Language Coverage</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.45pt;
margin-left:.75pt'><a
href="https://msdn.microsoft.com/en-us/library/ee200272.aspx"><span
style='color:#193C96'>VBA Identifiers</span></a> (variable and function names)
can use the Latin script and may also be able to use <a
href="https://msdn.microsoft.com/en-us/library/ee199767.aspx"><span
style='color:#193C96'>Japanese</span></a>, <a
href="https://msdn.microsoft.com/en-us/library/ee177191.aspx"><span
style='color:#193C96'>Korean</span></a>, <a
href="https://msdn.microsoft.com/en-us/library/ee199765.aspx"><span
style='color:#193C96'>Simplified Chinese</span></a>, and <a
href="https://msdn.microsoft.com/en-us/library/ee199727.aspx"><span
style='color:#193C96'>Traditional Chinese</span></a> scripts.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>The extended Latin script has full coverage for many
languages:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.45pt;
margin-left:.75pt'>English, French, Spanish, German, Italian, Breton, Catalan,
Danish, Estonian, Finnish, Icelandic, Indonesian, Irish, Lojban, Mapudungun,
Norwegian, Portuguese, Scottish Gaelic, Swedish, Tagalog</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Some languages are only partially covered:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.45pt;
margin-left:.75pt'>Azeri, Croatian, Czech, Esperanto, Hungarian, Latvian,
Lithuanian, Polish, Romanian, Serbian, Slovak, Slovenian, Turkish, Yoruba,
Welsh</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Some languages have little or no coverage:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.45pt;
margin-left:.75pt'>Arabic, Bulgarian, Cherokee, Dzongkha, Greek, Hindi,
Macedonian, Malayalam, Mongolian, Russian, Sanskrit, Thai, Tibetan, Urdu,
Uyghur</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>The following variable declarations are all valid:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=267
src="VBA%20Notes%20for%20Professionals_files/image479.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.7pt;
margin-left:.75pt'>Note that in the VBA IDE, a single apostrophe within a
variable name does not turn the line into a comment (as it does on Stack
Overflow).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:.75pt'>Also, languages that use two angles to indicate a quote <span
style='font-family:"Arial",sans-serif'></span> are allowed to use those in
variable names desipte the fact that the &quot;&quot;-type quotes are not.</p>

<h1 style='margin-left:-.25pt'><a name="_Toc308848">Chapter 46: API Calls</a></h1>

<p class=MsoNormal style='margin-top:0in;margin-right:.9in;margin-bottom:12.8pt;
margin-left:-.25pt'>API stands for <a
href="https://en.wikipedia.org/wiki/Application_programming_interface"><span
style='color:#193C96'>Application Programming Interface</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.8pt;
margin-left:.75pt'>API's for VBA imply a set of methods that allow direct
interaction with the operating system</p>

<p class=MsoNormal style='margin-top:0in;margin-right:147.15pt;margin-bottom:
0in;margin-left:.75pt;line-height:145%'>System calls can be made by executing
procedures defined in DLL files</p>

<h2 style='margin-top:0in;margin-right:147.15pt;margin-bottom:0in;margin-left:
.75pt;line-height:145%'><a name="_Toc308849">Section 46.1: Mac APIs</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:31.65pt;margin-bottom:
0in;margin-left:.75pt;line-height:215%'><a
href="https://msdn.microsoft.com/en-us/library/office/mt654019.aspx"><span
style='color:#193C96'>Microsoft doesn't officially support APIs</span></a> but
with some research more declarations can be found online Office 2016 for Mac is
sandboxed</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.8pt;
margin-left:.75pt'>Unlike other versions of Office apps that support VBA,
Office 2016 for Mac apps are sandboxed.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.45pt;
margin-left:.75pt'>Sandboxing restricts the apps from accessing resources
outside the app container. This affects any add-ins or macros that involve file
access or communication across processes. You can minimize the effects of
sandboxing by using the new commands described in the following section. New
VBA commands for Office 2016 for Mac</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.8pt;
margin-left:.75pt'>The following VBA commands are new and unique to Office 2016
for Mac.</p>

<h3 style='margin-top:0in;margin-right:0in;margin-bottom:1.1pt;margin-left:
0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;line-height:
110%;color:black;font-weight:normal'> </span><span
style='font-size:10.0pt;line-height:110%;color:black'>Command Use
to</span></h3>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'><a
href="https://msdn.microsoft.com/en-us/library/office/mt654020.aspx"><span
style='color:#193C96'>GrantAccessToMultipleFiles</span></a><u><span
style='color:#193C96'> </span></u>Request a user's permission to access
multiple files at once</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=548
 style='width:411.35pt;margin-left:1.0pt;border-collapse:collapse'>
 <tr style='height:13.65pt'>
  <td width=164 valign=top style='width:123.0pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://msdn.microsoft.com/en-us/library/office/mt654021.aspx"><span
  style='color:#193C96'>AppleScriptTask</span></a></p>
  </td>
  <td width=384 valign=top style='width:288.35pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
  margin-left:8.0pt;text-indent:0in;line-height:107%'>Call external AppleScript
  scripts from VB</p>
  </td>
 </tr>
 <tr style='height:13.65pt'>
  <td width=164 valign=top style='width:123.0pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://msdn.microsoft.com/en-us/library/office/mt654025.aspx"><span
  style='color:#193C96'>MAC_OFFICE_VERSION</span></a></p>
  </td>
  <td width=384 valign=top style='width:288.35pt;padding:0in 0in 0in 0in;
  height:13.65pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
  margin-left:8.0pt;text-indent:0in;line-height:107%'>IFDEF between different
  Mac Office versions at compile time</p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.9in;margin-bottom:14.45pt;
margin-left:-.25pt'><a href="https://stackoverflow.com/a/12320294/4914662"><span
style='color:#193C96'>Office 2011 for Mac</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Private</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Declare</span></b><span style='font-size:
9.0pt;line-height:110%'> </span><b><span style='font-size:9.0pt;line-height:
110%;color:blue'>Function</span></b><span style='font-size:9.0pt;line-height:
110%'> system </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>Lib</span></b><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>&quot;libc.dylib&quot;</span><span
style='font-size:9.0pt;line-height:110%'> (</span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;
line-height:110%'> command </span><b><span style='font-size:9.0pt;line-height:
110%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:slateblue'>String</span><span
style='font-size:9.0pt;line-height:110%'>) </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>As</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:slateblue'>Long</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Private</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Declare</span></b><span style='font-size:
9.0pt;line-height:110%'> </span><b><span style='font-size:9.0pt;line-height:
110%;color:blue'>Function</span></b><span style='font-size:9.0pt;line-height:
110%'> popen </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>Lib</span></b><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>&quot;libc.dylib&quot;</span><span
style='font-size:9.0pt;line-height:110%'> (</span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;
line-height:110%'> command </span><b><span style='font-size:9.0pt;line-height:
110%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:slateblue'>String</span><span
style='font-size:9.0pt;line-height:110%'>, </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;
line-height:110%'> mode </span><b><span style='font-size:9.0pt;line-height:
110%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:slateblue'>String</span><span
style='font-size:9.0pt;line-height:110%'>) </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>As</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.25pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%;color:slateblue'>Long</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Private</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Declare</span></b><span style='font-size:
9.0pt;line-height:110%'> </span><b><span style='font-size:9.0pt;line-height:
110%;color:blue'>Function</span></b><span style='font-size:9.0pt;line-height:
110%'> pclose </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>Lib</span></b><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>&quot;libc.dylib&quot;</span><span
style='font-size:9.0pt;line-height:110%'> (</span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;
line-height:110%'> file </span><b><span style='font-size:9.0pt;line-height:
110%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:slateblue'>Long</span><span
style='font-size:9.0pt;line-height:110%'>) </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>As</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:slateblue'>Long</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><span style='position:relative;z-index:-1895755776'><span
style='left:0px;position:absolute;left:0px;top:-129757px;width:718px;
height:1px'><img width=718 height=1
src="VBA%20Notes%20for%20Professionals_files/image213.gif"></span></span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Private</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Declare</span></b><span style='font-size:
9.0pt;line-height:110%'> </span><b><span style='font-size:9.0pt;line-height:
110%;color:blue'>Function</span></b><span style='font-size:9.0pt;line-height:
110%'> fread </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>Lib</span></b><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>&quot;libc.dylib&quot;</span><span
style='font-size:9.0pt;line-height:110%'> (</span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;
line-height:110%'> outStr </span><b><span style='font-size:9.0pt;line-height:
110%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:slateblue'>String</span><span
style='font-size:9.0pt;line-height:110%'>, </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;
line-height:110%'> size </span><b><span style='font-size:9.0pt;line-height:
110%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:slateblue'>Long</span><span
style='font-size:9.0pt;line-height:110%'>, </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>ByVal </span></b><span style='font-size:
9.0pt;line-height:110%'>items </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>As</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:110%'>, </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>ByVal</span></b><span
style='font-size:9.0pt;line-height:110%'> stream </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>Long</span><span style='font-size:9.0pt;
line-height:110%'>) </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>As</span></b><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:slateblue'>Long</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:25.55pt;
margin-left:3.5pt'><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Private</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Declare</span></b><span style='font-size:
9.0pt;line-height:110%'> </span><b><span style='font-size:9.0pt;line-height:
110%;color:blue'>Function</span></b><span style='font-size:9.0pt;line-height:
110%'> feof </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Lib</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:brown'>&quot;libc.dylib&quot;</span><span
style='font-size:9.0pt;line-height:110%'> (</span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;
line-height:110%'> file </span><b><span style='font-size:9.0pt;line-height:
110%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:slateblue'>Long</span><span
style='font-size:9.0pt;line-height:110%'>) </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>As</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:slateblue'>Long</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.9in;margin-bottom:14.45pt;
margin-left:-.25pt'><a href="https://stackoverflow.com/a/40029588/4914662"><span
style='color:#193C96'>Office 2016 for Mac</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><span style='position:relative;z-index:-1895754752'><span
style='left:0px;position:absolute;left:0px;top:-129865px;width:718px;
height:1px'><img width=718 height=1
src="VBA%20Notes%20for%20Professionals_files/image480.gif"></span></span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Private</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Declare</span></b><span style='font-size:
9.0pt;line-height:110%'> PtrSafe </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Function</span></b><span style='font-size:9.0pt;
line-height:110%'> popen </span><b><span style='font-size:9.0pt;line-height:
110%;color:blue'>Lib</span></b><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>&quot;libc.dylib&quot;</span><span
style='font-size:9.0pt;line-height:110%'> (</span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;
line-height:110%'> command </span><b><span style='font-size:9.0pt;line-height:
110%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:slateblue'>String</span><span
style='font-size:9.0pt;line-height:110%'>, </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;
line-height:110%'> mode </span><b><span style='font-size:9.0pt;line-height:
110%;color:blue'>As </span></b><span style='font-size:9.0pt;line-height:110%;
color:slateblue'>String</span><span style='font-size:9.0pt;line-height:110%'>) </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> LongPtr</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:21.8pt;margin-bottom:
.2pt;margin-left:3.5pt'><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>Private</span></b><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Declare</span></b><span
style='font-size:9.0pt;line-height:110%'> PtrSafe </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Function</span></b><span
style='font-size:9.0pt;line-height:110%'> pclose </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Lib</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:brown'>&quot;libc.dylib&quot;</span><span
style='font-size:9.0pt;line-height:110%'> (</span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;
line-height:110%'> file </span><b><span style='font-size:9.0pt;line-height:
110%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:110%'>
LongPtr) </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>Long </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Private</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>Declare</span></b><span style='font-size:9.0pt;line-height:110%'>
PtrSafe </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Function</span></b><span
style='font-size:9.0pt;line-height:110%'> fread </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Lib</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:brown'>&quot;libc.dylib&quot;</span><span
style='font-size:9.0pt;line-height:110%'> (</span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;
line-height:110%'> outStr </span><b><span style='font-size:9.0pt;line-height:
110%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:slateblue'>String</span><span
style='font-size:9.0pt;line-height:110%'>, </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;
line-height:110%'> size </span><b><span style='font-size:9.0pt;line-height:
110%;color:blue'>As</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'>LongPtr, </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>ByVal</span></b><span
style='font-size:9.0pt;line-height:110%'> items </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> LongPtr, </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>ByVal</span></b><span
style='font-size:9.0pt;line-height:110%'> stream </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> LongPtr) </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>Long</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:23.0pt;
margin-left:3.5pt'><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Private</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Declare</span></b><span style='font-size:
9.0pt;line-height:110%'> PtrSafe </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Function</span></b><span style='font-size:9.0pt;
line-height:110%'> feof </span><b><span style='font-size:9.0pt;line-height:
110%;color:blue'>Lib</span></b><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>&quot;libc.dylib&quot;</span><span
style='font-size:9.0pt;line-height:110%'> (</span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;
line-height:110%'> file </span><b><span style='font-size:9.0pt;line-height:
110%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:110%'>
LongPtr) </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> LongPtr</span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:0in;margin-left:-.25pt'><a
name="_Toc308850">Section 46.2: Get total monitors and screen resolution</a></h2>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=720 height=124
src="VBA%20Notes%20for%20Professionals_files/image481.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:25.4pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=720 height=481
src="VBA%20Notes%20for%20Professionals_files/image482.gif"></span></p>

<h2 style='margin-left:-.25pt'><a name="_Toc308851">Section 46.3: FTP and
Regional APIs</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>modFTP</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=718 height=436
src="VBA%20Notes%20for%20Professionals_files/image483.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:566.95pt;margin-bottom:
0in;margin-left:-28.35pt;text-indent:0in;line-height:107%'>&nbsp;</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=718
 style='width:538.6pt;border-collapse:collapse'>
 <tr style='height:771.0pt'>
  <td width=718 valign=top style='width:538.6pt;background:#FAFAFA;padding:
  2.55pt 5.75pt 0in 3.75pt;height:771.0pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;
  line-height:107%'> lFlags </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><span style='font-size:9.0pt;line-height:107%;color:slateblue'>Long</span><span
  style='font-size:9.0pt;line-height:107%'>, _</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;
  line-height:107%'> lContext </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:107%'> _</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>) </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><span style='font-size:9.0pt;line-height:107%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><i><span style='font-size:
  9.0pt;line-height:107%;color:green'>'ex: lngINetConn =
  InternetConnect(lngINet, &quot;ftp.microsoft.com&quot;, 0,
  &quot;anonymous&quot;,</span></i></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><i><span style='font-size:
  9.0pt;line-height:107%;color:green'>&quot;wally@wallyworld.com&quot;, 1, 0,
  0)</span></i></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><i><span style='font-size:
  9.0pt;line-height:107%;color:green'>'Get a file</span></i></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Private</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Declare</span></b><span style='font-size:9.0pt;line-height:
  107%'> </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Function</span></b><span
  style='font-size:9.0pt;line-height:107%'> FtpGetFile </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Lib</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:brown'>&quot;wininet.dll&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Alias</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;line-height:
  107%;color:brown'>&quot;FtpGetFileA&quot;</span><span style='font-size:9.0pt;
  line-height:107%'> ( _</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;
  line-height:107%'> hFtpSession </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:107%'>,
  _</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;
  line-height:107%'> lpszRemoteFile </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>String</span><span style='font-size:9.0pt;line-height:107%'>,
  _</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;
  line-height:107%'> lpszNewFile </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>String</span><span style='font-size:9.0pt;line-height:107%'>,
  _</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;
  line-height:107%'> fFailIfExists </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Boolean</span><span style='font-size:9.0pt;line-height:107%'>,
  _</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;
  line-height:107%'> dwFlagsAndAttributes </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:107%'>,
  _</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;
  line-height:107%'> dwFlags </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><span style='font-size:9.0pt;line-height:107%;color:slateblue'>Long</span><span
  style='font-size:9.0pt;line-height:107%'>, _</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;
  line-height:107%'> dwContext </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:107%'> _</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>) </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><span style='font-size:9.0pt;line-height:107%;color:slateblue'>Boolean</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><i><span style='font-size:
  9.0pt;line-height:107%;color:green'>'ex: blnRC = FtpGetFile(lngINetConn,
  &quot;dirmap.txt&quot;, &quot;c:\dirmap.txt&quot;, 0, 0, 1, 0)</span></i></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><i><span style='font-size:
  9.0pt;line-height:107%;color:green'>'Send a file</span></i></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Private</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Declare</span></b><span style='font-size:9.0pt;line-height:
  107%'> </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Function</span></b><span
  style='font-size:9.0pt;line-height:107%'> FtpPutFile </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Lib</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:brown'>&quot;wininet.dll&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Alias</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;line-height:
  107%;color:brown'>&quot;FtpPutFileA&quot;</span><span style='font-size:9.0pt;
  line-height:107%'> _</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>( _</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;
  line-height:107%'> hFtpSession </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:107%'>,
  _</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;
  line-height:107%'> lpszLocalFile </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>String</span><span style='font-size:9.0pt;line-height:107%'>,
  _</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;
  line-height:107%'> lpszRemoteFile </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>String</span><span style='font-size:9.0pt;line-height:107%'>,
  _</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;
  line-height:107%'> dwFlags </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><span style='font-size:9.0pt;line-height:107%;color:slateblue'>Long</span><span
  style='font-size:9.0pt;line-height:107%'>, </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>ByVal</span></b><span style='font-size:
  9.0pt;line-height:107%'> dwContext </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:107%'> _</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:1.6pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>) </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><span style='font-size:9.0pt;line-height:107%;color:slateblue'>Boolean</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.2pt;
  margin-left:0in;text-indent:0in;line-height:107%'><i><span style='font-size:
  9.0pt;line-height:107%;color:green'>'ex: blnRC = FtpPutFile(lngINetConn, </span></i><span
  style='font-size:9.0pt;line-height:107%;font-family:"Arial",sans-serif;
  color:green'></span><i><span style='font-size:9.0pt;line-height:107%;
  color:green'>c:\dirmap.txt</span></i><span style='font-size:9.0pt;line-height:
  107%;font-family:"Arial",sans-serif;color:green'></span><i><span
  style='font-size:9.0pt;line-height:107%;color:green'>, </span></i><span
  style='font-size:9.0pt;line-height:107%;font-family:"Arial",sans-serif;
  color:green'></span><i><span style='font-size:9.0pt;line-height:107%;
  color:green'>dirmap.txt</span></i><span style='font-size:9.0pt;line-height:
  107%;font-family:"Arial",sans-serif;color:green'></span><i><span
  style='font-size:9.0pt;line-height:107%;color:green'>, 1, 0)</span></i></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><i><span style='font-size:
  9.0pt;line-height:107%;color:green'>'Delete a file</span></i></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Private</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Declare</span></b><span style='font-size:9.0pt;line-height:
  107%'> </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Function</span></b><span
  style='font-size:9.0pt;line-height:107%'> FtpDeleteFile </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Lib</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:brown'>&quot;wininet.dll&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Alias</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;line-height:
  107%;color:brown'>&quot;FtpDeleteFileA&quot;</span><span style='font-size:
  9.0pt;line-height:107%'> _</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>( _</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;
  line-height:107%'> hFtpSession </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:107%'>,
  _</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;
  line-height:107%'> lpszFileName </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>String</span><span style='font-size:9.0pt;line-height:107%'>
  _</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:1.6pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>) </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><span style='font-size:9.0pt;line-height:107%;color:slateblue'>Boolean</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.2pt;
  margin-left:0in;text-indent:0in;line-height:107%'><i><span style='font-size:
  9.0pt;line-height:107%;color:green'>'ex: blnRC = FtpDeleteFile(lngINetConn, </span></i><span
  style='font-size:9.0pt;line-height:107%;font-family:"Arial",sans-serif;
  color:green'></span><i><span style='font-size:9.0pt;line-height:107%;
  color:green'>test.txt</span></i><span style='font-size:9.0pt;line-height:
  107%;font-family:"Arial",sans-serif;color:green'></span><i><span
  style='font-size:9.0pt;line-height:107%;color:green'>)</span></i></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><i><span style='font-size:
  9.0pt;line-height:107%;color:green'>'Close the Internet object</span></i></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Private</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Declare</span></b><span style='font-size:9.0pt;line-height:
  107%'> </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Function</span></b><span
  style='font-size:9.0pt;line-height:107%'> InternetCloseHandle </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Lib</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:brown'>&quot;wininet.dll&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> (</span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>ByVal</span></b><span style='font-size:
  9.0pt;line-height:107%'> hInet </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:107%'>) </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>Integer</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><i><span style='font-size:
  9.0pt;line-height:107%;color:green'>'ex: InternetCloseHandle lngINetConn</span></i></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:37.4pt;
  margin-left:0in;text-indent:0in;line-height:107%'><i><span style='font-size:
  9.0pt;line-height:107%;color:green'>'ex: InternetCloseHandle lngINet</span></i></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Private</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Declare</span></b><span style='font-size:9.0pt;line-height:
  107%'> </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Function</span></b><span
  style='font-size:9.0pt;line-height:107%'> FtpFindFirstFile </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Lib</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:brown'>&quot;wininet.dll&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Alias</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;line-height:
  107%;color:brown'>&quot;FtpFindFirstFileA&quot;</span><span style='font-size:
  9.0pt;line-height:107%'> _</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>( _</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:313.1pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:112%'><span style='font-size:
  9.0pt;line-height:112%'> </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;
  line-height:112%'> hFtpSession </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:112%'>,
  _ </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>ByVal</span></b><span
  style='font-size:9.0pt;line-height:112%'> lpszSearchFile </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>String</span><span style='font-size:9.0pt;
  line-height:112%'>, _ lpFindFileData </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> WIN32_FIND_DATA, _ </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>ByVal</span></b><span style='font-size:
  9.0pt;line-height:112%'> dwFlags </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:112%'>,
  _</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;
  line-height:107%'> dwContent </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:107%'> _</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:334.65pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>) </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><span style='font-size:9.0pt;line-height:107%;color:slateblue'>Long </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Private</span></b><span
  style='font-size:9.0pt;line-height:107%'> Type FILETIME dwLowDateTime
  </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>Long </span><span style='font-size:9.0pt;
  line-height:107%'>dwHighDateTime </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Long </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>End</span></b><span style='font-size:9.0pt;line-height:107%'>
  Type </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Private</span></b><span
  style='font-size:9.0pt;line-height:107%'> Type WIN32_FIND_DATA
  dwFileAttributes </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:107%'> </span><span
  style='font-size:9.0pt;line-height:107%;color:slateblue'>Long </span><span
  style='font-size:9.0pt;line-height:107%'>ftCreationTime </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> FILETIME ftLastAccessTime </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> FILETIME ftLastWriteTime </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> FILETIME nFileSizeHigh </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>Long </span><span style='font-size:9.0pt;
  line-height:107%'>nFileSizeLow </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Long</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05pt;margin-bottom:
14.8pt;margin-left:-.45pt;text-indent:0in;line-height:107%'><img border=0
width=719 height=712 id="Picture 302237"
src="VBA%20Notes%20for%20Professionals_files/image484.gif"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>modRegional:</p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=719 height=268
src="VBA%20Notes%20for%20Professionals_files/image485.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:167.65pt;margin-bottom:
.2pt;margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'>
getDateSeparator = Application.International(xlDateSeparator) </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>End</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Function</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Public</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Function</span></b><span style='font-size:
9.0pt;line-height:110%'> getListSeparator() </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>As</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:slateblue'>String</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Dim</span></b><span
style='font-size:9.0pt;line-height:110%'> ListSeparator </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>String</span><span style='font-size:9.0pt;
line-height:110%'>, iRetVal1 </span><b><span style='font-size:9.0pt;line-height:
110%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:slateblue'>Long</span><span
style='font-size:9.0pt;line-height:110%'>, iRetVal2 </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>Long</span><span style='font-size:9.0pt;
line-height:110%'>, lpLCDataVar </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>As</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:slateblue'>String</span><span style='font-size:9.0pt;line-height:110%'>,</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:313.45pt;margin-bottom:
.2pt;margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'>Position
</span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>Integer</span><span style='font-size:9.0pt;
line-height:110%'>, Locale </span><b><span style='font-size:9.0pt;line-height:
110%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:slateblue'>Long </span><span
style='font-size:9.0pt;line-height:110%'>Locale = GetUserDefaultLCID()</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:108.2pt;margin-bottom:
.2pt;margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'>
iRetVal1 = GetLocaleInfo(Locale, LOCALE_SLIST, lpLCDataVar, </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>0</span><span
style='font-size:9.0pt;line-height:110%'>) ListSeparator = </span><span
style='font-size:9.0pt;line-height:110%;color:slateblue'>String</span><span
style='font-size:9.0pt;line-height:110%'>$(iRetVal1, </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>0</span><span
style='font-size:9.0pt;line-height:110%'>)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'> iRetVal2
= GetLocaleInfo(Locale, LOCALE_SLIST, ListSeparator, iRetVal1)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'> Position
= </span><span style='font-size:9.0pt;line-height:110%;color:#000066'>InStr</span><span
style='font-size:9.0pt;line-height:110%'>(ListSeparator, </span><span
style='font-size:9.0pt;line-height:110%;color:#000066'>Chr$</span><span
style='font-size:9.0pt;line-height:110%'>(</span><span style='font-size:9.0pt;
line-height:110%;color:brown'>0</span><span style='font-size:9.0pt;line-height:
110%'>))</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><span style='position:relative;z-index:-1895753728'><span
style='left:0px;position:absolute;left:0px;top:-133361px;width:718px;
height:1px'><img width=718 height=1
src="VBA%20Notes%20for%20Professionals_files/image486.gif"></span></span><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>If</span></b><span style='font-size:9.0pt;
line-height:110%'> Position &gt; </span><span style='font-size:9.0pt;
line-height:110%;color:brown'>0</span><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Then</span></b><span
style='font-size:9.0pt;line-height:110%'> ListSeparator = </span><span
style='font-size:9.0pt;line-height:110%;color:#000066'>Left$</span><span
style='font-size:9.0pt;line-height:110%'>(ListSeparator, Position - </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>1</span><span
style='font-size:9.0pt;line-height:110%'>) </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Else</span></b><span style='font-size:9.0pt;
line-height:110%'> ListSeparator = vbNullString</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:324.25pt;margin-bottom:
12.45pt;margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'>
getListSeparator = ListSeparator </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>End</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>Function</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.05pt;margin-bottom:.25pt;
margin-left:3.5pt'><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Private</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Sub</span></b><span style='font-size:9.0pt;
line-height:110%'> ChangeSettingExample() </span><i><span style='font-size:
9.0pt;line-height:110%;color:green'>'change the setting of the character
displayed as the decimal separator.</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Call</span></b><span
style='font-size:9.0pt;line-height:110%'> SetLocalSetting(LOCALE_SDECIMAL, </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>&quot;,&quot;</span><span
style='font-size:9.0pt;line-height:110%'>) </span><i><span style='font-size:
9.0pt;line-height:110%;color:green'>'to change to &quot;,&quot;</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.05pt;margin-bottom:.25pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Stop</span></b><span
style='font-size:9.0pt;line-height:110%'>
</span><i><span style='font-size:9.0pt;line-height:110%;color:green'>'check
your control panel to verify or use the GetLocaleInfo API function</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:143.2pt;margin-bottom:
12.45pt;margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Call</span></b><span
style='font-size:9.0pt;line-height:110%'> SetLocalSetting(LOCALE_SDECIMAL, </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>&quot;.&quot;</span><span
style='font-size:9.0pt;line-height:110%'>) </span><i><span style='font-size:
9.0pt;line-height:110%;color:green'>'to back change to &quot;.&quot; </span></i><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>End</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Sub</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Private</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Function</span></b><span style='font-size:
9.0pt;line-height:110%'> SetLocalSetting(LC_CONST </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>Long</span><span style='font-size:9.0pt;
line-height:110%'>, Setting </span><b><span style='font-size:9.0pt;line-height:
110%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:slateblue'>String</span><span
style='font-size:9.0pt;line-height:110%'>) </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>As</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:slateblue'>Boolean</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:178.4pt;margin-bottom:
22.95pt;margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Call</span></b><span
style='font-size:9.0pt;line-height:110%'> SetLocaleInfo(GetUserDefaultLCID(),
LC_CONST, Setting) </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>End</span></b><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Function</span></b></p>

<h2 style='margin-left:-.25pt'><a name="_Toc308852">Section 46.4: API
declaration and usage</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'><a
href="https://msdn.microsoft.com/en-us/library/aa716201(v=vs.60).aspx"><span
style='color:#193C96'>Declaring a DLL procedure</span></a> to work with
different VBA versions:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=191
src="VBA%20Notes%20for%20Professionals_files/image487.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.8pt;
margin-left:.75pt'>The above declaration tells VBA how to call the function
&quot;Sleep&quot; defined in file Kernel32.dll</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.8pt;
margin-left:.75pt'>Win64 and Win32 are predefined constants used for
conditional compilation</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.8pt;
margin-left:.75pt'>Pre-defined Constants</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.45pt;
margin-left:.75pt'>Some compilation constants are already pre-defined. Which
ones exist will depend on the bitness of the office version you're running VBA
in. Note that Vba7 was introduced alongside Office 2010 to support 64 bit
versions of Office.</p>

<h4 style='margin-top:0in;margin-right:373.15pt;margin-bottom:.05in;margin-left:
.75pt'>Constant 16 bit 32 bit 64 bit <span style='font-weight:normal'>Vba6
False If Vba6 False</span></h4>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:3.85pt;
margin-left:0in;text-indent:0in'>Vba7 False If Vba7 True</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:3.85pt;
margin-left:0in;text-indent:0in'>Win16 True False False</p>

<p class=MsoNormal style='margin-left:0in;text-indent:0in'>Win32 False
True True</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:3.85pt;
margin-left:0in;text-indent:0in'>Win64 False False True</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:15.05pt;
margin-left:0in;text-indent:0in'>Mac False If Mac If Mac</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.45pt;
margin-left:.75pt'>These constants refer to the Office version, not the Windows
version. For example Win32 = TRUE in 32-bit Office, even if the OS is a 64-bit
version of Windows.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:76.15pt;
margin-left:.75pt'>The main difference when declaring APIs is between 32 bit
and 64 bit Office versions which introduced new parameter types (see Remarks
section for more details)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:54.5pt'><img width=52 height=1
src="VBA%20Notes%20for%20Professionals_files/image488.gif" align=left
hspace=12>Declarations are placed at the top of the module, and outside any
Subs or Functions</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:54.5pt'>Procedures declared in standard modules are public by
default</p>

<p class=MsoNormal style='margin-top:0in;margin-right:28.5pt;margin-bottom:
20.75pt;margin-left:54.5pt'>To declare a procedure private to a module precede
the declaration with the <b><span style='font-size:9.0pt;line-height:110%;
color:blue;background:#FAFAFA'>Private</span></b> keyword DLL procedures
declared in any other type of module are private to that module</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:0in;
margin-left:.75pt'>Simple example for the Sleep API call:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=223
src="VBA%20Notes%20for%20Professionals_files/image489.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.45pt;
margin-left:.75pt'>It is recommended to create a dedicated API module to
provide easy access to the system functions from VBA wrappers -- normal VBA
Subs or Functions that encapsulate the details needed for the actual system
call such as parameters used in libraries, and initialization of those
parameters</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:12.8pt;
margin-left:.75pt'>The module can contain all declarations and dependencies:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:1.5pt;
margin-left:21.4pt'><img width=5 height=1
src="VBA%20Notes%20for%20Professionals_files/image166.gif" align=left
hspace=12>Method signatures and required data structures</p>

<p class=MsoNormal style='margin-top:0in;margin-right:65.15pt;margin-bottom:
.2pt;margin-left:.25pt;text-indent:5.5pt;line-height:215%'>Wrappers that
perform input validation, and ensure all parameters are passed as expected To
declare a DLL procedure, add a <b><span style='font-size:9.0pt;line-height:
215%;color:blue;background:#FAFAFA'>Declare</span></b> statement to the
Declarations section of the code window.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:14.7pt;
margin-left:.75pt'>If the procedure returns a value, declare it as a <b>Function</b>:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:17.45pt;
margin-left:3.5pt'><span style='position:relative;z-index:-1895750656'><span
style='left:0px;position:absolute;left:0px;top:-134999px;width:718px;
height:1px'><img width=718 height=1
src="VBA%20Notes%20for%20Professionals_files/image147.gif"></span></span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Declare</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Function</span></b><span style='font-size:
9.0pt;line-height:110%'> publicname </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Lib</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:brown'>&quot;libname&quot;</span><span style='font-size:9.0pt;line-height:
110%'> [</span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Alias</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:brown'>&quot;alias&quot;</span><span style='font-size:
9.0pt;line-height:110%'>] [([[</span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;
line-height:110%'>] variable [</span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>As</span></b><span style='font-size:9.0pt;
line-height:110%'> type] [,[</span><b><span style='font-size:9.0pt;line-height:
110%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:110%'>]
variable [</span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> type]]...])] </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> Type</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:14.7pt;
margin-left:.75pt'>If a procedure does not return a value, declare it as a <b>Sub</b>:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><span style='position:relative;z-index:-1895749632'><span
style='left:0px;position:absolute;left:0px;top:-135078px;width:718px;
height:1px'><img width=718 height=1
src="VBA%20Notes%20for%20Professionals_files/image147.gif"></span></span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Declare</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Sub</span></b><span style='font-size:9.0pt;
line-height:110%'> publicname </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Lib</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:brown'>&quot;libname&quot;</span><span style='font-size:9.0pt;line-height:
110%'> [</span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Alias</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:brown'>&quot;alias&quot;</span><span style='font-size:
9.0pt;line-height:110%'>] [([[</span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;
line-height:110%'>] variable [</span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>As</span></b><span style='font-size:9.0pt;
line-height:110%'> type] [,[</span><b><span style='font-size:9.0pt;line-height:
110%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:110%'>]
variable [</span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> type]]...])]</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:24.25pt;
margin-left:16.25pt'><img width=13 height=1
src="VBA%20Notes%20for%20Professionals_files/image490.gif" align=left
hspace=12>!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:24.25pt;
margin-left:24.5pt'>Also of note is that <b>most invalid calls to the API's
will crash Excel</b>, and possibly corrupt data files</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:13.05pt;
margin-left:16.25pt'>!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</p>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:0in;margin-left:.75pt'>Office
2011 for Mac</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:14.95pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%'><img border=0 width=718 height=125
src="VBA%20Notes%20for%20Professionals_files/image491.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:18.2pt;
margin-left:.75pt'>The examples bellow (Windows API - Dedicated Module (1 and
2)) show an API module that includes common declarations for Win64 and Win32</p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:4.2pt;margin-left:
-.25pt'><a name="_Toc308853">Section 46.5: Windows API - Dedicated Module (1 of
2)</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:12.55pt;
margin-left:3.5pt'><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Option</span></b><span
style='font-size:9.0pt;line-height:110%'> Explicit</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.05pt;margin-bottom:.25pt;
margin-left:3.5pt'><b><span style='font-size:9.0pt;line-height:110%;color:slateblue'>#If</span></b><span
style='font-size:9.0pt;line-height:110%'> Win64 </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Then</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><i><span style='font-size:
9.0pt;line-height:110%;color:green'>'Win64 = True, Win32 = False, Win16 = False</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Private</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Declare</span></b><span style='font-size:
9.0pt;line-height:110%'> PtrSafe </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Sub</span></b><span style='font-size:9.0pt;
line-height:110%'> apiCopyMemory </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Lib</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:brown'>&quot;Kernel32&quot;</span><span style='font-size:9.0pt;
line-height:110%'> </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>Alias</span></b><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>&quot;RtlMoveMemory&quot;</span><span
style='font-size:9.0pt;line-height:110%'> (MyDest </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> Any, MySource </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> Any, </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>ByVal</span></b><span
style='font-size:9.0pt;line-height:110%'> MySize </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>Long</span><span style='font-size:9.0pt;
line-height:110%'>)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Private</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Declare</span></b><span style='font-size:
9.0pt;line-height:110%'> PtrSafe </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Sub</span></b><span style='font-size:9.0pt;
line-height:110%'> apiExitProcess </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Lib</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:brown'>&quot;Kernel32&quot;</span><span style='font-size:9.0pt;
line-height:110%'> </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>Alias</span></b><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>&quot;ExitProcess&quot;</span><span
style='font-size:9.0pt;line-height:110%'> (</span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;
line-height:110%'> uExitCode </span><b><span style='font-size:9.0pt;line-height:
110%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:slateblue'>Long</span><span
style='font-size:9.0pt;line-height:110%'>)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Private</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Declare</span></b><span style='font-size:
9.0pt;line-height:110%'> PtrSafe </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Sub</span></b><span style='font-size:9.0pt;
line-height:110%'> apiSetCursorPos </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Lib</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:brown'>&quot;User32&quot;</span><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Alias</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:brown'>&quot;SetCursorPos&quot;</span><span
style='font-size:9.0pt;line-height:110%'> (</span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;
line-height:110%'> X </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>As </span></b><span style='font-size:9.0pt;line-height:110%;
color:slateblue'>Integer</span><span style='font-size:9.0pt;line-height:110%'>,
</span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>ByVal</span></b><span
style='font-size:9.0pt;line-height:110%'> Y </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>As</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:slateblue'>Integer</span><span style='font-size:9.0pt;line-height:110%'>)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Private</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Declare</span></b><span style='font-size:
9.0pt;line-height:110%'> PtrSafe </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Sub</span></b><span style='font-size:9.0pt;
line-height:110%'> apiSleep </span><b><span style='font-size:9.0pt;line-height:
110%;color:blue'>Lib</span></b><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>&quot;Kernel32&quot;</span><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Alias</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:brown'>&quot;Sleep&quot;</span><span style='font-size:9.0pt;line-height:
110%'> (</span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>ByVal</span></b><span
style='font-size:9.0pt;line-height:110%'> dwMilliseconds </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>As </span></b><span
style='font-size:9.0pt;line-height:110%;color:slateblue'>Long</span><span
style='font-size:9.0pt;line-height:110%'>)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Private</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Declare</span></b><span style='font-size:
9.0pt;line-height:110%'> PtrSafe </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Function</span></b><span style='font-size:9.0pt;
line-height:110%'> apiAttachThreadInput </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Lib</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:brown'>&quot;User32&quot;</span><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Alias</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:brown'>&quot;AttachThreadInput&quot;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:27.2pt;margin-bottom:
.2pt;margin-left:3.5pt'><span style='position:relative;z-index:-1895747584'><span
style='left:0px;position:absolute;left:0px;top:-135658px;width:718px;
height:1px'><img width=718 height=1
src="VBA%20Notes%20for%20Professionals_files/image492.gif"></span></span><span
style='font-size:9.0pt;line-height:110%'>(</span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;
line-height:110%'> idAttach </span><b><span style='font-size:9.0pt;line-height:
110%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:slateblue'>Long</span><span
style='font-size:9.0pt;line-height:110%'>, </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;
line-height:110%'> idAttachTo </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>As</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:110%'>, </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>ByVal</span></b><span
style='font-size:9.0pt;line-height:110%'> fAttach </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>Long</span><span style='font-size:9.0pt;
line-height:110%'>) </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>As</span></b><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:slateblue'>Long </span><span
style='font-size:9.0pt;line-height:110%'></span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Private</span></b><span style='font-size:
9.0pt;line-height:110%'> </span><b><span style='font-size:9.0pt;line-height:
110%;color:blue'>Declare</span></b><span style='font-size:9.0pt;line-height:
110%'> PtrSafe </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>Function</span></b><span style='font-size:9.0pt;line-height:110%'>
apiBringWindowToTop </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>Lib</span></b><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>&quot;User32&quot;</span><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Alias</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:brown'>&quot;BringWindowToTop&quot; </span><span style='font-size:9.0pt;
line-height:110%'>(</span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:110%'>
lngHWnd </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>Long</span><span style='font-size:9.0pt;
line-height:110%'>) </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>As</span></b><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:slateblue'>Long</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Private</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Declare</span></b><span style='font-size:
9.0pt;line-height:110%'> PtrSafe </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Function</span></b><span style='font-size:9.0pt;
line-height:110%'> apiCloseWindow </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Lib</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:brown'>&quot;User32&quot;</span><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Alias</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:brown'>&quot;CloseWindow&quot;</span><span
style='font-size:9.0pt;line-height:110%'> (</span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;
line-height:110%'> hWnd </span><b><span style='font-size:9.0pt;line-height:
110%;color:blue'>As </span></b><span style='font-size:9.0pt;line-height:110%;
color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:110%'>) </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>Long</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Private</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Declare</span></b><span style='font-size:
9.0pt;line-height:110%'> PtrSafe </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Function</span></b><span style='font-size:9.0pt;
line-height:110%'> apiDestroyWindow </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Lib</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:brown'>&quot;User32&quot;</span><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Alias</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:brown'>&quot;DestroyWindow&quot;</span><span
style='font-size:9.0pt;line-height:110%'> (</span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>ByVal </span></b><span style='font-size:
9.0pt;line-height:110%'>hWnd </span><b><span style='font-size:9.0pt;line-height:
110%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:slateblue'>Long</span><span
style='font-size:9.0pt;line-height:110%'>) </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>As</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:slateblue'>Boolean</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Private</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Declare</span></b><span style='font-size:
9.0pt;line-height:110%'> PtrSafe </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Function</span></b><span style='font-size:9.0pt;
line-height:110%'> apiEndDialog </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Lib</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:brown'>&quot;User32&quot;</span><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Alias</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:brown'>&quot;EndDialog&quot;</span><span
style='font-size:9.0pt;line-height:110%'> (</span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;
line-height:110%'> hWnd </span><b><span style='font-size:9.0pt;line-height:
110%;color:blue'>As</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.25pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%;color:slateblue'>Long</span><span
style='font-size:9.0pt;line-height:110%'>, </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;
line-height:110%'> result </span><b><span style='font-size:9.0pt;line-height:
110%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:slateblue'>Long</span><span
style='font-size:9.0pt;line-height:110%'>) </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>As</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:slateblue'>Boolean</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Private</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Declare</span></b><span style='font-size:
9.0pt;line-height:110%'> PtrSafe </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Function</span></b><span style='font-size:9.0pt;
line-height:110%'> apiEnumChildWindows </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Lib</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:brown'>&quot;User32&quot;</span><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Alias</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:brown'>&quot;EnumChildWindows&quot;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'>(</span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>ByVal</span></b><span
style='font-size:9.0pt;line-height:110%'> hWndParent </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>Long</span><span style='font-size:9.0pt;
line-height:110%'>, </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:110%'>
pEnumProc </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>Long</span><span style='font-size:9.0pt;
line-height:110%'>, </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:110%'>
lParam </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>Long</span><span style='font-size:9.0pt;
line-height:110%'>) </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>As</span></b><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:slateblue'>Long</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Private</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Declare</span></b><span style='font-size:
9.0pt;line-height:110%'> PtrSafe </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Function</span></b><span style='font-size:9.0pt;
line-height:110%'> apiExitWindowsEx </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Lib</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:brown'>&quot;User32&quot;</span><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Alias</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:brown'>&quot;ExitWindowsEx&quot;</span><span
style='font-size:9.0pt;line-height:110%'> (</span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>ByVal </span></b><span style='font-size:
9.0pt;line-height:110%'>uFlags </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>As</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:110%'>, </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>ByVal</span></b><span
style='font-size:9.0pt;line-height:110%'> dwReserved </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>Long</span><span style='font-size:9.0pt;
line-height:110%'>) </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>As</span></b><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:slateblue'>Long</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Private</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Declare</span></b><span style='font-size:
9.0pt;line-height:110%'> PtrSafe </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Function</span></b><span style='font-size:9.0pt;
line-height:110%'> apiFindExecutable </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Lib</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:brown'>&quot;Shell32&quot;</span><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Alias</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:brown'>&quot;FindExecutableA&quot;</span><span
style='font-size:9.0pt;line-height:110%'> (</span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>ByVal </span></b><span style='font-size:
9.0pt;line-height:110%'>lpFile </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>As</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:slateblue'>String</span><span style='font-size:9.0pt;line-height:110%'>,
ByVallpDirectory </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>As</span></b><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:slateblue'>String</span><span
style='font-size:9.0pt;line-height:110%'>, </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;
line-height:110%'> lpResult </span><b><span style='font-size:9.0pt;line-height:
110%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:slateblue'>String</span><span
style='font-size:9.0pt;line-height:110%'>) </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>As</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:slateblue'>Long</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Private</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Declare</span></b><span style='font-size:
9.0pt;line-height:110%'> PtrSafe </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Function</span></b><span style='font-size:9.0pt;
line-height:110%'> apiFindWindow </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Lib</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:brown'>&quot;User32&quot;</span><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Alias</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:brown'>&quot;FindWindowA&quot;</span><span
style='font-size:9.0pt;line-height:110%'> (</span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>ByVal </span></b><span style='font-size:
9.0pt;line-height:110%'>lpClassName </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>As</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:slateblue'>String</span><span style='font-size:9.0pt;line-height:110%'>, </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>ByVal</span></b><span
style='font-size:9.0pt;line-height:110%'> lpWindowName </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>String</span><span style='font-size:9.0pt;
line-height:110%'>) </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>As</span></b><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:slateblue'>Long</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Private</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Declare</span></b><span style='font-size:
9.0pt;line-height:110%'> PtrSafe </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Function</span></b><span style='font-size:9.0pt;
line-height:110%'> apiFindWindowEx </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Lib</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:brown'>&quot;User32&quot;</span><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Alias</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:brown'>&quot;FindWindowExA&quot;</span><span
style='font-size:9.0pt;line-height:110%'> (</span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>ByVal </span></b><span style='font-size:
9.0pt;line-height:110%'>hWnd1 </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>As</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:110%'>, </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>ByVal</span></b><span
style='font-size:9.0pt;line-height:110%'> hWnd2 </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>Long</span><span style='font-size:9.0pt;
line-height:110%'>, </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:110%'>
lpsz1 </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>String</span><span style='font-size:9.0pt;
line-height:110%'>, </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:110%'>
lpsz2 </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>String</span><span style='font-size:9.0pt;
line-height:110%'>) </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>As</span></b><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:slateblue'>Long</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Private</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Declare</span></b><span style='font-size:
9.0pt;line-height:110%'> PtrSafe </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Function</span></b><span style='font-size:9.0pt;
line-height:110%'> apiGetActiveWindow </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Lib</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:brown'>&quot;User32&quot;</span><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Alias</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:brown'>&quot;GetActiveWindow&quot;</span><span
style='font-size:9.0pt;line-height:110%'> () </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>As </span></b><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>Long</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Private</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Declare</span></b><span style='font-size:
9.0pt;line-height:110%'> PtrSafe </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Function</span></b><span style='font-size:9.0pt;
line-height:110%'> apiGetClassNameA </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Lib</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:brown'>&quot;User32&quot;</span><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Alias</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:brown'>&quot;GetClassNameA&quot;</span><span
style='font-size:9.0pt;line-height:110%'> (</span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>ByVal </span></b><span style='font-size:
9.0pt;line-height:110%'>hWnd </span><b><span style='font-size:9.0pt;line-height:
110%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:slateblue'>Long</span><span
style='font-size:9.0pt;line-height:110%'>, </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;
line-height:110%'> szClassName </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>As</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:slateblue'>String</span><span style='font-size:9.0pt;line-height:110%'>, </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>ByVal</span></b><span
style='font-size:9.0pt;line-height:110%'> lLength </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>Long</span><span style='font-size:9.0pt;
line-height:110%'>) </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>As</span></b><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:slateblue'>Long</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Private</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Declare</span></b><span style='font-size:
9.0pt;line-height:110%'> PtrSafe </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Function</span></b><span style='font-size:9.0pt;
line-height:110%'> apiGetCommandLine </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Lib</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:brown'>&quot;Kernel32&quot;</span><span style='font-size:9.0pt;
line-height:110%'> </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>Alias</span></b><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>&quot;GetCommandLineW&quot;</span><span
style='font-size:9.0pt;line-height:110%'> () </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>As</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.25pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%;color:slateblue'>Long</span></p>

</div>

<span style='font-size:10.0pt;line-height:110%;font-family:"Calibri",sans-serif;
color:black'><br clear=all style='page-break-before:always'>
</span>

<div class=WordSection3>

<p class=MsoNormal style='margin-top:0in;margin-right:566.75pt;margin-bottom:
0in;margin-left:-28.35pt;text-indent:0in;line-height:107%'>&nbsp;</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=718
 style='width:538.6pt;border-collapse:collapse'>
 <tr style='height:771.0pt'>
  <td width=718 valign=top style='width:538.6pt;background:#FAFAFA;padding:
  2.55pt .2pt 0in 3.75pt;height:771.0pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:112%'><span style='font-size:9.0pt;line-height:
  112%'> </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>Private</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Declare</span></b><span style='font-size:
  9.0pt;line-height:112%'> PtrSafe </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Function</span></b><span style='font-size:9.0pt;
  line-height:112%'> apiGetCommandLineParams </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Lib</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:brown'>&quot;Kernel32&quot;</span><span style='font-size:9.0pt;
  line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>Alias</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:brown'>&quot;GetCommandLineA&quot;
  </span><span style='font-size:9.0pt;line-height:112%'>() </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Private</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Declare</span></b><span style='font-size:9.0pt;line-height:107%'>
  PtrSafe </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Function</span></b><span
  style='font-size:9.0pt;line-height:107%'> apiGetDiskFreeSpaceEx </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Lib</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:brown'>&quot;Kernel32&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Alias</span></b></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:112%'><span
  style='font-size:9.0pt;line-height:112%;color:brown'>&quot;GetDiskFreeSpaceExA&quot;</span><span
  style='font-size:9.0pt;line-height:112%'> (</span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>ByVal</span></b><span style='font-size:
  9.0pt;line-height:112%'> lpDirectoryName </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>String</span><span style='font-size:9.0pt;line-height:112%'>,
  lpFreeBytesAvailableToCaller </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> Currency, lpTotalNumberOfBytes </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> Currency, lpTotalNumberOfFreeBytes </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> Currency) </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:112%'><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>Private</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Declare</span></b><span style='font-size:
  9.0pt;line-height:112%'> PtrSafe </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Function</span></b><span style='font-size:9.0pt;
  line-height:112%'> apiGetDriveType </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Lib</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:brown'>&quot;Kernel32&quot;</span><span style='font-size:9.0pt;
  line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>Alias</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:brown'>&quot;GetDriveTypeA&quot;</span><span
  style='font-size:9.0pt;line-height:112%'> (</span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>ByVal </span></b><span style='font-size:
  9.0pt;line-height:112%'>nDrive </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>String</span><span style='font-size:9.0pt;line-height:112%'>)
  </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Private</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Declare</span></b><span style='font-size:9.0pt;line-height:107%'>
  PtrSafe </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Function</span></b><span
  style='font-size:9.0pt;line-height:107%'> apiGetExitCodeProcess </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Lib</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:brown'>&quot;Kernel32&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Alias</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:brown'>&quot;GetExitCodeProcess&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> (</span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>ByVal</span></b><span style='font-size:
  9.0pt;line-height:107%'> hProcess </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:107%'>,
  lpExitCode </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:107%'> </span><span
  style='font-size:9.0pt;line-height:107%;color:slateblue'>Long</span><span
  style='font-size:9.0pt;line-height:107%'>) </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Private</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Declare</span></b><span style='font-size:9.0pt;line-height:107%'>
  PtrSafe </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Function</span></b><span
  style='font-size:9.0pt;line-height:107%'> apiGetForegroundWindow </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Lib</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:brown'>&quot;User32&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Alias</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:brown'>&quot;GetForegroundWindow&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> () </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Private</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Declare</span></b><span style='font-size:9.0pt;line-height:107%'>
  PtrSafe </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Function</span></b><span
  style='font-size:9.0pt;line-height:107%'> apiGetFrequency </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Lib</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:brown'>&quot;Kernel32&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Alias</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:brown'>&quot;QueryPerformanceFrequency&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> (cyFrequency </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> Currency) </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:112%'><span style='font-size:9.0pt;line-height:
  112%'> </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>Private</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Declare</span></b><span style='font-size:
  9.0pt;line-height:112%'> PtrSafe </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Function</span></b><span style='font-size:9.0pt;
  line-height:112%'> apiGetLastError </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Lib</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:brown'>&quot;Kernel32&quot;</span><span style='font-size:9.0pt;
  line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>Alias</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:brown'>&quot;GetLastError&quot;</span><span
  style='font-size:9.0pt;line-height:112%'> () </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As </span></b><span
  style='font-size:9.0pt;line-height:112%;color:slateblue'>Integer</span></p>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:112%'><span style='font-size:9.0pt;line-height:
  112%'> </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>Private</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Declare</span></b><span style='font-size:
  9.0pt;line-height:112%'> PtrSafe </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Function</span></b><span style='font-size:9.0pt;
  line-height:112%'> apiGetParent </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Lib</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:brown'>&quot;User32&quot;</span><span style='font-size:9.0pt;
  line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>Alias</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:brown'>&quot;GetParent&quot;</span><span
  style='font-size:9.0pt;line-height:112%'> (</span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>ByVal</span></b><span style='font-size:
  9.0pt;line-height:112%'> hWnd </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As </span></b><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:112%'>) </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:112%'><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>Private</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Declare</span></b><span style='font-size:
  9.0pt;line-height:112%'> PtrSafe </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Function</span></b><span style='font-size:9.0pt;
  line-height:112%'> apiGetSystemMetrics </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Lib</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:brown'>&quot;User32&quot;</span><span style='font-size:9.0pt;
  line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>Alias</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:brown'>&quot;GetSystemMetrics&quot;
  </span><span style='font-size:9.0pt;line-height:112%'>(</span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>ByVal</span></b><span
  style='font-size:9.0pt;line-height:112%'> nIndex </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:112%'>) </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:112%'><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>Private</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Declare</span></b><span style='font-size:
  9.0pt;line-height:112%'> PtrSafe </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Function</span></b><span style='font-size:9.0pt;
  line-height:112%'> apiGetSystemMetrics32 </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Lib</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:brown'>&quot;User32&quot;</span><span style='font-size:9.0pt;
  line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>Alias</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:brown'>&quot;GetSystemMetrics&quot;
  </span><span style='font-size:9.0pt;line-height:112%'>(</span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>ByVal</span></b><span
  style='font-size:9.0pt;line-height:112%'> nIndex </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:112%'>) </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:112%'><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>Private</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Declare</span></b><span style='font-size:
  9.0pt;line-height:112%'> PtrSafe </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Function</span></b><span style='font-size:9.0pt;
  line-height:112%'> apiGetTickCount </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Lib</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:brown'>&quot;Kernel32&quot;</span><span style='font-size:9.0pt;
  line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>Alias</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:brown'>&quot;QueryPerformanceCounter&quot;
  </span><span style='font-size:9.0pt;line-height:112%'>(cyTickCount </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> Currency) </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Private</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Declare</span></b><span style='font-size:9.0pt;line-height:107%'>
  PtrSafe </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Function</span></b><span
  style='font-size:9.0pt;line-height:107%'> apiGetTickCountMs </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Lib</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:brown'>&quot;Kernel32&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Alias</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;line-height:
  107%;color:brown'>&quot;GetTickCount&quot;</span><span style='font-size:9.0pt;
  line-height:107%'> () </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>As</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:112%'><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>Private</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Declare</span></b><span style='font-size:
  9.0pt;line-height:112%'> PtrSafe </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Function</span></b><span style='font-size:9.0pt;
  line-height:112%'> apiGetUserName </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Lib</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:brown'>&quot;AdvApi32&quot;</span><span style='font-size:9.0pt;
  line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>Alias</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:brown'>&quot;GetUserNameA&quot;</span><span
  style='font-size:9.0pt;line-height:112%'> (</span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>ByVal </span></b><span style='font-size:
  9.0pt;line-height:112%'>lpBuffer </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>String</span><span style='font-size:9.0pt;line-height:112%'>,
  nSize </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:112%'>) </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:112%'><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>Private</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Declare</span></b><span style='font-size:
  9.0pt;line-height:112%'> PtrSafe </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Function</span></b><span style='font-size:9.0pt;
  line-height:112%'> apiGetWindow </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Lib</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:brown'>&quot;User32&quot;</span><span style='font-size:9.0pt;
  line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>Alias</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:brown'>&quot;GetWindow&quot;</span><span
  style='font-size:9.0pt;line-height:112%'> (</span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>ByVal</span></b><span style='font-size:
  9.0pt;line-height:112%'> hWnd </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As </span></b><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:112%'>, </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:112%'>
  wCmd </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:112%'>) </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:112%'><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>Private</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Declare</span></b><span style='font-size:
  9.0pt;line-height:112%'> PtrSafe </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Function</span></b><span style='font-size:9.0pt;
  line-height:112%'> apiGetWindowRect </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Lib</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:brown'>&quot;User32&quot;</span><span style='font-size:9.0pt;
  line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>Alias</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:brown'>&quot;GetWindowRect&quot;</span><span
  style='font-size:9.0pt;line-height:112%'> (</span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>ByVal </span></b><span style='font-size:
  9.0pt;line-height:112%'>hWnd </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:112%'>,
  lpRect </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> winRect) </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:112%'><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>Private</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Declare</span></b><span style='font-size:
  9.0pt;line-height:112%'> PtrSafe </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Function</span></b><span style='font-size:9.0pt;
  line-height:112%'> apiGetWindowText </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Lib</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:brown'>&quot;User32&quot;</span><span style='font-size:9.0pt;
  line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>Alias</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:brown'>&quot;GetWindowTextA&quot;</span><span
  style='font-size:9.0pt;line-height:112%'> (</span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>ByVal </span></b><span style='font-size:
  9.0pt;line-height:112%'>hWnd </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:112%'>, </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>ByVal</span></b><span
  style='font-size:9.0pt;line-height:112%'> szWindowText </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>String</span><span style='font-size:9.0pt;
  line-height:112%'>, </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:112%'>
  lLength </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:112%'>) </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Private</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Declare</span></b><span style='font-size:9.0pt;line-height:107%'>
  PtrSafe </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Function</span></b><span
  style='font-size:9.0pt;line-height:107%'> apiGetWindowThreadProcessId </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Lib</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:brown'>&quot;User32&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Alias</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:1.05in;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:112%'><span style='font-size:
  9.0pt;line-height:112%;color:brown'>&quot;GetWindowThreadProcessId&quot;</span><span
  style='font-size:9.0pt;line-height:112%'> (</span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>ByVal</span></b><span style='font-size:
  9.0pt;line-height:112%'> hWnd </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:112%'>,
  lpdwProcessId </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:slateblue'>Long</span><span
  style='font-size:9.0pt;line-height:112%'>) </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Long </span><span style='font-size:9.0pt;line-height:112%'></span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>Private</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Declare</span></b><span style='font-size:
  9.0pt;line-height:112%'> PtrSafe </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Function</span></b><span style='font-size:9.0pt;
  line-height:112%'> apiIsCharAlphaNumericA </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Lib</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:brown'>&quot;User32&quot;</span><span style='font-size:9.0pt;
  line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>Alias</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:brown'>&quot;IsCharAlphaNumericA&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> (</span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>ByVal</span></b><span style='font-size:
  9.0pt;line-height:107%'> byChar </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Byte</span><span style='font-size:9.0pt;line-height:107%'>) </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-align:justify;text-justify:inter-ideograph;text-indent:
  0in;line-height:107%'><span style='font-size:9.0pt;line-height:107%'> </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Private</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Declare</span></b><span style='font-size:
  9.0pt;line-height:107%'> PtrSafe </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Function</span></b><span style='font-size:9.0pt;
  line-height:107%'> apiIsIconic </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Lib</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:brown'>&quot;User32&quot;</span><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Alias</span></b><span style='font-size:9.0pt;line-height:107%'> </span><span
  style='font-size:9.0pt;line-height:107%;color:brown'>&quot;IsIconic&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> (</span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>ByVal</span></b><span style='font-size:
  9.0pt;line-height:107%'> hWnd </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:107%'>)</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:112%'><span style='font-size:9.0pt;line-height:
  112%'> </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>Private</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Declare</span></b><span style='font-size:
  9.0pt;line-height:112%'> PtrSafe </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Function</span></b><span style='font-size:9.0pt;
  line-height:112%'> apiIsWindowVisible </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Lib</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:brown'>&quot;User32&quot;</span><span style='font-size:9.0pt;
  line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>Alias</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:brown'>&quot;IsWindowVisible&quot;</span><span
  style='font-size:9.0pt;line-height:112%'> (</span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>ByVal </span></b><span style='font-size:
  9.0pt;line-height:112%'>hWnd </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:112%'>) </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:112%'><span style='font-size:9.0pt;line-height:
  112%'> </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>Private</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Declare</span></b><span style='font-size:
  9.0pt;line-height:112%'> PtrSafe </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Function</span></b><span style='font-size:9.0pt;
  line-height:112%'> apiIsZoomed </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Lib</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:brown'>&quot;User32&quot;</span><span style='font-size:9.0pt;
  line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>Alias</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:brown'>&quot;IsZoomed&quot;</span><span
  style='font-size:9.0pt;line-height:112%'> (</span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>ByVal</span></b><span style='font-size:
  9.0pt;line-height:112%'> hWnd </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:112%'>) </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:112%'><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>Private</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Declare</span></b><span style='font-size:
  9.0pt;line-height:112%'> PtrSafe </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Function</span></b><span style='font-size:9.0pt;
  line-height:112%'> apiLStrCpynA </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Lib</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:brown'>&quot;Kernel32&quot;</span><span style='font-size:9.0pt;
  line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>Alias</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:brown'>&quot;lstrcpynA&quot;</span><span
  style='font-size:9.0pt;line-height:112%'> (</span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>ByVal </span></b><span style='font-size:
  9.0pt;line-height:112%'>pDestination </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>String</span><span style='font-size:9.0pt;line-height:112%'>,
  </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>ByVal</span></b><span
  style='font-size:9.0pt;line-height:112%'> pSource </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:112%'>, </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:112%'>
  iMaxLength </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:slateblue'>Integer</span><span
  style='font-size:9.0pt;line-height:112%'>) </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Private</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Declare</span></b><span style='font-size:9.0pt;line-height:107%'>
  PtrSafe </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Function</span></b><span
  style='font-size:9.0pt;line-height:107%'> apiMessageBox </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Lib</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:brown'>&quot;User32&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Alias</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;line-height:
  107%;color:brown'>&quot;MessageBoxA&quot;</span><span style='font-size:9.0pt;
  line-height:107%'> (</span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:107%'>
  hWnd </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:slateblue'>Long</span><span style='font-size:
  9.0pt;line-height:107%'>, </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:
  107%'> lpText </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:107%'> </span><span
  style='font-size:9.0pt;line-height:107%;color:slateblue'>String</span><span
  style='font-size:9.0pt;line-height:107%'>, </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>ByVal</span></b><span style='font-size:
  9.0pt;line-height:107%'> lpCaption </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>String</span><span style='font-size:9.0pt;line-height:107%'>,
  </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>ByVal</span></b><span
  style='font-size:9.0pt;line-height:107%'> wType </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:107%'>) </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:107%'> </span><span
  style='font-size:9.0pt;line-height:107%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:112%'><span style='font-size:9.0pt;line-height:
  112%'> </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>Private</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Declare</span></b><span style='font-size:
  9.0pt;line-height:112%'> PtrSafe </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Function</span></b><span style='font-size:9.0pt;
  line-height:112%'> apiOpenIcon </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Lib</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:brown'>&quot;User32&quot;</span><span style='font-size:9.0pt;
  line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>Alias</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:brown'>&quot;OpenIcon&quot;</span><span
  style='font-size:9.0pt;line-height:112%'> (</span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>ByVal</span></b><span style='font-size:
  9.0pt;line-height:112%'> hWnd </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:112%'>) </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:112%'><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>Private</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Declare</span></b><span style='font-size:
  9.0pt;line-height:112%'> PtrSafe </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Function</span></b><span style='font-size:9.0pt;
  line-height:112%'> apiOpenProcess </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Lib</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:brown'>&quot;Kernel32&quot;</span><span style='font-size:9.0pt;
  line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>Alias</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:brown'>&quot;OpenProcess&quot;</span><span
  style='font-size:9.0pt;line-height:112%'> (</span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>ByVal </span></b><span style='font-size:
  9.0pt;line-height:112%'>dwDesiredAccess </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:112%'>, </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>ByVal</span></b><span
  style='font-size:9.0pt;line-height:112%'> bInheritHandle </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:112%'>, </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:112%'>
  dwProcessId </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:slateblue'>Long</span><span
  style='font-size:9.0pt;line-height:112%'>) </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Private</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Declare</span></b><span style='font-size:9.0pt;line-height:107%'>
  PtrSafe </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Function</span></b><span
  style='font-size:9.0pt;line-height:107%'> apiPathAddBackslashByPointer </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Lib</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:brown'>&quot;ShlwApi&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Alias</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:brown'>&quot;PathAddBackslashW&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> (</span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>ByVal</span></b><span style='font-size:
  9.0pt;line-height:107%'> lpszPath </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:107%'>) </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Private</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Declare</span></b><span style='font-size:9.0pt;line-height:107%'>
  PtrSafe </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Function</span></b><span
  style='font-size:9.0pt;line-height:107%'> apiPathAddBackslashByString </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Lib</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:brown'>&quot;ShlwApi&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Alias</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:brown'>&quot;PathAddBackslashW&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> (</span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>ByVal</span></b><span style='font-size:
  9.0pt;line-height:107%'> lpszPath </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>String</span><span style='font-size:9.0pt;line-height:107%'>)
  </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><i><span style='font-size:
  9.0pt;line-height:107%;color:green'>'http://msdn.microsoft.com/en-us/library/aa155716%28office.10%29.aspx</span></i></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:112%'><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>Private</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Declare</span></b><span style='font-size:
  9.0pt;line-height:112%'> PtrSafe </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Function</span></b><span style='font-size:9.0pt;
  line-height:112%'> apiPostMessage </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Lib</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:brown'>&quot;User32&quot;</span><span style='font-size:9.0pt;
  line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>Alias</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:brown'>&quot;PostMessageA&quot;</span><span
  style='font-size:9.0pt;line-height:112%'> (</span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>ByVal</span></b><span style='font-size:
  9.0pt;line-height:112%'> hWnd </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:112%'>, </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>ByVal</span></b><span
  style='font-size:9.0pt;line-height:112%'> wMsg </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:112%'>, </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:112%'>
  wParam </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:112%'>, </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:112%'>
  lParam </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:112%'>) </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.6pt;
  margin-left:0in;text-indent:0in;line-height:112%'><span style='font-size:
  9.0pt;line-height:112%'> </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Private</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>Declare</span></b><span style='font-size:9.0pt;line-height:112%'>
  PtrSafe </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>Function</span></b><span
  style='font-size:9.0pt;line-height:112%'> apiRegQueryValue </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>Lib</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:brown'>&quot;AdvApi32&quot;</span><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Alias</span></b><span style='font-size:
  9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;line-height:
  112%;color:brown'>&quot;RegQueryValue&quot;</span><span style='font-size:
  9.0pt;line-height:112%'> (</span><b><span style='font-size:9.0pt;line-height:
  112%;color:blue'>ByVal </span></b><span style='font-size:9.0pt;line-height:
  112%'>hKey </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:slateblue'>Long</span><span
  style='font-size:9.0pt;line-height:112%'>, </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>ByVal</span></b><span style='font-size:
  9.0pt;line-height:112%'> sValueName </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>String</span><span style='font-size:9.0pt;line-height:112%'>,
  </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>ByVal</span></b><span
  style='font-size:9.0pt;line-height:112%'> dwReserved </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:112%'>, </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>ByRef</span></b><span style='font-size:9.0pt;line-height:112%'>
  lValueType </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:slateblue'>Long</span><span
  style='font-size:9.0pt;line-height:112%'>, </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>ByVal </span></b><span style='font-size:
  9.0pt;line-height:112%'>sValue </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>String</span><span style='font-size:9.0pt;line-height:112%'>,
  </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>ByRef</span></b><span
  style='font-size:9.0pt;line-height:112%'> lResultLen </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:112%'>) </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:11.0pt;line-height:107%'> </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Private </span></b><span
  style='font-size:9.0pt;line-height:107%'> PtrSafe </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Function</span></b><span
  style='font-size:9.0pt;line-height:107%'> apiSendMessage </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Lib</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:brown'>&quot;User32&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Alias</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;line-height:
  107%;color:brown'>&quot;SendMessageA&quot;</span><span style='font-size:9.0pt;
  line-height:107%'> (</span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:107%'>
  hWnd</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:566.75pt;margin-bottom:
0in;margin-left:-28.35pt;text-indent:0in;line-height:107%'>&nbsp;</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=718
 style='width:538.6pt;border-collapse:collapse'>
 <tr style='height:771.0pt'>
  <td width=718 valign=top style='width:538.6pt;background:#FAFAFA;padding:
  2.55pt .25pt 0in 3.75pt;height:771.0pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:107%'>, </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>ByVal</span></b><span
  style='font-size:9.0pt;line-height:107%'> wMsg </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:107%'>, </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:107%'>
  wParam </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:107%'>, lParam </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:107%'>
  Any) </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:112%'><span style='font-size:9.0pt;line-height:
  112%'> </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>Private</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Declare</span></b><span style='font-size:
  9.0pt;line-height:112%'> PtrSafe </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Function</span></b><span style='font-size:9.0pt;
  line-height:112%'> apiSetActiveWindow </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Lib</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:brown'>&quot;User32&quot;</span><span style='font-size:9.0pt;
  line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>Alias</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:brown'>&quot;SetActiveWindow&quot;</span><span
  style='font-size:9.0pt;line-height:112%'> (</span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>ByVal </span></b><span style='font-size:
  9.0pt;line-height:112%'>hWnd </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:112%'>) </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Private</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Declare</span></b><span style='font-size:9.0pt;line-height:107%'>
  PtrSafe </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Function</span></b><span
  style='font-size:9.0pt;line-height:107%'> apiSetCurrentDirectoryA </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Lib</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:brown'>&quot;Kernel32&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Alias</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:brown'>&quot;SetCurrentDirectoryA&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> (</span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>ByVal</span></b><span style='font-size:
  9.0pt;line-height:107%'> lpPathName </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>String</span><span style='font-size:9.0pt;line-height:107%'>)
  </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:112%'><span style='font-size:9.0pt;line-height:
  112%'> </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>Private</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Declare</span></b><span style='font-size:
  9.0pt;line-height:112%'> PtrSafe </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Function</span></b><span style='font-size:9.0pt;
  line-height:112%'> apiSetFocus </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Lib</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:brown'>&quot;User32&quot;</span><span style='font-size:9.0pt;
  line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>Alias</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:brown'>&quot;SetFocus&quot;</span><span
  style='font-size:9.0pt;line-height:112%'> (</span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>ByVal</span></b><span style='font-size:
  9.0pt;line-height:112%'> hWnd </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:112%'>) </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Private</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Declare</span></b><span style='font-size:9.0pt;line-height:107%'>
  PtrSafe </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Function</span></b><span
  style='font-size:9.0pt;line-height:107%'> apiSetForegroundWindow </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Lib</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:brown'>&quot;User32&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Alias</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:brown'>&quot;SetForegroundWindow&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> (</span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>ByVal</span></b><span style='font-size:
  9.0pt;line-height:107%'> hWnd </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:107%'>) </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:112%'><span style='font-size:9.0pt;line-height:
  112%'> </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>Private</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Declare</span></b><span style='font-size:
  9.0pt;line-height:112%'> PtrSafe </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Function</span></b><span style='font-size:9.0pt;
  line-height:112%'> apiSetLocalTime </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Lib</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:brown'>&quot;Kernel32&quot;</span><span style='font-size:9.0pt;
  line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>Alias</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:brown'>&quot;SetLocalTime&quot;</span><span
  style='font-size:9.0pt;line-height:112%'> (lpSystem </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> SystemTime) </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:112%'><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>Private</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Declare</span></b><span style='font-size:
  9.0pt;line-height:112%'> PtrSafe </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Function</span></b><span style='font-size:9.0pt;
  line-height:112%'> apiSetWindowPlacement </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Lib</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:brown'>&quot;User32&quot;</span><span style='font-size:9.0pt;
  line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>Alias</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:brown'>&quot;SetWindowPlacement&quot;
  </span><span style='font-size:9.0pt;line-height:112%'>(</span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>ByVal</span></b><span
  style='font-size:9.0pt;line-height:112%'> hWnd </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:112%'>, </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>ByRef</span></b><span style='font-size:9.0pt;line-height:112%'>
  lpwndpl </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> winPlacement) </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:112%'><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>Private</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Declare</span></b><span style='font-size:
  9.0pt;line-height:112%'> PtrSafe </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Function</span></b><span style='font-size:9.0pt;
  line-height:112%'> apiSetWindowPos </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Lib</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:brown'>&quot;User32&quot;</span><span style='font-size:9.0pt;
  line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>Alias</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:brown'>&quot;SetWindowPos&quot;</span><span
  style='font-size:9.0pt;line-height:112%'> (</span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>ByVal</span></b><span style='font-size:
  9.0pt;line-height:112%'> hWnd </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:112%'>, </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>ByVal</span></b><span
  style='font-size:9.0pt;line-height:112%'> hWndInsertAfter </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:112%'>, </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:112%'> X
  </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:112%'>, </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:112%'> Y
  </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:112%'>, </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:112%'>
  cx </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:112%'>, </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>ByVal </span></b><span style='font-size:9.0pt;line-height:112%'>cy
  </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:112%'>, </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:112%'>
  wFlags </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:112%'>) </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:112%'><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>Private</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Declare</span></b><span style='font-size:
  9.0pt;line-height:112%'> PtrSafe </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Function</span></b><span style='font-size:9.0pt;
  line-height:112%'> apiSetWindowText </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Lib</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:brown'>&quot;User32&quot;</span><span style='font-size:9.0pt;
  line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>Alias</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:brown'>&quot;SetWindowTextA&quot;</span><span
  style='font-size:9.0pt;line-height:112%'> (</span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>ByVal </span></b><span style='font-size:
  9.0pt;line-height:112%'>hWnd </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:112%'>, </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>ByVal</span></b><span
  style='font-size:9.0pt;line-height:112%'> lpString </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>String</span><span style='font-size:9.0pt;
  line-height:112%'>) </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:112%'><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>Private</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Declare</span></b><span style='font-size:
  9.0pt;line-height:112%'> PtrSafe </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Function</span></b><span style='font-size:9.0pt;
  line-height:112%'> apiShellExecute </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Lib</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:brown'>&quot;Shell32&quot;</span><span style='font-size:9.0pt;
  line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>Alias</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:brown'>&quot;ShellExecuteA&quot;</span><span
  style='font-size:9.0pt;line-height:112%'> (</span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>ByVal </span></b><span style='font-size:
  9.0pt;line-height:112%'>hWnd </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:112%'>, </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>ByVal</span></b><span
  style='font-size:9.0pt;line-height:112%'> lpOperation </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>String</span><span style='font-size:9.0pt;
  line-height:112%'>, </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:112%'>
  lpFile </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>String</span><span style='font-size:9.0pt;
  line-height:112%'>, </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:112%'>
  lpParameters </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:slateblue'>String</span><span
  style='font-size:9.0pt;line-height:112%'>, </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>ByVal</span></b><span style='font-size:
  9.0pt;line-height:112%'> lpDirectory </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>String</span><span style='font-size:9.0pt;line-height:112%'>,
  </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>ByVal</span></b><span
  style='font-size:9.0pt;line-height:112%'> nShowCmd </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:112%'>) </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:112%'><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>Private</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Declare</span></b><span style='font-size:
  9.0pt;line-height:112%'> PtrSafe </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Function</span></b><span style='font-size:9.0pt;
  line-height:112%'> apiShowWindow </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Lib</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:brown'>&quot;User32&quot;</span><span style='font-size:9.0pt;
  line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>Alias</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:brown'>&quot;ShowWindow&quot;</span><span
  style='font-size:9.0pt;line-height:112%'> (</span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>ByVal</span></b><span style='font-size:
  9.0pt;line-height:112%'> hWnd </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As </span></b><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:112%'>, </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:112%'>
  nCmdShow </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:112%'>) </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:112%'><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>Private</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Declare</span></b><span style='font-size:
  9.0pt;line-height:112%'> PtrSafe </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Function</span></b><span style='font-size:9.0pt;
  line-height:112%'> apiShowWindowAsync </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Lib</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:brown'>&quot;User32&quot;</span><span style='font-size:9.0pt;
  line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>Alias</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:brown'>&quot;ShowWindowAsync&quot;</span><span
  style='font-size:9.0pt;line-height:112%'> (</span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>ByVal </span></b><span style='font-size:
  9.0pt;line-height:112%'>hWnd </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:112%'>, </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>ByVal</span></b><span
  style='font-size:9.0pt;line-height:112%'> nCmdShow </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:112%'>) </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-align:justify;text-justify:inter-ideograph;text-indent:
  0in;line-height:107%'><span style='font-size:9.0pt;line-height:107%'> </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Private</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Declare</span></b><span style='font-size:
  9.0pt;line-height:107%'> PtrSafe </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Function</span></b><span style='font-size:9.0pt;
  line-height:107%'> apiStrCpy </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Lib</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:brown'>&quot;Kernel32&quot;</span><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Alias</span></b><span style='font-size:9.0pt;line-height:107%'> </span><span
  style='font-size:9.0pt;line-height:107%;color:brown'>&quot;lstrcpynA&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> (</span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>ByVal</span></b><span style='font-size:
  9.0pt;line-height:107%'> pDestination</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>String</span><span style='font-size:9.0pt;line-height:107%'>,
  </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>ByVal</span></b><span
  style='font-size:9.0pt;line-height:107%'> pSource </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>String</span><span style='font-size:9.0pt;
  line-height:107%'>, </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:107%'>
  iMaxLength </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:107%'> </span><span
  style='font-size:9.0pt;line-height:107%;color:slateblue'>Integer</span><span
  style='font-size:9.0pt;line-height:107%'>) </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:112%'><span style='font-size:9.0pt;line-height:
  112%'> </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>Private</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Declare</span></b><span style='font-size:
  9.0pt;line-height:112%'> PtrSafe </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Function</span></b><span style='font-size:9.0pt;
  line-height:112%'> apiStringLen </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Lib</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:brown'>&quot;Kernel32&quot;</span><span style='font-size:9.0pt;
  line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>Alias</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:brown'>&quot;lstrlenW&quot;</span><span
  style='font-size:9.0pt;line-height:112%'> (</span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>ByVal</span></b><span style='font-size:
  9.0pt;line-height:112%'> lpString </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:112%'>) </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Private</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Declare</span></b><span style='font-size:9.0pt;line-height:107%'>
  PtrSafe </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Function</span></b><span
  style='font-size:9.0pt;line-height:107%'> apiStrTrimW </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Lib</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:brown'>&quot;ShlwApi&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Alias</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;line-height:
  107%;color:brown'>&quot;StrTrimW&quot;</span><span style='font-size:9.0pt;
  line-height:107%'> () </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><span style='font-size:9.0pt;line-height:107%;color:slateblue'>Boolean</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Private</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Declare</span></b><span style='font-size:9.0pt;line-height:107%'>
  PtrSafe </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Function</span></b><span
  style='font-size:9.0pt;line-height:107%'> apiTerminateProcess </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Lib</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:brown'>&quot;Kernel32&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Alias</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;line-height:
  107%;color:brown'>&quot;TerminateProcess&quot;</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>(</span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:
  107%'> hWnd </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:107%'> </span><span
  style='font-size:9.0pt;line-height:107%;color:slateblue'>Long</span><span
  style='font-size:9.0pt;line-height:107%'>, </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>ByVal</span></b><span style='font-size:
  9.0pt;line-height:107%'> uExitCode </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:107%'>) </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Private</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Declare</span></b><span style='font-size:9.0pt;line-height:107%'>
  PtrSafe </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Function</span></b><span
  style='font-size:9.0pt;line-height:107%'> apiTimeGetTime </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Lib</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:brown'>&quot;Winmm&quot;</span><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Alias</span></b><span style='font-size:9.0pt;line-height:
  107%'> </span><span style='font-size:9.0pt;line-height:107%;color:brown'>&quot;timeGetTime&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> () </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:112%'><span style='font-size:9.0pt;line-height:
  112%'> </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>Private</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Declare</span></b><span style='font-size:
  9.0pt;line-height:112%'> PtrSafe </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Function</span></b><span style='font-size:9.0pt;
  line-height:112%'> apiVarPtrArray </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Lib</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:brown'>&quot;MsVbVm50&quot;</span><span style='font-size:9.0pt;
  line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>Alias</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:brown'>&quot;VarPtr&quot;</span><span
  style='font-size:9.0pt;line-height:112%'> (Var() </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> Any) </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As </span></b><span
  style='font-size:9.0pt;line-height:112%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:219.15pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:112%'><span style='font-size:
  9.0pt;line-height:112%'> </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Private</span></b><span style='font-size:9.0pt;
  line-height:112%'> Type browseInfo </span><i><span style='font-size:9.0pt;
  line-height:112%;color:green'>'used by apiBrowseForFolder </span></i><span
  style='font-size:9.0pt;line-height:112%'>hOwner </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long </span><span style='font-size:9.0pt;
  line-height:112%'>pidlRoot </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Long </span><span style='font-size:9.0pt;line-height:112%'>pszDisplayName
  </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>String </span><span style='font-size:9.0pt;
  line-height:112%'>lpszTitle </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>String </span><span style='font-size:9.0pt;line-height:112%'>ulFlags
  </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long </span><span style='font-size:9.0pt;
  line-height:112%'>lpfn </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Long </span><span style='font-size:9.0pt;line-height:112%'>lParam
  </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long </span><span style='font-size:9.0pt;
  line-height:112%'>iImage </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Long </span><span style='font-size:9.0pt;line-height:112%'></span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>End</span></b><span
  style='font-size:9.0pt;line-height:112%'> Type</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:112%'><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>Private</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Declare</span></b><span style='font-size:
  9.0pt;line-height:112%'> PtrSafe </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Function</span></b><span style='font-size:9.0pt;
  line-height:112%'> apiBrowseForFolder </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Lib</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:brown'>&quot;Shell32&quot;</span><span style='font-size:9.0pt;
  line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>Alias</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:brown'>&quot;SHBrowseForFolderA&quot;
  </span><span style='font-size:9.0pt;line-height:112%'>(lpBrowseInfo </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> browseInfo) </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:7.85pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:112%'><span style='font-size:
  9.0pt;line-height:112%'> </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Private</span></b><span style='font-size:9.0pt;
  line-height:112%'> Type CHOOSECOLOR </span><i><span style='font-size:9.0pt;
  line-height:112%;color:green'>'used by apiChooseColor;
  http://support.microsoft.com/kb/153929 and
  http://www.cpearson.com/Excel/Colors.aspx </span></i><span style='font-size:
  9.0pt;line-height:112%'>lStructSize </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Long </span><span style='font-size:9.0pt;line-height:112%'>hWndOwner
  </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long </span><span style='font-size:9.0pt;
  line-height:112%'>hInstance </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Long </span><span style='font-size:9.0pt;line-height:112%'>rgbResult
  </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long </span><span style='font-size:9.0pt;
  line-height:112%'>lpCustColors </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>String </span><span style='font-size:9.0pt;line-height:112%'>flags
  </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long </span><span style='font-size:9.0pt;
  line-height:112%'>lCustData </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Long </span><span style='font-size:9.0pt;line-height:112%'>lpfnHook
  </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:4.8in;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:112%'><span style='font-size:
  9.0pt;line-height:112%'> lpTemplateName </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>String </span><span style='font-size:9.0pt;
  line-height:112%'></span><b><span style='font-size:9.0pt;line-height:
  112%;color:blue'>End</span></b><span style='font-size:9.0pt;line-height:112%'>
  Type</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Private</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Declare</span></b><span style='font-size:9.0pt;line-height:107%'>
  PtrSafe </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Function</span></b><span
  style='font-size:9.0pt;line-height:107%'> apiChooseColor </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Lib</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:brown'>&quot;ComDlg32&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Alias</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;line-height:
  107%;color:brown'>&quot;ChooseColorA&quot;</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>(pChoosecolor </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> CHOOSECOLOR) </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Private</span></b><span
  style='font-size:9.0pt;line-height:107%'> Type FindWindowParameters </span><i><span
  style='font-size:9.0pt;line-height:107%;color:green'>'Custom structure for
  passing in the parameters in/out of</span></i></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:566.75pt;margin-bottom:
0in;margin-left:-28.35pt;text-indent:0in;line-height:107%'>&nbsp;</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=718
 style='width:538.6pt;border-collapse:collapse'>
 <tr style='height:771.0pt'>
  <td width=718 valign=top style='width:538.6pt;background:#FAFAFA;padding:
  2.55pt 1.25pt 0in 3.75pt;height:771.0pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:89.8pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:112%'><i><span
  style='font-size:9.0pt;line-height:112%;color:green'>the hook enumeration
  function; could use global variables instead, but this is nicer </span></i><span
  style='font-size:9.0pt;line-height:112%'>strTitle </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>String</span><span style='font-size:9.0pt;
  line-height:112%'> </span><i><span style='font-size:9.0pt;line-height:112%;
  color:green'>'INPUT </span></i><span style='font-size:9.0pt;line-height:112%'>hWnd
  </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:112%'> </span><i><span style='font-size:9.0pt;line-height:
  112%;color:green'>'OUTPUT</span></i></p>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:112%'><span style='font-size:9.0pt;line-height:
  112%'> </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>End</span></b><span
  style='font-size:9.0pt;line-height:112%'> Type </span><i><span
  style='font-size:9.0pt;line-height:112%;color:green'>'Find a specific window
  with dynamic caption from a list of all open windows:</span></i></p>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:112%'><i><span style='font-size:9.0pt;line-height:
  112%;color:green'>http://www.everythingaccess.com/tutorials.asp?ID=Bring-an-external-application-window-to-the-foregrou
  nd</span></i></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:112%'><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>Private</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Declare</span></b><span style='font-size:
  9.0pt;line-height:112%'> PtrSafe </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Function</span></b><span style='font-size:9.0pt;
  line-height:112%'> apiEnumWindows </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Lib</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:brown'>&quot;User32&quot;</span><span style='font-size:9.0pt;
  line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>Alias</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:brown'>&quot;EnumWindows&quot;</span><span
  style='font-size:9.0pt;line-height:112%'> (</span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>ByVal </span></b><span style='font-size:
  9.0pt;line-height:112%'>lpEnumFunc </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> LongPtr, </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;
  line-height:112%'> lParam </span><b><span style='font-size:9.0pt;line-height:
  112%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:112%'>
  LongPtr) </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:117.75pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:112%'><span style='font-size:
  9.0pt;line-height:112%'> </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Private</span></b><span style='font-size:9.0pt;
  line-height:112%'> Type lastInputInfo </span><i><span style='font-size:9.0pt;
  line-height:112%;color:green'>'used by apiGetLastInputInfo, getLastInputTime </span></i><span
  style='font-size:9.0pt;line-height:112%'>cbSize </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long </span><span style='font-size:9.0pt;
  line-height:112%'>dwTime </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Long </span><span style='font-size:9.0pt;line-height:112%'></span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>End</span></b><span
  style='font-size:9.0pt;line-height:112%'> Type</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:112%'><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>Private</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Declare</span></b><span style='font-size:
  9.0pt;line-height:112%'> PtrSafe </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Function</span></b><span style='font-size:9.0pt;
  line-height:112%'> apiGetLastInputInfo </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Lib</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:brown'>&quot;User32&quot;</span><span style='font-size:9.0pt;
  line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>Alias</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:brown'>&quot;GetLastInputInfo&quot;
  </span><span style='font-size:9.0pt;line-height:112%'>(</span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>ByRef</span></b><span
  style='font-size:9.0pt;line-height:112%'> plii </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> lastInputInfo) </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:4.8pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:112%'><span style='font-size:
  9.0pt;line-height:112%'> </span><i><span style='font-size:9.0pt;
  line-height:112%;color:green'>'http://www.pgacon.com/visualbasic.htm#Take%20Advantage%20of%20Conditional%20Compilation
  </span></i><span style='font-size:9.0pt;line-height:112%'></span><i><span
  style='font-size:9.0pt;line-height:112%;color:green'>'Logical and Bitwise
  Operators in Visual Basic:</span></i></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:184.9pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:112%'><i><span
  style='font-size:9.0pt;line-height:112%;color:green'>http://msdn.microsoft.com/en-us/library/wz3k228a(v=vs.80).aspx
  and http://stackoverflow.com/questions/1070863/hidden-features-of-vba </span></i><span
  style='font-size:9.0pt;line-height:112%'></span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>Private</span></b><span
  style='font-size:9.0pt;line-height:112%'> Type SystemTime
  wYear </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:slateblue'>Integer </span><span
  style='font-size:9.0pt;line-height:112%'>wMonth </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Integer </span><span style='font-size:9.0pt;
  line-height:112%'>wDayOfWeek </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Integer </span><span style='font-size:9.0pt;line-height:
  112%'>wDay </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Integer </span><span style='font-size:9.0pt;line-height:
  112%'>wHour </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Integer </span><span style='font-size:9.0pt;line-height:
  112%'>wMinute </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Integer </span><span style='font-size:9.0pt;line-height:
  112%'>wSecond </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Integer </span><span style='font-size:9.0pt;line-height:
  112%'>wMilliseconds </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Integer </span><span style='font-size:9.0pt;line-height:
  112%'></span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>End</span></b><span
  style='font-size:9.0pt;line-height:112%'> Type</span></p>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:112%'><span style='font-size:9.0pt;line-height:
  112%'> </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>Private</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Declare</span></b><span style='font-size:
  9.0pt;line-height:112%'> PtrSafe </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Sub</span></b><span style='font-size:9.0pt;
  line-height:112%'> apiGetLocalTime </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Lib</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:brown'>&quot;Kernel32&quot;</span><span style='font-size:9.0pt;
  line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>Alias</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:brown'>&quot;GetLocalTime&quot;</span><span
  style='font-size:9.0pt;line-height:112%'> (lpSystem </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As </span></b><span
  style='font-size:9.0pt;line-height:112%'>SystemTime)</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Private</span></b><span style='font-size:9.0pt;
  line-height:107%'> Type pointAPI </span><i><span style='font-size:9.0pt;
  line-height:107%;color:green'>'used by apiSetWindowPlacement</span></i></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:.15in;text-indent:-.15in;line-height:107%'><span
  style='font-size:9.0pt;line-height:107%'>X<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
  </span></span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:.15in;text-indent:-.15in;line-height:107%'><span
  style='font-size:9.0pt;line-height:107%'>Y<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
  </span></span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>End</span></b><span style='font-size:9.0pt;
  line-height:107%'> Type</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Private</span></b><span style='font-size:9.0pt;
  line-height:107%'> Type rectAPI </span><i><span style='font-size:9.0pt;
  line-height:107%;color:green'>'used by apiSetWindowPlacement</span></i></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> Left_Renamed </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> Top_Renamed </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> Right_Renamed </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> Bottom_Renamed </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>End</span></b><span style='font-size:9.0pt;
  line-height:107%'> Type</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:202.3pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:112%'><span style='font-size:
  9.0pt;line-height:112%'> </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Private</span></b><span style='font-size:9.0pt;
  line-height:112%'> Type winPlacement </span><i><span style='font-size:9.0pt;
  line-height:112%;color:green'>'used by apiSetWindowPlacement </span></i><span
  style='font-size:9.0pt;line-height:112%'>length </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long </span><span style='font-size:9.0pt;
  line-height:112%'>flags </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Long </span><span style='font-size:9.0pt;line-height:112%'>showCmd
  </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long </span><span style='font-size:9.0pt;
  line-height:112%'>ptMinPosition </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> pointAPI ptMaxPosition </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> pointAPI rcNormalPosition </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> rectAPI </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>End</span></b><span
  style='font-size:9.0pt;line-height:112%'> Type</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Private</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Declare</span></b><span style='font-size:9.0pt;line-height:107%'>
  PtrSafe </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Function</span></b><span
  style='font-size:9.0pt;line-height:107%'> apiGetWindowPlacement </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Lib</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:brown'>&quot;User32&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Alias</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;line-height:
  107%;color:brown'>&quot;GetWindowPlacement&quot;</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>(</span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:
  107%'> hWnd </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:107%'> </span><span
  style='font-size:9.0pt;line-height:107%;color:slateblue'>Long</span><span
  style='font-size:9.0pt;line-height:107%'>, </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>ByRef</span></b><span style='font-size:
  9.0pt;line-height:107%'> lpwndpl </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> winPlacement) </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Private</span></b><span style='font-size:9.0pt;
  line-height:107%'> Type winRect </span><i><span style='font-size:9.0pt;
  line-height:107%;color:green'>'used by apiMoveWindow</span></i></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> Left </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> Top </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> Right </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> Bottom </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>End</span></b><span style='font-size:9.0pt;
  line-height:107%'> Type</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:9.75pt;margin-bottom:
  12.9pt;margin-left:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:112%'><span style='font-size:9.0pt;line-height:
  112%'> </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>Private</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Declare</span></b><span style='font-size:
  9.0pt;line-height:112%'> PtrSafe </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Function</span></b><span style='font-size:9.0pt;
  line-height:112%'> apiMoveWindow </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Lib</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:brown'>&quot;User32&quot;</span><span style='font-size:9.0pt;
  line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>Alias</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:brown'>&quot;MoveWindow&quot;</span><span
  style='font-size:9.0pt;line-height:112%'> (</span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>ByVal</span></b><span style='font-size:
  9.0pt;line-height:112%'> hWnd </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As </span></b><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:112%'>, xLeft </span><b><span style='font-size:9.0pt;line-height:
  112%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:112%'>
  </span><span style='font-size:9.0pt;line-height:112%;color:slateblue'>Long</span><span
  style='font-size:9.0pt;line-height:112%'>, </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>ByVal</span></b><span style='font-size:
  9.0pt;line-height:112%'> yTop </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:112%'>,
  wWidth </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:112%'>, </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:112%'>
  hHeight </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:112%'>, </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:112%'>
  repaint </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>As
  </span></b><span style='font-size:9.0pt;line-height:112%;color:slateblue'>Long</span><span
  style='font-size:9.0pt;line-height:112%'>) </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:11.0pt;line-height:107%'> </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Private </span></b><span
  style='font-size:9.0pt;line-height:107%'> PtrSafe </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Function</span></b><span
  style='font-size:9.0pt;line-height:107%'> apiInternetOpen </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Lib</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:brown'>&quot;WiniNet&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Alias</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;line-height:
  107%;color:brown'>&quot;InternetOpenA&quot;</span><span style='font-size:
  9.0pt;line-height:107%'> (</span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>ByVal</span></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'>sAgent </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>String</span><span style='font-size:9.0pt;
line-height:110%'>, </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:110%'>
lAccessType </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>Long</span><span style='font-size:9.0pt;
line-height:110%'>, </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:110%'>
sProxyName </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>String</span><span style='font-size:9.0pt;
line-height:110%'>, </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:110%'>
sProxyBypass </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>As</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.05pt;margin-bottom:.25pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%;color:slateblue'>String</span><span
style='font-size:9.0pt;line-height:110%'>, </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;
line-height:110%'> lFlags </span><b><span style='font-size:9.0pt;line-height:
110%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:slateblue'>Long</span><span
style='font-size:9.0pt;line-height:110%'>) </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>As</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:110%'> </span><i><span
style='font-size:9.0pt;line-height:110%;color:green'>'Open the Internet
object 'ex: lngINet =</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.05pt;margin-bottom:.25pt;
margin-left:3.5pt'><i><span style='font-size:9.0pt;line-height:110%;color:green'>InternetOpen(</span></i><span
style='font-size:9.0pt;line-height:110%;font-family:"Arial",sans-serif;
color:green'></span><i><span style='font-size:9.0pt;line-height:110%;
color:green'>MyFTP Control</span></i><span style='font-size:9.0pt;line-height:
110%;font-family:"Arial",sans-serif;color:green'></span><i><span
style='font-size:9.0pt;line-height:110%;color:green'>, 1, vbNullString,
vbNullString, 0)</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Private</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Declare</span></b><span style='font-size:
9.0pt;line-height:110%'> PtrSafe </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Function</span></b><span style='font-size:9.0pt;
line-height:110%'> apiInternetConnect </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Lib</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:brown'>&quot;WiniNet&quot;</span><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Alias</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:brown'>&quot;InternetConnectA&quot; </span><span
style='font-size:9.0pt;line-height:110%'>(</span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;
line-height:110%'> hInternetSession </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>As</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:110%'>, </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>ByVal</span></b><span
style='font-size:9.0pt;line-height:110%'> sServerName </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>String</span><span style='font-size:9.0pt;
line-height:110%'>, </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:110%'>
nServerPort </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>Integer</span><span style='font-size:9.0pt;
line-height:110%'>, </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>ByVal </span></b><span style='font-size:9.0pt;line-height:110%'>sUsername
</span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>String</span><span style='font-size:9.0pt;
line-height:110%'>, </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:110%'>
sPassword </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>String</span><span style='font-size:9.0pt;
line-height:110%'>, </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:110%'>
lService </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>Long</span><span style='font-size:9.0pt;
line-height:110%'>, </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:110%'>
lFlags </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>Long</span><span style='font-size:9.0pt;
line-height:110%'>, </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>ByVal </span></b><span style='font-size:9.0pt;line-height:110%'>lContext
</span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>Long</span><span style='font-size:9.0pt;
line-height:110%'>) </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>As</span></b><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:slateblue'>Long</span><span
style='font-size:9.0pt;line-height:110%'> </span><i><span style='font-size:
9.0pt;line-height:110%;color:green'>'Connect to the network 'ex: lngINetConn =
InternetConnect(lngINet,</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.05pt;margin-bottom:.25pt;
margin-left:3.5pt'><i><span style='font-size:9.0pt;line-height:110%;color:green'>&quot;ftp.microsoft.com&quot;,
0, &quot;anonymous&quot;, &quot;wally@wallyworld.com&quot;, 1, 0, 0)</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Private</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Declare</span></b><span style='font-size:
9.0pt;line-height:110%'> PtrSafe </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Function</span></b><span style='font-size:9.0pt;
line-height:110%'> apiFtpGetFile </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Lib</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:brown'>&quot;WiniNet&quot;</span><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Alias</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:brown'>&quot;FtpGetFileA&quot;</span><span
style='font-size:9.0pt;line-height:110%'> (</span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>ByVal </span></b><span style='font-size:
9.0pt;line-height:110%'>hFtpSession </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>As</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:110%'>, </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>ByVal</span></b><span
style='font-size:9.0pt;line-height:110%'> lpszRemoteFile </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>String</span><span style='font-size:9.0pt;
line-height:110%'>, </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:110%'>
lpszNewFile </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>String</span><span style='font-size:9.0pt;
line-height:110%'>, </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>ByVal </span></b><span style='font-size:9.0pt;line-height:110%'>fFailIfExists
</span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>Boolean</span><span style='font-size:9.0pt;
line-height:110%'>, </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:110%'>
dwFlagsAndAttributes </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>As</span></b><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:slateblue'>Long</span><span
style='font-size:9.0pt;line-height:110%'>, </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;
line-height:110%'> dwFlags </span><b><span style='font-size:9.0pt;line-height:
110%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:slateblue'>Long</span><span
style='font-size:9.0pt;line-height:110%'>, </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>ByVal </span></b><span style='font-size:
9.0pt;line-height:110%'>dwContext </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>As</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:110%'>) </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>Boolean</span><span style='font-size:9.0pt;
line-height:110%'> </span><i><span style='font-size:9.0pt;line-height:110%;
color:green'>'Get a file 'ex: blnRC = FtpGetFile(lngINetConn,
&quot;dirmap.txt&quot;, &quot;c:\dirmap.txt&quot;, 0, 0, 1, 0)</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Private</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Declare</span></b><span style='font-size:
9.0pt;line-height:110%'> PtrSafe </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Function</span></b><span style='font-size:9.0pt;
line-height:110%'> apiFtpPutFile </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Lib</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:brown'>&quot;WiniNet&quot;</span><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Alias</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:brown'>&quot;FtpPutFileA&quot;</span><span
style='font-size:9.0pt;line-height:110%'> (</span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>ByVal </span></b><span style='font-size:
9.0pt;line-height:110%'>hFtpSession </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>As</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:110%'>, </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>ByVal</span></b><span
style='font-size:9.0pt;line-height:110%'> lpszLocalFile </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>String</span><span style='font-size:9.0pt;
line-height:110%'>, </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:110%'>
lpszRemoteFile </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>As</span></b><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:slateblue'>String</span><span
style='font-size:9.0pt;line-height:110%'>, </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;
line-height:110%'> dwFlags</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.05pt;margin-bottom:1.4pt;
margin-left:3.5pt'><b><span style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>Long</span><span style='font-size:9.0pt;
line-height:110%'>, </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:110%'>
dwContext </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>Long</span><span style='font-size:9.0pt;
line-height:110%'>) </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>As</span></b><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:slateblue'>Boolean</span><span
style='font-size:9.0pt;line-height:110%'> </span><i><span style='font-size:
9.0pt;line-height:110%;color:green'>'Send a file 'ex: blnRC =
FtpPutFile(lngINetConn,</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.05pt;margin-bottom:.25pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%;font-family:
"Arial",sans-serif;color:green'></span><i><span style='font-size:9.0pt;
line-height:110%;color:green'>c:\dirmap.txt</span></i><span style='font-size:
9.0pt;line-height:110%;font-family:"Arial",sans-serif;color:green'></span><i><span
style='font-size:9.0pt;line-height:110%;color:green'>, </span></i><span
style='font-size:9.0pt;line-height:110%;font-family:"Arial",sans-serif;
color:green'></span><i><span style='font-size:9.0pt;line-height:110%;
color:green'>dirmap.txt</span></i><span style='font-size:9.0pt;line-height:
110%;font-family:"Arial",sans-serif;color:green'></span><i><span
style='font-size:9.0pt;line-height:110%;color:green'>, 1, 0)</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:1.3pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Private</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Declare</span></b><span style='font-size:
9.0pt;line-height:110%'> PtrSafe </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Function</span></b><span style='font-size:9.0pt;
line-height:110%'> apiFtpDeleteFile </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Lib</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:brown'>&quot;WiniNet&quot;</span><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Alias</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:brown'>&quot;FtpDeleteFileA&quot;</span><span
style='font-size:9.0pt;line-height:110%'> (</span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>ByVal </span></b><span style='font-size:
9.0pt;line-height:110%'>hFtpSession </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>As</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:110%'>, </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>ByVal</span></b><span
style='font-size:9.0pt;line-height:110%'> lpszFileName </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>String</span><span style='font-size:9.0pt;
line-height:110%'>) </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>As</span></b><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:slateblue'>Boolean</span><span
style='font-size:9.0pt;line-height:110%'> </span><i><span style='font-size:
9.0pt;line-height:110%;color:green'>'Delete a file 'ex: blnRC =</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.05pt;margin-bottom:.25pt;
margin-left:3.5pt'><i><span style='font-size:9.0pt;line-height:110%;color:green'>FtpDeleteFile(lngINetConn,
</span></i><span style='font-size:9.0pt;line-height:110%;font-family:"Arial",sans-serif;
color:green'></span><i><span style='font-size:9.0pt;line-height:110%;
color:green'>test.txt</span></i><span style='font-size:9.0pt;line-height:110%;
font-family:"Arial",sans-serif;color:green'></span><i><span style='font-size:
9.0pt;line-height:110%;color:green'>)</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:3.75pt;text-align:justify;text-justify:inter-ideograph;text-indent:
0in;line-height:112%'><span style='font-size:9.0pt;line-height:112%'> </span><b><span
style='font-size:9.0pt;line-height:112%;color:blue'>Private</span></b><span
style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
9.0pt;line-height:112%;color:blue'>Declare</span></b><span style='font-size:
9.0pt;line-height:112%'> PtrSafe </span><b><span style='font-size:9.0pt;
line-height:112%;color:blue'>Function</span></b><span style='font-size:9.0pt;
line-height:112%'> apiInternetCloseHandle </span><b><span style='font-size:
9.0pt;line-height:112%;color:blue'>Lib</span></b><span style='font-size:9.0pt;
line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
color:brown'>&quot;WiniNet&quot;</span><span style='font-size:9.0pt;line-height:
112%'> (</span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>ByVal</span></b><span
style='font-size:9.0pt;line-height:112%'> hInet </span><b><span
style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
line-height:112%;color:slateblue'>Long</span><span style='font-size:9.0pt;
line-height:112%'>) </span><b><span style='font-size:9.0pt;line-height:112%;
color:blue'>As </span></b><span style='font-size:9.0pt;line-height:112%;
color:slateblue'>Integer</span><span style='font-size:9.0pt;line-height:112%'>
</span><i><span style='font-size:9.0pt;line-height:112%;color:green'>'Close the
Internet object 'ex: InternetCloseHandle lngINetConn 'ex:
InternetCloseHandle lngINet</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Private</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Declare</span></b><span style='font-size:
9.0pt;line-height:110%'> PtrSafe </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Function</span></b><span style='font-size:9.0pt;
line-height:110%'> apiFtpFindFirstFile </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Lib</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:brown'>&quot;WiniNet&quot;</span><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Alias</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:brown'>&quot;FtpFindFirstFileA&quot;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'>(</span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>ByVal</span></b><span
style='font-size:9.0pt;line-height:110%'> hFtpSession </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>Long</span><span style='font-size:9.0pt;
line-height:110%'>, </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:110%'>
lpszSearchFile </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>As</span></b><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:slateblue'>String</span><span
style='font-size:9.0pt;line-height:110%'>, lpFindFileData </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> WIN32_FIND_DATA,</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:237.65pt;margin-bottom:
.2pt;margin-left:3.5pt'><span style='position:relative;z-index:-1895746560'><span
style='left:0px;position:absolute;left:0px;top:-139545px;width:718px;
height:1px'><img width=718 height=1
src="VBA%20Notes%20for%20Professionals_files/image493.gif"></span></span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>ByVal</span></b><span
style='font-size:9.0pt;line-height:110%'> dwFlags </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>Long</span><span style='font-size:9.0pt;
line-height:110%'>, </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:110%'>
dwContent </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>Long</span><span style='font-size:9.0pt;
line-height:110%'>) </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>As</span></b><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:slateblue'>Long </span><span
style='font-size:9.0pt;line-height:110%'></span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Private</span></b><span style='font-size:
9.0pt;line-height:110%'> Type FILETIME dwLowDateTime </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>Long </span><span style='font-size:9.0pt;
line-height:110%'>dwHighDateTime </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>As</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:slateblue'>Long </span><span style='font-size:9.0pt;line-height:110%'></span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>End</span></b><span
style='font-size:9.0pt;line-height:110%'> Type </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Private</span></b><span
style='font-size:9.0pt;line-height:110%'> Type WIN32_FIND_DATA
dwFileAttributes </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>As</span></b><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:slateblue'>Long </span><span
style='font-size:9.0pt;line-height:110%'>ftCreationTime </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> FILETIME ftLastAccessTime </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> FILETIME ftLastWriteTime </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> FILETIME nFileSizeHigh </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>Long </span><span style='font-size:9.0pt;
line-height:110%'>nFileSizeLow </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>As</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:slateblue'>Long </span><span style='font-size:9.0pt;line-height:110%'>dwReserved0
</span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>Long </span><span style='font-size:9.0pt;
line-height:110%'>dwReserved1 </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>As</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:slateblue'>Long </span><span style='font-size:9.0pt;line-height:110%'>cFileName
</span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>String</span><span style='font-size:9.0pt;
line-height:110%'> * </span><span style='font-size:9.0pt;line-height:110%;
color:brown'>1</span><span style='font-size:9.0pt;line-height:110%'> </span><i><span
style='font-size:9.0pt;line-height:110%;color:green'>'MAX_FTP_PATH </span></i><span
style='font-size:9.0pt;line-height:110%'>cAlternate </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>String</span><span style='font-size:9.0pt;
line-height:110%'> * </span><span style='font-size:9.0pt;line-height:110%;
color:brown'>14</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.05pt;margin-bottom:.25pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>End</span></b><span
style='font-size:9.0pt;line-height:110%'> Type </span><i><span
style='font-size:9.0pt;line-height:110%;color:green'>'ex: lngHINet =
FtpFindFirstFile(lngINetConn, &quot;*.*&quot;, pData, 0, 0)</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Private</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Declare</span></b><span style='font-size:
9.0pt;line-height:110%'> PtrSafe </span><b><span style='font-size:9.0pt;
line-height:110%;color:blue'>Function</span></b><span style='font-size:9.0pt;
line-height:110%'> apiInternetFindNextFile </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Lib</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:brown'>&quot;WiniNet&quot;</span><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Alias</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.05pt;margin-bottom:.25pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%;color:brown'>&quot;InternetFindNextFileA&quot;</span><span
style='font-size:9.0pt;line-height:110%'> (</span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;
line-height:110%'> hFind </span><b><span style='font-size:9.0pt;line-height:
110%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:slateblue'>Long</span><span
style='font-size:9.0pt;line-height:110%'>, lpvFindData </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> WIN32_FIND_DATA) </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>Long</span><span style='font-size:9.0pt;
line-height:110%'> </span><i><span style='font-size:9.0pt;line-height:110%;
color:green'>'ex: blnRC = InternetFindNextFile(lngHINet, pData)</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.05pt;margin-bottom:17.25pt;
margin-left:3.5pt'><b><span style='font-size:9.0pt;line-height:110%;color:slateblue'>#ElseIf</span></b><span
style='font-size:9.0pt;line-height:110%'> Win32 </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Then</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><i><span style='font-size:
9.0pt;line-height:110%;color:green'>'Win32 = True, Win16 = False</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.65pt;margin-bottom:18.55pt;
margin-left:.75pt'>(continued in second example)</p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:4.2pt;margin-left:
-.25pt'><a name="_Toc308854">Section 46.6: Windows API - Dedicated Module (2 of
2)</a></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.05pt;margin-bottom:.25pt;
margin-left:3.5pt'><b><span style='font-size:9.0pt;line-height:110%;color:slateblue'>#ElseIf</span></b><span
style='font-size:9.0pt;line-height:110%'> Win32 </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Then</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><i><span style='font-size:
9.0pt;line-height:110%;color:green'>'Win32 = True, Win16 = False</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Private</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Declare</span></b><span style='font-size:
9.0pt;line-height:110%'> </span><b><span style='font-size:9.0pt;line-height:
110%;color:blue'>Sub</span></b><span style='font-size:9.0pt;line-height:110%'>
apiCopyMemory </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>Lib</span></b><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>&quot;Kernel32&quot;</span><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Alias</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:brown'>&quot;RtlMoveMemory&quot;</span><span style='font-size:9.0pt;
line-height:110%'> (MyDest </span><b><span style='font-size:9.0pt;line-height:
110%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:110%'>
Any, MySource</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><b><span style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> Any, </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>ByVal</span></b><span
style='font-size:9.0pt;line-height:110%'> MySize </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>Long</span><span style='font-size:9.0pt;
line-height:110%'>)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:.2pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'> </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Private</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Declare</span></b><span style='font-size:
9.0pt;line-height:110%'> </span><b><span style='font-size:9.0pt;line-height:
110%;color:blue'>Sub</span></b><span style='font-size:9.0pt;line-height:110%'>
apiExitProcess </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>Lib</span></b><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:brown'>&quot;Kernel32&quot;</span><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Alias</span></b><span style='font-size:9.0pt;
line-height:110%'> </span><span style='font-size:9.0pt;line-height:110%;
color:brown'>&quot;ExitProcess&quot;</span><span style='font-size:9.0pt;
line-height:110%'> (</span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:110%'>
uExitCode </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>As</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:slateblue'>Long</span><span style='font-size:9.0pt;
line-height:110%'>)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.05pt;margin-bottom:.25pt;
margin-left:3.5pt'><span style='font-size:9.0pt;line-height:110%'> </span><i><span
style='font-size:9.0pt;line-height:110%;color:green'>'Private Declare Sub
apiGetStartupInfo Lib &quot;Kernel32&quot; Alias &quot;GetStartupInfoA&quot;
(lpStartupInfo As STARTUPINFO)</span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.05pt;margin-bottom:.25pt;
margin-left:3.5pt'><span style='position:relative;z-index:-1895745536'><span
style='left:0px;position:absolute;left:0px;top:-139929px;width:718px;
height:1px'><img width=718 height=1
src="VBA%20Notes%20for%20Professionals_files/image494.gif"></span></span><span
style='font-size:9.0pt;line-height:110%'> </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>Private</span></b><span style='font-size:
9.0pt;line-height:110%'> </span><b><span style='font-size:9.0pt;line-height:
110%;color:blue'>Declare</span></b><span style='font-size:9.0pt;line-height:
110%'> </span><b><span style='font-size:9.0pt;line-height:110%;color:blue'>Sub</span></b><span
style='font-size:9.0pt;line-height:110%'> apiSetCursorPos </span><b><span
style='font-size:9.0pt;line-height:110%;color:blue'>Lib</span></b><span
style='font-size:9.0pt;line-height:110%'> </span><span style='font-size:9.0pt;
line-height:110%;color:brown'>&quot;User32&quot;</span><span style='font-size:
9.0pt;line-height:110%'> </span><b><span style='font-size:9.0pt;line-height:
110%;color:blue'>Alias</span></b><span style='font-size:9.0pt;line-height:110%'>
</span><span style='font-size:9.0pt;line-height:110%;color:brown'>&quot;SetCursorPos&quot;</span><span
style='font-size:9.0pt;line-height:110%'> (</span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;
line-height:110%'> X </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>As</span></b><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:slateblue'>Integer</span><span
style='font-size:9.0pt;line-height:110%'>, </span><b><span style='font-size:
9.0pt;line-height:110%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;
line-height:110%'> Y </span><b><span style='font-size:9.0pt;line-height:110%;
color:blue'>As</span></b><span style='font-size:9.0pt;line-height:110%'> </span><span
style='font-size:9.0pt;line-height:110%;color:slateblue'>Integer</span><span
style='font-size:9.0pt;line-height:110%'>) </span><i><span style='font-size:
9.0pt;line-height:110%;color:green'>'Logical and Bitwise Operators in Visual
Basic: http://msdn.microsoft.com/en-us/library/wz3k228a(v=vs.80).aspx and
http://stackoverflow.com/questions/1070863/hidden-features-of-vba </span></i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:566.75pt;margin-bottom:
0in;margin-left:-28.35pt;text-indent:0in;line-height:107%'>&nbsp;</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=718
 style='width:538.6pt;border-collapse:collapse'>
 <tr style='height:771.0pt'>
  <td width=718 valign=top style='width:538.6pt;background:#FAFAFA;padding:
  2.55pt .25pt 0in 3.75pt;height:771.0pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><i><span style='font-size:
  9.0pt;line-height:107%;color:green'>'http://www.pgacon.com/visualbasic.htm#Take%20Advantage%20of%20Conditional%20Compilation</span></i></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:112%'><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>Private</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Declare</span></b><span style='font-size:
  9.0pt;line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:
  112%;color:blue'>Sub</span></b><span style='font-size:9.0pt;line-height:112%'>
  apiSleep </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>Lib</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:brown'>&quot;Kernel32&quot;</span><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Alias</span></b><span style='font-size:
  9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;line-height:
  112%;color:brown'>&quot;Sleep&quot;</span><span style='font-size:9.0pt;
  line-height:112%'> (</span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:112%'>
  dwMilliseconds </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:slateblue'>Long</span><span
  style='font-size:9.0pt;line-height:112%'>) </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>Private</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Declare</span></b><span style='font-size:
  9.0pt;line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:
  112%;color:blue'>Function</span></b><span style='font-size:9.0pt;line-height:
  112%'> apiAttachThreadInput </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Lib</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:brown'>&quot;User32&quot;</span><span style='font-size:9.0pt;
  line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>Alias</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:brown'>&quot;AttachThreadInput&quot;</span><span
  style='font-size:9.0pt;line-height:112%'> (</span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>ByVal </span></b><span style='font-size:
  9.0pt;line-height:112%'>idAttach </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:112%'>, </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>ByVal</span></b><span
  style='font-size:9.0pt;line-height:112%'> idAttachTo </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:112%'>, </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:112%'>
  fAttach </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:112%'>) </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:.45in;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:112%'><span style='font-size:
  9.0pt;line-height:112%'> </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Private</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>Declare</span></b><span style='font-size:9.0pt;line-height:112%'>
  </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>Function</span></b><span
  style='font-size:9.0pt;line-height:112%'> apiBringWindowToTop </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>Lib</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:brown'>&quot;User32&quot;</span><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Alias</span></b><span style='font-size:
  9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;line-height:
  112%;color:brown'>&quot;BringWindowToTop&quot;</span><span style='font-size:
  9.0pt;line-height:112%'> (</span><b><span style='font-size:9.0pt;line-height:
  112%;color:blue'>ByVal </span></b><span style='font-size:9.0pt;line-height:
  112%'>lngHWnd </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:slateblue'>Long</span><span
  style='font-size:9.0pt;line-height:112%'>) </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Long </span><span style='font-size:9.0pt;line-height:112%'></span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>Private</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Declare</span></b><span style='font-size:
  9.0pt;line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:
  112%;color:blue'>Function</span></b><span style='font-size:9.0pt;line-height:
  112%'> apiCloseHandle </span><b><span style='font-size:9.0pt;line-height:
  112%;color:blue'>Lib</span></b><span style='font-size:9.0pt;line-height:112%'>
  </span><span style='font-size:9.0pt;line-height:112%;color:brown'>&quot;Kernel32&quot;</span><span
  style='font-size:9.0pt;line-height:112%'> (</span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>ByVal</span></b><span style='font-size:
  9.0pt;line-height:112%'> hObject </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:112%'>) </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Private</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Declare</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Function</span></b><span
  style='font-size:9.0pt;line-height:107%'> apiCloseWindow </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Lib</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:brown'>&quot;User32&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Alias</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;line-height:
  107%;color:brown'>&quot;CloseWindow&quot;</span><span style='font-size:9.0pt;
  line-height:107%'> (</span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:107%'>
  hWnd </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:107%'>)</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:112%'><span
  style='font-size:9.0pt;line-height:112%'> </span><i><span
  style='font-size:9.0pt;line-height:112%;color:green'>'Private Declare
  Function apiCreatePipe Lib &quot;Kernel32&quot; (phReadPipe As Long,
  phWritePipe As Long, lpPipeAttributes As SECURITY_ATTRIBUTES, ByVal nSize As
  Long) As Long</span></i></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:1.05pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:112%'><span style='font-size:
  9.0pt;line-height:112%'> </span><i><span style='font-size:9.0pt;
  line-height:112%;color:green'>'Private Declare Function apiCreateProcess Lib
  &quot;Kernel32&quot; Alias &quot;CreateProcessA&quot; (ByVal
  lpApplicationName As Long, ByVal lpCommandLine As String, lpProcessAttributes
  As Any, lpThreadAttributes As Any, ByVal bInheritHandles As Long, ByVal
  dwCreationFlags As Long, lpEnvironment As Any, ByVal lpCurrentDriectory As
  String, lpStartupInfo As STARTUPINFO, lpProcessInformation As
  PROCESS_INFORMATION) As Long</span></i></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Private</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Declare</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Function</span></b><span
  style='font-size:9.0pt;line-height:107%'> apiDestroyWindow </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Lib</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:brown'>&quot;User32&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Alias</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;line-height:
  107%;color:brown'>&quot;DestroyWindow&quot;</span><span style='font-size:
  9.0pt;line-height:107%'> (</span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:
  107%'> hWnd </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>As</span></b></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:112%'><span
  style='font-size:9.0pt;line-height:112%;color:slateblue'>Long</span><span
  style='font-size:9.0pt;line-height:112%'>) </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Boolean </span><span style='font-size:9.0pt;line-height:
  112%'></span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>Private</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Declare</span></b><span style='font-size:
  9.0pt;line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:
  112%;color:blue'>Function</span></b><span style='font-size:9.0pt;line-height:
  112%'> apiEndDialog </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>Lib</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:brown'>&quot;User32&quot;</span><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Alias</span></b><span style='font-size:
  9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;line-height:
  112%;color:brown'>&quot;EndDialog&quot;</span><span style='font-size:9.0pt;
  line-height:112%'> (</span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:112%'>
  hWnd </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:112%'>, </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>ByVal </span></b><span style='font-size:9.0pt;line-height:112%'>result
  </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:112%'>) </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:slateblue'>Boolean </span><span
  style='font-size:9.0pt;line-height:112%'></span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>Private</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Declare</span></b><span style='font-size:
  9.0pt;line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:
  112%;color:blue'>Function</span></b><span style='font-size:9.0pt;line-height:
  112%'> apiEnumChildWindows </span><b><span style='font-size:9.0pt;line-height:
  112%;color:blue'>Lib</span></b><span style='font-size:9.0pt;line-height:112%'>
  </span><span style='font-size:9.0pt;line-height:112%;color:brown'>&quot;User32&quot;</span><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Alias</span></b><span style='font-size:
  9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;line-height:
  112%;color:brown'>&quot;EnumChildWindows&quot;</span><span style='font-size:
  9.0pt;line-height:112%'> (</span><b><span style='font-size:9.0pt;line-height:
  112%;color:blue'>ByVal </span></b><span style='font-size:9.0pt;line-height:
  112%'>hWndParent </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:slateblue'>Long</span><span
  style='font-size:9.0pt;line-height:112%'>, </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>ByVal</span></b><span style='font-size:
  9.0pt;line-height:112%'> pEnumProc </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:112%'>, </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>ByVal</span></b><span
  style='font-size:9.0pt;line-height:112%'> lParam </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:112%'>) </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:slateblue'>Long </span><span
  style='font-size:9.0pt;line-height:112%'></span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>Private</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Declare</span></b><span style='font-size:
  9.0pt;line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:
  112%;color:blue'>Function</span></b><span style='font-size:9.0pt;line-height:
  112%'> apiExitWindowsEx </span><b><span style='font-size:9.0pt;line-height:
  112%;color:blue'>Lib</span></b><span style='font-size:9.0pt;line-height:112%'>
  </span><span style='font-size:9.0pt;line-height:112%;color:brown'>&quot;User32&quot;</span><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Alias</span></b><span style='font-size:
  9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;line-height:
  112%;color:brown'>&quot;ExitWindowsEx&quot;</span><span style='font-size:
  9.0pt;line-height:112%'> (</span><b><span style='font-size:9.0pt;line-height:
  112%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:
  112%'> uFlags </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>As</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:slateblue'>Long</span><span style='font-size:
  9.0pt;line-height:107%'>, </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:
  107%'> dwReserved </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:107%'> </span><span
  style='font-size:9.0pt;line-height:107%;color:slateblue'>Long</span><span
  style='font-size:9.0pt;line-height:107%'>) </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Private</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Declare</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Function</span></b><span
  style='font-size:9.0pt;line-height:107%'> apiFindExecutable </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Lib</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:brown'>&quot;Shell32&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Alias</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;line-height:
  107%;color:brown'>&quot;FindExecutableA&quot;</span><span style='font-size:
  9.0pt;line-height:107%'> (</span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:
  107%'> lpFile</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>String</span><span style='font-size:9.0pt;line-height:107%'>,
  ByVallpDirectory </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:107%'> </span><span
  style='font-size:9.0pt;line-height:107%;color:slateblue'>String</span><span
  style='font-size:9.0pt;line-height:107%'>, </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>ByVal</span></b><span style='font-size:
  9.0pt;line-height:107%'> lpResult </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>String</span><span style='font-size:9.0pt;line-height:107%'>)
  </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Private</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Declare</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Function</span></b><span
  style='font-size:9.0pt;line-height:107%'> apiFindWindow </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Lib</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:brown'>&quot;User32&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Alias</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;line-height:
  107%;color:brown'>&quot;FindWindowA&quot;</span><span style='font-size:9.0pt;
  line-height:107%'> (</span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:107%'>
  lpClassName </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>As</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:slateblue'>String</span><span style='font-size:
  9.0pt;line-height:107%'>, </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:
  107%'> lpWindowName </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:107%'> </span><span
  style='font-size:9.0pt;line-height:107%;color:slateblue'>String</span><span
  style='font-size:9.0pt;line-height:107%'>) </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Private</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Declare</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Function</span></b><span
  style='font-size:9.0pt;line-height:107%'> apiFindWindowEx </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Lib</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:brown'>&quot;User32&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Alias</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;line-height:
  107%;color:brown'>&quot;FindWindowExA&quot;</span><span style='font-size:
  9.0pt;line-height:107%'> (</span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:
  107%'> hWnd1 </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>As</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:slateblue'>Long</span><span style='font-size:
  9.0pt;line-height:107%'>, </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:
  107%'> hWnd2 </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:107%'> </span><span
  style='font-size:9.0pt;line-height:107%;color:slateblue'>Long</span><span
  style='font-size:9.0pt;line-height:107%'>, </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>ByVal</span></b><span style='font-size:
  9.0pt;line-height:107%'> lpsz1 </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>String</span><span style='font-size:9.0pt;line-height:107%'>,
  </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>ByVal</span></b><span
  style='font-size:9.0pt;line-height:107%'> lpsz2 </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>String</span><span style='font-size:9.0pt;
  line-height:107%'>) </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:107%'> </span><span
  style='font-size:9.0pt;line-height:107%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Private</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Declare</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Function</span></b><span
  style='font-size:9.0pt;line-height:107%'> apiGetActiveWindow </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Lib</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:brown'>&quot;User32&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Alias</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;line-height:
  107%;color:brown'>&quot;GetActiveWindow&quot;</span><span style='font-size:
  9.0pt;line-height:107%'> () </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Private</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Declare</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Function</span></b><span
  style='font-size:9.0pt;line-height:107%'> apiGetClassNameA </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Lib</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:brown'>&quot;User32&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Alias</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;line-height:
  107%;color:brown'>&quot;GetClassNameA&quot;</span><span style='font-size:
  9.0pt;line-height:107%'> (</span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:
  107%'> hWnd </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>As</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:slateblue'>Long</span><span style='font-size:
  9.0pt;line-height:107%'>, </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:
  107%'> szClassName </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:107%'> </span><span
  style='font-size:9.0pt;line-height:107%;color:slateblue'>String</span><span
  style='font-size:9.0pt;line-height:107%'>, </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>ByVal</span></b><span style='font-size:
  9.0pt;line-height:107%'> lLength </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:107%'>) </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:112%'><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>Private</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Declare</span></b><span style='font-size:
  9.0pt;line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:
  112%;color:blue'>Function</span></b><span style='font-size:9.0pt;line-height:
  112%'> apiGetCommandLine </span><b><span style='font-size:9.0pt;line-height:
  112%;color:blue'>Lib</span></b><span style='font-size:9.0pt;line-height:112%'>
  </span><span style='font-size:9.0pt;line-height:112%;color:brown'>&quot;Kernel32&quot;</span><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Alias</span></b><span style='font-size:
  9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;line-height:
  112%;color:brown'>&quot;GetCommandLineW&quot;</span><span style='font-size:
  9.0pt;line-height:112%'> () </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Long </span><span style='font-size:9.0pt;line-height:112%'></span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>Private</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Declare</span></b><span style='font-size:
  9.0pt;line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:
  112%;color:blue'>Function</span></b><span style='font-size:9.0pt;line-height:
  112%'> apiGetCommandLineParams </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Lib</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:brown'>&quot;Kernel32&quot;</span><span style='font-size:9.0pt;
  line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>Alias</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:brown'>&quot;GetCommandLineA&quot;</span><span
  style='font-size:9.0pt;line-height:112%'> () </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Private</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Declare</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Function</span></b><span
  style='font-size:9.0pt;line-height:107%'> apiGetDiskFreeSpaceEx </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Lib</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:brown'>&quot;Kernel32&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Alias</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;line-height:
  107%;color:brown'>&quot;GetDiskFreeSpaceExA&quot;</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-align:justify;text-justify:inter-ideograph;text-indent:
  0in;line-height:107%'><span style='font-size:9.0pt;line-height:107%'>(</span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>ByVal</span></b><span
  style='font-size:9.0pt;line-height:107%'> lpDirectoryName </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>String</span><span style='font-size:9.0pt;
  line-height:107%'>, lpFreeBytesAvailableToCaller </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> Currency, lpTotalNumberOfBytes </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>Currency, lpTotalNumberOfFreeBytes </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> Currency) </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Private</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Declare</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Function</span></b><span
  style='font-size:9.0pt;line-height:107%'> apiGetDriveType </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Lib</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:brown'>&quot;Kernel32&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Alias</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;line-height:
  107%;color:brown'>&quot;GetDriveTypeA&quot;</span><span style='font-size:
  9.0pt;line-height:107%'> (</span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:
  107%'> nDrive </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>As</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:5.4pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:112%'><span style='font-size:
  9.0pt;line-height:112%;color:slateblue'>String</span><span style='font-size:
  9.0pt;line-height:112%'>) </span><b><span style='font-size:9.0pt;line-height:
  112%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:112%'>
  </span><span style='font-size:9.0pt;line-height:112%;color:slateblue'>Long </span><span
  style='font-size:9.0pt;line-height:112%'></span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>Private</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Declare</span></b><span style='font-size:
  9.0pt;line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:
  112%;color:blue'>Function</span></b><span style='font-size:9.0pt;line-height:
  112%'> apiGetExitCodeProcess </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Lib</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:brown'>&quot;Kernel32&quot;</span><span style='font-size:9.0pt;
  line-height:112%'> (</span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:112%'>
  hProcess </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:112%'>, lpExitCode </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:112%'>) </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long </span><span style='font-size:9.0pt;
  line-height:112%'></span><b><span style='font-size:9.0pt;line-height:
  112%;color:blue'>Private</span></b><span style='font-size:9.0pt;line-height:
  112%'> </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>Declare</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Function</span></b><span style='font-size:
  9.0pt;line-height:112%'> apiGetFileSize </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Lib</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:brown'>&quot;Kernel32&quot;</span><span style='font-size:9.0pt;
  line-height:112%'> (</span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:112%'>
  hFile </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:112%'>, lpFileSizeHigh </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:slateblue'>Long</span><span style='font-size:
  9.0pt;line-height:107%'>) </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><span style='font-size:9.0pt;line-height:107%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Private</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Declare</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Function</span></b><span
  style='font-size:9.0pt;line-height:107%'> apiGetForegroundWindow </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Lib</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:brown'>&quot;User32&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Alias</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;line-height:
  107%;color:brown'>&quot;GetForegroundWindow&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> () </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:112%'><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>Private</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Declare</span></b><span style='font-size:
  9.0pt;line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:
  112%;color:blue'>Function</span></b><span style='font-size:9.0pt;line-height:
  112%'> apiGetFrequency </span><b><span style='font-size:9.0pt;line-height:
  112%;color:blue'>Lib</span></b><span style='font-size:9.0pt;line-height:112%'>
  </span><span style='font-size:9.0pt;line-height:112%;color:brown'>&quot;Kernel32&quot;</span><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Alias</span></b><span style='font-size:
  9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;line-height:
  112%;color:brown'>&quot;QueryPerformanceFrequency&quot; </span><span
  style='font-size:9.0pt;line-height:112%'>(cyFrequency </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> Currency) </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:112%'><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>Private</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Declare</span></b><span style='font-size:
  9.0pt;line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:
  112%;color:blue'>Function</span></b><span style='font-size:9.0pt;line-height:
  112%'> apiGetLastError </span><b><span style='font-size:9.0pt;line-height:
  112%;color:blue'>Lib</span></b><span style='font-size:9.0pt;line-height:112%'>
  </span><span style='font-size:9.0pt;line-height:112%;color:brown'>&quot;Kernel32&quot;</span><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Alias</span></b><span style='font-size:
  9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;line-height:
  112%;color:brown'>&quot;GetLastError&quot;</span><span style='font-size:9.0pt;
  line-height:112%'> () </span><b><span style='font-size:9.0pt;line-height:
  112%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:112%'>
  </span><span style='font-size:9.0pt;line-height:112%;color:slateblue'>Integer
  </span><span style='font-size:9.0pt;line-height:112%'></span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>Private</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Declare</span></b><span style='font-size:
  9.0pt;line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:
  112%;color:blue'>Function</span></b><span style='font-size:9.0pt;line-height:
  112%'> apiGetParent </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>Lib</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:brown'>&quot;User32&quot;</span><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Alias</span></b><span style='font-size:
  9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;line-height:
  112%;color:brown'>&quot;GetParent&quot;</span><span style='font-size:9.0pt;
  line-height:112%'> (</span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:112%'>
  hWnd </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:112%'>) </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>As</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:.45in;margin-bottom:
  0in;margin-left:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:112%'><span style='font-size:9.0pt;line-height:
  112%;color:slateblue'>Long </span><span style='font-size:9.0pt;line-height:
  112%'></span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>Private</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Declare</span></b><span style='font-size:
  9.0pt;line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:
  112%;color:blue'>Function</span></b><span style='font-size:9.0pt;line-height:
  112%'> apiGetSystemMetrics </span><b><span style='font-size:9.0pt;line-height:
  112%;color:blue'>Lib</span></b><span style='font-size:9.0pt;line-height:112%'>
  </span><span style='font-size:9.0pt;line-height:112%;color:brown'>&quot;User32&quot;</span><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Alias</span></b><span style='font-size:
  9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;line-height:
  112%;color:brown'>&quot;GetSystemMetrics&quot;</span><span style='font-size:
  9.0pt;line-height:112%'> (</span><b><span style='font-size:9.0pt;line-height:
  112%;color:blue'>ByVal </span></b><span style='font-size:9.0pt;line-height:
  112%'>nIndex </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:slateblue'>Long</span><span
  style='font-size:9.0pt;line-height:112%'>) </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:112%'><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>Private</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Declare</span></b><span style='font-size:
  9.0pt;line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:
  112%;color:blue'>Function</span></b><span style='font-size:9.0pt;line-height:
  112%'> apiGetTickCount </span><b><span style='font-size:9.0pt;line-height:
  112%;color:blue'>Lib</span></b><span style='font-size:9.0pt;line-height:112%'>
  </span><span style='font-size:9.0pt;line-height:112%;color:brown'>&quot;Kernel32&quot;</span><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Alias</span></b><span style='font-size:
  9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;line-height:
  112%;color:brown'>&quot;QueryPerformanceCounter&quot; </span><span
  style='font-size:9.0pt;line-height:112%'>(cyTickCount </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> Currency) </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Private</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Declare</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Function</span></b><span
  style='font-size:9.0pt;line-height:107%'> apiGetTickCountMs </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Lib</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:brown'>&quot;Kernel32&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Alias</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;line-height:
  107%;color:brown'>&quot;GetTickCount&quot;</span><span style='font-size:9.0pt;
  line-height:107%'> () </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><span style='font-size:9.0pt;line-height:107%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.6pt;
  margin-left:0in;text-align:justify;text-justify:inter-ideograph;text-indent:
  0in;line-height:112%'><span style='font-size:9.0pt;line-height:112%'> </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>Private</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Declare</span></b><span style='font-size:
  9.0pt;line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:
  112%;color:blue'>Function</span></b><span style='font-size:9.0pt;line-height:
  112%'> apiGetUserName </span><b><span style='font-size:9.0pt;line-height:
  112%;color:blue'>Lib</span></b><span style='font-size:9.0pt;line-height:112%'>
  </span><span style='font-size:9.0pt;line-height:112%;color:brown'>&quot;AdvApi32&quot;</span><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Alias</span></b><span style='font-size:
  9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;line-height:
  112%;color:brown'>&quot;GetUserNameA&quot;</span><span style='font-size:9.0pt;
  line-height:112%'> (</span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:112%'>
  lpBuffer </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>As
  </span></b><span style='font-size:9.0pt;line-height:112%;color:slateblue'>String</span><span
  style='font-size:9.0pt;line-height:112%'>, nSize </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:112%'>) </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:slateblue'>Long </span><span
  style='font-size:9.0pt;line-height:112%'></span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>Private</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Declare</span></b><span style='font-size:
  9.0pt;line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:
  112%;color:blue'>Function</span></b><span style='font-size:9.0pt;line-height:
  112%'> apiGetWindow </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>Lib</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:brown'>&quot;User32&quot;</span><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Alias</span></b><span style='font-size:
  9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;line-height:
  112%;color:brown'>&quot;GetWindow&quot;</span><span style='font-size:9.0pt;
  line-height:112%'> (</span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:112%'>
  hWnd </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:112%'>, </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>ByVal </span></b><span style='font-size:9.0pt;line-height:112%'>wCmd
  </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:112%'>) </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:11.0pt;line-height:107%'> </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Private </span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Function</span></b><span style='font-size:
  9.0pt;line-height:107%'> apiGetWindowRect </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Lib</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:brown'>&quot;User32&quot;</span><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Alias</span></b><span style='font-size:9.0pt;line-height:107%'> </span><span
  style='font-size:9.0pt;line-height:107%;color:brown'>&quot;GetWindowRect&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> (</span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>ByVal</span></b><span style='font-size:
  9.0pt;line-height:107%'> hWnd </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:566.75pt;margin-bottom:
0in;margin-left:-28.35pt;text-indent:0in;line-height:107%'>&nbsp;</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=718
 style='width:538.6pt;border-collapse:collapse'>
 <tr style='height:771.0pt'>
  <td width=718 valign=top style='width:538.6pt;background:#FAFAFA;padding:
  2.55pt .25pt 0in 3.75pt;height:771.0pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:slateblue'>Long</span><span style='font-size:
  9.0pt;line-height:107%'>, lpRect </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> winRect) </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Private</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Declare</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Function</span></b><span
  style='font-size:9.0pt;line-height:107%'> apiGetWindowText </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Lib</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:brown'>&quot;User32&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Alias</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;line-height:
  107%;color:brown'>&quot;GetWindowTextA&quot;</span><span style='font-size:
  9.0pt;line-height:107%'> (</span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:
  107%'> hWnd </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>As</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:slateblue'>Long</span><span style='font-size:
  9.0pt;line-height:107%'>, </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:
  107%'> szWindowText </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:107%'> </span><span
  style='font-size:9.0pt;line-height:107%;color:slateblue'>String</span><span
  style='font-size:9.0pt;line-height:107%'>, </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>ByVal</span></b><span style='font-size:
  9.0pt;line-height:107%'> lLength </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:107%'>) </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Private</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Declare</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Function</span></b><span
  style='font-size:9.0pt;line-height:107%'> apiGetWindowThreadProcessId </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Lib</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:brown'>&quot;User32&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Alias</span></b></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:112%'><span
  style='font-size:9.0pt;line-height:112%;color:brown'>&quot;GetWindowThreadProcessId&quot;</span><span
  style='font-size:9.0pt;line-height:112%'> (</span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>ByVal</span></b><span style='font-size:
  9.0pt;line-height:112%'> hWnd </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:112%'>,
  lpdwProcessId </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:slateblue'>Long</span><span
  style='font-size:9.0pt;line-height:112%'>) </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Long </span><span style='font-size:9.0pt;line-height:112%'></span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>Private</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Declare</span></b><span style='font-size:
  9.0pt;line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:
  112%;color:blue'>Function</span></b><span style='font-size:9.0pt;line-height:
  112%'> apiIsCharAlphaNumericA </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Lib</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:brown'>&quot;User32&quot;</span><span style='font-size:9.0pt;
  line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>Alias</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:brown'>&quot;IsCharAlphaNumericA&quot;</span><span
  style='font-size:9.0pt;line-height:112%'> (</span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>ByVal </span></b><span style='font-size:
  9.0pt;line-height:112%'>byChar </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Byte</span><span style='font-size:9.0pt;line-height:112%'>) </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long </span><span style='font-size:9.0pt;
  line-height:112%'></span><b><span style='font-size:9.0pt;line-height:
  112%;color:blue'>Private</span></b><span style='font-size:9.0pt;line-height:
  112%'> </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>Declare</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Function</span></b><span style='font-size:
  9.0pt;line-height:112%'> apiIsIconic </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Lib</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:brown'>&quot;User32&quot;</span><span style='font-size:9.0pt;
  line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>Alias</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:brown'>&quot;IsIconic&quot;</span><span
  style='font-size:9.0pt;line-height:112%'> (</span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>ByVal</span></b><span style='font-size:
  9.0pt;line-height:112%'> hWnd </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:112%'>) </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long </span><span style='font-size:9.0pt;
  line-height:112%'></span><b><span style='font-size:9.0pt;line-height:
  112%;color:blue'>Private</span></b><span style='font-size:9.0pt;line-height:
  112%'> </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>Declare</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Function</span></b><span style='font-size:
  9.0pt;line-height:112%'> apiIsWindowVisible </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Lib</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:brown'>&quot;User32&quot;</span><span style='font-size:9.0pt;
  line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>Alias</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:brown'>&quot;IsWindowVisible&quot;</span><span
  style='font-size:9.0pt;line-height:112%'> (</span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>ByVal</span></b><span style='font-size:
  9.0pt;line-height:112%'> hWnd </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:slateblue'>Long</span><span style='font-size:
  9.0pt;line-height:107%'>) </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><span style='font-size:9.0pt;line-height:107%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-align:justify;text-justify:inter-ideograph;text-indent:
  0in;line-height:107%'><span style='font-size:9.0pt;line-height:107%'> </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Private</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Declare</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Function</span></b><span style='font-size:9.0pt;line-height:
  107%'> apiIsZoomed </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Lib</span></b><span style='font-size:9.0pt;line-height:107%'> </span><span
  style='font-size:9.0pt;line-height:107%;color:brown'>&quot;User32&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Alias</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;line-height:
  107%;color:brown'>&quot;IsZoomed&quot;</span><span style='font-size:9.0pt;
  line-height:107%'> (</span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:107%'>
  hWnd </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:107%'>) </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:107%'> </span><span
  style='font-size:9.0pt;line-height:107%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Private</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Declare</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Function</span></b><span
  style='font-size:9.0pt;line-height:107%'> apiLStrCpynA </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Lib</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:brown'>&quot;Kernel32&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Alias</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;line-height:
  107%;color:brown'>&quot;lstrcpynA&quot;</span><span style='font-size:9.0pt;
  line-height:107%'> (</span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:107%'>
  pDestination </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>As</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:slateblue'>String</span><span style='font-size:
  9.0pt;line-height:107%'>, </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:
  107%'> pSource </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:107%'> </span><span
  style='font-size:9.0pt;line-height:107%;color:slateblue'>Long</span><span
  style='font-size:9.0pt;line-height:107%'>, </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>ByVal</span></b><span style='font-size:
  9.0pt;line-height:107%'> iMaxLength </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Integer</span><span style='font-size:9.0pt;line-height:107%'>)
  </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Private</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Declare</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Function</span></b><span
  style='font-size:9.0pt;line-height:107%'> apiMessageBox </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Lib</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:brown'>&quot;User32&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Alias</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;line-height:
  107%;color:brown'>&quot;MessageBoxA&quot;</span><span style='font-size:9.0pt;
  line-height:107%'> (</span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:107%'>
  hWnd </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:107%'>,</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>ByVal</span></b><span style='font-size:
  9.0pt;line-height:107%'> lpText </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>String</span><span style='font-size:9.0pt;line-height:107%'>,
  </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>ByVal</span></b><span
  style='font-size:9.0pt;line-height:107%'> lpCaption </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>String</span><span style='font-size:9.0pt;
  line-height:107%'>, </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:107%'>
  wType </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:107%'>) </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:107%'> </span><span
  style='font-size:9.0pt;line-height:107%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:112%'><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>Private</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Declare</span></b><span style='font-size:
  9.0pt;line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:
  112%;color:blue'>Function</span></b><span style='font-size:9.0pt;line-height:
  112%'> apiOpenIcon </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>Lib</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:brown'>&quot;User32&quot;</span><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Alias</span></b><span style='font-size:
  9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;line-height:
  112%;color:brown'>&quot;OpenIcon&quot;</span><span style='font-size:9.0pt;
  line-height:112%'> (</span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:112%'>
  hWnd </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:112%'>) </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:slateblue'>Long </span><span
  style='font-size:9.0pt;line-height:112%'></span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>Private</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Declare</span></b><span style='font-size:
  9.0pt;line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:
  112%;color:blue'>Function</span></b><span style='font-size:9.0pt;line-height:
  112%'> apiOpenProcess </span><b><span style='font-size:9.0pt;line-height:
  112%;color:blue'>Lib</span></b><span style='font-size:9.0pt;line-height:112%'>
  </span><span style='font-size:9.0pt;line-height:112%;color:brown'>&quot;Kernel32&quot;</span><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Alias</span></b><span style='font-size:
  9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;line-height:
  112%;color:brown'>&quot;OpenProcess&quot;</span><span style='font-size:9.0pt;
  line-height:112%'> (</span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>ByVal </span></b><span style='font-size:9.0pt;line-height:112%'>dwDesiredAccess
  </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:112%'>, </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:112%'>
  bInheritHandle </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:slateblue'>Long</span><span
  style='font-size:9.0pt;line-height:112%'>, </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>ByVal</span></b><span style='font-size:
  9.0pt;line-height:112%'> dwProcessId </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:112%'>) </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long </span><span style='font-size:9.0pt;
  line-height:112%'></span><b><span style='font-size:9.0pt;line-height:
  112%;color:blue'>Private</span></b><span style='font-size:9.0pt;line-height:
  112%'> </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>Declare</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Function</span></b><span style='font-size:
  9.0pt;line-height:112%'> apiPathAddBackslashByPointer </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>Lib</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:brown'>&quot;ShlwApi&quot;</span><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Alias</span></b><span style='font-size:
  9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;line-height:
  112%;color:brown'>&quot;PathAddBackslashW&quot;</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>(</span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:
  107%'> lpszPath </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:107%'> </span><span
  style='font-size:9.0pt;line-height:107%;color:slateblue'>Long</span><span
  style='font-size:9.0pt;line-height:107%'>) </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Private</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Declare</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Function</span></b><span
  style='font-size:9.0pt;line-height:107%'> apiPathAddBackslashByString </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Lib</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:brown'>&quot;ShlwApi&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Alias</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;line-height:
  107%;color:brown'>&quot;PathAddBackslashW&quot;</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>(</span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:
  107%'> lpszPath </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:107%'> </span><span
  style='font-size:9.0pt;line-height:107%;color:slateblue'>String</span><span
  style='font-size:9.0pt;line-height:107%'>) </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><i><span style='font-size:
  9.0pt;line-height:107%;color:green'>'http://msdn.microsoft.com/en-us/library/aa155716%28office.10%29.aspx</span></i></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Private</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Declare</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Function</span></b><span
  style='font-size:9.0pt;line-height:107%'> apiPostMessage </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Lib</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:brown'>&quot;User32&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Alias</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;line-height:
  107%;color:brown'>&quot;PostMessageA&quot;</span><span style='font-size:9.0pt;
  line-height:107%'> (</span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:107%'>
  hWnd </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:107%'>,</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>ByVal</span></b><span style='font-size:
  9.0pt;line-height:107%'> wMsg </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:107%'>, </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>ByVal</span></b><span
  style='font-size:9.0pt;line-height:107%'> wParam </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:107%'>, </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:107%'>
  lParam </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:107%'>) </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:107%'> </span><span
  style='font-size:9.0pt;line-height:107%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Private</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Declare</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Function</span></b><span
  style='font-size:9.0pt;line-height:107%'> apiReadFile </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Lib</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:brown'>&quot;Kernel32&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> (</span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>ByVal</span></b><span style='font-size:
  9.0pt;line-height:107%'> hFile </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:107%'>,
  lpBuffer </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> Any,</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>ByVal</span></b><span style='font-size:
  9.0pt;line-height:107%'> nNumberOfBytesToRead </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:107%'>, lpNumberOfBytesRead </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:107%'>,
  lpOverlapped </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:107%'> Any)
  </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:112%'><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>Private</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Declare</span></b><span style='font-size:
  9.0pt;line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:
  112%;color:blue'>Function</span></b><span style='font-size:9.0pt;line-height:
  112%'> apiRegQueryValue </span><b><span style='font-size:9.0pt;line-height:
  112%;color:blue'>Lib</span></b><span style='font-size:9.0pt;line-height:112%'>
  </span><span style='font-size:9.0pt;line-height:112%;color:brown'>&quot;AdvApi32&quot;</span><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Alias</span></b><span style='font-size:
  9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;line-height:
  112%;color:brown'>&quot;RegQueryValue&quot;</span><span style='font-size:
  9.0pt;line-height:112%'> (</span><b><span style='font-size:9.0pt;line-height:
  112%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:
  112%'> hKey </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>As </span></b><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:112%'>, </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>ByVal</span></b><span
  style='font-size:9.0pt;line-height:112%'> sValueName </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>String</span><span style='font-size:9.0pt;
  line-height:112%'>, </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:112%'>
  dwReserved </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:slateblue'>Long</span><span
  style='font-size:9.0pt;line-height:112%'>, </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>ByRef</span></b><span style='font-size:
  9.0pt;line-height:112%'> lValueType </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:112%'>, </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>ByVal</span></b><span
  style='font-size:9.0pt;line-height:112%'> sValue</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>String</span><span style='font-size:9.0pt;line-height:107%'>,
  </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>ByRef</span></b><span
  style='font-size:9.0pt;line-height:107%'> lResultLen </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:107%'>) </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:107%'> </span><span
  style='font-size:9.0pt;line-height:107%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Private</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Declare</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Function</span></b><span
  style='font-size:9.0pt;line-height:107%'> apiSendMessage </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Lib</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:brown'>&quot;User32&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Alias</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;line-height:
  107%;color:brown'>&quot;SendMessageA&quot;</span><span style='font-size:9.0pt;
  line-height:107%'> (</span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:107%'>
  hWnd </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:107%'>,</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>ByVal</span></b><span style='font-size:
  9.0pt;line-height:107%'> wMsg </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:107%'>, </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>ByVal</span></b><span
  style='font-size:9.0pt;line-height:107%'> wParam </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:107%'>, lParam </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:107%'>
  Any) </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-align:justify;text-justify:inter-ideograph;text-indent:
  0in;line-height:107%'><span style='font-size:9.0pt;line-height:107%'> </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Private</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Declare</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Function</span></b><span style='font-size:9.0pt;line-height:
  107%'> apiSetActiveWindow </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Lib</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><span style='font-size:9.0pt;line-height:107%;color:brown'>&quot;User32&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Alias</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;line-height:
  107%;color:brown'>&quot;SetActiveWindow&quot;</span><span style='font-size:
  9.0pt;line-height:107%'> (</span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:
  107%'> hWnd </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>As</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:slateblue'>Long</span><span style='font-size:
  9.0pt;line-height:107%'>) </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><span style='font-size:9.0pt;line-height:107%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Private</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Declare</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Function</span></b><span
  style='font-size:9.0pt;line-height:107%'> apiSetCurrentDirectoryA </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Lib</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:brown'>&quot;Kernel32&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Alias</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;line-height:
  107%;color:brown'>&quot;SetCurrentDirectoryA&quot;</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>(</span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:
  107%'> lpPathName </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:107%'> </span><span
  style='font-size:9.0pt;line-height:107%;color:slateblue'>String</span><span
  style='font-size:9.0pt;line-height:107%'>) </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:112%'><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>Private</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Declare</span></b><span style='font-size:
  9.0pt;line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:
  112%;color:blue'>Function</span></b><span style='font-size:9.0pt;line-height:
  112%'> apiSetFocus </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>Lib</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:brown'>&quot;User32&quot;</span><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Alias</span></b><span style='font-size:
  9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;line-height:
  112%;color:brown'>&quot;SetFocus&quot;</span><span style='font-size:9.0pt;
  line-height:112%'> (</span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:112%'>
  hWnd </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:112%'>) </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:slateblue'>Long </span><span
  style='font-size:9.0pt;line-height:112%'></span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>Private</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Declare</span></b><span style='font-size:
  9.0pt;line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:
  112%;color:blue'>Function</span></b><span style='font-size:9.0pt;line-height:
  112%'> apiSetForegroundWindow </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Lib</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:brown'>&quot;User32&quot;</span><span style='font-size:9.0pt;
  line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>Alias</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:brown'>&quot;SetForegroundWindow&quot;</span><span
  style='font-size:9.0pt;line-height:112%'> (</span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>ByVal </span></b><span style='font-size:
  9.0pt;line-height:112%'>hWnd </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:112%'>) </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long </span><span style='font-size:9.0pt;
  line-height:112%'></span><b><span style='font-size:9.0pt;line-height:
  112%;color:blue'>Private</span></b><span style='font-size:9.0pt;line-height:
  112%'> </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>Declare</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Function</span></b><span style='font-size:
  9.0pt;line-height:112%'> apiSetLocalTime </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Lib</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:brown'>&quot;Kernel32&quot;</span><span style='font-size:9.0pt;
  line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>Alias</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:brown'>&quot;SetLocalTime&quot;</span><span
  style='font-size:9.0pt;line-height:112%'> (lpSystem </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:112%'><span
  style='font-size:9.0pt;line-height:112%'>SystemTime) </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long </span><span style='font-size:9.0pt;
  line-height:112%'></span><b><span style='font-size:9.0pt;line-height:
  112%;color:blue'>Private</span></b><span style='font-size:9.0pt;line-height:
  112%'> </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>Declare</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Function</span></b><span style='font-size:
  9.0pt;line-height:112%'> apiSetWindowPlacement </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>Lib</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:brown'>&quot;User32&quot;</span><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Alias</span></b><span style='font-size:
  9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;line-height:
  112%;color:brown'>&quot;SetWindowPlacement&quot;</span><span
  style='font-size:9.0pt;line-height:112%'> (</span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>ByVal </span></b><span style='font-size:
  9.0pt;line-height:112%'>hWnd </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:112%'>, </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>ByRef</span></b><span
  style='font-size:9.0pt;line-height:112%'> lpwndpl </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> winPlacement) </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long </span><span style='font-size:9.0pt;
  line-height:112%'></span><b><span style='font-size:9.0pt;line-height:
  112%;color:blue'>Private</span></b><span style='font-size:9.0pt;line-height:
  112%'> </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>Declare</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Function</span></b><span style='font-size:
  9.0pt;line-height:112%'> apiSetWindowPos </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Lib</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:brown'>&quot;User32&quot;</span><span style='font-size:9.0pt;
  line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>Alias</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:brown'>&quot;SetWindowPos&quot;</span><span
  style='font-size:9.0pt;line-height:112%'> (</span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>ByVal</span></b><span style='font-size:
  9.0pt;line-height:112%'> hWnd </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:112%'>,</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:112%'><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>ByVal</span></b><span
  style='font-size:9.0pt;line-height:112%'> hWndInsertAfter </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:112%'>, </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:112%'> X
  </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:112%'>, </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:112%'> Y
  </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:112%'>, </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:112%'>
  cx </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:112%'>, </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:112%'>
  cy </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>As </span></b><span
  style='font-size:9.0pt;line-height:112%;color:slateblue'>Long</span><span
  style='font-size:9.0pt;line-height:112%'>, </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>ByVal</span></b><span style='font-size:
  9.0pt;line-height:112%'> wFlags </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:112%'>) </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Private</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Declare</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Function</span></b><span
  style='font-size:9.0pt;line-height:107%'> apiSetWindowText </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Lib</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:brown'>&quot;User32&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Alias</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;line-height:
  107%;color:brown'>&quot;SetWindowTextA&quot;</span><span style='font-size:
  9.0pt;line-height:107%'> (</span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:
  107%'> hWnd </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>As</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:slateblue'>Long</span><span style='font-size:
  9.0pt;line-height:107%'>, </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:
  107%'> lpString </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:107%'> </span><span
  style='font-size:9.0pt;line-height:107%;color:slateblue'>String</span><span
  style='font-size:9.0pt;line-height:107%'>) </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:.3in;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:112%'><span style='font-size:
  9.0pt;line-height:112%'> </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Private</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>Declare</span></b><span style='font-size:9.0pt;line-height:112%'>
  </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>Function</span></b><span
  style='font-size:9.0pt;line-height:112%'> apiShellExecute </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>Lib</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:brown'>&quot;Shell32&quot;</span><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Alias</span></b><span style='font-size:
  9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;line-height:
  112%;color:brown'>&quot;ShellExecuteA&quot;</span><span style='font-size:
  9.0pt;line-height:112%'> (</span><b><span style='font-size:9.0pt;line-height:
  112%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:
  112%'> hWnd </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>As </span></b><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:112%'>, </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>ByVal</span></b><span
  style='font-size:9.0pt;line-height:112%'> lpOperation </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>String</span><span style='font-size:9.0pt;
  line-height:112%'>, </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:112%'>
  lpFile </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>String</span><span style='font-size:9.0pt;
  line-height:112%'>, </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:112%'>
  lpParameters </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:slateblue'>String</span><span
  style='font-size:9.0pt;line-height:112%'>, </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>ByVal </span></b><span style='font-size:
  9.0pt;line-height:112%'>lpDirectory </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>String</span><span style='font-size:9.0pt;line-height:112%'>,
  </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>ByVal</span></b><span
  style='font-size:9.0pt;line-height:112%'> nShowCmd </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:112%'>) </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:slateblue'>Long </span><span
  style='font-size:9.0pt;line-height:112%'></span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>Private</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Declare</span></b><span style='font-size:
  9.0pt;line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:
  112%;color:blue'>Function</span></b><span style='font-size:9.0pt;line-height:
  112%'> apiShowWindow </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>Lib</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:brown'>&quot;User32&quot;</span><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Alias</span></b><span style='font-size:
  9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;line-height:
  112%;color:brown'>&quot;ShowWindow&quot;</span><span style='font-size:9.0pt;
  line-height:112%'> (</span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:112%'>
  hWnd </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:112%'>,</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>ByVal</span></b><span style='font-size:
  9.0pt;line-height:107%'> nCmdShow </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:107%'>) </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-align:justify;text-justify:inter-ideograph;text-indent:
  0in;line-height:107%'><span style='font-size:9.0pt;line-height:107%'> </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Private</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Declare</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Function</span></b><span style='font-size:9.0pt;line-height:
  107%'> apiShowWindowAsync </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Lib</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><span style='font-size:9.0pt;line-height:107%;color:brown'>&quot;User32&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Alias</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;line-height:
  107%;color:brown'>&quot;ShowWindowAsync&quot;</span><span style='font-size:
  9.0pt;line-height:107%'> (</span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:
  107%'> hWnd </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>As</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:slateblue'>Long</span><span style='font-size:
  9.0pt;line-height:107%'>, </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:
  107%'> nCmdShow </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:107%'> </span><span
  style='font-size:9.0pt;line-height:107%;color:slateblue'>Long</span><span
  style='font-size:9.0pt;line-height:107%'>) </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Private</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Declare</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Function</span></b><span
  style='font-size:9.0pt;line-height:107%'> apiStrCpy </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Lib</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:brown'>&quot;Kernel32&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Alias</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;line-height:
  107%;color:brown'>&quot;lstrcpynA&quot;</span><span style='font-size:9.0pt;
  line-height:107%'> (</span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:107%'>
  pDestination </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>As</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:slateblue'>String</span><span style='font-size:
  9.0pt;line-height:107%'>, </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:
  107%'> pSource </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:107%'> </span><span
  style='font-size:9.0pt;line-height:107%;color:slateblue'>String</span><span
  style='font-size:9.0pt;line-height:107%'>, </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>ByVal</span></b><span style='font-size:
  9.0pt;line-height:107%'> iMaxLength </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Integer</span><span style='font-size:9.0pt;line-height:107%'>)
  </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Private</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Declare</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Function</span></b><span
  style='font-size:9.0pt;line-height:107%'> apiStringLen </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Lib</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:brown'>&quot;Kernel32&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Alias</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;line-height:
  107%;color:brown'>&quot;lstrlenW&quot;</span><span style='font-size:9.0pt;
  line-height:107%'> (</span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:107%'>
  lpString </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:107%'>)</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:.3in;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Private</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Declare</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Function</span></b><span
  style='font-size:9.0pt;line-height:107%'> apiStrTrimW </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Lib</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:brown'>&quot;ShlwApi&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Alias</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;line-height:
  107%;color:brown'>&quot;StrTrimW&quot;</span><span style='font-size:9.0pt;
  line-height:107%'> () </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><span style='font-size:9.0pt;line-height:107%;color:slateblue'>Boolean
  </span><span style='font-size:9.0pt;line-height:107%'></span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Private</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Declare</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Function</span></b><span style='font-size:9.0pt;line-height:
  107%'> apiTerminateProcess </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Lib</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><span style='font-size:9.0pt;line-height:107%;color:brown'>&quot;Kernel32&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Alias</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;line-height:
  107%;color:brown'>&quot;TerminateProcess&quot;</span><span style='font-size:
  9.0pt;line-height:107%'> (</span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>ByVal </span></b><span style='font-size:9.0pt;line-height:
  107%'>hWnd </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:107%'> </span><span
  style='font-size:9.0pt;line-height:107%;color:slateblue'>Long</span><span
  style='font-size:9.0pt;line-height:107%'>, </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>ByVal</span></b><span style='font-size:
  9.0pt;line-height:107%'> uExitCode </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:107%'>) </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>Long</span></p>
  </td>
 </tr>
</table>

</div>

<span style='font-size:10.0pt;line-height:110%;font-family:"Calibri",sans-serif;
color:black'><br clear=all style='page-break-before:always'>
</span>

<div class=WordSection4>

<p class=MsoNormal style='margin-top:0in;margin-right:542.25pt;margin-bottom:
0in;margin-left:-28.35pt;text-indent:0in;line-height:107%'>&nbsp;</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=718
 style='width:538.6pt;border-collapse:collapse'>
 <tr style='height:771.0pt'>
  <td width=718 valign=top style='width:538.6pt;background:#FAFAFA;padding:
  2.55pt 1.25pt 0in 3.75pt;height:771.0pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Private</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Declare</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Function</span></b><span
  style='font-size:9.0pt;line-height:107%'> apiTimeGetTime </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Lib</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:brown'>&quot;Winmm&quot;</span><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>Alias</span></b><span style='font-size:9.0pt;line-height:
  107%'> </span><span style='font-size:9.0pt;line-height:107%;color:brown'>&quot;timeGetTime&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> () </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:112%'><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>Private</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Declare</span></b><span style='font-size:
  9.0pt;line-height:112%'> </span><b><span style='font-size:9.0pt;line-height:
  112%;color:blue'>Function</span></b><span style='font-size:9.0pt;line-height:
  112%'> apiVarPtrArray </span><b><span style='font-size:9.0pt;line-height:
  112%;color:blue'>Lib</span></b><span style='font-size:9.0pt;line-height:112%'>
  </span><span style='font-size:9.0pt;line-height:112%;color:brown'>&quot;MsVbVm50&quot;</span><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Alias</span></b><span style='font-size:
  9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;line-height:
  112%;color:brown'>&quot;VarPtr&quot;</span><span style='font-size:9.0pt;
  line-height:112%'> (Var() </span><b><span style='font-size:9.0pt;line-height:
  112%;color:blue'>As</span></b><span style='font-size:9.0pt;line-height:112%'>
  Any) </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long </span><span style='font-size:9.0pt;
  line-height:112%'></span><b><span style='font-size:9.0pt;line-height:
  112%;color:blue'>Private</span></b><span style='font-size:9.0pt;line-height:
  112%'> </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>Declare</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>Function</span></b><span style='font-size:
  9.0pt;line-height:112%'> apiWaitForSingleObject </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>Lib</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:brown'>&quot;Kernel32&quot;</span><span
  style='font-size:9.0pt;line-height:112%'> (</span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>ByVal</span></b><span style='font-size:
  9.0pt;line-height:112%'> hHandle </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Long</span><span style='font-size:9.0pt;line-height:112%'>, </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>ByVal </span></b><span
  style='font-size:9.0pt;line-height:112%'>dwMilliseconds </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:112%'>) </span><b><span style='font-size:9.0pt;line-height:112%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:112%'> </span><span
  style='font-size:9.0pt;line-height:112%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:218.15pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:112%'><span style='font-size:
  9.0pt;line-height:112%'> </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Private</span></b><span style='font-size:9.0pt;
  line-height:112%'> Type browseInfo </span><i><span style='font-size:9.0pt;
  line-height:112%;color:green'>'used by apiBrowseForFolder </span></i><span
  style='font-size:9.0pt;line-height:112%'>hOwner </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long </span><span style='font-size:9.0pt;
  line-height:112%'>pidlRoot </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Long </span><span style='font-size:9.0pt;line-height:112%'>pszDisplayName
  </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>String </span><span style='font-size:9.0pt;
  line-height:112%'>lpszTitle </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>String </span><span style='font-size:9.0pt;line-height:112%'>ulFlags
  </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long </span><span style='font-size:9.0pt;
  line-height:112%'>lpfn </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Long </span><span style='font-size:9.0pt;line-height:112%'>lParam
  </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long </span><span style='font-size:9.0pt;
  line-height:112%'>iImage </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Long </span><span style='font-size:9.0pt;line-height:112%'></span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>End</span></b><span
  style='font-size:9.0pt;line-height:112%'> Type</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Private</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Declare</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Function</span></b><span
  style='font-size:9.0pt;line-height:107%'> apiBrowseForFolder </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Lib</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:brown'>&quot;Shell32&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Alias</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;line-height:
  107%;color:brown'>&quot;SHBrowseForFolderA&quot;</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>(lpBrowseInfo </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> browseInfo) </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:6.8pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:112%'><span style='font-size:
  9.0pt;line-height:112%'> </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Private</span></b><span style='font-size:9.0pt;
  line-height:112%'> Type CHOOSECOLOR </span><i><span style='font-size:9.0pt;
  line-height:112%;color:green'>'used by apiChooseColor;
  http://support.microsoft.com/kb/153929 and
  http://www.cpearson.com/Excel/Colors.aspx </span></i><span style='font-size:
  9.0pt;line-height:112%'>lStructSize </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Long </span><span style='font-size:9.0pt;line-height:112%'>hWndOwner
  </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long </span><span style='font-size:9.0pt;
  line-height:112%'>hInstance </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Long </span><span style='font-size:9.0pt;line-height:112%'>rgbResult
  </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long </span><span style='font-size:9.0pt;
  line-height:112%'>lpCustColors </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>String </span><span style='font-size:9.0pt;line-height:112%'>flags
  </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long </span><span style='font-size:9.0pt;
  line-height:112%'>lCustData </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Long </span><span style='font-size:9.0pt;line-height:112%'>lpfnHook
  </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:344.6pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:112%'><span style='font-size:
  9.0pt;line-height:112%'> lpTemplateName </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>String </span><span style='font-size:9.0pt;
  line-height:112%'></span><b><span style='font-size:9.0pt;line-height:
  112%;color:blue'>End</span></b><span style='font-size:9.0pt;line-height:112%'>
  Type</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Private</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Declare</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Function</span></b><span
  style='font-size:9.0pt;line-height:107%'> apiChooseColor </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Lib</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:brown'>&quot;ComDlg32&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Alias</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;line-height:
  107%;color:brown'>&quot;ChooseColorA&quot;</span><span style='font-size:9.0pt;
  line-height:107%'> (pChoosecolor </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>CHOOSECOLOR) </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:16.45pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:112%'><span style='font-size:
  9.0pt;line-height:112%'> </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Private</span></b><span style='font-size:9.0pt;
  line-height:112%'> Type FindWindowParameters </span><i><span
  style='font-size:9.0pt;line-height:112%;color:green'>'Custom structure for
  passing in the parameters in/out of the hook enumeration function; could use
  global variables instead, but this is nicer </span></i><span
  style='font-size:9.0pt;line-height:112%'>strTitle </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>String</span><span style='font-size:9.0pt;
  line-height:112%'> </span><i><span style='font-size:9.0pt;line-height:112%;
  color:green'>'INPUT </span></i><span style='font-size:9.0pt;line-height:112%'>hWnd
  </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long</span><span style='font-size:9.0pt;
  line-height:112%'> </span><i><span style='font-size:9.0pt;line-height:
  112%;color:green'>'OUTPUT</span></i></p>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:112%'><span style='font-size:9.0pt;line-height:
  112%'> </span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>End</span></b><span
  style='font-size:9.0pt;line-height:112%'> Type </span><i><span
  style='font-size:9.0pt;line-height:112%;color:green'>'Find a specific window
  with dynamic caption from a list of all open windows:</span></i></p>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:112%'><i><span style='font-size:9.0pt;line-height:
  112%;color:green'>http://www.everythingaccess.com/tutorials.asp?ID=Bring-an-external-application-window-to-the-foregrou
  nd</span></i></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Private</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Declare</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Function</span></b><span
  style='font-size:9.0pt;line-height:107%'> apiEnumWindows </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Lib</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:brown'>&quot;User32&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Alias</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;line-height:
  107%;color:brown'>&quot;EnumWindows&quot;</span><span style='font-size:9.0pt;
  line-height:107%'> (</span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:107%'>
  lpEnumFunc </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>As</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%;color:slateblue'>Long</span><span style='font-size:
  9.0pt;line-height:107%'>, </span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>ByVal</span></b><span style='font-size:9.0pt;line-height:
  107%'> lParam </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>As</span></b><span style='font-size:9.0pt;line-height:107%'> </span><span
  style='font-size:9.0pt;line-height:107%;color:slateblue'>Long</span><span
  style='font-size:9.0pt;line-height:107%'>) </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><span style='font-size:9.0pt;line-height:107%;
  color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:117.75pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:112%'><span style='font-size:
  9.0pt;line-height:112%'> </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>Private</span></b><span style='font-size:9.0pt;
  line-height:112%'> Type lastInputInfo </span><i><span style='font-size:9.0pt;
  line-height:112%;color:green'>'used by apiGetLastInputInfo, getLastInputTime </span></i><span
  style='font-size:9.0pt;line-height:112%'>cbSize </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long </span><span style='font-size:9.0pt;
  line-height:112%'>dwTime </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Long </span><span style='font-size:9.0pt;line-height:112%'></span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>End</span></b><span
  style='font-size:9.0pt;line-height:112%'> Type</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Private</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Declare</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Function</span></b><span
  style='font-size:9.0pt;line-height:107%'> apiGetLastInputInfo </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Lib</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:brown'>&quot;User32&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Alias</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;line-height:
  107%;color:brown'>&quot;GetLastInputInfo&quot;</span><span style='font-size:
  9.0pt;line-height:107%'> (</span><b><span style='font-size:9.0pt;line-height:
  107%;color:blue'>ByRef</span></b><span style='font-size:9.0pt;line-height:
  107%'> plii</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:344.55pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:112%'><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> lastInputInfo) </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Long </span><span style='font-size:9.0pt;
  line-height:112%'></span><b><span style='font-size:9.0pt;line-height:
  112%;color:blue'>Private</span></b><span style='font-size:9.0pt;line-height:
  112%'> Type SystemTime wYear </span><b><span
  style='font-size:9.0pt;line-height:112%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:112%'> </span><span style='font-size:9.0pt;
  line-height:112%;color:slateblue'>Integer </span><span style='font-size:9.0pt;
  line-height:112%'>wMonth </span><b><span style='font-size:
  9.0pt;line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Integer </span><span style='font-size:9.0pt;line-height:
  112%'>wDayOfWeek </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Integer </span><span style='font-size:9.0pt;line-height:
  112%'>wDay </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Integer </span><span style='font-size:9.0pt;line-height:
  112%'>wHour </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Integer </span><span style='font-size:9.0pt;line-height:
  112%'>wMinute </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Integer </span><span style='font-size:9.0pt;line-height:
  112%'>wSecond </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Integer </span><span style='font-size:9.0pt;line-height:
  112%'>wMilliseconds </span><b><span style='font-size:9.0pt;
  line-height:112%;color:blue'>As</span></b><span style='font-size:9.0pt;
  line-height:112%'> </span><span style='font-size:9.0pt;line-height:112%;
  color:slateblue'>Integer </span><span style='font-size:9.0pt;line-height:
  112%'></span><b><span style='font-size:9.0pt;line-height:112%;color:blue'>End</span></b><span
  style='font-size:9.0pt;line-height:112%'> Type</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Private</span></b><span style='font-size:9.0pt;
  line-height:107%'> </span><b><span style='font-size:9.0pt;line-height:107%;
  color:blue'>Declare</span></b><span style='font-size:9.0pt;line-height:107%'>
  </span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>Sub</span></b><span
  style='font-size:9.0pt;line-height:107%'> apiGetLocalTime </span><b><span
  style='font-size:9.0pt;line-height:107%;color:blue'>Lib</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:brown'>&quot;Kernel32&quot;</span><span
  style='font-size:9.0pt;line-height:107%'> </span><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>Alias</span></b><span style='font-size:
  9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;line-height:
  107%;color:brown'>&quot;GetLocalTime&quot;</span><span style='font-size:9.0pt;
  line-height:107%'> (lpSystem </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>As</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'>SystemTime)</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  9.0pt;line-height:107%'> </span><b><span style='font-size:9.0pt;
  line-height:107%;color:blue'>Private</span></b><span style='font-size:9.0pt;
  line-height:107%'> Type pointAPI</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:.15in;text-indent:-.15in;line-height:107%'><span
  style='font-size:9.0pt;line-height:107%'>X<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
  </span></span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.45pt;
  margin-left:.15in;text-indent:-.15in;line-height:107%'><span
  style='font-size:9.0pt;line-height:107%'>Y<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
  </span></span><b><span style='font-size:9.0pt;line-height:107%;color:blue'>As</span></b><span
  style='font-size:9.0pt;line-height:107%'> </span><span style='font-size:9.0pt;
  line-height:107%;color:slateblue'>Long</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
  margin-left:.3in;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.0pt;line-height:107%;color:blue'>End</span></b><span style='font-size:9.0pt;
  line-height:107%'> Type</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:-24.65pt;margin-bottom:
0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%'><img border=0 width=719 height=448
src="VBA%20Notes%20for%20Professionals_files/image495.gif"></span><br
clear=all style='page-break-before:always'>
</p>

<h1 style='margin-left:-.25pt'><a name="_Toc308855">Credits</a></h1>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:0in;
margin-bottom:2.45pt;margin-left:12.65pt;text-align:center;line-height:103%'>Thank
you greatly to all the people from Stack Overflow Documentation who helped
provide this content, more changes can be sent to <u><span style='color:#193C96'>web@petercv.com</span></u>
for new content to be published or updated</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=568
 style='width:426.1pt;margin-left:1.0pt;border-collapse:collapse'>
 <tr style='height:12.55pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:12.55pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/4539709/"><span style='color:#193C96'>0m3r</span></a></p>
  </td>
  <td width=398 valign=top style='width:298.6pt;padding:0in 0in 0in 0in;
  height:12.55pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapters
  1 and 36</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/447485/"><span style='color:#193C96'>Andy
  Terra</span></a></p>
  </td>
  <td width=398 valign=top style='width:298.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  1</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/6476653/"><span style='color:#193C96'>Benno
  Grimm</span></a></p>
  </td>
  <td width=398 valign=top style='width:298.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapters
  1 and 7</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/2832561/"><span style='color:#193C96'>Blackhawk</span></a></p>
  </td>
  <td width=398 valign=top style='width:298.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  37</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/6548647/"><span style='color:#193C96'>Bookeater</span></a></p>
  </td>
  <td width=398 valign=top style='width:298.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  1</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/4636801/"><span style='color:#193C96'>Branislav
  Kollr</span></a></p>
  </td>
  <td width=398 valign=top style='width:298.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapters
  34, 35 and 42</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/4088852/"><span style='color:#193C96'>Comintern</span></a></p>
  </td>
  <td width=398 valign=top style='width:298.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapters
  2, 3, 6, 9, 10, 13, 14, 15, 20, 23, 25, 31, 32 and 33</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/2808645/"><span style='color:#193C96'>dadde</span></a></p>
  </td>
  <td width=398 valign=top style='width:298.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  2</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/6255978/"><span style='color:#193C96'>Dave</span></a></p>
  </td>
  <td width=398 valign=top style='width:298.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapters
  2, 3 and 9</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/5412719/"><span style='color:#193C96'>Derpcode</span></a></p>
  </td>
  <td width=398 valign=top style='width:298.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  1</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/2344413/"><span style='color:#193C96'>FreeMan</span></a></p>
  </td>
  <td width=398 valign=top style='width:298.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapters
  13 and 25</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/2509848/"><span style='color:#193C96'>Hosch250</span></a></p>
  </td>
  <td width=398 valign=top style='width:298.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  8</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1365754/"><span style='color:#193C96'>Hubisan</span></a></p>
  </td>
  <td width=398 valign=top style='width:298.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  9</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/2981328/"><span style='color:#193C96'>hymced</span></a></p>
  </td>
  <td width=398 valign=top style='width:298.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  28</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/7420518/"><span style='color:#193C96'>IvenBach</span></a></p>
  </td>
  <td width=398 valign=top style='width:298.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  30</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/4039065/"><span style='color:#193C96'>Jeeped</span></a></p>
  </td>
  <td width=398 valign=top style='width:298.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapters
  2, 23 and 24</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/4169411/"><span style='color:#193C96'>Kaz</span></a></p>
  </td>
  <td width=398 valign=top style='width:298.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapters
  2 and 5</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/4043845/"><span style='color:#193C96'>Kyle</span></a></p>
  </td>
  <td width=398 valign=top style='width:298.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  23</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/5043393/"><span style='color:#193C96'>LiamH</span></a></p>
  </td>
  <td width=398 valign=top style='width:298.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  6</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/3072566/"><span style='color:#193C96'>litelite</span></a></p>
  </td>
  <td width=398 valign=top style='width:298.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapters
  1 and 7</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/6563468/"><span style='color:#193C96'>Logan
  Reed</span></a></p>
  </td>
  <td width=398 valign=top style='width:298.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  10</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/4721734/"><span style='color:#193C96'>Mt
  Juhsz</span></a></p>
  </td>
  <td width=398 valign=top style='width:298.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  1</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/5793786/"><span style='color:#193C96'>Maarten
  van Stam</span></a></p>
  </td>
  <td width=398 valign=top style='width:298.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapters
  1, 9 and 24</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/4240221/"><span style='color:#193C96'>Macro
  Man</span></a></p>
  </td>
  <td width=398 valign=top style='width:298.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapters
  1, 4, 7, 12 and 24</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/5773890/"><span style='color:#193C96'>Mark.R</span></a></p>
  </td>
  <td width=398 valign=top style='width:298.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapters
  2 and 44</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/6627047/"><span style='color:#193C96'>Martin</span></a></p>
  </td>
  <td width=398 valign=top style='width:298.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  7</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1188513/"><span style='color:#193C96'>Mathieu
  Guindon</span></a></p>
  </td>
  <td width=398 valign=top style='width:298.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapters
  2, 4, 5, 6, 7, 9, 10, 18, 24, 27, 28, 29, 30, 34 and 43</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/3005534/"><span style='color:#193C96'>Miguel_Ryu</span></a></p>
  </td>
  <td width=398 valign=top style='width:298.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  9</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/2103496/"><span style='color:#193C96'>Neil
  Mussett</span></a></p>
  </td>
  <td width=398 valign=top style='width:298.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapters
  2, 4, 13, 26, 38, 40 and 45</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1641172/"><span style='color:#193C96'>Nick
  Dewitt</span></a></p>
  </td>
  <td width=398 valign=top style='width:298.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  1</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/141947/"><span style='color:#193C96'>pashute</span></a></p>
  </td>
  <td width=398 valign=top style='width:298.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  41</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/2636247/"><span style='color:#193C96'>PatricK</span></a></p>
  </td>
  <td width=398 valign=top style='width:298.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  39</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/4914662/"><span style='color:#193C96'>paul
  bica</span></a></p>
  </td>
  <td width=398 valign=top style='width:298.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  46</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/4628637/"><span style='color:#193C96'>R3uK</span></a></p>
  </td>
  <td width=398 valign=top style='width:298.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  34</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/2485248/"><span style='color:#193C96'>Roland</span></a></p>
  </td>
  <td width=398 valign=top style='width:298.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  7</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/3198973/"><span style='color:#193C96'>RubberDuck</span></a></p>
  </td>
  <td width=398 valign=top style='width:298.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapters
  3, 12, 24 and 28</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/6186333/"><span style='color:#193C96'>SandPiper</span></a></p>
  </td>
  <td width=398 valign=top style='width:298.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  31</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/2821274/"><span style='color:#193C96'>Shawn
  V. Wilson</span></a></p>
  </td>
  <td width=398 valign=top style='width:298.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapters
  2 and 8</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/7509720/"><span style='color:#193C96'>Sivaprasath
  Vadivel</span></a></p>
  </td>
  <td width=398 valign=top style='width:298.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  6</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/5776000/"><span style='color:#193C96'>Stefan
  Pinnow</span></a></p>
  </td>
  <td width=398 valign=top style='width:298.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapters
  1 and 24</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1667023/"><span style='color:#193C96'>Steve
  Rindsberg</span></a></p>
  </td>
  <td width=398 valign=top style='width:298.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapters
  3, 12 and 19</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/1240154/"><span style='color:#193C96'>SWa</span></a></p>
  </td>
  <td width=398 valign=top style='width:298.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  2</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/4687028/"><span style='color:#193C96'>Tazaf</span></a></p>
  </td>
  <td width=398 valign=top style='width:298.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  9</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/2043349/"><span style='color:#193C96'>Thierry
  Dalon</span></a></p>
  </td>
  <td width=398 valign=top style='width:298.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  2</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/4197505/"><span style='color:#193C96'>Thomas
  G</span></a></p>
  </td>
  <td width=398 valign=top style='width:298.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapters
  24 and 25</p>
  </td>
 </tr>
 <tr style='height:14.5pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/5757159/"><span style='color:#193C96'>ThunderFrame</span></a></p>
  </td>
  <td width=398 valign=top style='width:298.6pt;padding:0in 0in 0in 0in;
  height:14.5pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'>Chapters 2, 3, 7, 8, 11, 13, 14, 15, 16,
  17, 18, 19, 21, 22, 24 and 26</p>
  </td>
 </tr>
 <tr style='height:12.55pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:12.55pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/5094258/"><span style='color:#193C96'>Tim</span></a></p>
  </td>
  <td width=398 valign=top style='width:298.6pt;padding:0in 0in 0in 0in;
  height:12.55pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  35</p>
  </td>
 </tr>
</table>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=239 style='width:178.9pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:12.55pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:12.55pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/4583203/"><span style='color:#193C96'>Tom
  K.</span></a></p>
  </td>
  <td width=69 valign=top style='width:51.4pt;padding:0in 0in 0in 0in;
  height:12.55pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>Chapter
  2</p>
  </td>
 </tr>
 <tr style='height:12.55pt'>
  <td width=170 valign=top style='width:127.5pt;padding:0in 0in 0in 0in;
  height:12.55pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><a
  href="https://stackoverflow.com/users/111794/"><span style='color:#193C96'>Zev
  Spitz</span></a></p>
  </td>
  <td width=69 valign=top style='width:51.4pt;padding:0in 0in 0in 0in;
  height:12.55pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'>Chapter 23</p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:334.0pt;margin-bottom:
0in;margin-left:-28.35pt;text-indent:0in;line-height:107%'>&nbsp;</p>

</div>

<span style='font-size:10.0pt;line-height:110%;font-family:"Calibri",sans-serif;
color:black'><br clear=all style='page-break-before:always'>
</span>

<div class=WordSection5>

<h1 style='margin-left:-43.15pt'><a name="_Toc308856">You may also like</a></h1>

<p class=MsoNormal style='margin-top:0in;margin-right:-45.95pt;margin-bottom:
0in;margin-left:-47.25pt;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%'><img border=0 width=726 height=992
id="Group 296916" src="VBA%20Notes%20for%20Professionals_files/image496.gif"></span></p>

</div>

</body>

</html>
