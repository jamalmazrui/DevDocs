<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=Generator content="Microsoft Word 15 (filtered)">
<title>Dive Into Python 3</title>
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Helvetica;
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:Courier;
	panose-1:2 7 4 9 2 2 5 2 4 4;}
@font-face
	{font-family:"Tms Rmn";
	panose-1:2 2 6 3 4 5 5 2 3 4;}
@font-face
	{font-family:Helv;
	panose-1:2 11 6 4 2 2 2 3 2 4;}
@font-face
	{font-family:"New York";
	panose-1:2 4 5 3 6 5 6 2 3 4;}
@font-face
	{font-family:System;
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"MS Mincho";
	panose-1:2 2 6 9 4 2 5 8 3 4;}
@font-face
	{font-family:Batang;
	panose-1:2 3 6 0 0 1 1 1 1 1;}
@font-face
	{font-family:SimSun;
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:PMingLiU;
	panose-1:2 1 6 1 0 1 1 1 1 1;}
@font-face
	{font-family:"MS Gothic";
	panose-1:2 11 6 9 7 2 5 8 2 4;}
@font-face
	{font-family:Dotum;
	panose-1:2 11 6 0 0 1 1 1 1 1;}
@font-face
	{font-family:SimHei;
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:MingLiU;
	panose-1:2 1 6 9 0 1 1 1 1 1;}
@font-face
	{font-family:Mincho;
	panose-1:2 2 6 9 4 3 5 8 3 5;}
@font-face
	{font-family:Gulim;
	panose-1:2 11 6 0 0 1 1 1 1 1;}
@font-face
	{font-family:Century;
	panose-1:2 4 6 4 5 5 5 2 3 4;}
@font-face
	{font-family:"Angsana New";
	panose-1:2 2 6 3 5 4 5 2 3 4;}
@font-face
	{font-family:"Cordia New";
	panose-1:2 11 3 4 2 2 2 2 2 4;}
@font-face
	{font-family:Mangal;
	panose-1:0 0 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:Latha;
	panose-1:2 0 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:Sylfaen;
	panose-1:1 10 5 2 5 3 6 3 3 3;}
@font-face
	{font-family:Vrinda;
	panose-1:0 0 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:Raavi;
	panose-1:2 0 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:Shruti;
	panose-1:2 0 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:Sendnya;
	panose-1:0 0 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:Gautami;
	panose-1:2 0 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:Tunga;
	panose-1:0 0 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Estrangelo Edessa";
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:"Yu Gothic";
	panose-1:2 11 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:DengXian;
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:"Calibri Light";
	panose-1:2 15 3 2 2 2 4 3 2 4;}
@font-face
	{font-family:"Palatino Linotype";
	panose-1:2 4 5 2 5 5 5 3 3 4;}
@font-face
	{font-family:Verdana;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
	{font-family:"Arial Unicode MS";
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:"Aptos Display";}
@font-face
	{font-family:Aptos;}
@font-face
	{font-family:"Segoe UI Emoji";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Gill Sans MT";
	panose-1:2 11 5 2 2 1 4 2 2 3;}
@font-face
	{font-family:"Liberation Mono";
	panose-1:2 7 4 9 2 2 5 2 4 4;}
@font-face
	{font-family:"DejaVu Serif";
	panose-1:2 6 6 3 5 6 5 2 2 4;}
@font-face
	{font-family:"DejaVu Sans";
	panose-1:2 11 6 3 3 8 4 2 2 4;}
@font-face
	{font-family:"Segoe UI Symbol";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:.25pt;
	margin-left:12.75pt;
	text-indent:-.5pt;
	line-height:154%;
	font-size:12.0pt;
	font-family:"Gill Sans MT",sans-serif;
	color:black;}
h1
	{mso-style-link:"Heading 1 Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:12.75pt;
	text-indent:-.5pt;
	line-height:107%;
	page-break-after:avoid;
	font-size:19.0pt;
	font-family:"DejaVu Serif",serif;
	color:black;}
h2
	{mso-style-link:"Heading 2 Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:17.35pt;
	margin-left:12.75pt;
	text-indent:-.5pt;
	line-height:112%;
	page-break-after:avoid;
	font-size:14.5pt;
	font-family:"DejaVu Serif",serif;
	color:black;}
h3
	{mso-style-link:"Heading 3 Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:17.35pt;
	margin-left:12.75pt;
	text-indent:-.5pt;
	line-height:112%;
	page-break-after:avoid;
	font-size:14.5pt;
	font-family:"DejaVu Serif",serif;
	color:black;}
h4
	{mso-style-link:"Heading 4 Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:17.35pt;
	margin-left:12.75pt;
	text-indent:-.5pt;
	line-height:112%;
	page-break-after:avoid;
	font-size:14.5pt;
	font-family:"DejaVu Serif",serif;
	color:black;}
h5
	{mso-style-link:"Heading 5 Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:17.35pt;
	margin-left:12.75pt;
	text-indent:-.5pt;
	line-height:112%;
	page-break-after:avoid;
	font-size:14.5pt;
	font-family:"DejaVu Serif",serif;
	color:black;}
h6
	{mso-style-link:"Heading 6 Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:25.25pt;
	margin-left:17.15pt;
	text-indent:-.5pt;
	line-height:110%;
	page-break-after:avoid;
	font-size:10.5pt;
	font-family:"DejaVu Serif",serif;
	color:black;}
p.MsoHeading7, li.MsoHeading7, div.MsoHeading7
	{mso-style-link:"Heading 7 Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:25.25pt;
	margin-left:17.15pt;
	text-indent:-.5pt;
	line-height:110%;
	page-break-after:avoid;
	font-size:10.5pt;
	font-family:"DejaVu Serif",serif;
	color:black;
	font-weight:bold;}
p.MsoHeading8, li.MsoHeading8, div.MsoHeading8
	{mso-style-link:"Heading 8 Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:.35in;
	margin-left:17.15pt;
	text-indent:-.5pt;
	line-height:122%;
	page-break-after:avoid;
	font-size:13.0pt;
	font-family:"Liberation Mono";
	color:black;}
span.Heading8Char
	{mso-style-name:"Heading 8 Char";
	mso-style-link:"Heading 8";
	font-family:"Liberation Mono";
	color:black;}
span.Heading1Char
	{mso-style-name:"Heading 1 Char";
	mso-style-link:"Heading 1";
	font-family:"DejaVu Serif",serif;
	color:black;
	font-weight:bold;}
span.Heading6Char
	{mso-style-name:"Heading 6 Char";
	mso-style-link:"Heading 6";
	font-family:"DejaVu Serif",serif;
	color:black;
	font-weight:bold;}
span.Heading7Char
	{mso-style-name:"Heading 7 Char";
	mso-style-link:"Heading 7";
	font-family:"DejaVu Serif",serif;
	color:black;
	font-weight:bold;}
span.Heading2Char
	{mso-style-name:"Heading 2 Char";
	mso-style-link:"Heading 2";
	font-family:"DejaVu Serif",serif;
	color:black;
	font-weight:bold;}
span.Heading3Char
	{mso-style-name:"Heading 3 Char";
	mso-style-link:"Heading 3";
	font-family:"DejaVu Serif",serif;
	color:black;
	font-weight:bold;}
span.Heading5Char
	{mso-style-name:"Heading 5 Char";
	mso-style-link:"Heading 5";
	font-family:"DejaVu Serif",serif;
	color:black;
	font-weight:bold;}
span.Heading4Char
	{mso-style-name:"Heading 4 Char";
	mso-style-link:"Heading 4";
	font-family:"DejaVu Serif",serif;
	color:black;
	font-weight:bold;}
span.msoIns
	{mso-style-name:"";
	text-decoration:underline;
	color:#65B4B4;}
span.msoDel
	{mso-style-name:"";
	text-decoration:line-through;
	color:#FF4B4B;}
.MsoChpDefault
	{font-size:12.0pt;}
.MsoPapDefault
	{margin-bottom:8.0pt;
	line-height:115%;}
 /* Page Definitions */
 @page WordSection1
	{size:8.5in 11.0in;
	margin:33.55pt 30.0pt 50.0pt 17.75pt;}
div.WordSection1
	{page:WordSection1;}
@page WordSection2
	{size:8.5in 11.0in;
	margin:33.55pt 33.05pt 47.95pt 14.9pt;}
div.WordSection2
	{page:WordSection2;}
@page WordSection3
	{size:8.5in 11.0in;
	margin:26.55pt 30.0pt 44.1pt 13.35pt;}
div.WordSection3
	{page:WordSection3;}
@page WordSection4
	{size:8.5in 11.0in;
	margin:33.55pt 31.15pt 60.6pt 13.35pt;}
div.WordSection4
	{page:WordSection4;}
@page WordSection5
	{size:8.5in 11.0in;
	margin:34.85pt 35.7pt 173.8pt 13.35pt;}
div.WordSection5
	{page:WordSection5;}
@page WordSection6
	{size:8.5in 11.0in;
	margin:33.55pt 32.45pt 62.8pt 13.35pt;}
div.WordSection6
	{page:WordSection6;}
@page WordSection7
	{size:8.5in 11.0in;
	margin:32.2pt 0in 43.15pt 13.35pt;}
div.WordSection7
	{page:WordSection7;}
@page WordSection8
	{size:8.5in 11.0in;
	margin:34.85pt 30.45pt 40.05pt 13.35pt;}
div.WordSection8
	{page:WordSection8;}
@page WordSection9
	{size:8.5in 11.0in;
	margin:31.8pt 30.0pt 37.75pt 13.35pt;}
div.WordSection9
	{page:WordSection9;}
@page WordSection10
	{size:8.5in 11.0in;
	margin:33.5pt 30.05pt 63.6pt 13.35pt;}
div.WordSection10
	{page:WordSection10;}
@page WordSection11
	{size:8.5in 11.0in;
	margin:26.55pt 30.0pt 37.75pt 13.35pt;}
div.WordSection11
	{page:WordSection11;}
@page WordSection12
	{size:8.5in 11.0in;
	margin:1.0in 56.4pt 1.0in 13.35pt;}
div.WordSection12
	{page:WordSection12;}
@page WordSection13
	{size:8.5in 11.0in;
	margin:26.55pt 0in 40.05pt 13.35pt;}
div.WordSection13
	{page:WordSection13;}
@page WordSection14
	{size:8.5in 11.0in;
	margin:34.85pt 33.45pt 72.55pt 13.35pt;}
div.WordSection14
	{page:WordSection14;}
@page WordSection15
	{size:8.5in 11.0in;
	margin:33.55pt 33.35pt 48.5pt 13.35pt;}
div.WordSection15
	{page:WordSection15;}
@page WordSection16
	{size:8.5in 11.0in;
	margin:30.4pt 0in 38.75pt 13.35pt;}
div.WordSection16
	{page:WordSection16;}
@page WordSection17
	{size:8.5in 11.0in;
	margin:33.75pt 31.0pt 44.8pt 13.35pt;}
div.WordSection17
	{page:WordSection17;}
@page WordSection18
	{size:8.5in 11.0in;
	margin:31.5pt 0in 35.55pt 13.35pt;}
div.WordSection18
	{page:WordSection18;}
@page WordSection19
	{size:8.5in 11.0in;
	margin:33.5pt 0in 63.6pt 13.35pt;}
div.WordSection19
	{page:WordSection19;}
@page WordSection20
	{size:8.5in 11.0in;
	margin:33.5pt 0in 42.55pt 13.35pt;}
div.WordSection20
	{page:WordSection20;}
@page WordSection21
	{size:8.5in 11.0in;
	margin:33.55pt 26.45pt 51.5pt 13.35pt;}
div.WordSection21
	{page:WordSection21;}
@page WordSection22
	{size:8.5in 11.0in;
	margin:30.0pt 0in 50.05pt 13.35pt;}
div.WordSection22
	{page:WordSection22;}
@page WordSection23
	{size:8.5in 11.0in;
	margin:26.55pt 0in 39.55pt 13.35pt;}
div.WordSection23
	{page:WordSection23;}
@page WordSection24
	{size:8.5in 11.0in;
	margin:54.5pt 15.6pt 42.8pt 13.35pt;}
div.WordSection24
	{page:WordSection24;}
@page WordSection25
	{size:8.5in 11.0in;
	margin:26.55pt 0in 36.55pt 13.35pt;}
div.WordSection25
	{page:WordSection25;}
@page WordSection26
	{size:8.5in 11.0in;
	margin:30.0pt 23.85pt 37.4pt 13.35pt;}
div.WordSection26
	{page:WordSection26;}
@page WordSection27
	{size:8.5in 11.0in;
	margin:30.0pt 33.1pt 38.6pt 13.35pt;}
div.WordSection27
	{page:WordSection27;}
@page WordSection28
	{size:8.5in 11.0in;
	margin:30.0pt 30.0pt 34.2pt 13.35pt;}
div.WordSection28
	{page:WordSection28;}
 /* List Definitions */
 ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>

</head>

<body lang=EN-US style='word-wrap:break-word'>

<div class=WordSection1>

<h1 style='margin-right:22.2pt'><span style='font-size:24.0pt;line-height:107%'>C</span>HAPTER
<span style='font-size:24.0pt;line-height:107%'>-1. W</span>HAT<span
style='font-size:24.0pt;line-height:107%'>’</span>S <span style='font-size:
24.0pt;line-height:107%'>N</span>EW <span style='font-size:24.0pt;line-height:
107%'>I</span>N <span style='font-size:24.0pt;line-height:107%'>“D</span>IVE <span
style='font-size:24.0pt;line-height:107%'>I</span>NTO <span style='font-size:
24.0pt;line-height:107%'>P</span>YTHON <span style='font-size:24.0pt;
line-height:107%'>3”</span></h1>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:40.0pt;
margin-left:12.25pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img width=736
height=4 id="Group 615551" src="Dive%20Into%20Python%203_files/image001.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:66.15pt;
margin-left:451.95pt;text-indent:-47.25pt;line-height:160%'><span
style='font-size:13.0pt;line-height:160%;font-family:"Calibri",sans-serif'>&#10077;
</span><i>Isn’t this where we came in? </i><span style='font-size:13.0pt;
line-height:160%;font-family:"Calibri",sans-serif'>&#10078; </span><i>— Pink
Floyd, The Wall</i></p>

<h2 style='margin-bottom:66.4pt'><span style='font-size:18.0pt;line-height:
112%'>-1.1. </span><i>A</i><i><span style='font-size:18.0pt;line-height:112%'>.</span>K</i><i><span
style='font-size:18.0pt;line-height:112%'>.</span>A</i><i><span
style='font-size:18.0pt;line-height:112%'>. </span></i><span style='font-size:
18.0pt;line-height:112%'>“</span>THE MINUS LEVEL<span style='font-size:18.0pt;
line-height:112%'>”</span></h2>

<p class=MsoNormal style='margin-bottom:17.25pt;line-height:179%'><span
style='font-size:48.0pt;line-height:179%;font-family:"DejaVu Serif",serif;
color:#888888'>A </span>re you already a Python programmer? Did you read the
original “<a href="http://diveintopython.org/"><span style='color:black'>Dive</span></a><u>
</u><a href="http://diveintopython.org/"><span style='color:black'>Into</span></a><u>
</u><a href="http://diveintopython.org/"><span style='color:black'>Python</span></a>”?
Did you buy it on paper? (If so, thanks!) Are you ready to take the plunge into
Python 3? … If so, read on. (If none of that is true, you’d be better off <u>starting
at the beginning</u>.)</p>

<p class=MsoNormal style='margin-bottom:19.25pt'>Python 3 comes with a script
called <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>2to3</span>.
Learn it. Love it. Use it. <u>Porting Code to Python 3 with </u><u><span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>2to3 </span></u>is
a reference of all the things that the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>2to3 </span>tool can fix
automatically. Since a lot of those things are syntax changes, it’s a good
starting point to learn about a lot of the syntax changes in Python 3. (<span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>print </span>is
now a function, <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>`x` </span>doesn’t work, <i><span style='font-size:13.0pt;
line-height:154%;font-family:"DejaVu Serif",serif'>&amp;</span></i>c.)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:20.55pt;
margin-left:12.75pt'><u>Case Study: Porting </u><u><span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>chardet </span>to Python 3 </u>documents
my (ultimately successful) effort to port a non-trivial library from Python 2
to Python 3. It may help you; it may not. There’s a fairly steep learning
curve, since you need to kind of understand the library first, so you can
understand why it broke and how I fixed it. A lot of the breakage centers
around strings. Speaking of which…</p>

<p class=MsoNormal style='margin-top:0in;margin-right:4.0pt;margin-bottom:20.55pt;
margin-left:12.75pt'>Strings. Whew. Where to start. Python 2 had “strings” and
“Unicode strings.” Python 3 has “bytes” and “strings.” That is, all strings are
now Unicode strings, and if you want to deal with a bag of bytes, you use the
new <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>bytes
</span>type. Python 3 will <i>never </i>implicitly convert between strings and
bytes, so if you’re not sure which one you have at any given moment, your code
will almost certainly break. Read <u>the Strings chapter </u>for more details.</p>

<p class=MsoNormal style='margin-right:30.5pt;line-height:107%'>Bytes vs.
strings comes up again and again throughout the book.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:15.25pt;margin-bottom:
.25pt;margin-left:12.25pt;text-indent:-12.25pt'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>In <u>Files</u>, you’ll learn the difference between reading files in
“binary” and “text” mode. Reading (and writing!) files in text mode requires an
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>encoding
</span>parameter. Some text file methods count characters, but other methods
count bytes. If your code assumes that one character == one byte, it <i>will </i>break
on multi-byte characters.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:15.25pt;margin-bottom:
.25pt;margin-left:12.25pt;text-indent:-12.25pt'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>In <u><span style='font-size:9.5pt;line-height:154%'>HTTP </span>Web
Services</u>, the <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>httplib2 </span>module fetches headers and data over <span
style='font-size:9.5pt;line-height:154%'>HTTP</span>. <span style='font-size:
9.5pt;line-height:154%'>HTTP </span>headers are returned as strings, but the <span
style='font-size:9.5pt;line-height:154%'>HTTP </span>body is returned as bytes.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:15.25pt;margin-bottom:
.25pt;margin-left:12.25pt;text-indent:-12.25pt'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>In <u>Serializing Python Objects</u>, you’ll learn why the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>pickle </span>module
in Python 3 defines a new data format that is backwardly incompatible with
Python 2. (Hint: it’s because of bytes and strings.) Also <span
style='font-size:9.5pt;line-height:154%'>JSON</span>, which doesn’t support the
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>bytes
</span>type at all. I’ll show you how to hack around that.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:15.25pt;margin-bottom:
21.5pt;margin-left:12.25pt;text-indent:-12.25pt'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>In <u>Case study: porting </u><u><span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>chardet </span>to Python 3</u>,
it’s just a bloody mess of bytes and strings everywhere.</p>

<p class=MsoNormal style='margin-bottom:20.55pt'>Even if you don’t care about
Unicode (oh but you will), you’ll want to read about <u>string formatting in
Python 3</u>, which is completely different from Python 2.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.1pt;margin-bottom:20.55pt;
margin-left:12.75pt'>Iterators are everywhere in Python 3, and I understand
them a lot better than I did five years ago when I wrote “Dive Into Python”.
You need to understand them too, because lots of functions that used to return
lists in Python 2 will now return iterators in Python 3. At a minimum, you
should read <u>the second half of the Iterators chapter </u>and <u>the second
half of the Advanced Iterators chapter</u>.</p>

<p class=MsoNormal style='margin-bottom:20.55pt'>By popular request, I’ve added
an appendix on <u>Special Method Names</u>, which is kind of like <a
href="http://www.python.org/doc/3.1/reference/datamodel.html#special-method-names"><span
style='color:black'>the</span></a><u> </u><a
href="http://www.python.org/doc/3.1/reference/datamodel.html#special-method-names"><span
style='color:black'>Python</span></a><u> </u><a
href="http://www.python.org/doc/3.1/reference/datamodel.html#special-method-names"><span
style='color:black'>docs </span></a><a
href="http://www.python.org/doc/3.1/reference/datamodel.html#special-method-names"><span
style='color:black'>“Data</span></a><u> </u><a
href="http://www.python.org/doc/3.1/reference/datamodel.html#special-method-names"><span
style='color:black'>Model”</span></a><u> </u><a
href="http://www.python.org/doc/3.1/reference/datamodel.html#special-method-names"><span
style='color:black'>chapter</span></a><u> </u>but with more snark.</p>

<p class=MsoNormal style='margin-bottom:20.55pt'>When I was writing “Dive Into
Python”, all of the available XML libraries sucked. Then Fredrik Lundh wrote <a
href="http://effbot.org/zone/element-index.htm"><span style='color:black'>ElementTree</span></a>,
which doesn’t suck at all. The Python gods wisely <a
href="http://docs.python.org/3.1/library/xml.etree.elementtree.html"><span
style='color:black'>incorporated</span></a><u> </u><a
href="http://docs.python.org/3.1/library/xml.etree.elementtree.html"><span
style='color:black'>ElementTree</span></a><u> </u><a
href="http://docs.python.org/3.1/library/xml.etree.elementtree.html"><span
style='color:black'>into</span></a><u> </u><a
href="http://docs.python.org/3.1/library/xml.etree.elementtree.html"><span
style='color:black'>the</span></a><u> </u><a
href="http://docs.python.org/3.1/library/xml.etree.elementtree.html"><span
style='color:black'>standard </span></a><a
href="http://docs.python.org/3.1/library/xml.etree.elementtree.html"><span
style='color:black'>library</span></a>, and now it forms the basis for <u>my
new XML chapter</u>. The old ways of parsing XML are still around, but you
should avoid them, because they suck!</p>

<p class=MsoNormal style='margin-right:.15pt'>Also new in Python — not in the
language but in the community — is the emergence of code repositories like <a
href="http://pypi.python.org/"><span style='color:black'>The</span></a><u> </u><a
href="http://pypi.python.org/"><span style='color:black'>Python</span></a><u> </u><a
href="http://pypi.python.org/"><span style='color:black'>Package</span></a><u> </u><a
href="http://pypi.python.org/"><span style='color:black'>Index</span></a><u> </u>(PyPI).
Python comes with utilities to package your code in standard formats and
distribute those packages on PyPI. Read <u>Packaging Python Libraries </u>for
details.</p>

<h1 style='margin-right:22.2pt'><span style='font-size:24.0pt;line-height:107%'>C</span>HAPTER
<span style='font-size:24.0pt;line-height:107%'>0. I</span>NSTALLING <span
style='font-size:24.0pt;line-height:107%'>P</span>YTHON</h1>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:39.9pt;
margin-left:12.25pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=736 height=4 id="Group 613233"
src="Dive%20Into%20Python%203_files/image001.gif"></span></p>

<p class=MsoNormal align=right style='margin-top:0in;margin-right:0in;
margin-bottom:65.45pt;margin-left:121.75pt;text-align:right;line-height:160%'><span
style='font-size:13.0pt;line-height:160%;font-family:"Calibri",sans-serif'>&#10077;
</span><i>Tempora mutantur nos et mutamur in illis. (Times change, and we
change with them.) </i><span style='font-size:13.0pt;line-height:160%;
font-family:"Calibri",sans-serif'>&#10078; </span><i>— ancient Roman proverb</i></p>

<h2 style='margin-bottom:65.6pt'><span style='font-size:18.0pt;line-height:
112%'>0.1. D</span>IVING <span style='font-size:18.0pt;line-height:112%'>I</span>N</h2>

<p class=MsoNormal style='margin-right:30.5pt;line-height:107%'><span
style='font-size:48.0pt;line-height:107%;font-family:"DejaVu Serif",serif;
color:#888888'>B </span>efore you can start programming in Python 3, you need
to install it. Or do you?</p>

<p class=MsoNormal style='margin-bottom:17.35pt;line-height:112%'><b><span
style='font-size:18.0pt;line-height:112%;font-family:"DejaVu Serif",serif'>0.2.
W</span></b><b><span style='font-size:14.5pt;line-height:112%;font-family:"DejaVu Serif",serif'>HICH
</span></b><b><span style='font-size:18.0pt;line-height:112%;font-family:"DejaVu Serif",serif'>P</span></b><b><span
style='font-size:14.5pt;line-height:112%;font-family:"DejaVu Serif",serif'>YTHON
</span></b><b><span style='font-size:18.0pt;line-height:112%;font-family:"DejaVu Serif",serif'>I</span></b><b><span
style='font-size:14.5pt;line-height:112%;font-family:"DejaVu Serif",serif'>S </span></b><b><span
style='font-size:18.0pt;line-height:112%;font-family:"DejaVu Serif",serif'>R</span></b><b><span
style='font-size:14.5pt;line-height:112%;font-family:"DejaVu Serif",serif'>IGHT
</span></b><b><span style='font-size:18.0pt;line-height:112%;font-family:"DejaVu Serif",serif'>F</span></b><b><span
style='font-size:14.5pt;line-height:112%;font-family:"DejaVu Serif",serif'>OR </span></b><b><span
style='font-size:18.0pt;line-height:112%;font-family:"DejaVu Serif",serif'>Y</span></b><b><span
style='font-size:14.5pt;line-height:112%;font-family:"DejaVu Serif",serif'>OU</span></b><b><span
style='font-size:18.0pt;line-height:112%;font-family:"DejaVu Serif",serif'>?</span></b></p>

<p class=MsoNormal style='margin-bottom:6.0pt;line-height:107%'>If you're using
an account on a hosted server, your <span style='font-size:9.5pt;line-height:
107%'>ISP </span>may have already installed Python 3. If you’re running</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:12.75pt;line-height:107%'>Linux at home, you may already have
Python 3, too. Most popular GNU/Linux distributions come with</p>

<p class=MsoNormal style='margin-bottom:20.55pt'>Python 2 in the default
installation; a small but growing number of distributions also include Python
3. Mac OS X includes a command-line version of Python 2, but as of this writing
it does not include Python 3. Microsoft Windows does not come with any version
of Python. But don’t despair! You can point-and-click your way through
installing Python, regardless of what operating system you have.</p>

<p class=MsoNormal style='margin-bottom:6.75pt;line-height:107%'>The easiest
way to check for Python 3 on your Linux or Mac OS X system is to get to a
command line. On</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.1in;margin-left:12.75pt;line-height:107%'>Linux, look in your <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>Applications
</span>menu for a program called <span style='font-size:10.0pt;line-height:
107%;font-family:"Liberation Mono"'>Terminal</span>. (It may be in a submenu
like</p>

<p class=MsoNormal style='margin-bottom:18.85pt;line-height:166%'><span
style='font-size:10.0pt;line-height:166%;font-family:"Liberation Mono"'>Accessories
</span>or <span style='font-size:10.0pt;line-height:166%;font-family:"Liberation Mono"'>System</span>.)
On Mac OS X, there is an application called <span style='font-size:10.0pt;
line-height:166%;font-family:"Liberation Mono"'>Terminal.app </span>in your <span
style='font-size:10.0pt;line-height:166%;font-family:"Liberation Mono"'>/Application/Utilities/
</span>folder.</p>

<p class=MsoNormal style='margin-right:2.95pt'>Once you’re at a command line
prompt, just type <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>python3 </span>(all lowercase, no spaces) and see what
happens. On my home Linux system, Python 3 is already installed, and this
command gets me into the <i>Python interactive shell</i>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.95in;margin-bottom:
8.5pt;margin-left:34.3pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#666677'>mark@atlantis:~$ </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>python3</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:34.3pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>Python 3.0.1+ (r301:69556, Apr 15 2009,
17:25:52)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:110.45pt;margin-bottom:
0in;margin-left:34.3pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>[GCC 4.3.3] on linux2 Type
&quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or
&quot;license&quot; for more information.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.7pt;
margin-left:34.3pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&gt;&gt;&gt;</span>&nbsp;</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
23.0pt;margin-left:12.75pt'>(Type <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>exit() </span>and press <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>ENTER </span>to
exit the Python interactive shell.)</p>

<p class=MsoNormal style='margin-bottom:6.0pt;line-height:107%'>My <a
href="http://cornerhost.com/"><span style='color:black'>web</span></a><u> </u><a
href="http://cornerhost.com/"><span style='color:black'>hosting</span></a><u> </u><a
href="http://cornerhost.com/"><span style='color:black'>provider</span></a><u> </u>also
runs Linux and provides command-line access, but my server does not have</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.9pt;margin-left:12.75pt'>Python 3 installed. (Boo!)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:338.45pt;margin-bottom:
22.55pt;margin-left:34.3pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>mark@manganese:~$
</span><span style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>python3
bash: python3: command not found</span></p>

<p class=MsoNormal style='margin-bottom:20.55pt'>So back to the question that
started this section, “Which Python is right for you?” Whichever one runs on
the computer you already have.</p>

<p class=MsoNormal style='margin-bottom:46.1pt;line-height:150%'>[Read on for
Windows instructions, or skip to <u>Installing on Mac OS X</u>, <u>Installing
on Ubuntu Linux</u>, or <u>Installing on Other Platforms</u>.]</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:7.8pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h2><span style='font-size:18.0pt;line-height:112%'>0.3. I</span>NSTALLING ON <span
style='font-size:18.0pt;line-height:112%'>M</span>ICROSOFT <span
style='font-size:18.0pt;line-height:112%'>W</span>INDOWS</h2>

<p class=MsoNormal style='margin-bottom:21.35pt'>Windows comes in two
architectures these days: 32-bit and 64-bit. Of course, there are lots of
different <i>versions </i>of Windows — XP, Vista, Windows 7 — but Python runs
on all of them. The more important distinction is 32-bit v. 64-bit. If you have
no idea what architecture you’re running, it’s probably 32-bit.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.55pt;margin-left:12.75pt'>Visit <a href="http://python.org/download/"><span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono";
color:black'>python.org/download/</span></a><u><span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'> </span></u>and download the
appropriate Python 3 Windows installer for your architecture. Your choices will
look something like this:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:12.25pt;text-indent:-12.25pt;line-height:107%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><b>Python 3.1 Windows
installer </b>(Windows binary — does not include source)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.45pt;margin-left:12.25pt;text-indent:-12.25pt'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span><b>Python 3.1 Windows AMD64 installer </b>(Windows AMD64 binary — does
not include source)</p>

<p class=MsoNormal style='margin-bottom:20.55pt'>I don’t want to include direct
download links here, because minor updates of Python happen all the time and I
don’t want to be responsible for you missing important updates. You should
always install the most recent version of Python 3.x unless you have some
esoteric reason not to.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.85pt;margin-left:12.75pt'><img width=409 height=309
src="Dive%20Into%20Python%203_files/image002.jpg" align=left hspace=12>Once
your download is complete, doubleclick the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>.msi </span>file. Windows will
pop up a security alert, since you’re about to be running executable code. The
official Python installer is digitally signed by the <a
href="http://www.python.org/psf/"><span style='color:black'>Python </span></a><a
href="http://www.python.org/psf/"><span style='color:black'>Software</span></a><u>
</u><a href="http://www.python.org/psf/"><span style='color:black'>Foundation</span></a>,
the non-profit corporation that oversees Python development. Don’t accept
imitations!</p>

<p class=MsoNormal style='margin-bottom:6.05pt;line-height:107%'>Click the <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>Run </span>button
to launch the Python</p>

<p class=MsoNormal style='line-height:107%'>3 installer.</p>

</div>

<span style='font-size:12.0pt;line-height:154%;font-family:"Gill Sans MT",sans-serif;
color:black'><br clear=all style='page-break-before:always'>
</span>

<div class=WordSection2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.0pt;
margin-left:39.1pt;line-height:107%'><img width=499 height=432
src="Dive%20Into%20Python%203_files/image003.jpg" align=left hspace=12>first
question the installer</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>will ask you is whether you want to install Python 3
for all users or just for you. The default choice is “install for all users,”
which is the best choice unless you have a good reason to choose otherwise.
(One possible reason why you would want to “install just for me” is that you
are installing Python on your company’s computer and you don’t have
administrative rights on your Windows account. But then, why are you installing
Python without permission from your</p>

<p class=MsoNormal style='margin-top:0in;margin-right:188.6pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:301%'>company’s Windows administrator?
Don’t get me in trouble here!) Click the <span style='font-size:10.0pt;
line-height:301%;font-family:"Liberation Mono"'>Next </span>button to accept
your choice of installation type.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'><img width=499 height=432
src="Dive%20Into%20Python%203_files/image004.jpg" align=left hspace=12>Next,
the installer will prompt you to choose a destination directory. The default
for all versions of Python 3.1.x is</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.8pt;margin-left:16.4pt'><span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>C:\Python31\</span>, which should work well for
most users unless you have a specific reason to change it. If you maintain a
separate drive letter for installing applications, you can browse to it using
the embedded controls, or simply type the pathname in the box below. You are
not limited to installing Python on the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>C: </span>drive; you can
install it on any drive, in any folder.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.4pt;line-height:107%'><img width=499 height=432
src="Dive%20Into%20Python%203_files/image005.jpg" align=left hspace=12>Click
the <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>Next
</span>button to accept your choice of destination directory. next page looks</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.4pt;margin-left:16.4pt'>complicated, but it’s not really. Like many
installers, you have the option not to install every single component of Python
3. If disk space is especially tight, you can exclude certain components.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:15.1pt;text-indent:-15.1pt'><span style='font-family:"DejaVu Sans",sans-serif'>&#9702;
</span><b>Register Extensions </b>allows you to double-click Python scripts (<span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>.py </span>files)
and run them. Recommended but not required. (This option doesn’t require any
disk space, so there is little point in excluding it.)</p>

<p class=MsoNormal style='margin-left:15.1pt;text-indent:-15.1pt'><span
style='font-family:"DejaVu Sans",sans-serif'>&#9702; </span><b>Tcl/Tk </b>is
the graphics library used by the Python Shell, which you will use throughout
this book. I strongly recommend keeping this option.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:.5pt;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif'>&#9702;
</span><b>Documentation </b>installs a help file that contains much of the
information on <a href="http://docs.python.org/"><span style='font-size:10.0pt;
line-height:107%;font-family:"Liberation Mono";color:black'>docs.python.org</span></a>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.25pt;margin-left:16.4pt;line-height:107%'>Recommended if you are on dialup or
have limited Internet access.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.15pt;
margin-left:16.4pt;text-align:justify;text-justify:inter-ideograph;text-indent:
-17.15pt;line-height:155%'><span style='font-family:"DejaVu Sans",sans-serif'>&#9702;
</span><b>Utility Scripts </b>includes the <span style='font-size:10.0pt;
line-height:155%;font-family:"Liberation Mono"'>2to3.py </span>script which
you’ll learn about <u>later in this book</u>. Required if you want to learn
about migrating existing Python 2 code to Python 3. If you have no existing
Python 2 code, you can skip this option.</p>

<p class=MsoNormal style='margin-left:15.1pt;text-indent:-15.1pt'><span
style='font-family:"DejaVu Sans",sans-serif'>&#9702; </span><b>Test Suite </b>is
a collection of scripts used to test the Python interpreter itself. We will not
use it in this book, nor have I ever used it in the course of programming in
Python. Completely optional.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'><img width=499 height=432
src="Dive%20Into%20Python%203_files/image006.jpg" align=left hspace=12>If
you’re unsure how much disk space you have, click the</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.95pt;
margin-left:16.4pt;line-height:107%'><span style='font-size:10.0pt;line-height:
107%;font-family:"Liberation Mono"'>Disk Usage </span>button. The</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.85pt;margin-left:16.4pt'>installer will list your drive letters, compute how
much space is available on each drive, and calculate how much would be left
after installation.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
119.7pt;margin-left:16.4pt'>Click the <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>OK </span>button to return to the
“Customizing Python” page.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.2pt;margin-left:16.4pt'><img width=499 height=432
src="Dive%20Into%20Python%203_files/image007.jpg" align=left hspace=12>If you
decide to exclude an option, select the drop-down button before the option and
select “Entire feature will be unavailable.” For example, excluding the test
suite will save you a whopping 7908<span style='font-size:9.5pt;line-height:
154%'>KB </span>of disk space.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
5.55pt;margin-left:16.4pt'><img width=499 height=432
src="Dive%20Into%20Python%203_files/image008.jpg" align=left hspace=12>Click
the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>Next
</span>button to accept your choice of options. installer will copy all the</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
246.7pt;margin-left:16.4pt'>necessary files to your chosen destination
directory. (This happens so quickly, I had to try it three times to even get a
screenshot of it!)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'><img width=499 height=432
src="Dive%20Into%20Python%203_files/image009.jpg" align=left hspace=12>Click
the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>Finish
</span>button to exit the installer.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
521.65pt;margin-left:16.4pt'><img width=677 height=715
src="Dive%20Into%20Python%203_files/image010.jpg" align=left hspace=12>In your</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:20.55pt;
margin-left:16.4pt'><span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>Start </span>menu, there should be a new item called <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>Python
3.1</span>. Within that, there is a program called <span style='font-size:9.5pt;
line-height:154%'>IDLE</span>. Select this item to run the interactive Python
Shell.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:51.8pt;
margin-left:15.6pt;line-height:110%'>[Skip to <u>using the Python Shell</u>]</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:1.95pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

</div>

<span style='font-size:12.0pt;line-height:154%;font-family:"Gill Sans MT",sans-serif;
color:black'><br clear=all style='page-break-before:always'>
</span>

<div class=WordSection3>

<h2 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>0.4.
I</span>NSTALLING ON <span style='font-size:18.0pt;line-height:112%'>M</span>AC
<span style='font-size:18.0pt;line-height:112%'>OS X</span></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.85pt;margin-bottom:21.15pt;
margin-left:16.4pt'>All modern Macintosh computers use the Intel chip (like
most Windows PCs). Older Macs used PowerPC chips. You don’t need to understand
the difference, because there’s just one Mac Python installer for all Macs.</p>

<p class=MsoNormal style='margin-left:16.4pt'>Visit <a
href="http://python.org/download/"><span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono";color:black'>python.org/download/</span></a><u><span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'> </span></u>and
download the Mac installer. It will be called something like <b>Python 3.1 Mac
Installer Disk Image</b>, although the version number may vary. Be sure to
download version 3.x, not</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
9.35pt;margin-left:16.4pt;line-height:107%'>2.x.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:30.85pt;
margin-left:37.65pt;text-indent:0in;line-height:107%'><img border=0 width=708
height=413 id="Picture 2180" src="Dive%20Into%20Python%203_files/image011.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.9pt;margin-bottom:20.9pt;
margin-left:16.4pt'>Your browser should automatically mount the disk image and
open a Finder window to show you the contents. (If this doesn’t happen, you’ll
need to find the disk image in your downloads folder and double-click to mount
it. It will be named something like <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>python-3.1.dmg</span>.) The disk image
contains a number of text files (<span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>Build.txt</span>, <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>License.txt</span>, <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>ReadMe.txt</span>),
and the actual installer package, <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>Python.mpkg</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>Double-click the <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>Python.mpkg
</span>installer package to launch the Mac Python installer.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'><img width=622 height=442
src="Dive%20Into%20Python%203_files/image012.jpg" align=left hspace=12>The
first page of the</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.85pt;
margin-left:16.4pt;line-height:107%'>installer</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>gives a brief description of Python itself, then
refers you to the</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.55pt;margin-left:16.4pt'><span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>ReadMe.txt </span>file (which you didn’t read,
did you?) for more details.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.4pt;line-height:107%'>Click the</p>

<p class=MsoNormal style='margin-top:0in;margin-right:440.2pt;margin-bottom:
.25pt;margin-left:16.4pt'><span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>Continue </span>button to move along.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.0pt;
margin-left:16.4pt;line-height:107%'><img width=622 height=442
src="Dive%20Into%20Python%203_files/image013.jpg" align=left hspace=12>The next</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>page actually contains some</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>important information: Python requires</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.0pt;
margin-left:16.4pt;line-height:107%'>Mac OS X</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>10.3 or later. If you are still</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>running Mac OS X 10.2, you should</p>

<p class=MsoNormal style='margin-top:0in;margin-right:24.4pt;margin-bottom:
21.35pt;margin-left:16.4pt'>really upgrade. Apple no longer provides security
updates for your operating system, and your computer is probably at risk if you
ever go online. Also, you can’t run Python 3.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>Click the <span style='font-size:
10.0pt;line-height:107%;font-family:"Liberation Mono"'>Continue </span>button
to advance.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.0pt;
margin-left:16.4pt;line-height:107%'><img width=622 height=442
src="Dive%20Into%20Python%203_files/image014.jpg" align=left hspace=12>Like all
good</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.85pt;
margin-left:16.4pt;line-height:107%'>installers,</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.0pt;
margin-left:16.4pt;line-height:107%'>the Python</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>installer displays the software license agreement.
Python is open source, and its license is <a
href="http://opensource.org/licenses/"><span style='color:black'>approved</span></a><u>
</u><a href="http://opensource.org/licenses/"><span style='color:black'>by </span></a><a
href="http://opensource.org/licenses/"><span style='color:black'>the</span></a><u>
</u><a href="http://opensource.org/licenses/"><span style='color:black'>Open</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:17.15pt;line-height:110%'><a href="http://opensource.org/licenses/"><span
style='color:black'>Source</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:17.15pt;line-height:110%'><a href="http://opensource.org/licenses/"><span
style='color:black'>Initiative</span></a>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.35pt;margin-left:16.4pt'>Python has had a number of owners and sponsors
throughout its history, each of which has left its mark on the software
license. But the end result is this: Python is open source, and you may use it
on any platform, for any purpose, without fee or obligation of reciprocity.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>Click the <span style='font-size:
10.0pt;line-height:107%;font-family:"Liberation Mono"'>Continue </span>button
once again.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.0pt;
margin-left:16.4pt;line-height:107%'><img width=622 height=442
src="Dive%20Into%20Python%203_files/image015.jpg" align=left hspace=12>Due to</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>quirks in the standard Apple</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.85pt;
margin-left:16.4pt;line-height:107%'>installer</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>framework, you must “agree” to the software license
in order to complete the installation.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>Since Python is open source, you are really</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.95pt;margin-left:16.4pt'>“agreeing” that the license is granting you
additional rights, rather than taking them away.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>Click the <span style='font-size:
10.0pt;line-height:107%;font-family:"Liberation Mono"'>Agree </span>button to
continue.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'><img width=622 height=442
src="Dive%20Into%20Python%203_files/image016.jpg" align=left hspace=12>The next
screen allows you to change</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>your install location.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:17.15pt;line-height:110%'>You <b>must</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.85pt;
margin-left:16.4pt;line-height:107%'>install</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>Python on your boot drive, but due to</p>

<p class=MsoNormal style='margin-top:0in;margin-right:334.95pt;margin-bottom:
20.55pt;margin-left:16.4pt'>limitations of the installer, it does not enforce
this. In truth, I have never had the need to change the install location.</p>

<p class=MsoNormal style='margin-left:16.4pt'>From this screen, you can also
customize the installation to exclude certain features. If you want to do this,
click the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>Customize
</span>button; otherwise click the <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>Install </span>button.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'><img width=622 height=442
src="Dive%20Into%20Python%203_files/image017.jpg" align=left hspace=12>If you
choose a Custom</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>Install, the installer will present you with the</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.55pt;margin-left:16.4pt'>following list of features:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:133.5pt;
margin-left:1.3pt;line-height:110%'><span style='font-family:"DejaVu Sans",sans-serif'>&#9702;
</span><b>Python</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.4pt;line-height:107%'><b>Framework</b>. This is the guts
of Python, and is both selected and disabled because it must be installed.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-15.1pt'><span style='font-family:"DejaVu Sans",sans-serif'>&#9702;
</span><b>GUI Applications </b>includes IDLE, the graphical Python Shell which
you will use throughout this book. I strongly recommend keeping this option
selected.</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-15.1pt'><span
style='font-family:"DejaVu Sans",sans-serif'>&#9702; </span><b>UNIX
command-line tools </b>includes the command-line <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>python3 </span>application. I
strongly recommend keeping this option, too.</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-15.1pt'><span
style='font-family:"DejaVu Sans",sans-serif'>&#9702; </span><b>Python
Documentation </b>contains much of the information on <a
href="http://docs.python.org/"><span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono";color:black'>docs.python.org</span></a>.
Recommended if you are on dialup or have limited Internet access.</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-15.1pt'><span
style='font-family:"DejaVu Sans",sans-serif'>&#9702; </span><b>Shell profile
updater </b>controls whether to update your shell profile (used in <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>Terminal.app</span>)
to ensure that this version of Python is on the search path of your shell. You
probably don’t need to change this.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:21.25pt;
margin-left:16.65pt;text-indent:-15.1pt'><span style='font-family:"DejaVu Sans",sans-serif'>&#9702;
</span><b>Fix system Python </b>should not be changed. (It tells your Mac to
use Python 3 as the default Python for all scripts, including built-in system
scripts from Apple. This would be very bad, since most of those scripts are
written for Python 2, and they would fail to run properly under Python 3.)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>Click the <span style='font-size:
10.0pt;line-height:107%;font-family:"Liberation Mono"'>Install </span>button to
continue.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.0pt;
margin-left:16.4pt;line-height:107%'><img width=622 height=457
src="Dive%20Into%20Python%203_files/image018.jpg" align=left hspace=12>Because
it</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.85pt;
margin-left:16.4pt;line-height:107%'>installs</p>

<p class=MsoNormal style='margin-top:0in;margin-right:69.05pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:296%'>system-wide frameworks and binaries
in <span style='font-size:10.0pt;line-height:296%;font-family:"Liberation Mono"'>/usr/
local/bin/</span>, the installer will ask you for an administrative password.
There is no way to install Mac Python without administrator privileges.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>Click the <span style='font-size:
10.0pt;line-height:107%;font-family:"Liberation Mono"'>OK </span>button to
begin the installation.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
211.25pt;margin-left:16.4pt'><img width=622 height=442
src="Dive%20Into%20Python%203_files/image019.jpg" align=left hspace=12>The
installer will display a progress meter while it installs the features you’ve
selected.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'><img width=622 height=442
src="Dive%20Into%20Python%203_files/image020.jpg" align=left hspace=12>Assuming
all went well, the installer will give you a big green checkmark to tell you
that the</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>installation completed successfully.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.5pt;margin-left:16.4pt'>Click the <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>Close </span>button to exit the installer.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'><img width=488 height=482
src="Dive%20Into%20Python%203_files/image021.jpg" align=left hspace=12>Assuming
you didn’t change the install location, you can find the newly installed files
in the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>Python
3.1 </span>folder within your</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.9pt;margin-left:16.4pt'><span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>/Applications </span>folder. The most important
piece is <span style='font-size:9.5pt;line-height:154%'>IDLE</span>, the
graphical Python Shell.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>Double-click <span style='font-size:9.5pt;line-height:
154%'>IDLE </span>to launch the Python Shell.<br clear=all style='page-break-before:
always'>
</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'><img width=522 height=538
src="Dive%20Into%20Python%203_files/image022.jpg" align=left hspace=12>The
Python Shell is where you will spend most of your time exploring Python.
Examples throughout this book will assume that you can find your way into the
Python</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:21.3pt;
margin-left:16.4pt'>Shell.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:17.15pt;line-height:110%'>[Skip to <u>using the Python</u></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:209.45pt;
margin-left:17.15pt;line-height:110%'><u>Shell</u>]</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:3.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h2 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>0.5.
I</span>NSTALLING ON <span style='font-size:18.0pt;line-height:112%'>U</span>BUNTU
<span style='font-size:18.0pt;line-height:112%'>L</span>INUX</h2>

<p class=MsoNormal style='margin-left:16.4pt'>Modern Linux distributions are
backed by vast repositories of precompiled applications, ready to install. The
exact details vary by distribution. In Ubuntu Linux, the easiest way to install
Python 3 is through the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>Add/ Remove </span>application in your <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>Applications
</span>menu.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.25pt;
margin-left:37.65pt;text-indent:0in;line-height:107%'><img border=0 width=708
height=364 id="Picture 3181" src="Dive%20Into%20Python%203_files/image023.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:2.95pt;
margin-left:16.4pt'>When you first launch the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>Add/Remove </span>application,
it will show you a list of preselected applications in different categories.
Some are already installed; most are not. Because the repository contains over
10,000 applications, there are different filters you can apply to see small
parts of the repository. The default filter is “Canonical-maintained
applications,” which is a small subset of the total number of applications that
are officially supported by Canonical, the company that creates and maintains
Ubuntu Linux.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:37.65pt;text-indent:0in;line-height:107%'><img border=0 width=708
height=364 id="Picture 3183" src="Dive%20Into%20Python%203_files/image024.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:2.95pt;
margin-left:16.4pt'>Python 3 is not maintained by Canonical, so the first step
is to drop down this filter menu and select “All Open Source applications.”</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:30.85pt;
margin-left:37.65pt;text-indent:0in;line-height:107%'><img border=0 width=708
height=364 id="Picture 3269" src="Dive%20Into%20Python%203_files/image025.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:4.3pt;
margin-left:16.4pt'>Once you’ve widened the filter to include all open source
applications, use the Search box immediately after the filter menu to search
for <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>Python
3</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:37.65pt;text-indent:0in;line-height:107%'><img border=0 width=708
height=364 id="Picture 3271" src="Dive%20Into%20Python%203_files/image026.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:16.4pt;line-height:107%'>Now the list of applications narrows to
just those matching <span style='font-size:10.0pt;line-height:107%;font-family:
"Liberation Mono"'>Python 3</span>. You’re going to check two packages.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
9.3pt;margin-left:16.4pt;line-height:107%'>The first is <span style='font-size:
10.0pt;line-height:107%;font-family:"Liberation Mono"'>Python (v3.0)</span>.
This contains the Python interpreter itself.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.6pt;
margin-left:37.65pt;text-indent:0in;line-height:107%'><img border=0 width=708
height=364 id="Picture 3328" src="Dive%20Into%20Python%203_files/image027.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:21.1pt;
margin-left:16.4pt'>The second package you want is immediately above: <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>IDLE
(using Python-3.0)</span>. This is a graphical Python Shell that you will use
throughout this book.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>After you’ve checked those two
packages, click the <span style='font-size:10.0pt;line-height:107%;font-family:
"Liberation Mono"'>Apply Changes </span>button to continue.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'><img width=635 height=364
src="Dive%20Into%20Python%203_files/image028.jpg" align=left hspace=12>The
package manager will ask you to</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>confirm that you want to add both</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:17.15pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>IDLE</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:80.3pt;
margin-left:17.15pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>(using</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:27.15pt;
margin-left:17.15pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>Python-3.0) </span>and <span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>Python
(v3.0)</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.5pt;margin-left:16.4pt'>Click the <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>Apply </span>button to continue.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'><img width=287 height=211
src="Dive%20Into%20Python%203_files/image029.jpg" align=left hspace=12>The
package manager will show you a progress meter while it downloads the necessary
packages from Canonical’s Internet repository.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
157.35pt;margin-left:16.4pt'><img width=486 height=258
src="Dive%20Into%20Python%203_files/image030.jpg" align=left hspace=12>Once the
packages are downloaded, the package manager will automatically begin
installing them.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:289.3pt;margin-bottom:
21.45pt;margin-left:16.4pt'><img width=591 height=296
src="Dive%20Into%20Python%203_files/image031.jpg" align=left hspace=12>If all
went well, the package manager will confirm that both packages were
successfully installed. From here, you can double-click <span style='font-size:
9.5pt;line-height:154%'>IDLE </span>to launch the Python Shell, or click the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>Close </span>button
to exit the package manager.</p>

<p class=MsoNormal style='margin-left:16.4pt'>You can always relaunch the
Python Shell by going to your <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>Applications </span>menu, then the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>Programming
</span>submenu, and selecting <span style='font-size:9.5pt;line-height:154%'>IDLE</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.75pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%;font-family:"Calibri",sans-serif'>       </span>The <img
border=0 width=679 height=687 id="Picture 3542"
src="Dive%20Into%20Python%203_files/image032.jpg"></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.25pt;margin-bottom:
20.55pt;margin-left:16.4pt'>Python Shell is where you will spend most of your
time exploring Python. Examples throughout this book will assume that you can
find your way into the Python Shell.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:51.8pt;
margin-left:17.15pt;line-height:110%'>[Skip to <u>using the Python Shell</u>]</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:3.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h2 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>0.6.
I</span>NSTALLING ON <span style='font-size:18.0pt;line-height:112%'>O</span>THER
<span style='font-size:18.0pt;line-height:112%'>P</span>LATFORMS</h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:45.65pt;
margin-left:16.4pt'>Python 3 is available on a number of different platforms.
In particular, it is available in virtually every Linux, <span
style='font-size:9.5pt;line-height:154%'>BSD</span>, and Solaris-based
distribution. For example, RedHat Linux uses the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>yum </span>package manager;
FreeBSD has its <a href="http://www.freebsd.org/ports/"><span style='color:
black'>ports</span></a><u> </u><a href="http://www.freebsd.org/ports/"><span
style='color:black'>and</span></a><u> </u><a
href="http://www.freebsd.org/ports/"><span style='color:black'>packages</span></a><u>
</u><a href="http://www.freebsd.org/ports/"><span style='color:black'>collection</span></a>;
Solaris has <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>pkgadd
</span>and friends. A quick web search for <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>Python 3 </span>+ <i>your
operating system </i>will tell you whether a Python 3 package is available, and
how to install it.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:3.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h2 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>0.7.
U</span>SING <span style='font-size:18.0pt;line-height:112%'>T</span>HE <span
style='font-size:18.0pt;line-height:112%'>P</span>YTHON <span style='font-size:
18.0pt;line-height:112%'>S</span>HELL</h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.45pt;margin-bottom:20.65pt;
margin-left:16.4pt'>The Python Shell is where you can explore Python syntax,
get interactive help on commands, and debug short programs. The graphical
Python Shell (named <span style='font-size:9.5pt;line-height:154%'>IDLE</span>)
also contains a decent text editor that supports Python syntax coloring and
integrates with the Python Shell. If you don’t already have a favorite text
editor, you should give <span style='font-size:9.5pt;line-height:154%'>IDLE </span>a
try.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:19.05pt;
margin-left:16.4pt'>First things first. The Python Shell itself is an amazing
interactive playground. Throughout this book, you’ll see examples like this:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>1 + 1</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.15pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>2</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:20.65pt;
margin-left:16.4pt'>The three angle brackets, <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;</span>,
denote the Python Shell prompt. Don’t type that part. That’s just to let you
know that this example is meant to be followed in the Python Shell.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.6pt;margin-bottom:20.55pt;
margin-left:16.4pt'><span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>1<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span></span><span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>+
1 </span>is the part you type. You can type any valid Python expression or
command in the Python Shell. Don’t be shy; it won’t bite! The worst that will
happen is you’ll get an error message. Commands get executed immediately (once
you press <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>ENTER</span>);
expressions get evaluated immediately, and the Python Shell prints out the
result.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.6pt;margin-bottom:.25pt;
margin-left:16.4pt'><span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>2<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span></span>is the result of evaluating this expression. As it happens, <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>1 + 1 </span>is
a valid Python expression. The result, of course, is <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>2</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.9pt;margin-left:16.4pt'>Let’s try another one.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:350.45pt;margin-bottom:
22.55pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>print('Hello
world!') Hello world!</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:20.55pt;
margin-left:16.4pt'>Pretty simple, no? But there’s lots more you can do in the
Python shell. If you ever get stuck — you can’t remember a command, or you
can’t remember the proper arguments to pass a certain function — you can get
interactive help in the Python Shell. Just type <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>help </span>and press <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>ENTER</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>help</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>Type help() for interactive help, or
help(object) for help about object.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:21.2pt;
margin-left:16.4pt'>There are two modes of help. You can get help about a
single object, which just prints out the documentation and returns you to the
Python Shell prompt. You can also enter <i>help mode</i>, where instead of
evaluating Python expressions, you just type keywords or command names and it
will print out whatever it knows about that command.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>To enter the interactive help mode,
type <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>help()
</span>and press <span style='font-size:10.0pt;line-height:107%;font-family:
"Liberation Mono"'>ENTER</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>help()</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>Welcome to Python 3.0!  This is the online
help utility.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:80.45pt;margin-bottom:
21.0pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>If this is your first time
using Python, you should definitely check out the tutorial on the Internet at
http://docs.python.org/tutorial/.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:74.45pt;margin-bottom:
21.0pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>Enter the name of any module,
keyword, or topic to get help on writing Python programs and using Python
modules.  To quit this help utility and return to the interpreter, just type
&quot;quit&quot;.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:86.45pt;margin-bottom:
21.0pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>To get a list of available
modules, keywords, or topics, type &quot;modules&quot;, &quot;keywords&quot;,
or &quot;topics&quot;.  Each module also comes with a one-line summary of what
it does; to list the modules whose summaries contain a given word such as
&quot;spam&quot;, type &quot;modules spam&quot;.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.95in;margin-bottom:
31.35pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#666677'>help&gt;</span></p>

<p class=MsoNormal style='margin-left:16.4pt'>Note how the prompt changes from <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span>to <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono";color:#666677'>help&gt;</span>. This reminds
you that you’re in the interactive help mode. Now you can enter any keyword,
command, module name, function name — pretty much anything Python understands —
and read documentation on it.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>help&gt; </span><span style='font-size:10.0pt;line-height:110%;
font-family:"Liberation Mono"'>print                                                                 </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>Help on built-in function print in module
builtins:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:188.45pt;margin-bottom:
21.0pt;margin-left:61.4pt;text-indent:-24.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>print(...)
print(value, ..., sep=' ', end='\n', file=sys.stdout)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:104.45pt;margin-bottom:
0in;margin-left:62.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>Prints the values to a stream,
or to sys.stdout by default. Optional keyword arguments:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:86.45pt;margin-bottom:
16.85pt;margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono"'>file: a file-like object
(stream); defaults to the current sys.stdout. sep:  string inserted between
values, default a space. end:  string appended after the last value, default a
newline.</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=622
 style='width:466.85pt;margin-left:38.15pt;border-collapse:collapse'>
 <tr style='height:49.8pt'>
  <td width=608 valign=top style='width:456.05pt;padding:0in 0in 0in 0in;
  height:49.8pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>help&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>PapayaWhip</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>no
  Python documentation found for 'PapayaWhip'</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:49.8pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9313;</span></p>
  </td>
 </tr>
 <tr style='height:138.0pt'>
  <td width=608 valign=bottom style='width:456.05pt;padding:0in 0in 0in 0in;
  height:138.0pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>help&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>quit</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:36.05pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>You are now leaving
  help and returning to the Python interpreter. If you want to ask for help on
  a particular object directly from the interpreter, you can type
  &quot;help(object)&quot;.  Executing &quot;help('string')&quot; has the same
  effect as typing a particular string at the help&gt; prompt.</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:138.0pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9314;</span></p>
  </td>
 </tr>
 <tr style='height:18.3pt'>
  <td width=608 valign=bottom style='width:456.05pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono";
  color:#666677'>&gt;&gt;&gt;</span>&nbsp;</p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9315;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:9.0pt;margin-bottom:.25pt;
margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>To get documentation on the <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>print() </span>function, just type <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>print </span>and
press <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>ENTER</span>.
The interactive help mode will display something akin to a man page: the
function name, a brief synopsis, the function’s arguments and their default
values, and so on. If the documentation seems opaque to you, don’t panic.
You’ll learn more about all these concepts in the next few chapters.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:9.0pt;margin-bottom:.15pt;
margin-left:16.65pt;text-indent:-16.65pt;line-height:155%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Of course, the
interactive help mode doesn’t know everything. If you type something that isn’t
a Python command, module, function, or other built-in keyword, the interactive
help mode will just shrug its virtual shoulders.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:9.0pt;margin-bottom:7.65pt;
margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>To quit the
interactive help mode, type <span style='font-size:10.0pt;line-height:107%;
font-family:"Liberation Mono"'>quit </span>and press <span style='font-size:
10.0pt;line-height:107%;font-family:"Liberation Mono"'>ENTER</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:9.0pt;margin-bottom:.25pt;
margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The prompt changes back to <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span>to signal
that you’ve left the interactive help mode and returned to the Python Shell.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
46.6pt;margin-left:16.4pt'><span style='font-size:9.5pt;line-height:154%'>IDLE</span>,
the graphical Python Shell, also includes a Python-aware text editor.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:3.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h2 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>0.8.
P</span>YTHON <span style='font-size:18.0pt;line-height:112%'>E</span>DITORS
AND <span style='font-size:18.0pt;line-height:112%'>IDE</span>S</h2>

<p class=MsoNormal style='margin-left:16.4pt'><span style='font-size:9.5pt;
line-height:154%'>IDLE </span>is not the only game in town when it comes to
writing programs in Python. While it’s useful to get started with learning the
language itself, many developers prefer other text editors or Integrated</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:20.65pt;
margin-left:16.4pt'>Development Environments (<span style='font-size:9.5pt;
line-height:154%'>IDE</span>s). I won’t cover them here, but the Python
community maintains <a href="http://wiki.python.org/moin/PythonEditors"><span
style='color:black'>a</span></a><u> </u><a
href="http://wiki.python.org/moin/PythonEditors"><span style='color:black'>list</span></a><u>
</u><a href="http://wiki.python.org/moin/PythonEditors"><span style='color:
black'>of </span></a><a href="http://wiki.python.org/moin/PythonEditors"><span
style='color:black'>Python-aware</span></a><u> </u><a
href="http://wiki.python.org/moin/PythonEditors"><span style='color:black'>editors</span></a><u>
</u>that covers a wide range of supported platforms and software licenses.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:20.65pt;
margin-left:16.4pt'>You might also want to check out the <a
href="http://wiki.python.org/moin/IntegratedDevelopmentEnvironments"><span
style='color:black'>list</span></a><u> </u><a
href="http://wiki.python.org/moin/IntegratedDevelopmentEnvironments"><span
style='color:black'>of</span></a><u> </u><a
href="http://wiki.python.org/moin/IntegratedDevelopmentEnvironments"><span
style='color:black'>Python-aware</span></a><u> </u><a
href="http://wiki.python.org/moin/IntegratedDevelopmentEnvironments"><span
style='font-size:9.5pt;line-height:154%;color:black'>IDE</span></a><a
href="http://wiki.python.org/moin/IntegratedDevelopmentEnvironments"><span
style='color:black'>s</span></a>, although few of them support Python 3 yet.
One that does is <a href="http://pydev.sourceforge.net/"><span
style='color:black'>PyDev</span></a>, a plugin for <a href="http://eclipse.org/"><span
style='color:black'>Eclipse</span></a><u> </u>that turns Eclipse into a
full-fledged Python <span style='font-size:9.5pt;line-height:154%'>IDE</span>.
Both Eclipse and PyDev are cross-platform and open source.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.65pt;margin-bottom:
20.55pt;margin-left:16.4pt'>On the commercial front, there is ActiveState’s <a
href="http://www.activestate.com/komodo/"><span style='color:black'>Komodo</span></a><u>
</u><a href="http://www.activestate.com/komodo/"><span style='font-size:9.5pt;
line-height:154%;color:black'>IDE</span></a>. It has per-user licensing, but
students can get a discount, and a free time-limited trial version is
available.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.45pt;margin-bottom:
.25pt;margin-left:16.4pt'>I’ve been programming in Python for nine years, and I
edit my Python programs in <a href="http://www.gnu.org/software/emacs/"><span
style='color:black'>GNU</span></a><u> </u><a
href="http://www.gnu.org/software/emacs/"><span style='color:black'>Emacs</span></a><u>
</u>and debug them in the command-line Python Shell. There’s no right or wrong
way to develop in Python. Find a way that works for you!</p>

<h1 style='margin-top:0in;margin-right:22.2pt;margin-bottom:0in;margin-left:
16.4pt;margin-bottom:.0001pt'><span style='font-size:24.0pt;line-height:107%'>C</span>HAPTER
<span style='font-size:24.0pt;line-height:107%'>1. Y</span>OUR <span
style='font-size:24.0pt;line-height:107%'>F</span>IRST <span style='font-size:
24.0pt;line-height:107%'>P</span>YTHON <span style='font-size:24.0pt;
line-height:107%'>P</span>ROGRAM</h1>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:39.9pt;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=736 height=4 id="Group 618507"
src="Dive%20Into%20Python%203_files/image001.gif"></span></p>

<p class=MsoNormal align=right style='margin-top:0in;margin-right:0in;
margin-bottom:65.45pt;margin-left:55.2pt;text-align:right;line-height:160%'><span
style='font-size:13.0pt;line-height:160%;font-family:"Calibri",sans-serif'>&#10077;
</span><i>Don’t bury your burden in saintly silence. You have a problem? Great.
Rejoice, dive in, and investigate. </i><span style='font-size:13.0pt;
line-height:160%;font-family:"Calibri",sans-serif'>&#10078; </span><i>— </i><a
href="http://en.wikiquote.org/wiki/Buddhism"><i><span style='color:black'>Ven.</span></i></a><i><u>
</u></i><a href="http://en.wikiquote.org/wiki/Buddhism"><i><span
style='color:black'>Henepola</span></i></a><i><u> </u></i><a
href="http://en.wikiquote.org/wiki/Buddhism"><i><span style='color:black'>Gunaratana</span></i></a></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:66.15pt;margin-left:
16.4pt'><span style='font-size:18.0pt;line-height:112%'>1.1. D</span>IVING <span
style='font-size:18.0pt;line-height:112%'>I</span>N</h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.9pt;margin-bottom:1.85pt;
margin-left:16.4pt'><span style='font-size:48.0pt;line-height:154%;font-family:
"DejaVu Serif",serif;color:#888888'>C </span>onvention dictates that I should
bore you with the fundamental building blocks of programming, so we can slowly
work up to building something useful. Let’s skip all that. Here is a complete,
working Python program. It probably makes absolutely no sense to you. Don’t
worry about that, because you’re going to dissect it line by line. But read
through it first and see what, if anything, you can make of it.<br clear=all
style='page-break-before:always'>
</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>SUFFIXES = {1000: ['KB', 'MB', 'GB', 'TB',
'PB', 'EB', 'ZB', 'YB'],</span></p>

<p class=MsoNormal align=right style='margin-top:0in;margin-right:80.45pt;
margin-bottom:29.5pt;margin-left:.5pt;text-align:right;line-height:110%'><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>1024:
['KiB', 'MiB', 'GiB', 'TiB', 'PiB', 'EiB', 'ZiB', 'YiB']}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def approximate_size(size,
a_kilobyte_is_1024_bytes=True):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'''Convert a file size to human-readable
form.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>Keyword arguments:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>size -- file size in bytes</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>a_kilobyte_is_1024_bytes -- if True
(default), use multiples of 1024</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:230.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>if False, use multiples of 1000</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>Returns: string</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:434.45pt;margin-bottom:
0in;margin-left:62.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>''' if size &lt; 0:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:86.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>raise ValueError('number must be
non-negative')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:170.45pt;margin-bottom:
0in;margin-left:62.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>multiple = 1024 if
a_kilobyte_is_1024_bytes else 1000 for suffix in SUFFIXES[multiple]:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:368.45pt;margin-bottom:
0in;margin-left:86.7pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>size /= multiple if size &lt;
multiple:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:110.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>return '{0:.1f} {1}'.format(size, suffix)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>raise ValueError('number too large')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>if __name__ == '__main__':</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:8.45pt;margin-bottom:
22.55pt;margin-left:62.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>print(approximate_size(1000000000000,
False)) print(approximate_size(1000000000000))</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.9pt;margin-left:16.4pt'>Now let’s run this program on the command line. On
Windows, it will look something like this:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>c:\home\diveintopython3\examples&gt;
</span><span style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>c:\python31\python.exe
humansize.py</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>1.0 TB</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>931.3 GiB</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.9pt;margin-left:16.4pt'>On Mac OS X or Linux, it would look something like
this:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.95in;margin-bottom:
8.5pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#666677'>you@localhost:~/diveintopython3/examples$
</span><span style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>python3
humansize.py</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>1.0 TB</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>931.3 GiB</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.55pt;margin-bottom:21.7pt;
margin-left:16.4pt'>What just happened? You executed your first Python program.
You called the Python interpreter on the command line, and you passed the name
of the script you wanted Python to execute. The script defines a single
function, the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>approximate_size()
</span>function, which takes an exact file size in bytes and calculates a
“pretty” (but approximate) size. (You’ve probably seen this in Windows
Explorer, or the Mac OS X Finder, or Nautilus or Dolphin or Thunar on Linux. If
you display a folder of documents as a multi-column list, it will display a
table with the document icon, the document name, the size, type, last-modified
date, and so on. If the folder contains a 1093-byte file named <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>TODO</span>,
your file manager won’t display <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>TODO 1093 bytes</span>; it’ll say something like
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>TODO
1 KB </span>instead. That’s what the <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>approximate_size() </span>function does.)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:20.5pt;
margin-left:16.4pt'>Look at the bottom of the script, and you’ll see two calls
to <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>print(approximate_size(arguments))</span>.
These are function calls — first calling the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>approximate_size() </span>function
and passing a number of arguments, then taking the return value and passing it
straight on to the <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>print() </span>function. The <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>print() </span>function is
built-in; you’ll never see an explicit declaration of it. You can just use it,
anytime, anywhere. (There are lots of builtin functions, and lots more
functions that are separated into <i>modules</i>. Patience, grasshopper.)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.8pt;margin-bottom:45.5pt;
margin-left:16.4pt'>So why does running the script on the command line give you
the same output every time? We’ll get to that. First, let’s look at that <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>approximate_size()
</span>function.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:3.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h2 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>1.2.
D</span>ECLARING <span style='font-size:18.0pt;line-height:112%'>F</span>UNCTIONS</h2>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
18.9pt;margin-left:16.4pt'>Python has functions like most other languages, but
it does not have separate header files like <span style='font-size:9.5pt;
line-height:154%'>C</span>++ or <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>interface</span>/<span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>implementation </span>sections
like Pascal. When you need a function, just declare it, like this:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def approximate_size(size,
a_kilobyte_is_1024_bytes=True):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.55pt;margin-left:16.4pt'><img width=298 height=1
src="Dive%20Into%20Python%203_files/image033.gif" align=left hspace=12>The
keyword <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>def
</span>starts the function declaration, followed by the function name, followed
by the arguments in parentheses. Multiple arguments are separated with commas.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
46.85pt;margin-left:16.4pt'>Also note that the function doesn’t define a return
datatype. Python functions do not specify the datatype of their return value;
they don’t even specify whether or not they return a value. (In fact, every
Python function returns a value; if the function ever executes a <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>return </span>statement,
it will return that value, otherwise it will return <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>None</span>, the Python
null value.)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
2.15pt;margin-left:75.95pt;text-indent:-29.3pt'><span style='font-size:24.0pt;
line-height:154%;font-family:"Calibri",sans-serif'>&#9758; </span>In some
languages, functions (that return a value) start with <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>function</span>, and
subroutines (that do not return a value) start with <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>sub</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:52.95pt;margin-bottom:
42.65pt;margin-left:76.4pt'>There are no subroutines in Python. Everything is a
function, all functions return a value (even if it’s <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>None</span>), and all
functions start with <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>def</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:27.15pt;margin-bottom:
46.85pt;margin-left:16.4pt'>The <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>approximate_size() </span>function takes the two
arguments — <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>size
</span>and <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>a_kilobyte_is_1024_bytes
</span>— but neither argument specifies a datatype. In Python, variables are
never explicitly typed. Python figures out what type a variable is and keeps
track of it internally.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:57.4pt;margin-bottom:
.25pt;margin-left:75.95pt;text-indent:-29.3pt'><span style='font-size:24.0pt;
line-height:154%;font-family:"Calibri",sans-serif'>&#9758; </span>In Java and
other statically-typed languages, you must specify the datatype of the function
return value and each function argument. In Python, you never explicitly
specify the datatype of anything. Based on what value you assign, Python keeps
track of the datatype internally.</p>

<h3 style='margin-top:0in;margin-right:0in;margin-bottom:25.25pt;margin-left:
16.4pt;line-height:110%'><span style='font-size:13.0pt;line-height:110%'>1.2.1.
O</span><span style='font-size:10.5pt;line-height:110%'>PTIONAL AND </span><span
style='font-size:13.0pt;line-height:110%'>N</span><span style='font-size:10.5pt;
line-height:110%'>AMED </span><span style='font-size:13.0pt;line-height:110%'>A</span><span
style='font-size:10.5pt;line-height:110%'>RGUMENTS</span></h3>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:21.3pt;
margin-left:16.4pt'>Python allows function arguments to have default values; if
the function is called without the argument, the argument gets its default
value. Furthermore, arguments can be specified in any order by using named
arguments.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.9pt;margin-left:16.4pt'>Let’s take another look at that <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>approximate_size()
</span>function declaration:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:32.1pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def approximate_size(size,
a_kilobyte_is_1024_bytes=True):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:20.55pt;
margin-left:16.4pt'>The second argument, <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>a_kilobyte_is_1024_bytes</span>,
specifies a default value of <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>True</span>. This means the argument is <i>optional</i>;
you can call the function without it, and Python will act as if you had called
it with <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>True
</span>as a second parameter.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.9pt;margin-left:16.4pt'>Now look at the bottom of the script:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>if __name__ == '__main__':</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:19.55pt;
margin-left:62.65pt;line-height:180%'><span style='font-size:10.0pt;line-height:
180%;font-family:"Liberation Mono"'>print(approximate_size(1000000000000,
False)) </span><span style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;
</span><span style='font-size:10.0pt;line-height:180%;font-family:"Liberation Mono"'>print(approximate_size(1000000000000))      </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.4pt;margin-bottom:.25pt;
margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>This calls the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>approximate_size() </span>function with two
arguments. Within the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>approximate_size() </span>function, <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>a_kilobyte_is_1024_bytes
</span>will be <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>False</span>,
since you explicitly passed <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>False </span>as the second argument.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.4pt;margin-bottom:20.55pt;
margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>This calls the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>approximate_size() </span>function with only one
argument. But that’s OK, because the second argument is optional! Since the
caller doesn’t specify, the second argument defaults to <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>True</span>, as defined
by the function declaration.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>You can also pass values into a
function by name.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>from
humansize import approximate_size</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>approximate_size(4000,
a_kilobyte_is_1024_bytes=False)       </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'4.0 KB'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>approximate_size(size=4000,
a_kilobyte_is_1024_bytes=False) </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'4.0 KB'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>approximate_size(a_kilobyte_is_1024_bytes=False,
size=4000) </span><span style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'4.0 KB'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>approximate_size(a_kilobyte_is_1024_bytes=False,
4000)       </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>File
&quot;&lt;stdin&gt;&quot;, line 1</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
12.7pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>SyntaxError:
non-keyword arg after keyword arg</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>approximate_size(size=4000, False)                           </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9316;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>File
&quot;&lt;stdin&gt;&quot;, line 1</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
32.2pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>SyntaxError:
non-keyword arg after keyword arg</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.9pt;margin-bottom:.25pt;
margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>This calls the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>approximate_size() </span>function with <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>4000 </span>for
the first argument (<span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>size</span>) and <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>False </span>for the argument named <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>a_kilobyte_is_1024_bytes</span>.
(That happens to be the second argument, but doesn’t matter, as you’ll see in a
minute.)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.9pt;margin-bottom:.25pt;
margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>This calls the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>approximate_size() </span>function with <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>4000 </span>for
the argument named <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>size </span>and <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>False </span>for the argument named <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>a_kilobyte_is_1024_bytes</span>.
(These named arguments happen to be in the same order as the arguments are
listed in the function declaration, but that doesn’t matter either.)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.9pt;margin-bottom:.25pt;
margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>This calls the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>approximate_size() </span>function with <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>False </span>for
the argument named <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>a_kilobyte_is_1024_bytes </span>and <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>4000 </span>for the
argument named <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>size</span>.
(See? I told you the order didn’t matter.)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.9pt;margin-bottom:.25pt;
margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>This call fails, because you have a named argument followed by an
unnamed (positional) argument, and that never works. Reading the argument list
from left to right, once you have a single named argument, the rest of the
arguments must also be named.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.9pt;margin-bottom:45.6pt;
margin-left:16.65pt;text-indent:-16.65pt'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>This call fails too, for the same reason as the previous call. Is that
surprising? After all, you passed <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>4000 </span>for the argument named <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>size</span>,
then “obviously” that <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>False </span>value was meant for the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>a_kilobyte_is_1024_bytes
</span>argument. But Python doesn’t work that way. As soon as you have a named
argument, all arguments to the right of that need to be named arguments, too.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:3.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h2 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>1.3.
W</span>RITING <span style='font-size:18.0pt;line-height:112%'>R</span>EADABLE <span
style='font-size:18.0pt;line-height:112%'>C</span>ODE</h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:22.3pt;
margin-left:16.4pt'>I won’t bore you with a long finger-wagging speech about
the importance of documenting your code. Just know that code is written once
but read many times, and the most important audience for your code is yourself,
six months after writing it (<i>i.e. </i>after you’ve forgotten everything but
need to fix something). Python makes it easy to write readable code, so take
advantage of it. You’ll thank me in six months.</p>

<h3 style='margin-top:0in;margin-right:0in;margin-bottom:25.25pt;margin-left:
16.4pt;line-height:110%'><span style='font-size:13.0pt;line-height:110%'>1.3.1.
D</span><span style='font-size:10.5pt;line-height:110%'>OCUMENTATION </span><span
style='font-size:13.0pt;line-height:110%'>S</span><span style='font-size:10.5pt;
line-height:110%'>TRINGS</span></h3>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
18.75pt;margin-left:16.4pt'>You can document a Python function by giving it a
documentation string (<span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>docstring </span>for short). In this program,
the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>approximate_size()
</span>function has a <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>docstring</span>:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def approximate_size(size,
a_kilobyte_is_1024_bytes=True):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'''Convert a file size to human-readable
form.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>Keyword arguments:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>size -- file size in bytes</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>a_kilobyte_is_1024_bytes -- if True
(default), use multiples of 1024</span></p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:81.45pt;
margin-bottom:29.5pt;margin-left:159.7pt;text-align:center;line-height:110%'><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>if
False, use multiples of 1000</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>Returns: string</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'''</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
44.5pt;margin-left:16.4pt'><img width=298 height=1
src="Dive%20Into%20Python%203_files/image033.gif" align=left hspace=12>Triple
quotes signify a multi-line string. Everything between the start and end quotes
is part of a single string, including carriage returns, leading white space,
and other quote characters. You can use them anywhere, but you’ll see them most
often used when defining a <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>docstring</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:21.75pt;
margin-left:46.4pt;line-height:107%'><span style='font-size:24.0pt;line-height:
107%;font-family:"Calibri",sans-serif'>&#9758;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
41.45pt;margin-left:76.4pt'><img width=298 height=1
src="Dive%20Into%20Python%203_files/image033.gif" align=left hspace=12>Triple
quotes are also an easy way to define a string with both single and double
quotes, like <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>qq/.../
</span>in Perl 5.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
47.4pt;margin-left:16.4pt'>Everything between the triple quotes is the
function’s <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>docstring</span>,
which documents what the function does. A <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>docstring</span>, if it exists,
must be the first thing defined in a function (that is, on the next line after
the function declaration). You don’t technically need to give your function a <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>docstring</span>,
but you always should. I know you’ve heard this in every programming class
you’ve ever taken, but Python gives you an added incentive: the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>docstring
</span>is available at runtime as an attribute of the function.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:42.1pt;margin-bottom:
45.25pt;margin-left:75.95pt;text-indent:-29.3pt'><span style='font-size:24.0pt;
line-height:154%;font-family:"Calibri",sans-serif'>&#9758; </span>Many Python <span
style='font-size:9.5pt;line-height:154%'>IDE</span>s use the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>docstring
</span>to provide context-sensitive documentation, so that when you type a
function name, its <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>docstring </span>appears as a tooltip. This can be
incredibly helpful, but it’s only as good as the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>docstring</span>s you write.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:3.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:19.35pt;margin-left:
16.4pt'><span style='font-size:18.0pt;line-height:112%'>1.4. T</span>HE <span
style='font-size:18.0pt;line-height:112%;font-family:"Liberation Mono";
font-weight:normal'>import </span><span style='font-size:18.0pt;line-height:
112%'>S</span>EARCH <span style='font-size:18.0pt;line-height:112%'>P</span>ATH</h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.1pt;margin-bottom:.25pt;
margin-left:16.4pt'>Before this goes any further, I want to briefly mention the
library search path. Python looks in several places when you try to import a
module. Specifically, it looks in all the directories defined in <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>sys.path</span>.
This is just a list, and you can easily view it or modify it with standard list
methods. (You’ll learn more about lists in</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:17.15pt;line-height:110%'><u>Native Datatypes</u>.)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.6pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>import sys                                                 </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>sys.path                                                   </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>['',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'/usr/lib/python31.zip',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:92.45pt;margin-bottom:
0in;margin-left:44.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>'/usr/lib/python3.1',
'/usr/lib/python3.1/plat-linux2@EXTRAMACHDEPPATH@',
'/usr/lib/python3.1/lib-dynload',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'/usr/lib/python3.1/dist-packages',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.2pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'/usr/local/lib/python3.1/dist-packages']</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>sys                                                        </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;module 'sys' (built-in)&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.6pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>sys.path.insert(0,
'/home/mark/diveintopython3/examples') </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>sys.path                                                   </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9316;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>['/home/mark/diveintopython3/examples',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'/usr/lib/python31.zip',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:92.45pt;margin-bottom:
0in;margin-left:44.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>'/usr/lib/python3.1',
'/usr/lib/python3.1/plat-linux2@EXTRAMACHDEPPATH@',
'/usr/lib/python3.1/lib-dynload',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'/usr/lib/python3.1/dist-packages',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.2pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'/usr/local/lib/python3.1/dist-packages']</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.35pt;
margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Importing the <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>sys </span>module
makes all of its functions and attributes available.</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>sys.path
</span>is a list of directory names that constitute the current search path.
(Yours will look different, depending on your operating system, what version of
Python you’re running, and where it was originally installed.) Python will look
through these directories (in this order) for a <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>.py </span>file whose name
matches what you’re trying to import.</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Actually, I
lied; the truth is more complicated than that, because not all modules are
stored as <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>.py
</span>files. Some, like the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>sys </span>module, are <i>built-in modules</i>;
they are actually baked right into Python itself. Built-in modules behave just
like regular modules, but their Python source code is not available, because
they are not written in Python! (The <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>sys </span>module is written in <span
style='font-size:9.5pt;line-height:154%'>C</span>.)</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>You can add a
new directory to Python’s search path at runtime by adding the directory name
to <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>sys.path</span>,
and then Python will look in that directory as well, whenever you try to import
a module. The effect lasts as long as Python is running.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:45.55pt;
margin-left:16.65pt;text-indent:-16.65pt'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>By using <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>sys.path.insert(0, new_path)</span>, you inserted a new
directory as the first item of the <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>sys.path </span>list, and therefore at the
beginning of Python’s search path. This is almost always what you want. In case
of naming conflicts (for example, if Python ships with version 2 of a
particular library but you want to use version 3), this ensures that your modules
will be found and used instead of the modules that came with Python.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:3.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h2 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>1.5.
E</span>VERYTHING <span style='font-size:18.0pt;line-height:112%'>I</span>S <span
style='font-size:18.0pt;line-height:112%'>A</span>N <span style='font-size:
18.0pt;line-height:112%'>O</span>BJECT</h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:20.55pt;
margin-left:16.4pt'>In case you missed it, I just said that Python functions
have attributes, and that those attributes are available at runtime. A
function, like everything else in Python, is an object.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
23.95pt;margin-left:16.4pt'>Run the interactive Python shell and follow along:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.9pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>import humansize                               </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>print(humansize.approximate_size(4096,
True)) </span><span style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>4.0 KiB</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:171.65pt;margin-bottom:
21.0pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>print(humansize.approximate_size.__doc__)   </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314; </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>Convert
a file size to human-readable form.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>Keyword arguments:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>size -- file size in bytes</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>a_kilobyte_is_1024_bytes -- if True
(default), use multiples of 1024</span></p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:81.45pt;
margin-bottom:29.5pt;margin-left:159.7pt;text-align:center;line-height:110%'><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>if
False, use multiples of 1000</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:52.35pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>Returns: string</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.9pt;margin-bottom:.25pt;
margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The first line imports the <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>humansize </span>program as a module — a
chunk of code that you can use interactively, or from a larger Python program.
Once you import a module, you can reference any of its public functions,
classes, or attributes. Modules can do this to access functionality in other modules,
and you can do it in the Python interactive shell too. This is an important
concept, and you’ll see a lot more of it throughout this book.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.9pt;margin-bottom:.25pt;
margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>When you want to use functions defined in imported modules, you need to
include the module name. So you can’t just say <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>approximate_size</span>; it
must be <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>humansize.approximate_size</span>.
If you’ve used classes in Java, this should feel vaguely familiar.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.9pt;margin-bottom:47.2pt;
margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Instead of calling the function as you would expect to, you asked for
one of the function’s attributes, <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>__doc__</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:47.55pt;margin-bottom:
39.3pt;margin-left:75.95pt;text-indent:-29.3pt;line-height:177%'><span
style='font-size:24.0pt;line-height:177%;font-family:"Calibri",sans-serif'>&#9758;
</span><span style='font-size:10.0pt;line-height:177%;font-family:"Liberation Mono"'>import
</span>in Python is like <span style='font-size:10.0pt;line-height:177%;
font-family:"Liberation Mono"'>require </span>in Perl. Once you <span
style='font-size:10.0pt;line-height:177%;font-family:"Liberation Mono"'>import </span>a
Python module, you access its functions with <span style='font-size:10.0pt;
line-height:177%;font-family:"Liberation Mono"'>module.function</span>; once
you <span style='font-size:10.0pt;line-height:177%;font-family:"Liberation Mono"'>require
</span>a Perl module, you access its functions with <span style='font-size:
10.0pt;line-height:177%;font-family:"Liberation Mono"'>module::function</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:23.55pt;
margin-left:16.4pt;line-height:121%'><b><span style='font-size:13.0pt;
line-height:121%;font-family:"DejaVu Serif",serif'>1.5.1. W</span></b><b><span
style='font-size:10.5pt;line-height:121%;font-family:"DejaVu Serif",serif'>HAT</span></b><b><span
style='font-size:13.0pt;line-height:121%;font-family:"DejaVu Serif",serif'>’</span></b><b><span
style='font-size:10.5pt;line-height:121%;font-family:"DejaVu Serif",serif'>S </span></b><b><span
style='font-size:13.0pt;line-height:121%;font-family:"DejaVu Serif",serif'>A</span></b><b><span
style='font-size:10.5pt;line-height:121%;font-family:"DejaVu Serif",serif'>N </span></b><b><span
style='font-size:13.0pt;line-height:121%;font-family:"DejaVu Serif",serif'>O</span></b><b><span
style='font-size:10.5pt;line-height:121%;font-family:"DejaVu Serif",serif'>BJECT</span></b><b><span
style='font-size:13.0pt;line-height:121%;font-family:"DejaVu Serif",serif'>?</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:20.55pt;
margin-left:16.4pt'>Everything in Python is an object, and everything can have
attributes and methods. All functions have a builtin attribute <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__doc__</span>,
which returns the <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>docstring </span>defined in the function’s source code. The <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>sys </span>module
is an object which has (among other things) an attribute called <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>path</span>.
And so forth.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.2pt;margin-bottom:20.55pt;
margin-left:16.4pt'>Still, this doesn’t answer the more fundamental question:
what is an object? Different programming languages define “object” in different
ways. In some, it means that <i>all </i>objects <i>must </i>have attributes and
methods; in others, it means that all objects are subclassable. In Python, the
definition is looser. Some objects have neither attributes nor methods, <i>but
they could</i>. Not all objects are subclassable. But everything is an object
in the sense that it can be assigned to a variable or passed as an argument to a
function.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:20.55pt;
margin-left:16.4pt'>You may have heard the term “first-class object” in other
programming contexts. In Python, functions are <i>first-class objects</i>. You
can pass a function as an argument to another function. Modules are <i>first-class
objects</i>. You can pass an entire module as an argument to a function.
Classes are first-class objects, and individual instances of a class are also
first-class objects.</p>

<p class=MsoNormal style='margin-left:16.4pt'>This is important, so I’m going
to repeat it in case you missed it the first few times: <i>everything in Python
is an object</i>. Strings are objects. Lists are objects. Functions are
objects. Classes are objects. Class instances are objects. Even modules are
objects.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:3.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h2 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>1.6.
I</span>NDENTING <span style='font-size:18.0pt;line-height:112%'>C</span>ODE</h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:23.3pt;
margin-left:16.4pt'>Python functions have no explicit <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>begin </span>or <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>end</span>,
and no curly braces to mark where the function code starts and stops. The only
delimiter is a colon (<span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>:</span>) and the indentation of the code
itself.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:147.65pt;margin-bottom:
0in;margin-left:61.4pt;text-indent:-24.0pt;line-height:179%'><span
style='font-size:10.0pt;line-height:179%;font-family:"Liberation Mono"'>def
approximate_size(size, a_kilobyte_is_1024_bytes=True): </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312; </span><span
style='font-size:10.0pt;line-height:179%;font-family:"Liberation Mono"'>if size
&lt; 0:   </span><span style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;
</span><span style='font-size:10.0pt;line-height:179%;font-family:"Liberation Mono"'>raise
ValueError('number must be non-negative')   </span><span style='font-family:
"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:0in;
margin-bottom:5.9pt;margin-left:239.1pt;text-align:center;line-height:107%'><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>multiple = 1024 if a_kilobyte_is_1024_bytes
else 1000</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:159.65pt;margin-bottom:
0in;margin-left:86.15pt;text-indent:-24.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>for
suffix in SUFFIXES[multiple]:     </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9316; </span><span style='font-size:10.0pt;line-height:185%;
font-family:"Liberation Mono"'>size /= multiple if size &lt; multiple:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:110.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>return '{0:.1f} {1}'.format(size, suffix)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>raise ValueError('number too large')</span></p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Code blocks are
defined by their indentation. By “code block,” I mean functions, <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>if </span>statements,
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>for
</span>loops, <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>while
</span>loops, and so forth. Indenting starts a block and unindenting ends it.
There are no explicit braces, brackets, or keywords. This means that whitespace
is significant, and must be consistent. In this example, the function code is
indented four spaces. It doesn’t need to be four spaces, it just needs to be
consistent. The first line that is not indented marks the end of the function.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.15pt;
margin-left:16.65pt;text-indent:-16.65pt;line-height:155%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>In Python, an <span
style='font-size:10.0pt;line-height:155%;font-family:"Liberation Mono"'>if </span>statement
is followed by a code block. If the <span style='font-size:10.0pt;line-height:
155%;font-family:"Liberation Mono"'>if </span>expression evaluates to true, the
indented block is executed, otherwise it falls to the <span style='font-size:
10.0pt;line-height:155%;font-family:"Liberation Mono"'>else </span>block (if
any). Note the lack of parentheses around the expression.</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>This line is
inside the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>if
</span>code block. This <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>raise </span>statement will raise an exception
(of type <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>ValueError</span>),
but only if <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>size
&lt; 0</span>.</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>This is <i>not </i>the
end of the function. Completely blank lines don’t count. They can make the code
more readable, but they don’t count as code block delimiters. The function
continues on the next line.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:20.55pt;
margin-left:16.65pt;text-indent:-16.65pt'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>for
</span>loop also marks the start of a code block. Code blocks can contain
multiple lines, as long as they are all indented the same amount. This <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>for </span>loop
has three lines of code in it. There is no other special syntax for multi-line
code blocks. Just indent and get on with your life.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:46.75pt;
margin-left:16.4pt'>After some initial protests and several snide analogies to
Fortran, you will make peace with this and start seeing its benefits. One major
benefit is that all Python programs look similar, since indentation is a
language requirement and not a matter of style. This makes it easier to read
and understand other people’s Python code.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
45.3pt;margin-left:75.95pt;text-indent:-29.3pt'><span style='font-size:24.0pt;
line-height:154%;font-family:"Calibri",sans-serif'>&#9758; </span>Python uses
carriage returns to separate statements and a colon and indentation to separate
code blocks. <span style='font-size:9.5pt;line-height:154%'>C</span>++ and Java
use semicolons to separate statements and curly braces to separate code blocks.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:3.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h2 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>1.7.
E</span>XCEPTIONS</h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:20.4pt;
margin-left:16.4pt'>Exceptions are everywhere in Python. Virtually every module
in the standard Python library uses them, and Python itself will raise them in
a lot of different circumstances. You’ll see them repeatedly throughout this
book.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.1pt;margin-bottom:20.55pt;
margin-left:16.4pt'>What is an exception? Usually it’s an error, an indication
that something went wrong. (Not all exceptions are errors, but never mind that
for now.) Some programming languages encourage the use of error return codes,
which you <i>check</i>. Python encourages the use of exceptions, which you <i>handle</i>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.1pt;margin-bottom:.25pt;
margin-left:16.4pt'>When an error occurs in the Python Shell, it prints out
some details about the exception and how it happened, and that’s that. This is
called an <i>unhandled </i>exception. When the exception was raised, there was
no code to explicitly notice it and deal with it, so it bubbled its way back up
to the top level of the Python Shell, which spits out some debugging
information and calls it a day. In the shell, that's no big deal, but if that
happened while your actual Python program was running, the entire program would
come to a screeching halt if nothing handles the exception. Maybe that’s what
you want, maybe it isn’t.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:55.6pt;margin-bottom:
36.6pt;margin-left:75.95pt;text-indent:-29.3pt;line-height:189%'><span
style='font-size:24.0pt;line-height:189%;font-family:"Calibri",sans-serif'>&#9758;
</span>Unlike Java, Python functions don’t declare which exceptions they might
raise. It’s up to you to determine what possible exceptions you need to catch.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:4.45pt;margin-bottom:
47.7pt;margin-left:16.4pt'>An exception doesn’t need to result in a complete
program crash, though. Exceptions can be <i>handled</i>. Sometimes an exception
is really because you have a bug in your code (like accessing a variable that
doesn’t exist), but sometimes an exception is something you can anticipate. If
you’re opening a file, it might not exist. If you’re importing a module, it
might not be installed. If you’re connecting to a database, it might be
unavailable, or you might not have the correct security credentials to access
it. If you know a line of code may raise an exception, you should handle the
exception using a <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>try...except </span>block.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:34.6pt;margin-bottom:
41.95pt;margin-left:75.95pt;text-indent:-29.3pt'><span style='font-size:24.0pt;
line-height:154%;font-family:"Calibri",sans-serif'>&#9758; </span>Python uses <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>try...except
</span>blocks to handle exceptions, and the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>raise </span>statement to
generate them. Java and <span style='font-size:9.5pt;line-height:154%'>C</span>++
use <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>try...catch
</span>blocks to handle exceptions, and the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>throw </span>statement to
generate them.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:19.05pt;
margin-left:16.4pt'>The <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>approximate_size() </span>function raises
exceptions in two different cases: if the given <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>size </span>is larger than the
function is designed to handle, or if it’s less than zero.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>if size &lt; 0:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>raise ValueError('number must be
non-negative')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.65in;
margin-left:16.4pt'>The syntax for raising an exception is simple enough. Use
the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>raise
</span>statement, followed by the exception name, and an optional
human-readable string for debugging purposes. The syntax is reminiscent of
calling a function. (In reality, exceptions are implemented as classes, and
this <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>raise
</span>statement is actually creating an instance of the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>ValueError
</span>class and passing the string <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>'number must be non-negative' </span>to its
initialization method. But <u>we’re getting ahead of ourselves</u>!)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:42.25pt;margin-bottom:
.25pt;margin-left:75.95pt;text-indent:-29.3pt'><span style='font-size:24.0pt;
line-height:154%;font-family:"Calibri",sans-serif'>&#9758; </span>You don’t
need to handle an exception in the function that raises it. If one function
doesn’t handle it, the exception is passed to the calling function, then that
function’s calling function, and so on “up the stack.” If the exception is
never handled, your program will crash, Python will print a “traceback” to
standard error, and that’s the</p>

<p class=MsoNormal style='margin-top:0in;margin-right:51.4pt;margin-bottom:
43.05pt;margin-left:76.4pt'>end of that. Again, maybe that’s what you want; it
depends on what your program does.</p>

<h3 style='margin-top:0in;margin-right:0in;margin-bottom:25.25pt;margin-left:
16.4pt;line-height:110%'><span style='font-size:13.0pt;line-height:110%'>1.7.1.
C</span><span style='font-size:10.5pt;line-height:110%'>ATCHING </span><span
style='font-size:13.0pt;line-height:110%'>I</span><span style='font-size:10.5pt;
line-height:110%'>MPORT </span><span style='font-size:13.0pt;line-height:110%'>E</span><span
style='font-size:10.5pt;line-height:110%'>RRORS</span></h3>

<p class=MsoNormal style='margin-top:0in;margin-right:3.9pt;margin-bottom:19.05pt;
margin-left:16.4pt'>One of Python’s built-in exceptions is <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>ImportError</span>,
which is raised when you try to import a module and fail. This can happen for a
variety of reasons, but the simplest case is when the module doesn’t exist in
your <u>import search path</u>. You can use this to include optional features
in your program. For example, <u>the </u><u><span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>chardet </span>library </u>provides
character encoding auto-detection. Perhaps your program wants to use this
library <i>if it exists</i>, but continue gracefully if the user hasn’t
installed it. You can do this with a <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>try..except </span>block.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:181.7pt;margin-bottom:
8.75pt;margin-left:37.9pt;line-height:107%'><b><span style='font-size:10.0pt;
line-height:107%;font-family:"Liberation Mono";background:gainsboro'>try</span></b><span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>import chardet</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:374.45pt;margin-bottom:
22.9pt;margin-left:49.4pt;text-indent:-12.0pt;line-height:185%'><b><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
background:gainsboro'>except </span></b><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>ImportError: chardet = None</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.95pt;margin-left:16.4pt'>Later, you can check for the presence of the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>chardet
</span>module with a simple <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>if </span>statement:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>if chardet:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:404.45pt;margin-bottom:
0in;margin-left:37.4pt;text-indent:12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'># do
something else:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.5pt;
margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'># continue anyway</span></p>

<p class=MsoNormal style='margin-left:16.4pt'>Another common use of the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>ImportError
</span>exception is when two modules implement a common <span style='font-size:
9.5pt;line-height:154%'>API</span>, but one is more desirable than the other.
(Maybe it’s faster, or it uses less memory.) You can try to import one module
but fall back to a different module if the first import fails. For example, <u>the
XML chapter </u>talks about two modules that implement a common <span
style='font-size:9.5pt;line-height:154%'>API</span>, called the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>ElementTree
</span><span style='font-size:9.5pt;line-height:154%'>API</span>. The first, <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>lxml</span>,
is a third-party module that you need to download and install yourself. The
second, <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>xml.etree.ElementTree</span>,
is slower but is part of the Python 3 standard library.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>try:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:338.45pt;margin-bottom:
0in;margin-left:37.4pt;text-indent:24.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>from
lxml import etree except ImportError:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.65pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>import xml.etree.ElementTree as etree</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:45.75pt;
margin-left:16.4pt'>By the end of this <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>try..except </span>block, you
have imported <i>some </i>module and named it <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>etree</span>. Since both
modules implement a common <span style='font-size:9.5pt;line-height:154%'>API</span>,
the rest of your code doesn’t need to keep checking which module got imported.
And since the module that <i>did </i>get imported is always called <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>etree</span>,
the rest of your code doesn’t need to be littered with <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>if </span>statements to
call differently-named modules.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:3.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h2 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>1.8.
U</span>NBOUND <span style='font-size:18.0pt;line-height:112%'>V</span>ARIABLES</h2>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.9pt;margin-left:16.4pt'>Take another look at this line of code from the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>approximate_size()
</span>function:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.35pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>multiple = 1024 if a_kilobyte_is_1024_bytes
else 1000</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.0pt;margin-bottom:19.0pt;
margin-left:16.4pt'>You never declare the variable <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>multiple</span>, you just
assign a value to it. That’s OK, because Python lets you do that. What Python
will <i>not </i>let you do is reference a variable that has never been assigned
a value. Trying to do so will raise a <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>NameError </span>exception.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.95in;margin-bottom:
8.5pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>x</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>Traceback (most
recent call last):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:248.45pt;margin-bottom:
0in;margin-left:37.4pt;text-indent:12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
color:#880000'>File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;
NameError: name 'x' is not defined</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>x = 1</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.95in;margin-bottom:
8.5pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>x</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>1</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>You will thank Python for this one
day.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:3.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h2 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>1.9.
E</span>VERYTHING IS <span style='font-size:18.0pt;line-height:112%'>C</span>ASE<span
style='font-size:18.0pt;line-height:112%'>-S</span>ENSITIVE</h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:19.05pt;
margin-left:16.4pt'>All names in Python are case-sensitive: variable names,
function names, class names, module names, exception names. If you can get it,
set it, call it, construct it, import it, or raise it, it’s case-sensitive.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>an_integer
= 1</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>an_integer</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>1</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>AN_INTEGER</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>Traceback (most
recent call last):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:248.45pt;margin-bottom:
0in;margin-left:37.4pt;text-indent:12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
color:#880000'>File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;
NameError: name 'AN_INTEGER' is not defined</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>An_Integer</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>Traceback (most
recent call last):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:248.45pt;margin-bottom:
0in;margin-left:37.4pt;text-indent:12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
color:#880000'>File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;
NameError: name 'An_Integer' is not defined</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>an_inteGer</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>Traceback (most
recent call last):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>File
&quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
31.05pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>NameError: name
'an_inteGer' is not defined</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
46.55pt;margin-left:16.4pt'>And so on.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:3.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h2 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>1.10.
R</span>UNNING <span style='font-size:18.0pt;line-height:112%'>S</span>CRIPTS</h2>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.0pt;margin-left:16.4pt'><img width=298 height=1
src="Dive%20Into%20Python%203_files/image033.gif" align=left hspace=12>Python
modules are objects and have several useful attributes. You can use this to
easily test your modules as you write them, by including a special block of
code that executes when you run the Python file on the command line. Take the
last few lines of <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>humansize.py</span>:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:175.0pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>if __name__ == '__main__':</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:8.45pt;margin-bottom:
49.05pt;margin-left:62.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>print(approximate_size(1000000000000,
False)) print(approximate_size(1000000000000))</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:51.5pt;margin-bottom:
41.25pt;margin-left:75.95pt;text-indent:-29.3pt'><span style='font-size:24.0pt;
line-height:154%;font-family:"Calibri",sans-serif'>&#9758; </span>Like <span
style='font-size:9.5pt;line-height:154%'>C</span>, Python uses <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>== </span>for
comparison and <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>=
</span>for assignment. Unlike <span style='font-size:9.5pt;line-height:154%'>C</span>,
Python does not support in-line assignment, so there’s no chance of
accidentally assigning the value you thought you were comparing.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.85pt;
margin-left:16.4pt;line-height:107%'>So what makes this <span style='font-size:
10.0pt;line-height:107%;font-family:"Liberation Mono"'>if </span>statement
special? Well, modules are objects, and all modules have a built-in attribute</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:19.05pt;
margin-left:16.4pt'><span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>__name__</span>. A module’s <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>__name__ </span>depends on how
you’re using the module. If you <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>import </span>the module, then <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__name__
</span>is the module’s filename, without a directory path or file extension.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>import
humansize</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>humansize.__name__</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'humansize'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:19.0pt;
margin-left:16.4pt'>But you can also run the module directly as a standalone
program, in which case <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>__name__ </span>will be a special default value,
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__main__</span>.
Python will evaluate this <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>if </span>statement, find a true expression, and
execute the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>if
</span>code block. In this case, to print two values.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>c:\home\diveintopython3&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>c:\python31\python.exe
humansize.py</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>1.0 TB</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>931.3 GiB</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
46.55pt;margin-left:16.4pt'>And that’s your first Python program!</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:3.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h2 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>1.11.
F</span>URTHER <span style='font-size:18.0pt;line-height:112%'>R</span>EADING</h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.0pt;
margin-left:16.65pt;text-indent:-12.25pt;line-height:107%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://www.python.org/dev/peps/pep-0257/"><span style='color:black'>PEP</span></a><u>
</u><a href="http://www.python.org/dev/peps/pep-0257/"><span style='color:black'>257:</span></a><u>
</u><a href="http://www.python.org/dev/peps/pep-0257/"><span style='color:black'>Docstring</span></a><u>
</u><a href="http://www.python.org/dev/peps/pep-0257/"><span style='color:black'>Conventions</span></a><u>
</u>explains what distinguishes a good <span style='font-size:10.0pt;
line-height:107%;font-family:"Liberation Mono"'>docstring </span>from a great <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>docstring</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:16.65pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://docs.python.org/3.1/tutorial/controlflow.html#documentation-strings"><span
style='color:black'>Python</span></a><u> </u><a
href="http://docs.python.org/3.1/tutorial/controlflow.html#documentation-strings"><span
style='color:black'>Tutorial:</span></a><u> </u><a
href="http://docs.python.org/3.1/tutorial/controlflow.html#documentation-strings"><span
style='color:black'>Documentation</span></a><u> </u><a
href="http://docs.python.org/3.1/tutorial/controlflow.html#documentation-strings"><span
style='color:black'>Strings</span></a><u> </u>also touches on the subject.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.0pt;
margin-left:16.65pt;text-indent:-12.25pt;line-height:107%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://www.python.org/dev/peps/pep-0008/"><span style='color:black'>PEP</span></a><u>
</u><a href="http://www.python.org/dev/peps/pep-0008/"><span style='color:black'>8:</span></a><u>
</u><a href="http://www.python.org/dev/peps/pep-0008/"><span style='color:black'>Style</span></a><u>
</u><a href="http://www.python.org/dev/peps/pep-0008/"><span style='color:black'>Guide</span></a><u>
</u><a href="http://www.python.org/dev/peps/pep-0008/"><span style='color:black'>for</span></a><u>
</u><a href="http://www.python.org/dev/peps/pep-0008/"><span style='color:black'>Python</span></a><u>
</u><a href="http://www.python.org/dev/peps/pep-0008/"><span style='color:black'>Code</span></a><u>
</u>discusses good indentation style.</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-12.25pt'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://docs.python.org/3.1/reference/"><i><span style='color:black'>Python</span></i></a><i><u>
</u></i><a href="http://docs.python.org/3.1/reference/"><i><span
style='color:black'>Reference</span></i></a><i><u> </u></i><a
href="http://docs.python.org/3.1/reference/"><i><span style='color:black'>Manual</span></i></a><i><u>
</u></i>explains what it means to say that <a
href="http://docs.python.org/3.1/reference/datamodel.html#objects-values-and-types"><span
style='color:black'>everything</span></a><u> </u><a
href="http://docs.python.org/3.1/reference/datamodel.html#objects-values-and-types"><span
style='color:black'>in</span></a><u> </u><a
href="http://docs.python.org/3.1/reference/datamodel.html#objects-values-and-types"><span
style='color:black'>Python</span></a><u> </u><a
href="http://docs.python.org/3.1/reference/datamodel.html#objects-values-and-types"><span
style='color:black'>is</span></a><u> </u><a
href="http://docs.python.org/3.1/reference/datamodel.html#objects-values-and-types"><span
style='color:black'>an</span></a><u> </u><a
href="http://docs.python.org/3.1/reference/datamodel.html#objects-values-and-types"><span
style='color:black'>object</span></a>, because some people are <a
href="http://www.douglasadams.com/dna/pedants.html"><span style='color:black'>pedants</span></a><u>
</u>and like to discuss that sort of thing at great length.</p>

<h1 style='margin-top:0in;margin-right:22.2pt;margin-bottom:0in;margin-left:
16.4pt;margin-bottom:.0001pt'><span style='font-size:24.0pt;line-height:107%'>C</span>HAPTER
<span style='font-size:24.0pt;line-height:107%'>2. N</span>ATIVE <span
style='font-size:24.0pt;line-height:107%'>D</span>ATATYPES</h1>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:39.9pt;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=736 height=4 id="Group 623898"
src="Dive%20Into%20Python%203_files/image001.gif"></span></p>

<p class=MsoNormal align=right style='margin-top:0in;margin-right:0in;
margin-bottom:65.45pt;margin-left:151.15pt;text-align:right;line-height:160%'><span
style='font-size:13.0pt;line-height:160%;font-family:"Calibri",sans-serif'>&#10077;
</span><i>Wonder is the foundation of all philosophy, inquiry its progress,
ignorance its end. </i><span style='font-size:13.0pt;line-height:160%;
font-family:"Calibri",sans-serif'>&#10078; </span><i>— Michel de Montaigne</i></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:65.9pt;margin-left:
16.4pt'><span style='font-size:18.0pt;line-height:112%'>2.1. D</span>IVING <span
style='font-size:18.0pt;line-height:112%'>I</span>N</h2>

<p class=MsoNormal style='margin-left:16.4pt;line-height:107%'><span
style='font-size:48.0pt;line-height:107%;font-family:"DejaVu Serif",serif;
color:#888888'>D </span>atatypes. Set aside <u>your first Python program </u>for
just a minute, and let’s talk about datatypes. In</p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.9pt;margin-bottom:20.55pt;
margin-left:16.4pt'>Python, <u>every value has a datatype</u>, but you don’t
need to declare the datatype of variables. How does that work? Based on each
variable’s original assignment, Python figures out what type it is and keeps
tracks of that internally.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
22.3pt;margin-left:16.4pt'>Python has many native datatypes. Here are the
important ones:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.55pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><b>Booleans </b>are
either <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>True
</span>or <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>False</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span><b>Numbers </b>can be integers (<span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>1 </span>and <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>2</span>),
floats (<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>1.1
</span>and <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>1.2</span>),
fractions (<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>1/2
</span>and <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>2/3</span>),
or even <a href="http://en.wikipedia.org/wiki/Complex_number"><span
style='color:black'>complex </span></a><a
href="http://en.wikipedia.org/wiki/Complex_number"><span style='color:black'>numbers</span></a>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.25pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><b>Strings </b>are
sequences of Unicode characters, <i>e.g. </i>an <span style='font-size:9.5pt;
line-height:107%'>HTML </span>document.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.05pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><b>Bytes </b>and
<b>byte arrays</b>, <i>e.g. </i>a <span style='font-size:9.5pt;line-height:
107%'>JPEG </span>image file.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>5.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><b>Lists </b>are
ordered sequences of values.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>6.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><b>Tuples </b>are
ordered, immutable sequences of values.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>7.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><b>Sets </b>are
unordered bags of values.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.45pt;margin-left:16.65pt;text-indent:-16.65pt'>8.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span><b>Dictionaries </b>are unordered bags of key-value pairs.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.4pt;margin-bottom:.25pt;
margin-left:16.4pt'>Of course, there are more types than these. <u>Everything
is an object </u>in Python, so there are types like <i>module</i>, <i>function</i>,
<i>class</i>, <i>method</i>, <i>file</i>, and even <i>compiled code</i>. You’ve
already seen some of these: <u>modules have names</u>, <u>functions have </u><u><span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>docstrings</span></u>,
<i><span style='font-size:13.0pt;line-height:154%;font-family:"DejaVu Serif",serif'>&amp;</span></i>c.
You’ll learn about classes in <u>Classes </u><i><u><span style='font-size:13.0pt;
line-height:154%;font-family:"DejaVu Serif",serif'>&amp; </span></u></i><u>Iterators</u>,
and about files in</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:17.15pt;line-height:110%'><u>Files</u>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:45.7pt;
margin-left:16.4pt'>Strings and bytes are important enough — and complicated
enough — that they get their own chapter. Let’s look at the others first.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:3.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h2 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>2.2.
B</span>OOLEANS</h2>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.45pt;margin-left:16.4pt'><img width=298 height=1
src="Dive%20Into%20Python%203_files/image033.gif" align=left hspace=12>Booleans
are either true or false. Python has two constants, cleverly named <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>True </span>and
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>False</span>,
which can be used to assign boolean values directly. Expressions can also
evaluate to a boolean value. In certain places (like <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>if </span>statements),
Python expects an expression to evaluate to a boolean value. These places are
called <i>boolean contexts</i>. You can use virtually any expression in a
boolean context, and Python will try to determine its truth value. Different
datatypes have different rules about which values are true or false in a
boolean context. (This will make more sense once you see some concrete examples
later in this chapter.)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:19.9pt;
margin-left:16.4pt'>For example, take this snippet from <u><span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>humansize.py</span></u>:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:154.0pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>if size &lt; 0:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>raise ValueError('number must be
non-negative')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:19.05pt;
margin-left:16.4pt'><span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>size </span>is an integer, 0 is an integer, and <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>&lt; </span>is
a numerical operator. The result of the expression <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>size &lt; 0 </span>is always a
boolean. You can test this yourself in the Python interactive shell:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>size =
1</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>size
&lt; 0</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>False</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>size =
0</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>size
&lt; 0</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>False</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>size =
-1</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>size
&lt; 0</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.4pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>True</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.05pt;
margin-left:16.4pt;line-height:107%'>Due to some legacy issues left over from
Python 2, booleans can be treated as numbers. <span style='font-size:10.0pt;
line-height:107%;font-family:"Liberation Mono"'>True </span>is <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>1</span>;
<span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>False
</span>is</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.75pt;margin-left:16.4pt'>0.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>True +
True</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>2</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>True -
False</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>1</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>True *
False</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>0</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>True /
False</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>Traceback (most
recent call last):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>File
&quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
31.05pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>ZeroDivisionError:
int division or modulo by zero</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
46.55pt;margin-left:16.4pt'>Ew, ew, ew! Don’t do that. Forget I even mentioned
it.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:3.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h2 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>2.3.
N</span>UMBERS</h2>

<p class=MsoNormal style='margin-top:0in;margin-right:.6pt;margin-bottom:12.9pt;
margin-left:16.4pt;line-height:107%'>Numbers are awesome. There are so many to
choose from. Python supports both integers and floating point numbers. There’s
no type declaration to distinguish them; Python tells them apart by the
presence or absence of a decimal point.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=238
 style='width:178.8pt;margin-left:38.15pt;border-collapse:collapse'>
 <tr style='height:39.3pt'>
  <td width=224 valign=top style='width:168.05pt;padding:0in 0in 0in 0in;
  height:39.3pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>type(1)</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>&lt;class
  'int'&gt;</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:39.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9312;</span></p>
  </td>
 </tr>
 <tr style='height:43.5pt'>
  <td width=224 valign=top style='width:168.05pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>isinstance(1,
  int)</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>True</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9313;</span></p>
  </td>
 </tr>
 <tr style='height:43.5pt'>
  <td width=224 valign=top style='width:168.05pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>1
  + 1</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>2</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9314;</span></p>
  </td>
 </tr>
 <tr style='height:18.3pt'>
  <td width=224 valign=bottom style='width:168.05pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono";
  color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
  107%;font-family:"Liberation Mono"'>1 + 1.0</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9315;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>2.0</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>type(2.0)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.3pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;class 'float'&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.05pt;margin-bottom:
1.75pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>You can use the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>type() </span>function to check the type of any
value or variable. As you might expect, <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>1 </span>is an <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>int</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.05pt;margin-bottom:
6.9pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Similarly, you
can use the <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>isinstance()
</span>function to check whether a value or variable is of a given type.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.05pt;margin-bottom:
6.8pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Adding an <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>int </span>to
an <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>int
</span>yields an <span style='font-size:10.0pt;line-height:107%;font-family:
"Liberation Mono"'>int</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.05pt;margin-bottom:
22.15pt;margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Adding an <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>int </span>to a <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>float </span>yields a <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>float</span>.
Python coerces the <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>int </span>into a <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>float </span>to perform the addition, then
returns a <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>float
</span>as the result.</p>

<h3 style='margin-top:0in;margin-right:0in;margin-bottom:25.25pt;margin-left:
16.4pt;line-height:110%'><span style='font-size:13.0pt;line-height:110%'>2.3.1.
C</span><span style='font-size:10.5pt;line-height:110%'>OERCING </span><span
style='font-size:13.0pt;line-height:110%'>I</span><span style='font-size:10.5pt;
line-height:110%'>NTEGERS </span><span style='font-size:13.0pt;line-height:
110%'>T</span><span style='font-size:10.5pt;line-height:110%'>O </span><span
style='font-size:13.0pt;line-height:110%'>F</span><span style='font-size:10.5pt;
line-height:110%'>LOATS </span><span style='font-size:13.0pt;line-height:110%'>A</span><span
style='font-size:10.5pt;line-height:110%'>ND </span><span style='font-size:
13.0pt;line-height:110%'>V</span><span style='font-size:10.5pt;line-height:
110%'>ICE</span><span style='font-size:13.0pt;line-height:110%'>-V</span><span
style='font-size:10.5pt;line-height:110%'>ERSA</span></h3>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.0pt;
margin-left:16.4pt;line-height:107%'>As you just saw, some operators (like
addition) will coerce integers to floating point numbers as needed.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>You can also coerce them by
yourself.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>float(2)                </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.45pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>2.0</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>int(2.0)                </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.45pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>2</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>int(2.5)                </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.45pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>2</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>int(-2.5)               </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>-2</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>1.12345678901234567890
</span><span style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9316;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>1.1234567890123457</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>type(1000000000000000)
</span><span style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9317;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.8pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;class 'int'&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.7pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>You can
explicitly coerce an <span style='font-size:10.0pt;line-height:107%;font-family:
"Liberation Mono"'>int </span>to a <span style='font-size:10.0pt;line-height:
107%;font-family:"Liberation Mono"'>float </span>by calling the <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>float()
</span>function.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.4pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Unsurprisingly,
you can also coerce a <span style='font-size:10.0pt;line-height:107%;
font-family:"Liberation Mono"'>float </span>to an <span style='font-size:10.0pt;
line-height:107%;font-family:"Liberation Mono"'>int </span>by calling <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>int()</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.2pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>int() </span>function
will truncate, not round.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.05pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>int() </span>function
truncates negative numbers towards 0. It’s a true truncate function, not a
floor function.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>5.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Floating point
numbers are accurate to 15 decimal places.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
48.2pt;margin-left:16.65pt;text-indent:-16.65pt'>6.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Integers can be arbitrarily large.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:61.15pt;margin-bottom:
43.0pt;margin-left:75.95pt;text-indent:-29.3pt'><span style='font-size:24.0pt;
line-height:154%;font-family:"Calibri",sans-serif'>&#9758; </span>Python 2 had
separate types for <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>int </span>and <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>long</span>. The <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>int </span>datatype was
limited by <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>sys.maxint</span>,
which varied by platform but was usually <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>2</span><sup><span
style='font-family:"Liberation Mono"'>32</span></sup><span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>-1</span>. Python 3 has
just one integer type, which behaves mostly like the old <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>long </span>type
from Python 2. See <a href="http://www.python.org/dev/peps/pep-0237"><span
style='font-size:9.5pt;line-height:154%;color:black'>PEP </span></a><a
href="http://www.python.org/dev/peps/pep-0237"><span style='color:black'>237</span></a><u>
</u>for details.</p>

<h3 style='margin-top:0in;margin-right:0in;margin-bottom:25.25pt;margin-left:
16.4pt;line-height:110%'><span style='font-size:13.0pt;line-height:110%'>2.3.2.
C</span><span style='font-size:10.5pt;line-height:110%'>OMMON </span><span
style='font-size:13.0pt;line-height:110%'>N</span><span style='font-size:10.5pt;
line-height:110%'>UMERICAL </span><span style='font-size:13.0pt;line-height:
110%'>O</span><span style='font-size:10.5pt;line-height:110%'>PERATIONS</span></h3>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>You can do all kinds of things with
numbers.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=142
 style='width:106.75pt;margin-left:38.15pt;border-collapse:collapse'>
 <tr style='height:39.3pt'>
  <td width=128 valign=top style='width:96.0pt;padding:0in 0in 0in 0in;
  height:39.3pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>11
  / 2</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>5.5</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:39.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9312;</span></p>
  </td>
 </tr>
 <tr style='height:43.5pt'>
  <td width=128 valign=top style='width:96.0pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>11
  // 2</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>5</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9313;</span></p>
  </td>
 </tr>
 <tr style='height:43.5pt'>
  <td width=128 valign=top style='width:96.0pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>&#8722;11
  // 2</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>&#8722;6</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9314;</span></p>
  </td>
 </tr>
 <tr style='height:43.5pt'>
  <td width=128 valign=top style='width:96.0pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>11.0
  // 2</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>5.0</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9315;</span></p>
  </td>
 </tr>
 <tr style='height:43.5pt'>
  <td width=128 valign=top style='width:96.0pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>11
  ** 2</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>121</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9316;</span></p>
  </td>
 </tr>
 <tr style='height:18.3pt'>
  <td width=128 valign=bottom style='width:96.0pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono";
  color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
  107%;font-family:"Liberation Mono"'>11 % 2</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9317;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.3pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>1</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.55pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>/
</span>operator performs floating point division. It returns a <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>float </span>even
if both the numerator and denominator are <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>int</span>s.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.55pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>//
</span>operator performs a quirky kind of integer division. When the result is
positive, you can think of it as truncating (not rounding) to 0 decimal places,
but be careful with that.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.55pt;margin-bottom:
.15pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:155%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>When
integer-dividing negative numbers, the <span style='font-size:10.0pt;
line-height:155%;font-family:"Liberation Mono"'>// </span>operator rounds “up”
to the nearest integer. Mathematically speaking, it’s rounding “down” since <span
style='font-size:10.0pt;line-height:155%;font-family:"Liberation Mono"'>&#8722;6
</span>is less than <span style='font-size:10.0pt;line-height:155%;font-family:
"Liberation Mono"'>&#8722;5</span>, but it could trip you up if you were
expecting it to truncate to <span style='font-size:10.0pt;line-height:155%;
font-family:"Liberation Mono"'>&#8722;5</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.55pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>//
</span>operator doesn’t always return an integer. If either the numerator or
denominator is a <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>float</span>, it will still round to the nearest integer,
but the actual return value will be a <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>float</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.55pt;margin-bottom:
6.6pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>5.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>** </span>operator
means “raised to the power of.” <span style='font-size:10.0pt;line-height:107%;
font-family:"Liberation Mono"'>11</span><sup><span style='font-family:"Liberation Mono"'>2
</span></sup>is <span style='font-size:10.0pt;line-height:107%;font-family:
"Liberation Mono"'>121</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.55pt;margin-bottom:
46.9pt;margin-left:16.65pt;text-indent:-16.65pt'>6.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>%
</span>operator gives the remainder after performing integer division. <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>11 </span>divided
by <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>2
</span>is <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>5
</span>with a remainder of <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>1</span>, so the result here is <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>1</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:63.2pt;margin-bottom:
.25pt;margin-left:75.95pt;text-indent:-29.3pt'><span style='font-size:24.0pt;
line-height:154%;font-family:"Calibri",sans-serif'>&#9758; </span>In Python 2,
the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>/
</span>operator usually meant integer division, but you could make it behave
like floating point division by including a special directive in your code. In
Python 3, the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>/
</span>operator always means floating point division. See <a
href="http://www.python.org/dev/peps/pep-0238/"><span style='font-size:9.5pt;
line-height:154%;color:black'>PEP</span></a><u><span style='font-size:9.5pt;
line-height:154%'> </span></u><a href="http://www.python.org/dev/peps/pep-0238/"><span
style='color:black'>238</span></a><u> </u>for details.</p>

<h3 style='margin-top:0in;margin-right:0in;margin-bottom:25.25pt;margin-left:
16.4pt;line-height:110%'><span style='font-size:13.0pt;line-height:110%'>2.3.3.
F</span><span style='font-size:10.5pt;line-height:110%'>RACTIONS</span></h3>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:23.1pt;
margin-left:16.4pt'>Python isn’t limited to integers and floating point
numbers. It can also do all the fancy math you learned in high school and
promptly forgot about.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.85pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>import fractions              </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>x =
fractions.Fraction(1, 3) </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.95in;margin-bottom:
8.5pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>x</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.3pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>Fraction(1, 3)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>x * 2                         </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>Fraction(2, 3)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>fractions.Fraction(6, 4)      </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>Fraction(3, 2)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>fractions.Fraction(0, 0)      </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9316;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>Traceback (most
recent call last):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>File
&quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:182.45pt;margin-bottom:
0in;margin-left:62.15pt;text-indent:-12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
color:#880000'>File &quot;fractions.py&quot;, line 96, in __new__ raise
ZeroDivisionError('Fraction(%s, 0)' % numerator)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
31.65pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>ZeroDivisionError:
Fraction(0, 0)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.35pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>To start using
fractions, import the <span style='font-size:10.0pt;line-height:107%;
font-family:"Liberation Mono"'>fractions </span>module.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.3pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>To define a
fraction, create a <span style='font-size:10.0pt;line-height:107%;font-family:
"Liberation Mono"'>Fraction </span>object and pass in the numerator and
denominator.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
1.3pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>You can perform all the usual mathematical operations with fractions.
Operations return a new <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>Fraction </span>object. <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>2 * (1/3) = (2/3)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>Fraction
</span>object will automatically reduce fractions. <span style='font-size:10.0pt;
line-height:107%;font-family:"Liberation Mono"'>(6/4) = (3/2)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:288%'>5.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Python has the
good sense not to create a fraction with a zero denominator. <b><span
style='font-size:13.0pt;line-height:288%;font-family:"DejaVu Serif",serif'>2.3.4.
T</span></b><b><span style='font-size:10.5pt;line-height:288%;font-family:"DejaVu Serif",serif'>RIGONOMETRY</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>You can also do basic trigonometry
in Python.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.4pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>import
math</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>math.pi                </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>3.1415926535897931</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>math.sin(math.pi
/ 2) </span><span style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>1.0</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>math.tan(math.pi
/ 4) </span><span style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.2pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>0.99999999999999989</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.7pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>math </span>module
has a constant for &#960;, the ratio of a circle’s circumference to its
diameter.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
1.85pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>math
</span>module has all the basic trigonometric functions, including <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>sin()</span>,
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>cos()</span>,
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>tan()</span>,
and variants like <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>asin()</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
8.8pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Note, however,
that Python does not have infinite precision. <span style='font-size:10.0pt;
line-height:107%;font-family:"Liberation Mono"'>tan(&#960; / 4) </span>should
return <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>1.0</span>,
not</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:28.15pt;
margin-left:17.15pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>0.99999999999999989</span>.</p>

<h3 style='margin-top:0in;margin-right:0in;margin-bottom:25.25pt;margin-left:
16.4pt;line-height:110%'><span style='font-size:13.0pt;line-height:110%'>2.3.5.
N</span><span style='font-size:10.5pt;line-height:110%'>UMBERS </span><span
style='font-size:13.0pt;line-height:110%'>I</span><span style='font-size:10.5pt;
line-height:110%'>N </span><span style='font-size:13.0pt;line-height:110%'>A B</span><span
style='font-size:10.5pt;line-height:110%'>OOLEAN </span><span style='font-size:
13.0pt;line-height:110%'>C</span><span style='font-size:10.5pt;line-height:
110%'>ONTEXT</span></h3>

<p class=MsoNormal style='margin-left:16.4pt'>You can use numbers <u>in a
boolean context</u>, such as an <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>if </span>statement. Zero values are false, and
non-zero values are true.      <span style='font-size:11.0pt;line-height:154%;
font-family:"Calibri",sans-serif'><img border=0 width=298 height=338
src="Dive%20Into%20Python%203_files/image034.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def is_it_true(anything):             </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>...   </span><span style='font-size:10.0pt;line-height:110%;
font-family:"Liberation Mono"'>if anything:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:37.9pt;line-height:185%'><img width=298 height=1
src="Dive%20Into%20Python%203_files/image033.gif" align=left hspace=12><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
color:#666677'>...   </span><span style='font-size:10.0pt;line-height:185%;
font-family:"Liberation Mono"'>print(&quot;yes, it's true&quot;) </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
color:#666677'>...   </span><span style='font-size:10.0pt;line-height:185%;
font-family:"Liberation Mono"'>else:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:4.0pt;
margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;line-height:
185%;font-family:"Liberation Mono";color:#666677'>...   </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>print(&quot;no,
it's false&quot;) </span><span style='font-size:10.0pt;line-height:185%;
font-family:"Liberation Mono";color:#666677'>...</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:4.05pt;
margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;line-height:
185%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>is_it_true(1) </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313; </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>yes,
it's true </span><span style='font-size:10.0pt;line-height:185%;font-family:
"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span style='font-size:
10.0pt;line-height:185%;font-family:"Liberation Mono"'>is_it_true(-1) yes, it's
true </span><span style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
185%;font-family:"Liberation Mono"'>is_it_true(0) no, it's false</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:267.65pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>is_it_true(0.1)     </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314; </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>yes,
it's true </span><span style='font-size:10.0pt;line-height:185%;font-family:
"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span style='font-size:
10.0pt;line-height:185%;font-family:"Liberation Mono"'>is_it_true(0.0) no, it's
false</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>import
fractions</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:243.65pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>is_it_true(fractions.Fraction(1,
2)) </span><span style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9315;
</span><span style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>yes,
it's true</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:272.45pt;margin-bottom:
22.7pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>is_it_true(fractions.Fraction(0,
1)) no, it's false</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
1.3pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Did you know you can define your own functions in the Python interactive
shell? Just press <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>ENTER </span>at the end of each line, and <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>ENTER </span>on
a blank line to finish.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.1pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>In a boolean
context, non-zero integers are true; 0 is false.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Non-zero floating point numbers are true; <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>0.0 </span>is false. Be careful
with this one! If there’s the slightest rounding error (not impossible, as you
saw in the previous section) then Python will be testing</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.5pt;margin-left:16.4pt;line-height:107%'><span style='font-size:10.0pt;
line-height:107%;font-family:"Liberation Mono"'>0.0000000000001 </span>instead
of 0 and will return <span style='font-size:10.0pt;line-height:107%;font-family:
"Liberation Mono"'>True</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
45.7pt;margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Fractions can also be used in a boolean context. <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>Fraction(0, n) </span>is
false for all values of <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>n</span>. All other fractions are true.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:3.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:17.4pt;margin-left:
16.4pt;line-height:110%'><span style='font-size:18.0pt;line-height:110%'>2.4. L</span>ISTS</h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:46.85pt;
margin-left:16.4pt'>Lists are Python’s workhorse datatype. When I say “list,”
you might be thinking “array whose size I have to declare in advance, that can
only contain items of the same type, <i><span style='font-size:13.0pt;
line-height:154%;font-family:"DejaVu Serif",serif'>&amp;</span></i>c.” Don’t
think that. Lists are much cooler than that.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:50.25pt;margin-bottom:
46.4pt;margin-left:75.95pt;text-indent:-29.3pt'><span style='font-size:24.0pt;
line-height:154%;font-family:"Calibri",sans-serif'>&#9758; </span>A list in
Python is like an array in Perl 5. In Perl 5, variables that store arrays
always start with the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>@ </span>character; in Python, variables can be
named anything, and Python keeps track of the datatype internally.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:52.4pt;margin-bottom:
42.4pt;margin-left:75.95pt;text-indent:-29.3pt'><span style='font-size:24.0pt;
line-height:154%;font-family:"Calibri",sans-serif'>&#9758; </span>A list in
Python is much more than an array in Java (although it can be used as one if
that’s really all you want out of life). A better analogy would be to the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>ArrayList
</span>class, which can hold arbitrary objects and can expand dynamically as
new items are added.</p>

<h3 style='margin-top:0in;margin-right:0in;margin-bottom:25.25pt;margin-left:
16.4pt;line-height:110%'><span style='font-size:13.0pt;line-height:110%'>2.4.1.
C</span><span style='font-size:10.5pt;line-height:110%'>REATING </span><span
style='font-size:13.0pt;line-height:110%'>A L</span><span style='font-size:
10.5pt;line-height:110%'>IST</span></h3>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
24.1pt;margin-left:16.4pt'>Creating a list is easy: use square brackets to wrap
a comma-separated list of values.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>a_list
= ['a', 'b', 'mpilgrim', 'z', 'example'] </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>a_list</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.45pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>['a', 'b', 'mpilgrim', 'z', 'example']</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>a_list[0]                                        </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.45pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'a'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>a_list[4]                                        </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.5pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'example'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>a_list[-1]                                       </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.5pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'example'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>a_list[-3]                                       </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9316;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'mpilgrim'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.6pt;margin-bottom:.25pt;
margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>First, you define a list of five items. Note that they retain their
original order. This is not an accident. A list is an ordered set of items.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.6pt;margin-bottom:6.45pt;
margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>A list can be
used like a zero-based array. The first item of any non-empty list is always <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>a_list[0]</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.6pt;margin-bottom:6.05pt;
margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The last item of
this five-item list is <span style='font-size:10.0pt;line-height:107%;
font-family:"Liberation Mono"'>a_list[4]</span>, because lists are always
zero-based.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.6pt;margin-bottom:.25pt;
margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>A negative index accesses items from the end of the list counting
backwards. The last item of any non-empty list is always <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>a_list[-1]</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.6pt;margin-bottom:21.3pt;
margin-left:16.65pt;text-indent:-16.65pt'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>If the negative index is confusing to you, think of it this way: <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>a_list[-n]
== a_list[len(a_list) - n]</span>. So in this list, <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>a_list[-3] == a_list[5 -
3] == a_list[2]</span>.</p>

<h3 style='margin-top:0in;margin-right:0in;margin-bottom:25.25pt;margin-left:
16.4pt;line-height:110%'><span style='font-size:13.0pt;line-height:110%'>2.4.2.
S</span><span style='font-size:10.5pt;line-height:110%'>LICING </span><span
style='font-size:13.0pt;line-height:110%'>A L</span><span style='font-size:
10.5pt;line-height:110%'>IST</span></h3>

<p class=MsoNormal style='margin-top:0in;margin-right:265.75pt;margin-bottom:
19.05pt;margin-left:16.4pt'>Once you’ve defined a list, you can get any part of
it as a new list. This is called <i>slicing </i>the list.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><img width=298 height=1
src="Dive%20Into%20Python%203_files/image033.gif" align=left hspace=12><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>a_list</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.5pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>['a', 'b', 'mpilgrim', 'z', 'example']</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>a_list[1:3]            </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.5pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>['b', 'mpilgrim']</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>a_list[1:-1]           </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.5pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>['b', 'mpilgrim', 'z']</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>a_list[0:3]            </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.5pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>['a', 'b', 'mpilgrim']</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>a_list[:3]             </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.5pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>['a', 'b', 'mpilgrim']</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>a_list[3:]             </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9316;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.45pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>['z', 'example']</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>a_list[:]              </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9317;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>['a', 'b', 'mpilgrim', 'z', 'example']</span></p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>You can get a
part of a list, called a “slice”, by specifying two indices. The return value
is a new list containing all the items of the list, in order, starting with the
first slice index (in this case <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>a_list[1]</span>), up to but not including the
second slice index (in this case <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>a_list[3]</span>).</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Slicing works if
one or both of the slice indices is negative. If it helps, you can think of it
this way: reading the list from left to right, the first slice index specifies
the first item you want, and the second slice index specifies the first item you
don’t want. The return value is everything in between.</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Lists are
zero-based, so <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>a_list[0:3]
</span>returns the first three items of the list, starting at <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>a_list[0]</span>,
up to but not including <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>a_list[3]</span>.</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>If the left
slice index is 0, you can leave it out, and 0 is implied. So <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>a_list[:3]
</span>is the same as <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>a_list[0:3]</span>, because the starting 0 is
implied.</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>5.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Similarly, if
the right slice index is the length of the list, you can leave it out. So <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>a_list[3:]
</span>is the same as <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>a_list[3:5]</span>, because this list has five
items. There is a pleasing symmetry here. In this five-item list, <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>a_list[:3]
</span>returns the first 3 items, and <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>a_list[3:] </span>returns the last two
items. In fact, <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>a_list[:n] </span>will always return the first <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>n </span>items,
and <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>a_list[n:]
</span>will return the rest, regardless of the length of the list.</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt;line-height:
107%'>6.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>If
both slice indices are left out, all items of the list are included. But this
is not the same as the original <span style='font-size:10.0pt;line-height:107%;
font-family:"Liberation Mono"'>a_list </span>variable. It is a new list that
happens to have all the same items. <span style='font-size:10.0pt;line-height:
107%;font-family:"Liberation Mono"'>a_list[:] </span>is shorthand for making</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=315
 style='width:236.35pt;margin-left:16.65pt;border-collapse:collapse'>
 <tr style='height:83.25pt'>
  <td width=315 colspan=2 valign=top style='width:236.35pt;padding:0in 0in 0in 0in;
  height:83.25pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:28.3pt;
  margin-left:0in;text-indent:0in;line-height:107%'>a complete copy of a list.</p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><b><span
  style='font-size:13.0pt;line-height:107%;font-family:"DejaVu Serif",serif'>2.4.3.
  A</span></b><b><span style='font-size:10.5pt;line-height:107%;font-family:
  "DejaVu Serif",serif'>DDING </span></b><b><span style='font-size:13.0pt;
  line-height:107%;font-family:"DejaVu Serif",serif'>I</span></b><b><span
  style='font-size:10.5pt;line-height:107%;font-family:"DejaVu Serif",serif'>TEMS
  </span></b><b><span style='font-size:13.0pt;line-height:107%;font-family:
  "DejaVu Serif",serif'>T</span></b><b><span style='font-size:10.5pt;
  line-height:107%;font-family:"DejaVu Serif",serif'>O </span></b><b><span
  style='font-size:13.0pt;line-height:107%;font-family:"DejaVu Serif",serif'>A
  L</span></b><b><span style='font-size:10.5pt;line-height:107%;font-family:
  "DejaVu Serif",serif'>IST</span></b></p>
  </td>
 </tr>
 <tr style='height:58.8pt'>
  <td width=301 valign=top style='width:225.55pt;padding:0in 0in 0in 0in;
  height:58.8pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:25.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'>There are four ways to add
  items to a list.</p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
  margin-left:21.55pt;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>a_list
  = ['a']</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:58.8pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.0pt;
  margin-left:0in;text-indent:0in;line-height:107%'>&nbsp;</p>
  </td>
 </tr>
 <tr style='height:22.5pt'>
  <td width=301 valign=top style='width:225.55pt;padding:0in 0in 0in 0in;
  height:22.5pt'>
  <p class=MsoNormal align=center style='margin-top:0in;margin-right:2.5pt;
  margin-bottom:0in;margin-left:0in;text-align:center;text-indent:0in;
  line-height:107%'><span style='font-size:10.0pt;line-height:107%;font-family:
  "Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>a_list = a_list +
  [2.0, 3]</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:22.5pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9312;</span></p>
  </td>
 </tr>
 <tr style='height:43.5pt'>
  <td width=301 valign=top style='width:225.55pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:114.05pt;margin-bottom:
  0in;margin-left:21.55pt;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono";
  color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
  107%;font-family:"Liberation Mono"'>a_list ['a', 2.0, 3]</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9313;</span></p>
  </td>
 </tr>
 <tr style='height:64.5pt'>
  <td width=301 valign=top style='width:225.55pt;padding:0in 0in 0in 0in;
  height:64.5pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:21.55pt;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>a_list.append(True)</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:21.55pt;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>a_list</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
  margin-left:21.55pt;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>['a', 2.0, 3, True]</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:64.5pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9314;</span></p>
  </td>
 </tr>
 <tr style='height:64.5pt'>
  <td width=301 valign=top style='width:225.55pt;padding:0in 0in 0in 0in;
  height:64.5pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
  margin-left:21.55pt;text-indent:0in;line-height:185%'><span style='font-size:
  10.0pt;line-height:185%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>a_list.extend(['four',
  '&#937;']) </span><span style='font-size:10.0pt;line-height:185%;font-family:
  "Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span style='font-size:
  10.0pt;line-height:185%;font-family:"Liberation Mono"'>a_list</span></p>
  <p class=MsoNormal align=center style='margin-top:0in;margin-right:0in;
  margin-bottom:0in;margin-left:9.5pt;text-align:center;text-indent:0in;
  line-height:107%'><span style='font-size:10.0pt;line-height:107%;font-family:
  "Liberation Mono"'>['a', 2.0, 3, True, 'four', '&#937;']</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:64.5pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9315;</span></p>
  </td>
 </tr>
 <tr style='height:18.3pt'>
  <td width=301 valign=bottom style='width:225.55pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
  margin-left:21.55pt;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>a_list.insert(0,
  '&#937;')</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9316;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>a_list</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>['&#937;', 'a', 2.0, 3, True, 'four',
'&#937;']</span></p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>+ </span>operator
concatenates lists to create a new list. A list can contain any number of
items; there is no size limit (other than available memory). However, if memory
is a concern, you should be aware that list concatenation creates a second list
in memory. In this case, that new list is immediately assigned to the existing
variable <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>a_list</span>.
So this line of code is really a two-step process — concatenation then
assignment — which can (temporarily) consume a lot of memory when you’re
dealing with large lists.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.0pt;
margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>A list can
contain items of any datatype, and the items in a single list don’t all need to
be the same type.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.25pt;margin-left:16.4pt;line-height:107%'>Here we have a list containing a
string, a floating point number, and an integer.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.05pt;
margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>append()
</span>method adds a single item to the end of the list. (Now we have <i>four </i>different
datatypes in the</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
5.85pt;margin-left:16.4pt;line-height:107%'>list!)</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Lists are
implemented as classes. “Creating” a list is really instantiating a class. As
such, a list has methods that operate on it. The <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>extend() </span>method takes
one argument, a list, and appends each of the items of the argument to the
original list.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:48.2pt;
margin-left:16.65pt;text-indent:-16.65pt'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>insert()
</span>method inserts a single item into a list. The first argument is the
index of the first item in the list that will get bumped out of position. List
items do not need to be unique; for example, there are now two separate items
with the value <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>'&#937;'</span>:
the first item, <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>a_list[0]</span>, and the last item, <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>a_list[6]</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:59.95pt;margin-bottom:
42.05pt;margin-left:75.95pt;text-indent:-29.3pt'><span style='font-size:24.0pt;
line-height:154%;font-family:"Calibri",sans-serif'>&#9758; </span><span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>a_list.insert(0,
value) </span>is like the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>unshift() </span>function in Perl. It adds an
item to the beginning of the list, and all the other items have their
positional index bumped up to make room.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>Let’s look closer at the difference
between <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>append()
</span>and <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>extend()</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>a_list
= ['a', 'b', 'c']</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>a_list.extend(['d',
'e', 'f']) </span><span style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>a_list</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.5pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>['a', 'b', 'c', 'd', 'e', 'f']</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>len(a_list)                     </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>6</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>a_list[-1]</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'f'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>a_list.append(['g',
'h', 'i']) </span><span style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>a_list</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.5pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>['a', 'b', 'c', 'd', 'e', 'f', ['g', 'h',
'i']]</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>len(a_list)                     </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>7</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>a_list[-1]</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.35pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>['g', 'h', 'i']</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:1.4pt;
margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>extend()
</span>method takes a single argument, which is always a list, and adds each of
the items of that list to <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>a_list</span>.</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>If you start
with a list of three items and extend it with a list of another three items,
you end up with a list of six items.</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>On the other
hand, the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>append()
</span>method takes a single argument, which can be any datatype. Here, you’re
calling the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>append()
</span>method with a list of three items.</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>If you start
with a list of six items and append a list onto it, you end up with... a list
of seven items. Why seven? Because the last item (which you just appended) <i>is
itself a list</i>. Lists can contain any type of data, including other lists.
That may be what you want, or it may not. But it’s what you asked for, and it’s
what you got.</p>

<h3 style='margin-top:0in;margin-right:0in;margin-bottom:22.8pt;margin-left:
16.4pt;line-height:110%'><span style='font-size:13.0pt;line-height:110%'>2.4.4.
S</span><span style='font-size:10.5pt;line-height:110%'>EARCHING </span><span
style='font-size:13.0pt;line-height:110%'>F</span><span style='font-size:10.5pt;
line-height:110%'>OR </span><span style='font-size:13.0pt;line-height:110%'>V</span><span
style='font-size:10.5pt;line-height:110%'>ALUES </span><span style='font-size:
13.0pt;line-height:110%'>I</span><span style='font-size:10.5pt;line-height:
110%'>N </span><span style='font-size:13.0pt;line-height:110%'>A L</span><span
style='font-size:10.5pt;line-height:110%'>IST</span></h3>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.6pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>a_list
= ['a', 'b', 'new', 'mpilgrim', 'new']</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>a_list.count('new')       </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.55pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>2</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'new' in a_list           </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>True</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>'c' in
a_list</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>False</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>a_list.index('mpilgrim')
</span><span style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.6pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>3</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>a_list.index('new')       </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.6pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>2</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>a_list.index('c')         </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9316;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>Traceback
(innermost last):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>File
&quot;&lt;interactive input&gt;&quot;, line 1, in ?</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
31.3pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>ValueError:
list.index(x): x not in list</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.1pt;
margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>As you might
expect, the <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>count()
</span>method returns the number of occurrences of a specific value in a list.</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>If all you want
to know is whether a value is in the list or not, the <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>in </span>operator is
slightly faster than using the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>count() </span>method. The <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>in </span>operator
always returns <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>True
</span>or <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>False</span>;
it will not tell you how many times the value appears in the list.</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Neither the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>in </span>operator
nor the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>count()
</span>method will tell you <i>where </i>in the list a value appears. If you
need to know where in the list a value is, call the <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>index() </span>method.
By default it will search the entire list, although you can specify an optional
second argument of the (0-based) index to start from, and even an optional
third argument of the (0-based) index to stop searching.</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>index()
</span>method finds the <i>first </i>occurrence of a value in the list. In this
case, <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>'new'
</span>occurs twice in the list, in <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>a_list[2] </span>and <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>a_list[4]</span>,
but the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>index()
</span>method will return only the index of the first occurrence.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:21.75pt;
margin-left:16.65pt;text-indent:-16.65pt'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>As you might <i>not </i>expect, if the value is not found in the list,
the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>index()
</span>method will raise an exception.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:22.1pt;
margin-left:16.4pt'>Wait, what? That’s right: the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>index() </span>method raises an
exception if it doesn’t find the value in the list. This is notably different
from most languages, which will return some invalid index (like <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>-1</span>).
While this may seem annoying at first, I think you will come to appreciate it.
It means your program will crash at the source of the problem instead of
failing strangely and silently later. Remember, <u><span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>-1 </span>is a valid list index</u>.
If the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>index()
</span>method returned <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>-1</span>, that could lead to some not-so-fun
debugging sessions!</p>

<h3 style='margin-top:0in;margin-right:0in;margin-bottom:25.25pt;margin-left:
16.4pt;line-height:110%'><span style='font-size:13.0pt;line-height:110%'>2.4.5.
R</span><span style='font-size:10.5pt;line-height:110%'>EMOVING </span><span
style='font-size:13.0pt;line-height:110%'>I</span><span style='font-size:10.5pt;
line-height:110%'>TEMS </span><span style='font-size:13.0pt;line-height:110%'>F</span><span
style='font-size:10.5pt;line-height:110%'>ROM </span><span style='font-size:
13.0pt;line-height:110%'>A L</span><span style='font-size:10.5pt;line-height:
110%'>IST</span></h3>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.8pt;
margin-left:16.4pt'>Lists can expand and contract automatically. You’ve seen
the expansion part. There are several different ways to remove items from a
list as well. <span style='font-size:11.0pt;line-height:154%;font-family:"Calibri",sans-serif'><img
border=0 width=298 height=226 src="Dive%20Into%20Python%203_files/image035.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>a_list
= ['a', 'b', 'new', 'mpilgrim', 'new']</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>a_list[1]</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.55pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'b'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>del a_list[1]         </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>a_list</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.45pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>['a', 'new', 'mpilgrim', 'new']</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>a_list[1]             </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.2pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'new'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:15.25pt;margin-bottom:
6.15pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>You can use the <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>del </span>statement
to delete a specific item from a list.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:15.25pt;margin-bottom:
20.55pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Accessing index <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>1 </span>after deleting index <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>1 </span>does
<i>not </i>result in an error. All items after the deleted item shift their
positional index to “fill the gap” created by deleting the item.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>Don’t know the positional index? Not
a problem; you can remove items by value instead.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>a_list.remove('new')
</span><span style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>a_list</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.6pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>['a', 'mpilgrim', 'new']</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>a_list.remove('new')
</span><span style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>a_list</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>['a', 'mpilgrim']</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>a_list.remove('new')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>Traceback (most
recent call last):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>File
&quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
31.65pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>ValueError:
list.remove(x): x not in list</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:.25pt;
margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>You can also remove an item from a list with the <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>remove() </span>method.
The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>remove()
</span>method takes a <i>value </i>and removes the first occurrence of that
value from the list. Again, all items after the deleted item will have their
positional indices bumped down to “fill the gap.” Lists never have gaps.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:22.15pt;
margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>You can call the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>remove() </span>method as often as you like, but
it will raise an exception if you try to remove a value that isn’t in the list.</p>

<h3 style='margin-top:0in;margin-right:0in;margin-bottom:25.25pt;margin-left:
16.4pt;line-height:110%'><span style='font-size:13.0pt;line-height:110%'>2.4.6.
R</span><span style='font-size:10.5pt;line-height:110%'>EMOVING </span><span
style='font-size:13.0pt;line-height:110%'>I</span><span style='font-size:10.5pt;
line-height:110%'>TEMS </span><span style='font-size:13.0pt;line-height:110%'>F</span><span
style='font-size:10.5pt;line-height:110%'>ROM </span><span style='font-size:
13.0pt;line-height:110%'>A L</span><span style='font-size:10.5pt;line-height:
110%'>IST</span><span style='font-size:13.0pt;line-height:110%'>: B</span><span
style='font-size:10.5pt;line-height:110%'>ONUS </span><span style='font-size:
13.0pt;line-height:110%'>R</span><span style='font-size:10.5pt;line-height:
110%'>OUND</span></h3>

<p class=MsoNormal style='margin-left:16.4pt'>Another interesting list method
is <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>pop()</span>.
The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>pop()
</span>method is yet another way to <u>remove items from a list</u>, but with a
twist.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>a_list
= ['a', 'b', 'new', 'mpilgrim']</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=166
 style='width:124.75pt;margin-left:38.15pt;border-collapse:collapse'>
 <tr style='height:81.3pt'>
  <td width=152 valign=top style='width:114.0pt;padding:0in 0in 0in 0in;
  height:81.3pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>a_list.pop()</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:.5in;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:185%'><span style='font-size:
  10.0pt;line-height:185%;font-family:"Liberation Mono"'>'mpilgrim' </span><span
  style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
  color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
  185%;font-family:"Liberation Mono"'>a_list</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>['a',
  'b', 'new']</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:81.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9312;</span></p>
  </td>
 </tr>
 <tr style='height:169.5pt'>
  <td width=152 valign=top style='width:114.0pt;padding:0in 0in 0in 0in;
  height:169.5pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>a_list.pop(1)</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>'b'</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>a_list</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>['a', 'new']</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>a_list.pop()</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>'new'</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>a_list.pop()</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>'a'</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:169.5pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9313;</span></p>
  </td>
 </tr>
 <tr style='height:18.3pt'>
  <td width=152 valign=bottom style='width:114.0pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono";
  color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
  107%;font-family:"Liberation Mono"'>a_list.pop()</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9314;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>Traceback (most
recent call last):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>File
&quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
31.25pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>IndexError: pop
from empty list</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.95pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>When called without arguments, the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>pop() </span>list method
removes the last item in the list <i>and returns the value it removed</i>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.95pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>You can pop arbitrary items from a list. Just pass a positional index to
the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>pop()
</span>method. It will remove that item, shift all the items after it to “fill
the gap,” and return the value it removed.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.95pt;margin-bottom:
48.25pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Calling <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>pop()
</span>on an empty list raises an exception.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:47.15pt;line-height:107%'><span style='font-size:24.0pt;
line-height:107%;font-family:"Calibri",sans-serif'>&#9758; </span>Calling the <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>pop() </span>list
method without an argument is like the <span style='font-size:10.0pt;
line-height:107%;font-family:"Liberation Mono"'>pop() </span>function in Perl.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:62.8pt;margin-bottom:
.25pt;margin-left:76.4pt'>It removes the last item from the list and returns
the value of the removed item. Perl has another function, <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>shift()</span>,
which removes the first item and returns its value; in Python, this is
equivalent to <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>a_list.pop(0)</span>.</p>

<h3 style='margin-top:0in;margin-right:0in;margin-bottom:25.25pt;margin-left:
16.4pt;line-height:110%'><span style='font-size:13.0pt;line-height:110%'>2.4.7.
L</span><span style='font-size:10.5pt;line-height:110%'>ISTS </span><span
style='font-size:13.0pt;line-height:110%'>I</span><span style='font-size:10.5pt;
line-height:110%'>N </span><span style='font-size:13.0pt;line-height:110%'>A B</span><span
style='font-size:10.5pt;line-height:110%'>OOLEAN </span><span style='font-size:
13.0pt;line-height:110%'>C</span><span style='font-size:10.5pt;line-height:
110%'>ONTEXT</span></h3>

<p class=MsoNormal style='margin-top:0in;margin-right:259.55pt;margin-bottom:
19.0pt;margin-left:16.4pt'>You can also use a list in <u>a boolean context</u>,
such as an <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>if
</span>statement.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><img width=298 height=1
src="Dive%20Into%20Python%203_files/image033.gif" align=left hspace=12><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def is_it_true(anything):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>...   </span><span style='font-size:10.0pt;line-height:110%;
font-family:"Liberation Mono"'>if anything:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;line-height:
185%;font-family:"Liberation Mono";color:#666677'>...   </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>print(&quot;yes,
it's true&quot;) </span><span style='font-size:10.0pt;line-height:185%;
font-family:"Liberation Mono";color:#666677'>...   </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>else:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:4.05pt;
margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;line-height:
185%;font-family:"Liberation Mono";color:#666677'>...   </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>print(&quot;no,
it's false&quot;) </span><span style='font-size:10.0pt;line-height:185%;
font-family:"Liberation Mono";color:#666677'>...</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>is_it_true([])             </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.6pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>no, it's false</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>is_it_true(['a'])          </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.6pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>yes, it's true</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:22.5pt;
margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;line-height:
185%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>is_it_true([False]) </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314; </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>yes,
it's true</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>In a boolean
context, an empty list is false.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Any list with at
least one item is true.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
46.55pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Any list with at least one item is true. The value of the items is
irrelevant.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:3.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h3 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>2.5.
T</span>UPLES</h3>

<p class=MsoNormal align=right style='margin-top:0in;margin-right:1.6in;
margin-bottom:.15pt;margin-left:.5pt;text-align:right;line-height:110%'>A tuple
is an immutable list. A tuple can not be changed in any way once it is created.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>a_tuple
= (&quot;a&quot;, &quot;b&quot;, &quot;mpilgrim&quot;, &quot;z&quot;,
&quot;example&quot;) </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>a_tuple</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.5pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>('a', 'b', 'mpilgrim', 'z', 'example')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>a_tuple[0]                                        </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.5pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'a'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>a_tuple[-1]                                       </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.5pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'example'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>a_tuple[1:3]                                      </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>('b', 'mpilgrim')</span></p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>A tuple is
defined in the same way as a list, except that the whole set of elements is
enclosed in parentheses instead of square brackets.</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The elements of
a tuple have a defined order, just like a list. Tuple indices are zero-based,
just like a list, so the first element of a non-empty tuple is always <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>a_tuple[0]</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.0pt;
margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Negative indices
count from the end of the tuple, just like a list.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:20.55pt;
margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Slicing works too, just like a list. When you slice a list, you get a
new list; when you slice a tuple, you get a new tuple.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.65pt;margin-bottom:
.25pt;margin-left:16.4pt'>The major difference between tuples and lists is that
tuples can not be changed. In technical terms, tuples are immutable. In
practical terms, they have no methods that would allow you to change them.
Lists have methods like <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>append()</span>, <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>extend()</span>, <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>insert()</span>,
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>remove()</span>,
and <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>pop()</span>.
Tuples have none of these methods. You can slice a tuple (because that creates
a new tuple), and you can check whether a tuple contains a particular value
(because that doesn’t change the tuple), and… that’s about it.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'># continued from the previous example</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>a_tuple</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>('a', 'b', 'mpilgrim', 'z', 'example')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>a_tuple.append(&quot;new&quot;)               </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>Traceback
(innermost last):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:188.45pt;margin-bottom:
4.1pt;margin-left:37.4pt;text-indent:12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
color:#880000'>File &quot;&lt;interactive input&gt;&quot;, line 1, in ?
AttributeError: 'tuple' object has no attribute 'append'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>a_tuple.remove(&quot;z&quot;)                 </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>Traceback
(innermost last):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:188.45pt;margin-bottom:
0in;margin-left:37.4pt;text-indent:12.0pt;line-height:110%'><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#880000'>File &quot;&lt;interactive input&gt;&quot;, line 1, in ?
AttributeError: 'tuple' object has no attribute 'remove'</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=334
 style='width:250.8pt;margin-left:38.15pt;border-collapse:collapse'>
 <tr style='height:39.3pt'>
  <td width=320 valign=top style='width:240.05pt;padding:0in 0in 0in 0in;
  height:39.3pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>a_tuple.index(&quot;example&quot;)</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>4</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:39.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9314;</span></p>
  </td>
 </tr>
 <tr style='height:18.3pt'>
  <td width=320 valign=bottom style='width:240.05pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono";
  color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
  107%;font-family:"Liberation Mono"'>&quot;z&quot; in a_tuple</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9315;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.8pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>True</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.6pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>You can’t add
elements to a tuple. Tuples have no <span style='font-size:10.0pt;line-height:
107%;font-family:"Liberation Mono"'>append() </span>or <span style='font-size:
10.0pt;line-height:107%;font-family:"Liberation Mono"'>extend() </span>method.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>You can’t remove
elements from a tuple. Tuples have no <span style='font-size:10.0pt;line-height:
107%;font-family:"Liberation Mono"'>remove() </span>or <span style='font-size:
10.0pt;line-height:107%;font-family:"Liberation Mono"'>pop() </span>method.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.1pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>You <i>can </i>find
elements in a tuple, since this doesn’t change the tuple.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.5pt;margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>You can also use the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>in </span>operator to check if an element exists
in the tuple.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.45pt;margin-left:16.4pt'>So what are tuples good for?</p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.0pt;margin-bottom:.25pt;
margin-left:16.65pt;text-indent:-12.25pt'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Tuples are faster than lists. If you’re defining a constant set of
values and all you’re ever going to do with it is iterate through it, use a
tuple instead of a list.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.0pt;margin-bottom:.25pt;
margin-left:16.65pt;text-indent:-12.25pt'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>It makes your code safer if you “write-protect” data that doesn’t need
to be changed. Using a tuple instead of a list is like having an implied <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>assert </span>statement
that shows this data is constant, and that special thought (and a specific
function) is required to override that.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.0pt;margin-bottom:44.55pt;
margin-left:16.65pt;text-indent:-12.25pt'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Some tuples can be used as dictionary keys (specifically, tuples that
contain <i>immutable </i>values like strings, numbers, and other tuples). Lists
can never be used as dictionary keys, because lists are not immutable.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:21.75pt;
margin-left:46.4pt;line-height:107%'><span style='font-size:24.0pt;line-height:
107%;font-family:"Calibri",sans-serif'>&#9758;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:55.35pt;margin-bottom:
43.05pt;margin-left:76.4pt'>Tuples can be converted into lists, and vice-versa.
The built-in <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>tuple()
</span>function takes a list and returns a tuple with the same elements, and
the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>list()
</span>function takes a tuple and returns a list. In effect, <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>tuple()
</span>freezes a list, and <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>list() </span>thaws a tuple.</p>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:25.25pt;margin-left:
16.4pt;line-height:110%'><span style='font-size:13.0pt;line-height:110%'>2.5.1.
T</span><span style='font-size:10.5pt;line-height:110%'>UPLES </span><span
style='font-size:13.0pt;line-height:110%'>I</span><span style='font-size:10.5pt;
line-height:110%'>N </span><span style='font-size:13.0pt;line-height:110%'>A B</span><span
style='font-size:10.5pt;line-height:110%'>OOLEAN </span><span style='font-size:
13.0pt;line-height:110%'>C</span><span style='font-size:10.5pt;line-height:
110%'>ONTEXT</span></h4>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.0pt;margin-left:16.4pt'>You can use tuples in <u>a boolean context</u>, such
as an <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>if
</span>statement.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>def
is_it_true(anything):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>...   </span><span style='font-size:10.0pt;line-height:110%;
font-family:"Liberation Mono"'>if anything:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:326.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>...   </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>print(&quot;yes,
it's true&quot;) </span><span style='font-size:10.0pt;line-height:185%;
font-family:"Liberation Mono";color:#666677'>...  </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>else:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:326.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#666677'>...   </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>print(&quot;no,
it's false&quot;) </span><span style='font-size:10.0pt;line-height:110%;
font-family:"Liberation Mono";color:#666677'>...</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=262
 style='width:196.8pt;margin-left:38.15pt;border-collapse:collapse'>
 <tr style='height:39.3pt'>
  <td width=248 valign=top style='width:186.05pt;padding:0in 0in 0in 0in;
  height:39.3pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:60.05pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>is_it_true(())
  no, it's false</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:39.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9312;</span></p>
  </td>
 </tr>
 <tr style='height:43.5pt'>
  <td width=248 valign=top style='width:186.05pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:6.05pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>is_it_true(('a',
  'b')) yes, it's true</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9313;</span></p>
  </td>
 </tr>
 <tr style='height:43.5pt'>
  <td width=248 valign=top style='width:186.05pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:18.05pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>is_it_true((False,))
  yes, it's true</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9314;</span></p>
  </td>
 </tr>
 <tr style='height:18.3pt'>
  <td width=248 valign=bottom style='width:186.05pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono";
  color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
  107%;font-family:"Liberation Mono"'>type((False))</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9315;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;class 'bool'&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>type((False,))</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;class 'tuple'&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:15.25pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>In a boolean
context, an empty tuple is false.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:15.25pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Any tuple with
at least one item is true.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:15.25pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Any tuple with at least one item is true. The value of the items is
irrelevant. But what’s that comma doing there?</p>

<p class=MsoNormal style='margin-top:0in;margin-right:15.25pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>To create a tuple of one item, you need a comma after the value. Without
the comma, Python just assumes you have an extra pair of parentheses, which is
harmless, but it doesn’t create a tuple.</p>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:25.25pt;margin-left:
16.4pt;line-height:110%'><span style='font-size:13.0pt;line-height:110%'>2.5.2.
A</span><span style='font-size:10.5pt;line-height:110%'>SSIGNING </span><span
style='font-size:13.0pt;line-height:110%'>M</span><span style='font-size:10.5pt;
line-height:110%'>ULTIPLE </span><span style='font-size:13.0pt;line-height:
110%'>V</span><span style='font-size:10.5pt;line-height:110%'>ALUES </span><span
style='font-size:13.0pt;line-height:110%'>A</span><span style='font-size:10.5pt;
line-height:110%'>T </span><span style='font-size:13.0pt;line-height:110%'>O</span><span
style='font-size:10.5pt;line-height:110%'>NCE</span></h4>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.9pt;margin-left:16.4pt'>Here’s a cool programming shortcut: in Python, you
can use a tuple to assign multiple values at once.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.55pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>v =
('a', 2, True)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>(x, y, z) = v       </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.95in;margin-bottom:
8.5pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>x</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'a'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.95in;margin-bottom:
8.5pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>y</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>2</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.95in;margin-bottom:
8.5pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>z</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.35pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>True</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
12.9pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1. <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>v </span>is
a tuple of three elements, and <span style='font-size:10.0pt;line-height:107%;
font-family:"Liberation Mono"'>(x, y, z) </span>is a tuple of three variables.
Assigning one to the other assigns each of the values of <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>v </span>to
each of the variables, in order.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=717
 style='width:537.95pt;margin-left:16.65pt;border-collapse:collapse'>
 <tr style='height:21.0pt'>
  <td width=717 colspan=2 valign=top style='width:537.95pt;padding:0in 0in 0in 0in;
  height:21.0pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'>This has all kinds of uses. Suppose you
  want to assign names to a range of values. You can use the built-in</p>
  </td>
 </tr>
 <tr style='height:28.05pt'>
  <td width=672 valign=top style='width:504.2pt;padding:0in 0in 0in 0in;
  height:28.05pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>range()
  </span>function with multi-variable assignment to quickly assign consecutive
  values.</p>
  </td>
  <td width=45 valign=top style='width:33.75pt;padding:0in 0in 0in 0in;
  height:28.05pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.0pt;
  margin-left:0in;text-indent:0in;line-height:107%'>&nbsp;</p>
  </td>
 </tr>
 <tr style='height:32.25pt'>
  <td width=672 valign=bottom style='width:504.2pt;padding:0in 0in 0in 0in;
  height:32.25pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
  margin-left:21.55pt;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>(MONDAY,
  TUESDAY, WEDNESDAY, THURSDAY, FRIDAY, SATURDAY, SUNDAY) = range(7)</span></p>
  </td>
  <td width=45 valign=bottom style='width:33.75pt;padding:0in 0in 0in 0in;
  height:32.25pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
  margin-left:3.4pt;text-indent:0in;line-height:107%'><span style='font-family:
  "DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>
  </td>
 </tr>
 <tr style='height:102.3pt'>
  <td width=672 valign=bottom style='width:504.2pt;padding:0in 0in 0in 0in;
  height:102.3pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:21.55pt;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>MONDAY</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:21.55pt;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>0</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:21.55pt;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>TUESDAY</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:21.55pt;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>1</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
  margin-left:21.55pt;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>SUNDAY</span></p>
  </td>
  <td width=45 valign=top style='width:33.75pt;padding:0in 0in 0in 0in;
  height:102.3pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
  margin-left:3.4pt;text-indent:0in;line-height:107%'><span style='font-family:
  "DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.55pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>6</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:16.3pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The built-in <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>range() </span>function constructs a sequence of integers.
(Technically, the <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>range() </span>function returns an <u>iterator</u>, not a
list or a tuple, but you’ll learn about that distinction later.) <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>MONDAY</span>,
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>TUESDAY</span>,
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>WEDNESDAY</span>,
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>THURSDAY</span>,
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>FRIDAY</span>,
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>SATURDAY</span>,
and <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>SUNDAY
</span>are the variables you’re defining. (This example came from the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>calendar
</span>module, a fun little module that prints calendars, like the <span
style='font-size:9.5pt;line-height:154%'>UNIX </span>program <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>cal</span>.
The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>calendar
</span>module defines integer constants for days of the week.)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:16.3pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Now each
variable has its value: <span style='font-size:10.0pt;line-height:107%;
font-family:"Liberation Mono"'>MONDAY </span>is 0, <span style='font-size:10.0pt;
line-height:107%;font-family:"Liberation Mono"'>TUESDAY </span>is <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>1</span>,
and so forth.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.55pt;margin-bottom:
45.65pt;margin-left:16.4pt'>You can also use multi-variable assignment to build
functions that return multiple values, simply by returning a tuple of all the
values. The caller can treat it as a single tuple, or it can assign the values
to individual variables. Many standard Python libraries do this, including the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>os </span>module,
which you'll learn about in <u>the next chapter</u>.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:3.45pt;
margin-bottom:32.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:17.4pt;margin-left:
16.4pt;line-height:110%'><span style='font-size:18.0pt;line-height:110%'>2.6. S</span>ETS</h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.0pt;
margin-left:16.4pt;line-height:107%'>A set is an unordered “bag” of unique
values. A single set can contain values of any immutable datatype.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:22.65pt;
margin-left:16.4pt'>Once you have two sets, you can do standard set operations
like union, intersection, and set difference.</p>

<h3 style='margin-top:0in;margin-right:0in;margin-bottom:25.25pt;margin-left:
16.4pt;line-height:110%'><span style='font-size:13.0pt;line-height:110%'>2.6.1.
C</span><span style='font-size:10.5pt;line-height:110%'>REATING </span><span
style='font-size:13.0pt;line-height:110%'>A S</span><span style='font-size:
10.5pt;line-height:110%'>ET</span></h3>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
23.9pt;margin-left:16.4pt'>First things first. Creating a set is easy.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>a_set = {1}     </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>a_set</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.5pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>{1}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>type(a_set)     </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.55pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;class 'set'&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>a_set =
{1, 2} </span><span style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>a_set</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.15pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>{1, 2}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.05pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>To create a set
with one value, put the value in curly brackets (<span style='font-size:10.0pt;
line-height:107%;font-family:"Liberation Mono"'>{}</span>).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Sets are
actually implemented as <u>classes</u>, but don’t worry about that for now.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.45pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>To create a set with multiple values, separate the values with commas
and wrap it all up with curly brackets.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>You can also create a set out of a <u>list</u>.</p>

</div>

<span style='font-size:12.0pt;line-height:154%;font-family:"Gill Sans MT",sans-serif;
color:black'><br clear=all style='page-break-before:always'>
</span>

<div class=WordSection4>

<p class=MsoNormal style='margin-top:0in;margin-right:187.3pt;margin-bottom:
0in;margin-left:62.65pt;line-height:179%'><span style='font-size:10.0pt;
line-height:179%;font-family:"Liberation Mono"'>a_list = ['a', 'b', 'mpilgrim',
True, False, 42] a_set = set(a_list)   </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>a_set                                         </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.35pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>{'a', False, 'b', True, 'mpilgrim', 42}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>a_list                                        </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>['a', 'b', 'mpilgrim', True, False, 42]</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.75pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>To create a set from a list, use the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>set() </span>function. (Pedants
who know about how sets are implemented will point out that this is not really
calling a function, but instantiating a class. I <i>promise </i>you will learn
the difference later in this book. For now, just know that <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>set() </span>acts
like a function, and it returns a set.)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.75pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>As I mentioned earlier, a single set can contain values of any datatype.
And, as I mentioned earlier, sets are <i>unordered</i>. This set does not
remember the original order of the list that was used to create it. If you were
to add items to this set, it would not remember the order in which you added
them.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.75pt;margin-bottom:
21.45pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The original list is unchanged.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
12.9pt;margin-left:16.4pt;line-height:107%'>Don’t have any values yet? Not a
problem. You can create an empty set.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=182
 style='width:136.75pt;margin-left:38.15pt;border-collapse:collapse'>
 <tr style='height:18.3pt'>
  <td width=155 valign=top style='width:116.25pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono";
  color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
  107%;font-family:"Liberation Mono"'>a_set = set()</span></p>
  </td>
  <td width=27 valign=top style='width:20.5pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
  margin-left:9.75pt;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9312;</span></p>
  </td>
 </tr>
 <tr style='height:43.5pt'>
  <td width=155 valign=top style='width:116.25pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:32.25pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>a_set
  set()</span></p>
  </td>
  <td width=27 valign=top style='width:20.5pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
  margin-left:9.75pt;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9313;</span></p>
  </td>
 </tr>
 <tr style='height:43.5pt'>
  <td width=155 valign=top style='width:116.25pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>type(a_set)</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>&lt;class
  'set'&gt;</span></p>
  </td>
  <td width=27 valign=top style='width:20.5pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
  margin-left:9.75pt;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9314;</span></p>
  </td>
 </tr>
 <tr style='height:43.5pt'>
  <td width=155 valign=top style='width:116.25pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>len(a_set)</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>0</span></p>
  </td>
  <td width=27 valign=top style='width:20.5pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
  margin-left:9.75pt;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9315;</span></p>
  </td>
 </tr>
 <tr style='height:18.3pt'>
  <td width=155 valign=bottom style='width:116.25pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono";
  color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
  107%;font-family:"Liberation Mono"'>not_sure = {}</span></p>
  </td>
  <td width=27 valign=top style='width:20.5pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
  margin-left:9.75pt;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9316;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>type(not_sure)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.4pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;class 'dict'&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:22.55pt;margin-bottom:
6.1pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>To create an
empty set, call <span style='font-size:10.0pt;line-height:107%;font-family:
"Liberation Mono"'>set() </span>with no arguments.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:22.55pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The printed representation of an empty set looks a bit strange. Were you
expecting <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>{}</span>,
perhaps? That would denote an empty dictionary, not an empty set. You’ll learn
about dictionaries later in this chapter. 3. Despite the strange printed
representation, this <i>is </i>a set…</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>…and this set
has no members.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.8pt;margin-left:16.65pt;text-indent:-16.65pt'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Due to historical quirks carried over from Python 2, you can not create
an empty set with two curly brackets. This actually creates an empty
dictionary, not an empty set.</p>

<h3 style='margin-top:0in;margin-right:0in;margin-bottom:25.25pt;margin-left:
16.4pt;line-height:110%'><span style='font-size:13.0pt;line-height:110%'>2.6.2.
M</span><span style='font-size:10.5pt;line-height:110%'>ODIFYING </span><span
style='font-size:13.0pt;line-height:110%'>A S</span><span style='font-size:
10.5pt;line-height:110%'>ET</span></h3>

<p class=MsoNormal align=right style='margin-top:0in;margin-right:.1pt;
margin-bottom:.35in;margin-left:.5pt;text-align:right;line-height:110%'>There
are two different ways to add values to an existing set: the <span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>add() </span>method,
and the <span style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>update()
</span>method.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.5pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>a_set =
{1, 2}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>a_set.add(4)
</span><span style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:457.3pt;margin-bottom:
3.95pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>a_set
{1, 2, 4}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>len(a_set)    </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.5pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>3</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>a_set.add(1)
</span><span style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:457.3pt;margin-bottom:
3.95pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>&gt;&gt;&gt; a_set {1, 2, 4}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>len(a_set)    </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>3</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:15.25pt;margin-bottom:
6.05pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>add() </span>method
takes a single argument, which can be any datatype, and adds the given value to
the set.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:15.25pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>This set now has
3 members.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:15.25pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Sets are bags of <i>unique values</i>. If you try to add a value that
already exists in the set, it will do nothing. It won’t raise an error; it’s
just a no-op.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:15.25pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>This set <i>still
</i>has 3 members.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:373.3pt;margin-bottom:
0in;margin-left:62.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>a_set = {1, 2, 3} a_set</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>{1, 2, 3}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.45pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>a_set.update({2, 4, 6})                       </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>a_set                                         </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>{1, 2, 3, 4, 6}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>a_set.update({3,
6, 9}, {1, 2, 3, 5, 8, 13}) </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>a_set</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>{1, 2, 3, 4, 5, 6, 8, 9, 13}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>a_set.update([10, 20, 30])                    </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>a_set</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.35pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>{1, 2, 3, 4, 5, 6, 8, 9, 10, 13, 20, 30}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.2pt;margin-bottom:.25pt;
margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>update()
</span>method takes one argument, a set, and adds all its members to the
original set. It’s as if you called the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>add() </span>method with each
member of the set.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.2pt;margin-bottom:6.25pt;
margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Duplicate values
are ignored, since sets can not contain duplicates.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.2pt;margin-bottom:.25pt;
margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>You can actually call the <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>update() </span>method with any number of
arguments. When called with two sets, the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>update() </span>method adds all
the members of each set to the original set (dropping duplicates).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.2pt;margin-bottom:22.05pt;
margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>update()
</span>method can take objects of a number of different datatypes, including
lists. When called with a list, the <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>update() </span>method adds all the items
of the list to the original set.</p>

<h3 style='margin-top:0in;margin-right:0in;margin-bottom:25.25pt;margin-left:
16.4pt;line-height:110%'><span style='font-size:13.0pt;line-height:110%'>2.6.3.
R</span><span style='font-size:10.5pt;line-height:110%'>EMOVING </span><span
style='font-size:13.0pt;line-height:110%'>I</span><span style='font-size:10.5pt;
line-height:110%'>TEMS </span><span style='font-size:13.0pt;line-height:110%'>F</span><span
style='font-size:10.5pt;line-height:110%'>ROM </span><span style='font-size:
13.0pt;line-height:110%'>A S</span><span style='font-size:10.5pt;line-height:
110%'>ET</span></h3>

<p class=MsoNormal style='margin-left:16.4pt'>There are three ways to remove
individual values from a set. The first two, <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>discard() </span>and <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>remove()</span>,
have one subtle difference.</p>

</div>

<span style='font-size:12.0pt;line-height:154%;font-family:"Gill Sans MT",sans-serif;
color:black'><br clear=all style='page-break-before:always'>
</span>

<div class=WordSection5>

<p class=MsoNormal style='margin-top:0in;margin-right:224.75pt;margin-bottom:
0in;margin-left:62.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>a_set = {1, 3, 6, 10, 15, 21,
28, 36, 45} a_set</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.6pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>{1, 3, 36, 6, 10, 45, 15, 21, 28}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>a_set.discard(10)                        </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>a_set</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.6pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>{1, 3, 36, 6, 45, 15, 21, 28}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>a_set.discard(10)                        </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>a_set</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.6pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>{1, 3, 36, 6, 45, 15, 21, 28}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>a_set.remove(21)                         </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>a_set</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.6pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>{1, 3, 36, 6, 45, 15, 28}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>a_set.remove(21)                         </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>Traceback (most
recent call last):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>File
&quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
31.4pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>KeyError: 21</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:15.25pt;margin-bottom:
6.35pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>discard()
</span>method takes a single value as an argument and removes that value from
the set.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:15.25pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>If you call the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>discard() </span>method with a value that
doesn’t exist in the set, it does nothing. No error; it’s just a no-op.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:15.25pt;margin-bottom:
6.65pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>remove()
</span>method also takes a single value as an argument, and it also removes
that value from the set.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:15.25pt;margin-bottom:
20.95pt;margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Here’s the difference: if the value doesn’t exist in the set, the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>remove()
</span>method raises a <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>KeyError </span>exception.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>Like lists, sets have a <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>pop() </span>method.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>a_set = {1, 3, 6, 10, 15, 21, 28, 36, 45}</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=390
 style='width:292.8pt;margin-left:38.15pt;border-collapse:collapse'>
 <tr style='height:165.3pt'>
  <td width=376 valign=top style='width:282.05pt;padding:0in 0in 0in 0in;
  height:165.3pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:24.0pt;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>a_set.pop()</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>1</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>a_set.pop()</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>3</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>a_set.pop()</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>36</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>a_set</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>{6,
  10, 45, 15, 21, 28}</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:165.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9312;</span></p>
  </td>
 </tr>
 <tr style='height:64.5pt'>
  <td width=376 valign=top style='width:282.05pt;padding:0in 0in 0in 0in;
  height:64.5pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:180.05pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>a_set.clear()
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono";
  color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
  107%;font-family:"Liberation Mono"'>a_set set()</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:64.5pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9313;</span></p>
  </td>
 </tr>
 <tr style='height:18.3pt'>
  <td width=376 valign=bottom style='width:282.05pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono";
  color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
  107%;font-family:"Liberation Mono"'>a_set.pop()</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9314;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>Traceback (most
recent call last):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>File
&quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
31.25pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>KeyError: 'pop
from an empty set'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:21.2pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>pop()
</span>method removes a single value from a set and returns the value. However,
since sets are unordered, there is no “last” value in a set, so there is no way
to control which value gets removed. It is completely arbitrary.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:21.2pt;margin-bottom:
.15pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:155%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The <span
style='font-size:10.0pt;line-height:155%;font-family:"Liberation Mono"'>clear()
</span>method removes <i>all </i>values from a set, leaving you with an empty
set. This is equivalent to <span style='font-size:10.0pt;line-height:155%;
font-family:"Liberation Mono"'>a_set = set()</span>, which would create a new
empty set and overwrite the previous value of the <span style='font-size:10.0pt;
line-height:155%;font-family:"Liberation Mono"'>a_set </span>variable.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:21.2pt;margin-bottom:
23.1pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Attempting to pop a value from an empty set will raise a <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>KeyError
</span>exception.</p>

<h3 style='margin-top:0in;margin-right:0in;margin-bottom:25.25pt;margin-left:
16.4pt;line-height:110%'><span style='font-size:13.0pt;line-height:110%'>2.6.4.
C</span><span style='font-size:10.5pt;line-height:110%'>OMMON </span><span
style='font-size:13.0pt;line-height:110%'>S</span><span style='font-size:10.5pt;
line-height:110%'>ET </span><span style='font-size:13.0pt;line-height:110%'>O</span><span
style='font-size:10.5pt;line-height:110%'>PERATIONS</span></h3>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>Python’s <span style='font-size:
10.0pt;line-height:107%;font-family:"Liberation Mono"'>set </span>type supports
several common set operations.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.45pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>a_set = {2, 4, 5, 9, 12, 21, 30, 51, 76,
127, 195}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                            </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>30 in
a_set                                                     </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>True</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>31 in
a_set</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>False</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.6pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>b_set =
{1, 2, 3, 5, 6, 8, 9, 12, 15, 17, 18, 21}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>a_set.union(b_set)                                              </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>{1, 2, 195, 4, 5, 6, 8, 12, 76, 15, 17, 18,
3, 21, 30, 51, 9, 127}</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=558
 style='width:418.8pt;margin-left:38.15pt;border-collapse:collapse'>
 <tr style='height:39.3pt'>
  <td width=544 valign=top style='width:408.05pt;padding:0in 0in 0in 0in;
  height:39.3pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>a_set.intersection(b_set)</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>{9,
  2, 12, 5, 21}</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:39.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9314;</span></p>
  </td>
 </tr>
 <tr style='height:43.5pt'>
  <td width=544 valign=top style='width:408.05pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>a_set.difference(b_set)</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>{195,
  4, 76, 51, 30, 127}</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9315;</span></p>
  </td>
 </tr>
 <tr style='height:18.3pt'>
  <td width=544 valign=bottom style='width:408.05pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono";
  color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
  107%;font-family:"Liberation Mono"'>a_set.symmetric_difference(b_set)</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9316;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.15pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>{1, 3, 4, 6, 8, 76, 15, 17, 18, 195, 127,
30, 51}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.35pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>To test whether
a value is a member of a set, use the <span style='font-size:10.0pt;line-height:
107%;font-family:"Liberation Mono"'>in </span>operator. This works the same as
lists.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.6pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>union()
</span>method returns a new set containing all the elements that are in <i>either
</i>set.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.8pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>intersection()
</span>method returns a new set containing all the elements that are in <i>both
</i>sets.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.75pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>difference()
</span>method returns a new set containing all the elements that are in <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>a_set </span>but
not <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>b_set</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.55pt;margin-left:16.65pt;text-indent:-16.65pt'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>symmetric_difference()
</span>method returns a new set containing all the elements that are in <i>exactly
one </i>of the sets.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>Three of these methods are
symmetric.</p>

</div>

<span style='font-size:12.0pt;line-height:154%;font-family:"Gill Sans MT",sans-serif;
color:black'><br clear=all style='page-break-before:always'>
</span>

<div class=WordSection6>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'># continued from the previous example</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>b_set.symmetric_difference(a_set)                                       </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>{3, 1, 195, 4, 6, 8, 76, 15, 17, 18, 51,
30, 127}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>b_set.symmetric_difference(a_set)
== a_set.symmetric_difference(b_set) </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>True</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>b_set.union(a_set) == a_set.union(b_set)                                </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>True</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>b_set.intersection(a_set) ==
a_set.intersection(b_set)                  </span><span style='font-family:
"DejaVu Sans",sans-serif;color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>True</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>b_set.difference(a_set) ==
a_set.difference(b_set)                      </span><span style='font-family:
"DejaVu Sans",sans-serif;color:#222222'>&#9316;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.55pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>False</span></p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The symmetric
difference of <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>a_set
</span>from <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>b_set
</span><i>looks </i>different than the symmetric difference of <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>b_set </span>from
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>a_set</span>,
but remember, sets are unordered. Any two sets that contain all the same values
(with none left over) are considered equal.</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>And that’s
exactly what happens here. Don’t be fooled by the Python Shell’s printed
representation of these sets. They contain the same values, so they are equal.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.0pt;
margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The union of two
sets is also symmetric.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.0pt;
margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The intersection
of two sets is also symmetric.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:20.55pt;
margin-left:16.65pt;text-indent:-16.65pt'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The difference of two sets is not symmetric. That makes sense; it’s
analogous to subtracting one number from another. The order of the operands
matters.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>Finally, there are a few questions
you can ask of sets.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>a_set = {1, 2, 3}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>b_set =
{1, 2, 3, 4}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>a_set.issubset(b_set)    </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>True</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>b_set.issuperset(a_set)
</span><span style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.5pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>True</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>a_set.add(5)             </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>a_set.issubset(b_set)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>False</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:336.0pt;margin-bottom:
23.45pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>b_set.issuperset(a_set)
False</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.55pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>a_set </span>is
a subset of <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>b_set
</span>— all the members of <span style='font-size:10.0pt;line-height:107%;
font-family:"Liberation Mono"'>a_set </span>are also members of <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>b_set</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Asking the same question in reverse, <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>b_set </span>is a superset of <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>a_set</span>,
because all the members of <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>a_set </span>are also members of <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>b_set</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
22.95pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>As soon as you add a value to <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>a_set </span>that is not in <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>b_set</span>,
both tests return <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>False</span>.</p>

<h3 style='margin-top:0in;margin-right:0in;margin-bottom:25.25pt;margin-left:
16.4pt;line-height:110%'><span style='font-size:13.0pt;line-height:110%'>2.6.5.
S</span><span style='font-size:10.5pt;line-height:110%'>ETS </span><span
style='font-size:13.0pt;line-height:110%'>I</span><span style='font-size:10.5pt;
line-height:110%'>N </span><span style='font-size:13.0pt;line-height:110%'>A B</span><span
style='font-size:10.5pt;line-height:110%'>OOLEAN </span><span style='font-size:
13.0pt;line-height:110%'>C</span><span style='font-size:10.5pt;line-height:
110%'>ONTEXT</span></h3>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.0pt;margin-left:16.4pt'>You can use sets in <u>a boolean context</u>, such
as an <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>if
</span>statement.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>def
is_it_true(anything):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>...   </span><span style='font-size:10.0pt;line-height:110%;
font-family:"Liberation Mono"'>if anything:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:4.5in;margin-bottom:0in;
margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;line-height:
185%;font-family:"Liberation Mono";color:#666677'>...   </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>print(&quot;yes,
it's true&quot;) </span><span style='font-size:10.0pt;line-height:185%;
font-family:"Liberation Mono";color:#666677'>...  </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>else:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:4.5in;margin-bottom:4.1pt;
margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;line-height:
185%;font-family:"Liberation Mono";color:#666677'>...   </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>print(&quot;no,
it's false&quot;) </span><span style='font-size:10.0pt;line-height:185%;
font-family:"Liberation Mono";color:#666677'>...</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>is_it_true(set())          </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.6pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>no, it's false</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>is_it_true({'a'})          </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.6pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>yes, it's true</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>is_it_true({False})        </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>yes, it's true</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>In a boolean
context, an empty set is false.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Any set with at
least one item is true.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
46.55pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Any set with at least one item is true. The value of the items is
irrelevant.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:.95pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h3 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>2.7.
D</span>ICTIONARIES</h3>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:46.85pt;
margin-left:16.4pt'>A dictionary is an unordered set of key-value pairs. When
you add a key to a dictionary, you must also add a value for that key. (You can
always change the value later.) Python dictionaries are optimized for
retrieving the value when you know the key, but not the other way around.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:54.65pt;margin-bottom:
42.7pt;margin-left:75.95pt;text-indent:-29.3pt'><span style='font-size:24.0pt;
line-height:154%;font-family:"Calibri",sans-serif'>&#9758; </span>A dictionary
in Python is like a hash in Perl 5. In Perl 5, variables that store hashes
always start with a <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>% </span>character. In Python, variables can be named
anything, and Python keeps track of the datatype internally.</p>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:25.25pt;margin-left:
16.4pt;line-height:110%'><span style='font-size:13.0pt;line-height:110%'>2.7.1.
C</span><span style='font-size:10.5pt;line-height:110%'>REATING </span><span
style='font-size:13.0pt;line-height:110%'>A D</span><span style='font-size:
10.5pt;line-height:110%'>ICTIONARY</span></h4>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.0pt;
margin-left:16.4pt;line-height:107%'>Creating a dictionary is easy. The syntax
is similar to <u>sets</u>, but instead of values, you have key-value pairs.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>Once you have a dictionary, you can
look up values by their key.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:23.0pt;
margin-bottom:5.65pt;margin-left:.5pt;text-align:center;line-height:110%'><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>a_dict
= {'server': 'db.diveintopython3.org', 'database': 'mysql'} </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>a_dict</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.6pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>{'server': 'db.diveintopython3.org',
'database': 'mysql'}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>a_dict['server']                                                    </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.6pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'db.diveintopython3.org'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>a_dict['database']                                                  </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'mysql'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>a_dict['db.diveintopython3.org']                                    </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>Traceback (most
recent call last):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>File
&quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
31.25pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>KeyError:
'db.diveintopython3.org'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>First, you create a new dictionary with two items and assign it to the
variable <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>a_dict</span>.
Each item is a keyvalue pair, and the whole set of items is enclosed in curly
braces.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
8.75pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>'server'
</span>is a key, and its associated value, referenced by <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>a_dict['server']</span>,
is</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.95pt;
margin-left:17.15pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'db.diveintopython3.org'</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.7pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>'database'
</span>is a key, and its associated value, referenced by <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>a_dict['database']</span>,
is <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>'mysql'</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
7.95pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>You can get
values by key, but you can’t get keys by value. So <span style='font-size:10.0pt;
line-height:107%;font-family:"Liberation Mono"'>a_dict['server'] </span>is</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:20.4pt;
margin-left:17.15pt;line-height:165%'><span style='font-size:10.0pt;line-height:
165%;font-family:"Liberation Mono"'>'db.diveintopython3.org'</span>, but <span
style='font-size:10.0pt;line-height:165%;font-family:"Liberation Mono"'>a_dict['db.diveintopython3.org']
</span>raises an exception, because <span style='font-size:10.0pt;line-height:
165%;font-family:"Liberation Mono"'>'db.diveintopython3.org' </span>is not a
key.</p>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:25.25pt;margin-left:
16.4pt;line-height:110%'><span style='font-size:13.0pt;line-height:110%'>2.7.2.
M</span><span style='font-size:10.5pt;line-height:110%'>ODIFYING </span><span
style='font-size:13.0pt;line-height:110%'>A D</span><span style='font-size:
10.5pt;line-height:110%'>ICTIONARY</span></h4>

<p class=MsoNormal style='margin-left:16.4pt'>Dictionaries do not have any
predefined size limit. You can add new key-value pairs to a dictionary at any
time, or you can modify the value of an existing key. Continuing from the
previous example:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>a_dict</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>{'server': 'db.diveintopython3.org',
'database': 'mysql'}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>a_dict['database']
= 'blog' </span><span style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>a_dict</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>{'server': 'db.diveintopython3.org',
'database': 'blog'}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.5pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>a_dict['user'] = 'mark'      </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>a_dict                       </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>{'server': 'db.diveintopython3.org',
'user': 'mark', 'database': 'blog'}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>a_dict['user'] = 'dora'      </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>a_dict</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>{'server': 'db.diveintopython3.org',
'user': 'dora', 'database': 'blog'}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>a_dict['User'] = 'mark'      </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9316;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>a_dict</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>{'User': 'mark', 'server':
'db.diveintopython3.org', 'user': 'dora', 'database': 'blog'}</span></p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>You can not have
duplicate keys in a dictionary. Assigning a value to an existing key will wipe
out the old value.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.45pt;
margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>You can add new
key-value pairs at any time. This syntax is identical to modifying existing
values.</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The new
dictionary item (key <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>'user'</span>, value <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>'mark'</span>) appears to be in
the middle. In fact, it was just a coincidence that the items appeared to be in
order in the first example; it is just as much a coincidence that they appear
to be out of order now.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.15pt;
margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Assigning a
value to an existing dictionary key simply replaces the old value with the new
one.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:21.8pt;
margin-left:16.65pt;text-indent:-16.65pt'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Will this change the value of the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>user </span>key back to
&quot;mark&quot;? No! Look at the key closely — that’s a capital <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>U </span>in
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>&quot;User&quot;</span>.
Dictionary keys are case-sensitive, so this statement is creating a new
key-value pair, not overwriting an existing one. It may look similar to you,
but as far as Python is concerned, it’s completely different.</p>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:25.25pt;margin-left:
16.4pt;line-height:110%'><span style='font-size:13.0pt;line-height:110%'>2.7.3.
M</span><span style='font-size:10.5pt;line-height:110%'>IXED</span><span
style='font-size:13.0pt;line-height:110%'>-V</span><span style='font-size:10.5pt;
line-height:110%'>ALUE </span><span style='font-size:13.0pt;line-height:110%'>D</span><span
style='font-size:10.5pt;line-height:110%'>ICTIONARIES</span></h4>

<p class=MsoNormal style='margin-left:16.4pt'>Dictionaries aren’t just for
strings. Dictionary values can be any datatype, including integers, booleans,
arbitrary objects, or even other dictionaries. And within a single dictionary,
the values don’t all need to be the same type; you can mix and match as needed.
Dictionary keys are more restricted, but they can be strings, integers, and a
few other types. You can also mix and match key datatypes within a dictionary.</p>

</div>

<span style='font-size:12.0pt;line-height:154%;font-family:"Gill Sans MT",sans-serif;
color:black'><br clear=all style='page-break-before:always'>
</span>

<div class=WordSection7>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.9pt;margin-left:16.4pt'>In fact, you’ve already seen a dictionary with
non-string keys and values, in <u>your first Python program</u>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>SUFFIXES = {1000: ['KB', 'MB', 'GB', 'TB',
'PB', 'EB', 'ZB', 'YB'],</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:110.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>1024: ['KiB', 'MiB', 'GiB', 'TiB', 'PiB',
'EiB', 'ZiB', 'YiB']}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.9pt;margin-left:16.4pt'>Let's tear that apart in the interactive shell.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>SUFFIXES
= {1000: ['KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB'],</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.55pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>...             </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>1024: ['KiB', 'MiB', 'GiB', 'TiB', 'PiB',
'EiB', 'ZiB', 'YiB']}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>len(SUFFIXES)      </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.6pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>2</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>1000 in SUFFIXES   </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.55pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>True</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>SUFFIXES[1000]     </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.55pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>['KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB',
'YB']</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>SUFFIXES[1024]     </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.6pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>['KiB', 'MiB', 'GiB', 'TiB', 'PiB', 'EiB',
'ZiB', 'YiB']</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>SUFFIXES[1000][3]
</span><span style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9316;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.3pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'TB'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.1pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Like <u>lists </u>and
<u>sets</u>, the <span style='font-size:10.0pt;line-height:107%;font-family:
"Liberation Mono"'>len() </span>function gives you the number of keys in a
dictionary.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.55pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>And like lists
and sets, you can use the <span style='font-size:10.0pt;line-height:107%;
font-family:"Liberation Mono"'>in </span>operator to test whether a specific
key is defined in a dictionary.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.55pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>1000 </span><i>is
</i>a key in the <span style='font-size:10.0pt;line-height:107%;font-family:
"Liberation Mono"'>SUFFIXES </span>dictionary; its value is a list of eight
items (eight strings, to be precise).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.55pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Similarly, <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>1024 </span>is
a key in the <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>SUFFIXES
</span>dictionary; its value is also a list of eight items.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>5.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Since <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>SUFFIXES[1000]
</span>is a list, you can address individual items in the list by their 0-based
index.</p>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:25.25pt;margin-left:
16.4pt;line-height:110%'><span style='font-size:13.0pt;line-height:110%'>2.7.4.
D</span><span style='font-size:10.5pt;line-height:110%'>ICTIONARIES </span><span
style='font-size:13.0pt;line-height:110%'>I</span><span style='font-size:10.5pt;
line-height:110%'>N </span><span style='font-size:13.0pt;line-height:110%'>A B</span><span
style='font-size:10.5pt;line-height:110%'>OOLEAN </span><span style='font-size:
13.0pt;line-height:110%'>C</span><span style='font-size:10.5pt;line-height:
110%'>ONTEXT</span></h4>

<p class=MsoNormal style='margin-top:0in;margin-right:287.25pt;margin-bottom:
19.05pt;margin-left:16.4pt'>You can also use a dictionary in <u>a boolean
context</u>, such as an <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>if </span>statement.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.0pt;margin-bottom:
8.25pt;margin-left:37.9pt;line-height:110%'><img width=301 height=1
src="Dive%20Into%20Python%203_files/image036.gif" align=left hspace=12><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def is_it_true(anything):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>...   </span><span style='font-size:10.0pt;line-height:110%;
font-family:"Liberation Mono"'>if anything:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.0pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>...   </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>print(&quot;yes,
it's true&quot;) </span><span style='font-size:10.0pt;line-height:185%;
font-family:"Liberation Mono";color:#666677'>...   </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>else:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.0pt;margin-bottom:
4.05pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>...   </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>print(&quot;no,
it's false&quot;) </span><span style='font-size:10.0pt;line-height:185%;
font-family:"Liberation Mono";color:#666677'>...</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>is_it_true({})             </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.0pt;margin-bottom:
12.6pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono"'>no, it's false</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.0pt;margin-bottom:
22.5pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>is_it_true({'a':
1})      </span><span style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;
</span><span style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>yes,
it's true</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>In a boolean
context, an empty dictionary is false.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
62.3pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Any dictionary with at least one key-value pair is true.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:33.45pt;
margin-bottom:31.9pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:19.7pt;margin-left:
16.4pt;line-height:110%'><span style='font-size:18.0pt;line-height:110%'>2.8. </span><span
style='font-size:18.0pt;line-height:110%;font-family:"Liberation Mono";
font-weight:normal'>None</span></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.1pt;margin-left:16.4pt'><span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>None </span>is a special constant in Python. It
is a null value. <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>None </span>is not the same as <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>False</span>. <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>None </span>is
not 0. <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>None
</span>is not an empty string. Comparing <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>None </span>to anything other
than <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>None
</span>will always return <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>False</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'><span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>None </span>is the only null value. It has its
own datatype (<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>NoneType</span>).
You can assign <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>None
</span>to any variable, but you can not create other <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>NoneType </span>objects.
All variables whose value is <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>None </span>are equal to each other.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>type(None)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;class 'NoneType'&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>None ==
False</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>False</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>None ==
0</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>False</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>None ==
''</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>False</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>None ==
None</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>True</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>x =
None</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>x ==
None</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>True</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>y =
None</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:476.45pt;margin-bottom:
23.15pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>x == y
True</span></p>

<h3 style='margin-top:0in;margin-right:0in;margin-bottom:27.55pt;margin-left:
16.4pt;line-height:110%'><span style='font-size:13.0pt;line-height:110%'>2.8.1.
</span><span style='font-size:13.0pt;line-height:110%;font-family:"Liberation Mono";
font-weight:normal'>None </span><span style='font-size:13.0pt;line-height:110%'>I</span><span
style='font-size:10.5pt;line-height:110%'>N </span><span style='font-size:13.0pt;
line-height:110%'>A B</span><span style='font-size:10.5pt;line-height:110%'>OOLEAN
</span><span style='font-size:13.0pt;line-height:110%'>C</span><span
style='font-size:10.5pt;line-height:110%'>ONTEXT</span></h3>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.95pt;margin-left:16.4pt'>In <u>a boolean context</u>, <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>None </span>is
false and <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>not
None </span>is true.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>def
is_it_true(anything):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:374.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>...   </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>if
anything: </span><span style='font-size:10.0pt;line-height:185%;font-family:
"Liberation Mono";color:#666677'>...   </span><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>print(&quot;yes, it's
true&quot;) </span><span style='font-size:10.0pt;line-height:185%;font-family:
"Liberation Mono";color:#666677'>...      </span><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>else:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:356.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>...   </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>print(&quot;no,
it's false&quot;) </span><span style='font-size:10.0pt;line-height:185%;
font-family:"Liberation Mono";color:#666677'>...</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:416.45pt;margin-bottom:
47.65pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>is_it_true(None)
no, it's false </span><span style='font-size:10.0pt;line-height:185%;
font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>is_it_true(not
None) yes, it's true</span></p>

<p class=MsoNormal align=right style='margin-top:0in;margin-right:293.25pt;
margin-bottom:33.0pt;margin-left:.5pt;text-align:right;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h3 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>2.9.
F</span>URTHER <span style='font-size:18.0pt;line-height:112%'>R</span>EADING</h3>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://docs.python.org/3.1/library/stdtypes.html#boolean-operations-and-or-not"><span
style='color:black'>Boolean</span></a><u> </u><a
href="http://docs.python.org/3.1/library/stdtypes.html#boolean-operations-and-or-not"><span
style='color:black'>operations</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://docs.python.org/3.1/library/stdtypes.html#numeric-types-int-float-long-complex"><span
style='color:black'>Numeric</span></a><u> </u><a
href="http://docs.python.org/3.1/library/stdtypes.html#numeric-types-int-float-long-complex"><span
style='color:black'>types</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://docs.python.org/3.1/library/stdtypes.html#sequence-types-str-unicode-list-tuple-buffer-xrange"><span
style='color:black'>Sequence</span></a><u> </u><a
href="http://docs.python.org/3.1/library/stdtypes.html#sequence-types-str-unicode-list-tuple-buffer-xrange"><span
style='color:black'>types</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://docs.python.org/3.1/library/stdtypes.html#set-types-set-frozenset"><span
style='color:black'>Set</span></a><u> </u><a
href="http://docs.python.org/3.1/library/stdtypes.html#set-types-set-frozenset"><span
style='color:black'>types</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:7.3pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://docs.python.org/3.1/library/stdtypes.html#mapping-types-dict"><span
style='color:black'>Mapping</span></a><u> </u><a
href="http://docs.python.org/3.1/library/stdtypes.html#mapping-types-dict"><span
style='color:black'>types</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.55pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://docs.python.org/3.1/library/fractions.html"><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:black'>fractions</span></a><u><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'> </span></u><a
href="http://docs.python.org/3.1/library/fractions.html"><span
style='color:black'>module</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://docs.python.org/3.1/library/math.html"><span style='font-size:
10.0pt;line-height:110%;font-family:"Liberation Mono";color:black'>math</span></a><u><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'> </span></u><a
href="http://docs.python.org/3.1/library/math.html"><span style='color:black'>module</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://www.python.org/dev/peps/pep-0237/"><span style='font-size:9.5pt;
line-height:110%;color:black'>PEP</span></a><u><span style='font-size:9.5pt;
line-height:110%'> </span></u><a href="http://www.python.org/dev/peps/pep-0237/"><span
style='color:black'>237:</span></a><u> </u><a
href="http://www.python.org/dev/peps/pep-0237/"><span style='color:black'>Unifying</span></a><u>
</u><a href="http://www.python.org/dev/peps/pep-0237/"><span style='color:black'>Long</span></a><u>
</u><a href="http://www.python.org/dev/peps/pep-0237/"><span style='color:black'>Integers</span></a><u>
</u><a href="http://www.python.org/dev/peps/pep-0237/"><span style='color:black'>and</span></a><u>
</u><a href="http://www.python.org/dev/peps/pep-0237/"><span style='color:black'>Integers</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://www.python.org/dev/peps/pep-0238/"><span style='font-size:9.5pt;
line-height:110%;color:black'>PEP</span></a><u><span style='font-size:9.5pt;
line-height:110%'> </span></u><a href="http://www.python.org/dev/peps/pep-0238/"><span
style='color:black'>238:</span></a><u> </u><a
href="http://www.python.org/dev/peps/pep-0238/"><span style='color:black'>Changing</span></a><u>
</u><a href="http://www.python.org/dev/peps/pep-0238/"><span style='color:black'>the</span></a><u>
</u><a href="http://www.python.org/dev/peps/pep-0238/"><span style='color:black'>Division</span></a><u>
</u><a href="http://www.python.org/dev/peps/pep-0238/"><span style='color:black'>Operator</span></a><br
clear=all style='page-break-before:always'>
</p>

<h1 style='margin-top:0in;margin-right:22.2pt;margin-bottom:0in;margin-left:
16.4pt;margin-bottom:.0001pt'><span style='font-size:24.0pt;line-height:107%'>C</span>HAPTER
<span style='font-size:24.0pt;line-height:107%'>3. C</span>OMPREHENSIONS</h1>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:39.9pt;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=736 height=4 id="Group 632094"
src="Dive%20Into%20Python%203_files/image001.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.05pt;
margin-left:24.35pt;line-height:107%'><span style='font-size:13.0pt;line-height:
107%;font-family:"Calibri",sans-serif'>&#10077; </span><i>Our imagination is
stretched to the utmost, not, as in fiction, to imagine things which are not
really there, but just</i></p>

<p class=MsoNormal align=right style='margin-top:0in;margin-right:29.3pt;
margin-bottom:65.45pt;margin-left:363.9pt;text-align:right;line-height:160%'><i>to
comprehend those things which are. </i><span style='font-size:13.0pt;
line-height:160%;font-family:"Calibri",sans-serif'>&#10078; </span><i>— </i><a
href="http://en.wikiquote.org/wiki/Richard_Feynman"><i><span style='color:black'>Richard</span></i></a><i><u>
</u></i><a href="http://en.wikiquote.org/wiki/Richard_Feynman"><i><span
style='color:black'>Feynman</span></i></a></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:66.25pt;margin-left:
16.4pt'><span style='font-size:18.0pt;line-height:112%'>3.1. D</span>IVING <span
style='font-size:18.0pt;line-height:112%'>I</span>N</h2>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
45.45pt;margin-left:16.4pt'><span style='font-size:48.0pt;line-height:154%;
font-family:"DejaVu Serif",serif;color:#888888'>E </span>very programming
language has that one feature, a complicated thing intentionally made simple.
If you’re coming from another language, you could easily miss it, because your
old language didn’t make that thing simple (because it was busy making
something else simple instead). This chapter will teach you about list
comprehensions, dictionary comprehensions, and set comprehensions: three
related concepts centered around one very powerful technique. But first, I want
to take a little detour into two modules that will help you navigate your local
file system.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:33.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h2 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>3.2.
W</span>ORKING <span style='font-size:18.0pt;line-height:112%'>W</span>ITH <span
style='font-size:18.0pt;line-height:112%'>F</span>ILES <span style='font-size:
18.0pt;line-height:112%'>A</span>ND <span style='font-size:18.0pt;line-height:
112%'>D</span>IRECTORIES</h2>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>Python 3 comes with a module called <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>os</span>,
which stands for “operating system.” The <a
href="http://docs.python.org/3.1/library/os.html"><span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono";color:black'>os</span></a><u><span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'> </span></u><a
href="http://docs.python.org/3.1/library/os.html"><span style='color:black'>module</span></a><u>
</u>contains a plethora of functions to get information on — and in some cases,
to manipulate — local directories, files, processes, and environment variables.
Python does its best to offer a unified <span style='font-size:9.5pt;
line-height:154%'>API </span>across <u>all supported operating systems </u>so
your programs can run on any computer with as little platform-specific code as
possible.</p>

<h3 style='margin-top:0in;margin-right:0in;margin-bottom:25.25pt;margin-left:
16.4pt;line-height:110%'><span style='font-size:13.0pt;line-height:110%'>3.2.1.
T</span><span style='font-size:10.5pt;line-height:110%'>HE </span><span
style='font-size:13.0pt;line-height:110%'>C</span><span style='font-size:10.5pt;
line-height:110%'>URRENT </span><span style='font-size:13.0pt;line-height:110%'>W</span><span
style='font-size:10.5pt;line-height:110%'>ORKING </span><span style='font-size:
13.0pt;line-height:110%'>D</span><span style='font-size:10.5pt;line-height:
110%'>IRECTORY</span></h3>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.4pt;line-height:107%'>When you’re just getting started
with Python, you’re going to spend a lot of time in <u>the Python Shell</u>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
22.05pt;margin-left:16.4pt'>Throughout this book, you will see examples that go
like this:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Import one of
the modules in the <u><span style='font-size:10.0pt;line-height:107%;
font-family:"Liberation Mono"'>examples </span>folder</u></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Call a function
in that module</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.45pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Explain the result</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.95pt;margin-left:16.4pt'><img width=298 height=1
src="Dive%20Into%20Python%203_files/image033.gif" align=left hspace=12>If you
don’t know about the current working directory, step 1 will probably fail with
an <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>ImportError</span>.
Why? Because Python will look for the example module in <u>the import search
path</u>, but it won’t find it because the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>examples </span>folder isn’t
one of the directories in the search path. To get past this, you can do one of
two things:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.55pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Add the <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>examples
</span>folder to the import search path</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.4pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Change the current working directory to the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>examples </span>folder</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.65pt;margin-left:16.4pt'>The current working directory is an invisible
property that Python holds in memory at all times. There is always a current
working directory, whether you’re in the Python Shell, running your own Python
script from the command line, or running a Python <span style='font-size:9.5pt;
line-height:154%'>CGI </span>script on a web server somewhere.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>The <span style='font-size:10.0pt;
line-height:107%;font-family:"Liberation Mono"'>os </span>module contains two
functions to deal with the current working directory.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.75pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>import os                                            </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>print(os.getcwd())                                   </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>C:\Python31</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.75pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>os.chdir('/Users/pilgrim/diveintopython3/examples')
</span><span style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>print(os.getcwd())                                   </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.15pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>C:\Users\pilgrim\diveintopython3\examples</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.45pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>os </span>module
comes with Python; you can import it anytime, anywhere.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.05pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Use the <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>os.getcwd()
</span>function to get the current working directory. When you run the
graphical Python</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.35pt;margin-left:16.4pt;line-height:107%'>Shell, the current working
directory starts as the directory where the Python Shell executable is. On</p>

<p class=MsoNormal style='margin-top:0in;margin-right:34.0pt;margin-bottom:
.25pt;margin-left:16.4pt'>Windows, this depends on where you installed Python;
the default directory is <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>c:\Python31</span>. If you run the Python Shell
from the command line, the current working directory starts as the directory
you were in when you ran <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>python3</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.35pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Use the <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>os.chdir()
</span>function to change the current working directory.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
22.3pt;margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>When I called the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>os.chdir() </span>function, I used a Linux-style
pathname (forward slashes, no drive letter) even though I’m on Windows. This is
one of the places where Python tries to paper over the differences between
operating systems.</p>

<h3 style='margin-top:0in;margin-right:0in;margin-bottom:25.25pt;margin-left:
16.4pt;line-height:110%'><span style='font-size:13.0pt;line-height:110%'>3.2.2.
W</span><span style='font-size:10.5pt;line-height:110%'>ORKING </span><span
style='font-size:13.0pt;line-height:110%'>W</span><span style='font-size:10.5pt;
line-height:110%'>ITH </span><span style='font-size:13.0pt;line-height:110%'>F</span><span
style='font-size:10.5pt;line-height:110%'>ILENAMES AND </span><span
style='font-size:13.0pt;line-height:110%'>D</span><span style='font-size:10.5pt;
line-height:110%'>IRECTORY </span><span style='font-size:13.0pt;line-height:
110%'>N</span><span style='font-size:10.5pt;line-height:110%'>AMES</span></h3>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.05pt;margin-left:16.4pt'>While we’re on the subject of directories, I want
to point out the <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>os.path </span>module. <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>os.path </span>contains
functions for manipulating filenames and directory names.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.0pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>import
os</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>print(os.path.join('/Users/pilgrim/diveintopython3/examples/',
'humansize.py'))</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.0pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>/Users/pilgrim/diveintopython3/examples/humansize.py</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>print(os.path.join('/Users/pilgrim/diveintopython3/examples',
'humansize.py'))</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.0pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>/Users/pilgrim/diveintopython3/examples\humansize.py</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:260.45pt;margin-bottom:
1.5pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>print(os.path.expanduser('~'))
c:\Users\pilgrim</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-3.55pt;margin-bottom:
8.25pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>print(os.path.join(os.path.expanduser('~'),
'diveintopython3', 'examples', 'humansize.py')
c:\Users\pilgrim\diveintopython3\examples\humansize.py</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>os.path.join()
</span>function constructs a pathname out of one or more partial pathnames. In
this case, it simply concatenates strings.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>In this slightly less trivial case, <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>join </span>will add an extra
slash to the pathname before joining it to the filename. It’s a backslash
instead of a forward slash, because I constructed this example on Windows. If
you replicate this example on Linux or Mac OS X, you’ll see a forward slash
instead. Python can access the file regardless of what kind of slashes you use
in the pathname.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.15pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:155%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The <span
style='font-size:10.0pt;line-height:155%;font-family:"Liberation Mono"'>os.path.expanduser()
</span>function will expand a pathname that uses <span style='font-size:10.0pt;
line-height:155%;font-family:"Liberation Mono"'>~ </span>to represent the
current user’s home directory. This works on any platform where users have a
home directory, including Linux, Mac OS X, and Windows. The returned path does
not have a trailing slash, but the <span style='font-size:10.0pt;line-height:
155%;font-family:"Liberation Mono"'>os.path.join() </span>function doesn’t
mind.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.75pt;margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Combining these techniques, you can easily construct pathnames for
directories and files in the user’s home directory. The <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>os.path.join() </span>function
can take any number of arguments. I was overjoyed when I discovered this, since
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>addSlashIfNecessary()
</span>is one of the stupid little functions I always need to write when
building up my toolbox in a new language. <i>Do not </i>write this stupid
little function in Python; smart people have already taken care of it for you.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
18.85pt;margin-left:16.4pt'><span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>os.path </span>also contains functions to split
full pathnames, directory names, and filenames into their constituent parts.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>pathname
= '/Users/pilgrim/diveintopython3/examples/humansize.py'</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=550
 style='width:412.8pt;margin-left:38.15pt;border-collapse:collapse'>
 <tr style='height:39.3pt'>
  <td width=536 valign=top style='width:402.05pt;padding:0in 0in 0in 0in;
  height:39.3pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>os.path.split(pathname)</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>('/Users/pilgrim/diveintopython3/examples',
  'humansize.py')</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:39.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9312;</span></p>
  </td>
 </tr>
 <tr style='height:22.5pt'>
  <td width=536 valign=top style='width:402.05pt;padding:0in 0in 0in 0in;
  height:22.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono";
  color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
  107%;font-family:"Liberation Mono"'>(dirname, filename) =
  os.path.split(pathname)</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:22.5pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9313;</span></p>
  </td>
 </tr>
 <tr style='height:43.5pt'>
  <td width=536 valign=top style='width:402.05pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>dirname</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>'/Users/pilgrim/diveintopython3/examples'</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9314;</span></p>
  </td>
 </tr>
 <tr style='height:43.5pt'>
  <td width=536 valign=top style='width:402.05pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>filename</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>'humansize.py'</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9315;</span></p>
  </td>
 </tr>
 <tr style='height:18.3pt'>
  <td width=536 valign=bottom style='width:402.05pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono";
  color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
  107%;font-family:"Liberation Mono"'>(shortname, extension) =
  os.path.splitext(filename)</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9316;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>shortname</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'humansize'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>extension</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'.py'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>split </span>function
splits a full pathname and returns a tuple containing the path and filename.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.7pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Remember when I
said you could use <u>multi-variable assignment </u>to return multiple values
from a function?</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>The <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>os.path.split() </span>function does exactly
that. You assign the return value of the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>split </span>function into a
tuple of two variables. Each variable receives the value of the corresponding
element of the returned tuple.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The first variable, <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>dirname</span>, receives the value of the first
element of the tuple returned from the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>os.path.split() </span>function,
the file path.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The second variable, <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>filename</span>, receives the value of the
second element of the tuple returned from the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>os.path.split() </span>function,
the filename.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
22.15pt;margin-left:16.65pt;text-indent:-16.65pt'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span><span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>os.path
</span>also contains the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>os.path.splitext() </span>function, which splits
a filename and returns a tuple containing the filename and the file extension.
You use the same technique to assign each of them to separate variables.</p>

<h3 style='margin-top:0in;margin-right:0in;margin-bottom:25.25pt;margin-left:
16.4pt;line-height:110%'><span style='font-size:13.0pt;line-height:110%'>3.2.3.
L</span><span style='font-size:10.5pt;line-height:110%'>ISTING </span><span
style='font-size:13.0pt;line-height:110%'>D</span><span style='font-size:10.5pt;
line-height:110%'>IRECTORIES</span></h3>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
23.95pt;margin-left:16.4pt'>The <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>glob </span>module is another tool in the Python
standard library. It’s an easy way to get the contents of a directory
programmatically, and it uses the sort of wildcards that you may already be
familiar with from working on the command line.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:345.15pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=298 height=397 src="Dive%20Into%20Python%203_files/image037.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>os.chdir('/Users/pilgrim/diveintopython3/')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>import
glob</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=406
 style='width:304.8pt;margin-left:38.15pt;border-collapse:collapse'>
 <tr style='height:81.3pt'>
  <td width=392 valign=top style='width:294.05pt;padding:0in 0in 0in 0in;
  height:81.3pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>glob.glob('examples/*.xml')</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>['examples\\feed-broken.xml',</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:12.05pt;margin-bottom:
  0in;margin-left:6.0pt;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>'examples\\feed-ns0.xml',
  'examples\\feed.xml']</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:81.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9312;</span></p>
  </td>
 </tr>
 <tr style='height:22.5pt'>
  <td width=392 valign=top style='width:294.05pt;padding:0in 0in 0in 0in;
  height:22.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono";
  color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
  107%;font-family:"Liberation Mono"'>os.chdir('examples/')</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:22.5pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9313;</span></p>
  </td>
 </tr>
 <tr style='height:18.3pt'>
  <td width=392 valign=bottom style='width:294.05pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono";
  color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
  107%;font-family:"Liberation Mono"'>glob.glob('*test*.py')</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9314;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:350.45pt;margin-bottom:
0in;margin-left:43.4pt;text-indent:-6.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>['alphameticstest.py',
'pluraltest1.py', 'pluraltest2.py', 'pluraltest3.py', 'pluraltest4.py',
'pluraltest5.py',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:356.45pt;margin-bottom:
0in;margin-left:44.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>'pluraltest6.py',
'romantest1.py',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:362.45pt;margin-bottom:
0in;margin-left:44.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>'romantest10.py',
'romantest2.py', 'romantest3.py', 'romantest4.py', 'romantest5.py',
'romantest6.py', 'romantest7.py', 'romantest8.py',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.2pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'romantest9.py']</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:34.1pt;margin-bottom:
.15pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:155%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The <span
style='font-size:10.0pt;line-height:155%;font-family:"Liberation Mono"'>glob </span>module
takes a wildcard and returns the path of all files and directories matching the
wildcard. In this example, the wildcard is a directory path plus “<span
style='font-size:10.0pt;line-height:155%;font-family:"Liberation Mono"'>*.xml</span>”,
which will match all <span style='font-size:10.0pt;line-height:155%;font-family:
"Liberation Mono"'>.xml </span>files in the <span style='font-size:10.0pt;
line-height:155%;font-family:"Liberation Mono"'>examples </span>subdirectory.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:34.1pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Now change the current working directory to the <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>examples </span>subdirectory.
The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>os.chdir()
</span>function can take relative pathnames.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:34.1pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>You can include multiple wildcards in your glob pattern. This example
finds all the files in the current working directory that end in a <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>.py </span>extension
and contain the word <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>test </span>anywhere in their filename.</p>

<h3 style='margin-top:0in;margin-right:0in;margin-bottom:25.25pt;margin-left:
16.4pt;line-height:110%'><span style='font-size:13.0pt;line-height:110%'>3.2.4.
G</span><span style='font-size:10.5pt;line-height:110%'>ETTING </span><span
style='font-size:13.0pt;line-height:110%'>F</span><span style='font-size:10.5pt;
line-height:110%'>ILE </span><span style='font-size:13.0pt;line-height:110%'>M</span><span
style='font-size:10.5pt;line-height:110%'>ETADATA</span></h3>

<p class=MsoNormal style='margin-top:0in;margin-right:34.4pt;margin-bottom:
19.05pt;margin-left:16.4pt'>Every modern file system stores metadata about each
file: creation date, last-modified date, file size, and so on. Python provides
a single <span style='font-size:9.5pt;line-height:154%'>API </span>to access
this metadata. You don’t need to open the file; all you need is the filename.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.6pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>import
os</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:69.65pt;margin-bottom:
4.15pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>print(os.getcwd())  </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312; </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>c:\Users\pilgrim\diveintopython3\examples</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.75pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>metadata = os.stat('feed.xml')     </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>metadata.st_mtime                  </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.5pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>1247520344.9537716</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.85pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>import time                        </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>time.localtime(metadata.st_mtime)
</span><span style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9316;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
23.05pt;margin-left:49.4pt;text-indent:-12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>time.struct_time(tm_year=2009,
tm_mon=7, tm_mday=13, tm_hour=17, tm_min=25, tm_sec=44, tm_wday=0, tm_yday=194,
tm_isdst=1)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.95pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The current
working directory is the <span style='font-size:10.0pt;line-height:107%;
font-family:"Liberation Mono"'>examples </span>folder.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span><span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>feed.xml
</span>is a file in the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>examples </span>folder. Calling the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>os.stat()
</span>function returns an object that contains several different types of
metadata about the file.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span><span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>st_mtime
</span>is the modification time, but it’s in a format that isn’t terribly
useful. (Technically, it’s the number of seconds since the Epoch, which is
defined as the first second of January 1st, 1970. Seriously.)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>time
</span>module is part of the Python standard library. It contains functions to
convert between different time representations, format time values into
strings, and fiddle with timezones.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.0pt;margin-left:16.65pt;text-indent:-16.65pt'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>time.localtime()
</span>function converts a time value from seconds-since-the-Epoch (from the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>st_mtime
</span>property returned from the <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>os.stat() </span>function) into a more
useful structure of year, month, day, hour, minute, second, and so on. This
file was last modified on July 13, 2009, at around 5:25 PM.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.6pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'># continued from the previous example</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>metadata.st_size                              </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>3070</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>import
humansize</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>humansize.approximate_size(metadata.st_size)
</span><span style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'3.0 KiB'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>os.stat()
</span>function also returns the size of a file, in the <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>st_size </span>property.
The file <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>feed.xml
</span>is <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>3070
</span>bytes.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
23.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>You can pass the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>st_size </span>property to the <u><span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>approximate_size()
</span>function</u>.</p>

<h3 style='margin-top:0in;margin-right:0in;margin-bottom:25.25pt;margin-left:
16.4pt;line-height:110%'><span style='font-size:13.0pt;line-height:110%'>3.2.5.
C</span><span style='font-size:10.5pt;line-height:110%'>ONSTRUCTING </span><span
style='font-size:13.0pt;line-height:110%'>A</span><span style='font-size:10.5pt;
line-height:110%'>BSOLUTE </span><span style='font-size:13.0pt;line-height:
110%'>P</span><span style='font-size:10.5pt;line-height:110%'>ATHNAMES</span></h3>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
18.85pt;margin-left:16.4pt'>In <u>the previous section</u>, the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>glob.glob()
</span>function returned a list of relative pathnames. The first example had
pathnames like <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>'examples\feed.xml'</span>,
and the second example had even shorter relative pathnames like <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>'romantest1.py'</span>.
As long as you stay in the same current working directory, these relative
pathnames will work for opening files or getting file metadata. But if you want
to construct an absolute pathname — <i>i.e. </i>one that includes all the
directory names back to the root directory or drive letter — then you’ll need
the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>os.path.realpath()
</span>function.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>import
os</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>print(os.getcwd())</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:260.45pt;margin-bottom:
47.65pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>c:\Users\pilgrim\diveintopython3\examples
</span><span style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
185%;font-family:"Liberation Mono"'>print(os.path.realpath('feed.xml'))
c:\Users\pilgrim\diveintopython3\examples\feed.xml</span></p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:33.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h2 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>3.3.
L</span>IST <span style='font-size:18.0pt;line-height:112%'>C</span>OMPREHENSIONS</h2>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.05pt;margin-left:16.4pt'><img width=316 height=1
src="Dive%20Into%20Python%203_files/image038.gif" align=left hspace=12>A list
comprehension provides a compact way of mapping a list into another list by
applying a function to each of the elements of the list.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:16.45pt;margin-bottom:
305.15pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>a_list
= [1, 9, 8, 4]</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>[elem * 2 for elem in a_list]           </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.35pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>[2, 18, 16, 8]</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>a_list                                  </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>[1, 9, 8, 4]</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>a_list
= [elem * 2 for elem in a_list] </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>a_list</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.3pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>[2, 18, 16, 8]</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:34.1pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>To make sense of this, look at it from right to left. <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>a_list </span>is
the list you’re mapping. The Python interpreter loops through <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>a_list </span>one
element at a time, temporarily assigning the value of each element to the
variable <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>elem</span>.
Python then applies the function <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>elem * 2 </span>and appends that result to
the returned list.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:34.1pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>A list
comprehension creates a new list; it does not change the original list.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:34.1pt;margin-bottom:
20.35pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:155%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>It is safe to
assign the result of a list comprehension to the variable that you’re mapping.
Python constructs the new list in memory, and when the list comprehension is
complete, it assigns the result to the original variable.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.0pt;margin-left:16.4pt'>You can use any Python expression in a list
comprehension, including the functions in the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>os </span>module for
manipulating files and directories.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.6pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>import
os, glob</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>glob.glob('*.xml')                                 </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>['feed-broken.xml', 'feed-ns0.xml',
'feed.xml']</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>[os.path.realpath(f)
for f in glob.glob('*.xml')] </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>['c:\\Users\\pilgrim\\diveintopython3\\examples\\feed-broken.xml',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'c:\\Users\\pilgrim\\diveintopython3\\examples\\feed-ns0.xml',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.25pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'c:\\Users\\pilgrim\\diveintopython3\\examples\\feed.xml']</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.2pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>This returns a
list of all the <span style='font-size:10.0pt;line-height:107%;font-family:
"Liberation Mono"'>.xml </span>files in the current working directory.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.5pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>This list comprehension takes that list of <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>.xml </span>files and
transforms it into a list of full pathnames.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.9pt;margin-left:16.4pt'>List comprehensions can also filter items, producing
a result that can be smaller than the original list.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>import
os, glob</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>[f for
f in glob.glob('*.py') if os.stat(f).st_size &gt; 6000] </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>['pluraltest6.py',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:362.45pt;margin-bottom:
0in;margin-left:44.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>'romantest10.py',
'romantest6.py', 'romantest7.py', 'romantest8.py',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.1pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'romantest9.py']</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.   To filter a list, you can
include an <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>if
</span>clause at the end of the list comprehension. The expression after the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>if </span>keyword
will be evaluated for each item in the list. If the expression evaluates to <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>True</span>,
the item will be included in the output. This list comprehension looks at the
list of all <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>.py
</span>files in the current directory, and the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>if </span>expression filters
that list by testing whether the size of each file is greater than <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>6000 </span>bytes.
There are six such files, so the list comprehension returns a list of six
filenames.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.05pt;margin-left:16.4pt'>All the examples of list comprehensions so far have
featured simple expressions — multiply a number by a constant, call a single
function, or simply return the original list item (after filtering). But
there’s no limit to how complex a list comprehension can be.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>import
os, glob</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>[(os.stat(f).st_size, os.path.realpath(f))
for f in glob.glob('*.xml')]     </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>[(3074,
'c:\\Users\\pilgrim\\diveintopython3\\examples\\feed-broken.xml'),</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>(3386,
'c:\\Users\\pilgrim\\diveintopython3\\examples\\feed-ns0.xml'),</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>(3070,
'c:\\Users\\pilgrim\\diveintopython3\\examples\\feed.xml')]</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>import
humansize</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>[(humansize.approximate_size(os.stat(f).st_size),
f) for f in glob.glob('*.xml')] </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>[('3.0 KiB', 'feed-broken.xml'),</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>('3.3 KiB', 'feed-ns0.xml'),</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.2pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>('3.0 KiB', 'feed.xml')]</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:32.15pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>This list comprehension finds all the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>.xml </span>files in the
current working directory, gets the size of each file (by calling the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>os.stat()
</span>function), and constructs a tuple of the file size and the absolute path
of each file (by calling the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>os.path.realpath() </span>function).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:32.15pt;margin-bottom:
45.55pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>This comprehension builds on the previous one to call the <u><span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>approximate_size()
</span>function </u>with the file size of each <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>.xml </span>file.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:33.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h2 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>3.4.
D</span>ICTIONARY <span style='font-size:18.0pt;line-height:112%'>C</span>OMPREHENSIONS</h2>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>A dictionary comprehension is like a
list comprehension, but it constructs a dictionary instead of a list.</p>

</div>

<span style='font-size:12.0pt;line-height:154%;font-family:"Gill Sans MT",sans-serif;
color:black'><br clear=all style='page-break-before:always'>
</span>

<div class=WordSection8>

<p class=MsoNormal style='margin-top:0in;margin-right:111.2pt;margin-bottom:
0in;margin-left:62.65pt;line-height:180%'><span style='font-size:10.0pt;
line-height:180%;font-family:"Liberation Mono"'>import os, glob metadata = [(f,
os.stat(f)) for f in glob.glob('*test*.py')]   </span><span style='font-family:
"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>metadata[0]                                                     </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:32.0pt;margin-bottom:
4.25pt;margin-left:43.4pt;text-indent:-6.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>('alphameticstest.py',
nt.stat_result(st_mode=33206, st_ino=0, st_dev=0, st_nlink=0, st_uid=0,
st_gid=0, st_size=2509, st_atime=1247520344, st_mtime=1247520344,
st_ctime=1247520344))</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.75pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>metadata_dict
= {f:os.stat(f) for f in glob.glob('*test*.py')} </span><span style='font-family:
"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>type(metadata_dict)                                             </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;class 'dict'&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>list(metadata_dict.keys())                                      </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9316;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>['romantest8.py', 'pluraltest1.py',
'pluraltest2.py', 'pluraltest5.py',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:20.0pt;margin-bottom:
0in;margin-left:44.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>'pluraltest6.py',
'romantest7.py', 'romantest10.py', 'romantest4.py', 'romantest9.py',
'pluraltest3.py', 'romantest1.py', 'romantest2.py', 'romantest3.py',
'romantest5.py', 'romantest6.py', 'alphameticstest.py',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'pluraltest4.py']</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>metadata_dict['alphameticstest.py'].st_size                     </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9317;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.3pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>2509</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:15.85pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>This is not a dictionary comprehension; it’s a <u>list comprehension</u>.
It finds all <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>.py
</span>files with <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>test </span>in their name, then constructs a tuple of the
filename and the file metadata (from calling the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>os.stat() </span>function).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:15.85pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Each item of the
resulting list is a tuple.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:15.85pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>This is a dictionary comprehension. The syntax is similar to a list
comprehension, with two differences. First, it is enclosed in curly braces
instead of square brackets. Second, instead of a single expression for each
item, it contains two expressions separated by a colon. The expression before
the colon (<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>f
</span>in this example) is the dictionary key; the expression after the colon (<span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>os.stat(f)
</span>in this example) is the value.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:15.85pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>A dictionary
comprehension returns a dictionary.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:15.85pt;margin-bottom:
1.95pt;margin-left:16.65pt;text-indent:-16.65pt'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The keys of this particular dictionary are simply the filenames returned
from the call to <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>glob.glob('*test*.py')</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:15.85pt;margin-bottom:
20.5pt;margin-left:16.65pt;text-indent:-16.65pt'>6.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The value associated with each key is the return value from the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>os.stat()
</span>function. That means we can “look up” a file by name in this dictionary
to get its file metadata. One of the pieces of metadata is <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>st_size</span>,
the file size. The file <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>alphameticstest.py </span>is <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>2509 </span>bytes
long.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>Like list comprehensions, you can include an <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>if </span>clause
in a dictionary comprehension to filter the input sequence based on an
expression which is evaluated with each item.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>import os, glob, humansize</span></p>

<p class=MsoNormal style='margin-top:9.65pt;margin-right:0in;margin-bottom:
31.05pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono"'>'6.5 KiB'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.8pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>This dictionary
comprehension constructs a list of all the files in the current working
directory</p>

<p class=MsoNormal style='margin-left:16.4pt'>(<span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>glob.glob('*')</span>), gets
the file metadata for each file (<span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>os.stat(f)</span>), and constructs a
dictionary whose keys are filenames and whose values are the metadata for each
file.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=750 style='width:562.85pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:39.3pt'>
  <td width=736 valign=top style='width:552.1pt;padding:0in 0in 0in 0in;
  height:39.3pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:24.0pt;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>metadata_dict =
  {f:os.stat(f) for f in glob.glob('*')}</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono";
  color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
  107%;font-family:"Liberation Mono"'>humansize_dict =
  {os.path.splitext(f)[0]:humansize.approximate_size(meta.st_size) \</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:39.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9312;</span></p>
  </td>
 </tr>
 <tr style='height:22.5pt'>
  <td width=736 valign=top style='width:552.1pt;padding:0in 0in 0in 0in;
  height:22.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono";
  color:#666677'>...                   </span><span style='font-size:10.0pt;
  line-height:107%;font-family:"Liberation Mono"'>for f, meta in
  metadata_dict.items() if meta.st_size &gt; 6000}</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:22.5pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9313;</span></p>
  </td>
 </tr>
 <tr style='height:43.5pt'>
  <td width=736 valign=top style='width:552.1pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>list(humansize_dict.keys())</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>['romantest9',
  'romantest8', 'romantest7', 'romantest6', 'romantest10', 'pluraltest6']</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9314;</span></p>
  </td>
 </tr>
 <tr style='height:18.3pt'>
  <td width=736 valign=bottom style='width:552.1pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono";
  color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
  107%;font-family:"Liberation Mono"'>humansize_dict['romantest9']</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9315;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
2.2pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>This dictionary comprehension builds on the previous comprehension,
filters out files smaller than <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>6000 </span>bytes (<span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>if meta.st_size &gt; 6000</span>),
and uses that filtered list to construct a dictionary whose keys are the
filename minus the extension (<span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>os.path.splitext(f)[0]</span>) and whose values
are the approximate size of each file</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.6pt;
margin-left:17.15pt;line-height:110%'>(<span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono"'>humansize.approximate_size(meta.st_size)</span>).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.75pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>As you saw in a
previous example, there are six such files, thus there are six items in this
dictionary.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
23.15pt;margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The value of each key is the string returned from the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>approximate_size()
</span>function.</p>

<h3 style='margin-top:0in;margin-right:0in;margin-bottom:25.25pt;margin-left:
16.4pt;line-height:110%'><span style='font-size:13.0pt;line-height:110%'>3.4.1.
O</span><span style='font-size:10.5pt;line-height:110%'>THER </span><span
style='font-size:13.0pt;line-height:110%'>F</span><span style='font-size:10.5pt;
line-height:110%'>UN </span><span style='font-size:13.0pt;line-height:110%'>S</span><span
style='font-size:10.5pt;line-height:110%'>TUFF </span><span style='font-size:
13.0pt;line-height:110%'>T</span><span style='font-size:10.5pt;line-height:
110%'>O </span><span style='font-size:13.0pt;line-height:110%'>D</span><span
style='font-size:10.5pt;line-height:110%'>O </span><span style='font-size:13.0pt;
line-height:110%'>W</span><span style='font-size:10.5pt;line-height:110%'>ITH </span><span
style='font-size:13.0pt;line-height:110%'>D</span><span style='font-size:10.5pt;
line-height:110%'>ICTIONARY </span><span style='font-size:13.0pt;line-height:
110%'>C</span><span style='font-size:10.5pt;line-height:110%'>OMPREHENSIONS</span></h3>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:19.05pt;
margin-left:16.4pt'>Here’s a trick with dictionary comprehensions that might be
useful someday: swapping the keys and values of a dictionary.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>a_dict
= {'a': 1, 'b': 2, 'c': 3}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>{value:key
for key, value in a_dict.items()}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>{1: 'a', 2: 'b', 3: 'c'}</span></p>

<p class=MsoNormal style='margin-left:16.4pt'>Of course, this only works if the
values of the dictionary are immutable, like strings or tuples. If you try this
with a dictionary that contains lists, it will fail most spectacularly.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:200.0pt;margin-bottom:
0in;margin-left:37.4pt;text-indent:24.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>a_dict
= {'a': [1, 2, 3], 'b': 4, 'c': 5} {value:key for key, value in a_dict.items()}
</span><span style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
color:#880000'>Traceback (most recent call last):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>File
&quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>File
&quot;&lt;stdin&gt;&quot;, line 1, in &lt;dictcomp&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
56.15pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>TypeError:
unhashable type: 'list'</span></p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:3.0pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h2 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>3.5.
S</span>ET <span style='font-size:18.0pt;line-height:112%'>C</span>OMPREHENSIONS</h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:19.05pt;
margin-left:16.4pt'>Not to be left out, sets have their own comprehension
syntax as well. It is remarkably similar to the syntax for dictionary
comprehensions. The only difference is that sets just have values instead of
key:value pairs.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>a_set =
set(range(10))</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>a_set</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>{0, 1, 2, 3, 4, 5, 6, 7, 8, 9}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>{x ** 2 for x in a_set}           </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>{0, 1, 4, 81, 64, 9, 16, 49, 25, 36}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>{x for
x in a_set if x % 2 == 0} </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>{0, 8, 2, 4, 6}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>{2**x for x in range(10)}         </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>{32, 1, 2, 4, 8, 64, 128, 256, 16, 512}</span></p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Set
comprehensions can take a set as input. This set comprehension calculates the
squares of the set of numbers from 0 to <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>9</span>.</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Like list
comprehensions and dictionary comprehensions, set comprehensions can contain an
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>if
</span>clause to filter each item before returning it in the result set.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:46.55pt;
margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Set comprehensions do not need to take a set as input; they can take any
sequence.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:3.0pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

</div>

<span style='font-size:12.0pt;line-height:154%;font-family:"Gill Sans MT",sans-serif;
color:black'><br clear=all style='page-break-before:always'>
</span>

<div class=WordSection9>

<h2 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>3.6.
F</span>URTHER <span style='font-size:18.0pt;line-height:112%'>R</span>EADING</h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://docs.python.org/3.1/library/os.html"><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:black'>os</span></a><u><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'> </span></u><a
href="http://docs.python.org/3.1/library/os.html"><span style='color:black'>module</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.1in;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://www.doughellmann.com/PyMOTW/os/"><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:black'>os</span></a><u><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'> </span></u><a
href="http://www.doughellmann.com/PyMOTW/os/"><span style='color:black'>—</span></a><u>
</u><a href="http://www.doughellmann.com/PyMOTW/os/"><span style='color:black'>Portable</span></a><u>
</u><a href="http://www.doughellmann.com/PyMOTW/os/"><span style='color:black'>access</span></a><u>
</u><a href="http://www.doughellmann.com/PyMOTW/os/"><span style='color:black'>to</span></a><u>
</u><a href="http://www.doughellmann.com/PyMOTW/os/"><span style='color:black'>operating</span></a><u>
</u><a href="http://www.doughellmann.com/PyMOTW/os/"><span style='color:black'>system</span></a><u>
</u><a href="http://www.doughellmann.com/PyMOTW/os/"><span style='color:black'>specific</span></a><u>
</u><a href="http://www.doughellmann.com/PyMOTW/os/"><span style='color:black'>features</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.55pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://docs.python.org/3.1/library/os.path.html"><span style='font-size:
10.0pt;line-height:110%;font-family:"Liberation Mono";color:black'>os.path</span></a><u><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'> </span></u><a
href="http://docs.python.org/3.1/library/os.path.html"><span style='color:black'>module</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://www.doughellmann.com/PyMOTW/ospath/"><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:black'>os.path</span></a><u><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'> </span></u><a
href="http://www.doughellmann.com/PyMOTW/ospath/"><span style='color:black'>—</span></a><u>
</u><a href="http://www.doughellmann.com/PyMOTW/ospath/"><span
style='color:black'>Platform-independent</span></a><u> </u><a
href="http://www.doughellmann.com/PyMOTW/ospath/"><span style='color:black'>manipulation</span></a><u>
</u><a href="http://www.doughellmann.com/PyMOTW/ospath/"><span
style='color:black'>of</span></a><u> </u><a
href="http://www.doughellmann.com/PyMOTW/ospath/"><span style='color:black'>file</span></a><u>
</u><a href="http://www.doughellmann.com/PyMOTW/ospath/"><span
style='color:black'>names</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://docs.python.org/3.1/library/glob.html"><span style='font-size:
10.0pt;line-height:110%;font-family:"Liberation Mono";color:black'>glob</span></a><u><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'> </span></u><a
href="http://docs.python.org/3.1/library/glob.html"><span style='color:black'>module</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://www.doughellmann.com/PyMOTW/glob/"><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:black'>glob</span></a><u><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'> </span></u><a
href="http://www.doughellmann.com/PyMOTW/glob/"><span style='color:black'>—</span></a><u>
</u><a href="http://www.doughellmann.com/PyMOTW/glob/"><span style='color:black'>Filename</span></a><u>
</u><a href="http://www.doughellmann.com/PyMOTW/glob/"><span style='color:black'>pattern</span></a><u>
</u><a href="http://www.doughellmann.com/PyMOTW/glob/"><span style='color:black'>matching</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://docs.python.org/3.1/library/time.html"><span style='font-size:
10.0pt;line-height:110%;font-family:"Liberation Mono";color:black'>time</span></a><u><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'> </span></u><a
href="http://docs.python.org/3.1/library/time.html"><span style='color:black'>module</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://www.doughellmann.com/PyMOTW/time/"><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:black'>time</span></a><u><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'> </span></u><a
href="http://www.doughellmann.com/PyMOTW/time/"><span style='color:black'>—</span></a><u>
</u><a href="http://www.doughellmann.com/PyMOTW/time/"><span style='color:black'>Functions</span></a><u>
</u><a href="http://www.doughellmann.com/PyMOTW/time/"><span style='color:black'>for</span></a><u>
</u><a href="http://www.doughellmann.com/PyMOTW/time/"><span style='color:black'>manipulating</span></a><u>
</u><a href="http://www.doughellmann.com/PyMOTW/time/"><span style='color:black'>clock</span></a><u>
</u><a href="http://www.doughellmann.com/PyMOTW/time/"><span style='color:black'>time</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://docs.python.org/3.1/tutorial/datastructures.html#list-comprehensions"><span
style='color:black'>List</span></a><u> </u><a
href="http://docs.python.org/3.1/tutorial/datastructures.html#list-comprehensions"><span
style='color:black'>comprehensions</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://docs.python.org/3.1/tutorial/datastructures.html#nested-list-comprehensions"><span
style='color:black'>Nested</span></a><u> </u><a
href="http://docs.python.org/3.1/tutorial/datastructures.html#nested-list-comprehensions"><span
style='color:black'>list</span></a><u> </u><a
href="http://docs.python.org/3.1/tutorial/datastructures.html#nested-list-comprehensions"><span
style='color:black'>comprehensions</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://docs.python.org/3.1/tutorial/datastructures.html#looping-techniques"><span
style='color:black'>Looping</span></a><u> </u><a
href="http://docs.python.org/3.1/tutorial/datastructures.html#looping-techniques"><span
style='color:black'>techniques</span></a><br clear=all style='page-break-before:
always'>
</p>

<h1 style='margin-top:0in;margin-right:22.2pt;margin-bottom:0in;margin-left:
16.4pt;margin-bottom:.0001pt'><span style='font-size:24.0pt;line-height:107%'>C</span>HAPTER
<span style='font-size:24.0pt;line-height:107%'>4. S</span>TRINGS</h1>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:39.9pt;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=736 height=4 id="Group 639653"
src="Dive%20Into%20Python%203_files/image001.gif"></span></p>

<p class=MsoNormal align=right style='margin-top:0in;margin-right:.05pt;
margin-bottom:6.05pt;margin-left:16.6pt;text-align:right;line-height:107%'><span
style='font-size:13.0pt;line-height:107%;font-family:"Calibri",sans-serif'>&#10077;
</span><i>I’m telling you this ’cause you’re one of my friends.</i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:66.25pt;
margin-left:416.4pt;text-indent:-75.95pt;line-height:160%'><i>My alphabet
starts where your alphabet ends! </i><span style='font-size:13.0pt;line-height:
160%;font-family:"Calibri",sans-serif'>&#10078; </span><i>— Dr. Seuss, On
Beyond Zebra!</i></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:65.95pt;margin-left:
16.4pt'><span style='font-size:18.0pt;line-height:112%'>4.1. S</span>OME <span
style='font-size:18.0pt;line-height:112%'>B</span>ORING <span style='font-size:
18.0pt;line-height:112%'>S</span>TUFF <span style='font-size:18.0pt;line-height:
112%'>Y</span>OU <span style='font-size:18.0pt;line-height:112%'>N</span>EED <span
style='font-size:18.0pt;line-height:112%'>T</span>O <span style='font-size:
18.0pt;line-height:112%'>U</span>NDERSTAND <span style='font-size:18.0pt;
line-height:112%'>B</span>EFORE <span style='font-size:18.0pt;line-height:112%'>Y</span>OU
<span style='font-size:18.0pt;line-height:112%'>C</span>AN <span
style='font-size:18.0pt;line-height:112%'>D</span>IVE <span style='font-size:
18.0pt;line-height:112%'>I</span>N</h2>

<p class=MsoNormal style='margin-left:16.4pt;line-height:107%'><span
style='font-size:48.0pt;line-height:107%;font-family:"DejaVu Serif",serif;
color:#888888'>F </span>ew people think about it, but text is incredibly
complicated. Start with the alphabet. The people of</p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.3pt;margin-bottom:19.2pt;
margin-left:16.4pt'><a href="http://en.wikipedia.org/wiki/Bougainville_Province"><span
style='color:black'>Bougainville</span></a><u> </u>have the smallest alphabet
in the world; their <a href="http://en.wikipedia.org/wiki/Rotokas_alphabet"><span
style='color:black'>Rotokas</span></a><u> </u><a
href="http://en.wikipedia.org/wiki/Rotokas_alphabet"><span style='color:black'>alphabet</span></a><u>
</u>is composed of only 12 letters: A, E, G, I, K, O, P, R, S, T, U, and V. On
the other end of the spectrum, languages like Chinese, Japanese, and Korean
have thousands of characters. English, of course, has 26 letters — 52 if you
count uppercase and lowercase separately — plus a handful of <i><span
style='font-size:13.0pt;line-height:154%;font-family:"DejaVu Serif",serif'>!@#$%&amp;
</span></i>punctuation marks.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.8pt;margin-bottom:20.55pt;
margin-left:16.4pt'>When you talk about “text,” you’re probably thinking of
“characters and symbols on my computer screen.” But computers don’t deal in
characters and symbols; they deal in bits and bytes. Every piece of text you’ve
ever seen on a computer screen is actually stored in a particular <i>character
encoding</i>. Very roughly speaking, the character encoding provides a mapping
between the stuff you see on your screen and the stuff your computer actually
stores in memory and on disk. There are many different character encodings,
some optimized for particular languages like Russian or Chinese or English, and
others that can be used for multiple languages.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.3pt;margin-bottom:.25pt;
margin-left:16.4pt'>In reality, it’s more complicated than that. Many
characters are common to multiple encodings, but each encoding may use a
different sequence of bytes to actually store those characters in memory or on
disk. So you can think of the character encoding as a kind of decryption key.
Whenever someone gives you a sequence of bytes — a file, a web page, whatever —
and claims it’s “text,” you need to know what character encoding they used so
you can decode the bytes into characters. If they give you the wrong key or no
key at all, you’re left with the unenviable task of cracking the code yourself.
Chances are you’ll get it wrong, and the result will be gibberish.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.4pt;margin-left:16.4pt'><img width=298 height=1
src="Dive%20Into%20Python%203_files/image033.gif" align=left hspace=12>Surely
you’ve seen web pages like this, with strange question-mark-like characters
where apostrophes should be. That usually means the page author didn’t declare
their character encoding correctly, your browser was left guessing, and the
result was a mix of expected and unexpected characters. In English it’s merely
annoying; in other languages, the result can be completely unreadable.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.55pt;margin-left:16.4pt'>There are character encodings for each major
language in the world. Since each language is different, and memory and disk
space have historically been expensive, each character encoding is optimized
for a particular language. By that, I mean each encoding using the same numbers
(0–255) to represent that language’s characters. For instance, you’re probably
familiar with the <span style='font-size:9.5pt;line-height:154%'>ASCII </span>encoding,
which stores English characters as numbers ranging from 0 to 127. (65 is
capital “A”, 97 is lowercase “a”, <i><span style='font-size:13.0pt;line-height:
154%;font-family:"DejaVu Serif",serif'>&amp;</span></i>c.) English has a very
simple alphabet, so it can be completely expressed in less than 128 numbers.
For those of you who can count in base 2, that’s 7 out of the 8 bits in a byte.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:19.1pt;
margin-left:16.4pt'>Western European languages like French, Spanish, and German
have more letters than English. Or, more precisely, they have letters combined
with various diacritical marks, like the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>ñ </span>character in Spanish.
The most common encoding for these languages is CP-1252, also called
“windows-1252” because it is widely used on Microsoft Windows. The CP-1252
encoding shares characters with <span style='font-size:9.5pt;line-height:154%'>ASCII
</span>in the 0–127 range, but then extends into the 128–255 range for
characters like n-with-a-tilde-over-it (241), u-with-two-dots-over-it (252), <i><span
style='font-size:13.0pt;line-height:154%;font-family:"DejaVu Serif",serif'>&amp;</span></i>c.
It’s still a single-byte encoding, though; the highest possible number, 255,
still fits in one byte.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:20.55pt;
margin-left:16.4pt'>Then there are languages like Chinese, Japanese, and
Korean, which have so many characters that they require multiple-byte character
sets. That is, each “character” is represented by a two-byte number from
0–65535. But different multi-byte encodings still share the same problem as
different single-byte encodings, namely that they each use the same numbers to
mean different things. It’s just that the range of numbers is broader, because
there are many more characters to represent.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:20.6pt;
margin-left:16.4pt'>That was mostly OK in a non-networked world, where “text”
was something you typed yourself and occasionally printed. There wasn’t much
“plain text”. Source code was <span style='font-size:9.5pt;line-height:154%'>ASCII</span>,
and everyone else used word processors, which defined their own (non-text)
formats that tracked character encoding information along with rich styling, <i><span
style='font-size:13.0pt;line-height:154%;font-family:"DejaVu Serif",serif'>&amp;</span></i>c.
People read these documents with the same word processing program as the
original author, so everything worked, more or less.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.75pt;margin-bottom:20.55pt;
margin-left:16.4pt'>Now think about the rise of global networks like email and
the web. Lots of “plain text” flying around the globe, being authored on one
computer, transmitted through a second computer, and received and displayed by
a third computer. Computers can only see numbers, but the numbers could mean
different things. Oh no! What to do? Well, systems had to be designed to carry
encoding information along with every piece of “plain text.” Remember, it’s the
decryption key that maps computer-readable numbers to human-readable
characters. A missing decryption key means garbled text, gibberish, or worse.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:20.55pt;
margin-left:16.4pt'>Now think about trying to store multiple pieces of text in
the same place, like in the same database table that holds all the email you’ve
ever received. You still need to store the character encoding alongside each
piece of text so you can display it properly. Think that’s hard? Try searching
your email database, which means converting between multiple encodings on the
fly. Doesn’t that sound fun?</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:20.6pt;
margin-left:16.4pt'>Now think about the possibility of multilingual documents,
where characters from several languages are next to each other in the same
document. (Hint: programs that tried to do this typically used escape codes to
switch “modes.” Poof, you’re in Russian koi8-r mode, so 241 means <span
style='font-family:"DejaVu Sans",sans-serif'>&#1071;</span>; poof, now you’re
in Mac Greek mode, so 241 means <span style='font-family:"DejaVu Sans",sans-serif'>&#974;</span>.)
And of course you’ll want to search <i>those </i>documents, too.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:45.7pt;
margin-left:16.4pt'>Now cry a lot, because everything you thought you knew
about strings is wrong, and there ain’t no such thing as “plain text.”</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:3.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h2 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>4.2.
U</span>NICODE</h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:20.75pt;
margin-left:16.4pt;line-height:160%'><i>Enter Unicode.</i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:20.6pt;
margin-left:16.4pt'>Unicode is a system designed to represent <i>every </i>character
from <i>every </i>language. Unicode represents each letter, character, or
ideograph as a 4-byte number. Each number represents a unique character used in
at least one of the world’s languages. (Not all the numbers are used, but more
than 65535 of them are, so 2 bytes wouldn’t be sufficient.) Characters that are
used in multiple languages generally have the same number, unless there is a
good etymological reason not to. Regardless, there is exactly 1 number per
character, and exactly 1 character per number. Every number always means just
one thing; there are no “modes” to keep track of. <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>U+0041 </span>is always <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>'A'</span>,
even if your language doesn’t have an <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>'A' </span>in it.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:20.55pt;
margin-left:16.4pt'>On the face of it, this seems like a great idea. One
encoding to rule them all. Multiple languages per document. No more “mode
switching” to switch between encodings mid-stream. But right away, the obvious
question should leap out at you. Four bytes? For every single character<span
style='font-family:"Calibri",sans-serif'>&#8253; </span>That seems awfully
wasteful, especially for languages like English and Spanish, which need less
than one byte (256 numbers) to express every possible character. In fact, it’s
wasteful even for ideograph-based languages (like Chinese), which never need
more than two bytes per character.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.3pt;margin-bottom:20.55pt;
margin-left:16.4pt'>There is a Unicode encoding that uses four bytes per
character. It’s called UTF-32, because 32 bits = 4 bytes. UTF-32 is a
straightforward encoding; it takes each Unicode character (a 4-byte number) and
represents the character with that same number. This has some advantages, the
most important being that you can find the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>Nth </span>character of a
string in constant time, because the <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>Nth </span>character starts at the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>4×Nth </span>byte.
It also has several disadvantages, the most obvious being that it takes four
freaking bytes to store every freaking character.</p>

<p class=MsoNormal style='margin-left:16.4pt'>Even though there are a lot of
Unicode characters, it turns out that most people will never use anything
beyond the first 65535. Thus, there is another Unicode encoding, called UTF-16
(because 16 bits = 2 bytes). UTF-16 encodes every character from 0–65535 as two
bytes, then uses some dirty hacks if you actually need to represent the
rarely-used “astral plane” Unicode characters beyond 65535. Most obvious
advantage: UTF-16 is twice as space-efficient as UTF-32, because every
character requires only two bytes to store instead of four bytes (except for
the ones that don’t). And you can still easily find the <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>Nth </span>character of
a string in constant time, if you assume that the string doesn’t include any
astral plane characters, which is a good assumption right up until the moment
that it’s not.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.25pt;margin-bottom:20.55pt;
margin-left:16.4pt'>But there are also non-obvious disadvantages to both UTF-32
and UTF-16. Different computer systems store individual bytes in different
ways. That means that the character <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>U+4E2D </span>could be stored in UTF-16 as
either <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>4E
2D </span>or <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>2D
4E</span>, depending on whether the system is big-endian or little-endian. (For
UTF-32, there are even more possible byte orderings.) As long as your documents
never leave your computer, you’re safe — different applications on the same
computer will all use the same byte order. But the minute you want to transfer
documents between systems, perhaps on a world wide web of some sort, you’re
going to need a way to indicate which order your bytes are stored. Otherwise,
the receiving system has no way of knowing whether the two-byte sequence <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>4E 2D </span>means
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>U+4E2D
</span>or <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>U+2D4E</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.3pt;margin-bottom:20.65pt;
margin-left:16.4pt'>To solve <i>this </i>problem, the multi-byte Unicode
encodings define a “Byte Order Mark,” which is a special nonprintable character
that you can include at the beginning of your document to indicate what order
your bytes are in. For UTF-16, the Byte Order Mark is <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>U+FEFF</span>. If you
receive a UTF-16 document that starts with the bytes <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>FF FE</span>, you know
the byte ordering is one way; if it starts with <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>FE FF</span>, you know the byte
ordering is reversed.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:11.85pt;margin-bottom:
167.6pt;margin-left:16.4pt;line-height:176%'>Still, UTF-16 isn’t exactly ideal,
especially if you’re dealing with a lot of <span style='font-size:9.5pt;
line-height:176%'>ASCII </span>characters. If you think about it, even a
Chinese web page is going to contain a lot of <span style='font-size:9.5pt;
line-height:176%'>ASCII </span>characters — all the elements and attributes
surrounding the printable Chinese characters. Being able to find the <span
style='font-size:10.0pt;line-height:176%;font-family:"Liberation Mono"'>Nth </span>character
in constant time is nice, but there’s still the nagging problem of those astral
plane characters, which mean that you can’t <i>guarantee </i>that every
character is exactly two bytes, so you can’t <i>really </i>find the <span
style='font-size:10.0pt;line-height:176%;font-family:"Liberation Mono"'>Nth </span>character
in constant time unless you maintain a separate index. And boy, there sure is a
lot of <span style='font-size:9.5pt;line-height:176%'>ASCII </span>text in the
world… Other people pondered these questions, and they came up with a solution:</p>

<h1 style='margin-left:110.75pt;text-indent:0in'><span style='font-size:120.0pt;
line-height:107%;font-family:"Gill Sans MT",sans-serif'>UTF-8</span></h1>

<p class=MsoNormal style='margin-top:0in;margin-right:1.2pt;margin-bottom:20.7pt;
margin-left:16.4pt'>UTF-8 is a <i>variable-length </i>encoding system for
Unicode. That is, different characters take up a different number of bytes. For
<span style='font-size:9.5pt;line-height:154%'>ASCII </span>characters (A-Z, <i><span
style='font-size:13.0pt;line-height:154%;font-family:"DejaVu Serif",serif'>&amp;</span></i>c.)
<span style='font-size:9.5pt;line-height:154%'>UTF</span>-8 uses just one byte
per character. In fact, it uses the exact same bytes; the first 128 characters
(0–127) in <span style='font-size:9.5pt;line-height:154%'>UTF</span>-8 are
indistinguishable from <span style='font-size:9.5pt;line-height:154%'>ASCII</span>.
“Extended Latin” characters like ñ and ö end up taking two bytes. (The bytes
are not simply the Unicode code point like they would be in UTF-16; there is
some serious bit-twiddling involved.) Chinese characters like <span
style='font-family:"Calibri",sans-serif'>&#20013; </span>end up taking three
bytes. The rarely-used “astral plane” characters take four bytes.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:20.7pt;
margin-left:16.4pt'>Disadvantages: because each character can take a different
number of bytes, finding the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>Nth </span>character is an O(N) operation — that
is, the longer the string, the longer it takes to find a specific character.
Also, there is bit-twiddling involved to encode characters into bytes and
decode bytes into characters.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.35pt;margin-bottom:45.7pt;
margin-left:16.4pt'>Advantages: super-efficient encoding of common <span
style='font-size:9.5pt;line-height:154%'>ASCII </span>characters. No worse than
UTF-16 for extended Latin characters. Better than UTF-32 for Chinese
characters. Also (and you’ll have to trust me on this, because I’m not going to
show you the math), due to the exact nature of the bit twiddling, there are no byteordering
issues. A document encoded in <span style='font-size:9.5pt;line-height:154%'>UTF</span>-8
uses the exact same stream of bytes on any computer.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:3.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h2 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>4.3.
D</span>IVING <span style='font-size:18.0pt;line-height:112%'>I</span>N</h2>

<p class=MsoNormal style='margin-left:16.4pt'>In Python 3, all strings are
sequences of Unicode characters. There is no such thing as a Python string
encoded in <span style='font-size:9.5pt;line-height:154%'>UTF</span>-8, or a
Python string encoded as CP-1252. “Is this string <span style='font-size:9.5pt;
line-height:154%'>UTF</span>-8?” is an invalid question. <span
style='font-size:9.5pt;line-height:154%'>UTF</span>-8 is a way of encoding
characters as a sequence of bytes. If you want to take a string and turn it
into a sequence of bytes in a particular character encoding, Python 3 can help
you with that. If you want to take a sequence of bytes and turn it into a string,
Python 3 can help you with that too. Bytes are not characters; bytes are bytes.
Characters are an abstraction. A string is a sequence of those abstractions.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.75pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>s = '</span><span style='font-size:10.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>&#28145;&#20837;</span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>
Python'    </span><span style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>len(s)               </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>9</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.35pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>s[0]                 </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.15pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'</span><span style='font-size:10.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>&#28145;</span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.5pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>s + ' 3'             </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:30.5pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'</span><span style='font-size:10.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>&#28145;&#20837;</span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'> Python
3'</span></p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>To create a
string, enclose it in quotes. Python strings can be defined with either single
quotes (<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>'</span>)
or double quotes (<span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>&quot;</span>).</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The built-in <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>len() </span>function
returns the length of the string, <i>i.e. </i>the number of characters. This is
the same function you use to <u>find the length of a list, tuple, set, or
dictionary</u>. A string is like a tuple of characters.</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Just like
getting individual items out of a list, you can get individual characters out
of a string using index notation.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:46.65pt;
margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Just like lists, you can concatenate strings using the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>+ </span>operator.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:3.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:18.4pt;margin-left:
16.4pt'><span style='font-size:18.0pt;line-height:112%'>4.4. F</span>ORMATTING <span
style='font-size:18.0pt;line-height:112%'>S</span>TRINGS</h2>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
9.3pt;margin-left:16.4pt;line-height:107%'>Let’s take another look at <u><span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>humansize.py</span></u>:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:345.15pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=298 height=226 src="Dive%20Into%20Python%203_files/image039.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:345.15pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=298 height=394 src="Dive%20Into%20Python%203_files/image040.gif"></span><br
clear=all style='page-break-before:always'>
</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>SUFFIXES
= {1000: ['KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB'],         </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:110.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>1024: ['KiB', 'MiB', 'GiB', 'TiB', 'PiB',
'EiB', 'ZiB', 'YiB']}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def approximate_size(size,
a_kilobyte_is_1024_bytes=True):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:26.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                            </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>'''Convert
a file size to human-readable form.                          </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>Keyword arguments:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>size -- file size in bytes</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>a_kilobyte_is_1024_bytes -- if True
(default), use multiples of 1024</span></p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:81.45pt;
margin-bottom:29.5pt;margin-left:159.7pt;text-align:center;line-height:110%'><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>if
False, use multiples of 1000</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:32.75pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>Returns: string</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.75pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                            </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>'''                                                                     </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>if size &lt; 0:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:26.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                                      </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>raise
ValueError('number must be non-negative')                     </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:170.45pt;margin-bottom:
0in;margin-left:62.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>multiple = 1024 if
a_kilobyte_is_1024_bytes else 1000 for suffix in SUFFIXES[multiple]:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:368.45pt;margin-bottom:
4.2pt;margin-left:86.7pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>size /= multiple if size &lt;
multiple:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:26.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                                                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>return
'{0:.1f} {1}'.format(size, suffix)                       </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9316;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:32.1pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>raise ValueError('number too large')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>'KB'</span>,
<span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>'MB'</span>,
<span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>'GB'</span>…
those are each strings.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Function docstrings are strings. This docstring spans multiple lines, so
it uses three-in-a-row quotes to start and end the string.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>These
three-in-a-row quotes end the docstring.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>There’s another
string, being passed to the exception as a human-readable error message.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.45pt;margin-left:16.65pt;text-indent:-16.65pt'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>There’s a… whoa, what the heck is that?</p>

<p class=MsoNormal style='margin-left:16.4pt'>Python 3 supports formatting
values into strings. Although this can include very complicated expressions,
the most basic usage is to insert a value into a string with a single
placeholder.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>username
= 'mark'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.9pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>password = 'PapayaWhip'                             </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>&quot;{0}'s
password is {1}&quot;.format(username, password) </span><span style='font-family:
"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.9pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&quot;mark's password is PapayaWhip&quot;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:15.25pt;margin-bottom:
7.55pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>No, my password
is not really <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>PapayaWhip</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:15.25pt;margin-bottom:
22.1pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>There’s a lot going on here. First, that’s a method call on a string
literal. <i>Strings are objects</i>, and objects have methods. Second, the
whole expression evaluates to a string. Third, <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>{0} </span>and <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>{1} </span>are
<i>replacement fields</i>, which are replaced by the arguments passed to the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>format()
</span>method.</p>

<h3 style='margin-top:0in;margin-right:0in;margin-bottom:25.25pt;margin-left:
16.4pt;line-height:110%'><span style='font-size:13.0pt;line-height:110%'>4.4.1.
C</span><span style='font-size:10.5pt;line-height:110%'>OMPOUND </span><span
style='font-size:13.0pt;line-height:110%'>F</span><span style='font-size:10.5pt;
line-height:110%'>IELD </span><span style='font-size:13.0pt;line-height:110%'>N</span><span
style='font-size:10.5pt;line-height:110%'>AMES</span></h3>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:19.0pt;
margin-left:16.4pt'>The previous example shows the simplest case, where the
replacement fields are simply integers. Integer replacement fields are treated
as positional indices into the argument list of the <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>format() </span>method.
That means that <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>{0} </span>is replaced by the first argument (<span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>username
</span>in this case), <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>{1} </span>is replaced by the second argument (<span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>password</span>),
<i><span style='font-size:13.0pt;line-height:154%;font-family:"DejaVu Serif",serif'>&amp;</span></i>c.
You can have as many positional indices as you have arguments, and you can have
as many arguments as you want. But replacement fields are much more powerful
than that.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>import
humansize</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>si_suffixes = humansize.SUFFIXES[1000]      </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>si_suffixes</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>['KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB',
'YB']</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>'1000{0[0]}
= 1{0[1]}'.format(si_suffixes) </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.35pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'1000KB = 1MB'</span></p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Rather than
calling any function in the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>humansize </span>module, you’re just grabbing
one of the data structures it defines: the list of “SI” (powers-of-1000)
suffixes.</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>This looks
complicated, but it’s not. <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>{0} </span>would refer to the first argument
passed to the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>format()
</span>method, <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>si_suffixes</span>.
But <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>si_suffixes
</span>is a list. So <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>{0[0]} </span>refers to the first item of the list which is
the first argument passed to the <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>format() </span>method: <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>'KB'</span>.
Meanwhile, <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>{0[1]}
</span>refers to the second item of the same list: <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>'MB'</span>. Everything outside
the curly braces — including <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>1000</span>, the equals sign, and the spaces —
is untouched. The final result is the string <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>'1000KB = 1MB'</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:20.75pt;
margin-left:16.4pt;line-height:160%'><img width=298 height=1
src="Dive%20Into%20Python%203_files/image033.gif" align=left hspace=12>What
this example shows is that <i>format specifiers can access items and properties
of data structures using (almost) Python syntax</i>. This is called <i>compound
field names</i>. The following compound field names “just work”:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.0pt;
margin-left:16.65pt;text-indent:-12.25pt;line-height:107%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Passing a list,
and accessing an item of the list by index</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.0pt;
margin-left:16.4pt;line-height:107%'>(as in the previous example)</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-12.25pt'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Passing a
dictionary, and accessing a value of the dictionary by key</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-12.25pt'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Passing a
module, and accessing its variables and functions by name</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-12.25pt'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Passing a class
instance, and accessing its properties and methods by name</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:20.75pt;
margin-left:16.65pt;text-indent:-12.25pt;line-height:160%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><i>Any
combination of the above</i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.05pt;margin-left:16.4pt'>Just to blow your mind, here’s an example that
combines all of the above:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>import
humansize</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:70.0pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>import
sys</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:98.45pt;margin-bottom:
22.55pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>'1MB =
1000{0.modules[humansize].SUFFIXES[1000][0]}'.format(sys) '1MB = 1000KB'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.55pt;margin-left:16.4pt'>Here’s how it works:</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-12.25pt'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>sys </span>module
holds information about the currently running Python instance. Since you just
imported it, you can pass the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>sys </span>module itself as an argument to the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>format()
</span>method. So the replacement field <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>{0} </span>refers to the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>sys </span>module.</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-12.25pt'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>sys.modules
</span>is a dictionary of all the modules that have been imported in this
Python instance. The keys are the module names as strings; the values are the
module objects themselves. So the replacement field <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>{0.modules} </span>refers
to the dictionary of imported modules.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:7.05pt;
margin-left:16.65pt;text-indent:-12.25pt;line-height:107%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>sys.modules['humansize']
</span>is the <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>humansize
</span>module which you just imported. The replacement field</p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.3pt;margin-bottom:.25pt;
margin-left:16.4pt'><span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>{0.modules[humansize]} </span>refers to the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>humansize
</span>module. Note the slight difference in syntax here. In real Python code,
the keys of the <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>sys.modules </span>dictionary are strings; to refer to them,
you need to put quotes around the module name (<i>e.g. </i><span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>'humansize'</span>).
But within a replacement field, you skip the quotes around the dictionary key
name (<i>e.g. </i><span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>humansize</span>). To quote <a
href="http://www.python.org/dev/peps/pep-3101/"><span style='color:black'>PEP</span></a><u>
</u><a href="http://www.python.org/dev/peps/pep-3101/"><span style='color:black'>3101:</span></a><u>
</u><a href="http://www.python.org/dev/peps/pep-3101/"><span style='color:black'>Advanced</span></a><u>
</u><a href="http://www.python.org/dev/peps/pep-3101/"><span style='color:black'>String</span></a><u>
</u><a href="http://www.python.org/dev/peps/pep-3101/"><span style='color:black'>Formatting</span></a>,
“The rules for parsing an item key are very simple. If it starts with a digit,
then it is treated as a number, otherwise it is used as a string.”</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:1.7pt;
margin-left:16.65pt;text-indent:-12.25pt'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span><span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>sys.modules['humansize'].SUFFIXES
</span>is the dictionary defined at the top of the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>humansize </span>module. The
replacement field <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>{0.modules[humansize].SUFFIXES} </span>refers to that
dictionary.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:16.65pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>sys.modules['humansize'].SUFFIXES[1000]
</span>is a list of <span style='font-size:9.5pt;line-height:110%'>SI </span>suffixes:
<span style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>['KB',
'MB', 'GB', 'TB', 'PB',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:17.15pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'EB', 'ZB', 'YB']</span>. So the
replacement field <span style='font-size:10.0pt;line-height:110%;font-family:
"Liberation Mono"'>{0.modules[humansize].SUFFIXES[1000]} </span>refers to that
list.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:22.05pt;
margin-left:16.65pt;text-indent:-12.25pt'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span><span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>sys.modules['humansize'].SUFFIXES[1000][0]
</span>is the first item of the list of <span style='font-size:9.5pt;
line-height:154%'>SI </span>suffixes: <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>'KB'</span>. Therefore, the complete
replacement field <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>{0.modules[humansize].SUFFIXES[1000][0]} </span>is replaced
by the twocharacter string <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>KB</span>.</p>

<h3 style='margin-top:0in;margin-right:0in;margin-bottom:25.25pt;margin-left:
16.4pt;line-height:110%'><span style='font-size:13.0pt;line-height:110%'>4.4.2.
F</span><span style='font-size:10.5pt;line-height:110%'>ORMAT </span><span
style='font-size:13.0pt;line-height:110%'>S</span><span style='font-size:10.5pt;
line-height:110%'>PECIFIERS</span></h3>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.95pt;margin-left:16.4pt'>But wait! There’s more! Let’s take another look at
that strange line of code from <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>humansize.py</span>:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>if size &lt; multiple:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.7pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>return '{0:.1f} {1}'.format(size, suffix)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.6pt;margin-bottom:46.7pt;
margin-left:16.4pt'><span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>{1} </span>is replaced with the second argument passed to
the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>format()
</span>method, which is <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>suffix</span>. But what is <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>{0:.1f}</span>?
It’s two things: <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>{0}</span>, which you recognize, and <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>:.1f</span>, which you
don’t. The second half (including and after the colon) defines the <i>format
specifier</i>, which further refines how the replaced variable should be
formatted.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:61.1pt;margin-bottom:
2.05pt;margin-left:75.95pt;text-indent:-29.3pt'><span style='font-size:24.0pt;
line-height:154%;font-family:"Calibri",sans-serif'>&#9758; </span>Format
specifiers allow you to munge the replacement text in a variety of useful ways,
like the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>printf()
</span>function in C. You can add zero- or space-padding, align strings,
control decimal precision, and even convert numbers to hexadecimal.</p>

<p class=MsoNormal style='margin-left:16.4pt'>Within a replacement field, a
colon (<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>:</span>)
marks the start of the format specifier. The format specifier “<span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>.1</span>”
means “round to the nearest tenth” (<i>i.e. </i>display only one digit after
the decimal point). The format specifier “<span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>f</span>” means “fixed-point
number” (as opposed to exponential notation or some other decimal
representation).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.05pt;margin-left:16.4pt'>Thus, given a <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>size </span>of <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>698.24 </span>and
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>suffix
</span>of <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>'GB'</span>,
the formatted string would be <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>'698.2 GB'</span>, because <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>698.24 </span>gets
rounded to one decimal place, then the suffix is appended after the number.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>'{0:.1f}
{1}'.format(698.24, 'GB')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'698.2 GB'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:45.7pt;
margin-left:16.4pt'>For all the gory details on format specifiers, consult the <a
href="http://docs.python.org/3.1/library/string.html#format-specification-mini-language"><span
style='color:black'>Format</span></a><u> </u><a
href="http://docs.python.org/3.1/library/string.html#format-specification-mini-language"><span
style='color:black'>Specification</span></a><u> </u><a
href="http://docs.python.org/3.1/library/string.html#format-specification-mini-language"><span
style='color:black'>Mini-Language</span></a><u> </u>in the official Python
documentation.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:3.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h2 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>4.5.
O</span>THER <span style='font-size:18.0pt;line-height:112%'>C</span>OMMON <span
style='font-size:18.0pt;line-height:112%'>S</span>TRING <span style='font-size:
18.0pt;line-height:112%'>M</span>ETHODS</h2>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>Besides formatting, strings can do a
number of other useful tricks.</p>

</div>

<span style='font-size:12.0pt;line-height:154%;font-family:"Gill Sans MT",sans-serif;
color:black'><br clear=all style='page-break-before:always'>
</span>

<div class=WordSection10>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>s = '''Finished files are the re- </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>... </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>sult of
years of scientif-</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>... </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>ic
study combined with the</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.55pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>... </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>experience
of years.'''</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>s.splitlines()                     </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>['Finished files are the re-',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'sult of years of scientif-',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.95in;margin-bottom:
4.05pt;margin-left:44.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>'ic study combined with the',
'experience of years.']</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>print(s.lower())                   </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:362.4pt;margin-bottom:
4.1pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>finished files are the result
of years of scientific study combined with the experience of years.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>s.lower().count('f')               </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>6</span></p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>You can input
multiline strings in the Python interactive shell. Once you start a multiline
string with triple quotation marks, just hit <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>ENTER </span>and the
interactive shell will prompt you to continue the string. Typing the closing
triple quotation marks ends the string, and the next <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>ENTER </span>will
execute the command (in this case, assigning the string to <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>s</span>).</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>splitlines()
</span>method takes one multiline string and returns a list of strings, one for
each line of the original. Note that the carriage returns at the end of each
line are not included.</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>lower()
</span>method converts the entire string to lowercase. (Similarly, the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>upper()
</span>method converts a string to uppercase.)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:20.4pt;
margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>count()
</span>method counts the number of occurrences of a substring. Yes, there
really are six “f”s in that sentence!</p>

<p class=MsoNormal style='margin-top:0in;margin-right:36.8pt;margin-bottom:
.15pt;margin-left:16.65pt;text-align:justify;text-justify:inter-ideograph;
text-indent:0in;line-height:155%'>Here’s another common case. Let’s say you
have a list of key-value pairs in the form <span style='font-size:10.0pt;
line-height:155%;font-family:"Liberation Mono"'>key1=value1&amp;key2=value2</span>,
and you want to split them up and make a dictionary of the form <span
style='font-size:10.0pt;line-height:155%;font-family:"Liberation Mono"'>{key1:
value1, key2: value2}</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.7in;margin-bottom:0in;
margin-left:62.65pt;line-height:180%'><span style='font-size:10.0pt;line-height:
180%;font-family:"Liberation Mono"'>query =
'user=pilgrim&amp;database=master&amp;password=PapayaWhip' a_list =
query.split('&amp;')  </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>a_list</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>['user=pilgrim', 'database=master',
'password=PapayaWhip']</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>a_list_of_lists
= [v.split('=', 1) for v in a_list] </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>a_list_of_lists</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>[['user', 'pilgrim'], ['database',
'master'], ['password', 'PapayaWhip']]</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>a_dict = dict(a_list_of_lists)                       </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>a_dict</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.3pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>{'password': 'PapayaWhip', 'user':
'pilgrim', 'database': 'master'}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.8pt;margin-bottom:.25pt;
margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>split()
</span>string method has one required argument, a delimiter. The method splits
a string into a list of strings based on the delimiter. Here, the delimiter is
an ampersand character, but it could be anything.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.8pt;margin-bottom:.15pt;
margin-left:16.65pt;text-indent:-16.65pt;line-height:155%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Now we have a
list of strings, each with a key, followed by an equals sign, followed by a
value. We can use a <u>list comprehension </u>to iterate over the entire list
and split each string into two strings based on the first equals sign. The
optional second argument to the <span style='font-size:10.0pt;line-height:155%;
font-family:"Liberation Mono"'>split() </span>method is the number of times you
want to split. <span style='font-size:10.0pt;line-height:155%;font-family:"Liberation Mono"'>1
</span>means “only split once,” so the <span style='font-size:10.0pt;
line-height:155%;font-family:"Liberation Mono"'>split() </span>method will
return a two-item list. (In theory, a value could contain an equals sign too.
If you just used <span style='font-size:10.0pt;line-height:155%;font-family:
"Liberation Mono"'>'key=value=foo'.split('=')</span>, you would end up with a
threeitem list <span style='font-size:10.0pt;line-height:155%;font-family:"Liberation Mono"'>['key',
'value', 'foo']</span>.)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.8pt;margin-bottom:47.95pt;
margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Finally, Python can turn that list-of-lists into a dictionary simply by
passing it to the <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>dict() </span>function.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:40.5pt;margin-bottom:
42.55pt;margin-left:75.95pt;text-indent:-29.3pt'><span style='font-size:24.0pt;
line-height:154%;font-family:"Calibri",sans-serif'>&#9758; </span>The previous
example looks a lot like parsing query parameters in a <span style='font-size:
9.5pt;line-height:154%'>URL</span>, but real-life <span style='font-size:9.5pt;
line-height:154%'>URL </span>parsing is actually more complicated than this. If
you’re dealing with <span style='font-size:9.5pt;line-height:154%'>URL </span>query
parameters, you’re better off using the <a
href="http://docs.python.org/3.1/library/urllib.parse.html#urllib.parse.parse_qs"><span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono";
color:black'>urllib.parse.parse_qs()</span></a><u><span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'> </span></u>function, which
handles some non-obvious edge cases.</p>

<h3 style='margin-top:0in;margin-right:0in;margin-bottom:25.25pt;margin-left:
16.4pt;line-height:110%'><span style='font-size:13.0pt;line-height:110%'>4.5.1.
S</span><span style='font-size:10.5pt;line-height:110%'>LICING </span><span
style='font-size:13.0pt;line-height:110%'>A S</span><span style='font-size:
10.5pt;line-height:110%'>TRING</span></h3>

<p class=MsoNormal style='margin-left:16.4pt'>Once you’ve defined a string, you
can get any part of it as a new string. This is called <i>slicing </i>the
string. Slicing strings works exactly the same as <u>slicing lists</u>, which
makes sense, because strings are just sequences of characters.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:80.4pt;margin-bottom:
0in;margin-left:62.65pt;line-height:178%'><span style='font-size:10.0pt;
line-height:178%;font-family:"Liberation Mono"'>a_string = 'My alphabet starts
where your alphabet ends.' a_string[3:11]      </span><span style='font-family:
"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.55pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'alphabet'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>a_string[3:-3]           </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'alphabet starts where your alphabet en'</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=246
 style='width:184.8pt;margin-left:38.15pt;border-collapse:collapse'>
 <tr style='height:39.3pt'>
  <td width=232 valign=top style='width:174.05pt;padding:0in 0in 0in 0in;
  height:39.3pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>a_string[0:2]</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>'My'</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:39.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9314;</span></p>
  </td>
 </tr>
 <tr style='height:43.5pt'>
  <td width=232 valign=top style='width:174.05pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>a_string[:18]</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>'My
  alphabet starts'</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9315;</span></p>
  </td>
 </tr>
 <tr style='height:18.3pt'>
  <td width=232 valign=bottom style='width:174.05pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono";
  color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
  107%;font-family:"Liberation Mono"'>a_string[18:]</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9316;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>' where your alphabet ends.'</span></p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>You can get a
part of a string, called a “slice”, by specifying two indices. The return value
is a new string containing all the characters of the string, in order, starting
with the first slice index.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.8pt;
margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Like slicing
lists, you can use negative indices to slice strings.</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Strings are
zero-based, so <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>a_string[0:2]
</span>returns the first two items of the string, starting at <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>a_string[0]</span>,
up to but not including <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>a_string[2]</span>.</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>If the left
slice index is 0, you can leave it out, and 0 is implied. So <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>a_string[:18]
</span>is the same as <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>a_string[0:18]</span>, because the starting 0 is
implied.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:45.6pt;
margin-left:16.65pt;text-indent:-16.65pt'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Similarly, if the right slice index is the length of the string, you can
leave it out. So <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>a_string[18:] </span>is the same as <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>a_string[18:44]</span>,
because this string has 44 characters. There is a pleasing symmetry here. In
this 44-character string, <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>a_string[:18] </span>returns the first 18
characters, and <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>a_string[18:] </span>returns everything but the first 18
characters. In fact, <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>a_string[:n] </span>will always return the first <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>n </span>characters,
and <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>a_string[n:]
</span>will return the rest, regardless of the length of the string.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:3.35pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h2 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>4.6.
S</span>TRINGS VS<span style='font-size:18.0pt;line-height:112%'>. B</span>YTES</h2>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>Bytes are bytes; characters are an abstraction. An
immutable sequence of Unicode characters is called a <i>string</i>. An
immutable sequence of numbers-between-0-and-255 is called a <i>bytes </i>object.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=190
 style='width:142.75pt;margin-left:38.15pt;border-collapse:collapse'>
 <tr style='height:60.3pt'>
  <td width=176 valign=top style='width:132.0pt;padding:0in 0in 0in 0in;
  height:60.3pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
  margin-left:24.0pt;text-indent:0in;line-height:185%'><span style='font-size:
  10.0pt;line-height:185%;font-family:"Liberation Mono"'>by = b'abcd\x65' by</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>b'abcde'</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:60.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9312;</span></p>
  </td>
 </tr>
 <tr style='height:43.5pt'>
  <td width=176 valign=top style='width:132.0pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>type(by)</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>&lt;class
  'bytes'&gt;</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9313;</span></p>
  </td>
 </tr>
 <tr style='height:43.5pt'>
  <td width=176 valign=top style='width:132.0pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>len(by)</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>5</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9314;</span></p>
  </td>
 </tr>
 <tr style='height:64.5pt'>
  <td width=176 valign=top style='width:132.0pt;padding:0in 0in 0in 0in;
  height:64.5pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>by
  += b'\xff'</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:24.0pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>by
  b'abcde\xff'</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:64.5pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9315;</span></p>
  </td>
 </tr>
 <tr style='height:43.5pt'>
  <td width=176 valign=top style='width:132.0pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>len(by)</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>6</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9316;</span></p>
  </td>
 </tr>
 <tr style='height:43.5pt'>
  <td width=176 valign=top style='width:132.0pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>by[0]</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>97</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9317;</span></p>
  </td>
 </tr>
 <tr style='height:18.3pt'>
  <td width=176 valign=bottom style='width:132.0pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono";
  color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
  107%;font-family:"Liberation Mono"'>by[0] = 102</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9318;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>Traceback (most
recent call last):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>File
&quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
31.45pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>TypeError:
'bytes' object does not support item assignment</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>To define a <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>bytes </span>object, use the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>b'' </span>“byte literal”
syntax. Each byte within the byte literal can be an <span style='font-size:
9.5pt;line-height:154%'>ASCII </span>character or an encoded hexadecimal number
from <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>\x00
</span>to <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>\xff
</span>(0–255).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.4pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The type of a <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>bytes </span>object
is <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>bytes</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.25pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Just like lists
and strings, you can get the length of a <span style='font-size:10.0pt;
line-height:107%;font-family:"Liberation Mono"'>bytes </span>object with the
built-in <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>len()
</span>function.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Just like lists and strings, you can use the <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>+ </span>operator to
concatenate <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>bytes
</span>objects. The result is a new <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>bytes </span>object.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.2pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>5.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Concatenating a
5-byte <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>bytes
</span>object and a 1-byte <span style='font-size:10.0pt;line-height:107%;
font-family:"Liberation Mono"'>bytes </span>object gives you a 6-byte <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>bytes </span>object.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>6.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Just like lists and strings, you can use index notation to get
individual bytes in a <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>bytes </span>object. The items of a string are
strings; the items of a <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>bytes </span>object are integers. Specifically,
integers between 0–255.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>7.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>A <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>bytes
</span>object is immutable; you can not assign individual bytes. If you need to
change individual bytes, you can either use <u>string slicing </u>and
concatenation operators (which work the same as strings), or you can convert
the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>bytes
</span>object into a <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>bytearray </span>object.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:5.05in;margin-bottom:
0in;margin-left:62.65pt;line-height:179%'><span style='font-size:10.0pt;
line-height:179%;font-family:"Liberation Mono"'>by = b'abcd\x65' barr =
bytearray(by) </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:368.4pt;margin-bottom:
3.95pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>barr
bytearray(b'abcde')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>len(barr)             </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.55pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>5</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>barr[0] = 102         </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:368.4pt;margin-bottom:
23.45pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>barr
bytearray(b'fbcde')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.5pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>To convert a <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>bytes </span>object
into a mutable <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>bytearray
</span>object, use the built-in <span style='font-size:10.0pt;line-height:107%;
font-family:"Liberation Mono"'>bytearray() </span>function.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.35pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>All the methods
and operations you can do on a <span style='font-size:10.0pt;line-height:107%;
font-family:"Liberation Mono"'>bytes </span>object, you can do on a <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>bytearray
</span>object too.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.05pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The one
difference is that, with the <span style='font-size:10.0pt;line-height:107%;
font-family:"Liberation Mono"'>bytearray </span>object, you can assign
individual bytes using index notation.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.45pt;margin-left:16.4pt'>The assigned value must be an integer between
0–255.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.9pt;margin-left:16.4pt'>The one thing you <i>can never do </i>is mix bytes
and strings.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>by =
b'd'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.35pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>s =
'abcde'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>by + s                       </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>Traceback (most
recent call last):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>File
&quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
12.5pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>TypeError: can't
concat bytes to str</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>s.count(by)                  </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>Traceback (most
recent call last):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:188.4pt;margin-bottom:
4.15pt;margin-left:37.4pt;text-indent:12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
color:#880000'>File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;
TypeError: Can't convert 'bytes' object to str implicitly</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>s.count(by.decode('ascii'))
</span><span style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>1</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.0pt;
margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>You can’t
concatenate bytes and strings. They are two different data types.</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>You can’t count
the occurrences of bytes in a string, because there are no bytes in a string. A
string is a sequence of characters. Perhaps you meant “count the occurrences of
the string that you would get after</p>

</div>

<span style='font-size:12.0pt;line-height:154%;font-family:"Gill Sans MT",sans-serif;
color:black'><br clear=all style='page-break-before:always'>
</span>

<div class=WordSection11>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>decoding this sequence of bytes in a particular
character encoding”? Well then, you’ll need to say that explicitly. Python 3
won’t implicitly convert bytes to strings or strings to bytes.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:21.1pt;
margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>By an amazing coincidence, this line of code says “count the occurrences
of the string that you would get after decoding this sequence of bytes in this
particular character encoding.”</p>

<p class=MsoNormal style='margin-top:0in;margin-right:10.1pt;margin-bottom:
.25pt;margin-left:16.4pt'>And here is the link between strings and bytes: <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>bytes </span>objects
have a <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>decode()
</span>method that takes a character encoding and returns a string, and strings
have an <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>encode()
</span>method that takes a character encoding and returns a <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>bytes </span>object.
In the previous example, the decoding was relatively straightforward —
converting a sequence of bytes in the <span style='font-size:9.5pt;line-height:
154%'>ASCII </span>encoding into a string of characters. But the same process
works with any encoding that supports the characters of the string — even
legacy (nonUnicode) encodings.<br clear=all style='page-break-before:always'>
</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=310
 style='width:232.8pt;margin-left:38.15pt;border-collapse:collapse'>
 <tr style='height:60.3pt'>
  <td width=291 valign=top style='width:218.05pt;padding:0in 0in 0in 0in;
  height:60.3pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.0pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>a_string
  = '</span><span style='font-size:10.0pt;line-height:107%;font-family:"Calibri",sans-serif'>&#28145;&#20837;</span><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>
  Python'</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>len(a_string)</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>9</span></p>
  </td>
  <td width=20 valign=top style='width:14.75pt;padding:0in 0in 0in 0in;
  height:60.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9312;</span></p>
  </td>
 </tr>
 <tr style='height:106.5pt'>
  <td width=291 valign=top style='width:218.05pt;padding:0in 0in 0in 0in;
  height:106.5pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>by
  = a_string.encode('utf-8')</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>by</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>b'\xe6\xb7\xb1\xe5\x85\xa5
  Python'</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>len(by)</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>13</span></p>
  </td>
  <td width=20 valign=top style='width:14.75pt;padding:0in 0in 0in 0in;
  height:106.5pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
  margin-left:4.0pt;text-align:justify;text-justify:inter-ideograph;text-indent:
  0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9313;</span></p>
  </td>
 </tr>
 <tr style='height:106.5pt'>
  <td width=291 valign=top style='width:218.05pt;padding:0in 0in 0in 0in;
  height:106.5pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>by
  = a_string.encode('gb18030')</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>by</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>b'\xc9\xee\xc8\xeb
  Python'</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>len(by)</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>11</span></p>
  </td>
  <td width=20 valign=top style='width:14.75pt;padding:0in 0in 0in 0in;
  height:106.5pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
  margin-left:4.0pt;text-align:justify;text-justify:inter-ideograph;text-indent:
  0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9314;</span></p>
  </td>
 </tr>
 <tr style='height:106.5pt'>
  <td width=291 valign=top style='width:218.05pt;padding:0in 0in 0in 0in;
  height:106.5pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>by
  = a_string.encode('big5')</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>by</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>b'\xb2`\xa4J Python'</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>len(by)</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>11</span></p>
  </td>
  <td width=20 valign=top style='width:14.75pt;padding:0in 0in 0in 0in;
  height:106.5pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
  margin-left:4.0pt;text-align:justify;text-justify:inter-ideograph;text-indent:
  0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9315;</span></p>
  </td>
 </tr>
 <tr style='height:18.3pt'>
  <td width=291 valign=bottom style='width:218.05pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono";
  color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
  107%;font-family:"Liberation Mono"'>roundtrip = by.decode('big5')</span></p>
  </td>
  <td width=20 valign=top style='width:14.75pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
  margin-left:4.0pt;text-align:justify;text-justify:inter-ideograph;text-indent:
  0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9316;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.3pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>roundtrip</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'</span><span style='font-size:10.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>&#28145;&#20837;</span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>
Python'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:356.45pt;margin-bottom:
22.55pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>a_string
== roundtrip True</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.5pt;
margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>This is a
string. It has nine characters.</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>This is a <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>bytes </span>object.
It has 13 bytes. It is the sequence of bytes you get when you take <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>a_string
</span>and encode it in <span style='font-size:9.5pt;line-height:154%'>UTF</span>-8.</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>This is a <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>bytes </span>object.
It has 11 bytes. It is the sequence of bytes you get when you take <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>a_string
</span>and encode it in <a href="http://en.wikipedia.org/wiki/GB_18030"><span
style='color:black'>GB18030</span></a>.</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>This is a <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>bytes </span>object.
It has 11 bytes. It is an <i>entirely different sequence of bytes </i>that you
get when you take <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>a_string </span>and encode it in <a
href="http://en.wikipedia.org/wiki/Big5"><span style='color:black'>Big5</span></a>.</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>5.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>This is a
string. It has nine characters. It is the sequence of characters you get when
you take <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>by
</span>and decode it using the Big5 encoding algorithm. It is identical to the
original string.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:3.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h2 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>4.7.
P</span>OSTSCRIPT<span style='font-size:18.0pt;line-height:112%'>: C</span>HARACTER
<span style='font-size:18.0pt;line-height:112%'>E</span>NCODING <span
style='font-size:18.0pt;line-height:112%'>O</span>F <span style='font-size:
18.0pt;line-height:112%'>P</span>YTHON <span style='font-size:18.0pt;
line-height:112%'>S</span>OURCE <span style='font-size:18.0pt;line-height:112%'>C</span>ODE</h2>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
48.1pt;margin-left:16.4pt'>Python 3 assumes that your source code — <i>i.e. </i>each
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>.py
</span>file — is encoded in <span style='font-size:9.5pt;line-height:154%'>UTF</span>-8.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:37.45pt;margin-bottom:
36.15pt;margin-left:75.95pt;text-indent:-29.3pt;line-height:193%'><span
style='font-size:24.0pt;line-height:193%;font-family:"Calibri",sans-serif'>&#9758;
</span>In Python 2, the default encoding for <span style='font-size:10.0pt;
line-height:193%;font-family:"Liberation Mono"'>.py </span>files was <span
style='font-size:9.5pt;line-height:193%'>ASCII</span>. In Python 3, <a
href="http://www.python.org/dev/peps/pep-3120/"><span style='color:black'>the</span></a><u>
</u><a href="http://www.python.org/dev/peps/pep-3120/"><span style='color:black'>default
</span></a><a href="http://www.python.org/dev/peps/pep-3120/"><span
style='color:black'>encoding</span></a><u> </u><a
href="http://www.python.org/dev/peps/pep-3120/"><span style='color:black'>is</span></a><u>
</u><a href="http://www.python.org/dev/peps/pep-3120/"><span style='font-size:
9.5pt;line-height:193%;color:black'>UTF</span></a><a
href="http://www.python.org/dev/peps/pep-3120/"><span style='color:black'>-8</span></a>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:19.1pt;
margin-left:16.4pt'>If you would like to use a different encoding within your
Python code, you can put an encoding declaration on the first line of each
file. This declaration defines a <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>.py </span>file to be windows-1252:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.2pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'># -*- coding: windows-1252 -*-</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:19.05pt;
margin-left:16.4pt'>Technically, the character encoding override can also be on
the second line, if the first line is a <span style='font-size:9.5pt;
line-height:154%'>UNIX</span>-like hash-bang command.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>#!/usr/bin/python3</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.15pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'># -*- coding: windows-1252 -*-</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:51.8pt;
margin-left:17.15pt;line-height:110%'>For more information, consult <a
href="http://www.python.org/dev/peps/pep-0263/"><span style='font-size:9.5pt;
line-height:110%;color:black'>PEP</span></a><u><span style='font-size:9.5pt;
line-height:110%'> </span></u><a href="http://www.python.org/dev/peps/pep-0263/"><span
style='color:black'>263:</span></a><u> </u><a
href="http://www.python.org/dev/peps/pep-0263/"><span style='color:black'>Defining</span></a><u>
</u><a href="http://www.python.org/dev/peps/pep-0263/"><span style='color:black'>Python</span></a><u>
</u><a href="http://www.python.org/dev/peps/pep-0263/"><span style='color:black'>Source</span></a><u>
</u><a href="http://www.python.org/dev/peps/pep-0263/"><span style='color:black'>Code</span></a><u>
</u><a href="http://www.python.org/dev/peps/pep-0263/"><span style='color:black'>Encodings</span></a>.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:3.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h2 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>4.8.
F</span>URTHER <span style='font-size:18.0pt;line-height:112%'>R</span>EADING</h2>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>On Unicode in Python:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://docs.python.org/3.1/howto/unicode.html"><span style='color:black'>Python</span></a><u>
</u><a href="http://docs.python.org/3.1/howto/unicode.html"><span
style='color:black'>Unicode</span></a><u> </u><a
href="http://docs.python.org/3.1/howto/unicode.html"><span style='color:black'>HOWTO</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://docs.python.org/3.0/whatsnew/3.0.html#text-vs-data-instead-of-unicode-vs-8-bit"><span
style='color:black'>What’s</span></a><u> </u><a
href="http://docs.python.org/3.0/whatsnew/3.0.html#text-vs-data-instead-of-unicode-vs-8-bit"><span
style='color:black'>New</span></a><u> </u><a
href="http://docs.python.org/3.0/whatsnew/3.0.html#text-vs-data-instead-of-unicode-vs-8-bit"><span
style='color:black'>In</span></a><u> </u><a
href="http://docs.python.org/3.0/whatsnew/3.0.html#text-vs-data-instead-of-unicode-vs-8-bit"><span
style='color:black'>Python</span></a><u> </u><a
href="http://docs.python.org/3.0/whatsnew/3.0.html#text-vs-data-instead-of-unicode-vs-8-bit"><span
style='color:black'>3:</span></a><u> </u><a
href="http://docs.python.org/3.0/whatsnew/3.0.html#text-vs-data-instead-of-unicode-vs-8-bit"><span
style='color:black'>Text</span></a><u> </u><a
href="http://docs.python.org/3.0/whatsnew/3.0.html#text-vs-data-instead-of-unicode-vs-8-bit"><span
style='color:black'>vs.</span></a><u> </u><a
href="http://docs.python.org/3.0/whatsnew/3.0.html#text-vs-data-instead-of-unicode-vs-8-bit"><span
style='color:black'>Data</span></a><u> </u><a
href="http://docs.python.org/3.0/whatsnew/3.0.html#text-vs-data-instead-of-unicode-vs-8-bit"><span
style='color:black'>Instead</span></a><u> </u><a
href="http://docs.python.org/3.0/whatsnew/3.0.html#text-vs-data-instead-of-unicode-vs-8-bit"><span
style='color:black'>Of</span></a><u> </u><a
href="http://docs.python.org/3.0/whatsnew/3.0.html#text-vs-data-instead-of-unicode-vs-8-bit"><span
style='color:black'>Unicode</span></a><u> </u><a
href="http://docs.python.org/3.0/whatsnew/3.0.html#text-vs-data-instead-of-unicode-vs-8-bit"><span
style='color:black'>vs.</span></a><u> </u><a
href="http://docs.python.org/3.0/whatsnew/3.0.html#text-vs-data-instead-of-unicode-vs-8-bit"><span
style='color:black'>8-bit</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.5pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:225%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://www.python.org/dev/peps/pep-0261/"><span style='font-size:9.5pt;
line-height:225%;color:black'>PEP</span></a><u><span style='font-size:9.5pt;
line-height:225%'> </span></u><a href="http://www.python.org/dev/peps/pep-0261/"><span
style='color:black'>261</span></a><u> </u>explains how Python handles astral
characters outside of the Basic Multilingual Plane (<i>i.e. </i>characters
whose ordinal value is greater than 65535) On Unicode in general:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://www.joelonsoftware.com/articles/Unicode.html"><span
style='color:black'>The</span></a><u> </u><a
href="http://www.joelonsoftware.com/articles/Unicode.html"><span
style='color:black'>Absolute</span></a><u> </u><a
href="http://www.joelonsoftware.com/articles/Unicode.html"><span
style='color:black'>Minimum</span></a><u> </u><a
href="http://www.joelonsoftware.com/articles/Unicode.html"><span
style='color:black'>Every</span></a><u> </u><a
href="http://www.joelonsoftware.com/articles/Unicode.html"><span
style='color:black'>Software</span></a><u> </u><a
href="http://www.joelonsoftware.com/articles/Unicode.html"><span
style='color:black'>Developer</span></a><u> </u><a
href="http://www.joelonsoftware.com/articles/Unicode.html"><span
style='color:black'>Absolutely,</span></a><u> </u><a
href="http://www.joelonsoftware.com/articles/Unicode.html"><span
style='color:black'>Positively</span></a><u> </u><a
href="http://www.joelonsoftware.com/articles/Unicode.html"><span
style='color:black'>Must</span></a><u> </u><a
href="http://www.joelonsoftware.com/articles/Unicode.html"><span
style='color:black'>Know</span></a><u> </u><a
href="http://www.joelonsoftware.com/articles/Unicode.html"><span
style='color:black'>About</span></a><u> </u><a
href="http://www.joelonsoftware.com/articles/Unicode.html"><span
style='color:black'>Unicode</span></a><u> </u><a
href="http://www.joelonsoftware.com/articles/Unicode.html"><span
style='color:black'>and</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:17.15pt;line-height:110%'><a
href="http://www.joelonsoftware.com/articles/Unicode.html"><span
style='color:black'>Character</span></a><u> </u><a
href="http://www.joelonsoftware.com/articles/Unicode.html"><span
style='color:black'>Sets</span></a><u> </u><a
href="http://www.joelonsoftware.com/articles/Unicode.html"><span
style='color:black'>(No</span></a><u> </u><a
href="http://www.joelonsoftware.com/articles/Unicode.html"><span
style='color:black'>Excuses!)</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://www.tbray.org/ongoing/When/200x/2003/04/06/Unicode"><span
style='color:black'>On</span></a><u> </u><a
href="http://www.tbray.org/ongoing/When/200x/2003/04/06/Unicode"><span
style='color:black'>the</span></a><u> </u><a
href="http://www.tbray.org/ongoing/When/200x/2003/04/06/Unicode"><span
style='color:black'>Goodness</span></a><u> </u><a
href="http://www.tbray.org/ongoing/When/200x/2003/04/06/Unicode"><span
style='color:black'>of</span></a><u> </u><a
href="http://www.tbray.org/ongoing/When/200x/2003/04/06/Unicode"><span
style='color:black'>Unicode</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://www.tbray.org/ongoing/When/200x/2003/04/13/Strings"><span
style='color:black'>On</span></a><u> </u><a
href="http://www.tbray.org/ongoing/When/200x/2003/04/13/Strings"><span
style='color:black'>Character</span></a><u> </u><a
href="http://www.tbray.org/ongoing/When/200x/2003/04/13/Strings"><span
style='color:black'>Strings</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:26.7pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://www.tbray.org/ongoing/When/200x/2003/04/26/UTF"><span
style='color:black'>Characters</span></a><u> </u><a
href="http://www.tbray.org/ongoing/When/200x/2003/04/26/UTF"><span
style='color:black'>vs.</span></a><u> </u><a
href="http://www.tbray.org/ongoing/When/200x/2003/04/26/UTF"><span
style='color:black'>Bytes</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.45pt;margin-left:16.4pt'>On character encoding in other formats:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://feedparser.org/docs/character-encoding.html"><span
style='color:black'>Character</span></a><u> </u><a
href="http://feedparser.org/docs/character-encoding.html"><span
style='color:black'>encoding</span></a><u> </u><a
href="http://feedparser.org/docs/character-encoding.html"><span
style='color:black'>in</span></a><u> </u><a
href="http://feedparser.org/docs/character-encoding.html"><span
style='color:black'>XML</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:26.7pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://blog.whatwg.org/the-road-to-html-5-character-encoding"><span
style='color:black'>Character</span></a><u> </u><a
href="http://blog.whatwg.org/the-road-to-html-5-character-encoding"><span
style='color:black'>encoding</span></a><u> </u><a
href="http://blog.whatwg.org/the-road-to-html-5-character-encoding"><span
style='color:black'>in</span></a><u> </u><a
href="http://blog.whatwg.org/the-road-to-html-5-character-encoding"><span
style='color:black'>HTML</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
22.0pt;margin-left:16.4pt'>On strings and string formatting:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://docs.python.org/3.1/library/string.html"><span style='font-size:
10.0pt;line-height:110%;font-family:"Liberation Mono";color:black'>string</span></a><u><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'> </span></u><a
href="http://docs.python.org/3.1/library/string.html"><span style='color:black'>—</span></a><u>
</u><a href="http://docs.python.org/3.1/library/string.html"><span
style='color:black'>Common</span></a><u> </u><a
href="http://docs.python.org/3.1/library/string.html"><span style='color:black'>string</span></a><u>
</u><a href="http://docs.python.org/3.1/library/string.html"><span
style='color:black'>operations</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://docs.python.org/3.1/library/string.html#formatstrings"><span
style='color:black'>Format</span></a><u> </u><a
href="http://docs.python.org/3.1/library/string.html#formatstrings"><span
style='color:black'>String</span></a><u> </u><a
href="http://docs.python.org/3.1/library/string.html#formatstrings"><span
style='color:black'>Syntax</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://docs.python.org/3.1/library/string.html#format-specification-mini-language"><span
style='color:black'>Format</span></a><u> </u><a
href="http://docs.python.org/3.1/library/string.html#format-specification-mini-language"><span
style='color:black'>Specification</span></a><u> </u><a
href="http://docs.python.org/3.1/library/string.html#format-specification-mini-language"><span
style='color:black'>Mini-Language</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://www.python.org/dev/peps/pep-3101/"><span style='font-size:9.5pt;
line-height:110%;color:black'>PEP</span></a><u><span style='font-size:9.5pt;
line-height:110%'> </span></u><a href="http://www.python.org/dev/peps/pep-3101/"><span
style='color:black'>3101:</span></a><u> </u><a
href="http://www.python.org/dev/peps/pep-3101/"><span style='color:black'>Advanced</span></a><u>
</u><a href="http://www.python.org/dev/peps/pep-3101/"><span style='color:black'>String</span></a><u>
</u><a href="http://www.python.org/dev/peps/pep-3101/"><span style='color:black'>Formatting</span></a></p>

<h2 style='margin-top:0in;margin-right:22.2pt;margin-bottom:0in;margin-left:
16.4pt;line-height:107%'><span style='font-size:24.0pt;line-height:107%'>C</span><span
style='font-size:19.0pt;line-height:107%'>HAPTER </span><span style='font-size:
24.0pt;line-height:107%'>5. R</span><span style='font-size:19.0pt;line-height:
107%'>EGULAR </span><span style='font-size:24.0pt;line-height:107%'>E</span><span
style='font-size:19.0pt;line-height:107%'>XPRESSIONS</span></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:39.9pt;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=736 height=4 id="Group 651449"
src="Dive%20Into%20Python%203_files/image001.gif"></span></p>

<p class=MsoNormal align=right style='margin-top:0in;margin-right:0in;
margin-bottom:6.15pt;margin-left:16.6pt;text-align:right;line-height:107%'><span
style='font-size:13.0pt;line-height:107%;font-family:"Calibri",sans-serif'>&#10077;
</span><i>Some people, when confronted with a problem, think “I know, I’ll use
regular expressions.” Now they have two</i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.75pt;margin-bottom:
65.55pt;margin-left:479.9pt;text-indent:28.5pt;line-height:159%'><i>problems. </i><span
style='font-size:13.0pt;line-height:159%;font-family:"Calibri",sans-serif'>&#10078;
</span><i>— </i><a href="http://www.jwz.org/hacks/marginal.html"><i><span
style='color:black'>Jamie</span></i></a><i><u> </u></i><a
href="http://www.jwz.org/hacks/marginal.html"><i><span style='color:black'>Zawinski</span></i></a></p>

<h3 style='margin-top:0in;margin-right:0in;margin-bottom:65.9pt;margin-left:
16.4pt'><span style='font-size:18.0pt;line-height:112%'>5.1. D</span>IVING <span
style='font-size:18.0pt;line-height:112%'>I</span>N</h3>

<p class=MsoNormal style='margin-left:16.4pt;line-height:107%'><span
style='font-size:48.0pt;line-height:107%;font-family:"DejaVu Serif",serif;
color:#888888'>G </span>etting a small bit of text out of a large block of text
is a challenge. In Python, strings have methods</p>

<p class=MsoNormal style='margin-left:16.4pt'>for searching and replacing: <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>index()</span>,
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>find()</span>,
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>split()</span>,
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>count()</span>,
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>replace()</span>,
<i><span style='font-size:13.0pt;line-height:154%;font-family:"DejaVu Serif",serif'>&amp;</span></i>c.
But these methods are limited to the simplest of cases. For example, the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>index()
</span>method looks for a single, hard-coded substring, and the search is
always case-sensitive. To do case-insensitive searches of a string <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>s</span>,
you must call</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.4pt;margin-left:16.4pt'><span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>s.lower() </span>or <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>s.upper() </span>and make sure
your search strings are the appropriate case to match. The <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>replace()
</span>and <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>split()
</span>methods have the same limitations.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.5pt;margin-bottom:20.6pt;
margin-left:16.4pt'>If your goal can be accomplished with string methods, you
should use them. They’re fast and simple and easy to read, and there’s a lot to
be said for fast, simple, readable code. But if you find yourself using a lot
of different string functions with <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>if </span>statements to handle special
cases, or if you’re chaining calls to <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>split() </span>and <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>join() </span>to
slice-and-dice your strings, you may need to move up to regular expressions.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:46.9pt;
margin-left:16.4pt'>Regular expressions are a powerful and (mostly)
standardized way of searching, replacing, and parsing text with complex
patterns of characters. Although the regular expression syntax is tight and
unlike normal code, the result can end up being <i>more </i>readable than a
hand-rolled solution that uses a long chain of string functions. There are even
ways of embedding comments within regular expressions, so you can include
finegrained documentation within them.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:33.8pt;margin-bottom:
1.95pt;margin-left:75.95pt;text-indent:-29.3pt'><span style='font-size:24.0pt;
line-height:154%;font-family:"Calibri",sans-serif'>&#9758; </span>If you’ve
used regular expressions in other languages (like Perl, JavaScript, or PHP),
Python’s syntax will be very familiar. Read the summary of the <a
href="http://docs.python.org/dev/library/re.html#module-contents"><span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono";
color:black'>re</span></a><u><span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'> </span></u><a
href="http://docs.python.org/dev/library/re.html#module-contents"><span
style='color:black'>module</span></a><u> </u>to get an overview of the
available functions and their arguments.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:3.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h3 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>5.2.
C</span>ASE <span style='font-size:18.0pt;line-height:112%'>S</span>TUDY<span
style='font-size:18.0pt;line-height:112%'>: S</span>TREET <span
style='font-size:18.0pt;line-height:112%'>A</span>DDRESSES</h3>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:19.05pt;
margin-left:16.4pt'>This series of examples was inspired by a real-life problem
I had in my day job several years ago, when I needed to scrub and standardize
street addresses exported from a legacy system before importing them into a
newer system. (See, I don’t just make this stuff up; it’s actually useful.)
This example shows how I approached the problem.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>s =
'100 NORTH MAIN ROAD'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>s.replace('ROAD', 'RD.')                </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'100 NORTH MAIN RD.'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>s =
'100 NORTH BROAD ROAD'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>s.replace('ROAD', 'RD.')                </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'100 NORTH BRD. RD.'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>s[:-4]
+ s[-4:].replace('ROAD', 'RD.') </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.45pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'100 NORTH BROAD RD.'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.8pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>import re                               </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>re.sub('ROAD$', 'RD.', s)               </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9316;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.45pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'100 NORTH BROAD RD.'</span></p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>My goal is to
standardize a street address so that <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>'ROAD' </span>is always abbreviated as <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>'RD.'</span>.
At first glance, I thought this was simple enough that I could just use the
string method <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>replace()</span>.
After all, all the data was already uppercase, so case mismatches would not be
a problem. And the search string, <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>'ROAD'</span>, was a constant. And in this
deceptively simple example, <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>s.replace() </span>does indeed work.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.45pt;
margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Life,
unfortunately, is full of counterexamples, and I quickly discovered this one.
The problem here is that</p>

<p class=MsoNormal style='margin-left:16.4pt'><span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>'ROAD' </span>appears twice in
the address, once as part of the street name <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>'BROAD' </span>and once as its
own word. The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>replace()
</span>method sees these two occurrences and blindly replaces both of them;
meanwhile, I see my addresses getting destroyed.</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>To solve the
problem of addresses with more than one <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>'ROAD' </span>substring, you
could resort to something like this: only search and replace <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>'ROAD' </span>in
the last four characters of the address (<span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>s[-4:]</span>), and leave the
string alone (<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>s[:-4]</span>).
But you can see that this is already getting unwieldy. For example, the pattern
is dependent on the length of the string you’re replacing. (If you were
replacing <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>'STREET'
</span>with <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>'ST.'</span>,
you would need to</p>

<p class=MsoNormal align=right style='margin-top:0in;margin-right:.1pt;
margin-bottom:5.7pt;margin-left:.5pt;text-align:right;line-height:110%'>use <span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>s[:-6] </span>and
<span style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>s[-6:].replace(...)</span>.)
Would you like to come back in six months and debug this? I know</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.4pt;line-height:107%'>I wouldn’t.</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>It’s time to
move up to regular expressions. In Python, all functionality related to regular
expressions is contained in the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>re </span>module.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:20.55pt;
margin-left:16.65pt;text-indent:-16.65pt'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Take a look at the first parameter: <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>'ROAD$'</span>. This is a
simple regular expression that matches <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>'ROAD' </span>only when it
occurs at the end of a string. The <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>$ </span>means “end of the string.” (There
is a corresponding character, the caret <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>^</span>, which means
“beginning of the string.”) Using the <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>re.sub() </span>function, you search the
string <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>s
</span>for the regular expression <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>'ROAD$' </span>and replace it with <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>'RD.'</span>.
This matches the <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>ROAD </span>at the end of the string <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>s</span>, but does <i>not
</i>match the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>ROAD
</span>that’s part of the word <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>BROAD</span>, because that’s in the middle of <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>s</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.05pt;margin-left:16.4pt'><img width=298 height=1
src="Dive%20Into%20Python%203_files/image033.gif" align=left hspace=12>Continuing
with my story of scrubbing addresses, I soon discovered that the previous
example, matching <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>'ROAD' </span>at the end of the address, was not good
enough, because not all addresses included a street designation at all. Some
addresses simply ended with the street name. I got away with it most of the
time, but if the street name was <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>'BROAD'</span>, then the regular expression
would match <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>'ROAD'
</span>at the end of the string as part of the word <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>'BROAD'</span>, which is
not what I wanted.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>s =
'100 BROAD'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>re.sub('ROAD$',
'RD.', s)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'100 BRD.'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>re.sub('\\bROAD$', 'RD.', s)   </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'100 BROAD'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>re.sub(r'\bROAD$', 'RD.', s)   </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'100 BROAD'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>s =
'100 BROAD ROAD APT. 3'</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=294
 style='width:220.8pt;margin-left:38.15pt;border-collapse:collapse'>
 <tr style='height:39.3pt'>
  <td width=280 valign=top style='width:210.05pt;padding:0in 0in 0in 0in;
  height:39.3pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>re.sub(r'\bROAD$',
  'RD.', s)</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>'100
  BROAD ROAD APT. 3'</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:39.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9314;</span></p>
  </td>
 </tr>
 <tr style='height:18.3pt'>
  <td width=280 valign=bottom style='width:210.05pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono";
  color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
  107%;font-family:"Liberation Mono"'>re.sub(r'\bROAD\b', 'RD.', s)</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9315;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'100 BROAD RD. APT 3'</span></p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>What I <i>really
</i>wanted was to match <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>'ROAD' </span>when it was at the end of the
string <i>and </i>it was its own word (and not a part of some larger word). To
express this in a regular expression, you use <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>\b</span>, which means “a word
boundary must occur right here.” In Python, this is complicated by the fact
that the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>'\'
</span>character in a string must itself be escaped. This is sometimes referred
to as the backslash plague, and it is one reason why regular expressions are
easier in Perl than in Python. On the down side, Perl mixes regular expressions
with other syntax, so if you have a bug, it may be hard to tell whether it’s a
bug in syntax or a bug in your regular expression.</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>To work around
the backslash plague, you can use what is called a <i>raw string</i>, by
prefixing the string with the letter <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>r</span>. This tells Python that nothing in
this string should be escaped; <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>'\t' </span>is a tab character, but <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>r'\t' </span>is
really the backslash character <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>\ </span>followed by the letter <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>t</span>.
I recommend always using raw strings when dealing with regular expressions;
otherwise, things get too confusing too quickly (and regular expressions are
confusing enough already).</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><i>*sigh* </i>Unfortunately,
I soon found more cases that contradicted my logic. In this case, the street
address contained the word <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>'ROAD' </span>as a whole word by itself, but it
wasn’t at the end, because the address had an apartment number after the street
designation. Because <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>'ROAD' </span>isn’t at the very end of the string, it
doesn’t match, so the entire call to <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>re.sub() </span>ends up replacing nothing
at all, and you get the original string back, which is not what you want.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:45.65pt;
margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>To solve this problem, I removed the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>$ </span>character and added
another <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>\b</span>.
Now the regular expression reads “match <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>'ROAD' </span>when it’s a whole
word by itself anywhere in the string,” whether at the end, the beginning, or
somewhere in the middle.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:3.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h3 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>5.3.
C</span>ASE <span style='font-size:18.0pt;line-height:112%'>S</span>TUDY<span
style='font-size:18.0pt;line-height:112%'>: R</span>OMAN <span
style='font-size:18.0pt;line-height:112%'>N</span>UMERALS</h3>

<p class=MsoNormal style='margin-top:0in;margin-right:2.8pt;margin-bottom:.25pt;
margin-left:16.4pt'>You’ve most likely seen Roman numerals, even if you didn’t
recognize them. You may have seen them in copyrights of old movies and
television shows (“Copyright <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>MCMXLVI</span>” instead of “Copyright <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>1946</span>”),
or on the dedication walls of libraries or universities (“established <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>MDCCCLXXXVIII</span>”
instead of “established <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>1888</span>”). You may also have seen them in
outlines and bibliographical references. It’s a system of representing numbers
that really does date back to the ancient Roman empire (hence the name).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:22.7pt;
margin-left:16.4pt'>In Roman numerals, there are seven characters that are
repeated and combined in various ways to represent numbers.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:16.65pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>I = 1</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:16.65pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>V = 5</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:16.65pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>X = 10</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:16.65pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>L = 50</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:16.65pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>C = 100</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:16.65pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>D = 500</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:26.6pt;
margin-left:16.65pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>M =
1000</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
22.15pt;margin-left:16.4pt'>The following are some general rules for
constructing Roman numerals:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.15pt;
margin-left:16.65pt;text-indent:-12.25pt;line-height:107%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Sometimes
characters are additive. <span style='font-size:10.0pt;line-height:107%;
font-family:"Liberation Mono"'>I </span>is <span style='font-size:10.0pt;
line-height:107%;font-family:"Liberation Mono"'>1</span>, <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>II </span>is
<span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>2</span>,
and <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>III
</span>is <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>3</span>.
<span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>VI
</span>is <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>6
</span>(literally, “<span style='font-size:10.0pt;line-height:107%;font-family:
"Liberation Mono"'>5 </span>and <span style='font-size:10.0pt;line-height:107%;
font-family:"Liberation Mono"'>1</span>”), <span style='font-size:10.0pt;
line-height:107%;font-family:"Liberation Mono"'>VII </span>is <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>7</span>,
and</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.8pt;
margin-left:17.15pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>VIII </span>is <span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono"'>8</span>.</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-12.25pt'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The tens
characters (<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>I</span>,
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>X</span>,
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>C</span>,
and <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>M</span>)
can be repeated up to three times. At <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>4</span>, you need to subtract from the
next highest fives character. You can't represent <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>4 </span>as <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>IIII</span>;
instead, it is represented as <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>IV </span>(“<span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>1 </span>less than <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>5</span>”).</p>

<p class=MsoNormal style='margin-left:16.4pt'><span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>40 </span>is written as <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>XL </span>(“<span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>10 </span>less
than <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>50</span>”),
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>41
</span>as <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>XLI</span>,
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>42
</span>as <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>XLII</span>,
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>43
</span>as <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>XLIII</span>,
and then <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>44
</span>as <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>XLIV
</span>(“<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>10
</span>less than <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>50</span>, then <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>1 </span>less than <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>5</span>”).</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-12.25pt'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Sometimes
characters are… the opposite of additive. By putting certain characters before
others, you subtract from the final value. For example, at <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>9</span>,
you need to subtract from the next highest tens character: <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>8 </span>is
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>VIII</span>,
but <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>9
</span>is <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>IX
</span>(“<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>1
</span>less than <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>10</span>”), not <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>VIIII </span>(since the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>I </span>character
can not be repeated four times). <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>90 </span>is <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>XC</span>, <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>900 </span>is
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>CM</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.35pt;
margin-left:16.65pt;text-indent:-12.25pt;line-height:107%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The fives
characters can not be repeated. <span style='font-size:10.0pt;line-height:107%;
font-family:"Liberation Mono"'>10 </span>is always represented as <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>X</span>,
never as <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>VV</span>.
<span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>100
</span>is always <span style='font-size:10.0pt;line-height:107%;font-family:
"Liberation Mono"'>C</span>, never</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:17.15pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>LL</span>.</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-12.25pt'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Roman numerals
are read left to right, so the order of characters matters very much. <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>DC </span>is
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>600</span>;
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>CD
</span>is a completely different number (<span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>400</span>, “<span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>100 </span>less
than <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>500</span>”).
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>CI
</span>is <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>101</span>;
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>IC
</span>is not even a valid Roman numeral (because you can't subtract <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>1 </span>directly
from <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>100</span>;
you would need to write it as <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>XCIX</span>, “<span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>10 </span>less than <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>100</span>,
then <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>1
</span>less than <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>10</span>”).</p>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:25.25pt;margin-left:
16.4pt;line-height:110%'><span style='font-size:13.0pt;line-height:110%'>5.3.1.
C</span><span style='font-size:10.5pt;line-height:110%'>HECKING </span><span
style='font-size:13.0pt;line-height:110%'>F</span><span style='font-size:10.5pt;
line-height:110%'>OR </span><span style='font-size:13.0pt;line-height:110%'>T</span><span
style='font-size:10.5pt;line-height:110%'>HOUSANDS</span></h4>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:19.1pt;
margin-left:16.4pt'>What would it take to validate that an arbitrary string is
a valid Roman numeral? Let’s take it one digit at a time. Since Roman numerals
are always written highest to lowest, let’s start with the highest: the
thousands place. For numbers 1000 and higher, the thousands are represented by
a series of <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>M
</span>characters.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.6pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>import
re</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.8pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>pattern = '^M?M?M?$'        </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>re.search(pattern, 'M')     </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;_sre.SRE_Match object at 0106FB58&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>re.search(pattern, 'MM')    </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;_sre.SRE_Match object at 0106C290&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>re.search(pattern, 'MMM')   </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;_sre.SRE_Match object at 0106AA38&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.8pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>re.search(pattern,
'MMMM') </span><span style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9316;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>re.search(pattern, '')      </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9317;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.1pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;_sre.SRE_Match object at 0106F4A8&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:6.55pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>This pattern has three parts. <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>^ </span>matches what follows only at the
beginning of the string. If this were not specified, the pattern would match no
matter where the <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>M </span>characters were, which is not what you want.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.9pt;margin-bottom:.25pt;
margin-left:16.4pt'>You want to make sure that the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>M </span>characters, if they’re
there, are at the beginning of the string. <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>M? </span>optionally matches a
single <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>M
</span>character. Since this is repeated three times, you’re matching anywhere
from zero to three <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>M </span>characters in a row. And <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>$ </span>matches the end
of the string. When combined with the <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>^ </span>character at the beginning, this
means that the pattern must match the entire string, with no other characters
before or after the <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>M </span>characters.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:6.55pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The essence of the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>re </span>module is the <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>search() </span>function,
that takes a regular expression (<span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>pattern</span>) and a string (<span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>'M'</span>)
to try to match against the regular expression. If a match is found, <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>search()
</span>returns an object which has various methods to describe the match; if no
match is found, <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>search() </span>returns <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>None</span>, the Python null
value. All you care about at the moment is whether the pattern matches, which
you can tell by just looking at the return value of <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>search()</span>. <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>'M' </span>matches
this regular expression, because the first optional <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>M </span>matches and the
second and third optional <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>M </span>characters are ignored.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:6.55pt;margin-bottom:
6.45pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>'MM' </span>matches
because the first and second optional <span style='font-size:10.0pt;line-height:
107%;font-family:"Liberation Mono"'>M </span>characters match and the third <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>M </span>is
ignored.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:6.55pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>'MMM' </span>matches
because all three <span style='font-size:10.0pt;line-height:107%;font-family:
"Liberation Mono"'>M </span>characters match.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:6.55pt;margin-bottom:
.15pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:155%'>5.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:155%;font-family:"Liberation Mono"'>'MMMM' </span>does
not match. All three <span style='font-size:10.0pt;line-height:155%;font-family:
"Liberation Mono"'>M </span>characters match, but then the regular expression
insists on the string ending (because of the <span style='font-size:10.0pt;
line-height:155%;font-family:"Liberation Mono"'>$ </span>character), and the
string doesn’t end yet (because of the fourth <span style='font-size:10.0pt;
line-height:155%;font-family:"Liberation Mono"'>M</span>). So <span
style='font-size:10.0pt;line-height:155%;font-family:"Liberation Mono"'>search()
</span>returns <span style='font-size:10.0pt;line-height:155%;font-family:"Liberation Mono"'>None</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:6.55pt;margin-bottom:
23.1pt;margin-left:16.65pt;text-indent:-16.65pt'>6.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Interestingly, an empty string also matches this regular expression,
since all the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>M
</span>characters are optional.</p>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:25.25pt;margin-left:
16.4pt;line-height:110%'><span style='font-size:13.0pt;line-height:110%'>5.3.2.
C</span><span style='font-size:10.5pt;line-height:110%'>HECKING </span><span
style='font-size:13.0pt;line-height:110%'>F</span><span style='font-size:10.5pt;
line-height:110%'>OR </span><span style='font-size:13.0pt;line-height:110%'>H</span><span
style='font-size:10.5pt;line-height:110%'>UNDREDS</span></h4>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
23.05pt;margin-left:16.4pt'><img width=298 height=1
src="Dive%20Into%20Python%203_files/image033.gif" align=left hspace=12>The
hundreds place is more difficult than the thousands, because there are several
mutually exclusive ways it could be expressed, depending on its value.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:16.65pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>100 = C</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:16.65pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>200 =
CC</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:16.65pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>300 =
CCC</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:16.65pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>400 =
CD</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:16.65pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>500 = D</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:16.65pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>600 =
DC</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:16.65pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>700 =
DCC</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:16.65pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>800 =
DCCC</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:26.6pt;
margin-left:16.65pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>900 =
CM</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
23.5pt;margin-left:16.4pt'>So there are four possible patterns:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:16.65pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>CM</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:16.65pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>CD</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.25pt;
margin-left:16.65pt;text-indent:-12.25pt;line-height:107%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Zero to three <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>C </span>characters
(zero if the hundreds place is 0)</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-12.25pt;line-height:
300%'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:300%;font-family:"Liberation Mono"'>D</span>,
followed by zero to three <span style='font-size:10.0pt;line-height:300%;
font-family:"Liberation Mono"'>C </span>characters The last two patterns can be
combined:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:21.5pt;
margin-left:16.65pt;text-indent:-12.25pt'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>an optional <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>D</span>, followed by zero to three <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>C </span>characters</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>This example shows how to validate
the hundreds place of a Roman numeral.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>import
re</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=350
 style='width:3.65in;margin-left:38.15pt;border-collapse:collapse'>
 <tr style='height:18.3pt'>
  <td width=336 valign=top style='width:252.05pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono";
  color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
  107%;font-family:"Liberation Mono"'>pattern = '^M?M?M?(CM|CD|D?C?C?C?)$'</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9312;</span></p>
  </td>
 </tr>
 <tr style='height:43.5pt'>
  <td width=336 valign=top style='width:252.05pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>re.search(pattern,
  'MCM')</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>&lt;_sre.SRE_Match
  object at 01070390&gt;</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9313;</span></p>
  </td>
 </tr>
 <tr style='height:43.5pt'>
  <td width=336 valign=top style='width:252.05pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>re.search(pattern,
  'MD')</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>&lt;_sre.SRE_Match
  object at 01073A50&gt;</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9314;</span></p>
  </td>
 </tr>
 <tr style='height:43.5pt'>
  <td width=336 valign=top style='width:252.05pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>re.search(pattern,
  'MMMCCC')</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>&lt;_sre.SRE_Match
  object at 010748A8&gt;</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9315;</span></p>
  </td>
 </tr>
 <tr style='height:22.5pt'>
  <td width=336 valign=top style='width:252.05pt;padding:0in 0in 0in 0in;
  height:22.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono";
  color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
  107%;font-family:"Liberation Mono"'>re.search(pattern, 'MCMC')</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:22.5pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9316;</span></p>
  </td>
 </tr>
 <tr style='height:18.3pt'>
  <td width=336 valign=bottom style='width:252.05pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono";
  color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
  107%;font-family:"Liberation Mono"'>re.search(pattern, '')</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9317;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.1pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;_sre.SRE_Match object at 01071D98&gt;</span></p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>This pattern
starts out the same as the previous one, checking for the beginning of the
string (<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>^</span>),
then the thousands place (<span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>M?M?M?</span>). Then it has the new part, in
parentheses, which defines a set of three mutually exclusive patterns,
separated by vertical bars: <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>CM</span>, <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>CD</span>, and <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>D?C?C?C?
</span>(which is an optional <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>D </span>followed by zero to three optional <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>C </span>characters).
The regular expression parser checks for each of these patterns in order (from
left to right), takes the first one that matches, and ignores the rest.</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>'MCM' </span>matches
because the first <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>M </span>matches, the second and third <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>M </span>characters
are ignored, and the <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>CM </span>matches (so the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>CD </span>and <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>D?C?C?C?
</span>patterns are never even considered). <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>MCM </span>is the Roman numeral
representation of <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>1900</span>.</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>'MD' </span>matches
because the first <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>M </span>matches, the second and third <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>M </span>characters
are ignored, and the <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>D?C?C?C? </span>pattern matches <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>D </span>(each of the three <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>C </span>characters
are optional and are ignored). <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>MD </span>is the Roman numeral representation of
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>1500</span>.</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>'MMMCCC'
</span>matches because all three <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>M </span>characters match, and the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>D?C?C?C?
</span>pattern matches <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>CCC </span>(the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>D </span>is optional and is
ignored). <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>MMMCCC
</span>is the Roman numeral representation of <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>3300</span>.</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>5.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>'MCMC' </span>does
not match. The first <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>M </span>matches, the second and third <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>M </span>characters
are ignored, and the <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>CM </span>matches, but then the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>$ </span>does not match because
you’re not at the end of the string yet (you still have an unmatched <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>C </span>character).
The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>C
</span>does <i>not </i>match as part of the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>D?C?C?C? </span>pattern,
because the mutually exclusive <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>CM </span>pattern has already matched.</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>6.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Interestingly,
an empty string still matches this pattern, because all the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>M </span>characters
are optional and ignored, and the empty string matches the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>D?C?C?C?
</span>pattern where all the characters are optional and ignored.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:45.7pt;
margin-left:16.4pt'>Whew! See how quickly regular expressions can get nasty?
And you’ve only covered the thousands and hundreds places of Roman numerals.
But if you followed all that, the tens and ones places are easy, because
they’re exactly the same pattern. But let’s look at another way to express the
pattern.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:3.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h3 style='margin-top:0in;margin-right:0in;margin-bottom:19.4pt;margin-left:
16.4pt'><span style='font-size:18.0pt;line-height:112%'>5.4. U</span>SING <span
style='font-size:18.0pt;line-height:112%'>T</span>HE <span style='font-size:
18.0pt;line-height:112%;font-family:"Liberation Mono";font-weight:normal'>{n,m}
</span><span style='font-size:18.0pt;line-height:112%'>S</span>YNTAX</h3>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.05pt;margin-left:16.4pt'><img width=301 height=1
src="Dive%20Into%20Python%203_files/image036.gif" align=left hspace=12>In the
previous section, you were dealing with a pattern where the same character
could be repeated up to three times. There is another way to express this in
regular expressions, which some people find more readable. First look at the
method we already used in the previous example.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>import
re</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>pattern
= '^M?M?M?$'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>re.search(pattern, 'M')     </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;_sre.SRE_Match object at 0x008EE090&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>pattern
= '^M?M?M?$'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>re.search(pattern, 'MM')    </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;_sre.SRE_Match object at 0x008EEB48&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>pattern
= '^M?M?M?$'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>&gt;&gt;&gt;
re.search(pattern, 'MMM')   </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;_sre.SRE_Match object at 0x008EE090&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&gt;&gt;&gt; re.search(pattern, 'MMMM') </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;</span>&nbsp;</p>

<p class=MsoNormal style='margin-top:0in;margin-right:9.1pt;margin-bottom:.25pt;
margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>This matches the start of the string, and then the first optional <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>M</span>,
but not the second and third <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>M </span>(but that’s okay because they’re
optional), and then the end of the string.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:9.1pt;margin-bottom:.25pt;
margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>This matches the start of the string, and then the first and second
optional <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>M</span>,
but not the third <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>M </span>(but that’s okay because it’s optional), and then
the end of the string.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:9.1pt;margin-bottom:6.1pt;
margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>This matches the
start of the string, and then all three optional <span style='font-size:10.0pt;
line-height:107%;font-family:"Liberation Mono"'>M</span>, and then the end of
the string.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:9.1pt;margin-bottom:23.15pt;
margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>This matches the start of the string, and then all three optional <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>M</span>,
but then does not match the end of the string (because there is still one
unmatched <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>M</span>),
so the pattern does not match and returns <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>None</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.8pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>pattern = '^M{0,3}$'        </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>re.search(pattern, 'M')     </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;_sre.SRE_Match object at 0x008EEB48&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>re.search(pattern, 'MM')    </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;_sre.SRE_Match object at 0x008EE090&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>re.search(pattern, 'MMM')   </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;_sre.SRE_Match object at 0x008EEDA8&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>re.search(pattern,
'MMMM') </span><span style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9316;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.1pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&gt;&gt;&gt;</span>&nbsp;</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>This pattern says: “Match the start of the string, then anywhere from
zero to three <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>M
</span>characters, then the end of the string.” The 0 and 3 can be any numbers;
if you want to match at least one but no more than three <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>M </span>characters,
you could say <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>M{1,3}</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.1pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>This matches the
start of the string, then one <span style='font-size:10.0pt;line-height:107%;
font-family:"Liberation Mono"'>M </span>out of a possible three, then the end
of the string.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.1pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>This matches the
start of the string, then two <span style='font-size:10.0pt;line-height:107%;
font-family:"Liberation Mono"'>M </span>out of a possible three, then the end
of the string.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.1pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>This matches the
start of the string, then three <span style='font-size:10.0pt;line-height:107%;
font-family:"Liberation Mono"'>M </span>out of a possible three, then the end
of the string.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
22.1pt;margin-left:16.65pt;text-indent:-16.65pt'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>This matches the start of the string, then three <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>M </span>out of a
possible three, but then <i>does not match </i>the end of the string. The
regular expression allows for up to only three <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>M </span>characters before the
end of the string, but you have four, so the pattern does not match and returns
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>None</span>.</p>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:25.25pt;margin-left:
16.4pt;line-height:110%'><span style='font-size:13.0pt;line-height:110%'>5.4.1.
C</span><span style='font-size:10.5pt;line-height:110%'>HECKING </span><span
style='font-size:13.0pt;line-height:110%'>F</span><span style='font-size:10.5pt;
line-height:110%'>OR </span><span style='font-size:13.0pt;line-height:110%'>T</span><span
style='font-size:10.5pt;line-height:110%'>ENS </span><span style='font-size:
13.0pt;line-height:110%'>A</span><span style='font-size:10.5pt;line-height:
110%'>ND </span><span style='font-size:13.0pt;line-height:110%'>O</span><span
style='font-size:10.5pt;line-height:110%'>NES</span></h4>

<p class=MsoNormal style='margin-left:16.4pt'>Now let’s expand the Roman
numeral regular expression to cover the tens and ones place. This example shows
the check for tens.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>pattern
= '^M?M?M?(CM|CD|D?C?C?C?)(XC|XL|L?X?X?X?)$'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>re.search(pattern, 'MCMXL')     </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;_sre.SRE_Match object at 0x008EEB48&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>re.search(pattern, 'MCML')      </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;_sre.SRE_Match object at 0x008EEB48&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>re.search(pattern, 'MCMLX')     </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;_sre.SRE_Match object at 0x008EEB48&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>re.search(pattern, 'MCMLXXX')   </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;_sre.SRE_Match object at 0x008EEB48&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>re.search(pattern,
'MCMLXXXX') </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9316;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.95in;margin-bottom:
31.25pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;</span>&nbsp;</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.4pt;
margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>This matches the
start of the string, then the first optional <span style='font-size:10.0pt;
line-height:107%;font-family:"Liberation Mono"'>M</span>, then <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>CM</span>,
then <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>XL</span>,
then the end of the string.</p>

<p class=MsoNormal style='margin-left:16.4pt'>Remember, the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>(A|B|C)
</span>syntax means “match exactly one of A, B, or C”. You match <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>XL</span>,
so you ignore the <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>XC </span>and <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>L?X?X?X? </span>choices, and then move on
to the end of the string. <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>MCMXL </span>is the Roman numeral representation
of <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>1940</span>.</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>This matches the
start of the string, then the first optional <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>M</span>, then <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>CM</span>,
then <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>L?X?X?X?</span>.
Of the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>L?X?X?X?</span>,
it matches the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>L
</span>and skips all three optional <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>X </span>characters. Then you move to the
end of the string. <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>MCML </span>is the Roman numeral representation of <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>1950</span>.</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>This matches the
start of the string, then the first optional <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>M</span>, then <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>CM</span>,
then the optional <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>L </span>and the first optional <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>X</span>, skips the second and
third optional <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>X</span>,
then the end of the string. <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>MCMLX </span>is the Roman numeral representation
of <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>1960</span>.</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>This matches the
start of the string, then the first optional <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>M</span>, then <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>CM</span>,
then the optional <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>L </span>and all three optional <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>X </span>characters, then the
end of the string. <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>MCMLXXX </span>is the Roman numeral representation of <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>1980</span>.</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>5.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>This matches the
start of the string, then the first optional <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>M</span>, then <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>CM</span>,
then the optional <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>L </span>and all three optional <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>X </span>characters, then <i>fails
to match </i>the end of the string because there is still one more <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>X </span>unaccounted
for. So the entire pattern fails to match, and returns <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>None</span>. <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>MCMLXXXX
</span>is not a valid Roman numeral.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
margin-left:16.4pt'>The expression for the ones place follows the same pattern.
I’ll spare you the details and show you the end result. <span style='font-size:
11.0pt;line-height:154%;font-family:"Calibri",sans-serif'><img border=0
width=298 height=450 src="Dive%20Into%20Python%203_files/image041.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>pattern
= '^M?M?M?(CM|CD|D?C?C?C?)(XC|XL|L?X?X?X?)(IX|IV|V?I?I?I?)$'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.0pt;margin-left:16.4pt'>So what does that look like using this alternate <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>{n,m} </span>syntax?
This example shows the new syntax.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>pattern
= '^M{0,3}(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})$'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>re.search(pattern, 'MDLV')              </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;_sre.SRE_Match object at 0x008EEB48&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>re.search(pattern, 'MMDCLXVI')          </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;_sre.SRE_Match object at 0x008EEB48&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>re.search(pattern, 'MMMDCCCLXXXVIII')   </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;_sre.SRE_Match object at 0x008EEB48&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>re.search(pattern, 'I')                 </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;_sre.SRE_Match object at 0x008EEB48&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.35pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>This matches the start of the string, then one of a possible three <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>M </span>characters,
then <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>D?C{0,3}</span>.
Of that, it matches the optional <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>D </span>and zero of three possible <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>C </span>characters.
Moving on, it matches <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>L?X{0,3} </span>by matching the optional <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>L </span>and
zero of three possible <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>X </span>characters. Then it matches <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>V?I{0,3}
</span>by matching the optional <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>V </span>and zero of three possible <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>I </span>characters,
and finally the end of the string. <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>MDLV </span>is the Roman numeral
representation of <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>1555</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.35pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>This matches the start of the string, then two of a possible three <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>M </span>characters,
then the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>D?C{0,3}
</span>with a <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>D
</span>and one of three possible <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>C </span>characters; then <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>L?X{0,3}
</span>with an <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>L
</span>and one of three possible <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>X </span>characters; then <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>V?I{0,3}
</span>with a <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>V
</span>and one of three possible <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>I </span>characters; then the end of the
string. <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>MMDCLXVI
</span>is the Roman numeral representation of <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>2666</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.35pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>This matches the start of the string, then three out of three <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>M </span>characters,
then <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>D?C{0,3}
</span>with a <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>D
</span>and three out of three <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>C </span>characters; then <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>L?X{0,3}
</span>with an <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>L
</span>and three out of three <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>X </span>characters; then <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>V?I{0,3}
</span>with a <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>V
</span>and three out of three <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>I </span>characters; then the end of the string.
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>MMMDCCCLXXXVIII
</span>is the Roman numeral representation of <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>3888</span>, and it’s the
longest Roman numeral you can write without extended syntax.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.35pt;margin-bottom:
20.5pt;margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Watch closely. (I feel like a magician. “Watch closely, kids, I’m going
to pull a rabbit out of my hat.”) This matches the start of the string, then
zero out of three <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>M</span>, then matches <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>D?C{0,3} </span>by skipping the
optional <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>D
</span>and matching zero out of three <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>C</span>, then matches <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>L?X{0,3}
</span>by skipping the optional <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>L </span>and matching zero out of three <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>X</span>,
then matches <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>V?I{0,3}
</span>by skipping the optional <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>V </span>and matching one out of three <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>I</span>.
Then the end of the string. Whoa.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:20.55pt;
margin-left:16.4pt'>If you followed all that and understood it on the first
try, you’re doing better than I did. Now imagine trying to understand someone
else’s regular expressions, in the middle of a critical function of a large
program. Or even imagine coming back to your own regular expressions a few
months later. I’ve done it, and it’s not a pretty sight.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
46.55pt;margin-left:16.4pt'>Now let’s explore an alternate syntax that can help
keep your expressions maintainable.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:3.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h3 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>5.5.
V</span>ERBOSE <span style='font-size:18.0pt;line-height:112%'>R</span>EGULAR <span
style='font-size:18.0pt;line-height:112%'>E</span>XPRESSIONS</h3>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:20.55pt;
margin-left:16.4pt'>So far you’ve just been dealing with what I’ll call
“compact” regular expressions. As you’ve seen, they are difficult to read, and
even if you figure out what one does, that’s no guarantee that you’ll be able
to understand it six months later. What you really need is inline
documentation.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.4pt;margin-bottom:20.55pt;
margin-left:16.4pt'>Python allows you to do this with something called <i>verbose
regular expressions</i>. A verbose regular expression is different from a
compact regular expression in two ways:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.05pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-12.25pt'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Whitespace is ignored. Spaces, tabs, and carriage returns are not
matched as spaces, tabs, and carriage returns. They’re not matched at all. (If
you want to match a space in a verbose regular expression, you’ll need to
escape it by putting a backslash in front of it.)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.05pt;margin-bottom:
20.55pt;margin-left:16.65pt;text-indent:-12.25pt'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Comments are ignored. A comment in a verbose regular expression is just
like a comment in Python code: it starts with a <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'># </span>character and goes
until the end of the line. In this case it’s a comment within a multi-line
string instead of within your source code, but it works the same way.</p>

<p class=MsoNormal style='margin-left:16.4pt'>This will be more clear with an
example. Let’s revisit the compact regular expression you’ve been working with,
and make it a verbose regular expression. This example shows how.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>pattern
= '''</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>^                   # beginning of string</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>M{0,3}              # thousands - 0 to 3 Ms</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>(CM|CD|D?C{0,3})    # hundreds - 900 (CM),
400 (CD), 0-300 (0 to 3 Cs),</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:182.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>#            or 500-800 (D, followed by 0
to 3 Cs)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>(XC|XL|L?X{0,3})    # tens - 90 (XC), 40
(XL), 0-30 (0 to 3 Xs),</span></p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:99.45pt;
margin-bottom:8.5pt;margin-left:159.7pt;text-align:center;line-height:110%'><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>#       
or 50-80 (L, followed by 0 to 3 Xs)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>(IX|IV|V?I{0,3})    # ones - 9 (IX), 4
(IV), 0-3 (0 to 3 Is),</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:128.45pt;margin-bottom:
0in;margin-left:62.15pt;text-indent:120.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>#       
or 5-8 (V, followed by 0 to 3 Is) $                   # end of string</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'''</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>re.search(pattern, 'M', re.VERBOSE)                 </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;_sre.SRE_Match object at 0x008EEB48&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>re.search(pattern, 'MCMLXXXIX', re.VERBOSE)         </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;_sre.SRE_Match object at 0x008EEB48&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>re.search(pattern, 'MMMDCCCLXXXVIII',
re.VERBOSE)   </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;_sre.SRE_Match object at 0x008EEB48&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:28.2pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>re.search(pattern, 'M')                             </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.05pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The most important thing to remember when using verbose regular
expressions is that you need to pass an extra argument when working with them: <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>re.VERBOSE
</span>is a constant defined in the <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>re </span>module that signals that the
pattern should be treated as a verbose regular expression. As you can see, this
pattern has quite a bit of whitespace (all of which is ignored), and several
comments (all of which are ignored). Once you ignore the whitespace and the
comments, this is exactly the same regular expression as you saw in the
previous section, but it’s a lot more readable.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.05pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>This matches the start of the string, then one of a possible three <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>M</span>,
then <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>CM</span>,
then <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>L
</span>and three of a possible three <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>X</span>, then <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>IX</span>, then the end of the
string.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.05pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:151%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>This matches the
start of the string, then three of a possible three <span style='font-size:
10.0pt;line-height:151%;font-family:"Liberation Mono"'>M</span>, then <span
style='font-size:10.0pt;line-height:151%;font-family:"Liberation Mono"'>D </span>and
three of a possible three <span style='font-size:10.0pt;line-height:151%;
font-family:"Liberation Mono"'>C</span>, then <span style='font-size:10.0pt;
line-height:151%;font-family:"Liberation Mono"'>L </span>and three of a
possible three <span style='font-size:10.0pt;line-height:151%;font-family:"Liberation Mono"'>X</span>,
then <span style='font-size:10.0pt;line-height:151%;font-family:"Liberation Mono"'>V
</span>and three of a possible three <span style='font-size:10.0pt;line-height:
151%;font-family:"Liberation Mono"'>I</span>, then the end of the string.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.05pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>This does not match. Why? Because it doesn’t have the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>re.VERBOSE
</span>flag, so the <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>re.search </span>function is treating the pattern as a
compact regular expression, with significant whitespace and literal hash marks.
Python can’t auto-detect whether a regular expression is verbose or not. Python
assumes every regular expression is compact unless you explicitly state that it
is verbose.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:3.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h3 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>5.6.
C</span>ASE STUDY<span style='font-size:18.0pt;line-height:112%'>: P</span>ARSING
<span style='font-size:18.0pt;line-height:112%'>P</span>HONE <span
style='font-size:18.0pt;line-height:112%'>N</span>UMBERS</h3>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.55pt;margin-left:16.4pt'><img width=298 height=1
src="Dive%20Into%20Python%203_files/image033.gif" align=left hspace=12>So far
you’ve concentrated on matching whole patterns. Either the pattern matches, or
it doesn’t. But regular expressions are much more powerful than that. When a
regular expression <i>does </i>match, you can pick out specific pieces of it.
You can find out what matched where.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.55pt;margin-left:16.4pt'>This example came from another real-world problem I
encountered, again from a previous day job. The problem: parsing an American
phone number. The client wanted to be able to enter the number free-form (in a
single field), but then wanted to store the area code, trunk, number, and
optionally an extension separately in the company’s database. I scoured the Web
and found many examples of regular expressions that purported to do this, but
none of them were permissive enough.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
23.1pt;margin-left:16.4pt'>Here are the phone numbers I needed to be able to
accept:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:16.65pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>800-555-1212</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:16.65pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>800 555
1212</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:16.65pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>800.555.1212</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:16.65pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>(800)
555-1212</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:16.65pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>1-800-555-1212</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:16.65pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>800-555-1212-1234</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:16.65pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>800-555-1212x1234</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:16.65pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>800-555-1212
ext. 1234</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:16.65pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>work 1-(800)
555.1212 #1234</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.35pt;margin-bottom:
20.4pt;margin-left:16.4pt'>Quite a variety! In each of these cases, I need to
know that the area code was <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>800</span>, the trunk was <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>555</span>,
and the rest of the phone number was <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>1212</span>. For those with an extension, I
need to know that the extension was <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>1234</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
24.15pt;margin-left:16.4pt'>Let’s work through developing a solution for phone
number parsing. This example shows the first step.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.85pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>phonePattern
= re.compile(r'^(\d{3})-(\d{3})-(\d{4})$') </span><span style='font-family:
"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>phonePattern.search('800-555-1212').groups()             </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>('800', '555', '1212')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.9pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>phonePattern.search('800-555-1212-1234')                 </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:99.65pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>phonePattern.search('800-555-1212-1234').groups() </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9315; </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
color:#880000'>Traceback (most recent call last):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>File
&quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
31.05pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>AttributeError:
'NoneType' object has no attribute 'groups'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.65pt;
margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Always read
regular expressions from left to right. This one matches the beginning of the
string, and then</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.3pt;margin-bottom:.25pt;
margin-left:16.4pt'><span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>(\d{3})</span>. What’s <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>\d{3}</span>? Well, <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>\d </span>means
“any numeric digit” (0 through <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>9</span>). The <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>{3} </span>means “match exactly
three numeric digits”; it’s a variation on the <u><span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>{n,m} syntax </span></u>you saw
earlier. Putting it all in parentheses means “match exactly three numeric
digits, <i>and then remember them as a group that I can ask for later</i>”.
Then match a literal hyphen. Then match another group of exactly three digits.
Then another literal hyphen. Then another group of exactly four digits. Then
match the end of the string.</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>To get access to
the groups that the regular expression parser remembered along the way, use the
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>groups()
</span>method on the object that the <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>search() </span>method returns. It will
return a tuple of however many groups were defined in the regular expression.
In this case, you defined three groups, one with three digits, one with three
digits, and one with four digits.</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>This regular
expression is not the final answer, because it doesn’t handle a phone number
with an extension on the end. For that, you’ll need to expand the regular
expression.</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>And this is why
you should never “chain” the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>search() </span>and <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>groups() </span>methods in
production code. If the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>search() </span>method returns no matches, it
returns <u><span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>None</span></u>,
not a regular expression match object. Calling</p>

<p class=MsoNormal style='margin-top:0in;margin-right:5.55pt;margin-bottom:
.15pt;margin-left:16.65pt;text-align:justify;text-justify:inter-ideograph;
text-indent:0in;line-height:155%'><span style='font-size:10.0pt;line-height:
155%;font-family:"Liberation Mono"'>None.groups() </span>raises a perfectly
obvious exception: <span style='font-size:10.0pt;line-height:155%;font-family:
"Liberation Mono"'>None </span>doesn’t have a <span style='font-size:10.0pt;
line-height:155%;font-family:"Liberation Mono"'>groups() </span>method. (Of
course, it’s slightly less obvious when you get this exception from deep within
your code. Yes, I speak from experience here.)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.9pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>phonePattern
= re.compile(r'^(\d{3})-(\d{3})-(\d{4})-(\d+)$') </span><span style='font-family:
"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>phonePattern.search('800-555-1212-1234').groups()              </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>('800', '555', '1212', '1234')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>phonePattern.search('800 555 1212 1234')                       </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.95in;margin-bottom:
12.7pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;</span>&nbsp;</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>phonePattern.search('800-555-1212')                            </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.95in;margin-bottom:
31.05pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;</span>&nbsp;</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>This regular
expression is almost identical to the previous one. Just as before, you match
the beginning of the string, then a remembered group of three digits, then a
hyphen, then a remembered group of three digits, then a hyphen, then a
remembered group of four digits. What’s new is that you then match another
hyphen, and a remembered group of one or more digits, then the end of the
string.</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>groups()
</span>method now returns a tuple of four elements, since the regular
expression now defines four groups to remember.</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Unfortunately,
this regular expression is not the final answer either, because it assumes that
the different parts of the phone number are separated by hyphens. What if
they’re separated by spaces, or commas, or dots? You need a more general
solution to match several different types of separators.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:20.55pt;
margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Oops! Not only does this regular expression not do everything you want,
it’s actually a step backwards, because now you can’t parse phone numbers <i>without
</i>an extension. That’s not what you wanted at all; if the extension is there,
you want to know what it is, but if it’s not there, you still want to know what
the different parts of the main number are.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
23.25pt;margin-left:16.4pt'>The next example shows the regular expression to
handle separators between the different parts of the phone number.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.9pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>phonePattern
= re.compile(r'^(\d{3})\D+(\d{3})\D+(\d{4})\D+(\d+)$') </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>phonePattern.search('800
555 1212 1234').groups() </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>('800', '555', '1212', '1234')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>phonePattern.search('800-555-1212-1234').groups()
</span><span style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>('800', '555', '1212', '1234')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>phonePattern.search('80055512121234')              </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.95in;margin-bottom:
12.7pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;</span>&nbsp;</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>phonePattern.search('800-555-1212')                </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9316;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.95in;margin-bottom:
8.5pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;</span>&nbsp;</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.15pt;
margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Hang on to your
hat. You’re matching the beginning of the string, then a group of three digits,
then <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>\D+</span>.</p>

<p class=MsoNormal style='margin-left:16.4pt'>What the heck is that? Well, <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>\D </span>matches
any character <i>except </i>a numeric digit, and <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>+ </span>means “1 or more”. So <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>\D+ </span>matches
one or more characters that are not digits. This is what you’re using instead
of a literal hyphen, to try to match different separators.</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Using <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>\D+ </span>instead
of <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>-
</span>means you can now match phone numbers where the parts are separated by
spaces instead of hyphens.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.0pt;
margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Of course, phone
numbers separated by hyphens still work too.</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Unfortunately,
this is still not the final answer, because it assumes that there is a
separator at all. What if the phone number is entered without any spaces or
hyphens at all?</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:20.55pt;
margin-left:16.65pt;text-indent:-16.65pt'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Oops! This still hasn’t fixed the problem of requiring extensions. Now
you have two problems, but you can solve both of them with the same technique.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
24.15pt;margin-left:16.4pt'>The next example shows the regular expression for
handling phone numbers <i>without </i>separators.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.9pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>phonePattern
= re.compile(r'^(\d{3})\D*(\d{3})\D*(\d{4})\D*(\d*)$') </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>phonePattern.search('80055512121234').groups()      </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>('800', '555', '1212', '1234')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>phonePattern.search('800.555.1212
x1234').groups() </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>('800', '555', '1212', '1234')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>phonePattern.search('800-555-1212').groups()        </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>('800', '555', '1212', '')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>phonePattern.search('(800)5551212 x1234')           </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9316;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.95in;margin-bottom:
31.25pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;</span>&nbsp;</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.5pt;margin-bottom:.15pt;
margin-left:16.65pt;text-indent:-16.65pt;line-height:155%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The only change
you’ve made since that last step is changing all the <span style='font-size:
10.0pt;line-height:155%;font-family:"Liberation Mono"'>+ </span>to <span
style='font-size:10.0pt;line-height:155%;font-family:"Liberation Mono"'>*</span>.
Instead of <span style='font-size:10.0pt;line-height:155%;font-family:"Liberation Mono"'>\D+
</span>between the parts of the phone number, you now match on <span
style='font-size:10.0pt;line-height:155%;font-family:"Liberation Mono"'>\D*</span>.
Remember that <span style='font-size:10.0pt;line-height:155%;font-family:"Liberation Mono"'>+
</span>means “1 or more”? Well, <span style='font-size:10.0pt;line-height:155%;
font-family:"Liberation Mono"'>* </span>means “zero or more”. So now you should
be able to parse phone numbers even when there is no separator character at
all.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.5pt;margin-bottom:.25pt;
margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Lo and behold, it actually works. Why? You matched the beginning of the
string, then a remembered group of three digits (<span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>800</span>), then zero
non-numeric characters, then a remembered group of three digits (<span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>555</span>),
then zero non-numeric characters, then a remembered group of four digits (<span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>1212</span>),
then zero non-numeric characters, then a remembered group of an arbitrary
number of digits (<span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>1234</span>), then the end of the string.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.5pt;margin-bottom:.25pt;
margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Other variations
work now too: dots instead of hyphens, and both a space and an <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>x </span>before
the extension.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.5pt;margin-bottom:.25pt;
margin-left:16.65pt;text-indent:-16.65pt;line-height:151%'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Finally, you’ve
solved the other long-standing problem: extensions are optional again. If no
extension is found, the <span style='font-size:10.0pt;line-height:151%;
font-family:"Liberation Mono"'>groups() </span>method still returns a tuple of
four elements, but the fourth element is just an empty string.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.5pt;margin-bottom:20.55pt;
margin-left:16.65pt;text-indent:-16.65pt'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>I hate to be the bearer of bad news, but you’re not finished yet. What’s
the problem here? There’s an extra character before the area code, but the
regular expression assumes that the area code is the first thing at the
beginning of the string. No problem, you can use the same technique of “zero or
more non-numeric characters” to skip over the leading characters before the
area code.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
24.15pt;margin-left:16.4pt'>The next example shows how to handle leading
characters in phone numbers.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.9pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>phonePattern
= re.compile(r'^\D*(\d{3})\D*(\d{3})\D*(\d{4})\D*(\d*)$') </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>phonePattern.search('(800)5551212 ext.
1234').groups()                  </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>('800', '555', '1212', '1234')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>phonePattern.search('800-555-1212').groups()                            </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>('800', '555', '1212', '')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>phonePattern.search('work 1-(800) 555.1212
#1234')                      </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.95in;margin-bottom:
31.15pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;</span>&nbsp;</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.25pt;
margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>This is the same as in the previous example, except now you’re matching <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>\D*</span>,
zero or more non-numeric characters, before the first remembered group (the
area code). Notice that you’re not remembering these non-numeric characters
(they’re not in parentheses). If you find them, you’ll just skip over them and
then start remembering the area code whenever you get to it.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.25pt;
margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>You can successfully parse the phone number, even with the leading left
parenthesis before the area code. (The right parenthesis after the area code is
already handled; it’s treated as a non-numeric separator and matched by the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>\D* </span>after
the first remembered group.)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.25pt;
margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Just a sanity check to make sure you haven’t broken anything that used
to work. Since the leading characters are entirely optional, this matches the
beginning of the string, then zero non-numeric characters, then a remembered
group of three digits (<span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>800</span>), then one non-numeric character (the
hyphen), then a remembered group of three digits (<span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>555</span>), then one
non-numeric character (the hyphen), then a remembered group of four digits (<span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>1212</span>),
then zero non-numeric characters, then a remembered group of zero digits, then
the end of the string.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.25pt;
margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>This is where regular expressions make me want to gouge my eyes out with
a blunt object. Why doesn’t this phone number match? Because there’s a <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>1 </span>before
the area code, but you assumed that all the leading characters before the area
code were non-numeric characters (<span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>\D*</span>). Aargh.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:23.25pt;
margin-left:16.4pt'>Let’s back up for a second. So far the regular expressions
have all matched from the beginning of the string. But now you see that there
may be an indeterminate amount of stuff at the beginning of the string that you
want to ignore. Rather than trying to match it all just so you can skip over
it, let’s take a different approach: don’t explicitly match the beginning of
the string at all. This approach is shown in the next example.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.9pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>phonePattern
= re.compile(r'(\d{3})\D*(\d{3})\D*(\d{4})\D*(\d*)$') </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>phonePattern.search('work 1-(800) 555.1212
#1234').groups()         </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>('800', '555', '1212', '1234')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>phonePattern.search('800-555-1212')                                 </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>('800', '555', '1212', '')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>phonePattern.search('80055512121234')                               </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.1pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>('800', '555', '1212', '1234')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:15.25pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Note the lack of <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>^ </span>in this regular expression. You are not
matching the beginning of the string anymore. There’s nothing that says you
need to match the entire input with your regular expression. The regular
expression engine will do the hard work of figuring out where the input string
starts to match, and go from there.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:15.25pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Now you can successfully parse a phone number that includes leading
characters and a leading digit, plus any number of any kind of separators
around each part of the phone number.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:15.25pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Sanity check.
This still works.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:15.25pt;margin-bottom:
21.45pt;margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>That still works too.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.55pt;margin-left:16.4pt'>See how quickly a regular expression can get out of
control? Take a quick glance at any of the previous iterations. Can you tell
the difference between one and the next?</p>

<p class=MsoNormal style='margin-left:16.4pt'>While you still understand the
final answer (and it is the final answer; if you’ve discovered a case it
doesn’t handle, I don’t want to know about it), let’s write it out as a verbose
regular expression, before you forget why you made the choices you made.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>phonePattern
= re.compile(r'''</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:74.45pt;margin-bottom:
0in;margin-left:62.15pt;text-indent:1.0in;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'># don't
match beginning of string, number can start anywhere (\d{3})     # area code is
3 digits (e.g. '800') \D*         # optional separator is any number of
non-digits (\d{3})     # trunk is 3 digits (e.g. '555')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:182.45pt;margin-bottom:
0in;margin-left:62.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>\D*         # optional
separator (\d{4})     # rest of number is 4 digits (e.g. '1212')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:104.45pt;margin-bottom:
0in;margin-left:62.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>\D*         # optional
separator (\d*)       # extension is optional and can be any number of digits
$           # end of string</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>''', re.VERBOSE)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>phonePattern.search('work
1-(800) 555.1212 #1234').groups() </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>('800', '555', '1212', '1234')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>phonePattern.search('800-555-1212')                          </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>('800', '555', '1212', '')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:15.25pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Other than being spread out over multiple lines, this is exactly the
same regular expression as the last step, so it’s no surprise that it parses
the same inputs.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:15.25pt;margin-bottom:
46.55pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Final sanity check. Yes, this still works. You’re done.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:3.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h3 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>5.7.
S</span>UMMARY</h3>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:20.55pt;
margin-left:16.4pt'>This is just the tiniest tip of the iceberg of what regular
expressions can do. In other words, even though you’re completely overwhelmed
by them now, believe me, you ain’t seen nothing yet.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.55pt;margin-left:16.4pt'>You should now be familiar with the following
techniques:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.2pt;margin-left:16.65pt;text-indent:-12.25pt;line-height:107%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>^ </span>matches
the beginning of a string.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.3pt;margin-left:16.65pt;text-indent:-12.25pt;line-height:107%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>$ </span>matches
the end of a string.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-12.25pt;line-height:107%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>\b </span>matches
a word boundary.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.25pt;margin-left:16.65pt;text-indent:-12.25pt;line-height:107%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>\d </span>matches
any numeric digit.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.25pt;margin-left:16.65pt;text-indent:-12.25pt;line-height:107%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>\D </span>matches
any non-numeric character.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.4pt;margin-left:16.65pt;text-indent:-12.25pt;line-height:107%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>x? </span>matches
an optional <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>x
</span>character (in other words, it matches an <span style='font-size:10.0pt;
line-height:107%;font-family:"Liberation Mono"'>x </span>zero or one times).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.4pt;margin-left:16.65pt;text-indent:-12.25pt;line-height:107%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>x* </span>matches
<span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>x
</span>zero or more times.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.5pt;margin-left:16.65pt;text-indent:-12.25pt;line-height:107%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>x+ </span>matches
<span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>x
</span>one or more times.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
7.1pt;margin-left:16.65pt;text-indent:-12.25pt;line-height:107%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>x{n,m} </span>matches
an <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>x
</span>character at least <span style='font-size:10.0pt;line-height:107%;
font-family:"Liberation Mono"'>n </span>times, but not more than <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>m </span>times.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.35pt;margin-left:16.65pt;text-indent:-12.25pt;line-height:107%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>(a|b|c)
</span>matches either <span style='font-size:10.0pt;line-height:107%;
font-family:"Liberation Mono"'>a </span>or <span style='font-size:10.0pt;
line-height:107%;font-family:"Liberation Mono"'>b </span>or <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>c</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.45pt;margin-left:16.65pt;text-indent:-12.25pt'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span><span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>(x)
</span>in general is a <i>remembered group</i>. You can get the value of what
matched by using the <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>groups() </span>method of the object returned by <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>re.search</span>.</p>

<p class=MsoNormal style='margin-left:16.4pt'>Regular expressions are extremely
powerful, but they are not the correct solution for every problem. You should
learn enough about them to know when they are appropriate, when they will solve
your problems, and when they will cause more problems than they solve.<br
clear=all style='page-break-before:always'>
</p>

<h2 style='margin-top:0in;margin-right:22.2pt;margin-bottom:0in;margin-left:
16.4pt;line-height:107%'><span style='font-size:24.0pt;line-height:107%'>C</span><span
style='font-size:19.0pt;line-height:107%'>HAPTER </span><span style='font-size:
24.0pt;line-height:107%'>6. C</span><span style='font-size:19.0pt;line-height:
107%'>LOSURES </span><i><sub><span style='font-size:19.0pt;line-height:107%;
font-weight:normal'>&amp; </span></sub></i><span style='font-size:24.0pt;
line-height:107%'>G</span><span style='font-size:19.0pt;line-height:107%'>ENERATORS</span></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:39.9pt;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=736 height=4 id="Group 657232"
src="Dive%20Into%20Python%203_files/image001.gif"></span></p>

<p class=MsoNormal align=right style='margin-top:0in;margin-right:0in;
margin-bottom:65.45pt;margin-left:81.5pt;text-align:right;line-height:160%'><span
style='font-size:13.0pt;line-height:160%;font-family:"Calibri",sans-serif'>&#10077;
</span><i>My spelling is Wobbly. It’s good spelling but it Wobbles, and the
letters get in the wrong places. </i><span style='font-size:13.0pt;line-height:
160%;font-family:"Calibri",sans-serif'>&#10078; </span><i>— Winnie-the-Pooh</i></p>

<h3 style='margin-top:0in;margin-right:0in;margin-bottom:65.5pt;margin-left:
16.4pt'><span style='font-size:18.0pt;line-height:112%'>6.1. D</span>IVING <span
style='font-size:18.0pt;line-height:112%'>I</span>N</h3>

<p class=MsoNormal style='margin-top:0in;margin-right:7.9pt;margin-bottom:20.1pt;
margin-left:16.4pt'><span style='font-size:48.0pt;line-height:154%;font-family:
"DejaVu Serif",serif;color:#888888'>H </span>aving grown up the son of a
librarian and an English major, I have always been fascinated by languages. Not
programming languages. Well yes, programming languages, but also natural
languages. Take English. English is a schizophrenic language that borrows words
from German, French, Spanish, and Latin (to name a few). Actually, “borrows” is
the wrong word; “pillages” is more like it. Or perhaps “assimilates” — like the
Borg. Yes, I like that.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.35pt;
margin-left:20.1pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>We are the Borg. Your linguistic and
etymological distinctiveness will be added to our own.</span></p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:142.6pt;
margin-bottom:31.6pt;margin-left:159.7pt;text-align:center;line-height:110%'><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>Resistance
is futile.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.65pt;margin-bottom:
20.55pt;margin-left:16.4pt'>In this chapter, you’re going to learn about plural
nouns. Also, functions that return other functions, advanced regular
expressions, and generators. But first, let’s talk about how to make plural
nouns. (If you haven’t read <u>the chapter on regular expressions</u>, now
would be a good time. This chapter assumes you understand the basics of regular
expressions, and it quickly descends into more advanced uses.)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:20.55pt;
margin-left:16.4pt'>If you grew up in an English-speaking country or learned
English in a formal school setting, you’re probably familiar with the basic
rules:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.3pt;margin-bottom:6.0pt;
margin-left:16.65pt;text-indent:-12.25pt;line-height:107%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>If a word ends
in S, X, or Z, add ES. <i>Bass </i>becomes <i>basses</i>, <i>fax </i>becomes <i>faxes</i>,
and <i>waltz </i>becomes <i>waltzes</i>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.3pt;margin-bottom:.25pt;
margin-left:16.65pt;text-indent:-12.25pt'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>If a word ends in a noisy H, add ES; if it ends in a silent H, just add
S. What’s a noisy H? One that gets combined with other letters to make a sound
that you can hear. So <i>coach </i>becomes <i>coaches </i>and <i>rash </i>becomes
<i>rashes</i>, because you can hear the CH and SH sounds when you say them. But
<i>cheetah </i>becomes <i>cheetahs</i>, because the H is silent.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.3pt;margin-bottom:.25pt;
margin-left:16.65pt;text-indent:-12.25pt'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>If a word ends in Y that sounds like I, change the Y to IES; if the Y is
combined with a vowel to sound like something else, just add S. So <i>vacancy </i>becomes
<i>vacancies</i>, but <i>day </i>becomes <i>days</i>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.3pt;margin-bottom:21.45pt;
margin-left:16.65pt;text-indent:-12.25pt'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>If all else fails, just add S and hope for the best.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.4pt;margin-bottom:20.55pt;
margin-left:16.4pt'>(I know, there are a lot of exceptions. <i>Man </i>becomes <i>men
</i>and <i>woman </i>becomes <i>women</i>, but <i>human </i>becomes <i>humans</i>.
<i>Mouse </i>becomes <i>mice </i>and <i>louse </i>becomes <i>lice</i>, but <i>house
</i>becomes <i>houses</i>. <i>Knife </i>becomes <i>knives </i>and <i>wife </i>becomes
<i>wives</i>, but <i>lowlife </i>becomes <i>lowlifes</i>. And don’t even get me
started on words that are their own plural, like <i>sheep</i>, <i>deer</i>, and
<i>haiku</i>.)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.45pt;margin-left:16.4pt'>Other languages, of course, are completely
different.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:45.7pt;
margin-left:16.4pt'>Let’s design a Python library that automatically pluralizes
English nouns. We’ll start with just these four rules, but keep in mind that
you’ll inevitably need to add more.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:3.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:17.35pt;
margin-left:16.4pt;line-height:112%'><b><span style='font-size:18.0pt;
line-height:112%;font-family:"DejaVu Serif",serif'>6.2. I K</span></b><b><span
style='font-size:14.5pt;line-height:112%;font-family:"DejaVu Serif",serif'>NOW</span></b><b><span
style='font-size:18.0pt;line-height:112%;font-family:"DejaVu Serif",serif'>, L</span></b><b><span
style='font-size:14.5pt;line-height:112%;font-family:"DejaVu Serif",serif'>ET</span></b><b><span
style='font-size:18.0pt;line-height:112%;font-family:"DejaVu Serif",serif'>’</span></b><b><span
style='font-size:14.5pt;line-height:112%;font-family:"DejaVu Serif",serif'>S </span></b><b><span
style='font-size:18.0pt;line-height:112%;font-family:"DejaVu Serif",serif'>U</span></b><b><span
style='font-size:14.5pt;line-height:112%;font-family:"DejaVu Serif",serif'>SE </span></b><b><span
style='font-size:18.0pt;line-height:112%;font-family:"DejaVu Serif",serif'>R</span></b><b><span
style='font-size:14.5pt;line-height:112%;font-family:"DejaVu Serif",serif'>EGULAR
</span></b><b><span style='font-size:18.0pt;line-height:112%;font-family:"DejaVu Serif",serif'>E</span></b><b><span
style='font-size:14.5pt;line-height:112%;font-family:"DejaVu Serif",serif'>XPRESSIONS</span></b><b><span
style='font-size:18.0pt;line-height:112%;font-family:"DejaVu Serif",serif'>!</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:4.5pt;margin-bottom:.25pt;
margin-left:16.4pt'>So you’re looking at words, which, at least in English,
means you’re looking at strings of characters. You have rules that say you need
to find different combinations of characters, then do different things to them.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>This sounds like a job for regular
expressions!</p>

<p class=MsoNormal style='margin-top:0in;margin-right:428.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:370%'><span style='font-size:10.0pt;
line-height:370%;font-family:"Liberation Mono"'>import re def plural(noun):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:219.65pt;margin-bottom:
.3pt;margin-left:62.65pt;line-height:182%'><span style='font-size:10.0pt;
line-height:182%;font-family:"Liberation Mono"'>if re.search('[sxz]$', noun):   </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312; </span><span
style='font-size:10.0pt;line-height:182%;font-family:"Liberation Mono"'>return
re.sub('$', 'es', noun)   </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9313; </span><span style='font-size:10.0pt;line-height:182%;
font-family:"Liberation Mono"'>elif re.search('[^aeioudgkprt]h$', noun):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:278.45pt;margin-bottom:
0in;margin-left:62.15pt;text-indent:24.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>return
re.sub('$', 'es', noun) elif re.search('[^aeiou]y$', noun):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:260.45pt;margin-bottom:
0in;margin-left:62.15pt;text-indent:24.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>return
re.sub('y$', 'ies', noun) else:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:86.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>return noun + 's'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:15.25pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>This is a regular expression, but it uses a syntax you didn’t see in <i><u>Regular
Expressions</u></i>. The square brackets mean “match exactly one of these
characters.” So <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>[sxz] </span>means “<span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>s</span>, or <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>x</span>,
or <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>z</span>”,
but only one of them. The <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>$ </span>should be familiar; it matches the end
of string. Combined, this regular expression tests whether <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>noun </span>ends
with <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>s</span>,
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>x</span>,
or <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>z</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:15.25pt;margin-bottom:
21.5pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>This <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>re.sub()
</span>function performs regular expression-based string substitutions.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.9pt;margin-left:16.4pt'>Let’s look at regular expression substitutions in
more detail.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>import
re</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>re.search('[abc]', 'Mark')    </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;_sre.SRE_Match object at 0x001C1FA8&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>re.sub('[abc]',
'o', 'Mark') </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'Mork'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>re.sub('[abc]',
'o', 'rock') </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'rook'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>re.sub('[abc]',
'o', 'caps') </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.6pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'oops'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.75pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Does the string <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>Mark </span>contain
<span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>a</span>,
<span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>b</span>,
or <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>c</span>?
Yes, it contains <span style='font-size:10.0pt;line-height:107%;font-family:
"Liberation Mono"'>a</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.75pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>OK, now find <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>a</span>,
<span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>b</span>,
or <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>c</span>,
and replace it with <span style='font-size:10.0pt;line-height:107%;font-family:
"Liberation Mono"'>o</span>. <span style='font-size:10.0pt;line-height:107%;
font-family:"Liberation Mono"'>Mark </span>becomes <span style='font-size:10.0pt;
line-height:107%;font-family:"Liberation Mono"'>Mork</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The same
function turns <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>rock
</span>into <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>rook</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.9pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:155%'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>You might think
this would turn <span style='font-size:10.0pt;line-height:155%;font-family:
"Liberation Mono"'>caps </span>into <span style='font-size:10.0pt;line-height:
155%;font-family:"Liberation Mono"'>oaps</span>, but it doesn’t. <span
style='font-size:10.0pt;line-height:155%;font-family:"Liberation Mono"'>re.sub </span>replaces
<i>all </i>of the matches, not just the first one. So this regular expression
turns <span style='font-size:10.0pt;line-height:155%;font-family:"Liberation Mono"'>caps
</span>into <span style='font-size:10.0pt;line-height:155%;font-family:"Liberation Mono"'>oops</span>,
because both the <span style='font-size:10.0pt;line-height:155%;font-family:
"Liberation Mono"'>c </span>and the <span style='font-size:10.0pt;line-height:
155%;font-family:"Liberation Mono"'>a </span>get turned into <span
style='font-size:10.0pt;line-height:155%;font-family:"Liberation Mono"'>o</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.95pt;margin-left:16.4pt'>And now, back to the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>plural() </span>function…</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def plural(noun):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>if re.search('[sxz]$', noun):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:213.65pt;margin-bottom:
4.45pt;margin-left:62.15pt;text-indent:24.0pt;line-height:182%'><span
style='font-size:10.0pt;line-height:182%;font-family:"Liberation Mono"'>return
re.sub('$', 'es', noun)    </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9312; </span><span style='font-size:10.0pt;line-height:182%;
font-family:"Liberation Mono"'>elif re.search('[^aeioudgkprt]h$', noun): </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313; </span><span
style='font-size:10.0pt;line-height:182%;font-family:"Liberation Mono"'>return
re.sub('$', 'es', noun)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:237.65pt;margin-bottom:
0in;margin-left:62.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>elif re.search('[^aeiou]y$',
noun):  </span><span style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;
</span><span style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>return
re.sub('y$', 'ies', noun) else:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.25pt;
margin-left:86.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>return noun + 's'</span></p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Here, you’re
replacing the end of the string (matched by <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>$</span>) with the string <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>es</span>.
In other words, adding <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>es </span>to the string. You could accomplish
the same thing with string concatenation, for example <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>noun + 'es'</span>, but
I chose to use regular expressions for each rule, for reasons that will become
clear later in the chapter.</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Look closely,
this is another new variation. The <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>^ </span>as the first character inside the
square brackets means something special: negation. <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>[^abc] </span>means “any single
character <i>except </i><span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>a</span>, <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>b</span>, or <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>c</span>”.
So <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>[^aeioudgkprt]
</span>means any character except <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>a</span>, <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>e</span>, <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>i</span>,
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>o</span>,
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>u</span>,
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>d</span>,
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>g</span>,
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>k</span>,
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>p</span>,
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>r</span>,
or <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>t</span>.
Then that character needs to be followed by <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>h</span>, followed by end of
string. You’re looking for words that end in H where the H can be heard.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.05pt;
margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Same pattern
here: match words that end in Y, where the character before the Y is <i>not </i><span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>a</span>,
<span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>e</span>,
<span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>i</span>,
<span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>o</span>,
or <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>u</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.45pt;margin-left:16.4pt'>You’re looking for words that end in Y that sounds
like I.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>Let’s look at negation regular
expressions in more detail.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>import
re</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>re.search('[^aeiou]y$',
'vacancy') </span><span style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;_sre.SRE_Match object at 0x001C1FA8&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>re.search('[^aeiou]y$', 'boy')      </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.95in;margin-bottom:
8.5pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;</span>&nbsp;</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>re.search('[^aeiou]y$',
'day')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.95in;margin-bottom:
12.7pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;</span>&nbsp;</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>re.search('[^aeiou]y$', 'pita')     </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.95in;margin-bottom:
31.7pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;</span>&nbsp;</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.25pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>vacancy
</span>matches this regular expression, because it ends in <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>cy</span>,
and <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>c
</span>is not <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>a</span>,
<span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>e</span>,
<span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>i</span>,
<span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>o</span>,
or <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>u</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span><span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>boy
</span>does not match, because it ends in <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>oy</span>, and you specifically
said that the character before the <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>y </span>could not be <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>o</span>.
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>day
</span>does not match, because it ends in <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>ay</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
24.1pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span><span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>pita
</span>does not match, because it does not end in <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>y</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>re.sub('y$', 'ies', 'vacancy')               </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'vacancies'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>re.sub('y$',
'ies', 'agency')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'agencies'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>re.sub('([^aeiou])y$',
r'\1ies', 'vacancy') </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:32.15pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'vacancies'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.0pt;margin-bottom:.25pt;
margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>This regular expression turns <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>vacancy </span>into <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>vacancies </span>and <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>agency </span>into
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>agencies</span>,
which is what you wanted. Note that it would also turn <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>boy </span>into <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>boies</span>,
but that will never happen in the function because you did that <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>re.search
</span>first to find out whether you should do this <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>re.sub</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.0pt;margin-bottom:.25pt;
margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Just in passing, I want to point out that it is possible to combine
these two regular expressions (one to find out if the rule applies, and another
to actually apply it) into a single regular expression. Here’s what that would
look like. Most of it should look familiar: you’re using a remembered group,
which you learned in <u>Case study: Parsing Phone Numbers</u>. The group is
used to remember the character before the letter <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>y</span>. Then in the
substitution string, you use a new syntax, <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>\1</span>, which means “hey,
that first group you remembered? put it right here.” In this case, you remember
the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>c
</span>before the <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>y</span>; when you do the substitution, you substitute <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>c </span>in
place of <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>c</span>,
and <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>ies
</span>in place of <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>y</span>. (If you have more than one remembered group, you
can use <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>\2
</span>and <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>\3
</span>and so on.)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.1pt;margin-bottom:45.7pt;
margin-left:16.4pt'>Regular expression substitutions are extremely powerful,
and the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>\1
</span>syntax makes them even more powerful. But combining the entire operation
into one regular expression is also much harder to read, and it doesn’t
directly map to the way you first described the pluralizing rules. You
originally laid out rules like “if the word ends in S, X, or Z, then add ES”.
If you look at this function, you have two lines of code that say “if the word
ends in S, X, or Z, then add ES”. It doesn’t get much more direct than that.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:3.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h3 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>6.3.
A L</span>IST <span style='font-size:18.0pt;line-height:112%'>O</span>F <span
style='font-size:18.0pt;line-height:112%'>F</span>UNCTIONS</h3>

<p class=MsoNormal style='margin-left:16.4pt'>Now you’re going to add a level
of abstraction. You started by defining a list of rules: if this, do that,
otherwise go to the next rule. Let’s temporarily complicate part of the program
so you can simplify another part.<br clear=all style='page-break-before:always'>
</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>import re</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:314.45pt;margin-bottom:
21.0pt;margin-left:61.4pt;text-indent:-24.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>def
match_sxz(noun): return re.search('[sxz]$', noun)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:326.45pt;margin-bottom:
21.0pt;margin-left:61.4pt;text-indent:-24.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>def
apply_sxz(noun): return re.sub('$', 'es', noun)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:254.45pt;margin-bottom:
21.0pt;margin-left:61.4pt;text-indent:-24.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>def
match_h(noun): return re.search('[^aeioudgkprt]h$', noun)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def apply_h(noun):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:16.85pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>return re.sub('$', 'es', noun)</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=406
 style='width:304.8pt;margin-left:38.15pt;border-collapse:collapse'>
 <tr style='height:49.8pt'>
  <td width=376 valign=top style='width:282.05pt;padding:0in 0in 0in 0in;
  height:49.8pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>def match_y(noun):</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
  margin-left:24.0pt;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>return
  re.search('[^aeiou]y$', noun)</span></p>
  </td>
  <td width=30 valign=top style='width:22.75pt;padding:0in 0in 0in 0in;
  height:49.8pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>
  </td>
 </tr>
 <tr style='height:190.5pt'>
  <td width=376 style='width:282.05pt;padding:0in 0in 0in 0in;height:190.5pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>def apply_y(noun):</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.75pt;
  margin-left:24.0pt;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>return re.sub('y$',
  'ies', noun)</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:102.05pt;margin-bottom:
  21.0pt;margin-left:24.0pt;text-indent:-24.0pt;line-height:185%'><span
  style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>def
  match_default(noun): return True</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:102.05pt;margin-bottom:
  0in;margin-left:24.0pt;text-indent:-24.0pt;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>def
  apply_default(noun): return noun + 's'</span></p>
  </td>
  <td width=30 valign=top style='width:22.75pt;padding:0in 0in 0in 0in;
  height:190.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>
  </td>
 </tr>
 <tr style='height:159.0pt'>
  <td width=376 valign=bottom style='width:282.05pt;padding:0in 0in 0in 0in;
  height:159.0pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>rules = ((match_sxz,
  apply_sxz),</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:48.05pt;margin-bottom:
  0in;margin-left:.75in;text-indent:0in;line-height:185%'><span
  style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>(match_h,
  apply_h), (match_y, apply_y), (match_default, apply_default)</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.75pt;
  margin-left:.75in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>)</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>def
  plural(noun):</span></p>
  </td>
  <td width=30 valign=top style='width:22.75pt;padding:0in 0in 0in 0in;
  height:159.0pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>
  </td>
 </tr>
 <tr style='height:18.3pt'>
  <td width=376 valign=bottom style='width:282.05pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal align=center style='margin-top:0in;margin-right:6.05pt;
  margin-bottom:0in;margin-left:0in;text-align:center;text-indent:0in;
  line-height:107%'><span style='font-size:10.0pt;line-height:107%;font-family:
  "Liberation Mono"'>for matches_rule, apply_rule in rules:</span></p>
  </td>
  <td width=30 valign=top style='width:22.75pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
  margin-left:12.0pt;text-indent:0in;line-height:107%'><span style='font-family:
  "DejaVu Sans",sans-serif;color:#222222'>&#9315;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:86.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>if matches_rule(noun):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.45pt;
margin-left:110.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>return apply_rule(noun)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.35pt;
margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Now, each match
rule is its own function which returns the results of calling the <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>re.search()
</span>function.</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Each apply rule
is also its own function which calls the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>re.sub() </span>function to
apply the appropriate pluralization rule.</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Instead of
having one function (<span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>plural()</span>) with multiple rules, you have the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>rules </span>data
structure, which is a sequence of pairs of functions.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:20.45pt;
margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Since the rules have been broken out into a separate data structure, the
new <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>plural()
</span>function can be reduced to a few lines of code. Using a <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>for </span>loop,
you can pull out the match and apply rules two at a time (one match, one apply)
from the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>rules
</span>structure. On the first iteration of the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>for </span>loop, <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>matches_rule
</span>will get <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>match_sxz</span>, and <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>apply_rule </span>will get <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>apply_sxz</span>.
On the second iteration (assuming you get that far), <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>matches_rule </span>will
be assigned <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>match_h</span>,
and <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>apply_rule
</span>will be assigned <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>apply_h</span>. The function is guaranteed to
return something eventually, because the final match rule (<span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>match_default</span>)
simply returns <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>True</span>,
meaning the corresponding apply rule (<span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>apply_default</span>) will always be
applied.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.3pt;margin-left:16.4pt'><img width=298 height=1
src="Dive%20Into%20Python%203_files/image033.gif" align=left hspace=12>The
reason this technique works is that <u>everything in Python is an object</u>,
including functions. The <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>rules </span>data structure contains functions —
not names of functions, but actual function objects. When they get assigned in
the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>for
</span>loop, then <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>matches_rule </span>and <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>apply_rule </span>are actual
functions that you can call. On the first iteration of the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>for </span>loop,
this is equivalent to calling <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>matches_sxz(noun)</span>, and if it returns a
match, calling <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>apply_sxz(noun)</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>If this additional level of abstraction is confusing,
try unrolling the function to see the equivalence. The entire <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>for </span>loop
is equivalent to the following:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def plural(noun):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:62.65pt;line-height:185%'><img width=298 height=1
src="Dive%20Into%20Python%203_files/image033.gif" align=left hspace=12><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>if
match_sxz(noun): return apply_sxz(noun) if match_h(noun): return apply_h(noun)
if match_y(noun):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:62.15pt;text-indent:24.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>return
apply_y(noun) if match_default(noun):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.65pt;
margin-left:86.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>return apply_default(noun)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:22.55pt;margin-bottom:
20.55pt;margin-left:16.4pt'>The benefit here is that the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>plural()
</span>function is now simplified. It takes a sequence of rules, defined
elsewhere, and iterates through them in a generic fashion.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Get a match rule</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Does it match?
Then call the apply rule and return the result.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.8pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>No match? Go to step 1.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.5pt;margin-left:16.4pt'>The rules could be defined anywhere, in any way. The
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>plural()
</span>function doesn’t care.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:20.5pt;
margin-left:16.4pt'>Now, was adding this level of abstraction worth it? Well,
not yet. Let’s consider what it would take to add a new rule to the function.
In the first example, it would require adding an <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>if </span>statement to the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>plural()
</span>function. In this second example, it would require adding two functions,
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>match_foo()
</span>and <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>apply_foo()</span>,
and then updating the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>rules </span>sequence to specify where in the
order the new match and apply functions should be called relative to the other
rules.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
46.55pt;margin-left:16.4pt'>But this is really just a stepping stone to the
next section. Let’s move on…</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:3.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h3 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>6.4.
A L</span>IST <span style='font-size:18.0pt;line-height:112%'>O</span>F <span
style='font-size:18.0pt;line-height:112%'>P</span>ATTERNS</h3>

<p class=MsoNormal style='margin-top:0in;margin-right:10.6pt;margin-bottom:
18.8pt;margin-left:16.65pt;text-align:justify;text-justify:inter-ideograph;
text-indent:0in;line-height:204%'>Defining separate named functions for each
match and apply rule isn’t really necessary. You never call them directly; you
add them to the <span style='font-size:10.0pt;line-height:204%;font-family:
"Liberation Mono"'>rules </span>sequence and call them through there.
Furthermore, each function follows one of two patterns. All the match functions
call <span style='font-size:10.0pt;line-height:204%;font-family:"Liberation Mono"'>re.search()</span>,
and all the apply functions call <span style='font-size:10.0pt;line-height:
204%;font-family:"Liberation Mono"'>re.sub()</span>. Let’s factor out the
patterns so that defining new rules can be easier. <span style='font-size:10.0pt;
line-height:204%;font-family:"Liberation Mono"'>import re</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def
build_match_and_apply_functions(pattern, search, replace):</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=494
 style='width:5.15in;margin-left:62.15pt;border-collapse:collapse'>
 <tr style='height:39.3pt'>
  <td width=480 valign=top style='width:360.05pt;padding:0in 0in 0in 0in;
  height:39.3pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>def
  matches_rule(word):</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
  margin-left:24.0pt;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>return
  re.search(pattern, word)</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:39.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9312;</span></p>
  </td>
 </tr>
 <tr style='height:43.5pt'>
  <td width=480 valign=top style='width:360.05pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>def apply_rule(word):</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
  margin-left:24.0pt;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>return re.sub(search,
  replace, word)</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9313;</span></p>
  </td>
 </tr>
 <tr style='height:18.3pt'>
  <td width=480 valign=bottom style='width:360.05pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>return
  (matches_rule, apply_rule)</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9314;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:.35pt;margin-bottom:.25pt;
margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span><span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>build_match_and_apply_functions()
</span>is a function that builds other functions dynamically. It takes <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>pattern</span>,
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>search
</span>and <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>replace</span>,
then defines a <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>matches_rule()
</span>function which calls <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>re.search() </span>with the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>pattern
</span>that was passed to the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>build_match_and_apply_functions() </span>function,
and the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>word
</span>that was passed to the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>matches_rule() </span>function you’re building.
Whoa.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.35pt;margin-bottom:.25pt;
margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Building the apply function works the same way. The apply function is a
function that takes one parameter, and calls <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>re.sub() </span>with the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>search </span>and
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>replace
</span>parameters that were passed to the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>build_match_and_apply_functions()
</span>function, and the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>word </span>that was passed to the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>apply_rule()
</span>function you’re building. This technique of using the values of outside
parameters within a dynamic function is called <i>closures</i>. You’re
essentially defining constants within the apply function you’re building: it
takes one parameter (<span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>word</span>), but it then acts on that plus two other values
(<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>search
</span>and <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>replace</span>)
which were set when you defined the apply function.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.35pt;margin-bottom:20.35pt;
margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Finally, the <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>build_match_and_apply_functions() </span>function returns a
tuple of two values: the two functions you just created. The constants you
defined within those functions (<span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>pattern </span>within the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>matches_rule()
</span>function, and <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>search </span>and <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>replace </span>within the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>apply_rule()
</span>function) stay with those functions, even after you return from <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>build_match_and_apply_functions()</span>.
That’s insanely cool.</p>

<p class=MsoNormal style='margin-left:16.4pt'>If this is incredibly confusing
(and it should be, this is weird stuff), it may become clearer when you see how
to use it.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>patterns
= \                                                        </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>(</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:188.45pt;margin-bottom:
0in;margin-left:62.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>('[sxz]$',           '$', 
'es'), ('[^aeioudgkprt]h$', '$',  'es'),</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>('(qu|[^aeiou])y$',  'y$', 'ies'),</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                            </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>('$',               
'$',  's')                                 </span><span style='font-family:
"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:111.65pt;margin-bottom:
0in;margin-left:37.4pt;text-indent:12.0pt;line-height:180%'><span
style='font-size:10.0pt;line-height:180%;font-family:"Liberation Mono"'>) rules
= [build_match_and_apply_functions(pattern, search, replace) </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:92.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>for (pattern, search, replace) in patterns]</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.35pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Our pluralization “rules” are now defined as a tuple of tuples of <i>strings
</i>(not functions). The first string in each group is the regular expression
pattern that you would use in <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>re.search() </span>to see if this rule matches.
The second and third strings in each group are the search and replace
expressions you would use in <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>re.sub() </span>to actually apply the rule to
turn a noun into its plural.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.35pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>There’s a slight change here, in the fallback rule. In the previous
example, the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>match_default()
</span>function simply returned <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>True</span>, meaning that if none of the more
specific rules matched, the code would simply add an <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>s </span>to the end of
the given word. This example does something functionally equivalent. The final
regular expression asks whether the word has an end (<span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>$ </span>matches the end
of a string). Of course, every string has an end, even an empty string, so this
expression always matches. Thus, it serves the same purpose as the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>match_default()
</span>function that always returned <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>True</span>: it ensures that if no more
specific rule matches, the code adds an <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>s </span>to the end of the
given word.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.35pt;margin-bottom:
.1in;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>This line is
magic. It takes the sequence of strings in <span style='font-size:10.0pt;
line-height:107%;font-family:"Liberation Mono"'>patterns </span>and turns them
into a sequence of functions.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:20.85pt;
margin-left:16.4pt'>How? By “mapping” the strings to the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>build_match_and_apply_functions()
</span>function. That is, it takes each triplet of strings and calls the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>build_match_and_apply_functions()
</span>function with those three strings as arguments. The <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>build_match_and_apply_functions()
</span>function returns a tuple of two functions. This means that <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>rules </span>ends
up being functionally equivalent to the previous example: a list of tuples,
where each tuple is a pair of functions. The first function is the match
function that calls <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>re.search()</span>, and the second function is the apply
function that calls <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>re.sub()</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>Rounding out this version of the
script is the main entry point, the <span style='font-size:10.0pt;line-height:
107%;font-family:"Liberation Mono"'>plural() </span>function.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def plural(noun):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:243.65pt;margin-bottom:
0in;margin-left:86.15pt;text-indent:-24.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>for
matches_rule, apply_rule in rules: </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9312; </span><span style='font-size:10.0pt;line-height:185%;
font-family:"Liberation Mono"'>if matches_rule(noun):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.25pt;
margin-left:110.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>return apply_rule(noun)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:45.65pt;
margin-left:16.65pt;text-indent:-16.65pt'>1.   Since the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>rules </span>list
is the same as the previous example (really, it is), it should come as no
surprise that the <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>plural() </span>function hasn’t changed at all. It’s
completely generic; it takes a list of rule functions and calls them in order.
It doesn’t care how the rules are defined. In the previous example, they were
defined as separate named functions. Now they are built dynamically by mapping
the output of the <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>build_match_and_apply_functions() </span>function onto a
list of raw strings. It doesn’t matter; the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>plural() </span>function still
works the same way.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:3.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h3 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>6.5.
A F</span>ILE <span style='font-size:18.0pt;line-height:112%'>O</span>F <span
style='font-size:18.0pt;line-height:112%'>P</span>ATTERNS</h3>

<p class=MsoNormal style='margin-top:0in;margin-right:1.8pt;margin-bottom:20.55pt;
margin-left:16.4pt'>You’ve factored out all the duplicate code and added enough
abstractions so that the pluralization rules are defined in a list of strings.
The next logical step is to take these strings and put them in a separate file,
where they can be maintained separately from the code that uses them.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
18.9pt;margin-left:16.4pt'>First, let’s create a text file that contains the
rules you want. No fancy data structures, just whitespacedelimited strings in
three columns. Let’s call it <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>plural4-rules.txt</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:266.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>[sxz]$               $    es
[^aeioudgkprt]h$     $    es</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>[^aeiou]y$          y$    ies</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>$                    $    s</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>Now let’s see how you can use this
rules file.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:135.65pt;margin-bottom:
0in;margin-left:37.9pt;line-height:221%'><span style='font-size:10.0pt;
line-height:221%;font-family:"Liberation Mono"'>import re def
build_match_and_apply_functions(pattern, search, replace): </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312; </span><span
style='font-size:10.0pt;line-height:221%;font-family:"Liberation Mono"'>def
matches_rule(word): return re.search(pattern, word) def apply_rule(word):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:86.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>return re.sub(search, replace, word)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>return (matches_rule, apply_rule)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>rules = []</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:99.65pt;margin-bottom:
0in;margin-left:61.4pt;text-indent:-24.0pt;line-height:180%'><span
style='font-size:10.0pt;line-height:180%;font-family:"Liberation Mono"'>with
open('plural4-rules.txt', encoding='utf-8') as pattern_file: </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313; </span><span
style='font-size:10.0pt;line-height:180%;font-family:"Liberation Mono"'>for
line in pattern_file:    </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9314; </span><span style='font-size:10.0pt;line-height:180%;
font-family:"Liberation Mono"'>pattern, search, replace = line.split(None, 3) </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9315; </span><span
style='font-size:10.0pt;line-height:180%;font-family:"Liberation Mono"'>rules.append(build_match_and_apply_functions(     </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9316;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:32.2pt;
margin-left:134.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>pattern, search, replace))</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.2pt;margin-bottom:.25pt;
margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>build_match_and_apply_functions()
</span>function has not changed. You’re still using closures to build two
functions dynamically that use variables defined in the outer function.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.2pt;margin-bottom:.25pt;
margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The global <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>open() </span>function opens a file and returns a file
object. In this case, the file we’re opening contains the pattern strings for
pluralizing nouns. The <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>with </span>statement creates what’s called a <i>context</i>:
when the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>with
</span>block ends, Python will automatically close the file, even if an
exception is raised inside the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>with </span>block.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.85pt;margin-left:16.4pt;line-height:107%'>You’ll learn more about <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>with </span>blocks
and file objects in the <u>Files </u>chapter.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.2pt;margin-bottom:.25pt;
margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>for
line in &lt;fileobject&gt; </span>idiom reads data from the open file, one line
at a time, and assigns the text to the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>line </span>variable. You’ll
learn more about reading from files in the <u>Files </u>chapter.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.2pt;margin-bottom:1.3pt;
margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Each line in the file really has three values, but they’re separated by
whitespace (tabs or spaces, it makes no difference). To split it out, use the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>split()
</span>string method. The first argument to the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>split() </span>method is <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>None</span>,
which means “split on any whitespace (tabs or spaces, it makes no difference).”
The second argument is <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>3</span>, which means “split on whitespace 3
times, then leave the rest of the line alone.” A line like <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>[sxz]$
$ es </span>will be broken up into the list <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>['[sxz]$', '$', 'es']</span>,
which means that <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>pattern </span>will get <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>'[sxz]$'</span>, <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>search </span>will
get <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>'$'</span>,
and <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>replace
</span>will get <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>'es'</span>. That’s a lot of power in one little line of
code.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.2pt;margin-bottom:.25pt;
margin-left:16.65pt;text-indent:-16.65pt'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Finally, you pass <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>pattern</span>, <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>search</span>, and <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>replace
</span>to the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>build_match_and_apply_functions()
</span>function, which returns a tuple of functions. You append this tuple to
the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>rules
</span>list, and <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>rules </span>ends up storing the list of match and apply
functions that the <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>plural() </span>function expects.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:45.7pt;
margin-left:16.4pt'>The improvement here is that you’ve completely separated
the pluralization rules into an external file, so it can be maintained
separately from the code that uses it. Code is code, data is data, and life is
good.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:3.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h3 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>6.6.
G</span>ENERATORS</h3>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:19.0pt;
margin-left:16.4pt'>Wouldn’t it be grand to have a generic <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>plural()
</span>function that parses the rules file? Get rules, check for a match, apply
appropriate transformation, go to next rule. That’s all the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>plural()
</span>function has to do, and that’s all the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>plural() </span>function should
do.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def rules(rules_filename):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>with open(rules_filename, encoding='utf-8')
as pattern_file:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:86.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>for line in pattern_file:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:110.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>pattern, search, replace = line.split(None,
3)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:110.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>yield
build_match_and_apply_functions(pattern, search, replace)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def plural(noun,
rules_filename='plural5-rules.txt'):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>for matches_rule, apply_rule in
rules(rules_filename):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:86.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>if matches_rule(noun):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:110.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>return apply_rule(noun)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>raise ValueError('no matching rule for
{0}'.format(noun))</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>How the heck does <i>that </i>work?
Let’s look at an interactive example first.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>def
make_counter(x):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:284.45pt;margin-bottom:
3.9pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>...   </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>print('entering
make_counter') </span><span style='font-size:10.0pt;line-height:185%;
font-family:"Liberation Mono";color:#666677'>...      </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>while
True:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>...         </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>yield x                    </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>...         </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>print('incrementing x')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>...         </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>x = x + 1</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.95in;margin-bottom:
12.65pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#666677'>...</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.55pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>counter = make_counter(2)          </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>counter                            </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.55pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;generator object at 0x001C9C10&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>next(counter)                      </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:398.45pt;margin-bottom:
4.0pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>entering make_counter 2</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>next(counter)                      </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9316;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:440.45pt;margin-bottom:
4.0pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>incrementing x 3</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>next(counter)                      </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9317;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:440.45pt;margin-bottom:
23.15pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>incrementing x 4</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.35pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The presence of the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>yield </span>keyword in <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>make_counter </span>means
that this is not a normal function. It is a special kind of function which
generates values one at a time. You can think of it as a resumable function.
Calling it will return a <i>generator </i>that can be used to generate
successive values of <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>x</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.35pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>To create an instance of the <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>make_counter </span>generator, just call it
like any other function. Note that this does not actually execute the function
code. You can tell this because the first line of the <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>make_counter() </span>function
calls <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>print()</span>,
but nothing has been printed yet.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.35pt;margin-bottom:
6.4pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>make_counter()
</span>function returns a generator object.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.35pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>next()
</span>function takes a generator object and returns its next value. The first
time you call <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>next()
</span>with the <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>counter </span>generator, it executes the code in <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>make_counter()
</span>up to the first <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>yield </span>statement, then returns the value
that was yielded. In this case, that will be <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>2</span>, because you
originally created the generator by calling <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>make_counter(2)</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.35pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Repeatedly calling <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>next() </span>with the same generator object
resumes exactly where it left off and continues until it hits the next <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>yield </span>statement.
All variables, local state, <i><span style='font-size:13.0pt;line-height:154%;
font-family:"DejaVu Serif",serif'>&amp;</span></i>c. are saved on <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>yield </span>and
restored on <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>next()</span>.
The next line of code waiting to be executed calls <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>print()</span>, which prints <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>incrementing
x</span>. After that, the statement <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>x = x + 1</span>. Then it loops through the
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>while
</span>loop again, and the first thing it hits is the statement <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>yield x</span>,
which saves the state of everything and returns the current value of <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>x </span>(now
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>3</span>).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.35pt;margin-bottom:
21.9pt;margin-left:16.65pt;text-indent:-16.65pt'>6.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The second time you call <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>next(counter)</span>, you do all the same things
again, but this time <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>x </span>is now <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>4</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:22.2pt;
margin-left:16.4pt'>Since <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>make_counter </span>sets up an infinite loop,
you could theoretically do this forever, and it would just keep incrementing <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>x </span>and
spitting out values. But let’s look at more productive uses of generators
instead.</p>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:22.8pt;margin-left:
16.4pt;line-height:110%'><span style='font-size:13.0pt;line-height:110%'>6.6.1.
A F</span><span style='font-size:10.5pt;line-height:110%'>IBONACCI </span><span
style='font-size:13.0pt;line-height:110%'>G</span><span style='font-size:10.5pt;
line-height:110%'>ENERATOR</span></h4>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.45pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def fib(max):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                            </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>a, b =
0, 1          </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.25pt;
margin-left:62.65pt;line-height:110%'><img width=298 height=1
src="Dive%20Into%20Python%203_files/image033.gif" align=left hspace=12><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>while a
&lt; max:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:18.5pt;
margin-left:86.7pt;line-height:179%'><span style='font-size:10.0pt;line-height:
179%;font-family:"Liberation Mono"'>yield a   </span><span style='font-family:
"DejaVu Sans",sans-serif;color:#222222'>&#9313; </span><span style='font-size:
10.0pt;line-height:179%;font-family:"Liberation Mono"'>a, b = b, a + b </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The Fibonacci sequence is a sequence of numbers where each number is the
sum of the two numbers before it. It starts with 0 and <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>1</span>, goes up slowly
at first, then more and more rapidly. To start the sequence, you need two
variables: <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>a
</span>starts at 0, and <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>b </span>starts at <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>1</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.15pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>a </span>is
the current number in the sequence, so yield it.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.55pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span><span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>b
</span>is the next number in the sequence, so assign that to <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>a</span>,
but also calculate the next value (<span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>a + b</span>) and assign that to <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>b </span>for
later use. Note that this happens in parallel; if <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>a </span>is <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>3 </span>and
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>b
</span>is <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>5</span>,
then <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>a,
b = b, a + b </span>will set <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>a </span>to <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>5 </span>(the previous value of
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>b</span>)
and <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>b
</span>to <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>8
</span>(the sum of the previous values of <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>a </span>and <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>b</span>).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:166.95pt;margin-bottom:
.25pt;margin-left:16.4pt'>So you have a function that spits out successive
Fibonacci numbers. Sure, you could do that with recursion, but this way is
easier to read. Also, it works well with <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>for </span>loops.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.6pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>from
fibonacci import fib</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.75pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>for n in fib(1000):      </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>...     </span><span style='font-size:10.0pt;line-height:110%;
font-family:"Liberation Mono"'>print(n, end=' ')    </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.55pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>0 1 1 2 3 5 8 13 21 34 55 89 144 233 377
610 987</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>list(fib(1000))          </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>[0, 1, 1, 2, 3, 5, 8, 13, 21, 34, 55, 89,
144, 233, 377, 610, 987]</span></p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>You can use a
generator like <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>fib()
</span>in a <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>for
</span>loop directly. The <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>for </span>loop will automatically call the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>next() </span>function
to get values from the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>fib() </span>generator and assign them to the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>for </span>loop
index variable (<span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>n</span>).</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Each time
through the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>for
</span>loop, <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>n
</span>gets a new value from the <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>yield </span>statement in <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>fib()</span>,
and all you have to do is print it out. Once <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>fib() </span>runs out of
numbers (<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>a
</span>becomes bigger than <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>max</span>, which in this case is <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>1000</span>),
then the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>for
</span>loop exits gracefully.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:22.1pt;
margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>This is a useful idiom: pass a generator to the <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>list() </span>function,
and it will iterate through the entire generator (just like the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>for </span>loop
in the previous example) and return a list of all the values.</p>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:25.25pt;margin-left:
16.4pt;line-height:110%'><span style='font-size:13.0pt;line-height:110%'>6.6.2.
A P</span><span style='font-size:10.5pt;line-height:110%'>LURAL </span><span
style='font-size:13.0pt;line-height:110%'>R</span><span style='font-size:10.5pt;
line-height:110%'>ULE </span><span style='font-size:13.0pt;line-height:110%'>G</span><span
style='font-size:10.5pt;line-height:110%'>ENERATOR</span></h4>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.9pt;margin-left:16.4pt'>Let’s go back to <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>plural5.py </span>and see how
this version of the <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>plural() </span>function works.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def rules(rules_filename):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>with open(rules_filename, encoding='utf-8')
as pattern_file:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:86.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>for line in pattern_file:</span></p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:42.65pt;
margin-bottom:16.75pt;margin-left:95.7pt;text-align:center;line-height:180%'><span
style='font-size:10.0pt;line-height:180%;font-family:"Liberation Mono"'>pattern,
search, replace = line.split(None, 3)    </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9312; </span><span style='font-size:10.0pt;line-height:180%;
font-family:"Liberation Mono"'>yield build_match_and_apply_functions(pattern,
search, replace) </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def plural(noun,
rules_filename='plural5-rules.txt'):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:45.65pt;margin-bottom:
0in;margin-left:86.15pt;text-indent:-24.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>for
matches_rule, apply_rule in rules(rules_filename):  </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314; </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>if
matches_rule(noun):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:110.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>return apply_rule(noun)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>raise ValueError('no matching rule for
{0}'.format(noun))</span></p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>No magic here.
Remember that the lines of the rules file have three values separated by
whitespace, so you use <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>line.split(None, 3) </span>to get the three
“columns” and assign them to three local variables.</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><i>And then you
yield. </i>What do you yield? Two functions, built dynamically with your old
friend, <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>build_match_and_apply_functions()</span>,
which is identical to the previous examples. In other words, <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>rules()
</span>is a generator that spits out match and apply functions <i>on demand</i>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:20.8pt;
margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Since <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>rules()
</span>is a generator, you can use it directly in a <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>for </span>loop. The
first time through the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>for </span>loop, you will call the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>rules()
</span>function, which will open the pattern file, read the first line,
dynamically build a match function and an apply function from the patterns on
that line, and yield the dynamically built functions. The second time through
the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>for
</span>loop, you will pick up exactly where you left off in <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>rules()
</span>(which was in the middle of the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>for line in pattern_file </span>loop).
The first thing it will do is read the next line of the file (which is still
open), dynamically build another match and apply function based on the patterns
on that line in the file, and yield the two functions.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:20.95pt;
margin-left:16.4pt'>What have you gained over stage 4? Startup time. In stage
4, when you imported the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>plural4 </span>module, it read the entire
patterns file and built a list of all the possible rules, before you could even
think about calling the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>plural() </span>function. With generators, you
can do everything lazily: you read the first rule and create functions and try
them, and if that works you don’t ever read the rest of the file or create any
other functions.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:20.8pt;
margin-left:16.4pt'>What have you lost? Performance! Every time you call the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>plural()
</span>function, the <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>rules() </span>generator starts over from the beginning —
which means re-opening the patterns file and reading from the beginning, one
line at a time.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:20.55pt;
margin-left:16.4pt'>What if you could have the best of both worlds: minimal
startup cost (don’t execute any code on <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>import</span>), <i>and </i>maximum
performance (don’t build the same functions over and over again). Oh, and you
still want to keep the rules in a separate file (because code is code and data
is data), just as long as you never have to read the same line twice.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:45.55pt;
margin-left:16.4pt'>To do that, you’ll need to build your own iterator. But
before you do <i>that</i>, you need to learn about Python classes.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:3.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h3 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>6.7.
F</span>URTHER <span style='font-size:18.0pt;line-height:112%'>R</span>EADING</h3>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://www.python.org/dev/peps/pep-0255/"><span style='color:black'>PEP</span></a><u>
</u><a href="http://www.python.org/dev/peps/pep-0255/"><span style='color:black'>255:</span></a><u>
</u><a href="http://www.python.org/dev/peps/pep-0255/"><span style='color:black'>Simple</span></a><u>
</u><a href="http://www.python.org/dev/peps/pep-0255/"><span style='color:black'>Generators</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://effbot.org/zone/python-with-statement.htm"><span style='color:
black'>Understanding</span></a><u> </u><a
href="http://effbot.org/zone/python-with-statement.htm"><span style='color:
black'>Python’s</span></a><u> </u><a
href="http://effbot.org/zone/python-with-statement.htm"><span style='color:
black'>“with”</span></a><u> </u><a
href="http://effbot.org/zone/python-with-statement.htm"><span style='color:
black'>statement</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://ynniv.com/blog/2007/08/closures-in-python.html"><span
style='color:black'>Closures</span></a><u> </u><a
href="http://ynniv.com/blog/2007/08/closures-in-python.html"><span
style='color:black'>in</span></a><u> </u><a
href="http://ynniv.com/blog/2007/08/closures-in-python.html"><span
style='color:black'>Python</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://en.wikipedia.org/wiki/Fibonacci_number"><span style='color:black'>Fibonacci</span></a><u>
</u><a href="http://en.wikipedia.org/wiki/Fibonacci_number"><span
style='color:black'>numbers</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://www2.gsu.edu/~wwwesl/egw/crump.htm"><span style='color:black'>English</span></a><u>
</u><a href="http://www2.gsu.edu/~wwwesl/egw/crump.htm"><span style='color:
black'>Irregular</span></a><u> </u><a
href="http://www2.gsu.edu/~wwwesl/egw/crump.htm"><span style='color:black'>Plural</span></a><u>
</u><a href="http://www2.gsu.edu/~wwwesl/egw/crump.htm"><span style='color:
black'>Nouns</span></a><br clear=all style='page-break-before:always'>
</p>

<h2 style='margin-top:0in;margin-right:22.2pt;margin-bottom:0in;margin-left:
16.4pt;line-height:107%'><span style='font-size:24.0pt;line-height:107%'>C</span><span
style='font-size:19.0pt;line-height:107%'>HAPTER </span><span style='font-size:
24.0pt;line-height:107%'>7. C</span><span style='font-size:19.0pt;line-height:
107%'>LASSES </span><i><sub><span style='font-size:19.0pt;line-height:107%;
font-weight:normal'>&amp; </span></sub></i><span style='font-size:24.0pt;
line-height:107%'>I</span><span style='font-size:19.0pt;line-height:107%'>TERATORS</span></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:39.95pt;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=736 height=4 id="Group 660527"
src="Dive%20Into%20Python%203_files/image001.gif"></span></p>

<p class=MsoNormal align=right style='margin-top:0in;margin-right:0in;
margin-bottom:65.45pt;margin-left:229.95pt;text-align:right;line-height:160%'><span
style='font-size:13.0pt;line-height:160%;font-family:"Calibri",sans-serif'>&#10077;
</span><i>East is East, and West is West, and never the twain shall meet. </i><span
style='font-size:13.0pt;line-height:160%;font-family:"Calibri",sans-serif'>&#10078;
</span><i>— </i><a href="http://en.wikiquote.org/wiki/Rudyard_Kipling"><i><span
style='color:black'>Rudyard</span></i></a><i><u> </u></i><a
href="http://en.wikiquote.org/wiki/Rudyard_Kipling"><i><span style='color:black'>Kipling</span></i></a></p>

<h3 style='margin-top:0in;margin-right:0in;margin-bottom:67.45pt;margin-left:
16.4pt'><span style='font-size:18.0pt;line-height:112%'>7.1. D</span>IVING <span
style='font-size:18.0pt;line-height:112%'>I</span>N</h3>

<p class=MsoNormal style='margin-top:0in;margin-right:.15pt;margin-bottom:20.15pt;
margin-left:16.4pt'><span style='font-size:48.0pt;line-height:154%;font-family:
"DejaVu Serif",serif;color:#888888'>I </span>terators are the “secret sauce” of
Python 3. They’re everywhere, underlying everything, always just out of sight. <u>Comprehensions
</u>are just a simple form of <i>iterators</i>. Generators are just a simple
form of <i>iterators</i>. A function that <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>yield</span>s values is a nice,
compact way of building an iterator without building an iterator. Let me show
you what I mean by that.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>Remember <u>the Fibonacci generator</u>?
Here it is as a built-from-scratch iterator:<br clear=all style='page-break-before:
always'>
</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>class Fib:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'''iterator that yields numbers in the
Fibonacci sequence'''</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:314.45pt;margin-bottom:
21.0pt;margin-left:86.15pt;text-indent:-24.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>def
__init__(self, max): self.max = max</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:386.45pt;margin-bottom:
21.0pt;margin-left:86.15pt;text-indent:-24.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>def
__iter__(self): self.a = 0 self.b = 1 return self</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:374.45pt;margin-bottom:
0in;margin-left:86.15pt;text-indent:-24.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>def
__next__(self): fib = self.a if fib &gt; self.max:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:110.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>raise StopIteration</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:206.45pt;margin-bottom:
22.55pt;margin-left:86.7pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>self.a, self.b = self.b, self.a
+ self.b return fib</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.9pt;margin-left:16.4pt'>Let’s take that one line at a time.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.9pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>class Fib:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
46.55pt;margin-left:16.4pt'><span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>class</span>? What’s a class?</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:3.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h3 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>7.2.
D</span>EFINING <span style='font-size:18.0pt;line-height:112%'>C</span>LASSES</h3>

<p class=MsoNormal style='margin-top:0in;margin-right:.9pt;margin-bottom:.25pt;
margin-left:16.4pt'>Python is fully object-oriented: you can define your own
classes, inherit from your own or built-in classes, and instantiate the classes
you’ve defined.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.35pt;margin-bottom:
.25pt;margin-left:16.4pt'>Defining a class in Python is simple. As with
functions, there is no separate interface definition. Just define the class and
start coding. A Python class starts with the reserved word <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>class</span>,
followed by the class name.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
23.95pt;margin-left:16.4pt'>Technically, that’s all that’s required, since a
class doesn’t need to inherit from any other class.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:381.7pt;margin-bottom:
19.5pt;margin-left:61.4pt;text-indent:-24.0pt;line-height:175%'><span
style='font-size:10.0pt;line-height:175%;font-family:"Liberation Mono"'>class
PapayaWhip: </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9312; </span><span style='font-size:10.0pt;line-height:175%;
font-family:"Liberation Mono"'>pass </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:15.25pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The name of this class is <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>PapayaWhip</span>, and it doesn’t inherit
from any other class. Class names are usually capitalized, <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>EachWordLikeThis</span>,
but this is only a convention, not a requirement.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:15.25pt;margin-bottom:
21.0pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>You probably guessed this, but everything in a class is indented, just
like the code within a function, <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>if </span>statement, <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>for </span>loop,
or any other block of code. The first line not indented is outside the class.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:47.1pt;
margin-left:16.4pt'>This <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>PapayaWhip </span>class doesn’t define any
methods or attributes, but syntactically, there needs to be something in the
definition, thus the <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>pass </span>statement. This is a Python reserved word that
just means “move along, nothing to see here”. It’s a statement that does
nothing, and it’s a good placeholder when you’re stubbing out functions or
classes.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
31.4pt;margin-left:47.15pt'><span style='font-size:24.0pt;line-height:154%;
font-family:"Calibri",sans-serif'>&#9758; </span>The <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>pass </span>statement in
Python is like a empty set of curly braces (<span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>{}</span>) in Java or C.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:21.85pt;
margin-left:16.4pt'>Many classes are inherited from other classes, but this one
is not. Many classes define methods, but this one does not. There is nothing
that a Python class absolutely must have, other than a name. In particular, C++
programmers may find it odd that Python classes don’t have explicit
constructors and destructors. Although it’s not required, Python classes <i>can
</i>have something similar to a constructor: the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>__init__() </span>method.</p>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:.35in;margin-left:
16.4pt;line-height:122%'><span style='font-size:13.0pt;line-height:122%'>7.2.1.
T</span><span style='font-size:10.5pt;line-height:122%'>HE </span><span
style='font-size:13.0pt;line-height:122%;font-family:"Liberation Mono";
font-weight:normal'>__init__() </span><span style='font-size:13.0pt;line-height:
122%'>M</span><span style='font-size:10.5pt;line-height:122%'>ETHOD</span></h4>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.95pt;margin-left:16.4pt'>This example shows the initialization of the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>Fib </span>class
using the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__init__
</span>method.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>class Fib:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:30.8pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'''iterator that yields numbers in the
Fibonacci sequence''' </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                            </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>def
__init__(self, max):                                      </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:20.45pt;margin-bottom:
6.4pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Classes can (and
should) have <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>docstring</span>s
too, just like modules and functions.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:20.45pt;margin-bottom:
20.9pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__init__()
</span>method is called immediately after an instance of the class is created.
It would be tempting — but technically incorrect — to call this the
“constructor” of the class. It’s tempting, because it looks like a C++
constructor (by convention, the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>__init__() </span>method is the first method
defined for the class), acts like one (it’s the first piece of code executed in
a newly created instance of the class), and even sounds like one. Incorrect,
because the object has already been constructed by the time the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__init__()
</span>method is called, and you already have a valid reference to the new
instance of the class.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:21.1pt;
margin-left:16.4pt'>The first argument of every class method, including the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__init__()
</span>method, is always a reference to the current instance of the class. By
convention, this argument is named <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>self</span>. This argument fills the role
of the reserved word <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>this </span>in <span style='font-size:9.5pt;line-height:
154%'>C</span>++ or Java, but <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>self </span>is not a reserved word in Python,
merely a naming convention. Nonetheless, please don’t call it anything but <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>self</span>;
this is a very strong convention.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:45.65pt;
margin-left:16.4pt'>In the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>__init__() </span>method, <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>self </span>refers
to the newly created object; in other class methods, it refers to the instance
whose method was called. Although you need to specify <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>self </span>explicitly
when defining the method, you do <i>not </i>specify it when calling the method;
Python will add it for you automatically.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:3.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h3 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>7.3.
I</span>NSTANTIATING <span style='font-size:18.0pt;line-height:112%'>C</span>LASSES</h3>

<p class=MsoNormal style='margin-left:16.4pt'>Instantiating classes in Python
is straightforward. To instantiate a class, simply call the class as if it were
a function, passing the arguments that the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>__init__() </span>method
requires. The return value will be the newly created object.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>import
fibonacci2</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.35pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>fib =
fibonacci2.Fib(100) </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>fib                        </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.55pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;fibonacci2.Fib object at 0x00DB8810&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>fib.__class__              </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.5pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;class 'fibonacci2.Fib'&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>fib.__doc__                </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.5pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'iterator that yields numbers in the
Fibonacci sequence'</span></p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>You are creating
an instance of the <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>Fib </span>class (defined in the <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>fibonacci2 </span>module)
and assigning the newly created instance to the variable <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>fib</span>.
You are passing one parameter, <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>100</span>, which will end up as the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>max </span>argument
in <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>Fib</span>’s
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__init__()
</span>method.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.35pt;
margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>fib </span>is
now an instance of the <span style='font-size:10.0pt;line-height:107%;
font-family:"Liberation Mono"'>Fib </span>class.</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Every class
instance has a built-in attribute, <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>__class__</span>, which is the object’s
class. Java programmers may be familiar with the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>Class </span>class, which
contains methods like <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>getName() </span>and <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>getSuperclass() </span>to
get metadata information about an object. In Python, this kind of metadata is
available through attributes, but the idea is the same.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:46.55pt;
margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>You can access the instance’s <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>docstring </span>just as with a function or
a module. All instances of a class share the same <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>docstring</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:44.3pt;margin-bottom:
40.5pt;margin-left:75.95pt;text-indent:-29.3pt;line-height:191%'><span
style='font-size:24.0pt;line-height:191%;font-family:"Calibri",sans-serif'>&#9758;
</span>In Python, simply call a class as if it were a function to create a new
instance of the class. There is no explicit <span style='font-size:10.0pt;
line-height:191%;font-family:"Liberation Mono"'>new </span>operator like there
is in <span style='font-size:9.5pt;line-height:191%'>C</span>++ or Java.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:3.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h3 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>7.4.
I</span>NSTANCE <span style='font-size:18.0pt;line-height:112%'>V</span>ARIABLES</h3>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>On to the next line:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>class Fib:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.5pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def __init__(self, max):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:28.6pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                                      </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>self.max
= max        </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:19.0pt;
margin-left:16.65pt;text-indent:-16.65pt'>1.   What is <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>self.max</span>? It’s an
instance variable. It is completely separate from <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>max</span>, which was passed
into the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__init__()
</span>method as an argument. <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>self.max </span>is “global” to the instance.
That means that you can access it from other methods.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>class Fib:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.5pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def __init__(self, max):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                                      </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>self.max
= max        </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:494.45pt;margin-bottom:
0in;margin-left:62.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>. .</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def __next__(self):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:339.7pt;margin-bottom:
19.8pt;margin-left:86.7pt;line-height:179%'><span style='font-size:10.0pt;
line-height:179%;font-family:"Liberation Mono"'>fib = self.a if fib &gt;
self.max: </span><span style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.75pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>self.max
</span>is defined in the <span style='font-size:10.0pt;line-height:107%;
font-family:"Liberation Mono"'>__init__() </span>method…</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.55pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>…and referenced in the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>__next__() </span>method.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:19.0pt;
margin-left:16.4pt'>Instance variables are specific to one instance of a class.
For example, if you create two <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>Fib </span>instances with different maximum
values, they will each remember their own values.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>import
fibonacci2</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:332.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>fib1 =
fibonacci2.Fib(100) </span><span style='font-size:10.0pt;line-height:185%;
font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>fib2 =
fibonacci2.Fib(200)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>fib1.max</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>100</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>fib2.max</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:56.15pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>200</span></p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:3.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h3 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>7.5.
A F</span>IBONACCI <span style='font-size:18.0pt;line-height:112%'>I</span>TERATOR</h3>

<p class=MsoNormal style='margin-left:16.4pt;line-height:107%'><i>Now </i>you’re
ready to learn how to build an iterator. An iterator is just a class that
defines an <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>__iter__()</span></p>

</div>

<span style='font-size:12.0pt;line-height:154%;font-family:"Gill Sans MT",sans-serif;
color:black'><br clear=all style='page-break-before:auto'>
</span>

<div class=WordSection12>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
12.9pt;margin-left:16.4pt;line-height:107%'>method.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=414
 style='width:310.8pt;margin-left:38.15pt;border-collapse:collapse'>
 <tr style='height:18.3pt'>
  <td width=400 valign=top style='width:300.05pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>class
  Fib:</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9312;</span></p>
  </td>
 </tr>
 <tr style='height:.75in'>
  <td width=400 valign=top style='width:300.05pt;padding:0in 0in 0in 0in;
  height:.75in'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:24.0pt;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>def __init__(self,
  max):</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
  margin-left:48.0pt;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>self.max = max</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:.75in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9313;</span></p>
  </td>
 </tr>
 <tr style='height:106.5pt'>
  <td width=400 style='width:300.05pt;padding:0in 0in 0in 0in;height:106.5pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:156.05pt;margin-bottom:
  0in;margin-left:48.0pt;text-indent:-24.0pt;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>def
  __iter__(self): self.a = 0 self.b = 1 return self</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:106.5pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9314;</span></p>
  </td>
 </tr>
 <tr style='height:75.0pt'>
  <td width=400 valign=bottom style='width:300.05pt;padding:0in 0in 0in 0in;
  height:75.0pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:144.05pt;margin-bottom:
  0in;margin-left:48.0pt;text-indent:-24.0pt;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>def
  __next__(self): fib = self.a if fib &gt; self.max:</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:75.0pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9315;</span></p>
  </td>
 </tr>
 <tr style='height:18.3pt'>
  <td width=400 valign=bottom style='width:300.05pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
  margin-left:1.0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>raise StopIteration</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9316;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.4pt;
margin-left:86.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>self.a, self.b = self.b, self.a + self.b</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:28.4pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                                      </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>return
fib                                </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9317;</span></p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>To build an
iterator from scratch, <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>fib </span>needs to be a class, not a function.</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>“Calling” <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>Fib(max)
</span>is really creating an instance of this class and calling its <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__init__()
</span>method with <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>max</span>. The <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>__init__() </span>method saves the maximum
value as an instance variable so other methods can refer to it later.</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__iter__()
</span>method is called whenever someone calls <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>iter(fib)</span>. (As you’ll
see in a minute, a <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>for </span>loop will call this automatically, but you can
also call it yourself manually.) After performing beginning-of-iteration
initialization (in this case, resetting</p>

<p class=MsoNormal align=right style='margin-top:0in;margin-right:.1pt;
margin-bottom:.15pt;margin-left:.5pt;text-align:right;line-height:110%'><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>self.a </span>and
<span style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>self.b</span>,
our two counters), the <span style='font-size:10.0pt;line-height:110%;
font-family:"Liberation Mono"'>__iter__() </span>method can</p>

<p class=MsoNormal style='margin-left:-.25pt;line-height:152%'><span
style='font-family:"DejaVu Serif",serif;color:white'>All three of these class
methods,</span></p>

<p class=MsoNormal style='margin-left:-.25pt;line-height:152%'><span
style='font-family:"Liberation Mono";color:white'>__init__</span><span
style='font-family:"DejaVu Serif",serif;color:white'>, </span><span
style='font-family:"Liberation Mono";color:white'>__iter__</span><span
style='font-family:"DejaVu Serif",serif;color:white'>, and </span><span
style='font-family:"Liberation Mono";color:white'>__next__</span><span
style='font-family:"DejaVu Serif",serif;color:white'>, begin and end with a
pair of underscore (</span><span style='font-family:"Liberation Mono";
color:white'>_</span><span style='font-family:"DejaVu Serif",serif;color:white'>)
characters. Why is that? There’s nothing magical about it, but it usually
indicates that these are “special methods.”</span></p>

<p class=MsoNormal style='margin-left:-.25pt;line-height:152%'><span
style='position:relative;z-index:-1895780352'><span style='left:0px;position:
absolute;left:-29px;top:-141071px;width:242px;height:1px'><img width=242
height=1 src="Dive%20Into%20Python%203_files/image042.gif"></span></span><span
style='font-family:"DejaVu Serif",serif;color:white'>The only thing “special”
about special methods is that they aren’t called directly; Python calls them
when you use some other syntax on the class or an instance of the class. <u>More
about special methods</u>.</span></p>

</div>

<span style='font-size:12.0pt;line-height:154%;font-family:"Gill Sans MT",sans-serif;
color:black'><br clear=all style='page-break-before:auto'>
</span>

<div class=WordSection13>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>return any object that implements a <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__next__()
</span>method. In this case (and in most cases), <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>__iter__() </span>simply
returns <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>self</span>,
since this class implements its own <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>__next__() </span>method.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__next__()
</span>method is called whenever someone calls <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>next() </span>on an iterator of
an instance of a class. That will make more sense in a minute.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>When the <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>__next__() </span>method raises a <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>StopIteration </span>exception,
this signals to the caller that the iteration is exhausted. Unlike most
exceptions, this is not an error; it’s a normal condition that just means that
the iterator has no more values to generate. If the caller is a <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>for </span>loop,
it will notice this <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>StopIteration </span>exception and gracefully exit the loop.
(In other words, it will swallow the exception.) This little bit of magic is
actually the key to using iterators in <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>for </span>loops.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.55pt;margin-left:16.65pt;text-indent:-16.65pt'>6.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>To spit out the next value, an iterator’s <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>__next__() </span>method simply
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>return</span>s
the value. Do not use <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>yield </span>here; that’s a bit of syntactic
sugar that only applies when you’re using generators. Here you’re creating your
own iterator from scratch; use <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>return </span>instead.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.9pt;margin-left:16.4pt'>Thoroughly confused yet? Excellent. Let’s see how to
call this iterator:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:362.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>from
fibonacci2 import Fib </span><span style='font-size:10.0pt;line-height:185%;
font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>for n
in Fib(1000):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>...     </span><span style='font-size:10.0pt;line-height:110%;
font-family:"Liberation Mono"'>print(n, end=' ')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>0 1 1 2 3 5 8 13 21 34 55 89 144 233 377
610 987</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.75pt;margin-left:16.4pt'>Why, it’s exactly the same! Byte for byte identical
to how you called <u>Fibonacci-as-a-generator </u>(modulo one capital letter).
But how?</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
22.4pt;margin-left:16.4pt'>There’s a bit of magic involved in <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>for </span>loops.
Here’s what happens:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.6pt;margin-left:16.65pt;text-indent:-12.25pt;line-height:107%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>for </span>loop
calls <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>Fib(1000)</span>,
as shown. This returns an instance of the <span style='font-size:10.0pt;
line-height:107%;font-family:"Liberation Mono"'>Fib </span>class. Call this <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>fib_inst</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-12.25pt'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Secretly, and quite cleverly, the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>for </span>loop calls <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>iter(fib_inst)</span>,
which returns an iterator object. Call this <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>fib_iter</span>. In this case, <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>fib_iter
</span>== <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>fib_inst</span>,
because the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__iter__()
</span>method returns <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>self</span>, but the <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>for </span>loop doesn’t
know (or care) about that.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-12.25pt'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>To “loop through” the iterator, the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>for </span>loop calls <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>next(fib_iter)</span>,
which calls the <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>__next__() </span>method on the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>fib_iter </span>object, which
does the next-Fibonacci-number calculations and returns a value. The <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>for </span>loop
takes this value and assigns it to <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>n</span>, then executes the body of the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>for </span>loop
for that value of <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>n</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.55pt;margin-left:16.65pt;text-indent:-12.25pt;line-height:107%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>How does the <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>for </span>loop
know when to stop? I’m glad you asked! When <span style='font-size:10.0pt;
line-height:107%;font-family:"Liberation Mono"'>next(fib_iter) </span>raises a</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'><span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>StopIteration </span>exception, the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>for </span>loop
will swallow the exception and gracefully exit. (Any other exception will pass
through and be raised as usual.) And where have you seen a <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>StopIteration
</span>exception? In the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>__next__() </span>method, of course!</p>

<p class=MsoNormal align=right style='margin-top:0in;margin-right:293.25pt;
margin-bottom:33.0pt;margin-left:.5pt;text-align:right;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h3 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>7.6.
A P</span>LURAL <span style='font-size:18.0pt;line-height:112%'>R</span>ULE <span
style='font-size:18.0pt;line-height:112%'>I</span>TERATOR</h3>

<p class=MsoNormal style='margin-top:0in;margin-right:297.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>Now it’s time for the finale. Let’s rewrite the <u>plural
rules generator </u>as an iterator.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:345.15pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=298 height=394 src="Dive%20Into%20Python%203_files/image043.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>class LazyRules:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>rules_filename = 'plural6-rules.txt'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:134.45pt;margin-bottom:
21.0pt;margin-left:86.15pt;text-indent:-24.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>def
__init__(self): self.pattern_file = open(self.rules_filename, encoding='utf-8')
self.cache = []</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:356.45pt;margin-bottom:
21.0pt;margin-left:86.15pt;text-indent:-24.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>def
__iter__(self): self.cache_index = 0 return self</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def __next__(self):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:278.45pt;margin-bottom:
0in;margin-left:86.7pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>self.cache_index += 1 if
len(self.cache) &gt;= self.cache_index:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:110.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>return self.cache[self.cache_index - 1]</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:86.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>if self.pattern_file.closed:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:110.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>raise StopIteration</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:290.45pt;margin-bottom:
0in;margin-left:86.7pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>line =
self.pattern_file.readline() if not line:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:308.45pt;margin-bottom:
21.0pt;margin-left:110.7pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>self.pattern_file.close() raise
StopIteration</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:224.45pt;margin-bottom:
0in;margin-left:86.7pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>pattern, search, replace =
line.split(None, 3) funcs = build_match_and_apply_functions( pattern, search,
replace)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:332.45pt;margin-bottom:
21.0pt;margin-left:86.7pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>self.cache.append(funcs) return
funcs</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.8pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>rules = LazyRules()</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>So this is a class that implements <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__iter__()
</span>and <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__next__()</span>,
so it can be used as an iterator. Then, you instantiate the class and assign it
to <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>rules</span>.
This happens just once, on import.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.9pt;margin-left:16.4pt'>Let’s take the class one bite at a time.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>class LazyRules:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:302.45pt;margin-bottom:
0in;margin-left:62.65pt;line-height:370%'><span style='font-size:10.0pt;
line-height:370%;font-family:"Liberation Mono"'>rules_filename =
'plural6-rules.txt' def __init__(self):</span></p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:81.65pt;
margin-bottom:18.85pt;margin-left:56.7pt;text-align:center;line-height:179%'><span
style='font-size:10.0pt;line-height:179%;font-family:"Liberation Mono"'>self.pattern_file
= open(self.rules_filename, encoding='utf-8') </span><span style='font-family:
"DejaVu Sans",sans-serif;color:#222222'>&#9312; </span><span style='font-size:
10.0pt;line-height:179%;font-family:"Liberation Mono"'>self.cache = []   </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>When we instantiate the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>LazyRules </span>class, open the pattern file
but don’t read anything from it. (That comes later.)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.45pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>After opening the patterns file, initialize the cache. You’ll use this
cache later (in the <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>__next__() </span>method) as you read lines from the pattern
file.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>Before we continue, let’s take a closer look at <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>rules_filename</span>.
It’s not defined within the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>__iter__() </span>method. In fact, it’s not
defined within <i>any </i>method. It’s defined at the class level. It’s a <i>class
variable</i>, and although you can access it just like an instance variable (<span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>self.rules_filename</span>),
it is shared across all instances of the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>LazyRules </span>class.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>import
plural6</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>r1 =
plural6.LazyRules()</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.6pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>r2 =
plural6.LazyRules()</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>r1.rules_filename                               </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'plural6-rules.txt'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>r2.rules_filename</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'plural6-rules.txt'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>r2.rules_filename = 'r2-override.txt'           </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>r2.rules_filename</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'r2-override.txt'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>r1.rules_filename</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'plural6-rules.txt'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>r2.__class__.rules_filename                     </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'plural6-rules.txt'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>r2.__class__.rules_filename
= 'papayawhip.txt' </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>r1.rules_filename</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.6pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'papayawhip.txt'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>r2.rules_filename                               </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9316;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.6pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'r2-overridetxt'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Each instance of
the class inherits the <span style='font-size:10.0pt;line-height:107%;
font-family:"Liberation Mono"'>rules_filename </span>attribute with the value
defined by the class.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Changing the
attribute’s value in one instance does not affect other instances…</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>…nor does it change the class attribute. You can access the class
attribute (as opposed to an individual instance’s attribute) by using the
special <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__class__
</span>attribute to access the class itself.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.15pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>If you change
the class attribute, all instances that are still inheriting that value (like <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>r1 </span>here)
will be affected.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.5pt;margin-left:16.65pt;text-indent:-16.65pt'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Instances that have overridden that attribute (like <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>r2 </span>here)
will not be affected.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
23.95pt;margin-left:16.4pt'>And now back to our show.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:273.7pt;margin-bottom:
3.9pt;margin-left:86.15pt;text-indent:-24.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>def
__iter__(self): </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9312; </span><span style='font-size:10.0pt;line-height:185%;
font-family:"Liberation Mono"'>self.cache_index = 0</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.1pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                                      </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>return
self           </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:32.2pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>__iter__()
</span>method will be called every time someone — say, a <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>for </span>loop
— calls <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>iter(rules)</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:32.2pt;margin-bottom:
23.05pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The one thing that every <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>__iter__() </span>method must do is return an
iterator. In this case, it returns <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>self</span>, which signals that this class
defines a <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__next__()
</span>method which will take care of returning values throughout the
iteration.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                            </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>def
__next__(self):                                 </span><span style='font-family:
"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:86.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:500.45pt;margin-bottom:
0in;margin-left:86.7pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>. .</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:206.45pt;margin-bottom:
4.4pt;margin-left:86.7pt;line-height:182%'><span style='font-size:10.0pt;
line-height:182%;font-family:"Liberation Mono"'>pattern, search, replace =
line.split(None, 3) funcs = build_match_and_apply_functions(  </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313; </span><span
style='font-size:10.0pt;line-height:182%;font-family:"Liberation Mono"'>pattern,
search, replace)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                                      </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>self.cache.append(funcs)                        </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.95pt;
margin-left:86.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>return funcs</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__next__()
</span>method gets called whenever someone — say, a <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>for </span>loop — calls <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>next(rules)</span>.
This method will only make sense if we start at the end and work backwards. So
let’s do that.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The last part of this function should look familiar, at least. The <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>build_match_and_apply_functions()
</span>function hasn’t changed; it’s the same as it ever was.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.4pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The only difference is that, before returning the match and apply
functions (which are stored in the tuple <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>funcs</span>), we’re going to
save them in <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>self.cache</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.9pt;margin-left:16.4pt'>Moving backwards…</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def __next__(self):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:86.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:500.45pt;margin-bottom:
4.15pt;margin-left:86.7pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>. .</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:267.65pt;margin-bottom:
0in;margin-left:86.7pt;line-height:178%'><span style='font-size:10.0pt;
line-height:178%;font-family:"Liberation Mono"'>line =
self.pattern_file.readline() </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9312; </span><span style='font-size:10.0pt;line-height:178%;
font-family:"Liberation Mono"'>if not line: </span><span style='font-family:
"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.6pt;
margin-left:110.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>self.pattern_file.close()</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                                                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>raise
StopIteration              </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:86.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:86.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:86.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>A bit of advanced file trickery here. The <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>readline() </span>method (note:
singular, not the plural <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>readlines()</span>) reads exactly one line from
an open file. Specifically, the next line. (<i>File objects are iterators too!
It’s iterators all the way down…</i>)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>If there was a line for <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>readline() </span>to read, <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>line </span>will
not be an empty string. Even if the file contained a blank line, <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>line </span>would
end up as the one-character string <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>'\n' </span>(a carriage return). If <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>line </span>is
really an empty string, that means there are no more lines to read from the
file.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.85pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>When we reach the end of the file, we should close the file and raise
the magic <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>StopIteration
</span>exception. Remember, we got to this point because we needed a match and
apply function for the next rule. The next rule comes from the next line of the
file… but there is no next line! Therefore, we have no value to return. The
iteration is over. (<span style='font-family:"Calibri",sans-serif'>&#9835; </span>The
party’s over… <span style='font-family:"Calibri",sans-serif'>&#9835;</span>)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.95pt;margin-left:16.4pt'>Moving backwards all the way to the start of the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__next__()
</span>method…</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def __next__(self):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:278.45pt;margin-bottom:
4.2pt;margin-left:86.7pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>self.cache_index += 1 if
len(self.cache) &gt;= self.cache_index:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:26.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                                                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>return
self.cache[self.cache_index - 1]     </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.6pt;
margin-left:86.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>if self.pattern_file.closed:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                                                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>raise
StopIteration                         </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:86.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:500.45pt;margin-bottom:
22.9pt;margin-left:86.7pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>. .</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span><span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>self.cache
</span>will be a list of the functions we need to match and apply individual
rules. (At least <i>that </i>should sound familiar!) <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>self.cache_index </span>keeps
track of which cached item we should return next. If we haven’t exhausted the
cache yet (<i>i.e. </i>if the length of <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>self.cache </span>is greater
than <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>self.cache_index</span>),
then we have a cache hit! Hooray! We can return the match and apply functions
from the cache instead of building them from scratch.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>On the other hand, if we don’t get a hit from the cache, <i>and </i>the
file object has been closed (which could happen, further down the method, as
you saw in the previous code snippet), then there’s nothing more we can do. If
the file is closed, it means we’ve exhausted it — we’ve already read through
every line from the pattern file, and we’ve already built and cached the match
and apply functions for each pattern. The file is exhausted; the cache is
exhausted; I’m exhausted. Wait, what? Hang in there, we’re almost done.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.95pt;margin-left:16.4pt'>Putting it all together, here’s what happens when:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-12.25pt'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>When the module is imported, it creates a single instance of the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>LazyRules
</span>class, called <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>rules</span>, which opens the pattern file but does not read
from it.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-12.25pt'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>When asked for the first match and apply function, it checks its cache
but finds the cache is empty. So it reads a single line from the pattern file,
builds the match and apply functions from those patterns, and caches them.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-12.25pt'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Let’s say, for the sake of argument, that the very first rule matched.
If so, no further match and apply functions are built, and no further lines are
read from the pattern file.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-12.25pt'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Furthermore, for the sake of argument, suppose that the caller calls the
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>plural()
</span>function <i>again </i>to pluralize a different word. The <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>for </span>loop
in the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>plural()
</span>function will call <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>iter(rules)</span>, which will reset the cache
index but will not reset the open file object.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-12.25pt'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The first time through, the <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>for </span>loop will ask for a value from <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>rules</span>,
which will invoke its <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>__next__() </span>method. This time, however,
the cache is primed with a single pair of match and apply functions,
corresponding to the patterns in the first line of the pattern file. Since they
were built and cached in the course of pluralizing the previous word, they’re
retrieved from the cache. The cache index increments, and the open file is
never touched.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-12.25pt'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Let’s say, for the sake of argument, that the first rule does <i>not </i>match
this time around. So the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>for </span>loop comes around again and asks for
another value from <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>rules</span>. This invokes the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>__next__() </span>method a
second time. This time, the cache is exhausted — it only contained one item,
and we’re asking for a second — so the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>__next__() </span>method
continues. It reads another line from the open file, builds match and apply
functions out of the patterns, and caches them.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.55pt;margin-left:16.65pt;text-indent:-12.25pt'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>This read-build-and-cache process will continue as long as the rules
being read from the pattern file don’t match the word we’re trying to
pluralize. If we do find a matching rule before the end of the file, we simply
use it and stop, with the file still open. The file pointer will stay wherever
we stopped reading, waiting for the next <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>readline() </span>command. In
the meantime, the cache now has more items in it, and if we start all over
again trying to pluralize a new word, each of those items in the cache will be
tried before reading the next line from the pattern file.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.65pt;margin-left:16.4pt'>We have achieved pluralization nirvana.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span><b>Minimal startup cost. </b>The only thing that happens on <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>import </span>is
instantiating a single class and opening a file (but not reading from it).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span><b>Maximum performance. </b>The previous example would read through the
file and build functions dynamically every time you wanted to pluralize a word.
This version will cache functions as soon as they’re built, and in the worst
case, it will only read through the pattern file once, no matter how many words
you pluralize.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
46.9pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span><b>Separation of code and data. </b>All the patterns are stored in a
separate file. Code is code, and data is data, and never the twain shall meet.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:47.15pt;line-height:107%'><span style='font-size:24.0pt;
line-height:107%;font-family:"Calibri",sans-serif'>&#9758; </span>Is this
really nirvana? Well, yes and no. Here’s something to consider with the</p>

<p class=MsoNormal style='margin-top:0in;margin-right:82.7pt;margin-bottom:
21.1pt;margin-left:76.4pt'><span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>LazyRules </span>example: the pattern file is
opened (during <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__init__()</span>),
and it remains open until the final rule is reached. Python will eventually
close the file when it exits, or after the last instantiation of the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>LazyRules
</span>class is destroyed, but still, that could be a <i>long </i>time. If this
class is part of a long-running Python process, the Python interpreter may
never exit, and the <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>LazyRules </span>object may never get destroyed.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:92.65pt;margin-bottom:
.25pt;margin-left:76.4pt'>There are ways around this. Instead of opening the
file during <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__init__()
</span>and leaving it open while you read rules one line at a time, you could
open the file, read all the rules, and immediately close the file. Or you could
open the file, read one rule, save the file position with the <u><span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>tell() </span>method</u>,
close the file, and later re-open it and use the <u><span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>seek() </span>method </u>to
continue reading where you left off. Or you could not worry about it and just
leave the file open, like this example code does.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:66.5pt;margin-bottom:
45.7pt;margin-left:76.4pt'>Programming is design, and design is all about
trade-offs and constraints. Leaving a file open too long might be a problem;
making your code more complicated might be a problem. Which one is the bigger
problem depends on your development team, your application, and your runtime
environment.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:33.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h3 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>7.7.
F</span>URTHER <span style='font-size:18.0pt;line-height:112%'>R</span>EADING</h3>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://docs.python.org/3.1/library/stdtypes.html#iterator-types"><span
style='color:black'>Iterator</span></a><u> </u><a
href="http://docs.python.org/3.1/library/stdtypes.html#iterator-types"><span
style='color:black'>types</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://www.python.org/dev/peps/pep-0234/"><span style='color:black'>PEP</span></a><u>
</u><a href="http://www.python.org/dev/peps/pep-0234/"><span style='color:black'>234:</span></a><u>
</u><a href="http://www.python.org/dev/peps/pep-0234/"><span style='color:black'>Iterators</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://www.python.org/dev/peps/pep-0255/"><span style='color:black'>PEP</span></a><u>
</u><a href="http://www.python.org/dev/peps/pep-0255/"><span style='color:black'>255:</span></a><u>
</u><a href="http://www.python.org/dev/peps/pep-0255/"><span style='color:black'>Simple</span></a><u>
</u><a href="http://www.python.org/dev/peps/pep-0255/"><span style='color:black'>Generators</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://www.dabeaz.com/generators/"><span style='color:black'>Generator</span></a><u>
</u><a href="http://www.dabeaz.com/generators/"><span style='color:black'>Tricks</span></a><u>
</u><a href="http://www.dabeaz.com/generators/"><span style='color:black'>for</span></a><u>
</u><a href="http://www.dabeaz.com/generators/"><span style='color:black'>Systems</span></a><u>
</u><a href="http://www.dabeaz.com/generators/"><span style='color:black'>Programmers</span></a><br
clear=all style='page-break-before:always'>
</p>

<h2 style='margin-top:0in;margin-right:22.2pt;margin-bottom:0in;margin-left:
16.4pt;line-height:107%'><span style='font-size:24.0pt;line-height:107%'>C</span><span
style='font-size:19.0pt;line-height:107%'>HAPTER </span><span style='font-size:
24.0pt;line-height:107%'>8. A</span><span style='font-size:19.0pt;line-height:
107%'>DVANCED </span><span style='font-size:24.0pt;line-height:107%'>I</span><span
style='font-size:19.0pt;line-height:107%'>TERATORS</span></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:39.9pt;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=736 height=4 id="Group 667021"
src="Dive%20Into%20Python%203_files/image001.gif"></span></p>

<p class=MsoNormal align=right style='margin-top:0in;margin-right:29.3pt;
margin-bottom:6.05pt;margin-left:16.6pt;text-align:right;line-height:107%'><span
style='font-size:13.0pt;line-height:107%;font-family:"Calibri",sans-serif'>&#10077;
</span><i>Great fleas have little fleas upon their backs to bite ’em,</i></p>

<p class=MsoNormal align=right style='margin-top:0in;margin-right:29.3pt;
margin-bottom:5.2pt;margin-left:16.6pt;text-align:right;line-height:107%'><i>And
little fleas have lesser fleas, and so ad infinitum. </i><span
style='font-size:13.0pt;line-height:107%;font-family:"Calibri",sans-serif'>&#10078;</span></p>

<p class=MsoNormal align=right style='margin-top:0in;margin-right:29.3pt;
margin-bottom:65.45pt;margin-left:16.6pt;text-align:right;line-height:160%'><i>—
Augustus De Morgan</i></p>

<h3 style='margin-top:0in;margin-right:0in;margin-bottom:67.75pt;margin-left:
16.4pt'><span style='font-size:18.0pt;line-height:112%'>8.1. D</span>IVING <span
style='font-size:18.0pt;line-height:112%'>I</span>N</h3>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
11.1pt;margin-left:16.4pt;line-height:210%'><span style='font-size:48.0pt;
line-height:210%;font-family:"DejaVu Serif",serif;color:#888888'>J </span>ust
as <u>regular expressions </u>put <u>strings </u>on steroids, the <sub><span
style='font-size:15.5pt;line-height:210%;font-family:"Liberation Mono"'>itertools
</span></sub>module puts <u>iterators </u>on steroids. But first, I want to
show you a classic puzzle.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:296.45pt;margin-bottom:
21.0pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>HAWAII + IDAHO + IOWA + OHIO ==
STATES 510199 + 98153 + 9301 + 3593 == 621246</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:524.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>H = 5 A = 1 W = 0 I = 9 D = 8 O
= 3 S = 6 T = 2</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>E = 4</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>Puzzles like this are called <i>cryptarithms </i>or <i>alphametics</i>.
The letters spell out actual words, but if you replace each letter with a digit
from <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>0–9</span>,
it also “spells” an arithmetic equation. The trick is to figure out which
letter maps to each digit. All the occurrences of each letter must map to the
same digit, no digit can be repeated, and no “word” can start with the digit 0.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>In this chapter, we’ll dive into an incredible Python
program originally written by Raymond Hettinger. This program solves alphametic
puzzles <i>in just 14 lines of code</i>.       <span style='font-size:11.0pt;
line-height:154%;font-family:"Calibri",sans-serif'><img border=0 width=298
height=570 src="Dive%20Into%20Python%203_files/image044.gif"></span><br
clear=all style='page-break-before:always'>
</p>

<p class=MsoNormal style='margin-top:0in;margin-right:464.45pt;margin-bottom:
21.0pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>import re import itertools</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def solve(puzzle):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:170.45pt;margin-bottom:
0in;margin-left:62.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>words = re.findall('[A-Z]+',
puzzle.upper()) unique_characters = set(''.join(words))</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:206.45pt;margin-bottom:
0in;margin-left:62.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>assert len(unique_characters)
&lt;= 10, 'Too many letters' first_letters = {word[0] for word in words} n =
len(first_letters)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>sorted_characters = ''.join(first_letters)
+ \</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:170.45pt;margin-bottom:
0in;margin-left:62.15pt;text-indent:24.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>''.join(unique_characters
- first_letters) characters = tuple(ord(c) for c in sorted_characters) digits =
tuple(ord(c) for c in '0123456789') zero = digits[0] for guess in
itertools.permutations(digits, len(characters)):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:146.45pt;margin-bottom:
0in;margin-left:110.2pt;text-indent:-24.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>if zero
not in guess[:n]: equation = puzzle.translate(dict(zip(characters, guess))) if
eval(equation):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:134.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>return equation</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:368.45pt;margin-bottom:
0in;margin-left:61.4pt;text-indent:-24.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>if
__name__ == '__main__': import sys for puzzle in sys.argv[1:]: print(puzzle)
solution = solve(puzzle) if solution:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:110.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>print(solution)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.4pt;line-height:107%'>You can run the program from the
command line. On Linux, it would look like this. (These may take some</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>time, depending on the speed of your
computer, and there is no progress bar. Just be patient!)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>you@localhost:~/diveintopython3/examples$
</span><span style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>python3
alphametics.py &quot;HAWAII + IDAHO + IOWA + OHIO</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:302.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>HAWAII + IDAHO + IOWA + OHIO =
STATES 510199 + 98153 + 9301 + 3593 == 621246</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>you@localhost:~/diveintopython3/examples$
</span><span style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>python3
alphametics.py &quot;I + LOVE + YOU == DORA&quot;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:422.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>I + LOVE + YOU == DORA 1 + 2784
+ 975 == 3760</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>you@localhost:~/diveintopython3/examples$
</span><span style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>python3
alphametics.py &quot;SEND + MORE == MONEY&quot;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>SEND + MORE == MONEY</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:56.15pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>9567 + 1085 == 10652</span></p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:33.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h3 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>8.2.
F</span>INDING ALL OCCURRENCES OF A PATTERN</h3>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.9pt;margin-left:16.4pt'>The first thing this alphametics solver does is find
all the letters (A–Z) in the puzzle.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>import
re</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>re.findall('[0-9]+',
'16 2-by-4s in rows of 8') </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>['16', '2', '4', '8']</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>re.findall('[A-Z]+', 'SEND + MORE ==
MONEY')     </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.45pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>['SEND', 'MORE', 'MONEY']</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>re
</span>module is Python’s implementation of <u>regular expressions</u>. It has
a nifty function called <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>findall() </span>which takes a regular
expression pattern and a string, and finds all occurrences of the pattern
within the string. In this case, the pattern matches sequences of numbers. The <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>findall()
</span>function returns a list of all the substrings that matched the pattern.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.55pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Here the regular expression pattern matches sequences of letters. Again,
the return value is a list, and each item in the list is a string that matched
the regular expression pattern.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>Here’s another example that will
stretch your brain a little.</p>

<p class=MsoNormal align=right style='margin-top:0in;margin-right:128.45pt;
margin-bottom:8.5pt;margin-left:.5pt;text-align:right;line-height:110%'><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>re.findall(' s.*? s', &quot;The sixth sick
sheikh's sixth sheep's sick.&quot;)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>[' sixth s', &quot; sheikh's s&quot;,
&quot; sheep's s&quot;]</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
23.25pt;margin-left:16.4pt'><img width=298 height=1
src="Dive%20Into%20Python%203_files/image033.gif" align=left hspace=12>Surprised?
The regular expression looks for a space, an <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>s</span>, and then the shortest
possible series of any character (<span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>.*?</span>), then a space, then another <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>s</span>.
Well, looking at that input string, I see five matches:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.0pt;margin-bottom:
8.25pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:110%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>The <b><span
style='background:gainsboro'>sixth s</span></b>ick sheikh's sixth sheep's sick.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.0pt;margin-bottom:
8.25pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:110%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>The
sixth <b><span style='background:gainsboro'>sick s</span></b>heikh's sixth
sheep's sick.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.0pt;margin-bottom:
8.25pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:110%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>The
sixth sick <b><span style='background:gainsboro'>sheikh's s</span></b>ixth
sheep's sick.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.0pt;margin-bottom:
19.15pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:168%'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:168%;font-family:"Liberation Mono"'>The
sixth sick sheikh's <b><span style='background:gainsboro'>sixth s</span></b>heep's
sick. </span>5. <span style='font-size:10.0pt;line-height:168%;font-family:
"Liberation Mono"'>The sixth sick sheikh's sixth <b><span style='background:
gainsboro'>sheep's s</span></b>ick.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.55pt;margin-left:16.4pt'>But the <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>re.findall() </span>function only returned
three matches. Specifically, it returned the first, the third, and the fifth.
Why is that? Because <i>it doesn’t return overlapping matches</i>. The first
match overlaps with the second, so the first is returned and the second is
skipped. Then the third overlaps with the fourth, so the third is returned and
the fourth is skipped. Finally, the fifth is returned. Three matches, not five.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:299.25pt;margin-bottom:
45.7pt;margin-left:16.4pt'>This has nothing to do with the alphametics solver;
I just thought it was interesting.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:33.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h3 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>8.3.
F</span>INDING THE UNIQUE ITEMS IN A SEQUENCE</h3>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'><u>Sets </u>make it trivial to find
the unique items in a sequence.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.5pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>a_list
= ['The', 'sixth', 'sick', &quot;sheik's&quot;, 'sixth', &quot;sheep's&quot;,
'sick']</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>set(a_list)                      </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>{'sixth', 'The', &quot;sheep's&quot;,
'sick', &quot;sheik's&quot;}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.55pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>a_string
= 'EAST IS EAST'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>set(a_string)                    </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>{'A', ' ', 'E', 'I', 'S', 'T'}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.55pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>words =
['SEND', 'MORE', 'MONEY']</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>''.join(words)                   </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.6pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'SENDMOREMONEY'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>set(''.join(words))              </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>{'E', 'D', 'M', 'O', 'N', 'S', 'R', 'Y'}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Given a list of several strings, the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>set() </span>function will
return a set of unique strings from the list. This makes sense if you think of
it like a <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>for
</span>loop. Take the first item from the list, put it in the set. Second.
Third. Fourth. Fifth — wait, that’s in the set already, so it only gets listed
once, because Python sets don’t allow duplicates. Sixth. Seventh — again, a
duplicate, so it only gets listed once. The end result? All the unique items in
the original list, without any duplicates. The original list doesn’t even need
to be sorted first.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.6pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The same
technique works with strings, since a string is just a sequence of characters.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Given a list of
strings, <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>''.join(a_list)
</span>concatenates all the strings together into one.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.4pt;margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>So, given a list of strings, this line of code returns all the unique
characters across all the strings, with no duplicates.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.9pt;margin-left:16.4pt'>The alphametics solver uses this technique to build
a set of all the unique characters in the puzzle.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>unique_characters = set(''.join(words))</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
46.55pt;margin-left:16.4pt'>This list is later used to assign digits to
characters as the solver iterates through the possible solutions.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:33.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h3 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>8.4.
M</span>AKING ASSERTIONS</h3>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
24.05pt;margin-left:16.4pt'>Like many programming languages, Python has an <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>assert </span>statement.
Here’s how it works.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.75pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>assert 1 + 1 == 2                                     </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>assert 1 + 1 == 3                                     </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>Traceback (most
recent call last):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>File
&quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
12.75pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>AssertionError</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:147.65pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>assert
2 + 2 == 5, &quot;Only for very large values of 2&quot; </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314; </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
color:#880000'>Traceback (most recent call last):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>File
&quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
31.5pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>AssertionError:
Only for very large values of 2</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>assert
</span>statement is followed by any valid Python expression. In this case, the
expression <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>1
+ 1 == 2 </span>evaluates to <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>True</span>, so the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>assert </span>statement does
nothing.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.55pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>However, if the
Python expression evaluates to <span style='font-size:10.0pt;line-height:107%;
font-family:"Liberation Mono"'>False</span>, the <span style='font-size:10.0pt;
line-height:107%;font-family:"Liberation Mono"'>assert </span>statement will
raise an <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>AssertionError</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.5pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>You can also include a human-readable message that is printed if the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>AssertionError
</span>is raised.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.9pt;margin-left:16.4pt'>Therefore, this line of code:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>assert len(unique_characters) &lt;= 10,
'Too many letters'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.9pt;margin-left:16.4pt'>…is equivalent to this:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>if len(unique_characters) &gt; 10:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>raise AssertionError('Too many letters')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
45.7pt;margin-left:16.4pt'>The alphametics solver uses this exact <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>assert </span>statement
to bail out early if the puzzle contains more than ten unique letters. Since
each letter is assigned a unique digit, and there are only ten digits, a puzzle
with more than ten unique letters can not possibly have a solution.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:33.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h3 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>8.5.
G</span>ENERATOR EXPRESSIONS</h3>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.9pt;margin-left:16.4pt'>A generator expression is like a <u>generator
function </u>without the function.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>unique_characters
= {'E', 'D', 'M', 'O', 'N', 'S', 'R', 'Y'}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.35pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>gen =
(ord(c) for c in unique_characters) </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>gen                                        </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.45pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;generator object &lt;genexpr&gt; at
0x00BADC10&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>next(gen)                                  </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>69</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>next(gen)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>68</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>tuple(ord(c) for c in unique_characters)   </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>(69, 68, 77, 79, 78, 83, 82, 89)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>A generator expression is like an anonymous function that yields values.
The expression itself looks like a <u>list comprehension</u>, but it’s wrapped
in parentheses instead of square brackets.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.55pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The generator
expression returns… an iterator.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Calling <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>next(gen)
</span>returns the next value from the iterator.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
46.95pt;margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>If you like, you can iterate through all the possible values and return
a tuple, list, or set, by passing the generator expression to <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>tuple()</span>,
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>list()</span>,
or <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>set()</span>.
In these cases, you don’t need an extra set of parentheses — just pass the
“bare” expression <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>ord(c) for c in unique_characters </span>to the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>tuple()
</span>function, and Python figures out that it’s a generator expression.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:47.15pt;line-height:107%'><span style='font-size:24.0pt;
line-height:107%;font-family:"Calibri",sans-serif'>&#9758; </span>Using a
generator expression instead of a list comprehension can save both <span
style='font-size:9.5pt;line-height:107%'>CPU </span>and</p>

<p class=MsoNormal style='margin-top:0in;margin-right:76.25pt;margin-bottom:
41.55pt;margin-left:76.4pt'><span style='font-size:9.5pt;line-height:154%'>RAM</span>.
If you’re building an list just to throw it away (<i>e.g. </i>passing it to <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>tuple()
</span>or <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>set()</span>),
use a generator expression instead!</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>Here’s another way to accomplish the
same thing, using a <u>generator function</u>:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def ord_map(a_string):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>for c in a_string:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:86.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>yield ord(c)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>gen = ord_map(unique_characters)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
46.55pt;margin-left:16.4pt'>The generator expression is more compact but
functionally equivalent.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:33.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:17.35pt;
margin-left:16.4pt;line-height:112%'><b><span style='font-size:18.0pt;
line-height:112%;font-family:"DejaVu Serif",serif'>8.6. C</span></b><b><span
style='font-size:14.5pt;line-height:112%;font-family:"DejaVu Serif",serif'>ALCULATING
</span></b><b><span style='font-size:18.0pt;line-height:112%;font-family:"DejaVu Serif",serif'>P</span></b><b><span
style='font-size:14.5pt;line-height:112%;font-family:"DejaVu Serif",serif'>ERMUTATIONS</span></b><b><span
style='font-size:18.0pt;line-height:112%;font-family:"DejaVu Serif",serif'>… T</span></b><b><span
style='font-size:14.5pt;line-height:112%;font-family:"DejaVu Serif",serif'>HE </span></b><b><span
style='font-size:18.0pt;line-height:112%;font-family:"DejaVu Serif",serif'>L</span></b><b><span
style='font-size:14.5pt;line-height:112%;font-family:"DejaVu Serif",serif'>AZY </span></b><b><span
style='font-size:18.0pt;line-height:112%;font-family:"DejaVu Serif",serif'>W</span></b><b><span
style='font-size:14.5pt;line-height:112%;font-family:"DejaVu Serif",serif'>AY</span></b><b><span
style='font-size:18.0pt;line-height:112%;font-family:"DejaVu Serif",serif'>!</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.55pt;margin-left:16.4pt'>First of all, what the heck are permutations?
Permutations are a mathematical concept. (There are actually several
definitions, depending on what kind of math you’re doing. Here I’m talking
about combinatorics, but if that doesn’t mean anything to you, don’t worry
about it. As always, <a href="http://en.wikipedia.org/wiki/Permutation"><span
style='color:black'>Wikipedia</span></a><u> </u><a
href="http://en.wikipedia.org/wiki/Permutation"><span style='color:black'>is</span></a><u>
</u><a href="http://en.wikipedia.org/wiki/Permutation"><span style='color:black'>your</span></a><u>
</u><a href="http://en.wikipedia.org/wiki/Permutation"><span style='color:black'>friend</span></a>.)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>The idea is that you take a list of things (could be
numbers, could be letters, could be dancing bears) and find all the possible
ways to split them up into smaller lists. All the smaller lists have the same
size, which can be as small as 1 and as large as the total number of items. Oh,
and nothing can be repeated. Mathematicians say things like “let’s find the
permutations of 3 different items taken 2 at a time,” which means you have a
sequence of 3 items and you want to find all the possible ordered pairs.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.9pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>import itertools                              </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>perms =
itertools.permutations([1, 2, 3], 2) </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>next(perms)                                   </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>(1, 2)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>next(perms)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>(1, 3)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.2pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>next(perms)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>(2, 1)                                            </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>next(perms)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>(2, 3)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>next(perms)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>(3, 1)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>next(perms)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.5pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>(3, 2)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>next(perms)                                   </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9316;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>Traceback (most
recent call last):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>File
&quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
31.85pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>StopIteration</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>itertools
</span>module has all kinds of fun stuff in it, including a <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>permutations()
</span>function that does all the hard work of finding permutations.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>permutations()
</span>function takes a sequence (here a list of three integers) and a number,
which is the number of items you want in each smaller group. The function
returns an iterator, which you can use in a <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>for </span>loop or any old
place that iterates. Here I’ll step through the iterator manually to show all
the values.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.55pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The first
permutation of <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>[1,
2, 3] </span>taken 2 at a time is <span style='font-size:10.0pt;line-height:
107%;font-family:"Liberation Mono"'>(1, 2)</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.7pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Note that
permutations are ordered: <span style='font-size:10.0pt;line-height:107%;
font-family:"Liberation Mono"'>(2, 1) </span>is different than <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>(1, 2)</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>That’s it! Those are all the permutations of <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>[1, 2, 3] </span>taken 2
at a time. Pairs like <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>(1, 1) </span>and <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>(2, 2) </span>never show up,
because they contain repeats so they aren’t valid permutations. When there are
no more permutations, the iterator raises a <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>StopIteration </span>exception.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:297.05pt;margin-bottom:
.25pt;margin-left:16.4pt'>The <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>permutations() </span>function doesn’t have to
take a list. It can take any sequence — even a string.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:345.15pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=298 height=453 src="Dive%20Into%20Python%203_files/image045.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>import
itertools</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>perms =
itertools.permutations('ABC', 3) </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.5pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>next(perms)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>('A',
'B', 'C')                               </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:452.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>next(perms)
('A', 'C', 'B') </span><span style='font-size:10.0pt;line-height:185%;
font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>next(perms)
('B', 'A', 'C') </span><span style='font-size:10.0pt;line-height:185%;
font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>next(perms)
('B', 'C', 'A') </span><span style='font-size:10.0pt;line-height:185%;
font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>next(perms)
('C', 'A', 'B') </span><span style='font-size:10.0pt;line-height:185%;
font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>next(perms)
('C', 'B', 'A') </span><span style='font-size:10.0pt;line-height:185%;
font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>next(perms)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>Traceback (most
recent call last):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>File
&quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
12.7pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>StopIteration</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>list(itertools.permutations('ABC', 3))    </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>[('A', 'B', 'C'), ('A', 'C', 'B'),</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>('B', 'A', 'C'), ('B', 'C', 'A'),</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.25pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>('C', 'A', 'B'), ('C', 'B', 'A')]</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>A string is just a sequence of characters. For the purposes of finding
permutations, the string <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>'ABC' </span>is equivalent to the list <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>['A',
'B', 'C']</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The first permutation of the 3 items <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>['A', 'B', 'C']</span>, taken 3
at a time, is <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>('A',
'B', 'C')</span>. There are five other permutations — the same three characters
in every conceivable order.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
45.7pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Since the <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>permutations() </span>function always returns an iterator,
an easy way to debug permutations is to pass that iterator to the built-in <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>list() </span>function
to see all the permutations immediately.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:33.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h3 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>8.7.
O</span>THER <span style='font-size:18.0pt;line-height:112%'>F</span>UN <span
style='font-size:18.0pt;line-height:112%'>S</span>TUFF IN THE <span
style='font-size:18.0pt;line-height:112%;font-family:"Liberation Mono";
font-weight:normal'>itertools </span><span style='font-size:18.0pt;line-height:
112%'>M</span>ODULE</h3>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>import
itertools</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>list(itertools.product('ABC', '123'))   </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>[('A', '1'), ('A', '2'), ('A', '3'),</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:314.45pt;margin-bottom:
4.2pt;margin-left:44.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>('B', '1'), ('B', '2'), ('B',
'3'), ('C', '1'), ('C', '2'), ('C', '3')]</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>list(itertools.combinations('ABC',
2)) </span><span style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>[('A', 'B'), ('A', 'C'), ('B', 'C')]</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.8pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>itertools.product()
</span>function returns an iterator containing the Cartesian product of two
sequences.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
23.15pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>itertools.combinations()
</span>function returns an iterator containing all the possible combinations of
the given sequence of the given length. This is like the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>itertools.permutations()
</span>function, except combinations don’t include items that are duplicates of
other items in a different order. So <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>itertools.permutations('ABC', 2) </span>will
return both <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>('A',
'B') </span>and <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>('B', 'A') </span>(among others), but <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>itertools.combinations('ABC',
2) </span>will not return <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>('B', 'A') </span>because it is a duplicate of <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>('A',
'B') </span>in a different order.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:87.65pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>names =
list(open('examples/favorite-people.txt', encoding='utf-8')) </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312; </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
185%;font-family:"Liberation Mono"'>names</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>['Dora\n', 'Ethan\n', 'Wesley\n', 'John\n',
'Anne\n',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'Mike\n', 'Chris\n', 'Sarah\n', 'Alex\n',
'Lizzie\n']</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>names = [name.rstrip() for name in names]                             </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>names</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>['Dora', 'Ethan', 'Wesley', 'John', 'Anne',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'Mike', 'Chris', 'Sarah', 'Alex', 'Lizzie']</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>names = sorted(names)                                                 </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>names</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>['Alex', 'Anne', 'Chris', 'Dora', 'Ethan',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'John', 'Lizzie', 'Mike', 'Sarah',
'Wesley']</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>names = sorted(names, key=len)                                        </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>names</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>['Alex', 'Anne', 'Dora', 'John', 'Mike',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'Chris', 'Ethan', 'Sarah', 'Lizzie',
'Wesley']</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.65pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>This idiom
returns a list of the lines in a text file.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Unfortunately (for this example), the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>list(open(filename)) </span>idiom
also includes the carriage returns at the end of each line. This list
comprehension uses the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>rstrip() </span>string method to strip trailing
whitespace from each line. (Strings also have an <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>lstrip() </span>method to strip
leading whitespace, and a <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>strip() </span>method which strips both.)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.45pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>sorted()
</span>function takes a list and returns it sorted. By default, it sorts
alphabetically.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.7pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:155%'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>But the <span
style='font-size:10.0pt;line-height:155%;font-family:"Liberation Mono"'>sorted()
</span>function can also take a function as the <span style='font-size:10.0pt;
line-height:155%;font-family:"Liberation Mono"'>key </span>parameter, and it
sorts by that key. In this case, the sort function is <span style='font-size:
10.0pt;line-height:155%;font-family:"Liberation Mono"'>len()</span>, so it
sorts by <span style='font-size:10.0pt;line-height:155%;font-family:"Liberation Mono"'>len(each
item)</span>. Shorter names come first, then longer, then longest.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>What does this have to do with the <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>itertools
</span>module? I’m glad you asked.<br clear=all style='page-break-before:always'>
</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>…continuing from the previous interactive
shell…</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>import
itertools</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>groups
= itertools.groupby(names, len) </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>groups</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;itertools.groupby object at
0x00BB20C0&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>list(groups)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>[(4, &lt;itertools._grouper object at
0x00BA8BF0&gt;),</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>(5, &lt;itertools._grouper object at
0x00BB4050&gt;),</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>(6, &lt;itertools._grouper object at
0x00BB4030&gt;)]</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.85pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>groups = itertools.groupby(names, len)   </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>for name_length, name_iter in groups:    </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:170.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>...   </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>print('Names
with {0:d} letters:'.format(name_length)) </span><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>...  </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>for
name in name_iter:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>...         </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>print(name)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.95in;margin-bottom:
8.5pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#666677'>...</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:434.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>Names with 4 letters: Alex Anne
Dora John Mike Names with 5 letters: Chris Ethan Sarah Names with 6 letters:
Lizzie</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.75pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>Wesley</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>itertools.groupby()
</span>function takes a sequence and a key function, and returns an iterator
that generates pairs. Each pair contains the result of <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>key_function(each item) </span>and
another iterator containing all the items that shared that key result.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Calling the <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>list() </span>function “exhausted” the iterator, <i>i.e. </i>you’ve
already generated every item in the iterator to make the list. There’s no
“reset” button on an iterator; you can’t just start over once you’ve exhausted</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>it. If you want to loop through it again (say, in the
upcoming <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>for
</span>loop), you need to call <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>itertools.groupby() </span>again to create a new
iterator.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
47.8pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>In this example, given a list of names <i>already sorted by length</i>, <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>itertools.groupby(names,
len) </span>will put all the 4-letter names in one iterator, all the 5-letter
names in another iterator, and so on. The <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>groupby() </span>function is
completely generic; it could group strings by first letter, numbers by their
number of factors, or any other key function you can think of.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:90.6pt;margin-bottom:
41.15pt;margin-left:75.95pt;text-indent:-29.3pt'><span style='font-size:24.0pt;
line-height:154%;font-family:"Calibri",sans-serif'>&#9758; </span>The <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>itertools.groupby()
</span>function only works if the input sequence is already sorted by the
grouping function. In the example above, you grouped a list of names by the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>len() </span>function.
That only worked because the input list was already sorted by length.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.9pt;margin-left:16.4pt'>Are you watching closely?</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>list(range(0,
3))</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>[0, 1, 2]</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>list(range(10,
13))</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>[10, 11, 12]</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>list(itertools.chain(range(0, 3), range(10,
13)))        </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>[0, 1, 2, 10, 11, 12]</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>list(zip(range(0, 3), range(10, 13)))                    </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>[(0, 10), (1, 11), (2, 12)]</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>list(zip(range(0, 3), range(10, 14)))                    </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>[(0, 10), (1, 11), (2, 12)]</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>list(itertools.zip_longest(range(0,
3), range(10, 14))) </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>[(0, 10), (1, 11), (2, 12), (None, 13)]</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>itertools.chain()
</span>function takes two iterators and returns an iterator that contains all
the items from the first iterator, followed by all the items from the second
iterator. (Actually, it can take any number of iterators, and it chains them
all in the order they were passed to the function.)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>zip()
</span>function does something prosaic that turns out to be extremely useful:
it takes any number of sequences and returns an iterator which returns tuples
of the first items of each sequence, then the second items of each, then the
third, and so on.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>zip()
</span>function stops at the end of the shortest sequence. <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>range(10,
14) </span>has 4 items (10, 11, 12, and 13), but <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>range(0, 3) </span>only has 3,
so the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>zip()
</span>function returns an iterator of 3 items.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.6pt;margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>On the other hand, the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>itertools.zip_longest() </span>function stops at
the end of the <i>longest </i>sequence, inserting <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>None </span>values for items
past the end of the shorter sequences.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.9pt;margin-left:16.4pt'>OK, that was all very interesting, but how does it
relate to the alphametics solver? Here’s how:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>characters
= ('S', 'M', 'E', 'D', 'O', 'N', 'R', 'Y')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>guess =
('1', '2', '0', '3', '4', '5', '6', '7')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>tuple(zip(characters,
guess)) </span><span style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>(('S', '1'), ('M', '2'), ('E', '0'), ('D',
'3'),</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>('O', '4'), ('N', '5'), ('R', '6'), ('Y',
'7'))</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>dict(zip(characters, guess))   </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>{'E': '0', 'D': '3', 'M': '2', 'O': '4',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.15pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'N': '5', 'S': '1', 'R': '6', 'Y': '7'}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Given a list of letters and a list of digits (each represented here as
1-character strings), the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>zip </span>function will create a pairing of
letters and digits, in order.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.5pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Why is that cool? Because that data structure happens to be exactly the
right structure to pass to the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>dict() </span>function to create a dictionary
that uses letters as keys and their associated digits as values. (This isn’t
the only way to do it, of course. You could use a <u>dictionary comprehension </u>to
create the dictionary directly.) Although the printed representation of the
dictionary lists the pairs in a different order (dictionaries have no “order”
per se), you can see that each letter is associated with the digit, based on
the ordering of the original <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>characters </span>and <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>guess </span>sequences.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>The alphametics solver uses this technique to create
a dictionary that maps letters in the puzzle to digits in the solution, for
each possible solution.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:242.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>characters = tuple(ord(c) for c
in sorted_characters) digits = tuple(ord(c) for c in '0123456789') ...</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>for guess in itertools.permutations(digits,
len(characters)):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>...</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.55pt;
margin-left:62.65pt;line-height:110%;background:gainsboro'><b><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>equation
= puzzle.translate(dict(zip(characters, guess)))</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
46.6pt;margin-left:16.4pt'>But what is this <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>translate() </span>method? Ah,
now you’re getting to the <i>really </i>fun part.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:33.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h3 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>8.8.
A N</span>EW <span style='font-size:18.0pt;line-height:112%'>K</span>IND <span
style='font-size:18.0pt;line-height:112%'>O</span>F <span style='font-size:
18.0pt;line-height:112%'>S</span>TRING <span style='font-size:18.0pt;
line-height:112%'>M</span>ANIPULATION</h3>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
23.15pt;margin-left:16.4pt'>Python strings have many methods. You learned about
some of those methods in <u>the Strings chapter</u>: <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>lower()</span>, <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>count()</span>,
and <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>format()</span>.
Now I want to introduce you to a powerful but little-known string manipulation
technique: the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>translate()
</span>method.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.75pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>translation_table
= {ord('A'): ord('O')} </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>translation_table                         </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>{65: 79}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'MARK'.translate(translation_table)       </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'MORK'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>String translation starts with a translation table, which is just a
dictionary that maps one character to another. Actually, “character” is
incorrect — the translation table really maps one <i>byte </i>to another.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Remember, bytes in Python 3 are integers. The <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>ord() </span>function
returns the <span style='font-size:9.5pt;line-height:154%'>ASCII </span>value
of a character, which, in the case of A–Z, is always a byte from 65 to 90.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>translate()
</span>method on a string takes a translation table and runs the string through
it. That is, it replaces all occurrences of the keys of the translation table
with the corresponding values. In this case, “translating” <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>MARK </span>to
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>MORK</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:287.45pt;margin-bottom:
.25pt;margin-left:16.4pt'>What does this have to do with solving alphametic
puzzles? As it turns out, everything.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:24.25pt;
margin-left:345.15pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=298 height=394 src="Dive%20Into%20Python%203_files/image046.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>characters = tuple(ord(c) for c in
'SMEDONRY')       </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>characters</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>(83, 77, 69, 68, 79, 78, 82, 89)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>guess = tuple(ord(c) for c in '91570682')            </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>guess</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>(57, 49, 53, 55, 48, 54, 56, 50)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>translation_table = dict(zip(characters,
guess))     </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>translation_table</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>{68: 55, 69: 53, 77: 49, 78: 54, 79: 48,
82: 56, 83: 57, 89: 50}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>'SEND +
MORE == MONEY'.translate(translation_table) </span><span style='font-family:
"DejaVu Sans",sans-serif;color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.4pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'9567 + 1085 == 10652'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Using a <u>generator expression</u>, we quickly compute the byte values
for each character in a string. <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>characters </span>is an example of the value of <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>sorted_characters
</span>in the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>alphametics.solve()
</span>function.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Using another generator expression, we quickly compute the byte values
for each digit in this string. The result, <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>guess</span>, is of the form <u>returned
by the </u><u><span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>itertools.permutations()
</span>function </u>in the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>alphametics.solve() </span>function.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.15pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:155%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>This translation
table is generated by <u>zipping </u><u><span style='font-size:10.0pt;
line-height:155%;font-family:"Liberation Mono"'>characters </span>and </u><u><span
style='font-size:10.0pt;line-height:155%;font-family:"Liberation Mono"'>guess </span>together
</u>and building a dictionary from the resulting sequence of pairs. This is
exactly what the <span style='font-size:10.0pt;line-height:155%;font-family:
"Liberation Mono"'>alphametics.solve() </span>function does inside the <span
style='font-size:10.0pt;line-height:155%;font-family:"Liberation Mono"'>for </span>loop.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.55pt;margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Finally, we pass this translation table to the <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>translate() </span>method
of the original puzzle string. This converts each letter in the string to the
corresponding digit (based on the letters in <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>characters </span>and the
digits in <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>guess</span>).
The result is a valid Python expression, as a string.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:31.0pt;
margin-bottom:46.85pt;margin-left:.5pt;text-align:center;line-height:151%'>That’s
pretty impressive. But what can you do with a string that happens to be a valid
Python expression?</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:33.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h3 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>8.9.
E</span>VALUATING <span style='font-size:18.0pt;line-height:112%'>A</span>RBITRARY
<span style='font-size:18.0pt;line-height:112%'>S</span>TRINGS <span
style='font-size:18.0pt;line-height:112%'>A</span>S <span style='font-size:
18.0pt;line-height:112%'>P</span>YTHON <span style='font-size:18.0pt;
line-height:112%'>E</span>XPRESSIONS</h3>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.0pt;margin-left:16.4pt'>This is the final piece of the puzzle (or rather,
the final piece of the puzzle solver). After all that fancy string
manipulation, we’re left with a string like <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>'9567 + 1085 == 10652'</span>. But
that’s a string, and what good is a string? Enter <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>eval()</span>, the universal
Python evaluation tool.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>eval('1
+ 1 == 2')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>True</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>eval('1
+ 1 == 3')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>False</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>eval('9567
+ 1085 == 10652')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>True</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>But wait, there’s more! The <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>eval() </span>function
isn’t limited to boolean expressions. It can handle <i>any </i>Python
expression and returns <i>any </i>datatype.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>eval('&quot;A&quot;
+ &quot;B&quot;')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'AB'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>eval('&quot;MARK&quot;.translate({65:
79})')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'MORK'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>eval('&quot;AAAAA&quot;.count(&quot;A&quot;)')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>5</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>eval('[&quot;*&quot;]
* 5')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>['*', '*', '*', '*', '*']</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.9pt;margin-left:16.4pt'>But wait, that’s not all!</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.55pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>x = 5</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>eval(&quot;x * 5&quot;)         </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.6pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>25</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>eval(&quot;pow(x, 2)&quot;)     </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>25</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.6pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>import
math</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>eval(&quot;math.sqrt(x)&quot;)
</span><span style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.45pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>2.2360679774997898</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The expression that <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>eval() </span>takes can reference global
variables defined outside the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>eval()</span>. If called within a function, it
can reference local variables too.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>And functions.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:300%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>And modules.
Hey, wait a minute…</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>import
subprocess</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>eval(&quot;subprocess.getoutput('ls
~')&quot;)                  </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:248.45pt;margin-bottom:
0in;margin-left:43.4pt;text-indent:-6.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>'Desktop        
Library         Pictures \ Documents       Movies          Public   \</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>Music           Sites'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>eval(&quot;subprocess.getoutput('rm
/some/random/file')&quot;) </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.05pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>subprocess
</span>module allows you to run arbitrary shell commands and get the result as
a Python string.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.9pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Arbitrary shell commands can have permanent consequences.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
23.25pt;margin-left:16.4pt'>It’s even worse than that, because there’s a global
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__import__()
</span>function that takes a module name as a string, imports the module, and
returns a reference to it. Combined with the power of <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>eval()</span>, you can
construct a single expression that will wipe out all your files:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:28.5pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>eval(&quot;__import__('subprocess').getoutput('rm
/some/random/file')&quot;) </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
170.8pt;margin-left:16.65pt;text-indent:-16.65pt'>1. Now imagine the output of <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>'rm -rf
~'</span>. Actually there wouldn’t be any output, but you wouldn’t have any
files left either.</p>

<p class=MsoNormal align=center style='margin:0in;text-align:center;text-indent:
0in;line-height:90%'><b><span style='font-size:120.0pt;line-height:90%'>eval()
is EVIL</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.8pt;margin-left:16.4pt'>Well, the evil part is evaluating arbitrary
expressions from untrusted sources. You should only use <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>eval() </span>on trusted
input. Of course, the trick is figuring out what’s “trusted.” But here’s
something I know for certain: you should <b>NOT </b>take this alphametics
solver and put it on the internet as a fun little web service. Don’t make the
mistake of thinking, “Gosh, the function does a lot of string manipulation
before getting a string to evaluate; <i>I can’t imagine </i>how someone could
exploit that.” Someone <b>WILL </b>figure out how to sneak nasty executable
code past all that string manipulation (<a
href="http://www.securityfocus.com/blogs/746"><span style='color:black'>stranger</span></a><u>
</u><a href="http://www.securityfocus.com/blogs/746"><span style='color:black'>things</span></a><u>
</u><a href="http://www.securityfocus.com/blogs/746"><span style='color:black'>have</span></a><u>
</u><a href="http://www.securityfocus.com/blogs/746"><span style='color:black'>happened</span></a>),
and then you can kiss your server goodbye.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:33.8pt;margin-bottom:
19.0pt;margin-left:16.4pt'>But surely there’s <i>some </i>way to evaluate
expressions safely? To put <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>eval() </span>in a sandbox where it can’t access
or harm the outside world? Well, yes and no.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>x = 5</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=334
 style='width:250.8pt;margin-left:38.15pt;border-collapse:collapse'>
 <tr style='height:102.3pt'>
  <td width=320 valign=top style='width:240.05pt;padding:0in 0in 0in 0in;
  height:102.3pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>eval(&quot;x
  * 5&quot;, {}, {})</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#880000'>Traceback
  (most recent call last):</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:12.0pt;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#880000'>File
  &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:12.0pt;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono";
  color:#880000'>File &quot;&lt;string&gt;&quot;, line 1, in &lt;module&gt;
  NameError: name 'x' is not defined</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:102.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9312;</span></p>
  </td>
 </tr>
 <tr style='height:43.5pt'>
  <td width=320 valign=top style='width:240.05pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>eval(&quot;x
  * 5&quot;, {&quot;x&quot;: x}, {})</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono";
  color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
  107%;font-family:"Liberation Mono"'>import math</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9313;</span></p>
  </td>
 </tr>
 <tr style='height:102.3pt'>
  <td width=320 valign=bottom style='width:240.05pt;padding:0in 0in 0in 0in;
  height:102.3pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:185%'><span
  style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
  color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
  185%;font-family:"Liberation Mono"'>eval(&quot;math.sqrt(x)&quot;,
  {&quot;x&quot;: x}, {}) </span><span style='font-size:10.0pt;line-height:
  185%;font-family:"Liberation Mono";color:#880000'>Traceback (most recent call
  last):</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:12.0pt;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#880000'>File
  &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:12.0pt;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono";
  color:#880000'>File &quot;&lt;string&gt;&quot;, line 1, in &lt;module&gt;
  NameError: name 'math' is not defined</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:102.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9314;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The second and third parameters passed to the <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>eval() </span>function
act as the global and local namespaces for evaluating the expression. In this
case, they are both empty, which means that when the string <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>&quot;x
* 5&quot; </span>is evaluated, there is no reference to <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>x </span>in either the
global or local namespace, so <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>eval() </span>throws an exception.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>You can selectively include specific values in the global namespace by
listing them individually. Then those — and only those — variables will be
available during evaluation.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.5pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Even though you just imported the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>math </span>module, you didn’t
include it in the namespace passed to the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>eval() </span>function, so the
evaluation failed.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>Gee, that was easy. Lemme make an
alphametics web service now!</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>eval(&quot;pow(5, 2)&quot;, {}, {})                   </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>25</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>eval(&quot;__import__('math').sqrt(5)&quot;,
{}, {}) </span><span style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>2.2360679774997898</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Even though you’ve passed empty dictionaries for the global and local
namespaces, all of Python’s built-in functions are still available during
evaluation. So <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>pow(5,
2) </span>works, because <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>5 </span>and <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>2 </span>are literals, and <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>pow() </span>is
a built-in function.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.55pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Unfortunately (and if you don’t see why it’s unfortunate, read on), the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__import__()
</span>function is also a builtin function, so it works too.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.0pt;margin-left:16.4pt'>Yeah, that means you can still do nasty things, even
if you explicitly set the global and local namespaces to empty dictionaries
when calling <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>eval()</span>:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>eval(&quot;__import__('subprocess').getoutput('rm
/some/random/file')&quot;, {}, {})</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.0pt;margin-left:16.4pt'>Oops. I’m glad I didn’t make that alphametics web
service. Is there <i>any </i>way to use <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>eval() </span>safely? Well, yes
and no.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>eval(&quot;__import__('math').sqrt(5)&quot;,</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>...     </span><span style='font-size:10.0pt;line-height:110%;
font-family:"Liberation Mono"'>{&quot;__builtins__&quot;:None}, {})          </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>Traceback (most
recent call last):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>File
&quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>File
&quot;&lt;string&gt;&quot;, line 1, in &lt;module&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>NameError: name
'__import__' is not defined</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>eval(&quot;__import__('subprocess').getoutput('rm
-rf /')&quot;,</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>...     </span><span style='font-size:10.0pt;line-height:110%;
font-family:"Liberation Mono"'>{&quot;__builtins__&quot;:None}, {})          </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>Traceback (most
recent call last):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>File
&quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>File
&quot;&lt;string&gt;&quot;, line 1, in &lt;module&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
31.05pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>NameError: name
'__import__' is not defined</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.65pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>To evaluate
untrusted expressions safely, you need to define a global namespace dictionary
that maps</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:36.5pt;
margin-bottom:.25pt;margin-left:.5pt;text-align:center;line-height:151%'><span
style='font-size:10.0pt;line-height:151%;font-family:"Liberation Mono"'>&quot;__builtins__&quot;
</span>to <span style='font-size:10.0pt;line-height:151%;font-family:"Liberation Mono"'>None</span>,
the Python null value. Internally, the “built-in” functions are contained
within a pseudo-module called <span style='font-size:10.0pt;line-height:151%;
font-family:"Liberation Mono"'>&quot;__builtins__&quot;</span>. This
pseudo-module (<i>i.e. </i>the set of built-in functions) is made available to
evaluated expressions unless you explicitly override it.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.15pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Be sure you’ve overridden <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>__builtins__</span>. Not <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__builtin__</span>,
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__built-ins__</span>,
or some other variation that will work just fine but expose you to catastrophic
risks.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.95pt;margin-left:16.4pt'>So <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>eval() </span>is safe now? Well, yes and no.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>eval(&quot;2
** 2147483647&quot;,</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:28.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>...     </span><span style='font-size:10.0pt;line-height:110%;
font-family:"Liberation Mono"'>{&quot;__builtins__&quot;:None}, {})          </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.4pt;margin-left:16.65pt;text-indent:-16.65pt'>1.   Even without access to <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__builtins__</span>,
you can still launch a denial-of-service attack. For example, trying to raise <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>2 </span>to
the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>2147483647</span><sup><span
style='font-size:15.5pt;line-height:154%'>th </span></sup>power will spike your
server’s <span style='font-size:9.5pt;line-height:154%'>CPU </span>utilization
to 100% for quite some time. (If you’re trying this in the interactive shell,
press <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>Ctrl-C
</span>a few times to break out of it.) Technically this expression <i>will </i>return
a value eventually, but in the meantime your server will be doing a whole lot
of nothing.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
45.7pt;margin-left:16.4pt'>In the end, it <i>is </i>possible to safely evaluate
untrusted Python expressions, for some definition of “safe” that turns out not
to be terribly useful in real life. It’s fine if you’re just playing around,
and it’s fine if you only ever pass it trusted input. But anything else is just
asking for trouble.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:33.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h3 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>8.10.
P</span>UTTING <span style='font-size:18.0pt;line-height:112%'>I</span>T <span
style='font-size:18.0pt;line-height:112%'>A</span>LL <span style='font-size:
18.0pt;line-height:112%'>T</span>OGETHER</h3>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.25pt;margin-left:16.4pt'>To recap: this program solves alphametic puzzles by
brute force, <i>i.e. </i>through an exhaustive search of all possible
solutions. To do this, it…</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:16.65pt;text-indent:-16.65pt;line-height:110%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><u>Finds all the
letters in the puzzle </u>with the <span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>re.findall() </span>function</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:16.65pt;text-indent:-16.65pt;line-height:110%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><u>Find all the <i>unique
</i>letters in the puzzle </u>with sets and the <span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono"'>set() </span>function</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><u>Checks if
there are more than 10 unique letters </u>(meaning the puzzle is definitely
unsolvable) with an <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>assert </span>statement</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:16.65pt;text-indent:-16.65pt;line-height:110%'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><u>Converts the
letters to their ASCII equivalents </u>with a generator object</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:16.65pt;text-indent:-16.65pt;line-height:110%'>5.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><u>Calculates
all the possible solutions </u>with the <span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono"'>itertools.permutations() </span>function</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:16.65pt;text-indent:-16.65pt;line-height:110%'>6.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><u>Converts each
possible solution to a Python expression </u>with the <span style='font-size:
10.0pt;line-height:110%;font-family:"Liberation Mono"'>translate() </span>string
method</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:16.65pt;text-indent:-16.65pt;line-height:110%'>7.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><u>Tests each
possible solution by evaluating the Python expression </u>with the <span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>eval() </span>function</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:25.05pt;
margin-left:16.65pt;text-indent:-16.65pt;line-height:300%'>8.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Returns the
first solution that evaluates to <span style='font-size:10.0pt;line-height:
300%;font-family:"Liberation Mono"'>True </span>…in just 14 lines of code.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:33.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h3 style='margin-top:0in;margin-right:0in;margin-bottom:18.85pt;margin-left:
16.4pt'><span style='font-size:18.0pt;line-height:112%'>8.11. F</span>URTHER <span
style='font-size:18.0pt;line-height:112%'>R</span>EADING</h3>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.55pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://docs.python.org/3.1/library/itertools.html"><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:black'>itertools</span></a><u><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'> </span></u><a
href="http://docs.python.org/3.1/library/itertools.html"><span
style='color:black'>module</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://www.doughellmann.com/PyMOTW/itertools/"><span style='font-size:
10.0pt;line-height:110%;font-family:"Liberation Mono";color:black'>itertools</span></a><u><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'> </span></u><a
href="http://www.doughellmann.com/PyMOTW/itertools/"><span style='color:black'>—</span></a><u>
</u><a href="http://www.doughellmann.com/PyMOTW/itertools/"><span
style='color:black'>Iterator</span></a><u> </u><a
href="http://www.doughellmann.com/PyMOTW/itertools/"><span style='color:black'>functions</span></a><u>
</u><a href="http://www.doughellmann.com/PyMOTW/itertools/"><span
style='color:black'>for</span></a><u> </u><a
href="http://www.doughellmann.com/PyMOTW/itertools/"><span style='color:black'>efficient</span></a><u>
</u><a href="http://www.doughellmann.com/PyMOTW/itertools/"><span
style='color:black'>looping</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://blip.tv/file/1947373/"><span style='color:black'>Watch</span></a><u>
</u><a href="http://blip.tv/file/1947373/"><span style='color:black'>Raymond</span></a><u>
</u><a href="http://blip.tv/file/1947373/"><span style='color:black'>Hettinger’s</span></a><u>
</u><a href="http://blip.tv/file/1947373/"><span style='color:black'>“Easy</span></a><u>
</u><a href="http://blip.tv/file/1947373/"><span style='color:black'>AI</span></a><u>
</u><a href="http://blip.tv/file/1947373/"><span style='color:black'>with</span></a><u>
</u><a href="http://blip.tv/file/1947373/"><span style='color:black'>Python”</span></a><u>
</u><a href="http://blip.tv/file/1947373/"><span style='color:black'>talk</span></a><u>
</u>at PyCon 2009</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.0pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:107%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://code.activestate.com/recipes/576615/"><span style='color:black'>Recipe</span></a><u>
</u><a href="http://code.activestate.com/recipes/576615/"><span
style='color:black'>576615:</span></a><u> </u><a
href="http://code.activestate.com/recipes/576615/"><span style='color:black'>Alphametics</span></a><u>
</u><a href="http://code.activestate.com/recipes/576615/"><span
style='color:black'>solver</span></a>, Raymond Hettinger’s original alphametics
solver for Python 2</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.0pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:107%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://code.activestate.com/recipes/users/178123/"><span
style='color:black'>More</span></a><u> </u><a
href="http://code.activestate.com/recipes/users/178123/"><span
style='color:black'>of</span></a><u> </u><a
href="http://code.activestate.com/recipes/users/178123/"><span
style='color:black'>Raymond</span></a><u> </u><a
href="http://code.activestate.com/recipes/users/178123/"><span
style='color:black'>Hettinger’s</span></a><u> </u><a
href="http://code.activestate.com/recipes/users/178123/"><span
style='color:black'>recipes</span></a><u> </u>in the ActiveState Code
repository</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://en.wikipedia.org/wiki/Verbal_arithmetic"><span style='color:black'>Alphametics</span></a><u>
</u><a href="http://en.wikipedia.org/wiki/Verbal_arithmetic"><span
style='color:black'>on</span></a><u> </u><a
href="http://en.wikipedia.org/wiki/Verbal_arithmetic"><span style='color:black'>Wikipedia</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:26.7pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://www.tkcs-collins.com/truman/alphamet/index.shtml"><span
style='color:black'>Alphametics</span></a><u> </u><a
href="http://www.tkcs-collins.com/truman/alphamet/index.shtml"><span
style='color:black'>Index</span></a>, including <a
href="http://www.tkcs-collins.com/truman/alphamet/alphamet.shtml"><span
style='color:black'>lots</span></a><u> </u><a
href="http://www.tkcs-collins.com/truman/alphamet/alphamet.shtml"><span
style='color:black'>of</span></a><u> </u><a
href="http://www.tkcs-collins.com/truman/alphamet/alphamet.shtml"><span
style='color:black'>puzzles</span></a><u> </u>and <a
href="http://www.tkcs-collins.com/truman/alphamet/alpha_gen.shtml"><span
style='color:black'>a</span></a><u> </u><a
href="http://www.tkcs-collins.com/truman/alphamet/alpha_gen.shtml"><span
style='color:black'>generator</span></a><u> </u><a
href="http://www.tkcs-collins.com/truman/alphamet/alpha_gen.shtml"><span
style='color:black'>to</span></a><u> </u><a
href="http://www.tkcs-collins.com/truman/alphamet/alpha_gen.shtml"><span
style='color:black'>make</span></a><u> </u><a
href="http://www.tkcs-collins.com/truman/alphamet/alpha_gen.shtml"><span
style='color:black'>your</span></a><u> </u><a
href="http://www.tkcs-collins.com/truman/alphamet/alpha_gen.shtml"><span
style='color:black'>own</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>Many thanks to Raymond Hettinger for agreeing to
relicense his code so I could port it to Python 3 and use it as the basis for
this chapter.</p>

<h2 style='margin-top:0in;margin-right:22.2pt;margin-bottom:0in;margin-left:
16.4pt;line-height:107%'><span style='font-size:24.0pt;line-height:107%'>C</span><span
style='font-size:19.0pt;line-height:107%'>HAPTER </span><span style='font-size:
24.0pt;line-height:107%'>9. U</span><span style='font-size:19.0pt;line-height:
107%'>NIT </span><span style='font-size:24.0pt;line-height:107%'>T</span><span
style='font-size:19.0pt;line-height:107%'>ESTING</span></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:39.9pt;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=736 height=4 id="Group 677485"
src="Dive%20Into%20Python%203_files/image001.gif"></span></p>

<p class=MsoNormal align=right style='margin-top:0in;margin-right:29.3pt;
margin-bottom:65.45pt;margin-left:87.95pt;text-align:right;line-height:160%'><span
style='font-size:13.0pt;line-height:160%;font-family:"Calibri",sans-serif'>&#10077;
</span><i>Certitude is not the test of certainty. We have been cocksure of many
things that were not so. </i><span style='font-size:13.0pt;line-height:160%;
font-family:"Calibri",sans-serif'>&#10078; </span><i>— </i><a
href="http://en.wikiquote.org/wiki/Oliver_Wendell_Holmes,_Jr."><i><span
style='color:black'>Oliver</span></i></a><i><u> </u></i><a
href="http://en.wikiquote.org/wiki/Oliver_Wendell_Holmes,_Jr."><i><span
style='color:black'>Wendell</span></i></a><i><u> </u></i><a
href="http://en.wikiquote.org/wiki/Oliver_Wendell_Holmes,_Jr."><i><span
style='color:black'>Holmes,</span></i></a><i><u> </u></i><a
href="http://en.wikiquote.org/wiki/Oliver_Wendell_Holmes,_Jr."><i><span
style='color:black'>Jr.</span></i></a></p>

<h3 style='margin-top:0in;margin-right:0in;margin-bottom:66.45pt;margin-left:
16.4pt;line-height:110%'><span style='font-size:18.0pt;line-height:110%'>9.1.
(N</span>OT<span style='font-size:18.0pt;line-height:110%'>) D</span>IVING <span
style='font-size:18.0pt;line-height:110%'>I</span>N</h3>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
16.95pt;margin-left:16.4pt;line-height:179%'><span style='font-size:48.0pt;
line-height:179%;font-family:"DejaVu Serif",serif;color:#888888'>K </span>ids
today. So spoiled by these fast computers and fancy “dynamic” languages. Write
first, ship second, debug third (if ever). In my day, we had discipline.
Discipline, I say! We had to write programs by <i>hand</i>, on <i>paper</i>,
and feed them to the computer on <i>punchcards</i>. And we <i>liked it!</i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.55pt;margin-left:16.4pt'>In this chapter, you’re going to write and debug a
set of utility functions to convert to and from Roman numerals. You saw the
mechanics of constructing and validating Roman numerals in <u>“Case study:
roman numerals”</u>. Now step back and consider what it would take to expand
that into a two-way utility.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.45pt;margin-left:16.4pt'><u>The rules for Roman numerals </u>lead to a
number of interesting observations:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>There is only
one correct way to represent a particular number as a Roman numeral.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The converse is also true: if a string of characters is a valid Roman
numeral, it represents only one number (that is, it can only be interpreted one
way).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>There is a limited range of numbers that can be expressed as Roman
numerals, specifically <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>1 </span>through <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>3999</span>. The Romans did
have several ways of expressing larger numbers, for instance by having a bar
over a numeral to represent that its normal value should be multiplied by <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>1000</span>.
For the purposes of this chapter, let’s stipulate that Roman numerals go from <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>1 </span>to
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>3999</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>There is no way
to represent 0 in Roman numerals.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>5.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>There is no way
to represent negative numbers in Roman numerals.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>6.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>There is no way
to represent fractions or non-integer numbers in Roman numerals.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.5pt;margin-left:16.4pt'>Let’s start mapping out what a <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>roman.py
</span>module should do. It will have two main functions, <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>to_roman()
</span>and <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>from_roman()</span>.
The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>to_roman()
</span>function should take an integer from <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>1 </span>to <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>3999 </span>and
return the Roman numeral representation as a string…</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.0pt;margin-left:16.4pt'>Stop right there. Now let’s do something a little
unexpected: write a test case that checks whether the <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>to_roman() </span>function
does what you want it to. You read that right: you’re going to write code that
tests code that you haven’t written yet.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>This is called <i>test-driven development</i>, or <span
style='font-size:9.5pt;line-height:154%'>TDD</span>. The set of two conversion
functions — <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>to_roman()</span>,
and later <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>from_roman()
</span>— can be written and tested as a unit, separate from any larger program
that imports them.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.5pt;margin-left:16.4pt'>Python has a framework for unit testing, the
appropriately-named <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>unittest </span>module.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.55pt;margin-left:16.4pt'>Unit testing is an important part of an overall
testing-centric development strategy. If you write unit tests, it is important
to write them early and to keep them updated as code and requirements change.
Many people advocate writing tests before they write the code they’re testing,
and that’s the style I’m going to demonstrate in this chapter. But unit tests
are beneficial no matter when you write them.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-12.25pt;line-height:107%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Before writing
code, writing unit tests forces you to detail your requirements in a useful
fashion.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-12.25pt'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>While writing code, unit tests keep you from over-coding. When all the
test cases pass, the function is complete.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-12.25pt;line-height:107%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>When refactoring
code, they can help prove that the new version behaves the same way as the old
version.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-12.25pt'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>When maintaining code, having tests will help you cover your ass when
someone comes screaming that your latest change broke their old code. (“But <i>sir</i>,
all the unit tests passed when I checked it in...”)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
45.7pt;margin-left:16.65pt;text-indent:-12.25pt'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>When writing code in a team, having a comprehensive test suite
dramatically decreases the chances that your code will break someone else’s
code, because you can run their unit tests first. (I’ve seen this sort of thing
in code sprints. A team breaks up the assignment, everybody takes the specs for
their task, writes unit tests for it, then shares their unit tests with the
rest of the team. That way, nobody goes off too far into developing code that
doesn’t play well with others.)</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:33.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h4 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>9.2.
A S</span>INGLE <span style='font-size:18.0pt;line-height:112%'>Q</span>UESTION</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:295.5pt;margin-bottom:
20.55pt;margin-left:16.4pt'>A test case answers a single question about the
code it is testing. A test case should be able to...</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-12.25pt'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span><img width=298 height=1 src="Dive%20Into%20Python%203_files/image033.gif"
align=left hspace=12>...run completely by itself, without any human input. Unit
testing is about automation.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-12.25pt'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>...determine by itself whether the function it is testing has passed or
failed, without a human interpreting the results.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.55pt;margin-left:16.65pt;text-indent:-12.25pt'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>...run in isolation, separate from any other test cases (even if they
test the same functions). Each test case is an island.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:291.4pt;margin-bottom:
20.95pt;margin-left:16.4pt'>Given that, let’s build a test case for the first
requirement:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:21.5pt;
margin-left:0in;text-indent:0in'>1.     The <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>to_roman() </span>function
should return the Roman numeral representation for all integers <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>1 </span>to
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>3999</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>It is not immediately obvious how this code does…
well, <i>anything</i>. It defines a class which has no <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>__init__() </span>method.
The class <i>does </i>have another method, but it is never called. The entire
script has a <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__main__
</span>block, but it doesn’t reference the class or its method. But it does do
something, I promise.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:446.45pt;margin-bottom:
.35in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>import roman1 import unittest</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:165.65pt;margin-bottom:
0in;margin-left:61.4pt;text-indent:-24.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>class
KnownValues(unittest.TestCase): </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9312; </span><span style='font-size:10.0pt;line-height:185%;
font-family:"Liberation Mono"'>known_values = ( (1, 'I'),</span></p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:369.45pt;
margin-bottom:8.5pt;margin-left:159.7pt;text-align:center;line-height:110%'><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>(2,
'II'),</span></p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:363.45pt;
margin-bottom:8.5pt;margin-left:159.7pt;text-align:center;line-height:110%'><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>(3,
'III'),</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:356.45pt;margin-bottom:
0in;margin-left:164.7pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>(4, 'IV'), (5, 'V'),</span></p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:369.45pt;
margin-bottom:8.5pt;margin-left:159.7pt;text-align:center;line-height:110%'><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>(6,
'VI'),</span></p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:363.45pt;
margin-bottom:8.5pt;margin-left:159.7pt;text-align:center;line-height:110%'><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>(7,
'VII'),</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:350.45pt;margin-bottom:
0in;margin-left:164.7pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>(8, 'VIII'), (9, 'IX'), (10,
'X'), (50, 'L'),</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:338.45pt;margin-bottom:
0in;margin-left:164.7pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>(100, 'C'), (500, 'D'),</span></p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:357.45pt;
margin-bottom:8.5pt;margin-left:159.7pt;text-align:center;line-height:110%'><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>(1000,
'M'),</span></p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:351.45pt;
margin-bottom:8.5pt;margin-left:159.7pt;text-align:center;line-height:110%'><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>(31,
'XXXI'),</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:302.45pt;margin-bottom:
0in;margin-left:164.7pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>(148, 'CXLVIII'), (294,
'CCXCIV'),</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:308.45pt;margin-bottom:
0in;margin-left:164.7pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>(312, 'CCCXII'), (421,
'CDXXI'),</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:302.45pt;margin-bottom:
0in;margin-left:164.7pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>(528, 'DXXVIII'), (621,
'DCXXI'),</span></p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:315.45pt;
margin-bottom:8.5pt;margin-left:159.7pt;text-align:center;line-height:110%'><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>(782,
'DCCLXXXII'),</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:302.45pt;margin-bottom:
0in;margin-left:164.7pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>(870, 'DCCCLXX'), (941,
'CMXLI'),</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:296.45pt;margin-bottom:
0in;margin-left:164.7pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>(1043, 'MXLIII'), (1110,
'MCX'),</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:290.45pt;margin-bottom:
0in;margin-left:164.7pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>(1226, 'MCCXXVI'), (1301,
'MCCCI'),</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:284.45pt;margin-bottom:
8.25pt;margin-left:164.7pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>(1485, 'MCDLXXXV'), (1509,
'MDIX'), (1607, 'MDCVII'),</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:164.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>(1754, 'MDCCLIV'),</span></p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:303.45pt;
margin-bottom:8.5pt;margin-left:159.7pt;text-align:center;line-height:110%'><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>(1832,
'MDCCCXXXII'),</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:164.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>(1993, 'MCMXCIII'),</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:290.45pt;margin-bottom:
0in;margin-left:164.7pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>(2074, 'MMLXXIV'), (2152,
'MMCLII'),</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:164.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>(2212, 'MMCCXII'),</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:284.45pt;margin-bottom:
0in;margin-left:164.7pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>(2343, 'MMCCCXLIII'), (2499,
'MMCDXCIX'), (2574, 'MMDLXXIV'), (2646, 'MMDCXLVI'),</span></p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:303.45pt;
margin-bottom:8.5pt;margin-left:159.7pt;text-align:center;line-height:110%'><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>(2723,
'MMDCCXXIII'),</span></p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:303.45pt;
margin-bottom:8.5pt;margin-left:159.7pt;text-align:center;line-height:110%'><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>(2892,
'MMDCCCXCII'),</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:284.45pt;margin-bottom:
0in;margin-left:164.7pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>(2975, 'MMCMLXXV'), (3051,
'MMMLI'),</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:278.45pt;margin-bottom:
0in;margin-left:164.7pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>(3185, 'MMMCLXXXV'), (3250,
'MMMCCL'),</span></p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:303.45pt;
margin-bottom:8.5pt;margin-left:159.7pt;text-align:center;line-height:110%'><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>(3313,
'MMMCCCXIII'),</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:278.45pt;margin-bottom:
0in;margin-left:164.7pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>(3408, 'MMMCDVIII'), (3501,
'MMMDI'),</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:164.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>(3610, 'MMMDCX'),</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:266.45pt;margin-bottom:
0in;margin-left:164.7pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>(3743, 'MMMDCCXLIII'), (3844,
'MMMDCCCXLIV'),</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:242.45pt;margin-bottom:
4.1pt;margin-left:164.7pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>(3888, 'MMMDCCCLXXXVIII'),
(3940, 'MMMCMXL'),</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:30.85pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                                                                         </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>(3999,
'MMMCMXCIX'))           </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                            </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>def
test_to_roman_known_values(self):           </span><span style='font-family:
"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:176.45pt;margin-bottom:
.3pt;margin-left:86.7pt;text-align:justify;text-justify:inter-ideograph;
line-height:182%'><span style='font-size:10.0pt;line-height:182%;font-family:
"Liberation Mono"'>'''to_roman should give known result with known input''' for
integer, numeral in self.known_values: result = roman1.to_roman(integer) </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9315; </span><span
style='font-size:10.0pt;line-height:182%;font-family:"Liberation Mono"'>self.assertEqual(numeral,
result) </span><span style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9316;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>if __name__ == '__main__':</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.65pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>unittest.main()</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>To write a test case, first subclass the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>TestCase </span>class of the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>unittest
</span>module. This class provides many useful methods which you can use in
your test case to test specific conditions.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.15pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:155%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>This is a list
of integer/numeral pairs that I verified manually. It includes the lowest ten
numbers, the highest number, every number that translates to a single-character
Roman numeral, and a random sampling of other valid numbers. You don’t need to
test every possible input, but you should try to test all the obvious edge
cases.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Every individual test is its own method. A test method takes no
parameters, returns no value, and must have a name beginning with the four
letters <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>test</span>.
If a test method exits normally without raising an exception, the test is
considered passed; if the method raises an exception, the test is considered
failed.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Here you call the actual <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>to_roman() </span>function. (Well, the function
hasn’t been written yet, but once it is, this is the line that will call it.)
Notice that you have now defined the <span style='font-size:9.5pt;line-height:
154%'>API </span>for the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>to_roman() </span>function: it must take an
integer (the number to convert) and return a string (the Roman numeral
representation). If the <span style='font-size:9.5pt;line-height:154%'>API </span>is
different than that, this test is considered failed. Also notice that you are
not trapping any exceptions when you call <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>to_roman()</span>. This is
intentional. <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>to_roman()
</span>shouldn’t raise an exception when you call it with valid input, and
these input values are all valid. If <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>to_roman() </span>raises an exception, this
test is considered failed.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Assuming the <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>to_roman() </span>function was defined correctly, called
correctly, completed successfully, and returned a value, the last step is to
check whether it returned the <i>right </i>value. This is a common question,
and the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>TestCase
</span>class provides a method, <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>assertEqual</span>, to check whether two values
are equal. If the result returned from <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>to_roman() </span>(<span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>result</span>)
does not match the known value you were expecting (<span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>numeral</span>), <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>assertEqual
</span>will raise an exception and the test will fail. If the two values are
equal, <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>assertEqual
</span>will do nothing. If every value returned from <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>to_roman() </span>matches
the known value you expect, <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>assertEqual </span>never raises an exception, so
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>test_to_roman_known_values
</span>eventually exits normally, which means <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>to_roman() </span>has passed
this test.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.0pt;margin-left:16.4pt'><img width=298 height=1
src="Dive%20Into%20Python%203_files/image033.gif" align=left hspace=12>Once you
have a test case, you can start coding the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>to_roman() </span>function.
First, you should stub it out as an empty function and make sure the tests
fail. If the tests succeed before you’ve written any code, your tests aren’t
testing your code at all! Unit testing is a dance: tests lead, code follows.
Write a test that fails, then code until it passes.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.0pt;margin-bottom:
29.5pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono"'># roman1.py</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.0pt;margin-bottom:
8.25pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono"'>def to_roman(n):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.0pt;margin-bottom:
115.45pt;margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono"'>'''convert integer to Roman
numeral'''</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:28.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                            </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>pass                                   </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:51.2pt;margin-bottom:
20.85pt;margin-left:16.4pt;text-align:justify;text-justify:inter-ideograph;
text-indent:-17.15pt;line-height:155%'>1. At this stage, you want to define the
<span style='font-size:9.5pt;line-height:155%'>API </span>of the <span
style='font-size:10.0pt;line-height:155%;font-family:"Liberation Mono"'>to_roman()
</span>function, but you don’t want to code it yet. (Your test needs to fail
first.) To stub it out, use the Python reserved word <span style='font-size:
10.0pt;line-height:155%;font-family:"Liberation Mono"'>pass</span>, which does
precisely nothing.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>Execute <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>romantest1.py </span>on the command line to
run the test. If you call it with the <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>-v </span>command-line option, it will give
more verbose output so you can see exactly what’s going on as each test case
runs. With any luck, your output should look like this:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.95in;margin-bottom:
12.7pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#666677'>you@localhost:~/diveintopython3/examples$
</span><span style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>python3
romantest1.py -v</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:75.65pt;margin-bottom:
16.8pt;margin-left:37.9pt;line-height:180%'><span style='font-size:10.0pt;
line-height:180%;font-family:"Liberation Mono"'>test_to_roman_known_values
(__main__.KnownValues)     </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9312; </span><span style='font-size:10.0pt;line-height:180%;
font-family:"Liberation Mono"'>to_roman should give known result with known
input ... FAIL    </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:110.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>======================================================================
FAIL: to_roman should give known result with known input
---------------------------------------------------------------------Traceback
(most recent call last):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:38.45pt;margin-bottom:
4.15pt;margin-left:62.15pt;text-indent:-12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>File
&quot;romantest1.py&quot;, line 73, in test_to_roman_known_values
self.assertEqual(numeral, result)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:26.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>AssertionError:
'I' != None                                            </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>----------------------------------------------------------------------</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=582
 style='width:436.8pt;margin-left:38.15pt;border-collapse:collapse'>
 <tr style='height:.4in'>
  <td width=568 valign=top style='width:426.05pt;padding:0in 0in 0in 0in;
  height:.4in'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>Ran 1
  test in 0.016s</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:.4in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9315;</span></p>
  </td>
 </tr>
 <tr style='height:.4in'>
  <td width=568 valign=bottom style='width:426.05pt;padding:0in 0in 0in 0in;
  height:.4in'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>FAILED
  (failures=1)</span></p>
  </td>
  <td width=14 valign=bottom style='width:10.75pt;padding:0in 0in 0in 0in;
  height:.4in'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9316;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Running the script runs <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>unittest.main()</span>, which runs each test
case. Each test case is a method within a class in <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>romantest.py</span>. There is
no required organization of these test classes; they can each contain a single
test method, or you can have one class that contains multiple test methods. The
only requirement is that each test class must inherit from <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>unittest.TestCase</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>For each test case, the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>unittest </span>module will print out the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>docstring
</span>of the method and whether that test passed or failed. As expected, this
test case fails.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>For each failed test case, <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>unittest </span>displays the trace
information showing exactly what happened. In this case, the call to <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>assertEqual()
</span>raised an <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>AssertionError </span>because it was expecting <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>to_roman(1)
</span>to return</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'><span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>'I'</span>, but it didn’t. (Since there was no
explicit return statement, the function returned <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>None</span>, the Python null
value.)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>After the detail of each test, <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>unittest </span>displays a summary of how
many tests were performed and how long it took.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Overall, the test run failed because at least one test case did not
pass. When a test case doesn’t pass, <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>unittest </span>distinguishes between
failures and errors. A failure is a call to an <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>assertXYZ </span>method, like <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>assertEqual
</span>or <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>assertRaises</span>,
that fails because the asserted condition is not true or the expected exception
was not raised. An error is any other sort of exception raised in the code
you’re testing or the unit test case itself.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.95pt;margin-left:16.4pt'><i>Now</i>, finally, you can write the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>to_roman()
</span>function.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>roman_numeral_map = (('M',  1000),</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:361.7pt;margin-bottom:
.3pt;margin-left:163.95pt;text-align:justify;text-justify:inter-ideograph;
line-height:182%'><span style='font-size:10.0pt;line-height:182%;font-family:
"Liberation Mono"'>('CM', 900), ('D',  500), ('CD', 400),</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:361.7pt;margin-bottom:
.3pt;margin-left:163.95pt;text-align:justify;text-justify:inter-ideograph;
line-height:182%'><span style='font-size:10.0pt;line-height:182%;font-family:
"Liberation Mono"'>('C',  100), ('XC', 90), ('L',  50), ('XL', 40),</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:368.45pt;margin-bottom:
.3pt;margin-left:163.95pt;text-align:justify;text-justify:inter-ideograph;
line-height:182%'><span style='font-size:10.0pt;line-height:182%;font-family:
"Liberation Mono"'>('X',  10), ('IX', 9), ('V',  5),</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.4pt;
margin-left:164.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>('IV', 4),</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:26.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                                                                         </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>('I', 
1))                 </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def to_roman(n):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:284.45pt;margin-bottom:
4.05pt;margin-left:62.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>'''convert integer to Roman
numeral''' result = '' for numeral, integer in roman_numeral_map:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:261.65pt;margin-bottom:
0in;margin-left:110.2pt;text-indent:-24.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>while n
&gt;= integer:   </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9313; </span><span style='font-size:10.0pt;line-height:185%;
font-family:"Liberation Mono"'>result += numeral n -= integer</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.65pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>return result</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span><span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>roman_numeral_map
</span>is a tuple of tuples which defines three things: the character
representations of the most basic Roman numerals; the order of the Roman
numerals (in descending value order, from <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>M </span>all the way down to <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>I</span>);
the value of each Roman numeral. Each inner tuple is a pair of <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>(numeral,
value)</span>. It’s not just single-character Roman numerals; it also defines
two-character pairs like <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>CM </span>(“one hundred less than one
thousand”). This makes the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>to_roman() </span>function code simpler.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Here’s where the rich data structure of <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>roman_numeral_map </span>pays
off, because you don’t need any special logic to handle the subtraction rule.
To convert to Roman numerals, simply iterate through <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>roman_numeral_map </span>looking
for the largest integer value less than or equal to the input. Once found, add</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.4pt;margin-left:16.4pt'>the Roman numeral representation to the end of the
output, subtract the corresponding integer value from the input, lather, rinse,
repeat.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
18.9pt;margin-left:16.4pt'>If you’re still not clear how the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>to_roman()
</span>function works, add a <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>print() </span>call to the end of the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>while </span>loop:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:428.45pt;margin-bottom:
0in;margin-left:61.4pt;text-indent:-24.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>while n
&gt;= integer: result += numeral n -= integer</span></p>

<p class=MsoNormal align=right style='margin-top:0in;margin-right:44.45pt;
margin-bottom:31.45pt;margin-left:.5pt;text-align:right;line-height:110%'><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>print('subtracting
{0} from input, adding {1} to output'.format(integer, numeral))</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.95pt;margin-left:16.4pt'>With the debug <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>print() </span>statements, the
output looks like this:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:410.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>import
roman1 </span><span style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
185%;font-family:"Liberation Mono"'>roman1.to_roman(1424)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:236.45pt;margin-bottom:
22.9pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>subtracting 1000 from input,
adding M to output subtracting 400 from input, adding CD to output subtracting
10 from input, adding X to output subtracting 10 from input, adding X to output
subtracting 4 from input, adding IV to output 'MCDXXIV'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:33.95pt;margin-bottom:
19.05pt;margin-left:16.4pt'>So the <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>to_roman() </span>function appears to work,
at least in this manual spot check. But will it pass the test case you wrote?</p>

<p class=MsoNormal style='margin-top:0in;margin-right:8.4pt;margin-bottom:4.2pt;
margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;line-height:
185%;font-family:"Liberation Mono";color:#666677'>you@localhost:~/diveintopython3/examples$
</span><span style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>python3
romantest1.py -v test_to_roman_known_values (__main__.KnownValues)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:26.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>to_roman
should give known result with known input ... ok               </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:122.45pt;margin-bottom:
21.0pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>---------------------------------------------------------------------Ran
1 test in 0.016s</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>OK</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.55pt;margin-left:16.65pt;text-indent:-16.65pt'>1.   Hooray! The <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>to_roman()
</span>function passes the “known values” test case. It’s not comprehensive,
but it does put the function through its paces with a variety of inputs,
including inputs that produce every singlecharacter Roman numeral, the largest
possible input (<span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>3999</span>), and the input that produces the longest
possible Roman numeral (<span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>3888</span>). At this point, you can be
reasonably confident that the function works for any good input value you could
throw at it.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
46.55pt;margin-left:16.4pt'>“Good” input? Hmm. What about bad input?</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:33.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h4 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>9.3.
“H</span>ALT <span style='font-size:18.0pt;line-height:112%'>A</span>ND <span
style='font-size:18.0pt;line-height:112%'>C</span>ATCH <span style='font-size:
18.0pt;line-height:112%'>F</span>IRE<span style='font-size:18.0pt;line-height:
112%'>”</span></h4>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.05pt;margin-left:16.4pt'><img width=298 height=1
src="Dive%20Into%20Python%203_files/image033.gif" align=left hspace=12>It is
not enough to test that functions succeed when given good input; you must also
test that they fail when given bad input. And not just any sort of failure;
they must fail in the way you expect.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.0pt;margin-bottom:
8.25pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>import
roman1</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.0pt;margin-bottom:
8.25pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>roman1.to_roman(4000)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.0pt;margin-bottom:
8.25pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono"'>'MMMM'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.0pt;margin-bottom:
8.25pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>roman1.to_roman(5000)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.0pt;margin-bottom:
12.65pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono"'>'MMMMM'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.0pt;margin-bottom:
5.7pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>roman1.to_roman(9000)
</span><span style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.0pt;margin-bottom:
31.05pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono"'>'MMMMMMMMM'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:41.0pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.   That’s definitely not what
you wanted — that’s not even a valid Roman numeral! In fact, each of these
numbers is outside the range of acceptable input, but the function returns a
bogus value anyway. Silently returning bad values is <i>baaaaaaad</i>; if a
program is going to fail, it is far better if it fails quickly and noisily.
“Halt and catch fire,” as the saying goes. The Pythonic way to halt and catch
fire is to raise an exception.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:288.5pt;margin-bottom:
21.5pt;margin-left:16.4pt'>The question to ask yourself is, “How can I express
this as a testable requirement?” How’s this for starters:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.35pt;margin-left:39.65pt'><img width=298 height=1
src="Dive%20Into%20Python%203_files/image033.gif" align=left hspace=12>The <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>to_roman()
</span>function should raise an <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>OutOfRangeError </span>when given an integer
greater than <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>3999</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
64.6pt;margin-left:16.4pt'>What would that test look like?</p>

<p class=MsoNormal style='margin-top:0in;margin-right:87.65pt;margin-bottom:
0in;margin-left:61.4pt;text-indent:-24.0pt;line-height:180%'><span
style='font-size:10.0pt;line-height:180%;font-family:"Liberation Mono"'>class
ToRomanBadInput(unittest.TestCase): </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9312; </span><span style='font-size:10.0pt;line-height:180%;
font-family:"Liberation Mono"'>def test_too_large(self):     </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:8.45pt;margin-bottom:
18.9pt;margin-left:86.7pt;line-height:180%'><span style='font-size:10.0pt;
line-height:180%;font-family:"Liberation Mono"'>'''to_roman should fail with
large input''' self.assertRaises(roman2.OutOfRangeError, roman2.to_roman, 4000)
</span><span style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Like the previous test case, you create a class that inherits from <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>unittest.TestCase</span>.
You can have more than one test per class (as you’ll see later in this
chapter), but I chose to create a new class here because this test is something
different than the last one. We’ll keep all the good input tests together in
one class, and all the bad input tests together in another.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
7.05pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Like the
previous test case, the test itself is a method of the class, with a name
starting with <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>test</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.9pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>unittest.TestCase
</span>class provides the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>assertRaises </span>method, which takes the
following arguments: the exception you’re expecting, the function you’re
testing, and the arguments you’re passing to that function. (If the function
you’re testing takes more than one argument, pass them all to <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>assertRaises</span>,
in order, and it will pass them right along to the function you’re testing.)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>Pay close attention to this last line of code.
Instead of calling <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>to_roman() </span>directly and manually checking that it
raises a particular exception (by wrapping it in <u>a </u><u><span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>try...except
</span>block</u>), the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>assertRaises </span>method has encapsulated all
of that for us. All you do is tell it what exception you’re expecting</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>(<span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>roman2.OutOfRangeError</span>), the function (<span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>to_roman()</span>),
and the function’s arguments (<span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>4000</span>). The <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>assertRaises </span>method
takes care of calling <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>to_roman() </span>and checking that it raises <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>roman2.OutOfRangeError</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.55pt;margin-left:16.4pt'>Also note that you’re passing the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>to_roman()
</span>function itself as an argument; you’re not calling it, and you’re not
passing the name of it as a string. Have I mentioned recently how handy it is
that <u>everything in Python is an object</u>?</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.9pt;margin-left:16.4pt'>So what happens when you run the test suite with
this new test?</p>

<p class=MsoNormal style='margin-top:0in;margin-right:164.4pt;margin-bottom:
4.2pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>you@localhost:~/diveintopython3/examples$
</span><span style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>python3
romantest2.py -v test_to_roman_known_values (__main__.KnownValues) to_roman
should give known result with known input ... ok test_too_large
(__main__.ToRomanBadInput)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:26.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>to_roman
should fail with large input ... ERROR                         </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>======================================================================</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:86.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>ERROR: to_roman should fail
with large input
---------------------------------------------------------------------Traceback
(most recent call last):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:14.45pt;margin-bottom:
4.25pt;margin-left:62.15pt;text-indent:-12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>File
&quot;romantest2.py&quot;, line 78, in test_too_large
self.assertRaises(roman2.OutOfRangeError, roman2.to_roman, 4000)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:26.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>AttributeError:
'module' object has no attribute 'OutOfRangeError'      </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>----------------------------------------------------------------------</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>Ran 2 tests in 0.000s</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>FAILED (errors=1)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>You should have expected this to fail (since you haven’t written any
code to pass it yet), but... it didn’t actually “fail,” it had an “error”
instead. This is a subtle but important distinction. A unit test actually has <i>three
</i>return values: pass, fail, and error. Pass, of course, means that the test
passed — the code did what you expected. “Fail” is what the previous test case
did (until you wrote code to make it pass) — it executed the code but the
result was not what you expected. “Error” means that the code didn’t even
execute properly.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.05pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Why didn’t the code execute properly? The traceback tells all. The
module you’re testing doesn’t have an exception called <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>OutOfRangeError</span>.
Remember, you passed this exception to the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>assertRaises() </span>method,
because it’s the exception you want the function to raise given an out-of-range
input. But the exception doesn’t exist, so the call to the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>assertRaises()
</span>method failed. It never got a chance to test the <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>to_roman() </span>function;
it didn’t get that far.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
24.05pt;margin-left:16.4pt'>To solve this problem, you need to define the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>OutOfRangeError
</span>exception in <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>roman2.py</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:309.65pt;margin-bottom:
19.15pt;margin-left:61.4pt;text-indent:-24.0pt;line-height:175%'><span
style='font-size:10.0pt;line-height:175%;font-family:"Liberation Mono"'>class
OutOfRangeError(ValueError): </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9312; </span><span style='font-size:10.0pt;line-height:175%;
font-family:"Liberation Mono"'>pass </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Exceptions are classes. An “out of range” error is a kind of value error
— the argument value is out of its acceptable range. So this exception inherits
from the built-in <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>ValueError </span>exception. This is not strictly necessary
(it could just inherit from the base <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>Exception </span>class), but it feels
right.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.55pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Exceptions don’t actually do anything, but you need at least one line of
code to make a class. Calling <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>pass </span>does precisely nothing, but it’s a
line of Python code, so that makes it a class.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.9pt;margin-left:16.4pt'>Now run the test suite again.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:164.4pt;margin-bottom:
4.2pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>you@localhost:~/diveintopython3/examples$
</span><span style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>python3
romantest2.py -v test_to_roman_known_values (__main__.KnownValues) to_roman
should give known result with known input ... ok test_too_large
(__main__.ToRomanBadInput)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:26.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>to_roman
should fail with large input ... FAIL                          </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>======================================================================</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:86.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>FAIL: to_roman should fail with
large input
---------------------------------------------------------------------Traceback
(most recent call last):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:14.45pt;margin-bottom:
4.2pt;margin-left:62.15pt;text-indent:-12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>File
&quot;romantest2.py&quot;, line 78, in test_too_large
self.assertRaises(roman2.OutOfRangeError, roman2.to_roman, 4000)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:26.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>AssertionError:
OutOfRangeError not raised by to_roman                 </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>----------------------------------------------------------------------</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>Ran 2 tests in 0.016s</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>FAILED (failures=1)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The new test is still not passing, but it’s not returning an error
either. Instead, the test is failing. That’s progress! It means the call to the
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>assertRaises()
</span>method succeeded this time, and the unit test framework actually tested
the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>to_roman()
</span>function.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.55pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Of course, the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>to_roman() </span>function isn’t raising the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>OutOfRangeError
</span>exception you just defined, because you haven’t told it to do that yet.
That’s excellent news! It means this is a valid test case — it fails before you
write the code to make it pass.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.9pt;margin-left:16.4pt'>Now you can write the code to make this test pass.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def to_roman(n):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:296.45pt;margin-bottom:
4.25pt;margin-left:62.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>'''convert integer to Roman
numeral''' if n &gt; 3999:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:26.65pt;
margin-left:86.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>raise OutOfRangeError('number out of range
(must be less than 4000)') </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:284.45pt;margin-bottom:
0in;margin-left:62.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>result = '' for numeral,
integer in roman_numeral_map:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:380.45pt;margin-bottom:
0in;margin-left:110.2pt;text-indent:-24.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>while n
&gt;= integer: result += numeral n -= integer</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.75pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>return result</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.55pt;margin-left:16.65pt;text-indent:-16.65pt'>1.   This is straightforward:
if the given input (<span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>n</span>) is greater than <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>3999</span>, raise an <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>OutOfRangeError
</span>exception. The unit test does not check the human-readable string that
accompanies the exception, although you could write another test that did check
it (but watch out for internationalization issues for strings that vary by the
user’s language or environment).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>Does this make the test pass? Let’s
find out.</p>

</div>

<span style='font-size:12.0pt;line-height:154%;font-family:"Gill Sans MT",sans-serif;
color:black'><br clear=all style='page-break-before:always'>
</span>

<div class=WordSection14>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:0in;
margin-bottom:50.5pt;margin-left:159.7pt;text-align:center;line-height:110%'><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>python3
romantest2.py -v</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>test_too_large (__main__.ToRomanBadInput)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:26.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>to_roman
should fail with large input ... ok                            </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:89.05pt;margin-bottom:
21.0pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>---------------------------------------------------------------------Ran
2 tests in 0.000s</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>OK</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:45.7pt;
margin-left:16.65pt;text-indent:-16.65pt'>1.   Hooray! Both tests pass. Because
you worked iteratively, bouncing back and forth between testing and coding, you
can be sure that the two lines of code you just wrote were the cause of that
one test going from “fail” to “pass.” That kind of confidence doesn’t come
cheap, but it will pay for itself over the lifetime of your code.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:0in;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h4 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>9.4.
M</span>ORE <span style='font-size:18.0pt;line-height:112%'>H</span>ALTING<span
style='font-size:18.0pt;line-height:112%'>, M</span>ORE <span style='font-size:
18.0pt;line-height:112%'>F</span>IRE</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:19.05pt;
margin-left:16.4pt'>Along with testing numbers that are too large, you need to
test numbers that are too small. As <u>we noted in our functional requirements</u>,
Roman numerals cannot express 0 or negative numbers.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>import
roman2</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>roman2.to_roman(0)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>''</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>roman2.to_roman(-1)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>''</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>Well <i>that’s </i>not good. Let’s
add tests for each of these conditions.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>class ToRomanBadInput(unittest.TestCase):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def test_too_large(self):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
margin-left:86.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'''to_roman should fail with large input'''</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:26.65pt;
margin-left:86.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>self.assertRaises(roman3.OutOfRangeError,
roman3.to_roman, 4000) </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def test_zero(self):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
margin-left:86.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'''to_roman should fail with 0 input'''</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:26.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                                      </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>self.assertRaises(roman3.OutOfRangeError,
roman3.to_roman, 0)     </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def test_negative(self):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:18.9pt;
margin-left:86.7pt;line-height:180%'><span style='font-size:10.0pt;line-height:
180%;font-family:"Liberation Mono"'>'''to_roman should fail with negative
input''' self.assertRaises(roman3.OutOfRangeError, roman3.to_roman, -1)  </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>test_too_large()
</span>method has not changed since the previous step. I’m including it here to
show where the new code fits.</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Here’s a new
test: the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>test_zero()
</span>method. Like the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>test_too_large() </span>method, it tells the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>assertRaises()
</span>method defined in <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>unittest.TestCase </span>to call our <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>to_roman()
</span>function with a parameter of 0, and check that it raises the appropriate
exception, <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>OutOfRangeError</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:20.5pt;
margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>test_negative()
</span>method is almost identical, except it passes <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>-1 </span>to the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>to_roman()
</span>function. If either of these new tests does <i>not </i>raise an <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>OutOfRangeError
</span>(either because the function returns an actual value, or because it
raises some other exception), the test is considered failed.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>Now check that the tests fail:</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:0in;
margin-bottom:71.5pt;margin-left:159.7pt;text-align:center;line-height:110%'><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>python3
romantest3.py -v</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:233.05pt;margin-bottom:
21.0pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>to_roman should fail with
negative input ... FAIL test_too_large (__main__.ToRomanBadInput) to_roman
should fail with large input ... ok test_zero (__main__.ToRomanBadInput)
to_roman should fail with 0 input ... FAIL</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>======================================================================</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:53.05pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>FAIL: to_roman should fail with
negative input
---------------------------------------------------------------------Traceback
(most recent call last):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:62.15pt;text-indent:-12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>File
&quot;romantest3.py&quot;, line 86, in test_negative
self.assertRaises(roman3.OutOfRangeError, roman3.to_roman, -1)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>AssertionError: OutOfRangeError not raised
by to_roman</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>======================================================================</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:53.05pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>FAIL: to_roman should fail with
0 input
---------------------------------------------------------------------Traceback
(most recent call last):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:11.05pt;margin-bottom:
0in;margin-left:62.15pt;text-indent:-12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>File
&quot;romantest3.py&quot;, line 82, in test_zero
self.assertRaises(roman3.OutOfRangeError, roman3.to_roman, 0)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>AssertionError: OutOfRangeError not raised
by to_roman</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>----------------------------------------------------------------------</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>Ran 4 tests in 0.000s</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>FAILED (failures=2)</span></p>

<p class=MsoNormal style='margin-left:16.4pt'>Excellent. Both tests failed, as
expected. Now let’s switch over to the code and see what we can do to make them
pass.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def to_roman(n):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.6pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'''convert integer to Roman numeral'''</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:54.2pt;margin-bottom:
16.75pt;margin-left:86.15pt;text-indent:-24.0pt;line-height:180%'><span
style='font-size:10.0pt;line-height:180%;font-family:"Liberation Mono"'>if not
(0 &lt; n &lt; 4000):    </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9312; </span><span style='font-size:10.0pt;line-height:180%;
font-family:"Liberation Mono"'>raise OutOfRangeError('number out of range (must
be 1..3999)') </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:251.05pt;margin-bottom:
0in;margin-left:62.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>result = '' for numeral,
integer in roman_numeral_map:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:347.0pt;margin-bottom:
0in;margin-left:110.2pt;text-indent:-24.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>while n
&gt;= integer: result += numeral n -= integer</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.55pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>return result</span></p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>This is a nice
Pythonic shortcut: multiple comparisons at once. This is equivalent to <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>if not
((0 &lt; n) and (n &lt; 4000))</span>, but it’s much easier to read. This one
line of code should catch inputs that are too large, negative, or zero.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:20.55pt;
margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>If you change your conditions, make sure to update your human-readable
error strings to match. The <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>unittest </span>framework won’t care, but it’ll
make it difficult to do manual debugging if your code is throwing
incorrectly-described exceptions.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>I could show you a whole series of unrelated examples
to show that the multiple-comparisons-at-once shortcut works, but instead I’ll
just run the unit tests and prove it.</p>

</div>

<span style='font-size:12.0pt;line-height:154%;font-family:"Gill Sans MT",sans-serif;
color:black'><br clear=all style='page-break-before:always'>
</span>

<div class=WordSection15>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:.1pt;
margin-bottom:92.5pt;margin-left:159.7pt;text-align:center;line-height:110%'><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>python3
romantest3.py -v</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:263.15pt;margin-bottom:
21.0pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>test_too_large
(__main__.ToRomanBadInput) to_roman should fail with large input ... ok
test_zero (__main__.ToRomanBadInput) to_roman should fail with 0 input ... ok</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:89.15pt;margin-bottom:
21.0pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>---------------------------------------------------------------------Ran
4 tests in 0.016s</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:56.15pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>OK</span></p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:.1pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h4 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>9.5.
A</span>ND <span style='font-size:18.0pt;line-height:112%'>O</span>NE <span
style='font-size:18.0pt;line-height:112%'>M</span>ORE <span style='font-size:
18.0pt;line-height:112%'>T</span>HING<span style='font-size:18.0pt;line-height:
112%'>…</span></h4>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:18.9pt;
margin-left:16.4pt'>There was one more <u>functional requirement </u>for
converting numbers to Roman numerals: dealing with nonintegers.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.6pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>import
roman3</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>roman3.to_roman(0.5)
</span><span style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.6pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>''</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>roman3.to_roman(1.0)
</span><span style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'I'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Oh, that’s bad.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
22.1pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Oh, that’s even worse. Both of these cases should raise an exception.
Instead, they give bogus results.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>Testing for non-integers is not
difficult. First, define a <span style='font-size:10.0pt;line-height:107%;
font-family:"Liberation Mono"'>NotIntegerError </span>exception.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'># roman4.py</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>class OutOfRangeError(ValueError): pass</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.85pt;
margin-left:37.9pt;line-height:110%;background:gainsboro'><b><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>class
NotIntegerError(ValueError): pass</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.95pt;margin-left:16.4pt'>Next, write a test case that checks for the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>NotIntegerError
</span>exception.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>class ToRomanBadInput(unittest.TestCase):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:491.1pt;margin-bottom:
0in;margin-left:62.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>. .</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def test_non_integer(self):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:86.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'''to_roman should fail with non-integer
input'''</span></p>

<p class=MsoNormal align=right style='margin-top:0in;margin-right:101.1pt;
margin-bottom:31.05pt;margin-left:.5pt;text-align:right;line-height:110%;
background:gainsboro'><b><span style='font-size:10.0pt;line-height:110%;
font-family:"Liberation Mono"'>self.assertRaises(roman4.NotIntegerError,
roman4.to_roman, 0.5)</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>Now check that the test fails
properly.<br clear=all style='page-break-before:always'>
</p>

<p class=MsoNormal align=right style='margin-top:0in;margin-right:131.1pt;
margin-bottom:92.5pt;margin-left:.5pt;text-align:right;line-height:110%'><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>python3
romantest4.py -v</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:215.15pt;margin-bottom:
21.0pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>test_non_integer
(__main__.ToRomanBadInput) to_roman should fail with non-integer input ... FAIL
test_too_large (__main__.ToRomanBadInput) to_roman should fail with large input
... ok test_zero (__main__.ToRomanBadInput) to_roman should fail with 0 input
... ok</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:77.15pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>======================================================================
FAIL: to_roman should fail with non-integer input
---------------------------------------------------------------------Traceback
(most recent call last):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:62.15pt;text-indent:-12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>File
&quot;romantest4.py&quot;, line 90, in test_non_integer
self.assertRaises(roman4.NotIntegerError, roman4.to_roman, 0.5)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:37.9pt;line-height:110%;background:gainsboro'><b><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>AssertionError:
NotIntegerError not raised by to_roman</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>----------------------------------------------------------------------</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>Ran 5 tests in 0.000s</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>FAILED (failures=1)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>Write the code that makes the test
pass.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def to_roman(n):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:263.1pt;margin-bottom:
0in;margin-left:62.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>'''convert integer to Roman
numeral''' if not (0 &lt; n &lt; 4000):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:86.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>raise OutOfRangeError('number out of range
(must be 1..3999)')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:54.3pt;margin-bottom:
16.75pt;margin-left:86.15pt;text-indent:-24.0pt;line-height:180%'><span
style='font-size:10.0pt;line-height:180%;font-family:"Liberation Mono"'>if not
isinstance(n, int):      </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9312; </span><span style='font-size:10.0pt;line-height:180%;
font-family:"Liberation Mono"'>raise NotIntegerError('non-integers can not be
converted')      </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:251.1pt;margin-bottom:
0in;margin-left:62.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>result = '' for numeral,
integer in roman_numeral_map:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:347.1pt;margin-bottom:
0in;margin-left:110.2pt;text-indent:-24.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>while n
&gt;= integer: result += numeral n -= integer</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.5pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>return result</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The built-in <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>isinstance() </span>function tests whether a variable is a
particular type (or, technically, any descendant type).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.45pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>If the argument <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>n </span>is not an <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>int</span>, raise our newly
minted <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>NotIntegerError
</span>exception.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>Finally, check that the code does
indeed make the test pass.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:.1pt;
margin-bottom:92.5pt;margin-left:159.7pt;text-align:center;line-height:110%'><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>python3
romantest4.py -v</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:227.15pt;margin-bottom:
21.0pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>test_non_integer
(__main__.ToRomanBadInput) to_roman should fail with non-integer input ... ok
test_too_large (__main__.ToRomanBadInput) to_roman should fail with large input
... ok test_zero (__main__.ToRomanBadInput) to_roman should fail with 0 input ...
ok</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:89.15pt;margin-bottom:
21.0pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>---------------------------------------------------------------------Ran
5 tests in 0.000s</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.45pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>OK</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:45.2pt;
margin-left:16.4pt'>The <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>to_roman() </span>function passes all of its
tests, and I can’t think of any more tests, so it’s time to move on to <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>from_roman()</span>.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:.1pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h4 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>9.6.
A P</span>LEASING <span style='font-size:18.0pt;line-height:112%'>S</span>YMMETRY</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:20.55pt;
margin-left:16.4pt'>Converting a string from a Roman numeral to an integer
sounds more difficult than converting an integer to a Roman numeral. Certainly
there is the issue of validation. It’s easy to check if an integer is greater
than 0, but a bit harder to check whether a string is a valid Roman numeral.
But we already constructed <u>a regular expression to check for Roman numerals</u>,
so that part is done.</p>

<p class=MsoNormal style='margin-left:16.4pt'>That leaves the problem of
converting the string itself. As we’ll see in a minute, thanks to the rich data
structure we defined to map individual Roman numerals to integer values, the
nitty-gritty of the <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>from_roman() </span>function is as straightforward as the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>to_roman()
</span>function.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:19.05pt;
margin-left:16.4pt'>But first, the tests. We’ll need a “known values” test to
spot-check for accuracy. Our test suite already contains <u>a mapping of known
values</u>; let’s reuse that.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def test_from_roman_known_values(self):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:131.1pt;margin-bottom:
23.3pt;margin-left:86.7pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>'''from_roman should give known
result with known input''' for integer, numeral in self.known_values: result =
roman5.from_roman(numeral) self.assertEqual(integer, result)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:19.0pt;
margin-left:16.4pt'>There’s a pleasing symmetry here. The <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>to_roman()
</span>and <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>from_roman()
</span>functions are inverses of each other. The first converts integers to
specially-formatted strings, the second converts specially-formated strings to
integers. In theory, we should be able to “round-trip” a number by passing to
the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>to_roman()
</span>function to get a string, then passing that string to the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>from_roman()
</span>function to get an integer, and end up with the same number.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.3pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>n = from_roman(to_roman(n)) for all values
of n</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:18.95pt;
margin-left:16.4pt'>In this case, “all values” means any number between <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>1..3999</span>,
since that is the valid range of inputs to the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>to_roman() </span>function. We
can express this symmetry in a test case that runs through all the values <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>1..3999</span>,
calls <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>to_roman()</span>,
calls <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>from_roman()</span>,
and checks that the output is the same as the original input.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>class RoundtripCheck(unittest.TestCase):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def test_roundtrip(self):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:209.1pt;margin-bottom:
0in;margin-left:86.7pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>'''from_roman(to_roman(n))==n
for all n''' for integer in range(1, 4000):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:215.1pt;margin-bottom:
22.95pt;margin-left:110.7pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>numeral =
roman5.to_roman(integer) result = roman5.from_roman(numeral)
self.assertEqual(integer, result)</span></p>

<p class=MsoNormal style='margin-left:16.4pt'>These new tests won’t even fail
yet. We haven’t defined a <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>from_roman() </span>function at all, so they’ll
just raise errors.</p>

</div>

<span style='font-size:12.0pt;line-height:154%;font-family:"Gill Sans MT",sans-serif;
color:black'><br clear=all style='page-break-before:always'>
</span>

<div class=WordSection16>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:51.45pt;
margin-bottom:8.5pt;margin-left:159.7pt;text-align:center;line-height:110%'><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>python3
romantest5.py</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>E.E....</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:140.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>======================================================================
ERROR: test_from_roman_known_values (__main__.KnownValues) from_roman should
give known result with known input
---------------------------------------------------------------------Traceback
(most recent call last):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:140.45pt;margin-bottom:
0in;margin-left:62.15pt;text-indent:-12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>File
&quot;romantest5.py&quot;, line 78, in test_from_roman_known_values result =
roman5.from_roman(numeral)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>AttributeError: 'module' object has no
attribute 'from_roman'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:122.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>======================================================================
ERROR: test_roundtrip (__main__.RoundtripCheck) from_roman(to_roman(n))==n for
all n
---------------------------------------------------------------------Traceback
(most recent call last):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:218.45pt;margin-bottom:
0in;margin-left:62.15pt;text-indent:-12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>File
&quot;romantest5.py&quot;, line 103, in test_roundtrip result =
roman5.from_roman(numeral)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>AttributeError: 'module' object has no
attribute 'from_roman'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>----------------------------------------------------------------------</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>Ran 7 tests in 0.019s</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>FAILED (errors=2)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.9pt;margin-left:16.4pt'>A quick stub function will solve that problem.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:452.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'># roman5.py def from_roman(s):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'''convert Roman numeral to integer'''</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>(Hey, did you notice that? I defined a function with
nothing but a <u>docstring</u>. That’s legal Python. In fact, some programmers
swear by it. “Don’t stub; document!”)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.9pt;margin-left:16.4pt'>Now the test cases will actually fail.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.95in;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>you@localhost:~/diveintopython3/examples$
</span><span style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>python3
romantest5.py F.F....</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:140.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>======================================================================
FAIL: test_from_roman_known_values (__main__.KnownValues) from_roman should
give known result with known input
---------------------------------------------------------------------Traceback
(most recent call last):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:26.45pt;margin-bottom:
0in;margin-left:62.15pt;text-indent:-12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>File
&quot;romantest5.py&quot;, line 79, in test_from_roman_known_values
self.assertEqual(integer, result)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>AssertionError: 1 != None</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:128.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>======================================================================
FAIL: test_roundtrip (__main__.RoundtripCheck) from_roman(to_roman(n))==n for
all n
---------------------------------------------------------------------Traceback
(most recent call last):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:104.45pt;margin-bottom:
0in;margin-left:62.15pt;text-indent:-12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>File
&quot;romantest5.py&quot;, line 104, in test_roundtrip
self.assertEqual(integer, result)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>AssertionError: 1 != None</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>----------------------------------------------------------------------</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>Ran 7 tests in 0.002s</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.95pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>FAILED (failures=2)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>Now it’s time to write the <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>from_roman()
</span>function.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def from_roman(s):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:284.45pt;margin-bottom:
4.2pt;margin-left:62.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>&quot;&quot;&quot;convert Roman
numeral to integer&quot;&quot;&quot; result = 0 index = 0 for numeral, integer
in roman_numeral_map:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:219.65pt;margin-bottom:
0in;margin-left:110.2pt;text-indent:-24.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>while
s[index:index+len(numeral)] == numeral: </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9312; </span><span style='font-size:10.0pt;line-height:185%;
font-family:"Liberation Mono"'>result += integer index += len(numeral)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.4pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>return result</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.45pt;margin-left:16.65pt;text-indent:-16.65pt'>1.   The pattern here is the
same as the <u><span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>to_roman()
</span></u>function. You iterate through your Roman numeral data structure (a
tuple of tuples), but instead of matching the highest integer values as often
as possible, you match the “highest” Roman numeral character strings as often
as possible.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.9pt;margin-left:16.4pt'>If you're not clear how <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>from_roman() </span>works, add
a <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>print
</span>statement to the end of the <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>while </span>loop:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def from_roman(s):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:284.45pt;margin-bottom:
0in;margin-left:62.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>&quot;&quot;&quot;convert Roman
numeral to integer&quot;&quot;&quot; result = 0 index = 0 for numeral, integer
in roman_numeral_map:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:86.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>while s[index:index+len(numeral)] ==
numeral:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:356.45pt;margin-bottom:
0in;margin-left:110.7pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>result += integer index +=
len(numeral)</span></p>

<p class=MsoNormal align=right style='margin-top:0in;margin-right:61.7pt;
margin-bottom:31.05pt;margin-left:.5pt;text-align:right;line-height:110%;
background:gainsboro'><b><span style='font-size:10.0pt;line-height:110%;
font-family:"Liberation Mono"'>print('found', numeral, 'of length',
len(numeral), ', adding', integer)</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>import
roman5</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:362.45pt;margin-bottom:
22.55pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>roman5.from_roman('MCMLXXII')
found M of length 1, adding 1000 found CM of length 2, adding 900 found L of
length 1, adding 50 found X of length 1, adding 10 found X of length 1, adding
10 found I of length 1, adding 1 found I of length 1, adding 1 1972</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.9pt;margin-left:16.4pt'>Time to re-run the tests.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.95in;margin-bottom:
21.0pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>you@localhost:~/diveintopython3/examples$
</span><span style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>python3
romantest5.py .......
---------------------------------------------------------------------Ran 7
tests in 0.060s</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.5pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>OK</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
45.65pt;margin-left:16.4pt'>Two pieces of exciting news here. The first is that
the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>from_roman()
</span>function works for good input, at least for all the <u>known values</u>.
The second is that the “round trip” test also passed. Combined with the known
values tests, you can be reasonably sure that both the <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>to_roman() </span>and <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>from_roman()
</span>functions work properly for all possible good values. (This is not
guaranteed; it is theoretically possible that <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>to_roman() </span>has a bug
that produces the wrong Roman numeral for some particular set of inputs, <i>and
</i>that <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>from_roman()
</span>has a reciprocal bug that produces the same wrong integer values for
exactly that set of Roman numerals that <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>to_roman() </span>generated
incorrectly. Depending on your application and your requirements, this
possibility may bother you; if so, write more comprehensive test cases until it
doesn't bother you.)</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:33.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h4 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>9.7.
M</span>ORE <span style='font-size:18.0pt;line-height:112%'>B</span>AD <span
style='font-size:18.0pt;line-height:112%'>I</span>NPUT</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.55pt;margin-left:16.4pt'>Now that the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>from_roman() </span>function
works properly with good input, it's time to fit in the last piece of the
puzzle: making it work properly with bad input. That means finding a way to
look at a string and determine if it's a valid Roman numeral. This is
inherently more difficult than <u>validating numeric input </u>in the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>to_roman()
</span>function, but you have a powerful tool at your disposal: regular
expressions. (If you’re not familiar with regular expressions, now would be a
good time to read <u>the regular expressions chapter</u>.)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.25pt;margin-left:16.4pt'>As you saw in <u>Case Study: Roman Numerals</u>,
there are several simple rules for constructing a Roman numeral, using the
letters <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>M</span>,
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>D</span>,
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>C</span>,
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>L</span>,
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>X</span>,
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>V</span>,
and <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>I</span>.
Let's review the rules:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
8.15pt;margin-left:16.65pt;text-indent:-12.25pt;line-height:107%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Sometimes
characters are additive. <span style='font-size:10.0pt;line-height:107%;
font-family:"Liberation Mono"'>I </span>is <span style='font-size:10.0pt;
line-height:107%;font-family:"Liberation Mono"'>1</span>, <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>II </span>is
<span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>2</span>,
and <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>III
</span>is <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>3</span>.
<span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>VI
</span>is <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>6
</span>(literally, “<span style='font-size:10.0pt;line-height:107%;font-family:
"Liberation Mono"'>5 </span>and <span style='font-size:10.0pt;line-height:107%;
font-family:"Liberation Mono"'>1</span>”), <span style='font-size:10.0pt;
line-height:107%;font-family:"Liberation Mono"'>VII </span>is <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>7</span>,
and</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.8pt;
margin-left:17.15pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>VIII </span>is <span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono"'>8</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-12.25pt'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The tens characters (<span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>I</span>, <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>X</span>, <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>C</span>,
and <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>M</span>)
can be repeated up to three times. At <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>4</span>, you need to subtract from the
next highest fives character. You can't represent <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>4 </span>as <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>IIII</span>;
instead, it is represented as <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>IV </span>(“<span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>1 </span>less than <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>5</span>”).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'><span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>40 </span>is written as <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>XL </span>(“<span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>10 </span>less
than <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>50</span>”),
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>41
</span>as <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>XLI</span>,
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>42
</span>as <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>XLII</span>,
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>43
</span>as <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>XLIII</span>,
and then <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>44
</span>as <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>XLIV
</span>(“<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>10
</span>less than <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>50</span>, then <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>1 </span>less than <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>5</span>”).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-12.25pt'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Sometimes characters are… the opposite of additive. By putting certain
characters before others, you subtract from the final value. For example, at <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>9</span>,
you need to subtract from the next highest tens character: <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>8 </span>is
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>VIII</span>,
but <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>9
</span>is <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>IX
</span>(“<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>1
</span>less than <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>10</span>”), not <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>VIIII </span>(since the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>I </span>character
can not be repeated four times). <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>90 </span>is <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>XC</span>, <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>900 </span>is
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>CM</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
8.35pt;margin-left:16.65pt;text-indent:-12.25pt;line-height:107%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The fives
characters can not be repeated. <span style='font-size:10.0pt;line-height:107%;
font-family:"Liberation Mono"'>10 </span>is always represented as <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>X</span>,
never as <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>VV</span>.
<span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>100
</span>is always <span style='font-size:10.0pt;line-height:107%;font-family:
"Liberation Mono"'>C</span>, never</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:17.15pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>LL</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.95pt;margin-left:16.65pt;text-indent:-12.25pt'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Roman numerals are read left to right, so the order of characters
matters very much. <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>DC </span>is <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>600</span>; <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>CD </span>is a completely
different number (<span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>400</span>, “<span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>100 </span>less than <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>500</span>”). <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>CI </span>is
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>101</span>;
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>IC
</span>is not even a valid Roman numeral (because you can't subtract <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>1 </span>directly
from <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>100</span>;
you would need to write it as <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>XCIX</span>, “<span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>10 </span>less than <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>100</span>,
then <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>1
</span>less than <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>10</span>”).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>Thus, one useful test would be to ensure that the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>from_roman()
</span>function should fail when you pass it a string with too many repeated
numerals. How many is “too many” depends on the numeral.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>class FromRomanBadInput(unittest.TestCase):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def test_too_many_repeated_numerals(self):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:134.45pt;margin-bottom:
0in;margin-left:86.7pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>'''from_roman should fail with
too many repeated numerals''' for s in ('MMMM', 'DD', 'CCCC', 'LL', 'XXXX',
'VV', 'IIII'):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.3pt;
margin-left:110.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>self.assertRaises(roman6.InvalidRomanNumeralError,
roman6.from_roman, s)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.0pt;margin-left:16.4pt'>Another useful test would be to check that certain
patterns aren’t repeated. For example, <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>IX </span>is <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>9</span>,
but <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>IXIX
</span>is never valid.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def test_repeated_pairs(self):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:134.45pt;margin-bottom:
0in;margin-left:86.7pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>'''from_roman should fail with
repeated pairs of numerals''' for s in ('CMCM', 'CDCD', 'XCXC', 'XLXL', 'IXIX',
'IVIV'):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:110.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>self.assertRaises(roman6.InvalidRomanNumeralError,
roman6.from_roman, s)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.05pt;margin-left:16.4pt'>A third test could check that numerals appear in
the correct order, from highest to lowest value. For example, <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>CL </span>is
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>150</span>,
but <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>LC
</span>is never valid, because the numeral for <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>50 </span>can never come before
the numeral for <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>100</span>. This test includes a randomly chosen set of
invalid antecedents: <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>I </span>before <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>M</span>, <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>V </span>before <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>X</span>,
and so on.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def test_malformed_antecedents(self):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:164.45pt;margin-bottom:
0in;margin-left:86.7pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>'''from_roman should fail with
malformed antecedents''' for s in ('IIMXCC', 'VX', 'DCM', 'CMM', 'IXIV',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:146.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'MCMC', 'XCX', 'IVI', 'LM', 'LD', 'LC'):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:32.3pt;
margin-left:110.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>self.assertRaises(roman6.InvalidRomanNumeralError,
roman6.from_roman, s)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.05pt;margin-left:16.4pt'>Each of these tests relies the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>from_roman()
</span>function raising a new exception, <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>InvalidRomanNumeralError</span>,
which we haven’t defined yet.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'># roman6.py</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.5pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>class InvalidRomanNumeralError(ValueError):
pass</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>All three of these tests should fail, since the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>from_roman()
</span>function doesn’t currently have any validity checking. (If they don’t
fail now, then what the heck are they testing?)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.95in;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>you@localhost:~/diveintopython3/examples$
</span><span style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>python3
romantest6.py FFF.......</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:134.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>======================================================================
FAIL: test_malformed_antecedents (__main__.FromRomanBadInput) from_roman should
fail with malformed antecedents
---------------------------------------------------------------------Traceback
(most recent call last):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:62.15pt;text-indent:-12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>File
&quot;romantest6.py&quot;, line 113, in test_malformed_antecedents
self.assertRaises(roman6.InvalidRomanNumeralError, roman6.from_roman, s)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>AssertionError: InvalidRomanNumeralError
not raised by from_roman</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:140.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>======================================================================
FAIL: test_repeated_pairs (__main__.FromRomanBadInput) from_roman should fail
with repeated pairs of numerals
---------------------------------------------------------------------Traceback
(most recent call last):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:62.15pt;text-indent:-12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>File
&quot;romantest6.py&quot;, line 107, in test_repeated_pairs
self.assertRaises(roman6.InvalidRomanNumeralError, roman6.from_roman, s)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>AssertionError: InvalidRomanNumeralError
not raised by from_roman</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:110.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>======================================================================
FAIL: test_too_many_repeated_numerals (__main__.FromRomanBadInput) from_roman
should fail with too many repeated numerals
---------------------------------------------------------------------Traceback
(most recent call last):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:62.15pt;text-indent:-12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>File
&quot;romantest6.py&quot;, line 102, in test_too_many_repeated_numerals
self.assertRaises(roman6.InvalidRomanNumeralError, roman6.from_roman, s)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>AssertionError: InvalidRomanNumeralError
not raised by from_roman</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>----------------------------------------------------------------------</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>Ran 10 tests in 0.058s</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>FAILED (failures=3)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
18.7pt;margin-left:16.4pt'>Good deal. Now, all we need to do is add the <u>regular
expression to test for valid Roman numerals </u>into the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>from_roman()
</span>function.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>roman_numeral_pattern = re.compile('''</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>^                   # beginning of string</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>M{0,3}              # thousands - 0 to 3 Ms</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>(CM|CD|D?C{0,3})    # hundreds - 900 (CM),
400 (CD), 0-300 (0 to 3 Cs),</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:182.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>#            or 500-800 (D, followed by 0
to 3 Cs)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>(XC|XL|L?X{0,3})    # tens - 90 (XC), 40
(XL), 0-30 (0 to 3 Xs),</span></p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:129.45pt;
margin-bottom:8.5pt;margin-left:159.7pt;text-align:center;line-height:110%'><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>#       
or 50-80 (L, followed by 0 to 3 Xs)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>(IX|IV|V?I{0,3})    # ones - 9 (IX), 4
(IV), 0-3 (0 to 3 Is),</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:158.45pt;margin-bottom:
0in;margin-left:62.15pt;text-indent:120.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>#       
or 5-8 (V, followed by 0 to 3 Is) $                   # end of string</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>''', re.VERBOSE)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def from_roman(s):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'''convert Roman numeral to integer'''</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=707
 style='width:530.45pt;margin-left:38.15pt;border-collapse:collapse'>
 <tr style='height:42.0pt'>
  <td width=707 valign=top style='width:530.45pt;background:gainsboro;
  padding:4.85pt 5.75pt 0in 24.0pt;height:42.0pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><b><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>if not
  roman_numeral_pattern.search(s):</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
  margin-left:24.0pt;text-indent:0in;line-height:107%'><b><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>raise
  InvalidRomanNumeralError('Invalid Roman numeral: {0}'.format(s))</span></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:284.45pt;margin-bottom:
0in;margin-left:62.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>result = 0 index = 0 for
numeral, integer in roman_numeral_map:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:86.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>while s[index : index + len(numeral)] ==
numeral:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:356.45pt;margin-bottom:
0in;margin-left:110.7pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>result += integer index +=
len(numeral)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>return result</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>And re-run the tests…</p>

<p class=MsoNormal style='margin-top:0in;margin-right:122.45pt;margin-bottom:
21.0pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>you@localhost:~/diveintopython3/examples$
</span><span style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>python3
romantest7.py ..........
---------------------------------------------------------------------Ran 10
tests in 0.066s</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.4pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>OK</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>And the anticlimax award of the year goes to… the
word “<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>OK</span>”,
which is printed by the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>unittest </span>module when all the tests pass.<br
clear=all style='page-break-before:always'>
</p>

<h2 style='margin-top:0in;margin-right:22.2pt;margin-bottom:0in;margin-left:
16.4pt;line-height:107%'><span style='font-size:24.0pt;line-height:107%'>C</span><span
style='font-size:19.0pt;line-height:107%'>HAPTER </span><span style='font-size:
24.0pt;line-height:107%'>10. R</span><span style='font-size:19.0pt;line-height:
107%'>EFACTORING</span></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:39.9pt;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=736 height=4 id="Group 684791"
src="Dive%20Into%20Python%203_files/image001.gif"></span></p>

<p class=MsoNormal align=right style='margin-top:0in;margin-right:29.3pt;
margin-bottom:6.2pt;margin-left:16.6pt;text-align:right;line-height:107%'><span
style='font-size:13.0pt;line-height:107%;font-family:"Calibri",sans-serif'>&#10077;
</span><i>After one has played a vast quantity of notes and more notes, it is
simplicity that emerges as the crowning reward</i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.25in;margin-bottom:65.55pt;
margin-left:479.9pt;text-indent:46.5pt;line-height:159%'><i>of art. </i><span
style='font-size:13.0pt;line-height:159%;font-family:"Calibri",sans-serif'>&#10078;
</span><i>— </i><a href="http://en.wikiquote.org/wiki/Fr%C3%A9d%C3%A9ric_Chopin"><i><span
style='color:black'>Frédéric</span></i></a><i><u> </u></i><a
href="http://en.wikiquote.org/wiki/Fr%C3%A9d%C3%A9ric_Chopin"><i><span
style='color:black'>Chopin</span></i></a></p>

<h3 style='margin-top:0in;margin-right:0in;margin-bottom:66.7pt;margin-left:
16.4pt;line-height:110%'><span style='font-size:18.0pt;line-height:110%'>10.1.
D</span>IVING <span style='font-size:18.0pt;line-height:110%'>I</span>N</h3>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'><span style='font-size:48.0pt;
line-height:107%;font-family:"DejaVu Serif",serif;color:#888888'>L </span>ike
it or not, bugs happen. Despite your best efforts to write comprehensive <u>unit
tests</u>, bugs happen.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.9pt;margin-left:16.4pt'>What do I mean by “bug”? A bug is a test case you
haven’t written yet.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>import
roman7</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>roman7.from_roman('')
</span><span style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.9pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>0</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.55pt;margin-left:16.65pt;text-indent:-16.65pt'>1.   This is a bug. An empty
string should raise an <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>InvalidRomanNumeralError </span>exception, just
like any other sequence of characters that don’t represent a valid Roman
numeral.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
18.9pt;margin-left:16.4pt'>After reproducing the bug, and before fixing it, you
should write a test case that fails, thus illustrating the bug.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>class FromRomanBadInput(unittest.TestCase):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:524.45pt;margin-bottom:
0in;margin-left:62.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>. .</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def testBlank(self):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
margin-left:86.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'''from_roman should fail with blank
string'''</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:86.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>self.assertRaises(roman6.InvalidRomanNumeralError,
roman6.from_roman, '') </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.9pt;
margin-left:0in;text-indent:0in;line-height:107%'>1.     Pretty simple stuff
here. Call <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>from_roman()
</span>with an empty string and make sure it raises an</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.55pt;margin-left:16.4pt'><span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>InvalidRomanNumeralError </span>exception. The
hard part was finding the bug; now that you know about it, testing for it is
the easy part.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.9pt;margin-left:16.4pt'>Since your code has a bug, and you now have a test
case that tests this bug, the test case will fail:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:164.4pt;margin-bottom:
21.0pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>you@localhost:~/diveintopython3/examples$
</span><span style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>python3
romantest8.py -v from_roman should fail with blank string ... FAIL from_roman
should fail with malformed antecedents ... ok from_roman should fail with
repeated pairs of numerals ... ok from_roman should fail with too many repeated
numerals ... ok from_roman should give known result with known input ... ok
to_roman should give known result with known input ... ok
from_roman(to_roman(n))==n for all n ... ok to_roman should fail with negative
input ... ok to_roman should fail with non-integer input ... ok to_roman should
fail with large input ... ok to_roman should fail with 0 input ... ok</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>======================================================================</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:86.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>FAIL: from_roman should fail
with blank string
---------------------------------------------------------------------Traceback
(most recent call last):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:62.15pt;text-indent:-12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>File
&quot;romantest8.py&quot;, line 117, in test_blank
self.assertRaises(roman8.InvalidRomanNumeralError, roman8.from_roman, '')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:37.9pt;line-height:110%;background:gainsboro'><b><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>AssertionError:
InvalidRomanNumeralError not raised by from_roman</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>----------------------------------------------------------------------</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>Ran 11 tests in 0.171s</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>FAILED (failures=1)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'><i>Now </i>you can fix the bug.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def from_roman(s):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.35pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'''convert Roman numeral to integer'''</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                            </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>if not
s:                                                                  </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:86.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>raise InvalidRomanNumeralError('Input can
not be blank')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>if not re.search(romanNumeralPattern, s):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:26.65pt;
margin-left:86.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>raise InvalidRomanNumeralError('Invalid
Roman numeral: {}'.format(s)) </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:296.45pt;margin-bottom:
0in;margin-left:62.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>result = 0 index = 0 for
numeral, integer in romanNumeralMap:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:86.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>while s[index:index+len(numeral)] ==
numeral:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:356.45pt;margin-bottom:
0in;margin-left:110.7pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>result += integer index +=
len(numeral)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>return result</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.05pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Only two lines
of code are required: an explicit check for an empty string, and a <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>raise </span>statement.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>I don’t think I’ve mentioned this yet anywhere in this book, so let this
serve as your final lesson in <u>string formatting</u>. Starting in Python 3.1,
you can skip the numbers when using positional indexes in a format specifier.
That is, instead of using the format specifier <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>{0} </span>to refer to the
first parameter to the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>format() </span>method, you can simply use <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>{} </span>and
Python will fill in the proper positional index for you. This works for any
number of arguments; the first <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>{} </span>is <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>{0}</span>, the second <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>{} </span>is
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>{1}</span>,
and so forth.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:164.4pt;margin-bottom:
21.05pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>you@localhost:~/diveintopython3/examples$
</span><span style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>python3
romantest8.py -v from_roman should fail with blank string ... ok </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312; </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>from_roman
should fail with malformed antecedents ... ok from_roman should fail with
repeated pairs of numerals ... ok from_roman should fail with too many repeated
numerals ... ok from_roman should give known result with known input ... ok
to_roman should give known result with known input ... ok
from_roman(to_roman(n))==n for all n ... ok to_roman should fail with negative
input ... ok to_roman should fail with non-integer input ... ok to_roman should
fail with large input ... ok to_roman should fail with 0 input ... ok</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:122.45pt;margin-bottom:
24.0pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>---------------------------------------------------------------------Ran
11 tests in 0.156s</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:28.3pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>OK </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The blank string
test case now passes, so the bug is fixed.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.45pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>All the other test cases still pass, which means that this bug fix
didn’t break anything else. Stop coding.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:33.6pt;margin-bottom:
45.7pt;margin-left:16.4pt'>Coding this way does not make fixing bugs any
easier. Simple bugs (like this one) require simple test cases; complex bugs
will require complex test cases. In a testing-centric environment, it may <i>seem
</i>like it takes longer to fix a bug, since you need to articulate in code
exactly what the bug is (to write the test case), then fix the bug itself. Then
if the test case doesn’t pass right away, you need to figure out whether the
fix was wrong, or whether the test case itself has a bug in it. However, in the
long run, this back-and-forth between test code and code tested pays for
itself, because it makes it more likely that bugs are fixed correctly the first
time. Also, since you can easily re-run <i>all </i>the test cases along with
your new one, you are much less likely to break old code when fixing new code.
Today’s unit test is tomorrow’s regression test.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:33.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h4 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>10.2.
H</span>ANDLING <span style='font-size:18.0pt;line-height:112%'>C</span>HANGING
<span style='font-size:18.0pt;line-height:112%'>R</span>EQUIREMENTS</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>Despite your best efforts to pin your customers to
the ground and extract exact requirements from them on pain of horrible nasty
things involving scissors and hot wax, requirements will change. Most customers
don’t know what they want until they see it, and even if they do, they aren’t
that good at articulating what they want precisely enough to be useful. And
even if they do, they’ll want more in the next release anyway.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.45pt;margin-left:16.4pt'>So be prepared to update your test cases as
requirements change.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.4pt;line-height:107%'>Suppose, for instance, that you
wanted to expand the range of the Roman numeral conversion functions.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.15pt;margin-left:16.4pt;line-height:107%'>Normally, no character in a Roman
numeral can be repeated more than three times in a row. But the</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.35pt;margin-left:16.4pt;line-height:107%'>Romans were willing to make an
exception to that rule by having 4 <span style='font-size:10.0pt;line-height:
107%;font-family:"Liberation Mono"'>M </span>characters in a row to represent <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>4000</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.45pt;margin-left:16.4pt;line-height:107%'>If you make this change, you’ll be
able to expand the range of convertible numbers from <span style='font-size:
10.0pt;line-height:107%;font-family:"Liberation Mono"'>1..3999 </span>to</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'><span style='font-size:10.0pt;
line-height:107%;font-family:"Liberation Mono"'>1..4999</span>. But first, you
need to make some changes to your test cases.<br clear=all style='page-break-before:
always'>
</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>class KnownValues(unittest.TestCase):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>known_values = ( (1, 'I'),</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:170.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:170.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:170.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.5pt;
margin-left:164.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>(3999, 'MMMCMXCIX'),</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                                                                         </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>(4000,
'MMMM'),                                      </span><span style='font-family:
"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:164.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>(4500, 'MMMMD'),</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:164.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>(4888, 'MMMMDCCCLXXXVIII'),</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:164.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>(4999, 'MMMMCMXCIX') )</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>class ToRomanBadInput(unittest.TestCase):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def test_too_large(self):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:8.45pt;margin-bottom:
16.75pt;margin-left:86.7pt;line-height:180%'><span style='font-size:10.0pt;
line-height:180%;font-family:"Liberation Mono"'>'''to_roman should fail with
large input''' self.assertRaises(roman8.OutOfRangeError, roman8.to_roman, 5000)
</span><span style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>class FromRomanBadInput(unittest.TestCase):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def test_too_many_repeated_numerals(self):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:56.45pt;margin-bottom:
21.25pt;margin-left:86.7pt;line-height:182%'><span style='font-size:10.0pt;
line-height:182%;font-family:"Liberation Mono"'>'''from_roman should fail with
too many repeated numerals''' for s in ('MMMMM', 'DD', 'CCCC', 'LL', 'XXXX',
'VV', 'IIII'): </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9314; </span><span style='font-size:10.0pt;line-height:182%;
font-family:"Liberation Mono"'>self.assertRaises(roman8.InvalidRomanNumeralError,
roman8.from_roman, s)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>class RoundtripCheck(unittest.TestCase):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def test_roundtrip(self):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:86.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'''from_roman(to_roman(n))==n for all n'''</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.5pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                                      </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>for
integer in range(1, 5000):                                    </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:248.45pt;margin-bottom:
22.55pt;margin-left:110.7pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>numeral =
roman8.to_roman(integer) result = roman8.from_roman(numeral)
self.assertEqual(integer, result)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:31.4pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The existing known values don’t change (they’re all still reasonable
values to test), but you need to add a few more in the <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>4000 </span>range. Here
I’ve included <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>4000
</span>(the shortest), <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>4500 </span>(the second shortest), <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>4888 </span>(the
longest), and <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>4999
</span>(the largest).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:31.4pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The definition of “large input” has changed. This test used to call <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>to_roman()
</span>with <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>4000
</span>and expect an error; now that <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>4000-4999 </span>are good values, you need
to bump this up to <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>5000</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:31.4pt;margin-bottom:
.15pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:155%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The definition
of “too many repeated numerals” has also changed. This test used to call <span
style='font-size:10.0pt;line-height:155%;font-family:"Liberation Mono"'>from_roman()
</span>with <span style='font-size:10.0pt;line-height:155%;font-family:"Liberation Mono"'>'MMMM'
</span>and expect an error; now that <span style='font-size:10.0pt;line-height:
155%;font-family:"Liberation Mono"'>MMMM </span>is considered a valid Roman
numeral, you need to bump this up to <span style='font-size:10.0pt;line-height:
155%;font-family:"Liberation Mono"'>'MMMMM'</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:31.4pt;margin-bottom:
20.55pt;margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The sanity check loops through every number in the range, from <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>1 </span>to
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>3999</span>.
Since the range has now expanded, this <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>for </span>loop need to be
updated as well to go up to <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>4999</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>Now your test cases are up to date with the new
requirements, but your code is not, so you expect several of the test cases to
fail.<br clear=all style='page-break-before:always'>
</p>

<p class=MsoNormal style='margin-top:0in;margin-right:164.4pt;margin-bottom:
0in;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#666677'>you@localhost:~/diveintopython3/examples$
</span><span style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>python3
romantest9.py -v from_roman should fail with blank string ... ok from_roman
should fail with malformed antecedents ... ok from_roman should fail with
non-string input ... ok from_roman should fail with repeated pairs of numerals
... ok from_roman should fail with too many repeated numerals ... ok</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=590
 style='width:6.15in;margin-left:38.15pt;border-collapse:collapse'>
 <tr style='height:18.3pt'>
  <td width=576 valign=top style='width:432.05pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>from_roman
  should give known result with known input ... ERROR</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9312;</span></p>
  </td>
 </tr>
 <tr style='height:22.5pt'>
  <td width=576 valign=top style='width:432.05pt;padding:0in 0in 0in 0in;
  height:22.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>to_roman
  should give known result with known input ... ERROR</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:22.5pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9313;</span></p>
  </td>
 </tr>
 <tr style='height:18.3pt'>
  <td width=576 valign=bottom style='width:432.05pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>from_roman(to_roman(n))==n
  for all n ... ERROR</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9314;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:248.45pt;margin-bottom:
21.0pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>to_roman should fail with
negative input ... ok to_roman should fail with non-integer input ... ok
to_roman should fail with large input ... ok to_roman should fail with 0 input
... ok</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:104.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>======================================================================
ERROR: from_roman should give known result with known input
---------------------------------------------------------------------Traceback
(most recent call last):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:140.45pt;margin-bottom:
0in;margin-left:62.15pt;text-indent:-12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>File
&quot;romantest9.py&quot;, line 82, in test_from_roman_known_values result =
roman9.from_roman(numeral)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:80.45pt;margin-bottom:
0in;margin-left:62.15pt;text-indent:-12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>File
&quot;C:\home\diveintopython3\examples\roman9.py&quot;, line 60, in from_roman
raise InvalidRomanNumeralError('Invalid Roman numeral: {0}'.format(s))</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:37.9pt;line-height:110%;background:gainsboro'><b><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>roman9.InvalidRomanNumeralError:
Invalid Roman numeral: MMMM</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:104.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>======================================================================
ERROR: to_roman should give known result with known input
---------------------------------------------------------------------Traceback
(most recent call last):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:152.45pt;margin-bottom:
0in;margin-left:62.15pt;text-indent:-12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>File
&quot;romantest9.py&quot;, line 76, in test_to_roman_known_values result =
roman9.to_roman(integer)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:92.45pt;margin-bottom:
0in;margin-left:62.15pt;text-indent:-12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>File
&quot;C:\home\diveintopython3\examples\roman9.py&quot;, line 42, in to_roman
raise OutOfRangeError('number out of range (must be 0..3999)')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.5pt;
margin-left:37.9pt;line-height:110%;background:gainsboro'><b><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>roman9.OutOfRangeError:
number out of range (must be 0..3999) </span></b><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono"'>======================================================================</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:86.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>ERROR:
from_roman(to_roman(n))==n for all n
---------------------------------------------------------------------Traceback
(most recent call last):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:236.45pt;margin-bottom:
0in;margin-left:62.15pt;text-indent:-12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>File
&quot;romantest9.py&quot;, line 131, in testSanity numeral =
roman9.to_roman(integer)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:92.45pt;margin-bottom:
0in;margin-left:62.15pt;text-indent:-12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>File
&quot;C:\home\diveintopython3\examples\roman9.py&quot;, line 42, in to_roman
raise OutOfRangeError('number out of range (must be 0..3999)')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:37.9pt;line-height:110%;background:gainsboro'><b><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>roman9.OutOfRangeError:
number out of range (must be 0..3999)</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>----------------------------------------------------------------------</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>Ran 12 tests in 0.171s</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:32.1pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>FAILED (errors=3)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>from_roman()
</span>known values test will fail as soon as it hits <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>'MMMM'</span>, because <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>from_roman()
</span>still thinks this is an invalid Roman numeral.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>to_roman()
</span>known values test will fail as soon as it hits <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>4000</span>, because <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>to_roman()
</span>still thinks this is out of range.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.5pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The roundtrip check will also fail as soon as it hits <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>4000</span>,
because <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>to_roman()
</span>still thinks this is out of range.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>Now that you have test cases that fail due to the new
requirements, you can think about fixing the code to bring it in line with the
test cases. (When you first start coding unit tests, it might feel strange that
the code being tested is never “ahead” of the test cases. While it’s behind,
you still have some work to do, and as soon as it catches up to the test cases,
you stop coding. After you get used to it, you’ll wonder how you ever
programmed without tests.)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>roman_numeral_pattern = re.compile('''</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>^                   # beginning of string</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>M{0,4}              # thousands - 0 to 4 Ms
</span><span style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>(CM|CD|D?C{0,3})    # hundreds - 900 (CM),
400 (CD), 0-300 (0 to 3 Cs),</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:182.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>#            or 500-800 (D, followed by 0
to 3 Cs)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>(XC|XL|L?X{0,3})    # tens - 90 (XC), 40
(XL), 0-30 (0 to 3 Xs),</span></p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:129.45pt;
margin-bottom:8.5pt;margin-left:159.7pt;text-align:center;line-height:110%'><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>#       
or 50-80 (L, followed by 0 to 3 Xs)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>(IX|IV|V?I{0,3})    # ones - 9 (IX), 4
(IV), 0-3 (0 to 3 Is),</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:158.45pt;margin-bottom:
0in;margin-left:62.15pt;text-indent:120.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>#       
or 5-8 (V, followed by 0 to 3 Is) $                   # end of string</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>''', re.VERBOSE)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def to_roman(n):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.6pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'''convert integer to Roman numeral'''</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                            </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>if not
(0 &lt; n &lt; 5000):                        </span><span style='font-family:
"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:128.45pt;margin-bottom:
0in;margin-left:62.15pt;text-indent:24.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>raise
OutOfRangeError('number out of range (must be 1..4999)') if not isinstance(n,
int):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:86.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>raise NotIntegerError('non-integers can not
be converted')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:284.45pt;margin-bottom:
0in;margin-left:62.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>result = '' for numeral,
integer in roman_numeral_map:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:380.45pt;margin-bottom:
0in;margin-left:110.2pt;text-indent:-24.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>while n
&gt;= integer: result += numeral n -= integer</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>return result</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def from_roman(s):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:524.45pt;margin-bottom:
23.0pt;margin-left:62.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>. .</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>You don’t need to make any changes to the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>from_roman() </span>function at
all. The only change is to <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>roman_numeral_pattern</span>. If you look
closely, you’ll notice that I changed the maximum number of optional <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>M </span>characters
from <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>3
</span>to <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>4
</span>in the first section of the regular expression. This will allow the
Roman numeral equivalents of <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>4999 </span>instead of <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>3999</span>. The actual <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>from_roman()
</span>function is completely generic; it just looks for repeated Roman numeral
characters and adds them up, without caring how many times they repeat. The
only reason it didn’t handle <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>'MMMM' </span>before is that you explicitly
stopped it with the regular expression pattern matching.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.35pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>to_roman()
</span>function only needs one small change, in the range check. Where you used
to check <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>0
&lt; n &lt; 4000</span>, you now check <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>0 &lt; n &lt; 5000</span>. And
you change the error message that you <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>raise </span>to reflect the new acceptable
range (<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>1..4999
</span>instead of <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>1..3999</span>). You don’t need to make any changes to the
rest of the function; it handles the new cases already. (It merrily adds <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>'M' </span>for
each thousand that it finds; given <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>4000</span>, it will spit out <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>'MMMM'</span>.
The only reason it didn’t do this before is that you explicitly stopped it with
the range check.)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:33.65pt;margin-bottom:
19.05pt;margin-left:16.4pt'>You may be skeptical that these two small changes
are all that you need. Hey, don’t take my word for it; see for yourself.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:164.4pt;margin-bottom:
21.0pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>you@localhost:~/diveintopython3/examples$
</span><span style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>python3
romantest9.py -v from_roman should fail with blank string ... ok from_roman
should fail with malformed antecedents ... ok from_roman should fail with
non-string input ... ok from_roman should fail with repeated pairs of numerals
... ok from_roman should fail with too many repeated numerals ... ok from_roman
should give known result with known input ... ok to_roman should give known
result with known input ... ok from_roman(to_roman(n))==n for all n ... ok to_roman
should fail with negative input ... ok to_roman should fail with non-integer
input ... ok to_roman should fail with large input ... ok to_roman should fail
with 0 input ... ok</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:122.45pt;margin-bottom:
24.0pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>---------------------------------------------------------------------Ran
12 tests in 0.203s</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:28.3pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>OK </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-left:0in;text-indent:0in;line-height:107%'>1.    All
the test cases pass. Stop coding.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
46.55pt;margin-left:16.4pt'>Comprehensive unit testing means never having to
rely on a programmer who says “Trust me.”</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:33.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h4 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>10.3.
R</span>EFACTORING</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.4pt;margin-left:16.4pt'>The best thing about comprehensive unit testing is
not the feeling you get when all your test cases finally pass, or even the
feeling you get when someone else blames you for breaking their code and you
can actually <i>prove </i>that you didn’t. The best thing about unit testing is
that it gives you the freedom to refactor mercilessly.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.0pt;margin-left:16.4pt'>Refactoring is the process of taking working code
and making it work better. Usually, “better” means “faster”, although it can
also mean “using less memory”, or “using less disk space”, or simply “more
elegantly”. Whatever it means to you, to your project, in your environment,
refactoring is important to the long-term health of any program.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.55pt;margin-left:16.4pt'>Here, “better” means both “faster” and “easier to
maintain.” Specifically, the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>from_roman() </span>function is slower and more
complex than I’d like, because of that big nasty regular expression that you
use to validate Roman numerals. Now, you might think, “Sure, the regular
expression is big and hairy, but how else am I supposed to validate that an arbitrary
string is a valid a Roman numeral?”</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.55pt;margin-left:16.4pt'>Answer: there’s only 5000 of them; why don’t you
just build a lookup table? This idea gets even better when you realize that <i>you
don’t need to use regular expressions at all</i>. As you build the lookup table
for converting integers to Roman numerals, you can build the reverse lookup
table to convert Roman numerals to integers. By the time you need to check
whether an arbitrary string is a valid Roman numeral, you will have collected
all the valid Roman numerals. “Validating” is reduced to a single dictionary lookup.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>And best of all, you already have a complete set of
unit tests. You can change over half the code in the module, but the unit tests
will stay the same. That means you can prove — to yourself and to others — that
the new code works just as well as the original.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:272.45pt;margin-bottom:
21.0pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>class
OutOfRangeError(ValueError): pass class NotIntegerError(ValueError): pass class
InvalidRomanNumeralError(ValueError): pass</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>roman_numeral_map = (('M',  1000),</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:361.7pt;margin-bottom:
.3pt;margin-left:163.95pt;text-align:justify;text-justify:inter-ideograph;
line-height:182%'><span style='font-size:10.0pt;line-height:182%;font-family:
"Liberation Mono"'>('CM', 900), ('D',  500), ('CD', 400),</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:361.7pt;margin-bottom:
.3pt;margin-left:163.95pt;text-align:justify;text-justify:inter-ideograph;
line-height:182%'><span style='font-size:10.0pt;line-height:182%;font-family:
"Liberation Mono"'>('C',  100), ('XC', 90), ('L',  50), ('XL', 40),</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:368.45pt;margin-bottom:
.3pt;margin-left:163.95pt;text-align:justify;text-justify:inter-ideograph;
line-height:182%'><span style='font-size:10.0pt;line-height:182%;font-family:
"Liberation Mono"'>('X',  10), ('IX', 9), ('V',  5), ('IV', 4),</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:164.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>('I',  1))</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:314.45pt;margin-bottom:
21.0pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>to_roman_table = [ None ]
from_roman_table = {}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def to_roman(n):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:296.45pt;margin-bottom:
0in;margin-left:62.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>'''convert integer to Roman
numeral''' if not (0 &lt; n &lt; 5000):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:128.45pt;margin-bottom:
0in;margin-left:62.15pt;text-indent:24.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>raise
OutOfRangeError('number out of range (must be 1..4999)') if int(n) != n:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:86.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>raise NotIntegerError('non-integers can not
be converted')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>return to_roman_table[n]</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def from_roman(s):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:296.45pt;margin-bottom:
0in;margin-left:62.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>'''convert Roman numeral to
integer''' if not isinstance(s, str):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:164.45pt;margin-bottom:
8.25pt;margin-left:62.15pt;text-indent:24.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>raise
InvalidRomanNumeralError('Input must be a string') if not s:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:92.45pt;margin-bottom:
0in;margin-left:62.15pt;text-indent:24.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>raise
InvalidRomanNumeralError('Input can not be blank') if s not in
from_roman_table: raise InvalidRomanNumeralError('Invalid Roman numeral:
{0}'.format(s))</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>return from_roman_table[s]</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def build_lookup_tables():</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def to_roman(n):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:260.45pt;margin-bottom:
0in;margin-left:86.7pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>result = '' for numeral,
integer in roman_numeral_map:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:362.45pt;margin-bottom:
0in;margin-left:134.2pt;text-indent:-24.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>if n
&gt;= integer: result = numeral n -= integer break</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:326.45pt;margin-bottom:
0in;margin-left:110.2pt;text-indent:-24.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>if n
&gt; 0: result += to_roman_table[n]</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:86.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>return result</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>for integer in range(1, 5000):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:110.45pt;margin-bottom:
21.0pt;margin-left:86.7pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>roman_numeral =
to_roman(integer) to_roman_table.append(roman_numeral)
from_roman_table[roman_numeral] = integer</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>build_lookup_tables()</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.9pt;margin-left:16.4pt'>Let’s break that down into digestable pieces.
Arguably, the most important line is the last one:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.6pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>build_lookup_tables()</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.3in;margin-left:16.4pt'>You will note that is a function call, but there’s no <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>if </span>statement
around it. This is not an <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>if __name__ == '__main__' </span>block; it gets
called <i>when the module is imported</i>. (It is important to understand that
modules are only imported once, then cached. If you import an already-imported
module, it does nothing. So this code will only get called the first time you
import this module.)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>So what does the <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>build_lookup_tables()
</span>function do? I’m glad you asked.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:410.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>to_roman_table = [ None ]
from_roman_table = {} .</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:548.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>. .</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.55pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def build_lookup_tables():</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:237.65pt;margin-bottom:
.3pt;margin-left:86.15pt;text-align:justify;text-justify:inter-ideograph;
text-indent:-24.0pt;line-height:182%'><span style='font-size:10.0pt;line-height:
182%;font-family:"Liberation Mono"'>def to_roman(n):    </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312; </span><span
style='font-size:10.0pt;line-height:182%;font-family:"Liberation Mono"'>result
= '' for numeral, integer in roman_numeral_map:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:362.45pt;margin-bottom:
0in;margin-left:134.2pt;text-indent:-24.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>if n
&gt;= integer: result = numeral n -= integer break</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:326.45pt;margin-bottom:
0in;margin-left:110.2pt;text-indent:-24.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>if n
&gt; 0: result += to_roman_table[n]</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:86.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>return result</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>for integer in range(1, 5000):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:27.65pt;margin-bottom:
0in;margin-left:86.7pt;line-height:180%'><span style='font-size:10.0pt;
line-height:180%;font-family:"Liberation Mono"'>roman_numeral =
to_roman(integer) </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9313; </span><span style='font-size:10.0pt;line-height:180%;
font-family:"Liberation Mono"'>to_roman_table.append(roman_numeral)    </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.4pt;
margin-left:86.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>from_roman_table[roman_numeral] = integer</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>This is a clever bit of programming… perhaps too clever. The <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>to_roman()
</span>function is defined above; it looks up values in the lookup table and
returns them. But the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>build_lookup_tables() </span>function redefines
the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>to_roman()
</span>function to actually do work (like the previous examples did, before you
added a lookup table).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>Within the <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>build_lookup_tables() </span>function,
calling <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>to_roman()
</span>will call this redefined version. Once the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>build_lookup_tables() </span>function
exits, the redefined version disappears — it is only defined in the local scope
of the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>build_lookup_tables()
</span>function.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.4pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>This line of
code will call the redefined <span style='font-size:10.0pt;line-height:107%;
font-family:"Liberation Mono"'>to_roman() </span>function, which actually
calculates the Roman numeral.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.55pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Once you have the result (from the redefined <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>to_roman() </span>function),
you add the integer and its Roman numeral equivalent to both lookup tables.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>Once the lookup tables are built,
the rest of the code is both easy and fast.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def to_roman(n):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:296.45pt;margin-bottom:
0in;margin-left:62.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>'''convert integer to Roman
numeral''' if not (0 &lt; n &lt; 5000):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:128.45pt;margin-bottom:
0in;margin-left:62.15pt;text-indent:24.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>raise
OutOfRangeError('number out of range (must be 1..4999)') if int(n) != n:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:86.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>raise NotIntegerError('non-integers can not
be converted')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:26.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                            </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>return
to_roman_table[n]                                            </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def from_roman(s):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:296.45pt;margin-bottom:
0in;margin-left:62.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>'''convert Roman numeral to
integer''' if not isinstance(s, str):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:164.45pt;margin-bottom:
0in;margin-left:62.15pt;text-indent:24.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>raise
InvalidRomanNumeralError('Input must be a string') if not s:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:164.45pt;margin-bottom:
0in;margin-left:62.15pt;text-indent:24.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>raise
InvalidRomanNumeralError('Input can not be blank') if s not in
from_roman_table:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:56.45pt;margin-bottom:
18.75pt;margin-left:62.15pt;text-indent:24.0pt;line-height:180%'><span
style='font-size:10.0pt;line-height:180%;font-family:"Liberation Mono"'>raise
InvalidRomanNumeralError('Invalid Roman numeral: {0}'.format(s)) return
from_roman_table[s]  </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>After doing the same bounds checking as before, the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>to_roman()
</span>function simply finds the appropriate value in the lookup table and
returns it.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.55pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Similarly, the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>from_roman() </span>function is reduced to some
bounds checking and one line of code. No more regular expressions. No more
looping. O(1) conversion to and from Roman numerals.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>But does it work? Why yes, yes it
does. And I can prove it.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.2in;margin-bottom:21.0pt;
margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;line-height:
185%;font-family:"Liberation Mono";color:#666677'>you@localhost:~/diveintopython3/examples$
</span><span style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>python3
romantest10.py -v from_roman should fail with blank string ... ok from_roman
should fail with malformed antecedents ... ok from_roman should fail with
non-string input ... ok from_roman should fail with repeated pairs of numerals
... ok from_roman should fail with too many repeated numerals ... ok from_roman
should give known result with known input ... ok to_roman should give known
result with known input ... ok from_roman(to_roman(n))==n for all n ... ok
to_roman should fail with negative input ... ok to_roman should fail with
non-integer input ... ok to_roman should fail with large input ... ok to_roman
should fail with 0 input ... ok</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.6pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>----------------------------------------------------------------------</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:26.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>Ran 12
tests in 0.031s                                                  </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>OK</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.55pt;margin-left:16.65pt;text-indent:-16.65pt'>1.   Not that you asked, but
it’s fast, too! Like, almost 10× as fast. Of course, it’s not entirely a fair
comparison, because this version takes longer to import (when it builds the
lookup tables). But since the import is only done once, the startup cost is amortized
over all the calls to the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>to_roman() </span>and <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>from_roman() </span>functions.
Since the tests make several thousand function calls (the roundtrip test alone
makes 10,000), this savings adds up in a hurry!</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.45pt;margin-left:16.4pt'>The moral of the story?</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-12.25pt;line-height:107%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Simplicity is a
virtue.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-12.25pt;line-height:107%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Especially when
regular expressions are involved.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
46.55pt;margin-left:16.65pt;text-indent:-12.25pt'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Unit tests can give you the confidence to do large-scale refactoring.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:33.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h4 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>10.4.
S</span>UMMARY</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.55pt;margin-left:16.4pt'>Unit testing is a powerful concept which, if
properly implemented, can both reduce maintenance costs and increase
flexibility in any long-term project. It is also important to understand that
unit testing is not a panacea, a Magic Problem Solver, or a silver bullet.
Writing good test cases is hard, and keeping them up to date takes discipline
(especially when customers are screaming for critical bug fixes). Unit testing
is not a replacement for other forms of testing, including functional testing,
integration testing, and user acceptance testing. But it is feasible, and it
does work, and once you’ve seen it work, you’ll wonder how you ever got along
without it.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.55pt;margin-left:16.4pt'>These few chapters have covered a lot of ground,
and much of it wasn’t even Python-specific. There are unit testing frameworks
for many languages, all of which require you to understand the same basic
concepts:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-12.25pt;line-height:107%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Designing test
cases that are specific, automated, and independent</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-12.25pt;line-height:107%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Writing test
cases <i>before </i>the code they are testing</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-12.25pt;line-height:107%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Writing tests
that test good input and check for proper results</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-12.25pt;line-height:107%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Writing tests
that test bad input and check for proper failure responses</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-12.25pt;line-height:107%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Writing and
updating test cases to reflect new requirements</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-12.25pt'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Refactoring mercilessly to improve performance, scalability,
readability, maintainability, or whatever other -ility you’re lacking</p>

<h2 style='margin-top:0in;margin-right:22.2pt;margin-bottom:0in;margin-left:
16.4pt;line-height:107%'><span style='font-size:24.0pt;line-height:107%'>C</span><span
style='font-size:19.0pt;line-height:107%'>HAPTER </span><span style='font-size:
24.0pt;line-height:107%'>11. F</span><span style='font-size:19.0pt;line-height:
107%'>ILES</span></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:39.95pt;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=736 height=4 id="Group 691662"
src="Dive%20Into%20Python%203_files/image001.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.25in;margin-bottom:65.35pt;
margin-left:370.05pt;text-indent:-59.85pt;line-height:160%'><span
style='font-size:13.0pt;line-height:160%;font-family:"Calibri",sans-serif'>&#10077;
</span><i>A nine mile walk is no joke, especially in the rain. </i><span
style='font-size:13.0pt;line-height:160%;font-family:"Calibri",sans-serif'>&#10078;
</span><i>— Harry Kemelman, The Nine Mile Walk</i></p>

<h3 style='margin-top:0in;margin-right:0in;margin-bottom:65.5pt;margin-left:
16.4pt;line-height:110%'><span style='font-size:18.0pt;line-height:110%'>11.1.
D</span>IVING <span style='font-size:18.0pt;line-height:110%'>I</span>N</h3>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
24.45pt;margin-left:16.4pt'><span style='font-size:48.0pt;line-height:154%;
font-family:"DejaVu Serif",serif;color:#888888'>M </span>y Windows laptop had
38,493 files before I installed a single application. Installing Python 3 added
almost 3,000 files to that total. Files are the primary storage paradigm of
every major operating system; the concept is so ingrained that most people would
have trouble <a href="http://en.wikipedia.org/wiki/Computer_file#History"><span
style='color:black'>imagining</span></a><u> </u><a
href="http://en.wikipedia.org/wiki/Computer_file#History"><span
style='color:black'>an</span></a><u> </u><a
href="http://en.wikipedia.org/wiki/Computer_file#History"><span
style='color:black'>alternative</span></a>. Your computer is, metaphorically
speaking, drowning in files.</p>

<h4 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>11.2.
R</span>EADING <span style='font-size:18.0pt;line-height:112%'>F</span>ROM <span
style='font-size:18.0pt;line-height:112%'>T</span>EXT <span style='font-size:
18.0pt;line-height:112%'>F</span>ILES</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.9pt;margin-left:16.4pt'>Before you can read from a file, you need to open
it. Opening a file in Python couldn’t be easier:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.3pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>a_file = open('examples/chinese.txt',
encoding='utf-8')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.4pt;margin-left:16.4pt'>Python has a built-in <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>open() </span>function, which
takes a filename as an argument. Here the filename is <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>'examples/chinese.txt'</span>.
There are five interesting things about this filename:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>It’s not just the name of a file; it’s a combination of a directory path
and a filename. A hypothetical fileopening function could have taken two
arguments — a directory path and a filename — but the <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>open() </span>function
only takes one. In Python, whenever you need a “filename,” you can include some
or all of a directory path as well.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The directory path uses a forward slash, but I didn’t say what operating
system I was using. Windows uses backward slashes to denote subdirectories,
while Mac OS X and Linux use forward slashes. But in Python, forward slashes
always Just Work, even on Windows.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The directory path does not begin with a slash or a drive letter, so it
is called a <i>relative path</i>. Relative to what, you might ask? Patience,
grasshopper.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>It’s a string. All modern operating systems (even Windows!) use Unicode
to store the names of files and directories. Python 3 fully supports non-<span
style='font-size:9.5pt;line-height:154%'>ASCII </span>pathnames.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.05pt;margin-left:16.65pt;text-indent:-16.65pt'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>It doesn’t need to be on your local disk. You might have a network drive
mounted. That “file” might be a figment of <a
href="http://en.wikipedia.org/wiki/Filesystem_in_Userspace"><span
style='color:black'>an</span></a><u> </u><a
href="http://en.wikipedia.org/wiki/Filesystem_in_Userspace"><span
style='color:black'>entirely</span></a><u> </u><a
href="http://en.wikipedia.org/wiki/Filesystem_in_Userspace"><span
style='color:black'>virtual</span></a><u> </u><a
href="http://en.wikipedia.org/wiki/Filesystem_in_Userspace"><span
style='color:black'>filesystem</span></a>. If your computer considers it a file
and can access it as a file, Python can open it.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.4pt;line-height:107%'>But that call to the <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>open() </span>function
didn’t stop at the filename. There’s another argument, called <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>encoding</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:28.3pt;
margin-left:17.15pt;line-height:110%'>Oh dear, <u>that sounds dreadfully
familiar</u>.</p>

<h5 style='margin-top:0in;margin-right:0in;margin-bottom:25.25pt;margin-left:
16.4pt;line-height:110%'><span style='font-size:13.0pt;line-height:110%'>11.2.1.
C</span><span style='font-size:10.5pt;line-height:110%'>HARACTER </span><span
style='font-size:13.0pt;line-height:110%'>E</span><span style='font-size:10.5pt;
line-height:110%'>NCODING </span><span style='font-size:13.0pt;line-height:
110%'>R</span><span style='font-size:10.5pt;line-height:110%'>EARS </span><span
style='font-size:13.0pt;line-height:110%'>I</span><span style='font-size:10.5pt;
line-height:110%'>TS </span><span style='font-size:13.0pt;line-height:110%'>U</span><span
style='font-size:10.5pt;line-height:110%'>GLY </span><span style='font-size:
13.0pt;line-height:110%'>H</span><span style='font-size:10.5pt;line-height:
110%'>EAD</span></h5>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.05pt;margin-left:16.4pt'>Bytes are bytes; <u>characters are an abstraction</u>.
A string is a sequence of Unicode characters. But a file on disk is not a
sequence of Unicode characters; a file on disk is a sequence of bytes. So if
you read a “text file” from disk, how does Python convert that sequence of
bytes into a sequence of characters? It decodes the bytes according to a
specific character encoding algorithm and returns a sequence of Unicode
characters (otherwise known as a string).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:206.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'># This example was created on
Windows. Other platforms may # behave differently, for reasons outlined below.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>file =
open('examples/chinese.txt')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>a_string
= file.read()</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>Traceback (most
recent call last):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>File
&quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:140.45pt;margin-bottom:
0in;margin-left:62.15pt;text-indent:-12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
color:#880000'>File &quot;C:\Python31\lib\encodings\cp1252.py&quot;, line 23,
in decode return codecs.charmap_decode(input,self.errors,decoding_table)[0]</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-3.55pt;margin-bottom:
8.5pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#880000'>UnicodeDecodeError:
'charmap' codec can't decode byte 0x8f in position 28: character maps to &lt; </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.35pt;margin-left:16.4pt'><img width=300 height=1
src="Dive%20Into%20Python%203_files/image047.gif" align=left hspace=12>What
just happened? You didn’t specify a character encoding, so Python is forced to
use the default encoding. What’s the default encoding? If you look closely at
the traceback, you can see that it’s dying in <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>cp1252.py</span>, meaning that
Python is using CP-1252 as the default encoding here. (CP-1252 is a common
encoding on computers running Microsoft Windows.) The CP-1252 character set
doesn’t support the characters that are in this file, so the read fails with an
ugly <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>UnicodeDecodeError</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
46.75pt;margin-left:16.4pt'>But wait, it’s worse than that! The default
encoding is <i>platform-dependent</i>, so this code <i>might </i>work on your
computer (if your default encoding is <span style='font-size:9.5pt;line-height:
154%'>UTF</span>-8), but then it will fail when you distribute it to someone
else (whose default encoding is different, like CP-1252).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:91.0pt;margin-bottom:
42.75pt;margin-left:75.95pt;text-indent:-29.3pt'><span style='font-size:24.0pt;
line-height:154%;font-family:"Calibri",sans-serif'>&#9758; </span>If you need
to get the default character encoding, import the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>locale </span>module and call <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>locale.getpreferredencoding()</span>.
On my Windows laptop, it returns <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>'cp1252'</span>, but on my Linux box
upstairs, it returns <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>'UTF8'</span>. I can’t even maintain consistency in my own
house! Your results may be different (even on Windows) depending on which
version of your operating system you have installed and how your
regional/language settings are configured. This is why it’s so important to
specify the encoding every time you open a file.</p>

<h5 style='margin-top:0in;margin-right:0in;margin-bottom:25.25pt;margin-left:
16.4pt;line-height:110%'><span style='font-size:13.0pt;line-height:110%'>11.2.2.
S</span><span style='font-size:10.5pt;line-height:110%'>TREAM </span><span
style='font-size:13.0pt;line-height:110%'>O</span><span style='font-size:10.5pt;
line-height:110%'>BJECTS</span></h5>

<p class=MsoNormal style='margin-top:0in;margin-right:33.8pt;margin-bottom:
.25pt;margin-left:16.4pt'>So far, all we know is that Python has a built-in
function called <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>open()</span>. The <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>open() </span>function returns a <i>stream
object</i>, which has methods and attributes for getting information about and
manipulating a stream of characters.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>a_file
= open('examples/chinese.txt', encoding='utf-8')</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=502
 style='width:376.8pt;margin-left:38.15pt;border-collapse:collapse'>
 <tr style='height:39.3pt'>
  <td width=488 valign=top style='width:366.05pt;padding:0in 0in 0in 0in;
  height:39.3pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>a_file.name</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>'examples/chinese.txt'</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:39.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9312;</span></p>
  </td>
 </tr>
 <tr style='height:43.5pt'>
  <td width=488 valign=top style='width:366.05pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>a_file.encoding</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>'utf-8'</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9313;</span></p>
  </td>
 </tr>
 <tr style='height:18.3pt'>
  <td width=488 valign=bottom style='width:366.05pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono";
  color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
  107%;font-family:"Liberation Mono"'>a_file.mode</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9314;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.4pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'r'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>name
</span>attribute reflects the name you passed in to the <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>open() </span>function
when you opened the file. It is not normalized to an absolute pathname.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Likewise, <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>encoding </span>attribute reflects the encoding you passed
in to the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>open()
</span>function. If you didn’t specify the encoding when you opened the file
(bad developer!) then the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>encoding </span>attribute will reflect <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>locale.getpreferredencoding()</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
47.15pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>mode
</span>attribute tells you in which mode the file was opened. You can pass an
optional <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>mode
</span>parameter to the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>open() </span>function. You didn’t specify a
mode when you opened this file, so Python defaults to <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>'r'</span>, which means
“open for reading only, in text mode.” As you’ll see later in this chapter, the
file mode serves several purposes; different modes let you write to a file,
append to a file, or open a file in binary mode (in which you deal with bytes
instead of strings).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
32.7pt;margin-left:47.15pt'><span style='font-size:24.0pt;line-height:154%;
font-family:"Calibri",sans-serif'>&#9758; </span>The <a
href="http://docs.python.org/3.1/library/io.html#module-interface"><span
style='color:black'>documentation</span></a><u> </u><a
href="http://docs.python.org/3.1/library/io.html#module-interface"><span
style='color:black'>for</span></a><u> </u><a
href="http://docs.python.org/3.1/library/io.html#module-interface"><span
style='color:black'>the</span></a><u> </u><a
href="http://docs.python.org/3.1/library/io.html#module-interface"><span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono";
color:black'>open()</span></a><u><span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'> </span></u><a
href="http://docs.python.org/3.1/library/io.html#module-interface"><span
style='color:black'>function</span></a><u> </u>lists all the possible file
modes.</p>

<h5 style='margin-top:0in;margin-right:0in;margin-bottom:25.25pt;margin-left:
16.4pt;line-height:110%'><span style='font-size:13.0pt;line-height:110%'>11.2.3.
R</span><span style='font-size:10.5pt;line-height:110%'>EADING </span><span
style='font-size:13.0pt;line-height:110%'>D</span><span style='font-size:10.5pt;
line-height:110%'>ATA </span><span style='font-size:13.0pt;line-height:110%'>F</span><span
style='font-size:10.5pt;line-height:110%'>ROM </span><span style='font-size:
13.0pt;line-height:110%'>A T</span><span style='font-size:10.5pt;line-height:
110%'>EXT </span><span style='font-size:13.0pt;line-height:110%'>F</span><span
style='font-size:10.5pt;line-height:110%'>ILE</span></h5>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.9pt;margin-left:16.4pt'>After you open a file for reading, you’ll probably
want to read from it at some point.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.55pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>a_file
= open('examples/chinese.txt', encoding='utf-8')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.3pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>a_file.read()                                            </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.3pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'Dive Into Python </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Calibri",sans-serif'>&#26159;&#20026;&#26377;&#32463;&#39564;&#30340;&#31243;&#24207;&#21592;&#32534;&#20889;&#30340;&#19968;&#26412;</span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'> Python
</span><span style='font-size:10.0pt;line-height:110%;font-family:"Calibri",sans-serif'>&#20070;&#12290;</span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>\n'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>a_file.read()                                            </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>''</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Once you open a file (with the correct encoding), reading from it is
just a matter of calling the stream object’s <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>read() </span>method. The
result is a string.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.55pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Perhaps somewhat surprisingly, reading the file again does not raise an
exception. Python does not consider reading past end-of-file to be an error; it
simply returns an empty string.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.9pt;margin-left:16.4pt'>What if you want to re-read a file?</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.0pt;margin-bottom:
12.55pt;margin-left:37.9pt;line-height:110%'><img width=298 height=1
src="Dive%20Into%20Python%203_files/image033.gif" align=left hspace=12><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>#
continued from the previous example</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>a_file.read()                      </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.0pt;margin-bottom:
12.55pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono"'>''</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>a_file.seek(0)                     </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.0pt;margin-bottom:
12.55pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono"'>0</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>a_file.read(16)                    </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.0pt;margin-bottom:
12.55pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono"'>'Dive Into Python'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>a_file.read(1)                     </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.0pt;margin-bottom:
8.25pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono"'>' '</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.0pt;margin-bottom:
8.25pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>a_file.read(1)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.0pt;margin-bottom:
12.25pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono"'>'</span><span style='font-size:
10.0pt;line-height:110%;font-family:"Calibri",sans-serif'>&#26159;</span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>a_file.tell()                      </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9316;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.0pt;margin-bottom:
31.05pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono"'>20</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Since you’re still at the end of the file, further calls to the stream
object’s <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>read()
</span>method simply return an empty string.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.3pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>seek() </span>method
moves to a specific byte position in a file.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.05pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>read() </span>method
can take an optional parameter, the number of characters to read.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>If you like, you
can even read one character at a time.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.45pt;margin-left:16.65pt;text-indent:-16.65pt'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>16 + 1 + 1 = … 20?</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>Let’s try that again.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'># continued from the previous example</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=326
 style='width:3.4in;margin-left:38.15pt;border-collapse:collapse'>
 <tr style='height:39.3pt'>
  <td width=270 valign=top style='width:202.75pt;padding:0in 0in 0in 0in;
  height:39.3pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>a_file.seek(17)</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>17</span></p>
  </td>
  <td width=56 valign=top style='width:42.05pt;padding:0in 0in 0in 0in;
  height:39.3pt'>
  <p class=MsoNormal align=right style='margin:0in;text-align:right;text-indent:
  0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9312;</span></p>
  </td>
 </tr>
 <tr style='height:43.8pt'>
  <td width=270 valign=top style='width:202.75pt;padding:0in 0in 0in 0in;
  height:43.8pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.4pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>a_file.read(1)</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>'</span><span
  style='font-size:10.0pt;line-height:107%;font-family:"Calibri",sans-serif'>&#26159;</span><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>'</span></p>
  </td>
  <td width=56 valign=top style='width:42.05pt;padding:0in 0in 0in 0in;
  height:43.8pt'>
  <p class=MsoNormal align=right style='margin:0in;text-align:right;text-indent:
  0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9313;</span></p>
  </td>
 </tr>
 <tr style='height:18.3pt'>
  <td width=270 valign=bottom style='width:202.75pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono";
  color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
  107%;font-family:"Liberation Mono"'>a_file.tell()</span></p>
  </td>
  <td width=56 valign=top style='width:42.05pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal align=right style='margin:0in;text-align:right;text-indent:
  0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9314;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:33.5pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>20</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
3.2pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Move to the 17<sup><span
style='font-size:15.5pt;line-height:107%'>th </span></sup>byte.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
8.65pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Read one
character.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
24.4pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Now you’re on
the 20<sup><span style='font-size:15.5pt;line-height:107%'>th </span></sup>byte.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.55pt;margin-left:16.4pt'>Do you see it yet? The <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>seek() </span>and <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>tell() </span>methods
always count <i>bytes</i>, but since you opened this file as text, the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>read() </span>method
counts <i>characters</i>. Chinese characters <u>require multiple bytes to
encode in </u><u><span style='font-size:9.5pt;line-height:154%'>UTF</span>-8</u>.
The English characters in the file only require one byte each, so you might be
misled into thinking that the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>seek() </span>and <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>read() </span>methods are
counting the same thing. But that’s only true for some characters.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
12.9pt;margin-left:16.4pt;line-height:107%'>But wait, it gets worse!</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=366
 style='width:274.8pt;margin-left:38.15pt;border-collapse:collapse'>
 <tr style='height:39.3pt'>
  <td width=352 valign=top style='width:264.05pt;padding:0in 0in 0in 0in;
  height:39.3pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>a_file.seek(18)</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>18</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:39.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9312;</span></p>
  </td>
 </tr>
 <tr style='height:18.3pt'>
  <td width=352 valign=bottom style='width:264.05pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono";
  color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
  107%;font-family:"Liberation Mono"'>a_file.read(1)</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9313;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>Traceback (most
recent call last):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:224.45pt;margin-bottom:
0in;margin-left:62.15pt;text-indent:-12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
color:#880000'>File &quot;&lt;pyshell#12&gt;&quot;, line 1, in &lt;module&gt;
a_file.read(1)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>File
&quot;C:\Python31\lib\codecs.py&quot;, line 300, in decode</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>(result,
consumed) = self._buffer_decode(data, self.errors, final)</span></p>

<p class=MsoNormal align=right style='margin-top:0in;margin-right:14.45pt;
margin-bottom:34.15pt;margin-left:.5pt;text-align:right;line-height:110%'><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#880000'>UnicodeDecodeError: 'utf8' codec can't decode byte 0x98 in
position 0: unexpected code byte</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
5.6pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Move to the 18<sup><span
style='font-size:15.5pt;line-height:107%'>th </span></sup>byte and try to read
one character.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Why does this fail? Because there isn’t a character at the 18<sup><span
style='font-size:15.5pt;line-height:154%'>th </span></sup>byte. The nearest
character starts at the 17<sup><span style='font-size:15.5pt;line-height:154%'>th
</span></sup>byte (and goes for three bytes). Trying to read a character from
the middle will fail with a <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>UnicodeDecodeError</span>.</p>

<h5 style='margin-top:0in;margin-right:0in;margin-bottom:25.25pt;margin-left:
16.4pt;line-height:110%'><span style='font-size:13.0pt;line-height:110%'>11.2.4.
C</span><span style='font-size:10.5pt;line-height:110%'>LOSING </span><span
style='font-size:13.0pt;line-height:110%'>F</span><span style='font-size:10.5pt;
line-height:110%'>ILES</span></h5>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.05pt;margin-left:16.4pt'>Open files consume system resources, and depending
on the file mode, other programs may not be able to access them. It’s important
to close files as soon as you’re finished with them.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'># continued from the previous example</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>a_file.close()</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.9pt;margin-left:16.4pt'>Well <i>that </i>was anticlimactic.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.05pt;margin-left:16.4pt'>The stream object <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>a_file </span>still exists;
calling its <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>close()
</span>method doesn’t destroy the object itself. But it’s not terribly useful.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.55pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'># continued from the previous example</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>a_file.read()                           </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>Traceback (most
recent call last):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:230.45pt;margin-bottom:
0in;margin-left:62.15pt;text-indent:-12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
color:#880000'>File &quot;&lt;pyshell#24&gt;&quot;, line 1, in &lt;module&gt;
a_file.read()</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
12.55pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>ValueError: I/O
operation on closed file.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>a_file.seek(0)                          </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>Traceback (most
recent call last):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:224.45pt;margin-bottom:
0in;margin-left:62.15pt;text-indent:-12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
color:#880000'>File &quot;&lt;pyshell#25&gt;&quot;, line 1, in &lt;module&gt;
a_file.seek(0)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
12.55pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>ValueError: I/O
operation on closed file.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>a_file.tell()                           </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>Traceback (most
recent call last):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:230.45pt;margin-bottom:
0in;margin-left:62.15pt;text-indent:-12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
color:#880000'>File &quot;&lt;pyshell#26&gt;&quot;, line 1, in &lt;module&gt;
a_file.tell()</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
12.55pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>ValueError: I/O
operation on closed file.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>a_file.close()                          </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>a_file.closed                           </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9316;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.45pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>True</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>You can’t read
from a closed file; that raises an <span style='font-size:10.0pt;line-height:
107%;font-family:"Liberation Mono"'>IOError </span>exception.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.3pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>You can’t seek
in a closed file either.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.3pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>There’s no
current position in a closed file, so the <span style='font-size:10.0pt;
line-height:107%;font-family:"Liberation Mono"'>tell() </span>method also
fails.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Perhaps surprisingly, calling the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>close() </span>method on a
stream object whose file has been closed does <i>not </i>raise an exception.
It’s just a no-op.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
23.15pt;margin-left:16.65pt;text-indent:-16.65pt'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Closed stream objects do have one useful attribute: the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>closed </span>attribute
will confirm that the file is closed.</p>

<h5 style='margin-top:0in;margin-right:0in;margin-bottom:25.25pt;margin-left:
16.4pt;line-height:110%'><span style='font-size:13.0pt;line-height:110%'>11.2.5.
C</span><span style='font-size:10.5pt;line-height:110%'>LOSING </span><span
style='font-size:13.0pt;line-height:110%'>F</span><span style='font-size:10.5pt;
line-height:110%'>ILES </span><span style='font-size:13.0pt;line-height:110%'>A</span><span
style='font-size:10.5pt;line-height:110%'>UTOMATICALLY</span></h5>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.45pt;margin-left:16.4pt'><img width=301 height=1
src="Dive%20Into%20Python%203_files/image036.gif" align=left hspace=12>Stream
objects have an explicit <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>close() </span>method, but what happens if your
code has a bug and crashes before you call <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>close()</span>? That file could
theoretically stay open for much longer than necessary. While you’re debugging
on your local computer, that’s not a big deal. On a production server, maybe it
is.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
41.6pt;margin-left:16.4pt'>Python 2 had a solution for this: the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>try..finally
</span>block. That still works in Python 3, and you may see it in other
people’s code or in older code that was <u>ported to Python 3</u>. But Python
2.5 introduced a cleaner solution, which is now the preferred solution in
Python 3: the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>with
</span>statement.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>with open('examples/chinese.txt',
encoding='utf-8') as a_file:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>a_file.seek(17)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:260.45pt;margin-bottom:
23.4pt;margin-left:62.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>a_character = a_file.read(1)
print(a_character)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>This code calls <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>open()</span>, but it never
calls <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>a_file.close()</span>.
The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>with
</span>statement starts a code block, like an <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>if </span>statement or a <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>for </span>loop.
Inside this code block, you can use the variable <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>a_file </span>as the stream
object returned from the call to <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>open()</span>. All the regular stream
object methods are available — <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>seek()</span>, <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>read()</span>, whatever you
need. When the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>with
</span>block ends, <i>Python calls </i><span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>a_file.close() </span><i>automatically</i>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
47.1pt;margin-left:16.4pt'>Here’s the kicker: no matter how or when you exit
the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>with
</span>block, Python will close that file… even if you “exit” it via an
unhandled exception. That’s right, even if your code raises an exception and
your entire program comes to a screeching halt, that file will get closed.
Guaranteed.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:92.75pt;margin-bottom:
41.55pt;margin-left:75.95pt;text-indent:-29.3pt'><span style='font-size:24.0pt;
line-height:154%;font-family:"Calibri",sans-serif'>&#9758; </span>In technical
terms, the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>with
</span>statement creates a runtime context. In these examples, the stream
object acts as a context manager. Python creates the stream object <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>a_file </span>and
tells it that it is entering a runtime context. When the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>with </span>code
block is completed, Python tells the stream object that it is exiting the
runtime context, and the stream object calls its own <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>close() </span>method.
See <u>Appendix B, “Classes That Can Be Used in a </u><u><span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>with </span>Block”
</u>for details.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.7pt;margin-left:16.4pt'>There’s nothing file-specific about the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>with </span>statement;
it’s just a generic framework for creating runtime contexts and telling objects
that they’re entering and exiting a runtime context. If the object in question
is a stream object, then it does useful file-like things (like closing the file
automatically). But that behavior is defined in the stream object, not in the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>with </span>statement.
There are lots of other ways to use context managers that have nothing to do
with files. You can even create your own, as you’ll see later in this chapter.</p>

<h5 style='margin-top:0in;margin-right:0in;margin-bottom:25.25pt;margin-left:
16.4pt;line-height:110%'><span style='font-size:13.0pt;line-height:110%'>11.2.6.
R</span><span style='font-size:10.5pt;line-height:110%'>EADING </span><span
style='font-size:13.0pt;line-height:110%'>D</span><span style='font-size:10.5pt;
line-height:110%'>ATA </span><span style='font-size:13.0pt;line-height:110%'>O</span><span
style='font-size:10.5pt;line-height:110%'>NE </span><span style='font-size:
13.0pt;line-height:110%'>L</span><span style='font-size:10.5pt;line-height:
110%'>INE </span><span style='font-size:13.0pt;line-height:110%'>A</span><span
style='font-size:10.5pt;line-height:110%'>T </span><span style='font-size:13.0pt;
line-height:110%'>A T</span><span style='font-size:10.5pt;line-height:110%'>IME</span></h5>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.5pt;margin-left:16.4pt'>A “line” of a text file is just what you think it is
— you type a few words and press <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>ENTER</span>, and now you’re on a new line.
A line of text is a sequence of characters delimited by… what exactly? Well,
it’s complicated, because text files can use several different characters to
mark the end of a line. Every operating system has its own convention. Some use
a carriage return character, others use a line feed character, and some use
both characters at the end of every line.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
44.55pt;margin-left:16.4pt'>Now breathe a sigh of relief, because <i>Python
handles line endings automatically </i>by default. If you say, “I want to read
this text file one line at a time,” Python will figure out which kind of line
ending the text file uses and and it will all Just Work.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:21.75pt;
margin-left:46.4pt;line-height:107%'><span style='font-size:24.0pt;line-height:
107%;font-family:"Calibri",sans-serif'>&#9758;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.25in;margin-bottom:
41.5pt;margin-left:76.4pt'>If you need fine-grained control over what’s
considered a line ending, you can pass the optional <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>newline </span>parameter
to the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>open()
</span>function. See <a
href="http://docs.python.org/3.1/library/io.html#module-interface"><span
style='color:black'>the</span></a><u> </u><a
href="http://docs.python.org/3.1/library/io.html#module-interface"><span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono";
color:black'>open()</span></a><u><span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'> </span></u><a
href="http://docs.python.org/3.1/library/io.html#module-interface"><span
style='color:black'>function </span></a><a
href="http://docs.python.org/3.1/library/io.html#module-interface"><span
style='color:black'>documentation</span></a><u> </u>for all the gory details.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.9pt;margin-left:16.4pt'>So, how do you actually do it? Read a file one line
at a time, that is. It’s so simple, it’s beautiful.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>line_number = 0</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:117.65pt;margin-bottom:
18.35pt;margin-left:61.4pt;text-indent:-24.0pt;line-height:182%'><span
style='font-size:10.0pt;line-height:182%;font-family:"Liberation Mono"'>with
open('examples/favorite-people.txt', encoding='utf-8') as a_file: </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312; </span><span
style='font-size:10.0pt;line-height:182%;font-family:"Liberation Mono"'>for
a_line in a_file: </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9313; </span><span style='font-size:10.0pt;line-height:182%;
font-family:"Liberation Mono"'>line_number += 1 print('{:&gt;4}
{}'.format(line_number, a_line.rstrip()))  </span><span style='font-family:
"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.4pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Using <u>the </u><u><span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>with </span>pattern</u>,
you safely open the file and let Python close it for you.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>To read a file one line at a time, use a <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>for </span>loop. That’s it.
Besides having explicit methods like <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>read()</span>, <i>the stream object is also
an <u>iterator </u></i>which spits out a single line every time you ask for a
value.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.0pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Using <u>the </u><u><span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>format() </span>string method</u>, you can print
out the line number and the line itself. The format specifier <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>{:&gt;4}
</span>means “print this argument right-justified within 4 spaces.” The <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>a_line </span>variable
contains the complete line, carriage returns and all. The <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>rstrip()
</span>string method removes the trailing whitespace, including the carriage
return characters.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.95in;margin-bottom:
8.5pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#666677'>you@localhost:~/diveintopython3$
</span><span style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>python3
examples/oneline.py</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:68.15pt;text-indent:-12.0pt;line-height:110%'><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>1<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>Dora</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:68.15pt;text-indent:-12.0pt;line-height:110%'><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>2<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>Ethan</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:68.15pt;text-indent:-12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>3<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>Wesley4
John 5 Anne 6 Mike</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:247.25pt;margin-bottom:
8.25pt;margin-left:68.15pt;text-indent:-12.0pt;line-height:110%'><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>7<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>Chris</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:247.25pt;margin-bottom:
0in;margin-left:68.15pt;text-indent:-12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>8<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>Sarah9
Alex</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>10 Lizzie</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=675
 style='width:506.25pt;margin-left:39.5pt;border-collapse:collapse'>
 <tr style='height:347.95pt'>
  <td width=675 valign=bottom style='width:506.25pt;border:solid black 1.0pt;
  padding:0in 5.75pt 16.4pt 21.4pt;height:347.95pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:25.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'>Did you get this error?</p>
  <p class=MsoNormal style='margin-top:0in;margin-right:43.55pt;margin-bottom:
  0in;margin-left:21.55pt;text-indent:0in;line-height:185%'><span
  style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
  color:#666677'>you@localhost:~/diveintopython3$ </span><span
  style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>python3
  examples/oneline.py </span><span style='font-size:10.0pt;line-height:185%;
  font-family:"Liberation Mono";color:#880000'>Traceback (most recent call
  last):</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:91.55pt;margin-bottom:
  0in;margin-left:45.55pt;text-indent:-12.0pt;line-height:185%'><span
  style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
  color:#880000'>File &quot;examples/oneline.py&quot;, line 4, in
  &lt;module&gt; print('{:&gt;4} {}'.format(line_number, a_line.rstrip()))</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.3pt;
  margin-left:21.55pt;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#880000'>ValueError:
  zero length field name in format</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:27.0pt;
  margin-left:0in;text-indent:0in;line-height:107%'>If so, you’re probably
  using Python 3.0. You should really upgrade to Python 3.1.</p>
  <p class=MsoNormal align=center style='margin-top:0in;margin-right:20.0pt;
  margin-bottom:6.0pt;margin-left:0in;text-align:center;text-indent:0in;
  line-height:107%'>Python 3.0 supported string formatting, but only with <u>explicitly
  numbered format specifiers</u>.</p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:19.45pt;
  margin-left:0in;text-indent:0in;line-height:150%'>Python 3.1 allows you to
  omit the argument indexes in your format specifiers. Here is the Python
  3.0-compatible version for comparison:</p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
  margin-left:21.55pt;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>print('{<b><span
  style='background:gainsboro'>0</span></b>:&gt;4} {<b><span style='background:
  gainsboro'>1</span></b>}'.format(line_number, a_line.rstrip()))</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal align=right style='margin-top:0in;margin-right:293.25pt;
margin-bottom:33.0pt;margin-left:.5pt;text-align:right;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h4 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>11.3.
W</span>RITING TO <span style='font-size:18.0pt;line-height:112%'>T</span>EXT <span
style='font-size:18.0pt;line-height:112%'>F</span>ILES</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.0pt;margin-left:16.4pt'><img width=298 height=1
src="Dive%20Into%20Python%203_files/image033.gif" align=left hspace=12>You can
write to files in much the same way that you read from them. First you open a
file and get a stream object, then you use methods on the stream object to
write data to the file, then you close the file.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.95pt;margin-left:16.4pt'>To open a file for writing, use the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>open() </span>function
and specify the write mode. There are two file modes for writing:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-12.25pt'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>“Write” mode will overwrite the file. Pass <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>mode='w' </span>to the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>open() </span>function.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
7.35pt;margin-left:16.65pt;text-indent:-12.25pt;line-height:107%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>“Append” mode
will add data to the end of the file.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.4pt;margin-left:16.4pt'>Pass <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>mode='a' </span>to the <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>open() </span>function.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'><img width=298 height=1
src="Dive%20Into%20Python%203_files/image033.gif" align=left hspace=12>Either
mode will create the file automatically if it doesn’t already exist, so there’s
never a need for any sort of fiddly “if the file doesn’t exist yet, create a
new empty file just so you can open it for the first time” function.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.45pt;margin-left:16.4pt'>Just open a file and start writing.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
23.25pt;margin-left:16.4pt'>You should always close a file as soon as you’re
done writing to it, to release the file handle and ensure that the data is
actually written to disk. As with reading data from a file, you can call the
stream object’s <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>close() </span>method, or you can use the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>with </span>statement
and let Python close the file for you. I bet you can guess which technique I
recommend.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.85pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>with
open('test.log', mode='w', encoding='utf-8') as a_file: </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>...     </span><span style='font-size:10.0pt;line-height:110%;
font-family:"Liberation Mono"'>a_file.write('test succeeded')                            </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>with
open('test.log', encoding='utf-8') as a_file:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:368.45pt;margin-bottom:
4.25pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>... </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>print(a_file.read())
test succeeded</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>with
open('test.log', mode='a', encoding='utf-8') as a_file: </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>...     </span><span style='font-size:10.0pt;line-height:110%;
font-family:"Liberation Mono"'>a_file.write('and again')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>with
open('test.log', encoding='utf-8') as a_file:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.6pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>...     </span><span style='font-size:10.0pt;line-height:110%;
font-family:"Liberation Mono"'>print(a_file.read())</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:28.5pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>test
succeededand again                                           </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>You start boldly by creating the new file <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>test.log </span>(or overwriting
the existing file), and opening the file for writing. The <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>mode='w'
</span>parameter means open the file for writing. Yes, that’s all as dangerous
as it sounds. I hope you didn’t care about the previous contents of that file
(if any), because that data is gone now.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>You can add data to the newly opened file with the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>write()
</span>method of the stream object returned by the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>open() </span>function. After
the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>with
</span>block ends, Python automatically closes the file.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>That was so fun, let’s do it again. But this time, with <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>mode='a'
</span>to append to the file instead of overwriting it. Appending will <i>never
</i>harm the existing contents of the file.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
22.15pt;margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Both the original line you wrote and the second line you appended are
now in the file <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>test.log</span>. Also note that neither carriage returns nor
line feeds are included. Since you didn’t write them explicitly to the file
either time, the file doesn’t include them. You can write a carriage return
with the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>'\r'
</span>character, and/or a line feed with the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>'\n' </span>character. Since
you didn’t do either, everything you wrote to the file ended up on one line.</p>

<h5 style='margin-top:0in;margin-right:0in;margin-bottom:25.25pt;margin-left:
16.4pt;line-height:110%'><span style='font-size:13.0pt;line-height:110%'>11.3.1.
C</span><span style='font-size:10.5pt;line-height:110%'>HARACTER </span><span
style='font-size:13.0pt;line-height:110%'>E</span><span style='font-size:10.5pt;
line-height:110%'>NCODING </span><span style='font-size:13.0pt;line-height:
110%'>A</span><span style='font-size:10.5pt;line-height:110%'>GAIN</span></h5>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
45.65pt;margin-left:16.4pt'>Did you notice the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>encoding </span>parameter that
got passed in to the <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>open() </span>function while you were <u>opening a file for
writing</u>? It’s important; don’t ever leave it out! As you saw in the
beginning of this chapter, files don’t contain <i>strings</i>, they contain <i>bytes</i>.
Reading a “string” from a text file only works because you told Python what
encoding to use to read a stream of bytes and convert it to a string. Writing
text to a file presents the same problem in reverse. You can’t write characters
to a file; <u>characters are an abstraction</u>. In order to write to the file,
Python needs to know how to convert your string into a sequence of bytes. The
only way to be sure it’s performing the correct conversion is to specify the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>encoding
</span>parameter when you open the file for writing.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:33.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:13.6pt;margin-left:
16.4pt'><span style='font-size:18.0pt;line-height:112%'>11.4. B</span>INARY <span
style='font-size:18.0pt;line-height:112%'>F</span>ILES</h4>

<p class=MsoNormal style='margin-left:0in;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%;font-family:"Calibri",sans-serif'>           </span>Not
all files contain text. Some of them contain pictures of my dog.                                   <img
border=0 width=100 height=100 id="Picture 56187"
src="Dive%20Into%20Python%203_files/image048.jpg"></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=598
 style='width:448.8pt;margin-left:38.15pt;border-collapse:collapse'>
 <tr style='height:18.3pt'>
  <td width=584 valign=top style='width:438.05pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono";
  color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
  107%;font-family:"Liberation Mono"'>an_image =
  open('examples/beauregard.jpg', mode='rb')</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9312;</span></p>
  </td>
 </tr>
 <tr style='height:43.5pt'>
  <td width=584 valign=top style='width:438.05pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>an_image.mode</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>'rb'</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9313;</span></p>
  </td>
 </tr>
 <tr style='height:43.5pt'>
  <td width=584 valign=top style='width:438.05pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>an_image.name</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>'examples/beauregard.jpg'</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9314;</span></p>
  </td>
 </tr>
 <tr style='height:18.3pt'>
  <td width=584 valign=bottom style='width:438.05pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono";
  color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
  107%;font-family:"Liberation Mono"'>an_image.encoding</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9315;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>Traceback (most
recent call last):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>File
&quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
31.05pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>AttributeError:
'_io.BufferedReader' object has no attribute 'encoding'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Opening a file in binary mode is simple but subtle. The only difference
from opening it in text mode is that the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>mode </span>parameter contains
a <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>'b'
</span>character.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The stream object you get from opening a file in binary mode has many of
the same attributes, including <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>mode</span>, which reflects the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>mode </span>parameter
you passed into the <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>open() </span>function.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.35pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Binary stream
objects also have a <span style='font-size:10.0pt;line-height:107%;font-family:
"Liberation Mono"'>name </span>attribute, just like text stream objects.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.55pt;margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Here’s one difference, though: a binary stream object has no <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>encoding
</span>attribute. That makes sense, right? You’re reading (or writing) bytes,
not strings, so there’s no conversion for Python to do. What you get out of a
binary file is exactly what you put into it, no conversion necessary.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>Did I mention you’re reading bytes?
Oh yes you are.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'># continued from the previous example</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>an_image.tell()</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>0</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>data =
an_image.read(3) </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:422.45pt;margin-bottom:
3.95pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>data
b'\xff\xd8\xff'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>type(data)               </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.55pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;class 'bytes'&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>an_image.tell()          </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>3</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>an_image.seek(0)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>0</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>data =
an_image.read()</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>len(data)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>3150</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.2pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Like text files,
you can read binary files a little bit at a time. But there’s a crucial
difference…</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>…you’re reading bytes, not strings. Since you opened the file in binary
mode, the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>read()
</span>method takes <i>the number of bytes to read</i>, not the number of
characters.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
45.65pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>That means that there’s never <u>an unexpected mismatch </u>between the
number you passed into the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>read() </span>method and the position index you
get out of the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>tell()
</span>method. The <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>read() </span>method reads bytes, and the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>seek() </span>and
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>tell()
</span>methods track the number of bytes read. For binary files, they’ll always
agree.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:33.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h4 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>11.5.
S</span>TREAM <span style='font-size:18.0pt;line-height:112%'>O</span>BJECTS <span
style='font-size:18.0pt;line-height:112%'>F</span>ROM <span style='font-size:
18.0pt;line-height:112%'>N</span>ON<span style='font-size:18.0pt;line-height:
112%'>-F</span>ILE <span style='font-size:18.0pt;line-height:112%'>S</span>OURCES</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.55pt;margin-left:16.4pt'><img width=298 height=1
src="Dive%20Into%20Python%203_files/image033.gif" align=left hspace=12>Imagine
you’re writing a library, and one of your library functions is going to read
some data from a file. The function could simply take a filename as a string,
go open the file for reading, read it, and close it before exiting. But you
shouldn’t do that. Instead, your <span style='font-size:9.5pt;line-height:154%'>API
</span>should take <i>an arbitrary stream object</i>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.55pt;margin-left:16.4pt'>In the simplest case, a stream object is anything
with a <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>read()
</span>method which takes an optional <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>size </span>parameter and returns a string.
When called with no <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>size </span>parameter, the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>read() </span>method should
read everything there is to read from the input source and return all the data
as a single value. When called with a <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>size </span>parameter, it reads that much
from the input source and returns that much data. When called again, it picks
up where it left off and returns the next chunk of data.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:42.3pt;margin-bottom:
.25pt;margin-left:16.4pt'>That sounds exactly like the stream object you get
from opening a real file. The difference is that <i>you’re not limiting
yourself to real files</i>. The input source that’s being “read” could be
anything: a web page, a string in memory, even the output of another program.
As long as your functions take a stream object and simply call the object’s <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>read() </span>method,
you can handle any input source that acts like a file, without specific code to
handle each kind of input.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>a_string
= 'PapayaWhip is the new black.'</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=390
 style='width:292.8pt;margin-left:38.15pt;border-collapse:collapse'>
 <tr style='height:18.3pt'>
  <td width=376 valign=top style='width:282.05pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono";
  color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
  107%;font-family:"Liberation Mono"'>import io</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9312;</span></p>
  </td>
 </tr>
 <tr style='height:22.5pt'>
  <td width=376 valign=top style='width:282.05pt;padding:0in 0in 0in 0in;
  height:22.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono";
  color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
  107%;font-family:"Liberation Mono"'>a_file = io.StringIO(a_string)</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:22.5pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9313;</span></p>
  </td>
 </tr>
 <tr style='height:43.5pt'>
  <td width=376 valign=top style='width:282.05pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>a_file.read()</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>'PapayaWhip
  is the new black.'</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9314;</span></p>
  </td>
 </tr>
 <tr style='height:43.5pt'>
  <td width=376 valign=top style='width:282.05pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>a_file.read()</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>''</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9315;</span></p>
  </td>
 </tr>
 <tr style='height:43.5pt'>
  <td width=376 valign=top style='width:282.05pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>a_file.seek(0)</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>0</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9316;</span></p>
  </td>
 </tr>
 <tr style='height:18.3pt'>
  <td width=376 valign=bottom style='width:282.05pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono";
  color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
  107%;font-family:"Liberation Mono"'>a_file.read(10)</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9317;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'PapayaWhip'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>a_file.tell()</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>10</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>a_file.seek(18)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>18</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:434.45pt;margin-bottom:
22.95pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>a_file.read()
'new black.'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.5pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>io </span>module
defines the <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>StringIO
</span>class that you can use to treat a string in memory as a file.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>To create a stream object out of a string, create an instance of the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>io.StringIO()
</span>class and pass it the string you want to use as your “file” data. Now
you have a stream object, and you can do all sorts of stream-like things with
it.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Calling the <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>read() </span>method “reads” the entire “file,” which in the
case of a <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>StringIO
</span>object simply returns the original string.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.05pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Just like a real
file, calling the <span style='font-size:10.0pt;line-height:107%;font-family:
"Liberation Mono"'>read() </span>method again returns an empty string.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>You can explicitly seek to the beginning of the string, just like
seeking through a real file, by using the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>seek() </span>method of the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>StringIO
</span>object.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
48.75pt;margin-left:16.65pt;text-indent:-16.65pt'>6.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>You can also read the string in chunks, by passing a <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>size </span>parameter
to the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>read()
</span>method.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:77.1pt;margin-bottom:
.25pt;margin-left:75.95pt;text-indent:-29.3pt;line-height:188%'><span
style='font-size:24.0pt;line-height:188%;font-family:"Calibri",sans-serif'>&#9758;
</span><span style='font-size:10.0pt;line-height:188%;font-family:"Liberation Mono"'>io.StringIO
</span>lets you treat a string as a text file. There’s also a <span
style='font-size:10.0pt;line-height:188%;font-family:"Liberation Mono"'>io.BytesIO
</span>class, which lets you treat a byte array as a binary file.</p>

<h5 style='margin-top:0in;margin-right:0in;margin-bottom:25.25pt;margin-left:
16.4pt;line-height:110%'><span style='font-size:13.0pt;line-height:110%'>11.5.1.
H</span><span style='font-size:10.5pt;line-height:110%'>ANDLING </span><span
style='font-size:13.0pt;line-height:110%'>C</span><span style='font-size:10.5pt;
line-height:110%'>OMPRESSED </span><span style='font-size:13.0pt;line-height:
110%'>F</span><span style='font-size:10.5pt;line-height:110%'>ILES</span></h5>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.7pt;margin-left:16.4pt'>The Python standard library contains modules that
support reading and writing compressed files. There are a number of different
compression schemes; the two most popular on non-Windows systems are <a
href="http://docs.python.org/3.1/library/gzip.html"><span style='color:black'>gzip</span></a><u>
</u>and <a href="http://docs.python.org/3.1/library/bz2.html"><span
style='color:black'>bzip2</span></a>. (You may have also encountered <a
href="http://docs.python.org/3.1/library/zipfile.html"><span style='color:black'>PKZIP</span></a><u>
</u><a href="http://docs.python.org/3.1/library/zipfile.html"><span
style='color:black'>archives</span></a><u> </u>and <a
href="http://docs.python.org/3.1/library/tarfile.html"><span style='color:black'>GNU</span></a><u>
</u><a href="http://docs.python.org/3.1/library/tarfile.html"><span
style='color:black'>Tar</span></a><u> </u><a
href="http://docs.python.org/3.1/library/tarfile.html"><span style='color:black'>archives</span></a>.
Python has modules for those, too.)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.7pt;margin-left:16.4pt'>The <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>gzip </span>module lets you create a stream
object for reading or writing a gzip-compressed file. The stream object it
gives you supports the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>read() </span>method (if you opened it for
reading) or the <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>write() </span>method (if you opened it for writing). That
means you can use the methods you’ve already learned for regular files to <i>directly
read or write a gzip-compressed file</i>, without creating a temporary file to
store the decompressed data.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.0pt;margin-left:16.4pt'>As an added bonus, it supports the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>with </span>statement
too, so you can let Python automatically close your gzipcompressed file when
you’re done with it.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 align=left
 width=750 style='width:562.85pt;border-collapse:collapse;margin-left:-2.25pt;
 margin-right:-2.25pt'>
 <tr style='height:39.3pt'>
  <td width=587 valign=top style='width:440.35pt;padding:0in 0in 0in 0in;
  height:39.3pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>you@localhost:~$
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>ls
  -l out.log.gz</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>-rw-r--r-- 
  1 mark mark    79 2009-07-19 14:29 out.log.gz</span></p>
  </td>
  <td width=163 valign=top style='width:122.5pt;padding:0in 0in 0in 0in;
  height:39.3pt'>
  <p class=MsoNormal align=right style='margin:0in;text-align:right;text-indent:
  0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9313;</span></p>
  </td>
 </tr>
 <tr style='height:22.5pt'>
  <td width=587 valign=top style='width:440.35pt;padding:0in 0in 0in 0in;
  height:22.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono";
  color:#666677'>you@localhost:~$ </span><span style='font-size:10.0pt;
  line-height:107%;font-family:"Liberation Mono"'>gunzip out.log.gz</span></p>
  </td>
  <td width=163 valign=top style='width:122.5pt;padding:0in 0in 0in 0in;
  height:22.5pt'>
  <p class=MsoNormal align=right style='margin:0in;text-align:right;text-indent:
  0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9314;</span></p>
  </td>
 </tr>
 <tr style='height:18.3pt'>
  <td width=587 valign=bottom style='width:440.35pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono";
  color:#666677'>you@localhost:~$ </span><span style='font-size:10.0pt;
  line-height:107%;font-family:"Liberation Mono"'>cat out.log</span></p>
  </td>
  <td width=163 valign=top style='width:122.5pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal align=right style='margin:0in;text-align:right;text-indent:
  0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9315;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:1.95in;margin-bottom:
29.5pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#666677'>you@localhost:~$ </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>python3</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>import
gzip</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>with gzip.open('out.log.gz', mode='wb') as
z_file:                          </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;line-height:
185%;font-family:"Liberation Mono";color:#666677'>...   </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>z_file.write('A
nine mile walk is no joke, especially in the rain.'.encode('utf-8')) </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
color:#666677'>...</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.1pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>exit()</span></p>

<p class=MsoNormal style='margin-top:9.65pt;margin-right:0in;margin-bottom:
31.3pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono"'>A nine mile walk is no joke,
especially in the rain.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.05pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>You should
always open gzipped files in binary mode. (Note the <span style='font-size:
10.0pt;line-height:107%;font-family:"Liberation Mono"'>'b' </span>character in
the <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>mode
</span>argument.)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>I constructed this example on Linux. If you’re not familiar with the
command line, this command is showing the “long listing” of the gzip-compressed
file you just created in the Python Shell. This listing shows that the file
exists (good), and that it is 79 bytes long. That’s actually larger than the
string you started with! The gzip</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>file format includes a fixed-length header that
contains some metadata about the file, so it’s inefficient for extremely small
files.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>gunzip
</span>command (pronounced “gee-unzip”) decompresses the file and stores the
contents in a new file named the same as the compressed file but without the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>.gz </span>file
extension.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
9.7pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>cat </span>command
displays the contents of a file. This file contains the string you originally
wrote directly to the compressed file <span style='font-size:10.0pt;line-height:
107%;font-family:"Liberation Mono"'>out.log.gz </span>from within the Python
Shell.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=675
 style='width:506.25pt;margin-left:39.5pt;border-collapse:collapse'>
 <tr style='height:336.75pt'>
  <td width=675 style='width:506.25pt;border:solid black 1.0pt;padding:0in 0in 0in 21.4pt;
  height:336.75pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:25.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'>Did you get this error?</p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:21.55pt;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>with
  gzip.open('out.log.gz', mode='wb') as z_file:</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:-58.7pt;margin-bottom:
  0in;margin-left:21.55pt;text-indent:0in;line-height:185%'><span
  style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
  color:#666677'>...     </span><span style='font-size:10.0pt;line-height:185%;
  font-family:"Liberation Mono"'>z_file.write('A nine mile walk is no joke,
  especially in the rain.'.encode( </span><span style='font-size:10.0pt;
  line-height:185%;font-family:"Liberation Mono";color:#666677'>...</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:21.55pt;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#880000'>Traceback
  (most recent call last):</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:27.55pt;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#880000'>File
  &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.3pt;
  margin-left:21.55pt;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#880000'>AttributeError:
  'GzipFile' object has no attribute '__exit__'</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:27.15pt;
  margin-left:0in;text-indent:0in;line-height:107%'>If so, you’re probably
  using Python 3.0. You should really upgrade to Python 3.1.</p>
  <p class=MsoNormal style='margin-top:0in;margin-right:19.55pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:107%'>Python 3.0 had a <span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>gzip </span>module,
  but it did not support using a gzipped-file object as a context manager.
  Python 3.1 added the ability to use gzipped-file objects in a <span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>with </span>statement.</p>
  </td>
 </tr>
</table>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:33.45pt;
margin-bottom:0in;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h4 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>11.6.
S</span>TANDARD <span style='font-size:18.0pt;line-height:112%'>I</span>NPUT<span
style='font-size:18.0pt;line-height:112%'>, O</span>UTPUT<span
style='font-size:18.0pt;line-height:112%'>, </span>AND <span style='font-size:
18.0pt;line-height:112%'>E</span>RROR</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.55pt;margin-left:16.4pt'><img width=301 height=1
src="Dive%20Into%20Python%203_files/image036.gif" align=left hspace=12>Command-line
gurus are already familiar with the concept of standard input, standard output,
and standard error. This section is for the rest of you.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:60.2pt;margin-bottom:
19.0pt;margin-left:16.4pt'>Standard output and standard error (commonly
abbreviated <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>stdout
</span>and <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>stderr</span>)
are pipes that are built into every <span style='font-size:9.5pt;line-height:
154%'>UNIX</span>-like system, including Mac OS X and Linux. When you call the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>print()
</span>function, the thing you’re printing is sent to the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>stdout </span>pipe.
When your program crashes and prints out a traceback, it goes to the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>stderr </span>pipe.
By default, both of these pipes are just connected to the terminal window where
you are working; when your program prints something, you see the output in your
terminal window, and when a program crashes, you see the traceback in your
terminal window too. In the graphical Python Shell, the <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>stdout </span>and <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>stderr </span>pipes
default to your “Interactive Window”.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.6pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>for i
in range(3):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>...     </span><span style='font-size:10.0pt;line-height:110%;
font-family:"Liberation Mono"'>print('PapayaWhip')        </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:440.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>PapayaWhip PapayaWhip
PapayaWhip</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>import
sys</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>for i
in range(3):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:327.65pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>... </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>sys.stdout.write('is
the') </span><span style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;
</span><span style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>is
theis theis the</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>for i
in range(3):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:321.65pt;margin-bottom:
23.0pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>... </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>sys.stderr.write('new
black') </span><span style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;
</span><span style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>new
blacknew blacknew black</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>print()
</span>function, in a loop. Nothing surprising here.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span><span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>stdout
</span>is defined in the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>sys </span>module, and it is a <u>stream object</u>.
Calling its <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>write()
</span>function will print out whatever string you give it. In fact, this is
what the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>print
</span>function really does; it adds a carriage return to the end of the string
you’re printing, and calls <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>sys.stdout.write</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.5pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>In the simplest case, <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>sys.stdout </span>and <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>sys.stderr </span>send
their output to the same place: the Python <span style='font-size:9.5pt;
line-height:154%'>IDE </span>(if you’re in one), or the terminal (if you’re
running Python from the command line). Like standard output, standard error
does not add carriage returns for you. If you want carriage returns, you’ll
need to write carriage return characters.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
18.95pt;margin-left:16.4pt'><span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>sys.stdout </span>and <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>sys.stderr </span>are
stream objects, but they are write-only. Attempting to call their <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>read() </span>method
will always raise an <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>IOError</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>import
sys</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>sys.stdout.read()</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>Traceback (most
recent call last):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>File
&quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
31.95pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>IOError: not
readable</span></p>

<h5 style='margin-top:0in;margin-right:0in;margin-bottom:25.25pt;margin-left:
16.4pt;line-height:110%'><span style='font-size:13.0pt;line-height:110%'>11.6.1.
R</span><span style='font-size:10.5pt;line-height:110%'>EDIRECTING </span><span
style='font-size:13.0pt;line-height:110%'>S</span><span style='font-size:10.5pt;
line-height:110%'>TANDARD </span><span style='font-size:13.0pt;line-height:
110%'>O</span><span style='font-size:10.5pt;line-height:110%'>UTPUT</span></h5>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'><span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>sys.stdout </span>and <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>sys.stderr </span>are
stream objects, albeit ones that only support writing. But they’re not
constants; they’re variables. That means you can assign them a new value — any
other stream object — to redirect their output.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>import sys</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>class RedirectStdoutTo:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def __init__(self, out_new):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:86.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>self.out_new = out_new</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def __enter__(self):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:302.45pt;margin-bottom:
21.0pt;margin-left:86.7pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>self.out_old = sys.stdout
sys.stdout = self.out_new</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def __exit__(self, *args):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:86.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>sys.stdout = self.out_old</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:50.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>print('A') with open('out.log',
mode='w', encoding='utf-8') as a_file, RedirectStdoutTo(a_file):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>print('B')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>print('C')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.9pt;margin-left:16.4pt'>Check this out:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.95in;margin-bottom:
8.5pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#666677'>you@localhost:~/diveintopython3/examples$
</span><span style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>python3
stdout.py</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:548.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>A C</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.95in;margin-bottom:
8.5pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#666677'>you@localhost:~/diveintopython3/examples$
</span><span style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>cat
out.log</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.15pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>B</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=675
 style='width:506.25pt;margin-left:39.5pt;border-collapse:collapse'>
 <tr style='height:179.95pt'>
  <td width=675 valign=bottom style='width:506.25pt;border:solid black 1.0pt;
  padding:0in 0in 16.4pt 21.4pt;height:179.95pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:25.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'>Did you get this error?</p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:21.55pt;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>you@localhost:~/diveintopython3/examples$
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>python3
  stdout.py</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:-58.65pt;margin-bottom:
  0in;margin-left:45.55pt;text-indent:-12.0pt;line-height:185%'><span
  style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
  color:#880000'>File &quot;stdout.py&quot;, line 15 with open('out.log',
  mode='w', encoding='utf-8') as a_file, RedirectStdoutTo(a_file</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:393.6pt;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#880000'>^</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
  margin-left:21.55pt;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#880000'>SyntaxError:
  invalid syntax</span></p>
  </td>
 </tr>
</table>

<div style='border:solid black 1.0pt;padding:0in 0in 0in 0in;margin-left:60.15pt;
margin-right:64.9pt'>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:22.25pt;
margin-left:.5pt;line-height:150%;border:none;padding:0in'>If so, you’re
probably using Python 3.0. You should really upgrade to Python 3.1.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:42.6pt;
margin-left:.5pt;line-height:150%;border:none;padding:0in'>Python 3.0 supported
the <span style='font-size:10.0pt;line-height:150%;font-family:"Liberation Mono"'>with
</span>statement, but each statement can only use one context manager. Python
3.1 allows you to chain multiple context managers in a single <span
style='font-size:10.0pt;line-height:150%;font-family:"Liberation Mono"'>with </span>statement.</p>

</div>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.9pt;margin-left:16.4pt'>Let’s take the last part first.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:50.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>print('A') with open('out.log',
mode='w', encoding='utf-8') as a_file, RedirectStdoutTo(a_file):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>print('B')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.2pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>print('C')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.0pt;margin-left:16.4pt'>That’s a complicated <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>with </span>statement. Let me
rewrite it as something more recognizable.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>with open('out.log', mode='w',
encoding='utf-8') as a_file:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>with RedirectStdoutTo(a_file):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.2pt;
margin-left:86.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>print('B')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.05pt;margin-left:16.4pt'>As the rewrite shows, you actually have <i>two </i><span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>with </span>statements,
one nested within the scope of the other. The “outer” <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>with </span>statement
should be familiar by now: it opens a <span style='font-size:9.5pt;line-height:
154%'>UTF</span>-8-encoded text file named <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>out.log </span>for writing and
assigns the stream object to a variable named <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>a_file</span>. But that’s not
the only thing odd here.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>with RedirectStdoutTo(a_file):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.1pt;margin-left:16.4pt'>Where’s the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>as </span>clause? The <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>with </span>statement
doesn’t actually require one. Just like you can call a function and ignore its
return value, you can have a <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>with </span>statement that doesn’t assign the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>with </span>context
to a variable. In this case, you’re only interested in the side effects of the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>RedirectStdoutTo
</span>context.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>What are those side effects? Take a look inside the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>RedirectStdoutTo
</span>class. This class is a custom <u>context manager</u>. Any class can be a
context manager by defining two <u>special methods</u>: <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>__enter__() </span>and <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__exit__()</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>class RedirectStdoutTo:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:261.65pt;margin-bottom:
25.05pt;margin-left:86.15pt;text-indent:-24.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>def
__init__(self, out_new):    </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9312; </span><span style='font-size:10.0pt;line-height:185%;
font-family:"Liberation Mono"'>self.out_new = out_new</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:302.45pt;margin-bottom:
25.1pt;margin-left:86.15pt;text-indent:-24.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>def
__enter__(self):      </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9313; </span><span style='font-size:10.0pt;line-height:185%;
font-family:"Liberation Mono"'>self.out_old = sys.stdout sys.stdout =
self.out_new</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:273.65pt;margin-bottom:
22.9pt;margin-left:86.15pt;text-indent:-24.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>def
__exit__(self, *args):    </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9314; </span><span style='font-size:10.0pt;line-height:185%;
font-family:"Liberation Mono"'>sys.stdout = self.out_old</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:33.7pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__init__()
</span>method is called immediately after an instance is created. It takes one
parameter, the stream object that you want to use as standard output for the
life of the context. This method just saves the stream object in an instance
variable so other methods can use it later.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:33.7pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__enter__()
</span>method is a <u>special class method</u>; Python calls it when entering a
context (<i>i.e. </i>at the beginning of the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>with </span>statement). This
method saves the current value of <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>sys.stdout </span>in <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>self.out_old</span>,
then redirects standard output by assigning <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>self.out_new </span>to <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>sys.stdout</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:33.7pt;margin-bottom:
20.3pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__exit__()
</span>method is another special class method; Python calls it when exiting the
context (<i>i.e. </i>at the end of the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>with </span>statement). This
method restores standard output to its original value by assigning the saved <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>self.out_old
</span>value to <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>sys.stdout</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
23.8pt;margin-left:16.4pt'>Putting it all together:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:27.6pt;margin-bottom:
18.3pt;margin-left:38.65pt;text-align:justify;text-justify:inter-ideograph;
line-height:182%'><span style='font-size:10.0pt;line-height:182%;font-family:
"Liberation Mono"'>print('A')  </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9312; </span><span style='font-size:10.0pt;line-height:182%;
font-family:"Liberation Mono"'>with open('out.log', mode='w', encoding='utf-8')
as a_file, RedirectStdoutTo(a_file): </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9313; </span><span style='font-size:10.0pt;line-height:182%;
font-family:"Liberation Mono"'>print('B')   </span><span style='font-family:
"DejaVu Sans",sans-serif;color:#222222'>&#9314; </span><span style='font-size:
10.0pt;line-height:182%;font-family:"Liberation Mono"'>print('C')      </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>This will print to the <span style='font-size:9.5pt;line-height:154%'>IDE
</span>“Interactive Window” (or the terminal, if running the script from the
command line).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>This <u><span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>with
</span>statement </u>takes <i>a comma-separated list of contexts</i>. The
comma-separated list acts like a series of nested <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>with </span>blocks. The first
context listed is the “outer” block; the last one listed is the “inner” block.
The first context opens a file; the second context redirects <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>sys.stdout
</span>to the stream object that was created in the first context.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Because this <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>print() </span>function is executed with the context created
by the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>with
</span>statement, it will not print to the screen; it will write to the file <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>out.log</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.3pt;margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>with
</span>code block is over. Python has told each context manager to do whatever
it is they do upon exiting a context. The context managers form a
last-in-first-out stack. Upon exiting, the second context changed <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>sys.stdout
</span>back to its original value, then the first context closed the file named
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>out.log</span>.
Since standard output has been restored to its original value, calling the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>print()
</span>function will once again print to the screen.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
46.55pt;margin-left:16.4pt'>Redirecting standard error works exactly the same
way, using <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>sys.stderr
</span>instead of <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>sys.stdout</span>.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:33.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h4 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>11.7.
F</span>URTHER <span style='font-size:18.0pt;line-height:112%'>R</span>EADING</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.6pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:107%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://docs.python.org/tutorial/inputoutput.html#reading-and-writing-files"><span
style='color:black'>Reading</span></a><u> </u><a
href="http://docs.python.org/tutorial/inputoutput.html#reading-and-writing-files"><span
style='color:black'>and</span></a><u> </u><a
href="http://docs.python.org/tutorial/inputoutput.html#reading-and-writing-files"><span
style='color:black'>writing</span></a><u> </u><a
href="http://docs.python.org/tutorial/inputoutput.html#reading-and-writing-files"><span
style='color:black'>files</span></a><u> </u>in the Python.org tutorial</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://docs.python.org/3.1/library/io.html"><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:black'>io</span></a><u><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'> </span></u><a
href="http://docs.python.org/3.1/library/io.html"><span style='color:black'>module</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://docs.python.org/3.1/library/stdtypes.html#file-objects"><span
style='color:black'>Stream</span></a><u> </u><a
href="http://docs.python.org/3.1/library/stdtypes.html#file-objects"><span
style='color:black'>objects</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.05pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://docs.python.org/3.1/library/stdtypes.html#context-manager-types"><span
style='color:black'>Context</span></a><u> </u><a
href="http://docs.python.org/3.1/library/stdtypes.html#context-manager-types"><span
style='color:black'>manager</span></a><u> </u><a
href="http://docs.python.org/3.1/library/stdtypes.html#context-manager-types"><span
style='color:black'>types</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.55pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://docs.python.org/3.1/library/sys.html#sys.stdout"><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:black'>sys.stdout</span></a><u><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'> </span></u><a
href="http://docs.python.org/3.1/library/sys.html#sys.stdout"><span
style='color:black'>and</span></a><u> </u><a
href="http://docs.python.org/3.1/library/sys.html#sys.stdout"><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:black'>sys.stderr</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://en.wikipedia.org/wiki/Filesystem_in_Userspace"><span
style='font-size:9.5pt;line-height:110%;color:black'>FUSE</span></a><u><span
style='font-size:9.5pt;line-height:110%'> </span></u><a
href="http://en.wikipedia.org/wiki/Filesystem_in_Userspace"><span
style='color:black'>on</span></a><u> </u><a
href="http://en.wikipedia.org/wiki/Filesystem_in_Userspace"><span
style='color:black'>Wikipedia</span></a></p>

<h2 style='margin-top:0in;margin-right:0in;margin-bottom:0in;margin-left:16.65pt;
text-indent:0in;line-height:107%'><span style='font-size:24.0pt;line-height:
107%'>C</span><span style='font-size:19.0pt;line-height:107%'>HAPTER </span><span
style='font-size:24.0pt;line-height:107%'>12. XML</span></h2>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:39.95pt;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=736 height=4 id="Group 699608"
src="Dive%20Into%20Python%203_files/image001.gif"></span></p>

<p class=MsoNormal align=right style='margin-top:0in;margin-right:29.3pt;
margin-bottom:65.45pt;margin-left:227.0pt;text-align:right;line-height:160%'><span
style='font-size:13.0pt;line-height:160%;font-family:"Calibri",sans-serif'>&#10077;
</span><i>In the archonship of Aristaechmus, Draco enacted his ordinances. </i><span
style='font-size:13.0pt;line-height:160%;font-family:"Calibri",sans-serif'>&#10078;
</span><i>— </i><a
href="http://www.perseus.tufts.edu/cgi-bin/ptext?doc=Perseus:text:1999.01.0046;query=chapter%3D%235;layout=;loc=3.1"><i><span
style='color:black'>Aristotle</span></i></a></p>

<h3 style='margin-top:0in;margin-right:0in;margin-bottom:65.9pt;margin-left:
16.4pt;line-height:110%'><span style='font-size:18.0pt;line-height:110%'>12.1.
D</span>IVING <span style='font-size:18.0pt;line-height:110%'>I</span>N</h3>

<p class=MsoNormal style='margin-top:0in;margin-right:34.05pt;margin-bottom:
20.3pt;margin-left:16.4pt'><span style='font-size:48.0pt;line-height:154%;
font-family:"DejaVu Serif",serif;color:#888888'>N </span>early all the chapters
in this book revolve around a piece of sample code. But <sub><span
style='font-size:15.0pt;line-height:154%'>XML </span></sub>isn’t about code;
it’s about data. One common use of <span style='font-size:9.5pt;line-height:
154%'>XML </span>is “syndication feeds” that list the latest articles on a
blog, forum, or other frequently-updated website. Most popular blogging
software can produce a feed and update it whenever new articles, discussion
threads, or blog posts are published. You can follow a blog by “subscribing” to
its feed, and you can follow multiple blogs with a dedicated “<a
href="http://en.wikipedia.org/wiki/List_of_feed_aggregators"><span
style='color:black'>feed</span></a><u> </u><a
href="http://en.wikipedia.org/wiki/List_of_feed_aggregators"><span
style='color:black'>aggregator</span></a>” like <a
href="http://www.google.com/reader/"><span style='color:black'>Google </span></a><a
href="http://www.google.com/reader/"><span style='color:black'>Reader</span></a>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>Here, then, is the <span style='font-size:9.5pt;
line-height:154%'>XML </span>data we’ll be working with in this chapter. It’s a
feed — specifically, an <a href="http://atompub.org/rfc4287.html"><span
style='color:black'>Atom </span></a><a href="http://atompub.org/rfc4287.html"><span
style='color:black'>syndication</span></a><u> </u><a
href="http://atompub.org/rfc4287.html"><span style='color:black'>feed</span></a>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:224.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>&lt;?xml version='1.0'
encoding='utf-8'?&gt; &lt;feed xmlns='http://www.w3.org/2005/Atom'
xml:lang='en'&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;title&gt;dive into mark&lt;/title&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;subtitle&gt;currently between
addictions&lt;/subtitle&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;id&gt;tag:diveintomark.org,2001-07-29:/&lt;/id&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;updated&gt;2009-03-27T21:56:07Z&lt;/updated&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:50.45pt;margin-bottom:
0in;margin-left:50.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>&lt;link rel='alternate'
type='text/html' href='http://diveintomark.org/'/&gt; &lt;link rel='self'
type='application/atom+xml' href='http://diveintomark.org/feed/'/&gt;
&lt;entry&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;author&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:74.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;name&gt;Mark&lt;/name&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:74.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;uri&gt;http://diveintomark.org/&lt;/uri&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;/author&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;title&gt;Dive into history, 2009
edition&lt;/title&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:74.15pt;text-indent:-12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>&lt;link
rel='alternate' type='text/html'
href='http://diveintomark.org/archives/2009/03/27/dive-into-history-2009-edition'/&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:62.65pt;line-height:185%'><span style='font-size:10.0pt;line-height:
185%;font-family:"Liberation Mono"'>&lt;id&gt;tag:diveintomark.org,2009-03-27:/archives/20090327172042&lt;/id&gt;
&lt;updated&gt;2009-03-27T21:56:07Z&lt;/updated&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;published&gt;2009-03-27T17:20:42Z&lt;/published&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;category
scheme='http://diveintomark.org' term='diveintopython'/&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:128.45pt;margin-bottom:
0in;margin-left:62.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>&lt;category
scheme='http://diveintomark.org' term='docbook'/&gt; &lt;category
scheme='http://diveintomark.org' term='html'/&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
0in;margin-left:62.15pt;text-indent:-12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>&lt;summary
type='html'&gt;Putting an entire chapter on one page sounds bloated, but
consider this &amp;amp;mdash; my longest chapter so far would be 75 printed
pages, and it loads in under 5 seconds&amp;amp;hellip; On
dialup.&lt;/summary&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:458.45pt;margin-bottom:
0in;margin-left:50.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>&lt;/entry&gt; &lt;entry&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;author&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:74.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;name&gt;Mark&lt;/name&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:74.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;uri&gt;http://diveintomark.org/&lt;/uri&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;/author&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:218.45pt;margin-bottom:
8.25pt;margin-left:62.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>&lt;title&gt;Accessibility is a
harsh mistress&lt;/title&gt; &lt;link rel='alternate' type='text/html'
href='http://diveintomark.org/archives/2009/03/21/accessibility-is-a-harsh-mistress'/&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:62.65pt;line-height:185%'><span style='font-size:10.0pt;line-height:
185%;font-family:"Liberation Mono"'>&lt;id&gt;tag:diveintomark.org,2009-03-21:/archives/20090321200928&lt;/id&gt;
&lt;updated&gt;2009-03-22T01:05:37Z&lt;/updated&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;published&gt;2009-03-21T20:09:28Z&lt;/published&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;category
scheme='http://diveintomark.org' term='accessibility'/&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:44.45pt;margin-bottom:
0in;margin-left:74.15pt;text-indent:-12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>&lt;summary
type='html'&gt;The accessibility orthodoxy does not permit people to question
the value of features that are rarely useful and rarely used.&lt;/summary&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:458.45pt;margin-bottom:
0in;margin-left:50.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>&lt;/entry&gt; &lt;entry&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;author&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:74.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;name&gt;Mark&lt;/name&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:50.45pt;margin-bottom:
0in;margin-left:62.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>&lt;/author&gt; &lt;title&gt;A
gentle introduction to video encoding, part 1: container formats&lt;/title&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:74.15pt;text-indent:-12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>&lt;link
rel='alternate' type='text/html'
href='http://diveintomark.org/archives/2008/12/18/give-part-1-container-formats'/&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:62.65pt;line-height:185%'><span style='font-size:10.0pt;line-height:
185%;font-family:"Liberation Mono"'>&lt;id&gt;tag:diveintomark.org,2008-12-18:/archives/20081218155422&lt;/id&gt;
&lt;updated&gt;2009-01-11T19:39:22Z&lt;/updated&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;published&gt;2008-12-18T15:54:22Z&lt;/published&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:152.45pt;margin-bottom:
0in;margin-left:62.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>&lt;category
scheme='http://diveintomark.org' term='asf'/&gt; &lt;category
scheme='http://diveintomark.org' term='avi'/&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:122.45pt;margin-bottom:
0in;margin-left:62.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>&lt;category
scheme='http://diveintomark.org' term='encoding'/&gt; &lt;category
scheme='http://diveintomark.org' term='flv'/&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:152.45pt;margin-bottom:
0in;margin-left:62.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>&lt;category
scheme='http://diveintomark.org' term='GIVE'/&gt; &lt;category
scheme='http://diveintomark.org' term='mp4'/&gt; &lt;category
scheme='http://diveintomark.org' term='ogg'/&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;category
scheme='http://diveintomark.org' term='video'/&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:122.45pt;margin-bottom:
0in;margin-left:74.15pt;text-indent:-12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>&lt;summary
type='html'&gt;These notes will eventually become part of a tech talk on video
encoding.&lt;/summary&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;/entry&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:56.15pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;/feed&gt;</span></p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:33.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h4 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>12.2.
A 5-M</span>INUTE <span style='font-size:18.0pt;line-height:112%'>C</span>RASH <span
style='font-size:18.0pt;line-height:112%'>C</span>OURSE IN <span
style='font-size:18.0pt;line-height:112%'>XML</span></h4>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.7pt;margin-left:16.4pt'>If you already know about <span style='font-size:
9.5pt;line-height:154%'>XML</span>, you can skip this section.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
22.6pt;margin-left:16.4pt'><span style='font-size:9.5pt;line-height:154%'>XML </span>is
a generalized way of describing hierarchical structured data. An <span
style='font-size:9.5pt;line-height:154%'>XML </span><i>document </i>contains
one or more <i>elements</i>, which are delimited by <i>start and end tags</i>.
This is a complete (albeit boring) <span style='font-size:9.5pt;line-height:
154%'>XML </span>document:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.35pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>&lt;foo&gt;   </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:28.55pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;/foo&gt; </span><span style='font-family:
"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.15pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>This is the <i>start
tag </i>of the <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>foo
</span>element.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.8pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>This is the matching <i>end tag </i>of the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>foo </span>element. Like
balancing parentheses in writing or mathematics or code, every start tag must
be <i>closed </i>(matched) by a corresponding end tag.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
18.9pt;margin-left:16.4pt'>Elements can be <i>nested </i>to any depth. An
element <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>bar
</span>inside an element <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>foo </span>is said to be a <i>subelement </i>or <i>child
</i>of <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>foo</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;foo&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:181.7pt;margin-bottom:
8.75pt;margin-left:50.65pt;line-height:107%'><b><span style='font-size:10.0pt;
line-height:107%;font-family:"Liberation Mono";background:gainsboro'>&lt;bar&gt;&lt;/bar&gt;</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;/foo&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.05pt;margin-left:16.4pt'>The first element in every <span style='font-size:
9.5pt;line-height:154%'>XML </span>document is called the <i>root element</i>.
An <span style='font-size:9.5pt;line-height:154%'>XML </span>document can only
have one root element. The following is <b>not an </b><b><span
style='font-size:9.5pt;line-height:154%'>XML </span>document</b>, because it
has two root elements:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;foo&gt;&lt;/foo&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;bar&gt;&lt;/bar&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
23.0pt;margin-left:16.4pt'>Elements can have <i>attributes</i>, which are
name-value pairs. Attributes are listed within the start tag of an element and
separated by whitespace. <i>Attribute names </i>can not be repeated within an
element. <i>Attribute values </i>must be quoted. You may use either single or
double quotes.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.1pt;
margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:11.0pt;
line-height:107%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>&lt;foo
<b><span style='background:gainsboro'>lang='en'</span></b>&gt;                          </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;bar id=xml-'papayawhip'&gt;<b><span
style='background:gainsboro'>lang=&quot;fr&quot;</span></b>&gt;&lt;/bar&gt; </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;/foo&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.55pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>foo </span>element
has one attribute, named <span style='font-size:10.0pt;line-height:107%;
font-family:"Liberation Mono"'>lang</span>. The value of its <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>lang </span>attribute
is <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>en</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.6pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>bar
</span>element has two attributes, named <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>id </span>and <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>lang</span>.
The value of its <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>lang </span>attribute is <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>fr</span>. This doesn’t
conflict with the <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>foo </span>element in any way. Each element has its own set
of attributes.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.55pt;margin-left:16.4pt'>If an element has more than one attribute, the
ordering of the attributes is not significant. An element’s attributes form an
unordered set of keys and values, like a Python dictionary. There is no limit
to the number of attributes you can define on each element.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.9pt;margin-left:16.4pt'>Elements can have <i>text content</i>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;foo lang='en'&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;bar lang='fr'&gt;<b><span
style='background:gainsboro'>PapayaWhip</span></b>&lt;/bar&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;/foo&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.9pt;margin-left:16.4pt'>Elements that contain no text and no children are <i>empty</i>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.1pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;foo&gt;&lt;/foo&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.05pt;margin-left:16.4pt'>There is a shorthand for writing empty elements. By
putting a <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>/
</span>character in the start tag, you can skip the end tag altogther. The <span
style='font-size:9.5pt;line-height:154%'>XML </span>document in the previous
example could be written like this instead:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.15pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;foo<b><span style='background:gainsboro'>/</span></b>&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>Like Python functions can be declared in different <i>modules</i>,
<span style='font-size:9.5pt;line-height:154%'>XML </span>elements can be
declared in different <i>namespaces</i>. Namespaces usually look like URLs. You
use an <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>xmlns
</span>declaration to define a <i>default namespace</i>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
24.1pt;margin-left:16.4pt'>A namespace declaration looks similar to an
attribute, but it has a different purpose.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:181.7pt;margin-bottom:
10.05pt;margin-left:37.9pt;line-height:107%'><span style='font-size:10.0pt;
line-height:107%;font-family:"Liberation Mono"'>&lt;feed <b><span
style='background:gainsboro'>xmlns='http://www.w3.org/2005/Atom'</span></b>&gt;
</span><span style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                      </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>&lt;title&gt;dive
into mark&lt;/title&gt;             </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:32.6pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;/feed&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:15.25pt;margin-bottom:
6.8pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:110%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The <span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>feed </span>element
is in the <span style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>http://www.w3.org/2005/Atom
</span>namespace.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:15.25pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>title
</span>element is also in the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>http://www.w3.org/2005/Atom </span>namespace.
The namespace declaration affects the element where it’s declared, plus all
child elements.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
23.25pt;margin-left:16.4pt'>You can also use an <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>xmlns:prefix </span>declaration
to define a namespace and associate it with a <i>prefix</i>. Then each element
in that namespace must be explicitly declared with the prefix.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:181.7pt;margin-bottom:
10.1pt;margin-left:37.9pt;line-height:107%'><span style='font-size:10.0pt;
line-height:107%;font-family:"Liberation Mono"'>&lt;atom:feed <b><span
style='background:gainsboro'>xmlns:atom='http://www.w3.org/2005/Atom'</span></b>&gt;
</span><span style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                      </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>&lt;atom:title&gt;dive
into mark&lt;/atom:title&gt;             </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:32.6pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;/atom:feed&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:15.25pt;margin-bottom:
7.15pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:110%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The <span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>feed </span>element
is in the <span style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>http://www.w3.org/2005/Atom
</span>namespace.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:15.25pt;margin-bottom:
.3in;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>title
</span>element is also in the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>http://www.w3.org/2005/Atom </span>namespace.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.7pt;margin-left:16.4pt'>As far as an <span style='font-size:9.5pt;
line-height:154%'>XML </span>parser is concerned, the previous two <span
style='font-size:9.5pt;line-height:154%'>XML </span>documents are <i>identical</i>.
Namespace + element name = <span style='font-size:9.5pt;line-height:154%'>XML </span>identity.
Prefixes only exist to refer to namespaces, so the actual prefix name (<span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>atom:</span>)
is irrelevant. The namespaces match, the element names match, the attributes
(or lack of attributes) match, and each element’s text content matches,
therefore the <span style='font-size:9.5pt;line-height:154%'>XML </span>documents
are the same.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.05pt;margin-left:16.4pt'>Finally, <span style='font-size:9.5pt;line-height:
154%'>XML </span>documents can contain <u>character encoding information </u>on
the first line, before the root element. (If you’re curious how a document can
contain information which needs to be known before the document can be parsed, <a
href="http://www.w3.org/TR/REC-xml/#sec-guessing-no-ext-info"><span
style='color:black'>Section</span></a><u> </u><a
href="http://www.w3.org/TR/REC-xml/#sec-guessing-no-ext-info"><span
style='color:black'>F</span></a><u> </u><a
href="http://www.w3.org/TR/REC-xml/#sec-guessing-no-ext-info"><span
style='color:black'>of</span></a><u> </u><a
href="http://www.w3.org/TR/REC-xml/#sec-guessing-no-ext-info"><span
style='color:black'>the</span></a><u> </u><a
href="http://www.w3.org/TR/REC-xml/#sec-guessing-no-ext-info"><span
style='font-size:9.5pt;line-height:154%;color:black'>XML</span></a><u><span
style='font-size:9.5pt;line-height:154%'> </span></u><a
href="http://www.w3.org/TR/REC-xml/#sec-guessing-no-ext-info"><span
style='color:black'>specification</span></a><u> </u>details how to resolve this
Catch-22.)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;?xml version='1.0' <b><span
style='background:gainsboro'>encoding='utf-8'</span></b>?&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
46.6pt;margin-left:16.4pt'>And now you know just enough <span style='font-size:
9.5pt;line-height:154%'>XML </span>to be dangerous!</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:33.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h4 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>12.3.
T</span>HE <span style='font-size:18.0pt;line-height:112%'>S</span>TRUCTURE <span
style='font-size:18.0pt;line-height:112%'>O</span>F <span style='font-size:
18.0pt;line-height:112%'>A</span>N <span style='font-size:18.0pt;line-height:
112%'>A</span>TOM <span style='font-size:18.0pt;line-height:112%'>F</span>EED</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>Think of a weblog, or in fact any website with
frequently updated content, like <a href="http://www.cnn.com/"><span
style='color:black'>CNN.com</span></a>. The site itself has a title
(“CNN.com”), a subtitle (“Breaking News, U.S., World, Weather, Entertainment <i><span
style='font-size:13.0pt;line-height:154%;font-family:"DejaVu Serif",serif'>&amp;
</span></i>Video News”), a last-updated date (“updated 12:43 p.m. EDT, Sat May
16, 2009”), and a list of articles posted at different times. Each article also
has a title, a first-published date (and maybe also a last-updated date, if
they published a correction or fixed a typo), and a unique URL.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.75pt;margin-left:16.4pt'>The Atom syndication format is designed to capture
all of this information in a standard format. My weblog and CNN.com are wildly
different in design, scope, and audience, but they both have the same basic
structure. CNN.com has a title; my blog has a title. CNN.com publishes
articles; I publish articles.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
22.8pt;margin-left:16.4pt'>At the top level is the <i>root element</i>, which
every Atom feed shares: the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>feed </span>element in the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>http://www.w3.org/2005/Atom
</span>namespace.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:207.65pt;margin-bottom:
20.2pt;margin-left:73.4pt;text-indent:-.5in;line-height:178%'><span
style='font-size:10.0pt;line-height:178%;font-family:"Liberation Mono"'>&lt;feed
xmlns='http://www.w3.org/2005/Atom' </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9312; </span><span style='font-size:10.0pt;line-height:178%;
font-family:"Liberation Mono"'>xml:lang='en'&gt;    </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:15.25pt;margin-bottom:
5.95pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:110%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>http://www.w3.org/2005/Atom
</span>is the Atom namespace.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:15.25pt;margin-bottom:
6.35pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Any element can
contain an <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>xml:lang
</span>attribute, which declares the language of the element and its children.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.05pt;margin-left:16.4pt;line-height:107%'>In this case, the <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>xml:lang
</span>attribute is declared once on the root element, which means the entire
feed is in</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.3pt;margin-left:16.4pt'>English.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.0pt;margin-left:16.4pt'>An Atom feed contains several pieces of information
about the feed itself. These are declared as children of the root-level <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>feed </span>element.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;feed
xmlns='http://www.w3.org/2005/Atom' xml:lang='en'&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.9pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                      </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>&lt;title&gt;dive
into mark&lt;/title&gt;                                             </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.85pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                      </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>&lt;subtitle&gt;currently
between addictions&lt;/subtitle&gt;                         </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.85pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                      </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>&lt;id&gt;tag:diveintomark.org,2001-07-29:/&lt;/id&gt;                                </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.9pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                      </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>&lt;updated&gt;2009-03-27T21:56:07Z&lt;/updated&gt;                                   </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.35pt;
margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;link rel='alternate' type='text/html'
href='http://diveintomark.org/'/&gt; </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9316;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
7.55pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The title of
this feed is <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>dive
into mark</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
5.7pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:110%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The subtitle of
this feed is <span style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>currently
between addictions</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Every feed needs
a globally unique identifier. See <a href="http://www.ietf.org/rfc/rfc4151.txt"><span
style='color:black'>RFC</span></a><u> </u><a
href="http://www.ietf.org/rfc/rfc4151.txt"><span style='color:black'>4151</span></a><u>
</u>for how to create one.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>This feed was last updated on March 27, 2009, at 21:56 GMT. This is
usually equivalent to the last-modified date of the most recent article.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Now things start to get interesting. This <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>link </span>element has no text
content, but it has three attributes: <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>rel</span>, <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>type</span>, and <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>href</span>.
The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>rel
</span>value tells you what kind of link this is; <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>rel='alternate' </span>means
that this is a link to an alternate representation of this feed. The <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>type='text/html'
</span>attribute means that this is a link to an <span style='font-size:9.5pt;
line-height:154%'>HTML </span>page. And the link target is given in the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>href </span>attribute.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.65in;margin-left:16.4pt'>Now we know that this is a feed for a site named
“dive into mark“ which is available at <a href="http://diveintomark.org/"><span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono";
color:black'>http://diveintomark.org/</span></a><u><span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'> </span></u>and was last
updated on March 27, 2009.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:67.0pt;margin-bottom:
36.55pt;margin-left:75.95pt;text-indent:-29.3pt;line-height:189%'><span
style='font-size:24.0pt;line-height:189%;font-family:"Calibri",sans-serif'>&#9758;
</span>Although the order of elements can be relevant in some <span
style='font-size:9.5pt;line-height:189%'>XML </span>documents, it is not
relevant in an Atom feed.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.9pt;margin-left:16.4pt'>After the feed-level metadata is the list of the
most recent articles. An article looks like this:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;entry&gt;</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=598
 style='width:448.8pt;margin-left:50.15pt;border-collapse:collapse'>
 <tr style='height:81.3pt'>
  <td width=412 valign=top style='width:308.7pt;padding:0in 0in 0in 0in;
  height:81.3pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>&lt;author&gt;</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:12.0pt;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>&lt;name&gt;Mark&lt;/name&gt;</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:32.7pt;margin-bottom:
  0in;margin-left:0in;text-indent:12.0pt;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>&lt;uri&gt;http://diveintomark.org/&lt;/uri&gt;
  &lt;/author&gt;</span></p>
  </td>
  <td width=187 valign=top style='width:140.15pt;padding:0in 0in 0in 0in;
  height:81.3pt'>
  <p class=MsoNormal align=right style='margin:0in;text-align:right;text-indent:
  0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9312;</span></p>
  </td>
 </tr>
 <tr style='height:22.5pt'>
  <td width=412 valign=top style='width:308.7pt;padding:0in 0in 0in 0in;
  height:22.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>&lt;title&gt;Dive
  into history, 2009 edition&lt;/title&gt;</span></p>
  </td>
  <td width=187 valign=top style='width:140.15pt;padding:0in 0in 0in 0in;
  height:22.5pt'>
  <p class=MsoNormal align=right style='margin:0in;text-align:right;text-indent:
  0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9313;</span></p>
  </td>
 </tr>
 <tr style='height:18.3pt'>
  <td width=412 valign=bottom style='width:308.7pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>&lt;link
  rel='alternate' type='text/html'</span></p>
  </td>
  <td width=187 valign=top style='width:140.15pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal align=right style='margin:0in;text-align:right;text-indent:
  0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9314;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal align=right style='margin-top:0in;margin-right:38.45pt;
margin-bottom:0in;margin-left:.5pt;text-align:right;line-height:110%'><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>href='http://diveintomark.org/archives/2009/03/27/dive-into-history-2009-edition'/&gt;</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=598
 style='width:448.8pt;margin-left:50.15pt;border-collapse:collapse'>
 <tr style='height:18.3pt'>
  <td width=584 valign=top style='width:438.05pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>&lt;id&gt;tag:diveintomark.org,2009-03-27:/archives/20090327172042&lt;/id&gt;</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9315;</span></p>
  </td>
 </tr>
 <tr style='height:43.5pt'>
  <td width=584 valign=top style='width:438.05pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>&lt;updated&gt;2009-03-27T21:56:07Z&lt;/updated&gt;</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>&lt;published&gt;2009-03-27T17:20:42Z&lt;/published&gt;</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9316;</span></p>
  </td>
 </tr>
 <tr style='height:64.5pt'>
  <td width=584 valign=top style='width:438.05pt;padding:0in 0in 0in 0in;
  height:64.5pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>&lt;category
  scheme='http://diveintomark.org' term='diveintopython'/&gt;</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:30.05pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>&lt;category
  scheme='http://diveintomark.org' term='docbook'/&gt; &lt;category
  scheme='http://diveintomark.org' term='html'/&gt;</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:64.5pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9317;</span></p>
  </td>
 </tr>
 <tr style='height:18.3pt'>
  <td width=584 valign=bottom style='width:438.05pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>&lt;summary
  type='html'&gt;Putting an entire chapter on one page sounds</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9318;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
3.8pt;margin-left:62.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>bloated, but consider this
&amp;amp;mdash; my longest chapter so far would be 75 printed pages, and it
loads in under 5 seconds&amp;amp;hellip; On dialup.&lt;/summary&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:28.45pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>&lt;/entry&gt;                                                                   </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9319;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:33.8pt;text-indent:-33.8pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>author
</span>element tells who wrote this article: some guy named Mark, whom you can
find loafing at <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>http://diveintomark.org/</span>. (This is the same as the
alternate link in the feed metadata, but it doesn’t have to be. Many weblogs
have multiple authors, each with their own personal website.)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:33.8pt;text-indent:-33.8pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>title
</span>element gives the title of the article, “Dive into history, 2009
edition”.</p>

</div>

<span style='font-size:12.0pt;line-height:154%;font-family:"Gill Sans MT",sans-serif;
color:black'><br clear=all style='page-break-before:always'>
</span>

<div class=WordSection17>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.1pt;margin-left:33.8pt;text-indent:-33.8pt;line-height:107%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>with the feed-level alternate link, this <span style='font-size:10.0pt;
line-height:107%;font-family:"Liberation Mono"'>link </span>element gives the
address of the <span style='font-size:9.5pt;line-height:107%'>HTML </span>version
of this article.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.6pt;margin-left:33.8pt;text-indent:-33.8pt;line-height:107%'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Entries, like feeds, need a unique identifier.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.75pt;margin-left:33.8pt;text-indent:-33.8pt;line-height:107%'>5.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Entries have two dates: a first-published date (<span style='font-size:
10.0pt;line-height:107%;font-family:"Liberation Mono"'>published</span>) and a
last-modified date (<span style='font-size:10.0pt;line-height:107%;font-family:
"Liberation Mono"'>updated</span>).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
1.75pt;margin-left:33.8pt;text-indent:-33.8pt'>6.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Entries can have an arbitrary number of categories. This article is
filed under <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>diveintopython</span>,
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>docbook</span>,
and <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>html</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:33.8pt;text-indent:-33.8pt'>7.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>summary
</span>element gives a brief summary of the article. (There is also a <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>content
</span>element, not shown here, if you want to include the complete article
text in your feed.) This <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>summary </span>element has the Atomspecific <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>type='html'
</span>attribute, which specifies that this summary is a snippet of <span
style='font-size:9.5pt;line-height:154%'>HTML</span>, not plain text. This is
important, since it has <span style='font-size:9.5pt;line-height:154%'>HTML</span>-specific
entities in it (<span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>&amp;mdash; </span>and <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>&amp;hellip;</span>) which
should be rendered as “—” and “…” rather than displayed directly.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
46.6pt;margin-left:33.8pt;text-indent:-33.8pt'>8.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Finally, the end tag for the <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>entry </span>element, signaling the end of
the metadata for this article.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:2.4pt;
margin-bottom:32.1pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h3 style='margin-top:0in;margin-right:0in;margin-bottom:17.4pt;margin-left:
16.4pt;line-height:110%'><span style='font-size:18.0pt;line-height:110%'>12.4.
P</span>ARSING <span style='font-size:18.0pt;line-height:110%'>XML</span></h3>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:23.2pt;
margin-left:16.4pt'>Python can parse <span style='font-size:9.5pt;line-height:
154%'>XML </span>documents in several ways. It has traditional <a
href="http://en.wikipedia.org/wiki/XML#DOM"><span style='font-size:9.5pt;
line-height:154%;color:black'>DOM</span></a><u><span style='font-size:9.5pt;
line-height:154%'> </span></u>and <a
href="http://en.wikipedia.org/wiki/Simple_API_for_XML"><span style='font-size:
9.5pt;line-height:154%;color:black'>SAX</span></a><u><span style='font-size:
9.5pt;line-height:154%'> </span></u>parsers, but I will focus on a different
library called ElementTree.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.85pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>import xml.etree.ElementTree as etree    </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.8pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>tree =
etree.parse('examples/feed.xml') </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.4pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>root = tree.getroot()                    </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>root                                     </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.9pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;Element
{http://www.w3.org/2005/Atom}feed at cd1eb0&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.25pt;
margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The ElementTree
library is part of the Python standard library, in <span style='font-size:10.0pt;
line-height:107%;font-family:"Liberation Mono"'>xml.etree.ElementTree</span>.</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The primary
entry point for the ElementTree library is the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>parse() </span>function, which
can take a filename or a <u>file-like object</u>. This function parses the
entire document at once. If memory is tight, there are ways to <a
href="http://effbot.org/zone/element-iterparse.htm"><span style='color:black'>parse
</span></a><a href="http://effbot.org/zone/element-iterparse.htm"><span
style='color:black'>an</span></a><u> </u><a
href="http://effbot.org/zone/element-iterparse.htm"><span style='font-size:
9.5pt;line-height:154%;color:black'>XML</span></a><u><span style='font-size:
9.5pt;line-height:154%'> </span></u><a
href="http://effbot.org/zone/element-iterparse.htm"><span style='color:black'>document</span></a><u>
</u><a href="http://effbot.org/zone/element-iterparse.htm"><span
style='color:black'>incrementally</span></a><u> </u><a
href="http://effbot.org/zone/element-iterparse.htm"><span style='color:black'>instead</span></a>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.55pt;
margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>parse()
</span>function returns an object which represents the entire document. This is
<i>not </i>the root element.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>To get a reference to the root
element, call the <span style='font-size:10.0pt;line-height:107%;font-family:
"Liberation Mono"'>getroot() </span>method.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:47.8pt;
margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>expected, the root element is the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>feed </span>element in the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>http://www.w3.org/2005/Atom
</span>namespace. The string representation of this object reinforces an
important point: an <span style='font-size:9.5pt;line-height:154%'>XML </span>element
is a combination of its namespace and its tag name (also called the <i>local
name</i>). Every element in this document is in the Atom namespace, so the root
element is represented as <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>{http://www.w3.org/2005/Atom}feed</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:42.6pt;margin-bottom:
37.9pt;margin-left:75.95pt;text-indent:-29.3pt;line-height:190%'><span
style='font-size:24.0pt;line-height:190%;font-family:"Calibri",sans-serif'>&#9758;
</span>ElementTree represents <span style='font-size:9.5pt;line-height:190%'>XML
</span>elements as <span style='font-size:10.0pt;line-height:190%;font-family:
"Liberation Mono"'>{namespace}localname</span>. You’ll see and use this format
in multiple places in the ElementTree <span style='font-size:9.5pt;line-height:
190%'>API</span>.</p>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:25.25pt;margin-left:
16.4pt;line-height:110%'><span style='font-size:13.0pt;line-height:110%'>12.4.1.
E</span><span style='font-size:10.5pt;line-height:110%'>LEMENTS </span><span
style='font-size:13.0pt;line-height:110%'>A</span><span style='font-size:10.5pt;
line-height:110%'>RE </span><span style='font-size:13.0pt;line-height:110%'>L</span><span
style='font-size:10.5pt;line-height:110%'>ISTS</span></h4>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.9pt;margin-left:16.4pt'>In the ElementTree API, an element acts like a list.
The items of the list are the element’s children.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.45pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'># continued from the previous example</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>root.tag                        </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'{http://www.w3.org/2005/Atom}feed'</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=302
 style='width:3.15in;margin-left:38.15pt;border-collapse:collapse'>
 <tr style='height:39.3pt'>
  <td width=288 valign=top style='width:216.05pt;padding:0in 0in 0in 0in;
  height:39.3pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>len(root)</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>8</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:39.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9313;</span></p>
  </td>
 </tr>
 <tr style='height:22.5pt'>
  <td width=288 valign=top style='width:216.05pt;padding:0in 0in 0in 0in;
  height:22.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono";
  color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
  107%;font-family:"Liberation Mono"'>for child in root:</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:22.5pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9314;</span></p>
  </td>
 </tr>
 <tr style='height:18.3pt'>
  <td width=288 valign=bottom style='width:216.05pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono";
  color:#666677'>...   </span><span style='font-size:10.0pt;line-height:107%;
  font-family:"Liberation Mono"'>print(child)</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9315;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:1.95in;margin-bottom:
8.5pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#666677'>...</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;Element
{http://www.w3.org/2005/Atom}title at e2b5d0&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:139.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>&lt;Element
{http://www.w3.org/2005/Atom}subtitle at e2b4e0&gt; &lt;Element
{http://www.w3.org/2005/Atom}id at e2b6c0&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:145.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>&lt;Element
{http://www.w3.org/2005/Atom}updated at e2b6f0&gt; &lt;Element
{http://www.w3.org/2005/Atom}link at e2b4b0&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:157.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>&lt;Element
{http://www.w3.org/2005/Atom}entry at e2b720&gt; &lt;Element
{http://www.w3.org/2005/Atom}entry at e2b510&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:32.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;Element
{http://www.w3.org/2005/Atom}entry at e2b750&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
5.95pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Continuing from
the previous example, the root element is <span style='font-size:10.0pt;
line-height:107%;font-family:"Liberation Mono"'>{http://www.w3.org/2005/Atom}feed</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The “length” of
the root element is the number of child elements.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>You can use the
element itself as an iterator to loop through all of its child elements.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.35pt;margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>you can see from the output, there are indeed 8 child elements: all of
the feed-level metadata (<span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>title</span>, <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>subtitle</span>, <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>id</span>,
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>updated</span>,
and <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>link</span>)
followed by the three <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>entry </span>elements.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:22.15pt;
margin-left:16.4pt'>You may have guessed this already, but I want to point it
out explicitly: the list of child elements only includes <i>direct </i>children.
Each of the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>entry
</span>elements contain their own children, but those are not included in the
list. They would be included in the list of each <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>entry</span>’s children, but
they are not included in the list of the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>feed</span>’s children. There
are ways to find elements no matter how deeply nested they are; we’ll look at
two such ways later in this chapter.</p>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:25.25pt;margin-left:
16.4pt;line-height:110%'><span style='font-size:13.0pt;line-height:110%'>12.4.2.
A</span><span style='font-size:10.5pt;line-height:110%'>TTRIBUTES </span><span
style='font-size:13.0pt;line-height:110%'>A</span><span style='font-size:10.5pt;
line-height:110%'>RE </span><span style='font-size:13.0pt;line-height:110%'>D</span><span
style='font-size:10.5pt;line-height:110%'>ICTONARIES</span></h4>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:19.05pt;
margin-left:16.4pt'><span style='font-size:9.5pt;line-height:154%'>XML </span>isn’t
just a collection of elements; each element can also have its own set of
attributes. Once you have a reference to a specific element, you can easily get
its attributes as a Python dictionary.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.5pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'># continuing from the previous example</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>root.attrib                           </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.4pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>{'{http://www.w3.org/XML/1998/namespace}lang':
'en'}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>root[4]                               </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.55pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;Element
{http://www.w3.org/2005/Atom}link at e181b0&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>root[4].attrib                        </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>{'href': 'http://diveintomark.org/',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'type': 'text/html',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.4pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'rel': 'alternate'}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>root[3]                               </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.55pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;Element
{http://www.w3.org/2005/Atom}updated at e2b4e0&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>root[3].attrib                        </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9316;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.45pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>{}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>attrib
</span>property is a dictionary of the element’s attributes. The original
markup here was <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>&lt;feed xmlns='http://www.w3.org/2005/Atom'
xml:lang='en'&gt;</span>. The <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>xml: </span>prefix refers to a built-in
namespace that every <span style='font-size:9.5pt;line-height:154%'>XML </span>document
can use without declaring it.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.95pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The fifth child
— <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>[4]
</span>in a 0-based list — is the <span style='font-size:10.0pt;line-height:
107%;font-family:"Liberation Mono"'>link </span>element.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.55pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>link </span>element
has three attributes: <span style='font-size:10.0pt;line-height:107%;
font-family:"Liberation Mono"'>href</span>, <span style='font-size:10.0pt;
line-height:107%;font-family:"Liberation Mono"'>type</span>, and <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>rel</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The fourth child
— <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>[3]
</span>in a 0-based list — is the <span style='font-size:10.0pt;line-height:
107%;font-family:"Liberation Mono"'>updated </span>element.</p>

</div>

<span style='font-size:12.0pt;line-height:154%;font-family:"Gill Sans MT",sans-serif;
color:black'><br clear=all style='page-break-before:always'>
</span>

<div class=WordSection18>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
46.6pt;margin-left:16.65pt;text-indent:-16.65pt'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>updated
</span>element has no attributes, so its <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>.attrib </span>is just an empty
dictionary.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:33.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h4 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>12.5.
S</span>EARCHING <span style='font-size:18.0pt;line-height:112%'>F</span>OR <span
style='font-size:18.0pt;line-height:112%'>N</span>ODES <span style='font-size:
18.0pt;line-height:112%'>W</span>ITHIN <span style='font-size:18.0pt;
line-height:112%'>A</span>N <span style='font-size:18.0pt;line-height:112%'>XML
D</span>OCUMENT</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.0pt;margin-left:16.4pt'>So far, we’ve worked with this <span
style='font-size:9.5pt;line-height:154%'>XML </span>document “from the top
down,” starting with the root element, getting its child elements, and so on
throughout the document. But many uses of <span style='font-size:9.5pt;
line-height:154%'>XML </span>require you to find specific elements. Etree can
do that, too.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>import
xml.etree.ElementTree as etree</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>tree =
etree.parse('examples/feed.xml')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>root =
tree.getroot()</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>root.findall('{http://www.w3.org/2005/Atom}entry')    </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>[&lt;Element
{http://www.w3.org/2005/Atom}entry at e2b4e0&gt;,</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;Element
{http://www.w3.org/2005/Atom}entry at e2b510&gt;,</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;Element
{http://www.w3.org/2005/Atom}entry at e2b540&gt;]</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>root.tag</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'{http://www.w3.org/2005/Atom}feed'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>root.findall('{http://www.w3.org/2005/Atom}feed')     </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>[]</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>root.findall('{http://www.w3.org/2005/Atom}author')   </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.4pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>[]</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>findall()
</span>method finds child elements that match a specific query. (More on the
query format in a minute.)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Each element — including the root element, but also child elements — has
a <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>findall()
</span>method. It finds all matching elements among the element’s children. But
why aren’t there any results? Although it may not be obvious, this particular
query only searches the element’s children. Since the root <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>feed </span>element
has no child named <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>feed</span>, this query returns an empty list.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.5pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>This result may
also surprise you. <u>There is an </u><u><span style='font-size:10.0pt;
line-height:107%;font-family:"Liberation Mono"'>author </span>element </u>in
this document; in fact, there are three</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
23.25pt;margin-left:16.4pt'>(one in each <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>entry</span>). But those <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>author </span>elements
are not <i>direct children </i>of the root element; they are “grandchildren”
(literally, a child element of a child element). If you want to look for <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>author </span>elements
at any nesting level, you can do that, but the query format is slightly
different.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>tree.findall('{http://www.w3.org/2005/Atom}entry')    </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>[&lt;Element
{http://www.w3.org/2005/Atom}entry at e2b4e0&gt;,</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:176.45pt;margin-bottom:
4.2pt;margin-left:44.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>&lt;Element
{http://www.w3.org/2005/Atom}entry at e2b510&gt;, &lt;Element
{http://www.w3.org/2005/Atom}entry at e2b540&gt;]</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>tree.findall('{http://www.w3.org/2005/Atom}author')   </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>[]</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>For convenience, the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>tree </span>object (returned from the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>etree.parse()
</span>function) has several methods that mirror the methods on the root
element. The results are the same as if you had called the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>tree.getroot().findall()
</span>method.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.7pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Perhaps surprisingly, this query does not find the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>author </span>elements
in this document. Why not? Because this is just a shortcut for <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>tree.getroot().findall('{http://www.w3.org/2005/Atom}author')</span>,
which means “find all the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>author </span>elements that are children of the
root element.” The <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>author </span>elements are not children of the root element;
they’re children of the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>entry </span>elements. Thus the query doesn’t
return any matches.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
23.25pt;margin-left:16.4pt'>There is also a <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>find() </span>method which
returns the first matching element. This is useful for situations where you are
only expecting one match, or if there are multiple matches, you only care about
the first one.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>entries =
tree.findall('{http://www.w3.org/2005/Atom}entry')           </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>len(entries)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.95in;margin-bottom:
12.75pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#666677'>3</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>title_element
= entries[0].find('{http://www.w3.org/2005/Atom}title') </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>title_element.text</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'Dive into history, 2009 edition'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>foo_element =
entries[0].find('{http://www.w3.org/2005/Atom}foo')      </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>foo_element</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>type(foo_element)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.55pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;class 'NoneType'&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.3pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>You saw this in
the previous example. It finds all the <span style='font-size:10.0pt;
line-height:107%;font-family:"Liberation Mono"'>atom:entry </span>elements.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>find() </span>method
takes an ElementTree query and returns the first matching element.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
48.1pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>There are no elements in this entry named <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>foo</span>, so this returns <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>None</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:88.85pt;margin-bottom:
41.25pt;margin-left:75.95pt;text-indent:-29.3pt'><span style='font-size:24.0pt;
line-height:154%;font-family:"Calibri",sans-serif'>&#9758; </span>There is a
“gotcha” with the <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>find() </span>method that will eventually bite you. In a
boolean context, ElementTree element objects will evaluate to <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>False </span>if
they contain no children (<i>i.e. </i>if <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>len(element) </span>is 0). This
means that <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>if
element.find('...') </span>is not testing whether the <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>find() </span>method
found a matching element; it’s testing whether that matching element has any
child elements! To test whether the <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>find() </span>method returned an element,
use <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>if
element.find('...') is not None</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>There <i>is </i>a way to search for <i>descendant </i>elements,
<i>i.e. </i>children, grandchildren, and any element at any nesting level.<br
clear=all style='page-break-before:always'>
</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>all_links
= tree.findall('//{http://www.w3.org/2005/Atom}link') </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>all_links</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>[&lt;Element
{http://www.w3.org/2005/Atom}link at e181b0&gt;,</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:182.45pt;margin-bottom:
4.1pt;margin-left:44.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>&lt;Element
{http://www.w3.org/2005/Atom}link at e2b570&gt;, &lt;Element
{http://www.w3.org/2005/Atom}link at e2b480&gt;, &lt;Element
{http://www.w3.org/2005/Atom}link at e2b5a0&gt;]</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>all_links[0].attrib                                              </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>{'href': 'http://diveintomark.org/',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'type': 'text/html',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.6pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'rel': 'alternate'}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>all_links[1].attrib                                              </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>{'href':
'http://diveintomark.org/archives/2009/03/27/dive-into-history-2009-edition',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:398.45pt;margin-bottom:
0in;margin-left:44.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>'type': 'text/html', 'rel':
'alternate'}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>all_links[2].attrib</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>{'href':
'http://diveintomark.org/archives/2009/03/21/accessibility-is-a-harsh-mistress',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:398.45pt;margin-bottom:
0in;margin-left:44.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>'type': 'text/html', 'rel':
'alternate'}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>all_links[3].attrib</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>{'href':
'http://diveintomark.org/archives/2008/12/18/give-part-1-container-formats',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'type': 'text/html',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:32.25pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'rel': 'alternate'}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>This query — <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>//{http://www.w3.org/2005/Atom}link </span>— is very similar
to the previous examples, except for the two slashes at the beginning of the
query. Those two slashes mean “don’t just look for direct children; I want <i>any
</i>elements, regardless of nesting level.” So the result is a list of four <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>link </span>elements,
not just one.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The first result <i>is </i>a direct child of the root element. As you
can see from its attributes, this is the feed-level alternate link that points
to the <span style='font-size:9.5pt;line-height:154%'>HTML </span>version of
the website that the feed describes.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.9pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The other three results are each entry-level alternate links. Each <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>entry </span>has
a single <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>link
</span>child element, and because of the double slash at the beginning of the
query, this query finds all of them.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
45.6pt;margin-left:16.4pt'>Overall, ElementTree’s <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>findall() </span>method is a
very powerful feature, but the query language can be a bit surprising. It is
officially described as “<a href="http://effbot.org/zone/element-xpath.htm"><span
style='color:black'>limited</span></a><u> </u><a
href="http://effbot.org/zone/element-xpath.htm"><span style='color:black'>support</span></a><u>
</u><a href="http://effbot.org/zone/element-xpath.htm"><span style='color:black'>for</span></a><u>
</u><a href="http://effbot.org/zone/element-xpath.htm"><span style='color:black'>XPath</span></a><u>
</u><a href="http://effbot.org/zone/element-xpath.htm"><span style='color:black'>expressions</span></a>.”
<a href="http://www.w3.org/TR/xpath"><span style='color:black'>XPath</span></a><u>
</u>is a W3C standard for querying <span style='font-size:9.5pt;line-height:
154%'>XML </span>documents. ElementTree’s query language is similar enough to
XPath to do basic searching, but dissimilar enough that it may annoy you if you
already know XPath. Now let’s look at a third-party <span style='font-size:
9.5pt;line-height:154%'>XML </span>library that extends the ElementTree <span
style='font-size:9.5pt;line-height:154%'>API </span>with full XPath support.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:33.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h4 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>12.6.
G</span>OING <span style='font-size:18.0pt;line-height:112%'>F</span>URTHER <span
style='font-size:18.0pt;line-height:112%'>W</span>ITH LXML</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
22.95pt;margin-left:16.4pt'><a href="http://codespeak.net/lxml/"><span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono";
color:black'>lxml</span></a><u><span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'> </span></u>is an open source third-party
library that builds on the popular <a href="http://www.xmlsoft.org/"><span
style='color:black'>libxml2</span></a><u> </u><a href="http://www.xmlsoft.org/"><span
style='color:black'>parser</span></a>. It provides a 100% compatible
ElementTree <span style='font-size:9.5pt;line-height:154%'>API</span>, then
extends it with full XPath 1.0 support and a few other niceties. There are <a
href="http://pypi.python.org/pypi/lxml/"><span style='color:black'>installers</span></a><u>
</u><a href="http://pypi.python.org/pypi/lxml/"><span style='color:black'>available</span></a><u>
</u><a href="http://pypi.python.org/pypi/lxml/"><span style='color:black'>for</span></a><u>
</u><a href="http://pypi.python.org/pypi/lxml/"><span style='color:black'>Windows</span></a>;
Linux users should always try to use distribution-specific tools like <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>yum </span>or
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>apt-get
</span>to install precompiled binaries from their repositories. Otherwise
you’ll need to <a href="http://codespeak.net/lxml/installation.html"><span
style='color:black'>install</span></a><u> </u><a
href="http://codespeak.net/lxml/installation.html"><span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono";color:black'>lxml </span></a><a
href="http://codespeak.net/lxml/installation.html"><span style='color:black'>manually</span></a>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.85pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>from lxml import etree                   </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.8pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>tree =
etree.parse('examples/feed.xml') </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.9pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>root = tree.getroot()                    </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>root.findall('{http://www.w3.org/2005/Atom}entry')
</span><span style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>[&lt;Element
{http://www.w3.org/2005/Atom}entry at e2b4e0&gt;,</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;Element
{http://www.w3.org/2005/Atom}entry at e2b510&gt;,</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.35pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;Element
{http://www.w3.org/2005/Atom}entry at e2b540&gt;]</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.7pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Once imported, <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>lxml </span>provides
the same <span style='font-size:9.5pt;line-height:107%'>API </span>as the
built-in ElementTree library.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.95pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>parse()
</span>function: same as ElementTree.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.85pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>getroot()
</span>method: also the same.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.7pt;margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span><span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>findall()
</span>method: exactly the same.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>For large <span style='font-size:9.5pt;line-height:
154%'>XML </span>documents, <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>lxml </span>is significantly faster than the
built-in ElementTree library. If you’re only using the ElementTree <span
style='font-size:9.5pt;line-height:154%'>API </span>and want to use the fastest
available implementation, you can try to import <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>lxml </span>and fall back to
the built-in ElementTree.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>try:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:368.45pt;margin-bottom:
0in;margin-left:37.4pt;text-indent:24.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>from
lxml import etree except ImportError:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.55pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>import xml.etree.ElementTree as etree</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
23.1pt;margin-left:16.4pt'>But <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>lxml </span>is more than just a faster
ElementTree. Its <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>findall() </span>method includes support for more
complicated expressions.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>import lxml.etree                                                           </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>tree =
lxml.etree.parse('examples/feed.xml')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>tree.findall('//{http://www.w3.org/2005/Atom}*[@href]')                     </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>[&lt;Element
{http://www.w3.org/2005/Atom}link at eeb8a0&gt;,</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:182.45pt;margin-bottom:
0in;margin-left:44.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>&lt;Element
{http://www.w3.org/2005/Atom}link at eeb990&gt;, &lt;Element
{http://www.w3.org/2005/Atom}link at eeb960&gt;,</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;Element
{http://www.w3.org/2005/Atom}link at eeb9c0&gt;]</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>tree.findall(&quot;//{http://www.w3.org/2005/Atom}*[@href='http://diveintomark.org/']&quot;)
</span><span style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>[&lt;Element
{http://www.w3.org/2005/Atom}link at eeb930&gt;]</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>NS =
'{http://www.w3.org/2005/Atom}'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>tree.findall('//{NS}author[{NS}uri]'.format(NS=NS))                         </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>[&lt;Element
{http://www.w3.org/2005/Atom}author at eeba80&gt;,</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:32.3pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;Element
{http://www.w3.org/2005/Atom}author at eebba0&gt;]</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>In this example, I’m going to <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>import lxml.etree </span>(instead of, say, <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>from
lxml import etree</span>), to emphasize that these features are specific to <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>lxml</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>This query finds all elements in the Atom namespace, anywhere in the
document, that have an <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>href </span>attribute. The <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>// </span>at
the beginning of the query means “elements anywhere (not just as children of
the root element).” <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>{http://www.w3.org/2005/Atom} </span>means “only elements in
the Atom namespace.” <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>* </span>means</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
7.15pt;margin-left:16.4pt;line-height:107%'>“elements with any local name.” And
<span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>[@href]
</span>means “has an <span style='font-size:10.0pt;line-height:107%;font-family:
"Liberation Mono"'>href </span>attribute.”</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
5.95pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The query finds
all Atom elements with an <span style='font-size:10.0pt;line-height:107%;
font-family:"Liberation Mono"'>href </span>whose value is <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>http://diveintomark.org/</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>After doing some quick <u>string formatting </u>(because otherwise these
compound queries get ridiculously long), this query searches for Atom <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>author </span>elements
that have an Atom <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>uri </span>element as a child. This only returns two <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>author </span>elements,
the ones in the first and second <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>entry</span>. The <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>author </span>in the
last <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>entry
</span>contains only a <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>name</span>, not a <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>uri</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
18.9pt;margin-left:16.4pt'>Not enough for you? <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>lxml </span>also integrates
support for arbitrary XPath 1.0 expressions. I’m not going to go into depth
about XPath syntax; that could be a whole book unto itself! But I will show you
how it integrates into <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>lxml</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>import
lxml.etree</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>tree =
lxml.etree.parse('examples/feed.xml')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.9pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>NSMAP = {'atom':
'http://www.w3.org/2005/Atom'}                    </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>entries
= tree.xpath(&quot;//atom:category[@term='accessibility']/..&quot;, </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.4pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>...     </span><span style='font-size:10.0pt;line-height:110%;
font-family:"Liberation Mono"'>namespaces=NSMAP)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>entries                                                            </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>[&lt;Element
{http://www.w3.org/2005/Atom}entry at e2b630&gt;]</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>entry =
entries[0]</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>entry.xpath('./atom:title/text()',
namespaces=NSMAP)               </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>['Accessibility is a harsh mistress']</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>To perform XPath queries on namespaced elements, you need to define a
namespace prefix mapping. This is just a Python dictionary.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Here is an XPath query. The XPath expression searches for <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>category
</span>elements (in the Atom namespace) that contain a <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>term </span>attribute
with the value <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>accessibility</span>.
But that’s not actually the query result. Look at the very end of the query
string; did you notice the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>/.. </span>bit? That means “and then return the
parent element of the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>category </span>element you just found.” So this
single XPath query will find all entries with a child element of <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>&lt;category
term='accessibility'&gt;</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
1.5pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>xpath()
</span>function returns a list of ElementTree objects. In this document, there
is only one entry with a <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>category </span>whose <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>term </span>is <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>accessibility</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
45.65pt;margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>XPath expressions don’t always return a list of elements. Technically,
the <span style='font-size:9.5pt;line-height:154%'>DOM </span>of a parsed <span
style='font-size:9.5pt;line-height:154%'>XML </span>document doesn’t contain
elements; it contains <i>nodes</i>. Depending on their type, nodes can be
elements, attributes, or even text content. The result of an XPath query is a
list of nodes. This query returns a list of text nodes: the text content (<span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>text()</span>)
of the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>title
</span>element (<span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>atom:title</span>) that is a child of the current element (<span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>./</span>).</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:33.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h4 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>12.7.
G</span>ENERATING <span style='font-size:18.0pt;line-height:112%'>XML</span></h4>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.05pt;margin-left:16.4pt'>Python’s support for <span style='font-size:9.5pt;
line-height:154%'>XML </span>is not limited to parsing existing documents. You
can also create <span style='font-size:9.5pt;line-height:154%'>XML </span>documents
from scratch.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>import
xml.etree.ElementTree as etree</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.9pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>new_feed =
etree.Element('{http://www.w3.org/2005/Atom}feed',     </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.85pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>...      </span><span style='font-size:10.0pt;line-height:110%;
font-family:"Liberation Mono"'>attrib={'{http://www.w3.org/XML/1998/namespace}lang':
'en'}) </span><span style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>print(etree.tostring(new_feed))                                   </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.3pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;ns0:feed
xmlns:ns0='http://www.w3.org/2005/Atom' xml:lang='en'/&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>To create a new element, instantiate the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>Element </span>class. You pass
the element name (namespace + local name) as the first argument. This statement
creates a <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>feed
</span>element in the Atom namespace. This will be our new document’s root
element.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
2.35pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>To add attributes to the newly created element, pass a dictionary of
attribute names and values in the <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>attrib </span>argument. Note that the
attribute name should be in the standard ElementTree format,</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.95pt;
margin-left:17.15pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>{namespace}localname</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.3in;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>At any time, you can serialize any element (and its children) with the
ElementTree <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>tostring()
</span>function.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.8pt;margin-left:16.4pt'>Was that serialization surprising to you? The way
ElementTree serializes namespaced <span style='font-size:9.5pt;line-height:
154%'>XML </span>elements is technically accurate but not optimal. The sample <span
style='font-size:9.5pt;line-height:154%'>XML </span>document at the beginning
of this chapter defined a <i>default namespace </i>(<span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>xmlns='http://www.w3.org/2005/Atom'</span>).
Defining a default namespace is useful for documents — like Atom feeds — where
every element is in the same namespace, because you can declare the namespace
once and declare each element with just its local name (<span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>&lt;feed&gt;</span>, <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>&lt;link&gt;</span>,
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>&lt;entry&gt;</span>).
There is no need to use any prefixes unless you want to declare elements from
another namespace.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.05pt;margin-left:16.4pt'>An <span style='font-size:9.5pt;line-height:154%'>XML
</span>parser won’t “see” any difference between an <span style='font-size:
9.5pt;line-height:154%'>XML </span>document with a default namespace and an <span
style='font-size:9.5pt;line-height:154%'>XML </span>document with a prefixed
namespace. The resulting <span style='font-size:9.5pt;line-height:154%'>DOM </span>of
this serialization:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:163.2pt;margin-bottom:
0in;margin-left:16.65pt;text-indent:21.55pt;line-height:312%'><span
style='font-size:10.0pt;line-height:312%;font-family:"Liberation Mono"'>&lt;ns0:feed
xmlns:ns0='http://www.w3.org/2005/Atom' xml:lang='en'/&gt; </span>is identical
to the <span style='font-size:9.5pt;line-height:312%'>DOM </span>of this
serialization:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;feed
xmlns='http://www.w3.org/2005/Atom' xml:lang='en'/&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.55pt;margin-left:16.4pt'>The only practical difference is that the second
serialization is several characters shorter. If we were to recast our entire
sample feed with a <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>ns0: </span>prefix in every start and end tag, it would add
4 characters per start tag × 79 tags + 4 characters for the namespace
declaration itself, for a total of 320 characters. Assuming <u>UTF-8 encoding</u>,
that’s 320 extra bytes. (After gzipping, the difference drops to 21 bytes, but
still, 21 bytes is 21 bytes.) Maybe that doesn’t matter to you, but for
something like an Atom feed, which may be downloaded several thousand times
whenever it changes, saving a few bytes per request can quickly add up.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.0pt;margin-left:16.4pt'>The built-in ElementTree library does not offer this
fine-grained control over serializing namespaced elements, but <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>lxml </span>does.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>import
lxml.etree</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.9pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>NSMAP = {None:
'http://www.w3.org/2005/Atom'}                     </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.85pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>new_feed = lxml.etree.Element('feed',
nsmap=NSMAP)                </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>print(lxml.etree.tounicode(new_feed))                             </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;feed
xmlns='http://www.w3.org/2005/Atom'/&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>new_feed.set('{http://www.w3.org/XML/1998/namespace}lang',
'en') </span><span style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>print(lxml.etree.tounicode(new_feed))</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;feed
xmlns='http://www.w3.org/2005/Atom' xml:lang='en'/&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>To start, define a namespace mapping as a dictionary. Dictionary values
are namespaces; dictionary keys are the desired prefix. Using <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>None </span>as
a prefix effectively declares a default namespace.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Now you can pass the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>lxml</span>-specific <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>nsmap </span>argument
when you create an element, and <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>lxml </span>will respect the namespace prefixes
you’ve defined.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>As expected, this serialization defines the Atom namespace as the
default namespace and declares the <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>feed </span>element without a namespace
prefix.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.65pt;margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Oops, we forgot to add the <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>xml:lang </span>attribute. You can always
add attributes to any element with the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>set() </span>method. It takes
two arguments: the attribute name in standard ElementTree format, then the
attribute value. (This method is not <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>lxml</span>-specific. The only <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>lxml</span>-specific
part of this example was the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>nsmap </span>argument to control the namespace
prefixes in the serialized output.)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>Are <span style='font-size:9.5pt;line-height:154%'>XML
</span>documents limited to one element per document? No, of course not. You
can easily create child elements, too.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=510
 style='width:382.8pt;margin-left:38.15pt;border-collapse:collapse'>
 <tr style='height:18.3pt'>
  <td width=496 valign=top style='width:372.05pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono";
  color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
  107%;font-family:"Liberation Mono"'>title = lxml.etree.SubElement(new_feed,
  'title',</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9312;</span></p>
  </td>
 </tr>
 <tr style='height:22.5pt'>
  <td width=496 valign=top style='width:372.05pt;padding:0in 0in 0in 0in;
  height:22.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono";
  color:#666677'>...     </span><span style='font-size:10.0pt;line-height:107%;
  font-family:"Liberation Mono"'>attrib={'type':'html'})</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:22.5pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9313;</span></p>
  </td>
 </tr>
 <tr style='height:18.3pt'>
  <td width=496 valign=bottom style='width:372.05pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono";
  color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
  107%;font-family:"Liberation Mono"'>print(lxml.etree.tounicode(new_feed))</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9314;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;feed
xmlns='http://www.w3.org/2005/Atom' xml:lang='en'&gt;&lt;title
type='html'/&gt;&lt;/feed&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.85pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>title.text = 'dive into &amp;hellip;'                         </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>print(lxml.etree.tounicode(new_feed))                     </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9316;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;feed
xmlns='http://www.w3.org/2005/Atom' xml:lang='en'&gt;&lt;title
type='html'&gt;dive into &amp;amp;hell</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>print(lxml.etree.tounicode(new_feed,
pretty_print=True)) </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9317;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:188.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>&lt;feed
xmlns='http://www.w3.org/2005/Atom' xml:lang='en'&gt; &lt;title
type='html'&gt;dive into&amp;amp;hellip;&lt;/title&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.4pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;/feed&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>To create a child element of an existing element, instantiate the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>SubElement
</span>class. The only required arguments are the parent element (<span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>new_feed
</span>in this case) and the new element’s name. Since this child element will
inherit the namespace mapping of its parent, there is no need to redeclare the
namespace or prefix here.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.15pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>You can also
pass in an attribute dictionary. Keys are attribute names; values are attribute
values.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>As expected, the new <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>title </span>element was created in the Atom
namespace, and it was inserted as a child of the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>feed </span>element. Since the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>title </span>element
has no text content and no children of its own, <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>lxml </span>serializes it as an
empty element (with the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>/&gt; </span>shortcut).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.2pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>To set the text
content of an element, simply set its <span style='font-size:10.0pt;line-height:
107%;font-family:"Liberation Mono"'>.text </span>property.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Now the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>title
</span>element is serialized with its text content. Any text content that
contains less-than signs or ampersands needs to be escaped when serialized. <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>lxml </span>handles
this escaping automatically.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
46.9pt;margin-left:16.65pt;text-indent:-16.65pt'>6.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>You can also apply “pretty printing” to the serialization, which inserts
line breaks after end tags, and after start tags of elements that contain child
elements but no text content. In technical terms, <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>lxml </span>adds “insignificant
whitespace” to make the output more readable.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:47.15pt;line-height:107%'><span style='font-size:24.0pt;
line-height:107%;font-family:"Calibri",sans-serif'>&#9758; </span>You might
also want to check out <a href="http://github.com/galvez/xmlwitch/tree/master"><span
style='color:black'>xmlwitch</span></a>, another third-party library for
generating</p>

<p class=MsoNormal style='margin-top:0in;margin-right:80.25pt;margin-bottom:
45.65pt;margin-left:76.4pt'><span style='font-size:9.5pt;line-height:154%'>XML</span>.
It makes extensive use of <u>the </u><u><span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>with </span>statement </u>to
make <span style='font-size:9.5pt;line-height:154%'>XML </span>generation code
more readable.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:33.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h4 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>12.8.
P</span>ARSING <span style='font-size:18.0pt;line-height:112%'>B</span>ROKEN <span
style='font-size:18.0pt;line-height:112%'>XML</span></h4>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.5pt;margin-left:16.4pt'>The <span style='font-size:9.5pt;line-height:154%'>XML
</span>specification mandates that all conforming <span style='font-size:9.5pt;
line-height:154%'>XML </span>parsers employ “draconian error handling.” That
is, they must halt and catch fire as soon as they detect any sort of
wellformedness error in the <span style='font-size:9.5pt;line-height:154%'>XML </span>document.
Wellformedness errors include mismatched start and end tags, undefined
entities, illegal Unicode characters, and a number of other esoteric rules.
This is in stark contrast to other common formats like <span style='font-size:
9.5pt;line-height:154%'>HTML </span>— your browser doesn’t stop rendering a web
page if you forget to close an <span style='font-size:9.5pt;line-height:154%'>HTML
</span>tag or escape an ampersand in an attribute value. (It is a common
misconception that <span style='font-size:9.5pt;line-height:154%'>HTML </span>has
no defined error handling. <a
href="http://www.whatwg.org/specs/web-apps/current-work/multipage/syntax.html#parsing"><span
style='font-size:9.5pt;line-height:154%;color:black'>HTML</span></a><u><span
style='font-size:9.5pt;line-height:154%'> </span></u><a
href="http://www.whatwg.org/specs/web-apps/current-work/multipage/syntax.html#parsing"><span
style='color:black'>error </span></a><a
href="http://www.whatwg.org/specs/web-apps/current-work/multipage/syntax.html#parsing"><span
style='color:black'>handling</span></a><u> </u>is actually quite well-defined,
but it’s significantly more complicated than “halt and catch fire on first
error.”)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.65pt;margin-left:16.4pt'>Some people (myself included) believe that it was a
mistake for the inventors of <span style='font-size:9.5pt;line-height:154%'>XML
</span>to mandate draconian error handling. Don’t get me wrong; I can certainly
see the allure of simplifying the error handling rules. But in practice, the
concept of “wellformedness” is trickier than it sounds, especially for <span
style='font-size:9.5pt;line-height:154%'>XML </span>documents (like Atom feeds)
that are published on the web and served over <span style='font-size:9.5pt;
line-height:154%'>HTTP</span>. Despite the maturity of <span style='font-size:
9.5pt;line-height:154%'>XML</span>, which standardized on draconian error
handling in 1997, surveys continually show a significant fraction of Atom feeds
on the web are plagued with wellformedness errors.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.75pt;margin-left:16.4pt'>So, I have both theoretical and practical reasons
to parse <span style='font-size:9.5pt;line-height:154%'>XML </span>documents
“at any cost,” that is, <i>not </i>to halt and catch fire at the first
wellformedness error. If you find yourself wanting to do this too, <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>lxml </span>can
help.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.95pt;margin-left:16.4pt'>Here is a fragment of a broken <span
style='font-size:9.5pt;line-height:154%'>XML </span>document. I’ve highlighted
the wellformedness error.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:224.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>&lt;?xml version='1.0'
encoding='utf-8'?&gt; &lt;feed xmlns='http://www.w3.org/2005/Atom'
xml:lang='en'&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:332.45pt;margin-bottom:
0in;margin-left:37.4pt;text-indent:12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>&lt;title&gt;dive
into <b><span style='background:gainsboro'>&amp;hellip;</span></b>&lt;/title&gt;
...</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.6pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;/feed&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>That’s an error, because the <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>&amp;hellip; </span>entity
is not defined in <span style='font-size:9.5pt;line-height:154%'>XML</span>.
(It is defined in <span style='font-size:9.5pt;line-height:154%'>HTML</span>.)
If you try to parse this broken feed with the default settings, <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>lxml </span>will
choke on the undefined entity.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>import
lxml.etree</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:176.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>tree =
lxml.etree.parse('examples/feed-broken.xml') </span><span style='font-size:
10.0pt;line-height:185%;font-family:"Liberation Mono";color:#880000'>Traceback
(most recent call last):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>File
&quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.5pt;
margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#880000'>File
&quot;lxml.etree.pyx&quot;, line 2693, in lxml.etree.parse
(src/lxml/lxml.etree.c:52591)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.5pt;
margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#880000'>File &quot;parser.pxi&quot;,
line 1478, in lxml.etree._parseDocument (src/lxml/lxml.etree.c:75665)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-3.55pt;margin-bottom:
0in;margin-left:50.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#880000'>File
&quot;parser.pxi&quot;, line 1507, in lxml.etree._parseDocumentFromURL
(src/lxml/lxml.etree.c:759 File &quot;parser.pxi&quot;, line 1407, in
lxml.etree._parseDocFromFile (src/lxml/lxml.etree.c:75002)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-3.55pt;margin-bottom:
8.5pt;margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>File
&quot;parser.pxi&quot;, line 965, in lxml.etree._BaseParser._parseDocFromFile
(src/lxml/lxml.etre</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-3.55pt;margin-bottom:
8.5pt;margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>File
&quot;parser.pxi&quot;, line 539, in
lxml.etree._ParserContext._handleParseResultDoc (src/lxml/lx</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.5pt;
margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#880000'>File &quot;parser.pxi&quot;,
line 625, in lxml.etree._handleParseResult (src/lxml/lxml.etree.c:68877)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:22.75pt;
margin-left:37.4pt;text-indent:12.0pt;line-height:185%'><span style='font-size:
10.0pt;line-height:185%;font-family:"Liberation Mono";color:#880000'>File
&quot;parser.pxi&quot;, line 565, in lxml.etree._raiseParseError
(src/lxml/lxml.etree.c:68125) lxml.etree.XMLSyntaxError: Entity 'hellip' not
defined, line 3, column 28</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
23.1pt;margin-left:16.4pt'>To parse this broken <span style='font-size:9.5pt;
line-height:154%'>XML </span>document, despite its wellformedness error, you
need to create a custom <span style='font-size:9.5pt;line-height:154%'>XML </span>parser.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.9pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>parser = lxml.etree.XMLParser(recover=True)                  </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.75pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>tree =
lxml.etree.parse('examples/feed-broken.xml', parser) </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>parser.error_log                                             </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>examples/feed-broken.xml:3:28:FATAL:PARSER:ERR_UNDECLARED_ENTITY:
Entity 'hellip' not defined</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>tree.findall('{http://www.w3.org/2005/Atom}title')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>[&lt;Element
{http://www.w3.org/2005/Atom}title at ead510&gt;]</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.5pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>title =
tree.findall('{http://www.w3.org/2005/Atom}title')[0]</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>title.text                                                   </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'dive into '</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>print(lxml.etree.tounicode(tree.getroot()))                  </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9316;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;feed
xmlns='http://www.w3.org/2005/Atom' xml:lang='en'&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:290.45pt;margin-bottom:
8.25pt;margin-left:37.4pt;text-indent:12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>&lt;title&gt;dive
into &lt;/title&gt; . . [rest of serialization snipped for brevity] .</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>To create a custom parser, instantiate the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>lxml.etree.XMLParser </span>class.
It can take <a href="http://codespeak.net/lxml/parsing.html#parser-options"><span
style='color:black'>a</span></a><u> </u><a
href="http://codespeak.net/lxml/parsing.html#parser-options"><span
style='color:black'>number</span></a><u> </u><a
href="http://codespeak.net/lxml/parsing.html#parser-options"><span
style='color:black'>of</span></a><u> </u><a
href="http://codespeak.net/lxml/parsing.html#parser-options"><span
style='color:black'>different </span></a><a
href="http://codespeak.net/lxml/parsing.html#parser-options"><span
style='color:black'>named</span></a><u> </u><a
href="http://codespeak.net/lxml/parsing.html#parser-options"><span
style='color:black'>arguments</span></a>. The one we’re interested in here is
the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>recover
</span>argument. When set to <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>True</span>, the <span style='font-size:9.5pt;
line-height:154%'>XML </span>parser will try its best to “recover” from
wellformedness errors.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>To parse an <span style='font-size:9.5pt;line-height:154%'>XML </span>document
with your custom parser, pass the <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>parser </span>object as the second argument
to the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>parse()
</span>function. Note that <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>lxml </span>does not raise an exception about
the undefined <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>&amp;hellip;
</span>entity.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The parser keeps a log of the wellformedness errors that it has
encountered. (This is actually true regardless of whether it is set to recover
from those errors or not.)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Since it didn’t know what to do with the undefined <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>&amp;hellip;
</span>entity, the parser just silently dropped it. The text content of the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>title </span>element
becomes <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>'dive
into '</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.3in;margin-left:16.65pt;text-indent:-16.65pt'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>As you can see from the serialization, the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>&amp;hellip; </span>entity
didn’t get moved; it was simply dropped.</p>

<p class=MsoNormal align=right style='margin-top:0in;margin-right:32.55pt;
margin-bottom:6.15pt;margin-left:.5pt;text-align:right;line-height:110%'>It is
important to reiterate that there is <b>no guarantee of interoperability </b>with
“recovering” <span style='font-size:9.5pt;line-height:110%'>XML </span>parsers.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.5pt;margin-left:16.4pt;line-height:107%'>A different parser might decide that
it recognized the <span style='font-size:10.0pt;line-height:107%;font-family:
"Liberation Mono"'>&amp;hellip; </span>entity from <span style='font-size:9.5pt;
line-height:107%'>HTML</span>, and replace it with</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
45.65pt;margin-left:16.4pt'><span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>&amp;amp;hellip; </span>instead. Is that
“better”? Maybe. Is it “more correct”? No, they are both equally incorrect. The
correct behavior (according to the <span style='font-size:9.5pt;line-height:
154%'>XML </span>specification) is to halt and catch fire. If you’ve decided
not to do that, you’re on your own.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:33.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h4 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>12.9.
F</span>URTHER <span style='font-size:18.0pt;line-height:112%'>R</span>EADING</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://en.wikipedia.org/wiki/XML"><span style='font-size:9.5pt;
line-height:110%;color:black'>XML</span></a><u><span style='font-size:9.5pt;
line-height:110%'> </span></u><a href="http://en.wikipedia.org/wiki/XML"><span
style='color:black'>on</span></a><u> </u><a
href="http://en.wikipedia.org/wiki/XML"><span style='color:black'>Wikipedia.org</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://docs.python.org/3.1/library/xml.etree.elementtree.html"><span
style='color:black'>The</span></a><u> </u><a
href="http://docs.python.org/3.1/library/xml.etree.elementtree.html"><span
style='color:black'>ElementTree</span></a><u> </u><a
href="http://docs.python.org/3.1/library/xml.etree.elementtree.html"><span
style='font-size:9.5pt;line-height:110%;color:black'>XML</span></a><u><span
style='font-size:9.5pt;line-height:110%'> </span></u><a
href="http://docs.python.org/3.1/library/xml.etree.elementtree.html"><span
style='color:black'>API</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://effbot.org/zone/element.htm"><span style='color:black'>Elements</span></a><u>
</u><a href="http://effbot.org/zone/element.htm"><span style='color:black'>and</span></a><u>
</u><a href="http://effbot.org/zone/element.htm"><span style='color:black'>Element</span></a><u>
</u><a href="http://effbot.org/zone/element.htm"><span style='color:black'>Trees</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://effbot.org/zone/element-xpath.htm"><span style='color:black'>XPath</span></a><u>
</u><a href="http://effbot.org/zone/element-xpath.htm"><span style='color:black'>Support</span></a><u>
</u><a href="http://effbot.org/zone/element-xpath.htm"><span style='color:black'>in</span></a><u>
</u><a href="http://effbot.org/zone/element-xpath.htm"><span style='color:black'>ElementTree</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.1pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://effbot.org/zone/element-iterparse.htm"><span style='color:black'>The</span></a><u>
</u><a href="http://effbot.org/zone/element-iterparse.htm"><span
style='color:black'>ElementTree</span></a><u> </u><a
href="http://effbot.org/zone/element-iterparse.htm"><span style='color:black'>iterparse</span></a><u>
</u><a href="http://effbot.org/zone/element-iterparse.htm"><span
style='color:black'>Function</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.55pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://codespeak.net/lxml/"><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:black'>lxml</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://codespeak.net/lxml/1.3/parsing.html"><span style='color:black'>Parsing</span></a><u>
</u><a href="http://codespeak.net/lxml/1.3/parsing.html"><span
style='font-size:9.5pt;line-height:110%;color:black'>XML</span></a><u><span
style='font-size:9.5pt;line-height:110%'> </span></u><a
href="http://codespeak.net/lxml/1.3/parsing.html"><span style='color:black'>and</span></a><u>
</u><a href="http://codespeak.net/lxml/1.3/parsing.html"><span
style='font-size:9.5pt;line-height:110%;color:black'>HTML</span></a><u><span
style='font-size:9.5pt;line-height:110%'> </span></u><a
href="http://codespeak.net/lxml/1.3/parsing.html"><span style='color:black'>with</span></a><u>
</u><a href="http://codespeak.net/lxml/1.3/parsing.html"><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:black'>lxml</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://codespeak.net/lxml/1.3/xpathxslt.html"><span style='color:black'>XPath</span></a><u>
</u><a href="http://codespeak.net/lxml/1.3/xpathxslt.html"><span
style='color:black'>and</span></a><u> </u><a
href="http://codespeak.net/lxml/1.3/xpathxslt.html"><span style='font-size:
9.5pt;line-height:110%;color:black'>XSLT</span></a><u><span style='font-size:
9.5pt;line-height:110%'> </span></u><a
href="http://codespeak.net/lxml/1.3/xpathxslt.html"><span style='color:black'>with</span></a><u>
</u><a href="http://codespeak.net/lxml/1.3/xpathxslt.html"><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:black'>lxml</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://github.com/galvez/xmlwitch/tree/master"><span style='color:black'>xmlwitch</span></a></p>

<h3 style='margin-top:0in;margin-right:22.2pt;margin-bottom:0in;margin-left:
16.4pt;line-height:107%'><span style='font-size:24.0pt;line-height:107%'>C</span><span
style='font-size:19.0pt;line-height:107%'>HAPTER </span><span style='font-size:
24.0pt;line-height:107%'>13. S</span><span style='font-size:19.0pt;line-height:
107%'>ERIALIZING </span><span style='font-size:24.0pt;line-height:107%'>P</span><span
style='font-size:19.0pt;line-height:107%'>YTHON </span><span style='font-size:
24.0pt;line-height:107%'>O</span><span style='font-size:19.0pt;line-height:
107%'>BJECTS</span></h3>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:39.9pt;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=736 height=4 id="Group 705933"
src="Dive%20Into%20Python%203_files/image001.gif"></span></p>

<p class=MsoNormal align=right style='margin-top:0in;margin-right:29.3pt;
margin-bottom:.1pt;margin-left:16.6pt;text-align:right;line-height:160%'><span
style='font-size:13.0pt;line-height:160%;font-family:"Calibri",sans-serif'>&#10077;
</span><i>Every Saturday since we’ve lived in this apartment, I have awakened
at 6:15, poured myself a bowl of cereal, added</i></p>

<p class=MsoNormal align=right style='margin-top:0in;margin-right:29.3pt;
margin-bottom:65.45pt;margin-left:32.95pt;text-align:right;line-height:160%'><i>a
quarter-cup of 2% milk, sat on <b>this </b>end of <b>this </b>couch, turned on
BBC America, and watched Doctor Who. </i><span style='font-size:13.0pt;
line-height:160%;font-family:"Calibri",sans-serif'>&#10078; </span><i>—
Sheldon, </i><a
href="http://en.wikiquote.org/wiki/The_Big_Bang_Theory#The_Dumpling_Paradox_.5B1.07.5D"><i><span
style='color:black'>The</span></i></a><i><u> </u></i><a
href="http://en.wikiquote.org/wiki/The_Big_Bang_Theory#The_Dumpling_Paradox_.5B1.07.5D"><i><span
style='color:black'>Big</span></i></a><i><u> </u></i><a
href="http://en.wikiquote.org/wiki/The_Big_Bang_Theory#The_Dumpling_Paradox_.5B1.07.5D"><i><span
style='color:black'>Bang</span></i></a><i><u> </u></i><a
href="http://en.wikiquote.org/wiki/The_Big_Bang_Theory#The_Dumpling_Paradox_.5B1.07.5D"><i><span
style='color:black'>Theory</span></i></a></p>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:66.1pt;margin-left:
16.4pt;line-height:110%'><span style='font-size:18.0pt;line-height:110%'>13.1.
D</span>IVING <span style='font-size:18.0pt;line-height:110%'>I</span>N</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
1.85pt;margin-left:16.4pt'><span style='font-size:48.0pt;line-height:154%;
font-family:"DejaVu Serif",serif;color:#888888'>O </span>n the surface, the
concept of serialization is simple. You have a data structure in memory that
you want to save, reuse, or send to someone else. How would you do that? Well,
that depends on how you want to save it, how you want to reuse it, and to whom you
want to send it. Many games allow you to save your progress when you quit the
game and pick up where you left off when you relaunch the game.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.8pt;margin-left:16.4pt'>(Actually, many non-gaming applications do this as
well.) In this case, a data structure that captures “your progress so far”
needs to be stored on disk when you quit, then loaded from disk when you
relaunch. The data is only meant to be used by the same program that created
it, never sent over a network, and never read by anything other than the
program that created it. Therefore, the interoperability issues are limited to
ensuring that later versions of the program can read data written by earlier
versions.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.2pt;margin-left:16.4pt'>For cases like this, the <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>pickle </span>module is
ideal. It’s part of the Python standard library, so it’s always available. It’s
fast; the bulk of it is written in C, like the Python interpreter itself. It
can store arbitrarily complex Python data structures.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.45pt;margin-left:16.4pt'>What can the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>pickle </span>module store?</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-12.25pt'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>All the <u>native datatypes </u>that Python supports: booleans,
integers, floating point numbers, complex numbers, strings, <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>bytes </span>objects,
byte arrays, and <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>None</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-12.25pt;line-height:107%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Lists, tuples,
dictionaries, and sets containing any combination of native datatypes.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-12.25pt'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Lists, tuples, dictionaries, and sets containing any combination of
lists, tuples, dictionaries, and sets containing any combination of native
datatypes (and so on, to <a
href="http://docs.python.org/3.1/library/sys.html#sys.getrecursionlimit"><span
style='color:black'>the</span></a><u> </u><a
href="http://docs.python.org/3.1/library/sys.html#sys.getrecursionlimit"><span
style='color:black'>maximum</span></a><u> </u><a
href="http://docs.python.org/3.1/library/sys.html#sys.getrecursionlimit"><span
style='color:black'>nesting</span></a><u> </u><a
href="http://docs.python.org/3.1/library/sys.html#sys.getrecursionlimit"><span
style='color:black'>level</span></a><u> </u><a
href="http://docs.python.org/3.1/library/sys.html#sys.getrecursionlimit"><span
style='color:black'>that</span></a><u> </u><a
href="http://docs.python.org/3.1/library/sys.html#sys.getrecursionlimit"><span
style='color:black'>Python</span></a><u> </u><a
href="http://docs.python.org/3.1/library/sys.html#sys.getrecursionlimit"><span
style='color:black'>supports</span></a>).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.65pt;margin-left:16.65pt;text-indent:-12.25pt'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Functions, classes, and instances of classes (with caveats).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
22.15pt;margin-left:16.4pt'>If this isn’t enough for you, the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>pickle </span>module
is also extensible. If you’re interested in extensibility, check out the links
in the <u>Further Reading </u>section at the end of the chapter.</p>

<h5 style='margin-top:0in;margin-right:0in;margin-bottom:25.25pt;margin-left:
16.4pt;line-height:110%'><span style='font-size:13.0pt;line-height:110%'>13.1.1.
A Q</span><span style='font-size:10.5pt;line-height:110%'>UICK </span><span
style='font-size:13.0pt;line-height:110%'>N</span><span style='font-size:10.5pt;
line-height:110%'>OTE </span><span style='font-size:13.0pt;line-height:110%'>A</span><span
style='font-size:10.5pt;line-height:110%'>BOUT </span><span style='font-size:
13.0pt;line-height:110%'>T</span><span style='font-size:10.5pt;line-height:
110%'>HE </span><span style='font-size:13.0pt;line-height:110%'>E</span><span
style='font-size:10.5pt;line-height:110%'>XAMPLES IN </span><span
style='font-size:13.0pt;line-height:110%'>T</span><span style='font-size:10.5pt;
line-height:110%'>HIS </span><span style='font-size:13.0pt;line-height:110%'>C</span><span
style='font-size:10.5pt;line-height:110%'>HAPTER</span></h5>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.5pt;margin-left:16.4pt'>This chapter tells a tale with two Python Shells.
All of the examples in this chapter are part of a single story arc. You will be
asked to switch back and forth between the two Python Shells as I demonstrate
the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>pickle
</span>and <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>json
</span>modules.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.9pt;margin-left:16.4pt'>To help keep things straight, open the Python Shell
and define the following variable:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>shell =
1</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.9pt;margin-left:16.4pt'>Keep that window open. Now open another Python Shell
and define the following variable:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>shell =
2</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
45.5pt;margin-left:16.4pt'>Throughout this chapter, I will use the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>shell </span>variable
to indicate which Python Shell is being used in each example.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:33.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h5 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>13.2.
S</span>AVING <span style='font-size:18.0pt;line-height:112%'>D</span>ATA TO A <span
style='font-size:18.0pt;line-height:112%'>P</span>ICKLE <span style='font-size:
18.0pt;line-height:112%'>F</span>ILE</h5>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>The <span style='font-size:10.0pt;
line-height:107%;font-family:"Liberation Mono"'>pickle </span>module works with
data structures. Let’s build one.</p>

</div>

<span style='font-size:12.0pt;line-height:154%;font-family:"Gill Sans MT",sans-serif;
color:black'><br clear=all style='page-break-before:always'>
</span>

<div class=WordSection19>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.0pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>1</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>entry = {}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>entry['title']
= 'Dive into history, 2009 edition'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-3.55pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>entry['article_link']
= 'http://diveintomark.org/archives/2009/03/27/dive-into-history-200 </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
185%;font-family:"Liberation Mono"'>entry['comments_link'] = None</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>entry['internal_id']
= b'\xDE\xD5\xB4\xF8'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>entry['tags']
= ('diveintopython', 'docbook', 'html')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>entry['published']
= True</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.0pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>import
time</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>entry['published_date']
= time.strptime('Fri Mar 27 22:20:42 2009')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>entry['published_date']</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>time.struct_time(tm_year=2009, tm_mon=3,
tm_mday=27, tm_hour=22, tm_min=20, tm_sec=42, tm_wday</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Follow along in
Python Shell #1.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The idea here is to build a Python dictionary that could represent
something useful, like an <u>entry in an Atom feed</u>. But I also want to
ensure that it contains several different types of data, to show off the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>pickle </span>module.
Don’t read too much into these values.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.55pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>time
</span>module contains a data structure (<span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>time_struct</span>) to
represent a point in time (accurate to one millisecond) and functions to
manipulate time structs. The <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>strptime() </span>function takes a formatted
string an converts it to a <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>time_struct</span>. This string is in the
default format, but you can control that with format codes. See the <a
href="http://docs.python.org/3.1/library/time.html"><span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono";color:black'>time</span></a><u><span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'> </span></u><a
href="http://docs.python.org/3.1/library/time.html"><span style='color:black'>module</span></a><u>
</u>for more details.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
23.7pt;margin-left:16.4pt'>That’s a handsome-looking Python dictionary. Let’s
save it to a file.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>shell                                    </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>1</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>import
pickle</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.8pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>with open('entry.pickle', 'wb') as f:    </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>...     </span><span style='font-size:10.0pt;line-height:110%;
font-family:"Liberation Mono"'>pickle.dump(entry, f)                </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.95in;margin-bottom:
31.05pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#666677'>...</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>This is still in
Python Shell #1.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Use the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>open()
</span>function to open a file. Set the file mode to <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>'wb' </span>to open the
file for writing <u>in binary mode</u>. Wrap it in a <u><span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>with </span>statement </u>to
ensure the file is closed automatically when you’re done with it.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.55pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>dump()
</span>function in the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>pickle </span>module takes a serializable Python
data structure, serializes it into a binary, Python-specific format using the
latest version of the pickle protocol, and saves it to an open file.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.75pt;margin-left:16.4pt'>That last sentence was pretty important.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.05pt;margin-left:16.65pt;text-indent:-12.25pt;line-height:107%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>pickle </span>module
takes a Python data structure and saves it to a file.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-12.25pt;line-height:107%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>To do this, it <i>serializes
</i>the data structure using a data format called “the pickle protocol.”</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-12.25pt'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The pickle protocol is Python-specific; there is no guarantee of
cross-language compatibility. You probably couldn’t take the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>entry.pickle
</span>file you just created and do anything useful with it in Perl, <span
style='font-size:9.5pt;line-height:154%'>PHP</span>, Java, or any other
language.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-12.25pt'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Not every Python data structure can be serialized by the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>pickle </span>module.
The pickle protocol has changed several times as new data types have been added
to the Python language, but there are still limitations.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-12.25pt'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>As a result of these changes, there is no guarantee of compatibility
between different versions of Python itself. Newer versions of Python support
the older serialization formats, but older versions of Python do not support
newer formats (since they don’t support the newer data types).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-12.25pt'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Unless you specify otherwise, the functions in the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>pickle </span>module
will use the latest version of the pickle protocol. This ensures that you have
maximum flexibility in the types of data you can serialize, but it also means
that the resulting file will not be readable by older versions of Python that
do not support the latest version of the pickle protocol.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
45.7pt;margin-left:16.65pt;text-indent:-12.25pt'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The latest version of the pickle protocol is a binary format. Be sure to
open your pickle files <u>in binary mode</u>, or the data will get corrupted
during writing.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:33.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h5 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>13.3.
L</span>OADING <span style='font-size:18.0pt;line-height:112%'>D</span>ATA FROM
A <span style='font-size:18.0pt;line-height:112%'>P</span>ICKLE <span
style='font-size:18.0pt;line-height:112%'>F</span>ILE</h5>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>Now switch to your second Python
Shell — <i>i.e. </i>not the one where you created the <span style='font-size:
10.0pt;line-height:107%;font-family:"Liberation Mono"'>entry </span>dictionary.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:210.05pt;
margin-bottom:5.9pt;margin-left:239.1pt;text-align:center;line-height:107%'><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.1pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>2</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                            </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>entry                                    </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>Traceback (most
recent call last):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:278.45pt;margin-bottom:
0in;margin-left:37.4pt;text-indent:12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
color:#880000'>File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;
NameError: name 'entry' is not defined</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>import
pickle</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.8pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>with open('entry.pickle', 'rb') as f:    </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>...     </span><span style='font-size:10.0pt;line-height:110%;
font-family:"Liberation Mono"'>entry = pickle.load(f)               </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.95in;margin-bottom:
12.3pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#666677'>...</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>entry                                    </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9316;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>{'comments_link': None,</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'internal_id': b'\xDE\xD5\xB4\xF8',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:254.45pt;margin-bottom:
0in;margin-left:44.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>'title': 'Dive into history,
2009 edition', 'tags': ('diveintopython', 'docbook', 'html'), 'article_link':</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-3.55pt;margin-bottom:
0in;margin-left:44.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>'http://diveintomark.org/archives/2009/03/27/dive-into-history-2009-edition',
'published_date': time.struct_time(tm_year=2009, tm_mon=3, tm_mday=27,
tm_hour=22, tm_min=20,</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'published': True}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.35pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>This is Python
Shell #2.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>There is no <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>entry </span>variable defined here. You defined an <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>entry </span>variable
in Python Shell #1, but that’s a completely different environment with its own
state.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Open the <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>entry.pickle </span>file you created in Python Shell #1. The
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>pickle
</span>module uses a binary data format, so you should always open pickle files
in binary mode.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>pickle.load()
</span>function takes a <u>stream object</u>, reads the serialized data from
the stream, creates a new Python object, recreates the serialized data in the
new Python object, and returns the new Python object.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
22.45pt;margin-left:16.65pt;text-indent:-16.65pt'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Now the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>entry
</span>variable is a dictionary with familiar-looking keys and values.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>The <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>pickle.dump() / pickle.load() </span>cycle
results in a new data structure that is equal to the original data structure.</p>

</div>

<span style='font-size:12.0pt;line-height:154%;font-family:"Gill Sans MT",sans-serif;
color:black'><br clear=all style='page-break-before:always'>
</span>

<div class=WordSection20>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:210.05pt;
margin-bottom:5.9pt;margin-left:239.1pt;text-align:center;line-height:107%'><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:279.65pt;margin-bottom:
0in;margin-left:61.4pt;text-indent:-24.0pt;line-height:180%'><span
style='font-size:10.0pt;line-height:180%;font-family:"Liberation Mono"'>1 with
open('entry.pickle', 'rb') as f:   </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>...     </span><span style='font-size:10.0pt;line-height:110%;
font-family:"Liberation Mono"'>entry2 = pickle.load(f)              </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.95in;margin-bottom:
12.55pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#666677'>...</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>entry2 == entry                          </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.55pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>True</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>entry2 is entry                          </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9316;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.55pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>False</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>entry2['tags']                           </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9317;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>('diveintopython', 'docbook', 'html')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:296.45pt;margin-bottom:
22.55pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>entry2['internal_id']
b'\xDE\xD5\xB4\xF8'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
7.4pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Switch back to
Python Shell #1.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.35pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Open the <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>entry.pickle
</span>file.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.6pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Load the
serialized data into a new variable, <span style='font-size:10.0pt;line-height:
107%;font-family:"Liberation Mono"'>entry2</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Python confirms that the two dictionaries, <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>entry </span>and <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>entry2</span>,
are equal. In this shell, you built <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>entry </span>from the ground up, starting
with an empty dictionary and manually assigning values to specific keys. You
serialized this dictionary and stored it in the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>entry.pickle </span>file. Now
you’ve read the serialized data from that file and created a perfect replica of
the original data structure.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Equality is not the same as identity. I said you’ve created a <i>perfect
replica </i>of the original data structure, which is true. But it’s still a
copy.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
45.55pt;margin-left:16.65pt;text-indent:-16.65pt'>6.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>For reasons that will become clear later in this chapter, I want to
point out that the value of the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>'tags' </span>key is a tuple, and the value of
the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>'internal_id'
</span>key is a <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>bytes </span>object.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:33.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h5 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>13.4.
P</span>ICKLING <span style='font-size:18.0pt;line-height:112%'>W</span>ITHOUT
A <span style='font-size:18.0pt;line-height:112%'>F</span>ILE</h5>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>The examples in the previous section showed how to
serialize a Python object directly to a file on disk. But what if you don’t
want or need a file? You can also serialize to a <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>bytes </span>object in memory.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:357.7pt;margin-bottom:
0in;margin-left:61.4pt;text-indent:-24.0pt;line-height:179%'><span
style='font-size:10.0pt;line-height:179%;font-family:"Liberation Mono"'>1 b =
pickle.dumps(entry)  </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>type(b)                     </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;class 'bytes'&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.75pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>entry3 = pickle.loads(b)    </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>entry3 == entry             </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>True</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>pickle.dumps()
</span>function (note the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>'s' </span>at the end of the function name)
performs the same serialization as the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>pickle.dump() </span>function.
Instead of taking a stream object and writing the serialized data to a file on
disk, it simply returns the serialized data.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.65pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Since the pickle
protocol uses a binary data format, the <span style='font-size:10.0pt;
line-height:107%;font-family:"Liberation Mono"'>pickle.dumps() </span>function
returns a <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>bytes
</span>object.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>pickle.loads()
</span>function (again, note the <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>'s' </span>at the end of the function name)
performs the same deserialization as the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>pickle.load() </span>function.
Instead of taking a stream object and reading the serialized data from a file,
it takes a <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>bytes
</span>object containing serialized data, such as the one returned by the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>pickle.dumps()
</span>function.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
46.55pt;margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The end result is the same: a perfect replica of the original
dictionary.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:33.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h5 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>13.5.
B</span>YTES AND <span style='font-size:18.0pt;line-height:112%'>S</span>TRINGS
<span style='font-size:18.0pt;line-height:112%'>R</span>EAR <span
style='font-size:18.0pt;line-height:112%'>T</span>HEIR <span style='font-size:
18.0pt;line-height:112%'>U</span>GLY <span style='font-size:18.0pt;line-height:
112%'>H</span>EADS <span style='font-size:18.0pt;line-height:112%'>A</span>GAIN</h5>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.55pt;margin-left:16.4pt'>The pickle protocol has been around for many years,
and it has matured as Python itself has matured. There are now <a
href="http://docs.python.org/3.1/library/pickle.html#data-stream-format"><span
style='color:black'>four</span></a><u> </u><a
href="http://docs.python.org/3.1/library/pickle.html#data-stream-format"><span
style='color:black'>different</span></a><u> </u><a
href="http://docs.python.org/3.1/library/pickle.html#data-stream-format"><span
style='color:black'>versions</span></a><u> </u>of the pickle protocol.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-12.25pt;line-height:107%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Python 1.x had
two pickle protocols, a text-based format (“version 0”) and a binary format
(“version 1”).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-12.25pt'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Python 2.3 introduced a new pickle protocol (“version 2”) to handle new
functionality in Python class objects. It is a binary format.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-12.25pt'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Python 3.0 introduced another pickle protocol (“version 3”) with
explicit support for <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>bytes </span>objects and byte arrays. It is a binary format.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
45.7pt;margin-left:16.4pt'>Oh look, <u>the difference between bytes and strings
</u>rears its ugly head again. (If you’re surprised, you haven’t been paying
attention.) What this means in practice is that, while Python 3 can read data
pickled with protocol version 2, Python 2 can not read data pickled with
protocol version 3.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:33.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h5 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>13.6.
D</span>EBUGGING <span style='font-size:18.0pt;line-height:112%'>P</span>ICKLE <span
style='font-size:18.0pt;line-height:112%'>F</span>ILES</h5>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
18.85pt;margin-left:16.4pt'>What does the pickle protocol look like? Let’s jump
out of the Python Shell for a moment and take a look at that <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>entry.pickle
</span>file we created.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:74.45pt;margin-bottom:
22.85pt;margin-left:38.65pt;text-align:justify;text-justify:inter-ideograph;
line-height:182%'><span style='font-size:10.0pt;line-height:182%;font-family:
"Liberation Mono";color:#666677'>you@localhost:~/diveintopython3/examples$ </span><span
style='font-size:10.0pt;line-height:182%;font-family:"Liberation Mono"'>ls -l
entry.pickle -rw-r--r-- 1 you  you  358 Aug  3 13:34 entry.pickle </span><span
style='font-size:10.0pt;line-height:182%;font-family:"Liberation Mono";
color:#666677'>you@localhost:~/diveintopython3/examples$ </span><span
style='font-size:10.0pt;line-height:182%;font-family:"Liberation Mono"'>cat
entry.pickle comments_linkqNXtagsqXdiveintopythonqXdocbookqXhtmlq?qX
publishedq?
XlinkXJhttp://diveintomark.org/archives/2009/03/27/dive-into-history-2009-edition
q   Xpublished_dateq ctime struct_time ?qRqXtitleqXDive into history, 2009
editionqu.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>That wasn’t terribly helpful. You can see the
strings, but other datatypes end up as unprintable (or at least unreadable)
characters. Fields are not obviously delimited by tabs or spaces. This is not a
format you would want to debug by yourself.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:428.45pt;margin-bottom:
0in;margin-left:61.4pt;text-indent:-24.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>1
import pickletools</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>with
open('entry.pickle', 'rb') as f:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:404.45pt;margin-bottom:
0in;margin-left:61.4pt;text-indent:-24.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
color:#666677'>... </span><span style='font-size:10.0pt;line-height:185%;
font-family:"Liberation Mono"'>pickletools.dis(f) 0: \x80 PROTO      3 2: }   
EMPTY_DICT</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:404.45pt;margin-bottom:
0in;margin-left:62.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>3: q    BINPUT     0 5: (   
MARK</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:284.45pt;margin-bottom:
0in;margin-left:56.15pt;text-indent:6.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>6:
X        BINUNICODE 'published_date' 25: q        BINPUT     1</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:56.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>27: c        GLOBAL     'time struct_time'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:374.45pt;margin-bottom:
0in;margin-left:56.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>45: q        BINPUT     2 47:
(        MARK</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:332.45pt;margin-bottom:
0in;margin-left:56.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>48: M            BININT2   
2009 51: K            BININT1    3</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:344.45pt;margin-bottom:
0in;margin-left:56.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>53: K            BININT1    27
55: K            BININT1    22 57: K            BININT1    20</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:344.45pt;margin-bottom:
0in;margin-left:56.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>59: K            BININT1    42
61: K            BININT1    4</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:344.45pt;margin-bottom:
0in;margin-left:56.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>63: K            BININT1    86
65: J            BININT     -1</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:56.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>70: t            TUPLE      (MARK at 47)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:374.45pt;margin-bottom:
0in;margin-left:56.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>71: q        BINPUT     3 73:
}        EMPTY_DICT</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:374.45pt;margin-bottom:
0in;margin-left:56.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>74: q        BINPUT     4 76:
\x86     TUPLE2</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:374.45pt;margin-bottom:
0in;margin-left:56.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>77: q        BINPUT     5 79:
R        REDUCE</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:56.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>80: q        BINPUT     6</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:56.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>82: X        BINUNICODE 'comments_link'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:368.45pt;margin-bottom:
8.25pt;margin-left:50.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>100: q        BINPUT     7 102:
N        NONE</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:296.45pt;margin-bottom:
0in;margin-left:50.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>103: X        BINUNICODE
'internal_id' 119: q        BINPUT     8</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:314.45pt;margin-bottom:
0in;margin-left:50.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>121: C        SHORT_BINBYTES
'ÞÕ´ø' 127: q        BINPUT     9</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:302.45pt;margin-bottom:
0in;margin-left:50.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>129: X        BINUNICODE 'tags'
138: q        BINPUT     10 140: X        BINUNICODE 'diveintopython' 159:
q        BINPUT     11</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:320.45pt;margin-bottom:
0in;margin-left:50.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>161: X        BINUNICODE
'docbook' 173: q        BINPUT     12</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>175: X        BINUNICODE 'html'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:362.45pt;margin-bottom:
0in;margin-left:50.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>184: q        BINPUT     13
186: \x87     TUPLE3</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>187: q        BINPUT     14</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>189: X        BINUNICODE 'title'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:200.45pt;margin-bottom:
0in;margin-left:50.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>199: q        BINPUT     15
201: X        BINUNICODE 'Dive into history, 2009 edition' 237: q       
BINPUT     16 239: X        BINUNICODE 'article_link'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-3.55pt;margin-bottom:
0in;margin-left:50.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>256: q        BINPUT     17
258: X        BINUNICODE
'http://diveintomark.org/archives/2009/03/27/dive-into-history-2009 337:
q        BINPUT     18</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>339: X        BINUNICODE 'published'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:332.45pt;margin-bottom:
0in;margin-left:50.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>353: q        BINPUT     19
355: \x88     NEWTRUE 356: u        SETITEMS   (MARK at 5)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>357: .    STOP</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:37.9pt;line-height:110%;background:gainsboro'><b><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>highest
protocol among opcodes = 3</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>The most interesting piece of information in that
disassembly is on the last line, because it includes the version of the pickle
protocol with which this file was saved. There is no explicit version marker in
the pickle protocol. To determine which protocol version was used to store a
pickle file, you need to look at the markers (“opcodes”) within the pickled
data and use hard-coded knowledge of which opcodes were introduced with each
version of the pickle protocol. The <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>pickle.dis() </span>function does exactly
that, and it</p>

</div>

<span style='font-size:12.0pt;line-height:154%;font-family:"Gill Sans MT",sans-serif;
color:black'><br clear=all style='page-break-before:always'>
</span>

<div class=WordSection21>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:19.05pt;
margin-left:16.4pt'>prints the result in the last line of the disassembly
output. Here is a function that returns just the version number, without
printing anything:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>import pickletools</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def protocol_version(file_object):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:174.0pt;margin-bottom:
0in;margin-left:62.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>maxproto = -1 for opcode, arg,
pos in pickletools.genops(file_object):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:86.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>maxproto = max(maxproto, opcode.proto)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>return maxproto</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.9pt;margin-left:16.4pt'>And here it is in action:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>import
pickleversion</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>with
open('entry.pickle', 'rb') as f:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>...     </span><span style='font-size:10.0pt;line-height:110%;
font-family:"Liberation Mono"'>v = pickleversion.protocol_version(f)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.95in;margin-bottom:
8.5pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>v</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:56.15pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>3</span></p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:6.95pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:1.4pt;
margin-left:16.4pt;line-height:112%'><b><span style='font-size:18.0pt;
line-height:112%;font-family:"DejaVu Serif",serif'>13.7. S</span></b><b><span
style='font-size:14.5pt;line-height:112%;font-family:"DejaVu Serif",serif'>ERIALIZING
</span></b><b><span style='font-size:18.0pt;line-height:112%;font-family:"DejaVu Serif",serif'>P</span></b><b><span
style='font-size:14.5pt;line-height:112%;font-family:"DejaVu Serif",serif'>YTHON
</span></b><b><span style='font-size:18.0pt;line-height:112%;font-family:"DejaVu Serif",serif'>O</span></b><b><span
style='font-size:14.5pt;line-height:112%;font-family:"DejaVu Serif",serif'>BJECTS
TO BE </span></b><b><span style='font-size:18.0pt;line-height:112%;font-family:
"DejaVu Serif",serif'>R</span></b><b><span style='font-size:14.5pt;line-height:
112%;font-family:"DejaVu Serif",serif'>EAD BY </span></b><b><span
style='font-size:18.0pt;line-height:112%;font-family:"DejaVu Serif",serif'>O</span></b><b><span
style='font-size:14.5pt;line-height:112%;font-family:"DejaVu Serif",serif'>THER</span></b></p>

<h4 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>L</span>ANGUAGES</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:5.05pt;margin-bottom:
20.95pt;margin-left:16.4pt'>The data format used by the <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>pickle </span>module is
Python-specific. It makes no attempt to be compatible with other programming
languages. If cross-language compatibility is one of your requirements, you
need to look at other serialization formats. One such format is <a
href="http://json.org/"><span style='font-size:9.5pt;line-height:154%;
color:black'>JSON</span></a>. “<span style='font-size:9.5pt;line-height:154%'>JSON</span>”
stands for “JavaScript Object Notation,” but don’t let the name fool you — <span
style='font-size:9.5pt;line-height:154%'>JSON </span>is explicitly designed to
be usable across multiple programming languages.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:20.5pt;
margin-left:16.4pt'>Python 3 includes a <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>json </span>module in the
standard library. Like the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>pickle </span>module, the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>json </span>module
has functions for serializing data structures, storing the serialized data on
disk, loading serialized data from disk, and unserializing the data back into a
new Python object. But there are some important differences, too. First of all,
the <span style='font-size:9.5pt;line-height:154%'>JSON </span>data format is
text-based, not binary. <a href="http://www.ietf.org/rfc/rfc4627.txt"><span
style='color:black'>RFC</span></a><u> </u><a
href="http://www.ietf.org/rfc/rfc4627.txt"><span style='color:black'>4627</span></a><u>
</u>defines the <span style='font-size:9.5pt;line-height:154%'>JSON </span>format
and how different types of data must be encoded as text. For example, a boolean
value is stored as either the fivecharacter string <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>'false' </span>or the
four-character string <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>'true'</span>. All <span style='font-size:9.5pt;
line-height:154%'>JSON </span>values are case-sensitive.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.35pt;margin-bottom:
20.75pt;margin-left:16.4pt'>Second, as with any text-based format, there is the
issue of whitespace. <span style='font-size:9.5pt;line-height:154%'>JSON </span>allows
arbitrary amounts of whitespace (spaces, tabs, carriage returns, and line
feeds) between values. This whitespace is “insignificant,” which means that <span
style='font-size:9.5pt;line-height:154%'>JSON </span>encoders can add as much
or as little whitespace as they like, and <span style='font-size:9.5pt;
line-height:154%'>JSON </span>decoders are required to ignore the whitespace
between values. This allows you to “pretty-print” your <span style='font-size:
9.5pt;line-height:154%'>JSON </span>data, nicely nesting values within values
at different indentation levels so you can read it in a standard browser or
text editor. Python’s <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>json </span>module has options for
pretty-printing during encoding.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.05pt;margin-bottom:
45.7pt;margin-left:16.4pt'>Third, there’s the perennial problem of character
encoding. <span style='font-size:9.5pt;line-height:154%'>JSON </span>encodes
values as plain text, but as you know, <u>there ain’t no such thing as “plain
text.” </u><span style='font-size:9.5pt;line-height:154%'>JSON </span>must be
stored in a Unicode encoding (UTF-32, UTF-16, or the default, <span
style='font-size:9.5pt;line-height:154%'>UTF</span>-8), and <a
href="http://www.ietf.org/rfc/rfc4627.txt"><span style='color:black'>section</span></a><u>
</u><a href="http://www.ietf.org/rfc/rfc4627.txt"><span style='color:black'>3</span></a><u>
</u><a href="http://www.ietf.org/rfc/rfc4627.txt"><span style='color:black'>of</span></a><u>
</u><a href="http://www.ietf.org/rfc/rfc4627.txt"><span style='color:black'>RFC</span></a><u>
</u><a href="http://www.ietf.org/rfc/rfc4627.txt"><span style='color:black'>4627</span></a><u>
</u>defines how to tell which encoding is being used.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:6.95pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h5 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>13.8.
S</span>AVING <span style='font-size:18.0pt;line-height:112%'>D</span>ATA TO A
JSON <span style='font-size:18.0pt;line-height:112%'>F</span>ILE</h5>

<p class=MsoNormal style='margin-left:16.4pt'><span style='font-size:9.5pt;
line-height:154%'>JSON </span>looks remarkably like a data structure you might
define manually in JavaScript. This is no accident; you can actually use the
JavaScript <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>eval()
</span>function to “decode” <span style='font-size:9.5pt;line-height:154%'>JSON</span>-serialized
data. (The usual <u>caveats about untrusted input </u>apply, but the point is
that <span style='font-size:9.5pt;line-height:154%'>JSON </span><i>is </i>valid
JavaScript.) As such, <span style='font-size:9.5pt;line-height:154%'>JSON </span>may
already look familiar to you.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>shell</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.6pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>1</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>basic_entry = {}                                           </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>basic_entry['id']
= 256</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>basic_entry['title']
= 'Dive into history, 2009 edition'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>basic_entry['tags']
= ('diveintopython', 'docbook', 'html')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>basic_entry['published']
= True</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>basic_entry['comments_link']
= None</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>import
json</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.8pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>with
open('basic.json', mode='w', encoding='utf-8') as f: </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:28.4pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>...     </span><span style='font-size:10.0pt;line-height:110%;
font-family:"Liberation Mono"'>json.dump(basic_entry, f)                              </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:4.8pt;margin-bottom:.25pt;
margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>We’re going to create a new data structure instead of re-using the
existing <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>entry
</span>data structure. Later in this chapter, we’ll see what happens when we
try to encode the more complex data structure in <span style='font-size:9.5pt;
line-height:154%'>JSON</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:4.8pt;margin-bottom:.25pt;
margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span><span style='font-size:9.5pt;line-height:154%'>JSON </span>is a
text-based format, which means you need to open this file in text mode and
specify a character encoding. You can never go wrong with <span
style='font-size:9.5pt;line-height:154%'>UTF</span>-8.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:4.8pt;margin-bottom:20.65pt;
margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Like the <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>pickle </span>module, the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>json </span>module defines a <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>dump() </span>function
which takes a Python data structure and a writeable stream object. The <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>dump() </span>function
serializes the Python data structure and writes it to the stream object. Doing
this inside a <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>with
</span>statement will ensure that the file is closed properly when we’re done.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.95pt;margin-left:16.4pt'>So what does the resulting <span style='font-size:
9.5pt;line-height:154%'>JSON </span>serialization look like?</p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.95in;margin-bottom:
8.5pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#666677'>you@localhost:~/diveintopython3/examples$
</span><span style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>cat
basic.json</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>{&quot;published&quot;: true,
&quot;tags&quot;: [&quot;diveintopython&quot;, &quot;docbook&quot;,
&quot;html&quot;], &quot;comments_link&quot;: null,</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.15pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&quot;id&quot;: 256, &quot;title&quot;:
&quot;Dive into history, 2009 edition&quot;}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.65pt;margin-bottom:
.25pt;margin-left:16.4pt'>That’s certainly <u>more readable than a pickle file</u>.
But <span style='font-size:9.5pt;line-height:154%'>JSON </span>can contain
arbitrary whitespace between values, and the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>json </span>module provides an
easy way to take advantage of this to create even more readable <span
style='font-size:9.5pt;line-height:154%'>JSON </span>files.</p>

</div>

<span style='font-size:12.0pt;line-height:154%;font-family:"Gill Sans MT",sans-serif;
color:black'><br clear=all style='page-break-before:always'>
</span>

<div class=WordSection22>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>with open('basic-pretty.json', mode='w',
encoding='utf-8') as f:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:28.95pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>...     </span><span style='font-size:10.0pt;line-height:110%;
font-family:"Liberation Mono"'>json.dump(basic_entry, f, <b><span
style='background:gainsboro'>indent=2</span></b>)                            </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:37.05pt;margin-bottom:
14.15pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:188%'>1.   If you
pass an <span style='font-size:10.0pt;line-height:188%;font-family:"Liberation Mono"'>indent
</span>parameter to the <span style='font-size:10.0pt;line-height:188%;
font-family:"Liberation Mono"'>json.dump() </span>function, it will make the
resulting <span style='font-size:9.5pt;line-height:188%'>JSON </span>file more
readable, at the expense of larger file size. The <span style='font-size:10.0pt;
line-height:188%;font-family:"Liberation Mono"'>indent </span>parameter is an
integer. 0 means “put each value on its own line.” A number greater than 0
means “put each value on its own line, and use this number of spaces to indent
nested data structures.” And this is the result:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.45in;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>you@localhost:~/diveintopython3/examples$
</span><span style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>cat
basic-pretty.json {</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:398.45pt;margin-bottom:
0in;margin-left:50.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>&quot;published&quot;: true,
&quot;tags&quot;: [</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&quot;diveintopython&quot;,</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&quot;docbook&quot;,</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&quot;html&quot;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:416.45pt;margin-bottom:
0in;margin-left:50.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>], &quot;comments_link&quot;:
null,</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&quot;id&quot;: 256,</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&quot;title&quot;: &quot;Dive into history,
2009 edition&quot;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:56.15pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>}</span></p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:33.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h5 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>13.9.
M</span>APPING OF <span style='font-size:18.0pt;line-height:112%'>P</span>YTHON
<span style='font-size:18.0pt;line-height:112%'>D</span>ATATYPES TO JSON</h5>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>Since <span style='font-size:9.5pt;line-height:154%'>JSON
</span>is not Python-specific, there are some mismatches in its coverage of
Python datatypes. Some of them are simply naming differences, but there is two
important Python datatypes that are completely missing.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>See if you can spot them:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:24.8pt;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=736 height=291 src="Dive%20Into%20Python%203_files/image049.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
45.7pt;margin-left:16.4pt'>Did you notice what was missing? Tuples <i><span
style='font-size:13.0pt;line-height:154%;font-family:"DejaVu Serif",serif'>&amp;
</span></i>bytes! <span style='font-size:9.5pt;line-height:154%'>JSON </span>has
an array type, which the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>json </span>module maps to a Python list, but it
does not have a separate type for “frozen arrays” (tuples). And while <span
style='font-size:9.5pt;line-height:154%'>JSON </span>supports strings quite
nicely, it has no support for <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>bytes </span>objects or byte arrays.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:33.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h5 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>13.10.
S</span>ERIALIZING <span style='font-size:18.0pt;line-height:112%'>D</span>ATATYPES
<span style='font-size:18.0pt;line-height:112%'>U</span>NSUPPORTED BY JSON</h5>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>Even if <span style='font-size:9.5pt;line-height:
154%'>JSON </span>has no built-in support for bytes, that doesn’t mean you
can’t serialize <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>bytes </span>objects. The <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>json </span>module provides
extensibility hooks for encoding and decoding unknown datatypes. (By “unknown,”
I mean “not defined in <span style='font-size:9.5pt;line-height:154%'>JSON</span>.”
Obviously the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>json
</span>module knows about byte arrays, but it’s constrained by the limitations
of the <span style='font-size:9.5pt;line-height:154%'>JSON </span>specification.)
If you want to encode bytes or other datatypes that <span style='font-size:
9.5pt;line-height:154%'>JSON </span>doesn’t support natively, you need to
provide custom encoders and decoders for those types.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                            </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>entry                                                 </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>{'comments_link': None,</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'internal_id': b'\xDE\xD5\xB4\xF8',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'title': 'Dive into history, 2009 edition',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'tags': ('diveintopython', 'docbook',
'html'),</span></p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:-3.55pt;
margin-bottom:0in;margin-left:.5pt;text-align:center;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>'article_link':
'http://diveintomark.org/archives/2009/03/27/dive-into-history-2009-edition',
'published_date': time.struct_time(tm_year=2009, tm_mon=3, tm_mday=27,
tm_hour=22, tm_min=20,</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'published': True}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>import
json</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.75pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>with
open('entry.json', 'w', encoding='utf-8') as f: </span><span style='font-family:
"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>...     </span><span style='font-size:10.0pt;line-height:110%;
font-family:"Liberation Mono"'>json.dump(entry, f)                               </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.95in;margin-bottom:
8.5pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#666677'>...</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>Traceback (most
recent call last):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>File
&quot;&lt;stdin&gt;&quot;, line 5, in &lt;module&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:182.45pt;margin-bottom:
0in;margin-left:62.15pt;text-indent:-12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
color:#880000'>File &quot;C:\Python31\lib\json\__init__.py&quot;, line 178, in
dump for chunk in iterable:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:146.45pt;margin-bottom:
0in;margin-left:62.15pt;text-indent:-12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
color:#880000'>File &quot;C:\Python31\lib\json\encoder.py&quot;, line 408, in
_iterencode for chunk in _iterencode_dict(o, _current_indent_level):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
0in;margin-left:62.15pt;text-indent:-12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
color:#880000'>File &quot;C:\Python31\lib\json\encoder.py&quot;, line 382, in
_iterencode_dict for chunk in chunks:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:158.45pt;margin-bottom:
0in;margin-left:62.15pt;text-indent:-12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
color:#880000'>File &quot;C:\Python31\lib\json\encoder.py&quot;, line 416, in
_iterencode o = _default(o)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:158.45pt;margin-bottom:
0in;margin-left:62.15pt;text-indent:-12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
color:#880000'>File &quot;C:\Python31\lib\json\encoder.py&quot;, line 170, in
default raise TypeError(repr(o) + &quot; is not JSON serializable&quot;)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.65pt;
margin-left:38.15pt;text-indent:0in;line-height:107%;background:gainsboro'><b><span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono";
color:#880000'>TypeError: b'\xDE\xD5\xB4\xF8' is not JSON serializable</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>OK, it’s time to revisit the <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>entry </span>data structure. This has it
all: a boolean value, a <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>None </span>value, a string, a tuple of strings,
a <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>bytes
</span>object, and a <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>time </span>structure.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>I know I’ve said it before, but it’s worth repeating: <span
style='font-size:9.5pt;line-height:154%'>JSON </span>is a text-based format.
Always open <span style='font-size:9.5pt;line-height:154%'>JSON </span>files in
text mode with a <span style='font-size:9.5pt;line-height:154%'>UTF</span>-8
character encoding.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Well <i>that’s </i>not
good. What happened?</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
23.15pt;margin-left:16.4pt'>Here’s what happened: the <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>json.dump() </span>function
tried to serialize the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>bytes </span>object <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>b'\xDE\xD5\xB4\xF8'</span>, but
it failed, because <span style='font-size:9.5pt;line-height:154%'>JSON </span>has
no support for <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>bytes
</span>objects. However, if storing bytes is important to you, you can define
your own “mini-serialization format.”</p>

<p class=MsoNormal style='margin-top:0in;margin-right:117.65pt;margin-bottom:
4.5pt;margin-left:62.15pt;text-align:justify;text-justify:inter-ideograph;
text-indent:-24.0pt;line-height:182%'><span style='font-size:10.0pt;line-height:
182%;font-family:"Liberation Mono"'>def to_json(python_object):   </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312; </span><span
style='font-size:10.0pt;line-height:182%;font-family:"Liberation Mono"'>if
isinstance(python_object, bytes): </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9313; </span><span style='font-size:10.0pt;line-height:182%;
font-family:"Liberation Mono"'>return {'__class__': 'bytes',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.9pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                                                            </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>'__value__':
list(python_object)}                       </span><span style='font-family:
"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:28.3pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>raise TypeError(repr(python_object) + ' is
not JSON serializable') </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>To define your own “mini-serialization format” for a datatype that <span
style='font-size:9.5pt;line-height:154%'>JSON </span>doesn’t support natively,
just define a function that takes a Python object as a parameter. This Python
object will be the actual object that the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>json.dump() </span>function is
unable to serialize by itself — in this case, the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>bytes </span>object <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>b'\xDE\xD5\xB4\xF8'</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Your custom serialization function should check the type of the Python
object that the <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>json.dump() </span>function passed to it. This is not
strictly necessary if your function only serializes one datatype, but it makes
it crystal clear what case your function is covering, and it makes it easier to
extend if you need to add serializations for more datatypes later.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>In this case, I’ve chosen to convert a <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>bytes </span>object into a
dictionary. The <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>__class__ </span>key will hold the original datatype (as a
string, <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>'bytes'</span>),
and the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__value__
</span>key will hold the actual value. Of course this can’t be a <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>bytes </span>object;
the entire point is to convert it into something that can be serialized in <span
style='font-size:9.5pt;line-height:154%'>JSON</span>! A <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>bytes </span>object is
just a sequence of integers; each integer is somewhere in the range 0–255. We
can use the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>list()
</span>function to convert the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>bytes </span>object into a list of integers. So <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>b'\xDE\xD5\xB4\xF8'
</span>becomes <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>[222,
213, 180, 248]</span>. (Do the math! It works! The byte <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>\xDE </span>in
hexadecimal is 222 in decimal, <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>\xD5 </span>is 213, and so on.)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.55pt;margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>This line is important. The data structure you’re serializing may
contain types that neither the built-in <span style='font-size:9.5pt;
line-height:154%'>JSON </span>serializer nor your custom serializer can handle.
In this case, your custom serializer must raise a <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>TypeError </span>so that the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>json.dump()
</span>function knows that your custom serializer did not recognize the type.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>That’s it; you don’t need to do anything else. In
particular, this custom serialization function <i>returns a Python dictionary</i>,
not a string. You’re not doing the entire serializing-to-<span
style='font-size:9.5pt;line-height:154%'>JSON </span>yourself; you’re only
doing the converting-to-a-supported-datatype part. The <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>json.dump() </span>function
will do the rest.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=718
 style='width:538.85pt;margin-left:38.15pt;border-collapse:collapse'>
 <tr style='height:18.3pt'>
  <td width=704 valign=top style='width:528.1pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
  margin-left:24.0pt;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>import
  customserializer</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9312;</span></p>
  </td>
 </tr>
 <tr style='height:22.5pt'>
  <td width=704 valign=top style='width:528.1pt;padding:0in 0in 0in 0in;
  height:22.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono";
  color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
  107%;font-family:"Liberation Mono"'>with open('entry.json', 'w',
  encoding='utf-8') as f:</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:22.5pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9313;</span></p>
  </td>
 </tr>
 <tr style='height:18.3pt'>
  <td width=704 valign=bottom style='width:528.1pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono";
  color:#666677'>...     </span><span style='font-size:10.0pt;line-height:107%;
  font-family:"Liberation Mono"'>json.dump(entry, f, <b><span style='background:
  gainsboro'>default=customserializer.to_json</span></b>)</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9314;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:1.95in;margin-bottom:
8.5pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#666677'>...</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>Traceback (most
recent call last):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:218.45pt;margin-bottom:
0in;margin-left:62.15pt;text-indent:-12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
color:#880000'>File &quot;&lt;stdin&gt;&quot;, line 9, in &lt;module&gt;
json.dump(entry, f, default=customserializer.to_json)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:182.45pt;margin-bottom:
0in;margin-left:62.15pt;text-indent:-12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
color:#880000'>File &quot;C:\Python31\lib\json\__init__.py&quot;, line 178, in
dump for chunk in iterable:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:146.45pt;margin-bottom:
0in;margin-left:62.15pt;text-indent:-12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
color:#880000'>File &quot;C:\Python31\lib\json\encoder.py&quot;, line 408, in
_iterencode for chunk in _iterencode_dict(o, _current_indent_level):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
0in;margin-left:62.15pt;text-indent:-12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
color:#880000'>File &quot;C:\Python31\lib\json\encoder.py&quot;, line 382, in
_iterencode_dict for chunk in chunks:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:158.45pt;margin-bottom:
0in;margin-left:62.15pt;text-indent:-12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
color:#880000'>File &quot;C:\Python31\lib\json\encoder.py&quot;, line 416, in
_iterencode o = _default(o)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#880000'>File
&quot;/Users/pilgrim/diveintopython3/examples/customserializer.py&quot;, line
12, in to_json</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                            </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#880000'>raise TypeError(repr(python_object) + ' is not JSON
serializable')          </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9315;</span></p>

<p class=MsoNormal align=right style='margin-top:0in;margin-right:-4.3pt;
margin-bottom:31.9pt;margin-left:.5pt;text-align:right;line-height:110%'><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#880000'>TypeError: time.struct_time(tm_year=2009, tm_mon=3, tm_mday=27,
tm_hour=22, tm_min=20, tm_sec=</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.1pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>customserializer
</span>module is where you just defined the <span style='font-size:10.0pt;
line-height:107%;font-family:"Liberation Mono"'>to_json() </span>function in
the previous example.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Text mode, <span style='font-size:9.5pt;line-height:154%'>UTF</span>-8
encoding, yadda yadda. (You’ll forget! I forget sometimes! And everything will
work right up until the moment that it fails, and then it will fail most
spectacularly.)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.15pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:155%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>This is the
important bit: to hook your custom conversion function into the <span
style='font-size:10.0pt;line-height:155%;font-family:"Liberation Mono"'>json.dump()
</span>function, pass your function into the <span style='font-size:10.0pt;
line-height:155%;font-family:"Liberation Mono"'>json.dump() </span>function in
the <span style='font-size:10.0pt;line-height:155%;font-family:"Liberation Mono"'>default
</span>parameter. (Hooray, <u>everything in Python is an object</u>!)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.45pt;margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>OK, so it didn’t actually work. But take a look at the exception. The <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>json.dump()
</span>function is no longer complaining about being unable to serialize the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>bytes </span>object.
Now it’s complaining about a completely different object: the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>time.struct_time
</span>object.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>While getting a different exception might not seem
like progress, it really is! It’ll just take one more tweak to get past this.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:398.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:370%'><span style='font-size:10.0pt;
line-height:370%;font-family:"Liberation Mono"'>import time def
to_json(python_object):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:147.65pt;margin-bottom:
4.2pt;margin-left:86.15pt;text-indent:-24.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>if
isinstance(python_object, time.struct_time):   </span><span style='font-family:
"DejaVu Sans",sans-serif;color:#222222'>&#9312; </span><span style='font-size:
10.0pt;line-height:185%;font-family:"Liberation Mono"'>return {'__class__':
'time.asctime',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                                                            </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>'__value__':
time.asctime(python_object)}    </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>if isinstance(python_object, bytes):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:86.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>return {'__class__': 'bytes',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:134.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'__value__': list(python_object)}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:32.0pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>raise TypeError(repr(python_object) + ' is
not JSON serializable')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Adding to our existing <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>customserializer.to_json() </span>function, we
need to check whether the Python object (that the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>json.dump() </span>function is
having trouble with) is a <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>time.struct_time</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>If so, we’ll do something similar to the conversion we did with the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>bytes </span>object:
convert the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>time.struct_time
</span>object to a dictionary that only contains <span style='font-size:9.5pt;
line-height:154%'>JSON</span>-serializable values. In this case, the easiest
way to convert a datetime into a <span style='font-size:9.5pt;line-height:154%'>JSON</span>-serializable
value is to convert it to a string with the</p>

<p class=MsoNormal style='margin-top:0in;margin-right:19.8pt;margin-bottom:
19.35pt;margin-left:17.15pt;line-height:163%'><span style='font-size:10.0pt;
line-height:163%;font-family:"Liberation Mono"'>time.asctime() </span>function.
The <span style='font-size:10.0pt;line-height:163%;font-family:"Liberation Mono"'>time.asctime()
</span>function will convert that nasty-looking <span style='font-size:10.0pt;
line-height:163%;font-family:"Liberation Mono"'>time.struct_time </span>into
the string <span style='font-size:10.0pt;line-height:163%;font-family:"Liberation Mono"'>'Fri
Mar 27 22:20:42 2009'</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.0pt;margin-left:16.4pt'>With these two custom conversions, the entire <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>entry </span>data
structure should serialize to <span style='font-size:9.5pt;line-height:154%'>JSON
</span>without any further problems.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>shell</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>1</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:194.45pt;margin-bottom:
8.25pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>with
open('entry.json', 'w', encoding='utf-8') as f: </span><span style='font-size:
10.0pt;line-height:185%;font-family:"Liberation Mono";color:#666677'>...     </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>json.dump(entry,
f, default=customserializer.to_json) </span><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>...</span></p>

</div>

<span style='font-size:12.0pt;line-height:154%;font-family:"Gill Sans MT",sans-serif;
color:black'><br clear=all style='page-break-before:always'>
</span>

<div class=WordSection23>

<p class=MsoNormal style='margin-top:0in;margin-right:1.95in;margin-bottom:
8.5pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#666677'>you@localhost:~/diveintopython3/examples$
</span><span style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>ls
-l example.json</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:14.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>-rw-r--r-- 1 you  you  391 Aug 
3 13:34 entry.json </span><span style='font-size:10.0pt;line-height:185%;
font-family:"Liberation Mono";color:#666677'>you@localhost:~/diveintopython3/examples$
</span><span style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>cat
example.json</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>{&quot;published_date&quot;:
{&quot;__class__&quot;: &quot;time.asctime&quot;, &quot;__value__&quot;:
&quot;Fri Mar 27 22:20:42 2009&quot;},</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-3.55pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>&quot;comments_link&quot;:
null, &quot;internal_id&quot;: {&quot;__class__&quot;: &quot;bytes&quot;,
&quot;__value__&quot;: [222, 213, 180, 248] &quot;tags&quot;:
[&quot;diveintopython&quot;, &quot;docbook&quot;, &quot;html&quot;],
&quot;title&quot;: &quot;Dive into history, 2009 edition&quot;,
&quot;article_link&quot;:
&quot;http://diveintomark.org/archives/2009/03/27/dive-into-history-2009-edition&quot;,</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:56.15pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&quot;published&quot;: true}</span></p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:33.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h5 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>13.11.
L</span>OADING <span style='font-size:18.0pt;line-height:112%'>D</span>ATA FROM
A JSON <span style='font-size:18.0pt;line-height:112%'>F</span>ILE</h5>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>Like the <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>pickle </span>module, the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>json </span>module
has a <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>load()
</span>function which takes a stream object, reads <span style='font-size:9.5pt;
line-height:154%'>JSON</span>encoded data from it, and creates a new Python
object that mirrors the <span style='font-size:9.5pt;line-height:154%'>JSON </span>data
structure.<br clear=all style='page-break-before:always'>
</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>shell</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.45pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>2</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>del entry                                             </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>entry</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>Traceback (most
recent call last):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:278.45pt;margin-bottom:
0in;margin-left:37.4pt;text-indent:12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
color:#880000'>File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;
NameError: name 'entry' is not defined</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>import
json</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>with
open('entry.json', 'r', encoding='utf-8') as f:</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=478
 style='width:358.8pt;margin-left:38.15pt;border-collapse:collapse'>
 <tr style='height:39.3pt'>
  <td width=464 valign=top style='width:348.05pt;padding:0in 0in 0in 0in;
  height:39.3pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:162.05pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>...   </span><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>entry
  = json.load(f) </span><span style='font-size:10.0pt;line-height:107%;
  font-family:"Liberation Mono";color:#666677'>...</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:39.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9313;</span></p>
  </td>
 </tr>
 <tr style='height:18.3pt'>
  <td width=464 valign=bottom style='width:348.05pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono";
  color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
  107%;font-family:"Liberation Mono"'>entry</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9314;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
0in;margin-left:43.4pt;text-indent:-6.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>{'comments_link':
None, 'internal_id': {'__class__': 'bytes', '__value__': [222, 213, 180, 248]},
'title': 'Dive into history, 2009 edition',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'tags': ['diveintopython', 'docbook',
'html'],</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-3.55pt;margin-bottom:
0in;margin-left:44.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>'article_link':
'http://diveintomark.org/archives/2009/03/27/dive-into-history-2009-edition',
'published_date': {'__class__': 'time.asctime', '__value__': 'Fri Mar 27
22:20:42 2009'},</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.2pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'published': True}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>For demonstration purposes, switch to Python Shell #2 and delete the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>entry </span>data
structure that you created earlier in this chapter with the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>pickle </span>module.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>In the simplest case, the <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>json.load() </span>function works the same
as the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>pickle.load()
</span>function. You pass in a stream object and it returns a new Python
object.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.3pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>I have good news and bad news. Good news first: the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>json.load()
</span>function successfully read the <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>entry.json </span>file you created in
Python Shell #1 and created a new Python object that contained the data. Now
the bad news: it didn’t recreate the original <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>entry </span>data structure.
The two values <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>'internal_id'
</span>and <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>'published_date'
</span>were recreated as dictionaries — specifically, the dictionaries with <span
style='font-size:9.5pt;line-height:154%'>JSON</span>-compatible values that you
created in the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>to_json()
</span>conversion function.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.35pt;margin-left:16.4pt;line-height:107%'><span style='font-size:10.0pt;
line-height:107%;font-family:"Liberation Mono"'>json.load() </span>doesn’t know
anything about any conversion function you may have passed to <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>json.dump()</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>What you need is the opposite of the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>to_json()
</span>function — a function that will take a custom-converted <span
style='font-size:9.5pt;line-height:154%'>JSON </span>object and convert it back
to the original Python datatype.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'># add this to customserializer.py</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:165.65pt;margin-bottom:
4.5pt;margin-left:61.4pt;text-indent:-24.0pt;line-height:182%'><span
style='font-size:10.0pt;line-height:182%;font-family:"Liberation Mono"'>def
from_json(json_object):   </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9312; </span><span style='font-size:10.0pt;line-height:182%;
font-family:"Liberation Mono"'>if '__class__' in json_object:  </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313; </span><span
style='font-size:10.0pt;line-height:182%;font-family:"Liberation Mono"'>if
json_object['__class__'] == 'time.asctime':</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                                                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>return
time.strptime(json_object['__value__'])    </span><span style='font-family:
"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:86.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>if json_object['__class__'] == 'bytes':</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                                                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>return
bytes(json_object['__value__'])            </span><span style='font-family:
"DejaVu Sans",sans-serif;color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>return json_object</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>This conversion function also takes one parameter and returns one value.
But the parameter it takes is not a string, it’s a Python object — the result
of deserializing a <span style='font-size:9.5pt;line-height:154%'>JSON</span>-encoded
string into Python.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>All you need to do is check whether this object contains the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>'__class__'
</span>key that the <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>to_json() </span>function created. If so, the value of the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>'__class__'
</span>key will tell you how to decode the value back into the original Python
datatype.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>To decode the time string returned by the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>time.asctime() </span>function,
you use the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>time.strptime()
</span>function. This function takes a formatted datetime string (in a
customizable format, but it defaults to the same format that <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>time.asctime()
</span>defaults to) and returns a <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>time.struct_time</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.85pt;margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>To convert a list of integers back into a <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>bytes </span>object, you can
use the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>bytes()
</span>function.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:33.6pt;margin-bottom:
.25pt;margin-left:16.4pt'>That was it; there were only two datatypes handled in
the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>to_json()
</span>function, and now those two datatypes are handled in the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>from_json()
</span>function. This is the result:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>shell</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>2</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>import
customserializer</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>with
open('entry.json', 'r', encoding='utf-8') as f:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:111.65pt;margin-bottom:
3.8pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>...   </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>entry =
json.load(f, object_hook=customserializer.from_json) </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312; </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
color:#666677'>...</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>entry                                                             </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>{'comments_link': None,</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'internal_id': b'\xDE\xD5\xB4\xF8',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'title': 'Dive into history, 2009 edition',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'tags': ['diveintopython', 'docbook',
'html'],</span></p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:-3.55pt;
margin-bottom:0in;margin-left:.5pt;text-align:center;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>'article_link':
'http://diveintomark.org/archives/2009/03/27/dive-into-history-2009-edition',
'published_date': time.struct_time(tm_year=2009, tm_mon=3, tm_mday=27,
tm_hour=22, tm_min=20,</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.8pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'published': True}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.45in;margin-bottom:.25pt;
margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>To hook the <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>from_json() </span>function into the deserialization
process, pass it as the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>object_hook </span>parameter to the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>json.load()
</span>function. Functions that take functions; it’s so handy!</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.45in;margin-bottom:.25pt;
margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>entry </span>data
structure now contains an <span style='font-size:10.0pt;line-height:107%;
font-family:"Liberation Mono"'>'internal_id' </span>key whose value is a <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>bytes </span>object.
It also</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=611
 style='width:458.35pt;margin-left:16.65pt;border-collapse:collapse'>
 <tr style='height:205.8pt'>
  <td width=597 valign=top style='width:447.6pt;padding:1.55pt 0in 0in 0in;
  height:205.8pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:26.95pt;
  margin-left:0in;text-indent:0in;line-height:107%'>contains a <span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>'published_date'
  </span>key whose value is a <span style='font-size:10.0pt;line-height:107%;
  font-family:"Liberation Mono"'>time.struct_time </span>object.</p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:25.45pt;
  margin-left:0in;text-indent:0in;line-height:107%'>There is one final glitch,
  though.</p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:21.55pt;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>shell</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:21.55pt;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>1</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:21.55pt;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>import
  customserializer</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:21.55pt;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>with
  open('entry.json', 'r', encoding='utf-8') as f:</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
  margin-left:21.55pt;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:10.0pt;line-height:
  107%;font-family:"Liberation Mono";color:#666677'>... </span><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>entry2
  = json.load(f, object_hook=customserializer.from_json) </span><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono";
  color:#666677'>...</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:1.55pt 0in 0in 0in;
  height:205.8pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.0pt;
  margin-left:0in;text-indent:0in;line-height:107%'>&nbsp;</p>
  </td>
 </tr>
 <tr style='height:43.5pt'>
  <td width=597 valign=top style='width:447.6pt;padding:1.55pt 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:21.55pt;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>entry2
  == entry</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
  margin-left:21.55pt;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>False</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:1.55pt 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9312;</span></p>
  </td>
 </tr>
 <tr style='height:43.5pt'>
  <td width=597 valign=top style='width:447.6pt;padding:1.55pt 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:21.55pt;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>entry['tags']</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
  margin-left:21.55pt;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>('diveintopython',
  'docbook', 'html')</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:1.55pt 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9313;</span></p>
  </td>
 </tr>
 <tr style='height:18.3pt'>
  <td width=597 valign=bottom style='width:447.6pt;padding:1.55pt 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
  margin-left:21.55pt;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>entry2['tags']</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:1.55pt 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9314;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>['diveintopython', 'docbook', 'html']</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Even after hooking the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>to_json() </span>function into the
serialization, and hooking the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>from_json() </span>function into the
deserialization, we still haven’t recreated a perfect replica of the original
data structure. Why not?</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.6pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>In the original <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>entry </span>data
structure, the value of the <span style='font-size:10.0pt;line-height:107%;
font-family:"Liberation Mono"'>'tags' </span>key was a tuple of three strings.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
24.55pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>But in the round-tripped <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>entry2 </span>data structure, the value of the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>'tags' </span>key
is a <i>list </i>of three strings. <span style='font-size:9.5pt;line-height:
154%'>JSON </span>doesn’t distinguish between tuples and lists; it only has a
single list-like datatype, the array, and the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>json </span>module silently
converts both tuples and lists into <span style='font-size:9.5pt;line-height:
154%'>JSON </span>arrays during serialization. For most uses, you can ignore
the difference between tuples and lists, but it’s something to keep in mind as
you work with the <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>json </span>module.</p>

<h5 style='margin-top:0in;margin-right:0in;margin-bottom:44.1pt;margin-left:
16.4pt'><span style='font-size:18.0pt;line-height:112%'>13.12. F</span>URTHER <span
style='font-size:18.0pt;line-height:112%'>R</span>EADING</h5>

<p class=MsoNormal style='margin-top:0in;margin-right:81.6pt;margin-bottom:
41.8pt;margin-left:75.95pt;text-indent:-29.3pt'><span style='font-size:24.0pt;
line-height:154%;font-family:"Calibri",sans-serif'>&#9758; </span>Many articles
about the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>pickle
</span>module make references to <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>cPickle</span>. In Python 2, there were two
implementations of the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>pickle </span>module, one written in pure Python
and another written in C (but still callable from Python). In Python 3, <u>these
two modules have been consolidated</u>, so you should always just <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>import
pickle</span>. You may find these articles useful, but you should ignore the
now-obsolete information about <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>cPickle</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
22.8pt;margin-left:16.4pt'>On pickling with the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>pickle </span>module:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.55pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://docs.python.org/3.1/library/pickle.html"><span style='font-size:
10.0pt;line-height:110%;font-family:"Liberation Mono";color:black'>pickle</span></a><u><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'> </span></u><a
href="http://docs.python.org/3.1/library/pickle.html"><span style='color:black'>module</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.1in;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://www.doughellmann.com/PyMOTW/pickle/"><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:black'>pickle</span></a><u><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'> </span></u><a
href="http://www.doughellmann.com/PyMOTW/pickle/"><span style='color:black'>and</span></a><u>
</u><a href="http://www.doughellmann.com/PyMOTW/pickle/"><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:black'>cPickle</span></a><u><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'> </span></u><a
href="http://www.doughellmann.com/PyMOTW/pickle/"><span style='color:black'>—</span></a><u>
</u><a href="http://www.doughellmann.com/PyMOTW/pickle/"><span
style='color:black'>Python</span></a><u> </u><a
href="http://www.doughellmann.com/PyMOTW/pickle/"><span style='color:black'>object</span></a><u>
</u><a href="http://www.doughellmann.com/PyMOTW/pickle/"><span
style='color:black'>serialization</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.55pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://wiki.python.org/moin/UsingPickle"><span style='color:black'>Using</span></a><u>
</u><a href="http://wiki.python.org/moin/UsingPickle"><span style='font-size:
10.0pt;line-height:110%;font-family:"Liberation Mono";color:black'>pickle</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:27.6pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://www.ibm.com/developerworks/library/l-pypers.html"><span
style='color:black'>Python</span></a><u> </u><a
href="http://www.ibm.com/developerworks/library/l-pypers.html"><span
style='color:black'>persistence</span></a><u> </u><a
href="http://www.ibm.com/developerworks/library/l-pypers.html"><span
style='color:black'>management</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.9pt;margin-left:16.4pt'>On <span style='font-size:9.5pt;line-height:154%'>JSON
</span>and the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>json
</span>module:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://www.doughellmann.com/PyMOTW/json/"><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:black'>json</span></a><u><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'> </span></u><a
href="http://www.doughellmann.com/PyMOTW/json/"><span style='color:black'>—</span></a><u>
</u><a href="http://www.doughellmann.com/PyMOTW/json/"><span style='color:black'>JavaScript</span></a><u>
</u><a href="http://www.doughellmann.com/PyMOTW/json/"><span style='color:black'>Object</span></a><u>
</u><a href="http://www.doughellmann.com/PyMOTW/json/"><span style='color:black'>Notation</span></a><u>
</u><a href="http://www.doughellmann.com/PyMOTW/json/"><span style='color:black'>Serializer</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:26.7pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://blog.quaternio.net/2009/07/16/json-encoding-and-decoding-with-custom-objects-in-python/"><span
style='color:black'>JSON</span></a><u> </u><a
href="http://blog.quaternio.net/2009/07/16/json-encoding-and-decoding-with-custom-objects-in-python/"><span
style='color:black'>encoding</span></a><u> </u><a
href="http://blog.quaternio.net/2009/07/16/json-encoding-and-decoding-with-custom-objects-in-python/"><span
style='color:black'>and</span></a><u> </u><a
href="http://blog.quaternio.net/2009/07/16/json-encoding-and-decoding-with-custom-objects-in-python/"><span
style='color:black'>ecoding</span></a><u> </u><a
href="http://blog.quaternio.net/2009/07/16/json-encoding-and-decoding-with-custom-objects-in-python/"><span
style='color:black'>with</span></a><u> </u><a
href="http://blog.quaternio.net/2009/07/16/json-encoding-and-decoding-with-custom-objects-in-python/"><span
style='color:black'>custom</span></a><u> </u><a
href="http://blog.quaternio.net/2009/07/16/json-encoding-and-decoding-with-custom-objects-in-python/"><span
style='color:black'>objects</span></a><u> </u><a
href="http://blog.quaternio.net/2009/07/16/json-encoding-and-decoding-with-custom-objects-in-python/"><span
style='color:black'>in</span></a><u> </u><a
href="http://blog.quaternio.net/2009/07/16/json-encoding-and-decoding-with-custom-objects-in-python/"><span
style='color:black'>Python</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>On pickle extensibility:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://docs.python.org/3.1/library/pickle.html#pickling-class-instances"><span
style='color:black'>Pickling</span></a><u> </u><a
href="http://docs.python.org/3.1/library/pickle.html#pickling-class-instances"><span
style='color:black'>class</span></a><u> </u><a
href="http://docs.python.org/3.1/library/pickle.html#pickling-class-instances"><span
style='color:black'>instances</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://docs.python.org/3.1/library/pickle.html#persistence-of-external-objects"><span
style='color:black'>Persistence</span></a><u> </u><a
href="http://docs.python.org/3.1/library/pickle.html#persistence-of-external-objects"><span
style='color:black'>of</span></a><u> </u><a
href="http://docs.python.org/3.1/library/pickle.html#persistence-of-external-objects"><span
style='color:black'>external</span></a><u> </u><a
href="http://docs.python.org/3.1/library/pickle.html#persistence-of-external-objects"><span
style='color:black'>objects</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://docs.python.org/3.1/library/pickle.html#handling-stateful-objects"><span
style='color:black'>Handling</span></a><u> </u><a
href="http://docs.python.org/3.1/library/pickle.html#handling-stateful-objects"><span
style='color:black'>stateful</span></a><u> </u><a
href="http://docs.python.org/3.1/library/pickle.html#handling-stateful-objects"><span
style='color:black'>objects</span></a><br clear=all style='page-break-before:
always'>
</p>

<h3 style='margin-top:0in;margin-right:22.2pt;margin-bottom:0in;margin-left:
16.4pt;line-height:107%'><span style='font-size:24.0pt;line-height:107%'>C</span><span
style='font-size:19.0pt;line-height:107%'>HAPTER </span><span style='font-size:
24.0pt;line-height:107%'>14. HTTP W</span><span style='font-size:19.0pt;
line-height:107%'>EB </span><span style='font-size:24.0pt;line-height:107%'>S</span><span
style='font-size:19.0pt;line-height:107%'>ERVICES</span></h3>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:39.95pt;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=736 height=4 id="Group 715381"
src="Dive%20Into%20Python%203_files/image001.gif"></span></p>

<p class=MsoNormal align=right style='margin-top:0in;margin-right:29.3pt;
margin-bottom:65.45pt;margin-left:350.25pt;text-align:right;line-height:160%'><span
style='font-size:13.0pt;line-height:160%;font-family:"Calibri",sans-serif'>&#10077;
</span><i>A ruffled mind makes a restless pillow. </i><span style='font-size:
13.0pt;line-height:160%;font-family:"Calibri",sans-serif'>&#10078; </span><i>—
Charlotte Brontë</i></p>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:66.65pt;margin-left:
16.4pt;line-height:110%'><span style='font-size:18.0pt;line-height:110%'>14.1.
D</span>IVING <span style='font-size:18.0pt;line-height:110%'>I</span>N</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
1.85pt;margin-left:16.4pt'><span style='font-size:48.0pt;line-height:154%;
font-family:"DejaVu Serif",serif;color:#888888'>P </span>hilosophically, I can
describe HTTP web services in 12 words: exchanging data with remote servers
using nothing but the operations of <span style='font-size:9.5pt;line-height:
154%'>HTTP</span>. If you want to get data from the server, use <span
style='font-size:9.5pt;line-height:154%'>HTTP </span><span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>GET</span>. If you want
to send new data to the server, use <span style='font-size:9.5pt;line-height:
154%'>HTTP </span><span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>POST</span>. Some more advanced <span style='font-size:9.5pt;
line-height:154%'>HTTP </span>web service <span style='font-size:9.5pt;
line-height:154%'>API</span>s also allow creating, modifying, and deleting
data, using <span style='font-size:9.5pt;line-height:154%'>HTTP </span><span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>PUT </span>and
<span style='font-size:9.5pt;line-height:154%'>HTTP </span><span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>DELETE</span>.
That’s it. No registries, no envelopes, no wrappers, no tunneling. The “verbs”
built into the <span style='font-size:9.5pt;line-height:154%'>HTTP </span>protocol
(<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>GET</span>,
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>POST</span>,
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>PUT</span>,
and</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.3in;margin-left:16.4pt'><span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>DELETE</span>) map directly to application-level
operations for retrieving, creating, modifying, and deleting data.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.95pt;margin-left:16.4pt'>The main advantage of this approach is simplicity,
and its simplicity has proven popular. Data — usually <u><span
style='font-size:9.5pt;line-height:154%'>XML </span></u>or <u><span
style='font-size:9.5pt;line-height:154%'>JSON </span></u>— can be built and
stored statically, or generated dynamically by a server-side script, and all
major programming languages (including Python, of course!) include an <span
style='font-size:9.5pt;line-height:154%'>HTTP </span>library for downloading
it. Debugging is also easier; because each resource in an <span
style='font-size:9.5pt;line-height:154%'>HTTP </span>web service has a unique
address (in the form of a <span style='font-size:9.5pt;line-height:154%'>URL</span>),
you can load it in your web browser and immediately see the raw data.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.3in;margin-left:16.4pt'>Examples of <span style='font-size:9.5pt;line-height:
154%'>HTTP </span>web services:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-12.25pt'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span><a href="http://code.google.com/apis/gdata/"><span style='color:black'>Google</span></a><u>
</u><a href="http://code.google.com/apis/gdata/"><span style='color:black'>Data</span></a><u>
</u><a href="http://code.google.com/apis/gdata/"><span style='font-size:9.5pt;
line-height:154%;color:black'>API</span></a><a
href="http://code.google.com/apis/gdata/"><span style='color:black'>s</span></a><u>
</u>allow you to interact with a wide variety of Google services, including <a
href="http://www.blogger.com/"><span style='color:black'>Blogger</span></a><u> </u>and
<a href="http://www.youtube.com/"><span style='color:black'>YouTube</span></a>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.1pt;margin-left:16.65pt;text-indent:-12.25pt;line-height:107%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://www.flickr.com/services/api/"><span style='color:black'>Flickr</span></a><u>
</u><a href="http://www.flickr.com/services/api/"><span style='color:black'>Services</span></a><u>
</u>allow you to upload and download photos from <a
href="http://www.flickr.com/"><span style='color:black'>Flickr</span></a>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-12.25pt;line-height:107%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://apiwiki.twitter.com/"><span style='color:black'>Twitter</span></a><u>
</u><a href="http://apiwiki.twitter.com/"><span style='font-size:9.5pt;
line-height:107%;color:black'>API</span></a><u><span style='font-size:9.5pt;
line-height:107%'> </span></u>allows you to publish status updates on <a
href="http://twitter.com/"><span style='color:black'>Twitter</span></a>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
26.85pt;margin-left:16.65pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://www.programmableweb.com/apis/directory/1?sort=mashups"><span
style='color:black'>…and</span></a><u> </u><a
href="http://www.programmableweb.com/apis/directory/1?sort=mashups"><span
style='color:black'>many</span></a><u> </u><a
href="http://www.programmableweb.com/apis/directory/1?sort=mashups"><span
style='color:black'>more</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>Python 3 comes with two different
libraries for interacting with <span style='font-size:9.5pt;line-height:107%'>HTTP
</span>web services:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
7.15pt;margin-left:16.65pt;text-indent:-12.25pt;line-height:107%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://docs.python.org/3.1/library/http.client.html"><span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono";
color:black'>http.client</span></a><u><span style='font-size:10.0pt;line-height:
107%;font-family:"Liberation Mono"'> </span></u>is a low-level library that
implements <a href="http://www.w3.org/Protocols/rfc2616/rfc2616.html"><span
style='font-size:9.5pt;line-height:107%;color:black'>RFC</span></a><u><span
style='font-size:9.5pt;line-height:107%'> </span></u><a
href="http://www.w3.org/Protocols/rfc2616/rfc2616.html"><span style='color:
black'>2616</span></a>, the <span style='font-size:9.5pt;line-height:107%'>HTTP
</span>protocol.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.9pt;margin-left:16.65pt;text-indent:-12.25pt'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span><a href="http://docs.python.org/3.1/library/urllib.request.html"><span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono";
color:black'>urllib.request</span></a><u><span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'> </span></u>is an abstraction
layer built on top of <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>http.client</span>. It provides a standard <span
style='font-size:9.5pt;line-height:154%'>API </span>for accessing both <span
style='font-size:9.5pt;line-height:154%'>HTTP </span>and <span
style='font-size:9.5pt;line-height:154%'>FTP </span>servers, automatically
follows <span style='font-size:9.5pt;line-height:154%'>HTTP </span>redirects,
and handles some common forms of <span style='font-size:9.5pt;line-height:154%'>HTTP
</span>authentication.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.7pt;margin-left:16.4pt'>So which one should you use? Neither of them.
Instead, you should use <a href="http://code.google.com/p/httplib2/"><span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono";
color:black'>httplib2</span></a>, an open source thirdparty library that
implements <span style='font-size:9.5pt;line-height:154%'>HTTP </span>more
fully than <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>http.client
</span>but provides a better abstraction than <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>urllib.request</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
46.65pt;margin-left:16.4pt'>To understand why <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>httplib2 </span>is the right
choice, you first need to understand <span style='font-size:9.5pt;line-height:
154%'>HTTP</span>.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:33.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:17.4pt;margin-left:
16.4pt;line-height:110%'><span style='font-size:18.0pt;line-height:110%'>14.2.
F</span>EATURES OF <span style='font-size:18.0pt;line-height:110%'>HTTP</span></h4>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
22.6pt;margin-left:16.4pt'>There are five important features which all <span
style='font-size:9.5pt;line-height:154%'>HTTP </span>clients should support.</p>

<h5 style='margin-top:0in;margin-right:0in;margin-bottom:23.55pt;margin-left:
16.4pt;line-height:121%'><span style='font-size:13.0pt;line-height:121%'>14.2.1.
C</span><span style='font-size:10.5pt;line-height:121%'>ACHING</span></h5>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>The most important thing to understand about any type
of web service is that network access is incredibly expensive. I don’t mean
“dollars and cents” expensive (although bandwidth ain’t free). I mean that it
takes an extraordinary long time to open a connection, send a request, and
retrieve a response from a remote server. Even on the fastest broadband
connection, <i>latency </i>(the time it takes to send a request and start
retrieving data in a response) can still be higher than you anticipated. A
router misbehaves, a packet is dropped, an intermediate proxy is under attack —
there’s <a href="http://isc.sans.org/"><span style='color:black'>never</span></a><u>
</u><a href="http://isc.sans.org/"><span style='color:black'>a</span></a><u> </u><a
href="http://isc.sans.org/"><span style='color:black'>dull</span></a><u> </u><a
href="http://isc.sans.org/"><span style='color:black'>moment</span></a><u> </u>on
the public internet, and there may be nothing you can do about it.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:36.8pt;margin-bottom:
20.6pt;margin-left:16.65pt;text-align:justify;text-justify:inter-ideograph;
text-indent:0in;line-height:155%'><img width=298 height=1
src="Dive%20Into%20Python%203_files/image033.gif" align=left hspace=12><span
style='font-size:9.5pt;line-height:155%'>HTTP </span>is designed with caching
in mind. There is an entire class of devices (called “caching proxies”) whose
only job is to sit between you and the rest of the world and minimize network
access. Your company or <span style='font-size:9.5pt;line-height:155%'>ISP </span>almost
certainly maintains caching proxies, even if you’re unaware of them. They work
because caching built into the <span style='font-size:9.5pt;line-height:155%'>HTTP
</span>protocol.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.0pt;margin-left:16.4pt'>Here’s a concrete example of how caching works. You
visit <a href="http://diveintomark.org/"><span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono";color:black'>diveintomark.org</span></a><u><span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'> </span></u>in
your browser. That page includes a background image, <a
href="http://wearehugh.com/m.jpg"><span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono";color:black'>wearehugh.com/m.jpg</span></a>.
When your browser downloads that image, the server includes the following <span
style='font-size:9.5pt;line-height:154%'>HTTP </span>headers:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.0pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>HTTP/1.1 200 OK Date: Sun, 31
May 2009 17:14:04 GMT</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.0pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>Server: Apache Last-Modified:
Fri, 22 Aug 2008 04:28:16 GMT</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.0pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>ETag: &quot;3075-ddc8d800&quot;
Accept-Ranges: bytes</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.0pt;margin-bottom:
54.8pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono"'>Content-Length: 12405</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.5pt;
margin-left:37.9pt;line-height:110%;background:gainsboro'><b><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>Cache-Control:
max-age=31536000, publicExpires: Mon, 31 May 2010 17:14:04 GMT</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>Connection: close</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.75pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>Content-Type: image/jpeg</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.55pt;margin-left:16.4pt'>The <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>Cache-Control </span>and <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>Expires </span>headers
tell your browser (and any caching proxies between you and the server) that
this image can be cached for up to a year. <i>A year! </i>And if, in the next
year, you visit another page which also includes a link to this image, your
browser will load the image from its cache <i>without generating any network
activity whatsoever</i>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.1pt;margin-left:16.4pt;line-height:107%'>But wait, it gets better. Let’s say
your browser purges the image from your local cache for some reason.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:20.45pt;
margin-left:16.65pt;text-align:justify;text-justify:inter-ideograph;text-indent:
0in;line-height:155%'>Maybe it ran out of disk space; maybe you manually
cleared the cache. Whatever. But the <span style='font-size:9.5pt;line-height:
155%'>HTTP </span>headers said that this data could be cached by public caching
proxies. (Technically, the important thing is what the headers <i>don’t </i>say;
the <span style='font-size:10.0pt;line-height:155%;font-family:"Liberation Mono"'>Cache-Control
</span>header doesn’t have the <span style='font-size:10.0pt;line-height:155%;
font-family:"Liberation Mono"'>private </span>keyword, so this data is
cacheable by default.) Caching proxies are designed to have tons of storage
space, probably far more than your local browser has allocated.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.7pt;margin-left:16.4pt'>If your company or <span style='font-size:9.5pt;
line-height:154%'>ISP </span>maintain a caching proxy, the proxy may still have
the image cached. When you visit <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>diveintomark.org </span>again, your browser
will look in its local cache for the image, but it won’t find it, so it will
make a network request to try to download it from the remote server. But if the
caching proxy still has a copy of the image, it will intercept that request and
serve the image from <i>its </i>cache. That means that your request will never
reach the remote server; in fact, it will never leave your company’s network.
That makes for a faster download (fewer network hops) and saves your company
money (less data being downloaded from the outside world).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.2pt;margin-left:16.4pt'><span style='font-size:9.5pt;line-height:154%'>HTTP </span>caching
only works when everybody does their part. On one side, servers need to send
the correct headers in their response. On the other side, clients need to
understand and respect those headers before they request the same data twice.
The proxies in the middle are not a panacea; they can only be as smart as the
servers and clients allow them to be.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
23.0pt;margin-left:16.4pt'>Python’s <span style='font-size:9.5pt;line-height:
154%'>HTTP </span>libraries do not support caching, but <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>httplib2 </span>does.</p>

<h6 style='margin-left:16.4pt'><span style='font-size:13.0pt;line-height:110%'>14.2.2.
L</span>AST<span style='font-size:13.0pt;line-height:110%'>-M</span>ODIFIED <span
style='font-size:13.0pt;line-height:110%'>C</span>HECKING</h6>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>Some data never changes, while other data changes all
the time. In between, there is a vast field of data that <i>might </i>have
changed, but hasn’t. CNN.com’s feed is updated every few minutes, but my
weblog’s feed may not change for days or weeks at a time. In the latter case, I
don’t want to tell clients to cache my feed for weeks at a time, because then
when I do actually post something, people may not read it for weeks (because
they’re respecting my cache headers which said “don’t bother checking this feed
for weeks”). On the other hand, I don’t want clients downloading my entire feed
once an hour if it hasn’t changed!</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
18.85pt;margin-left:16.4pt'><img width=298 height=1
src="Dive%20Into%20Python%203_files/image033.gif" align=left hspace=12><span
style='font-size:9.5pt;line-height:154%'>HTTP </span>has a solution to this,
too. When you request data for the first time, the server can send back a <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>LastModified
</span>header. This is exactly what it sounds like: the date that the data was
changed. That background image referenced from <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>diveintomark.org </span>included
a <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>LastModified
</span>header.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.0pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>HTTP/1.1 200 OK Date: Sun, 31
May 2009 17:14:04 GMT</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:181.7pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>Server: Apache <b><span
style='background:gainsboro'>Last-Modified: Fri, 22 Aug 2008 04:28:16 GMT</span></b></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.0pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>ETag: &quot;3075-ddc8d800&quot;
Accept-Ranges: bytes</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.0pt;margin-bottom:
8.25pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono"'>Content-Length: 12405</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.0pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>Cache-Control:
max-age=31536000, public Expires: Mon, 31 May 2010 17:14:04 GMT Connection:
close</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.0pt;margin-bottom:
31.05pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono"'>Content-Type: image/jpeg</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.0pt;margin-left:16.4pt'>When you request the same data a second (or third or
fourth) time, you can send an <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>If-Modified-Since </span>header with your
request, with the date you got back from the server last time. If the data has
changed since then, then the server ignores the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>If-ModifiedSince </span>header
and just gives you the new data with a <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>200 </span>status code. But if
the data <i>hasn’t </i>changed since then, the server sends back a special <span
style='font-size:9.5pt;line-height:154%'>HTTP </span><span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>304 </span>status code,
which means “this data hasn’t changed since the last time you asked for it.”
You can test this on the command line, using <a href="http://curl.haxx.se/"><span
style='color:black'>curl</span></a>:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-.05in;margin-bottom:
8.75pt;margin-left:37.9pt;line-height:107%'><span style='font-size:10.0pt;
line-height:107%;font-family:"Liberation Mono";color:#666677'>you@localhost:~$ </span><span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>curl -I
<b><span style='background:gainsboro'>-H &quot;If-Modified-Since: Fri, 22 Aug
2008 04:28:16 GMT&quot; </span></b>http://wearehug</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:350.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>HTTP/1.1 304 Not Modified Date:
Sun, 31 May 2009 18:04:39 GMT Server: Apache</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>Connection: close</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>ETag: &quot;3075-ddc8d800&quot;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>Expires: Mon, 31 May 2010 18:04:39 GMT</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>Cache-Control: max-age=31536000, public</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
17.9pt;margin-left:16.4pt;line-height:181%'>Why is this an improvement? Because
when the server sends a <span style='font-size:10.0pt;line-height:181%;
font-family:"Liberation Mono"'>304</span>, <i>it doesn’t re-send the data</i>.
All you get is the status code. Even after your cached copy has expired,
last-modified checking ensures that you won’t download the same data twice if
it hasn’t changed. (As an extra bonus, this <span style='font-size:10.0pt;
line-height:181%;font-family:"Liberation Mono"'>304 </span>response also
includes caching headers. Proxies will keep a copy of data even after it
officially “expires,” in the hopes that the data hasn’t <i>really </i>changed
and the next request responds with a <span style='font-size:10.0pt;line-height:
181%;font-family:"Liberation Mono"'>304 </span>status code and updated cache
information.) Python’s <span style='font-size:9.5pt;line-height:181%'>HTTP </span>libraries
do not support last-modified date checking, but <span style='font-size:10.0pt;
line-height:181%;font-family:"Liberation Mono"'>httplib2 </span>does.</p>

<h5 style='margin-top:0in;margin-right:0in;margin-bottom:23.55pt;margin-left:
16.4pt;line-height:121%'><span style='font-size:13.0pt;line-height:121%'>14.2.3.
ET</span><span style='font-size:10.5pt;line-height:121%'>AG </span><span
style='font-size:13.0pt;line-height:121%'>C</span><span style='font-size:10.5pt;
line-height:121%'>HECKING</span></h5>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.0pt;margin-left:16.4pt'>ETags are an alternate way to accomplish the same
thing as the <u>last-modified checking</u>. With Etags, the server sends a hash
code in an <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>ETag
</span>header along with the data you requested. (Exactly how this hash is
determined is entirely up to the server. The only requirement is that it
changes when the data changes.) That background image referenced from <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>diveintomark.org
</span>had an <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>ETag
</span>header.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:350.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>HTTP/1.1 200 OK Date: Sun, 31
May 2009 17:14:04 GMT</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:296.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>Server: Apache Last-Modified:
Fri, 22 Aug 2008 04:28:16 GMT</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:350.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><b><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";background:gainsboro'>ETag:
&quot;3075-ddc8d800&quot; </span></b><span style='font-size:10.0pt;line-height:
185%;font-family:"Liberation Mono"'>Accept-Ranges: bytes</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>Content-Length: 12405</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:278.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>Cache-Control:
max-age=31536000, public Expires: Mon, 31 May 2010 17:14:04 GMT Connection:
close</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>Content-Type: image/jpeg</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.3pt;margin-left:16.4pt'><img width=298 height=1
src="Dive%20Into%20Python%203_files/image033.gif" align=left hspace=12>The
second time you request the same data, you include the ETag hash in an <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>If-None-Match
</span>header of your request. If the data hasn’t changed, the server will send
you back a <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>304
</span>status code. As with the last-modified date checking, the server sends
back <i>only </i>the <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>304 </span>status code; it doesn’t send you the same data a
second time. By including the ETag hash in your second request, you’re telling
the server that there’s no need to re-send the same data if it still matches
this hash, since <u>you still have the data from the last time</u>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.05in;margin-bottom:0in;
margin-left:38.2pt;text-indent:-21.55pt;line-height:1226%'>Again with the <span
style='font-size:10.0pt;line-height:1226%;font-family:"Liberation Mono"'>curl</span>:
<span style='font-size:10.0pt;line-height:1226%;font-family:"Liberation Mono";
color:#666677'>you@localhost:~$ </span><span style='font-size:10.0pt;
line-height:1226%;font-family:"Liberation Mono"'>curl -I <b><span
style='background:gainsboro'>-H &quot;If-None-Match:
\&quot;3075-ddc8d800\&quot;&quot; </span></b>http://wearehugh.com/m.jpg </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:350.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>HTTP/1.1 304 Not Modified Date:
Sun, 31 May 2009 18:04:39 GMT Server: Apache</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>Connection: close</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>ETag: &quot;3075-ddc8d800&quot;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>Expires: Mon, 31 May 2010 18:04:39 GMT</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>Cache-Control: max-age=31536000, public</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.2pt;margin-left:16.65pt;text-indent:-16.65pt'>1.   ETags are commonly
enclosed in quotation marks, but <i>the quotation marks are part of the value</i>.
That means you need to send the quotation marks back to the server in the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>If-None-Match
</span>header.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>Python’s <span style='font-size:
9.5pt;line-height:107%'>HTTP </span>libraries do not support ETags, but <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>httplib2
</span>does.</p>

<h6 style='margin-left:16.4pt'><span style='font-size:13.0pt;line-height:110%'>14.2.4.
C</span>OMPRESSION</h6>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.7pt;margin-left:16.4pt'>When you talk about <span style='font-size:9.5pt;
line-height:154%'>HTTP </span>web services, you’re almost always talking about
moving text-based data back and forth over the wire. Maybe it’s <span
style='font-size:9.5pt;line-height:154%'>XML</span>, maybe it’s <span
style='font-size:9.5pt;line-height:154%'>JSON</span>, maybe it’s just <u>plain
text</u>. Regardless of the format, text compresses well. The example feed in <u>the
XML chapter </u>is 3070 bytes uncompressed, but would be 941 bytes after gzip
compression. That’s just 30% of the original size!</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
46.9pt;margin-left:16.4pt'><span style='font-size:9.5pt;line-height:154%'>HTTP </span>supports
<a href="http://www.iana.org/assignments/http-parameters"><span
style='color:black'>several</span></a><u> </u><a
href="http://www.iana.org/assignments/http-parameters"><span style='color:black'>compression</span></a><u>
</u><a href="http://www.iana.org/assignments/http-parameters"><span
style='color:black'>algorithms</span></a>. The two most common types are <a
href="http://www.ietf.org/rfc/rfc1952.txt"><span style='color:black'>gzip</span></a><u>
</u>and <a href="http://www.ietf.org/rfc/rfc1951.txt"><span style='color:black'>deflate</span></a>.
When you request a resource over <span style='font-size:9.5pt;line-height:154%'>HTTP</span>,
you can ask the server to send it in compressed format. You include an <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>Accept-encoding
</span>header in your request that lists which compression algorithms you
support. If the server supports any of the same algorithms, it will send you
back compressed data (with a <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>Content-encoding </span>header that tells you
which algorithm it used). Then it’s up to you to decompress the data.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:79.75pt;margin-bottom:
41.8pt;margin-left:75.95pt;text-indent:-29.3pt'><span style='font-size:24.0pt;
line-height:154%;font-family:"Calibri",sans-serif'>&#9758; </span>Important tip
for server-side developers: make sure that the compressed version of a resource
has a different <u>Etag </u>than the uncompressed version. Otherwise, caching
proxies will get confused and may serve the compressed version to clients that
can’t handle it. Read the discussion of <a
href="https://issues.apache.org/bugzilla/show_bug.cgi?id=39727"><span
style='color:black'>Apache</span></a><u> </u><a
href="https://issues.apache.org/bugzilla/show_bug.cgi?id=39727"><span
style='color:black'>bug</span></a><u> </u><a
href="https://issues.apache.org/bugzilla/show_bug.cgi?id=39727"><span
style='color:black'>39727</span></a><u> </u>for more details on this subtle
issue.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
22.75pt;margin-left:16.4pt'>Python’s <span style='font-size:9.5pt;line-height:
154%'>HTTP </span>libraries do not support compression, but <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>httplib2
</span>does.</p>

<h6 style='margin-left:16.4pt'><span style='font-size:13.0pt;line-height:110%'>14.2.5.
R</span>EDIRECTS</h6>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'><a href="http://www.w3.org/Provider/Style/URI"><span
style='color:black'>Cool</span></a><u> </u><a
href="http://www.w3.org/Provider/Style/URI"><span style='font-size:9.5pt;
line-height:154%;color:black'>URI</span></a><a
href="http://www.w3.org/Provider/Style/URI"><span style='color:black'>s</span></a><u>
</u><a href="http://www.w3.org/Provider/Style/URI"><span style='color:black'>don’t</span></a><u>
</u><a href="http://www.w3.org/Provider/Style/URI"><span style='color:black'>change</span></a>,
but many <span style='font-size:9.5pt;line-height:154%'>URI</span>s are
seriously uncool. Web sites get reorganized, pages move to new addresses. Even
web services can reorganize. A syndicated feed at <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>http://example.com/index.xml </span>might
be moved to <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>http://example.com/xml/atom.xml</span>.
Or an entire domain might move, as an organization expands and reorganizes; <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>http://www.example.com/index.xml
</span>becomes <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>http://serverfarm-1.example.com/index.xml</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.8pt;margin-left:16.4pt'><img width=298 height=1
src="Dive%20Into%20Python%203_files/image033.gif" align=left hspace=12>Every
time you request any kind of resource from an <span style='font-size:9.5pt;
line-height:154%'>HTTP </span>server, the server includes a status code in its
response. Status code <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>200 </span>means “everything’s normal, here’s
the page you asked for”. Status code <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>404 </span>means “page not found”. (You’ve
probably seen 404 errors while browsing the web.) Status codes in the 300’s
indicate some form of redirection.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'><span style='font-size:9.5pt;line-height:154%'>HTTP </span>has
several different ways of signifying that a resource has moved. The two most
common techiques are status codes <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>302 </span>and <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>301</span>. Status code <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>302 </span>is
a <i>temporary redirect</i>; it means “oops, that got moved over here
temporarily” (and then gives the temporary address in a <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>Location </span>header).
Status code <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>301
</span>is a <i>permanent redirect</i>; it means “oops, that got moved
permanently”</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.25pt;margin-left:16.4pt;line-height:107%'>(and then gives the new address in
a <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>Location
</span>header).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.05pt;margin-left:16.4pt'>If you get a <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>302 </span>status code and a
new address, the <span style='font-size:9.5pt;line-height:154%'>HTTP </span>specification
says you should use the new address to get what you asked for, but the next
time you want to access the same resource, you should retry the old address.
But if you get a <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>301 </span>status code and a new address, you’re supposed to
use the new address from then on.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.85pt;margin-left:16.4pt'>The <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>urllib.request </span>module automatically
“follow” redirects when it receives the appropriate status code from the <span
style='font-size:9.5pt;line-height:154%'>HTTP </span>server, but it doesn’t
tell you that it did so. You’ll end up getting data you asked for, but you’ll
never know that the underlying library “helpfully” followed a redirect for you.
So you’ll continue pounding away at the old address, and each time you’ll get
redirected to the new address, and each time the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>urllib.request </span>module
will “helpfully” follow the redirect. In other words, it treats permanent
redirects the same as temporary redirects. That means two round trips instead
of one, which is bad for the server and bad for you.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
45.7pt;margin-left:16.4pt'><span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>httplib2 </span>handles permanent redirects for
you. Not only will it tell you that a permanent redirect occurred, it will keep
track of them locally and automatically rewrite redirected <span
style='font-size:9.5pt;line-height:154%'>URL</span>s before requesting them.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:33.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h5 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>14.3.
H</span>OW <span style='font-size:18.0pt;line-height:112%'>N</span>OT <span
style='font-size:18.0pt;line-height:112%'>T</span>O <span style='font-size:
18.0pt;line-height:112%'>F</span>ETCH <span style='font-size:18.0pt;line-height:
112%'>D</span>ATA <span style='font-size:18.0pt;line-height:112%'>O</span>VER <span
style='font-size:18.0pt;line-height:112%'>HTTP</span></h5>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.05pt;margin-left:16.4pt'>Let’s say you want to download a resource over <span
style='font-size:9.5pt;line-height:154%'>HTTP</span>, such as <u>an Atom feed</u>.
Being a feed, you’re not just going to download it once; you’re going to
download it over and over again. (Most feed readers will check for changes once
an hour.) Let’s do it the quick-and-dirty way first, and then see how you can
do better.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>import
urllib.request</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>a_url =
'http://diveintopython3.org/examples/feed.xml'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>data =
urllib.request.urlopen(a_url).read() </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>type(data)                                   </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:452.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>&lt;class 'bytes'&gt; </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
185%;font-family:"Liberation Mono"'>print(data)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:224.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>&lt;?xml version='1.0'
encoding='utf-8'?&gt; &lt;feed xmlns='http://www.w3.org/2005/Atom'
xml:lang='en'&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;title&gt;dive into mark&lt;/title&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;subtitle&gt;currently between
addictions&lt;/subtitle&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;id&gt;tag:diveintomark.org,2001-07-29:/&lt;/id&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
0in;margin-left:50.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>&lt;updated&gt;2009-03-27T21:56:07Z&lt;/updated&gt;
&lt;link rel='alternate' type='text/html' href='http://diveintomark.org/'/&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.65pt;
margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>…</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Downloading anything over <span style='font-size:9.5pt;line-height:154%'>HTTP
</span>is incredibly easy in Python; in fact, it’s a one-liner. The <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>urllib.request
</span>module has a handy <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>urlopen() </span>function that takes the address
of the page you want, and returns a file-like object that you can just <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>read() </span>from
to get the full contents of the page. It just can’t get any easier.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.55pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>urlopen().read()
</span>method always returns <u>a </u><u><span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>bytes </span>object, not a
string</u>. Remember, bytes are bytes; characters are an abstraction. <span
style='font-size:9.5pt;line-height:154%'>HTTP </span>servers don’t deal in
abstractions. If you request a resource, you get bytes. If you want it as a
string, you’ll need to <a
href="http://feedparser.org/docs/character-encoding.html"><span
style='color:black'>determine</span></a><u> </u><a
href="http://feedparser.org/docs/character-encoding.html"><span
style='color:black'>the</span></a><u> </u><a
href="http://feedparser.org/docs/character-encoding.html"><span
style='color:black'>character</span></a><u> </u><a
href="http://feedparser.org/docs/character-encoding.html"><span
style='color:black'>encoding</span></a><u> </u>and explicitly convert it to a
string.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>So what’s wrong with this? For a quick one-off during
testing or development, there’s nothing wrong with it. I do it all the time. I
wanted the contents of the feed, and I got the contents of the feed. The same
technique works for any web page. But once you start thinking in terms of a web
service that you want to access on a regular basis (<i>e.g. </i>requesting this
feed once an hour), then you’re being inefficient, and you’re being rude.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:33.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:17.4pt;
margin-left:16.4pt;line-height:110%'><b><span style='font-size:18.0pt;
line-height:110%;font-family:"DejaVu Serif",serif'>14.4. W</span></b><b><span
style='font-size:14.5pt;line-height:110%;font-family:"DejaVu Serif",serif'>HAT</span></b><b><span
style='font-size:18.0pt;line-height:110%;font-family:"DejaVu Serif",serif'>’</span></b><b><span
style='font-size:14.5pt;line-height:110%;font-family:"DejaVu Serif",serif'>S </span></b><b><span
style='font-size:18.0pt;line-height:110%;font-family:"DejaVu Serif",serif'>O</span></b><b><span
style='font-size:14.5pt;line-height:110%;font-family:"DejaVu Serif",serif'>N </span></b><b><span
style='font-size:18.0pt;line-height:110%;font-family:"DejaVu Serif",serif'>T</span></b><b><span
style='font-size:14.5pt;line-height:110%;font-family:"DejaVu Serif",serif'>HE </span></b><b><span
style='font-size:18.0pt;line-height:110%;font-family:"DejaVu Serif",serif'>W</span></b><b><span
style='font-size:14.5pt;line-height:110%;font-family:"DejaVu Serif",serif'>IRE</span></b><b><span
style='font-size:18.0pt;line-height:110%;font-family:"DejaVu Serif",serif'>?</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.05pt;margin-left:16.4pt'>To see why this is inefficient and rude, let’s turn
on the debugging features of Python’s <span style='font-size:9.5pt;line-height:
154%'>HTTP </span>library and see what’s being sent “on the wire” (<i>i.e. </i>over
the network).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>from
http.client import HTTPConnection</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>HTTPConnection.debuglevel = 1                                       </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>from
urllib.request import urlopen</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:87.65pt;margin-bottom:
0in;margin-left:37.9pt;line-height:180%'><span style='font-size:10.0pt;
line-height:180%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:180%;font-family:"Liberation Mono"'>response
= urlopen('http://diveintopython3.org/examples/feed.xml') </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313; </span><span
style='font-size:10.0pt;line-height:180%;font-family:"Liberation Mono"'>send:
b'GET /examples/feed.xml HTTP/1.1   </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.8pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>Host:
diveintopython3.org                                               </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.8pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>Accept-Encoding:
identity                                               </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9316;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>User-Agent:
Python-urllib/3.1'                                          </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9317;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:326.45pt;margin-bottom:
23.0pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>Connection: close reply:
'HTTP/1.1 200 OK' …further debugging information omitted…</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>As I mentioned at the beginning of the chapter, <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>urllib.request </span>relies
on another standard Python library, <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>http.client</span>. Normally you don’t need
to touch <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>http.client
</span>directly. (The <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>urllib.request </span>module imports it
automatically.) But we import it here so we can toggle the debugging flag on
the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>HTTPConnection
</span>class that <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>urllib.request </span>uses to connect to the <span
style='font-size:9.5pt;line-height:154%'>HTTP </span>server.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.15pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:155%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Now that the
debugging flag is set, information on the <span style='font-size:9.5pt;
line-height:155%'>HTTP </span>request and response is printed out in real time.
As you can see, when you request the Atom feed, the <span style='font-size:
10.0pt;line-height:155%;font-family:"Liberation Mono"'>urllib.request </span>module
sends five lines to the server.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The first line
specifies the <span style='font-size:9.5pt;line-height:107%'>HTTP </span>verb
you’re using, and the path of the resource (minus the domain name).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The second line
specifies the domain name from which we’re requesting this feed.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The third line specifies the compression algorithms that the client
supports. As I mentioned earlier, <u><span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>urllib.request </span>does not support
compression </u>by default.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>6.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The fourth line specifies the name of the library that is making the
request. By default, this is <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>Python-urllib </span>plus a version number. Both
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>urllib.request
</span>and <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>httplib2
</span>support changing the user agent, simply by adding a <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>User-Agent
</span>header to the request (which will override the default value).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:282.25pt;margin-bottom:
.25pt;margin-left:16.4pt'>Now let’s look at what the server sent back in its
response.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:345.15pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=300 height=562 src="Dive%20Into%20Python%203_files/image050.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'># continued from previous example</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=390
 style='width:292.8pt;margin-left:38.15pt;border-collapse:collapse'>
 <tr style='height:18.3pt'>
  <td width=376 valign=top style='width:282.05pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono";
  color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
  107%;font-family:"Liberation Mono"'>print(response.headers.as_string())</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9312;</span></p>
  </td>
 </tr>
 <tr style='height:43.5pt'>
  <td width=376 valign=top style='width:282.05pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>Date: Sun, 31 May 2009
  19:23:06 GMT</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>Server:
  Apache</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9313;</span></p>
  </td>
 </tr>
 <tr style='height:22.5pt'>
  <td width=376 valign=top style='width:282.05pt;padding:0in 0in 0in 0in;
  height:22.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>Last-Modified:
  Sun, 31 May 2009 06:39:55 GMT</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:22.5pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9314;</span></p>
  </td>
 </tr>
 <tr style='height:43.5pt'>
  <td width=376 valign=top style='width:282.05pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>ETag:
  &quot;bfe-93d9c4c0&quot;</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>Accept-Ranges:
  bytes</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9315;</span></p>
  </td>
 </tr>
 <tr style='height:22.5pt'>
  <td width=376 valign=top style='width:282.05pt;padding:0in 0in 0in 0in;
  height:22.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>Content-Length:
  3070</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:22.5pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9316;</span></p>
  </td>
 </tr>
 <tr style='height:106.5pt'>
  <td width=376 valign=top style='width:282.05pt;padding:0in 0in 0in 0in;
  height:106.5pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:54.05pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:185%'><span style='font-size:
  10.0pt;line-height:185%;font-family:"Liberation Mono"'>Cache-Control:
  max-age=86400 Expires: Mon, 01 Jun 2009 19:23:06 GMT</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:90.05pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:185%'><span style='font-size:
  10.0pt;line-height:185%;font-family:"Liberation Mono"'>Vary: Accept-Encoding
  Connection: close</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>Content-Type:
  application/xml</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:106.5pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9317;</span></p>
  </td>
 </tr>
 <tr style='height:60.3pt'>
  <td width=376 valign=bottom style='width:282.05pt;padding:0in 0in 0in 0in;
  height:60.3pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>data
  = response.read()</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>len(data)</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>3070</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:60.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9318;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>response
</span>returned from the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>urllib.request.urlopen() </span>function
contains all the <span style='font-size:9.5pt;line-height:154%'>HTTP </span>headers
the server sent back. It also contains methods to download the actual data;
we’ll get to that in a minute.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.95pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The server tells
you when it handled your request.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.35pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>This response
includes a <u><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>Last-Modified
</span></u>header.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.6pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>This response
includes an <u><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>ETag
</span></u>header.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The data is 3070 bytes long. Notice what <i>isn’t </i>here: a <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>Content-encoding
</span>header. Your request stated that you only accept uncompressed data (<span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>Accept-encoding:
identity</span>), and sure enough, this response contains uncompressed data.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>6.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>This response includes caching headers that state that this feed can be
cached for up to 24 hours (86400 seconds).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.55pt;margin-left:16.65pt;text-indent:-16.65pt'>7.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>And finally, download the actual data by calling <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>response.read()</span>.
As you can tell from the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>len() </span>function, this downloads all 3070
bytes at once.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>As you can see, this code is already inefficient: it
asked for (and received) uncompressed data. I know for a fact that this server
supports <u>gzip compression</u>, but <span style='font-size:9.5pt;line-height:
154%'>HTTP </span>compression is opt-in. We didn’t ask for it, so we didn’t get
it. That means we’re downloading 3070 bytes when we could have just downloaded
941. Bad dog, no biscuit.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.9pt;margin-left:16.4pt'>But wait, it gets worse! To see just how inefficient
this code is, let’s request the same feed a second time.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'># continued from the previous example</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:134.45pt;margin-bottom:
22.55pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>response2
= urlopen('http://diveintopython3.org/examples/feed.xml') send: b'GET
/examples/feed.xml HTTP/1.1 Host: diveintopython3.org Accept-Encoding: identity
User-Agent: Python-urllib/3.1' Connection: close reply: 'HTTP/1.1 200 OK'
…further debugging information omitted…</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.5pt;margin-left:16.4pt'>Notice anything peculiar about this request? It
hasn’t changed! It’s exactly the same as the first request. No sign of <u><span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>If-Modified-Since
</span>headers</u>. No sign of <u><span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>If-None-Match </span>headers</u>. No
respect for the caching headers. Still no compression.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>And what happens when you do the
same thing twice? You get the same response. Twice.<br clear=all
style='page-break-before:always'>
</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'># continued from the previous example</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>print(response2.headers.as_string())     </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>Date: Mon, 01 Jun 2009 03:58:00 GMT</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:296.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>Server: Apache Last-Modified:
Sun, 31 May 2009 22:51:11 GMT ETag: &quot;bfe-255ef5c0&quot; Accept-Ranges:
bytes Content-Length: 3070</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:332.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>Cache-Control: max-age=86400
Expires: Tue, 02 Jun 2009 03:58:00 GMT</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:368.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>Vary: Accept-Encoding
Connection: close</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>Content-Type: application/xml</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.5pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>data2 =
response2.read()</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>len(data2)                               </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.55pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>3070</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>data2 == data                            </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.75pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>True</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:7.3pt;
margin-left:0in;text-indent:0in;line-height:107%'>1.          The server is
still sending the same array of “smart” headers: <span style='font-size:10.0pt;
line-height:107%;font-family:"Liberation Mono"'>Cache-Control </span>and <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>Expires
</span>to allow caching,</p>

<p class=MsoNormal style='margin-top:0in;margin-right:35.4pt;margin-bottom:
.25pt;margin-left:0in;text-indent:16.65pt'><span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>Last-Modified </span>and <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>ETag </span>to
enable “not-modified” tracking. Even the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>Vary: Accept-Encoding </span>header
hints that the server would support compression, if only you would ask for it.
But you didn’t. 2.         Once again, fetching this data downloads the whole
3070 bytes…</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:21.95pt;
margin-left:0in;text-indent:0in'>3.    …the exact same 3070 bytes you
downloaded last time.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:36.8pt;margin-bottom:
45.65pt;margin-left:16.65pt;text-align:justify;text-justify:inter-ideograph;
text-indent:0in;line-height:155%'><span style='font-size:9.5pt;line-height:
155%'>HTTP </span>is designed to work better than this. <span style='font-size:
10.0pt;line-height:155%;font-family:"Liberation Mono"'>urllib </span>speaks <span
style='font-size:9.5pt;line-height:155%'>HTTP </span>like I speak Spanish —
enough to get by in a jam, but not enough to hold a conversation. <span
style='font-size:9.5pt;line-height:155%'>HTTP </span>is a conversation. It’s
time to upgrade to a library that speaks <span style='font-size:9.5pt;
line-height:155%'>HTTP </span>fluently.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:33.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h5 style='margin-top:0in;margin-right:0in;margin-bottom:20.5pt;margin-left:
16.4pt'><span style='font-size:18.0pt;line-height:112%'>14.5. I</span>NTRODUCING
<span style='font-size:18.0pt;line-height:112%;font-family:"Liberation Mono";
font-weight:normal'>httplib2</span></h5>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.7pt;margin-left:16.4pt'>Before you can use <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>httplib2</span>, you’ll need to
install it. Visit <a href="http://code.google.com/p/httplib2/"><span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono";
color:black'>code.google.com/p/httplib2/</span></a><u><span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'> </span></u>and download
the latest version. <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>httplib2 </span>is available for Python 2.x and Python 3.x;
make sure you get the Python 3 version, named something like <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>httplib2-python3-0.5.0.zip</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>Unzip the archive, open a terminal window, and go to
the newly created <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>httplib2 </span>directory. On Windows, open the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>Start </span>menu,
select <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>Run...</span>,
type <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>cmd.exe
</span>and press <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>ENTER</span>.<br clear=all style='page-break-before:always'>
</p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.95in;margin-bottom:
8.5pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#666677'>c:\Users\pilgrim\Downloads&gt;
</span><b><span style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
background:gainsboro'>dir</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>Volume in drive C has no label.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>Volume Serial Number is DED5-B4F8</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>Directory of c:\Users\pilgrim\Downloads</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>07/28/2009  12:36 PM   
&lt;DIR&gt;          .</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>07/28/2009  12:36 PM   
&lt;DIR&gt;          ..</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:164.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>07/28/2009  12:36 PM   
&lt;DIR&gt;          httplib2-python3-0.5.0 07/28/2009  12:33 PM           
18,997 httplib2-python3-0.5.0.zip 1 File(s)         18,997 bytes</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:128.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>3 Dir(s)  61,496,684,544 bytes free</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.95in;margin-bottom:
8.5pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#666677'>c:\Users\pilgrim\Downloads&gt;
</span><b><span style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
background:gainsboro'>cd httplib2-python3-0.5.0</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:20.4pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>c:\Users\pilgrim\Downloads\httplib2-python3-0.5.0&gt;
</span><b><span style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
background:gainsboro'>c:\python31\python.exe setup.py install </span></b><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>running
install running build running build_py running install_lib</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>creating
c:\python31\Lib\site-packages\httplib2</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:74.45pt;margin-bottom:
23.8pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>copying
build\lib\httplib2\iri2uri.py -&gt; c:\python31\Lib\site-packages\httplib2
copying build\lib\httplib2\__init__.py -&gt;
c:\python31\Lib\site-packages\httplib2 byte-compiling
c:\python31\Lib\site-packages\httplib2\iri2uri.py to iri2uri.pyc byte-compiling
c:\python31\Lib\site-packages\httplib2\__init__.py to __init__.pyc running
install_egg_info Writing
c:\python31\Lib\site-packages\httplib2-python3_0.5.0-py3.1.egg-info</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>On Mac OS X, run the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>Terminal.app </span>application
in your <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>/Applications/Utilities/
</span>folder. On Linux, run the <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>Terminal </span>application, which is
usually in your <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>Applications </span>menu under <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>Accessories </span>or <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>System</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:181.7pt;margin-bottom:
8.75pt;margin-left:37.9pt;line-height:107%'><span style='font-size:10.0pt;
line-height:107%;font-family:"Liberation Mono";color:#666677'>you@localhost:~/Desktop$
</span><b><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono";
background:gainsboro'>unzip httplib2-python3-0.5.0.zip</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:296.45pt;margin-bottom:
.3pt;margin-left:50.15pt;text-align:justify;text-justify:inter-ideograph;
text-indent:-12.0pt;line-height:182%'><span style='font-size:10.0pt;line-height:
182%;font-family:"Liberation Mono"'>Archive:  httplib2-python3-0.5.0.zip
inflating: httplib2-python3-0.5.0/README inflating:
httplib2-python3-0.5.0/setup.py inflating: httplib2-python3-0.5.0/PKG-INFO</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:164.45pt;margin-bottom:
0in;margin-left:50.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>inflating:
httplib2-python3-0.5.0/httplib2/__init__.py inflating:
httplib2-python3-0.5.0/httplib2/iri2uri.py</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:181.7pt;margin-bottom:
8.75pt;margin-left:37.9pt;line-height:107%'><span style='font-size:10.0pt;
line-height:107%;font-family:"Liberation Mono";color:#666677'>you@localhost:~/Desktop$
</span><b><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono";
background:gainsboro'>cd httplib2-python3-0.5.0/</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:98.4pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>you@localhost:~/Desktop/httplib2-python3-0.5.0$
</span><b><span style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
background:gainsboro'>sudo python3 setup.py install </span></b><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>running
install running build running build_py creating build</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:296.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>creating
build/lib.linux-x86_64-3.1 creating build/lib.linux-x86_64-3.1/httplib2</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:122.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>copying httplib2/iri2uri.py
-&gt; build/lib.linux-x86_64-3.1/httplib2 copying httplib2/__init__.py -&gt;
build/lib.linux-x86_64-3.1/httplib2 running install_lib</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>creating
/usr/local/lib/python3.1/dist-packages/httplib2</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-3.55pt;margin-bottom:
23.75pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>copying
build/lib.linux-x86_64-3.1/httplib2/iri2uri.py -&gt;
/usr/local/lib/python3.1/dist-packag copying
build/lib.linux-x86_64-3.1/httplib2/__init__.py -&gt;
/usr/local/lib/python3.1/dist-packa byte-compiling
/usr/local/lib/python3.1/dist-packages/httplib2/iri2uri.py to iri2uri.pyc
byte-compiling /usr/local/lib/python3.1/dist-packages/httplib2/__init__.py to
__init__.pyc running install_egg_info Writing
/usr/local/lib/python3.1/dist-packages/httplib2-python3_0.5.0.egg-info</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>To use <span style='font-size:10.0pt;
line-height:107%;font-family:"Liberation Mono"'>httplib2</span>, create an
instance of the <span style='font-size:10.0pt;line-height:107%;font-family:
"Liberation Mono"'>httplib2.Http </span>class.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>import
httplib2</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.9pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>h = httplib2.Http('.cache')                                                 </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>response,
content = h.request('http://diveintopython3.org/examples/feed.xml') </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>response.status                                                             </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.5pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>200</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>content[:52]                                                                </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>b&quot;&lt;?xml version='1.0'
encoding='utf-8'?&gt;\r\n&lt;feed xmlns=&quot;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>len(content)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.45pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>3070</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The primary interface to <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>httplib2 </span>is the <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>Http </span>object. For
reasons you’ll see in the next section, you should always pass a directory name
when you create an <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>Http </span>object. The directory does not need to exist; <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>httplib2
</span>will create it if necessary.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Once you have an <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>Http </span>object, retrieving data is as simple
as calling the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>request()
</span>method with the address of the data you want. This will issue an <span
style='font-size:9.5pt;line-height:154%'>HTTP </span><span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>GET </span>request for
that <span style='font-size:9.5pt;line-height:154%'>URL</span>. (Later in this
chapter, you’ll see how to issue other <span style='font-size:9.5pt;line-height:
154%'>HTTP </span>requests, like <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>POST</span>.)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.15pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:155%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The <span
style='font-size:10.0pt;line-height:155%;font-family:"Liberation Mono"'>request()
</span>method returns two values. The first is an <span style='font-size:10.0pt;
line-height:155%;font-family:"Liberation Mono"'>httplib2.Response </span>object,
which contains all the <span style='font-size:9.5pt;line-height:155%'>HTTP </span>headers
the server returned. For example, a <span style='font-size:10.0pt;line-height:
155%;font-family:"Liberation Mono"'>status </span>code of <span
style='font-size:10.0pt;line-height:155%;font-family:"Liberation Mono"'>200 </span>indicates
that the request was successful.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
47.5pt;margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>content
</span>variable contains the actual data that was returned by the <span
style='font-size:9.5pt;line-height:154%'>HTTP </span>server. The data is
returned as <u>a </u><u><span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>bytes </span>object, not a string</u>. If you
want it as a string, you’ll need to <a
href="http://feedparser.org/docs/character-encoding.html"><span
style='color:black'>determine</span></a><u> </u><a
href="http://feedparser.org/docs/character-encoding.html"><span
style='color:black'>the</span></a><u> </u><a
href="http://feedparser.org/docs/character-encoding.html"><span
style='color:black'>character</span></a><u> </u><a
href="http://feedparser.org/docs/character-encoding.html"><span
style='color:black'>encoding </span></a>and convert it yourself.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:79.95pt;margin-bottom:
.25pt;margin-left:75.95pt;text-indent:-29.3pt;line-height:188%'><span
style='font-size:24.0pt;line-height:188%;font-family:"Calibri",sans-serif'>&#9758;
</span>You probably only need one <span style='font-size:10.0pt;line-height:
188%;font-family:"Liberation Mono"'>httplib2.Http </span>object. There are
valid reasons for creating more than one, but you should only do so if you know
why you need them.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:81.4pt;margin-bottom:
.25pt;margin-left:76.4pt'>“I need to request data from two different <span
style='font-size:9.5pt;line-height:154%'>URL</span>s” is not a valid reason.
Re-use the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>Http
</span>object and just call the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>request() </span>method twice.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:7.95pt;
margin-left:16.4pt;line-height:110%'><b><span style='font-size:13.0pt;
line-height:110%;font-family:"DejaVu Serif",serif'>14.5.1. A S</span></b><b><span
style='font-size:10.5pt;line-height:110%;font-family:"DejaVu Serif",serif'>HORT
</span></b><b><span style='font-size:13.0pt;line-height:110%;font-family:"DejaVu Serif",serif'>D</span></b><b><span
style='font-size:10.5pt;line-height:110%;font-family:"DejaVu Serif",serif'>IGRESSION
</span></b><b><span style='font-size:13.0pt;line-height:110%;font-family:"DejaVu Serif",serif'>T</span></b><b><span
style='font-size:10.5pt;line-height:110%;font-family:"DejaVu Serif",serif'>O </span></b><b><span
style='font-size:13.0pt;line-height:110%;font-family:"DejaVu Serif",serif'>E</span></b><b><span
style='font-size:10.5pt;line-height:110%;font-family:"DejaVu Serif",serif'>XPLAIN
</span></b><b><span style='font-size:13.0pt;line-height:110%;font-family:"DejaVu Serif",serif'>W</span></b><b><span
style='font-size:10.5pt;line-height:110%;font-family:"DejaVu Serif",serif'>HY </span></b><span
style='font-size:13.0pt;line-height:110%;font-family:"Liberation Mono"'>httplib2
</span><b><span style='font-size:13.0pt;line-height:110%;font-family:"DejaVu Serif",serif'>R</span></b><b><span
style='font-size:10.5pt;line-height:110%;font-family:"DejaVu Serif",serif'>ETURNS
</span></b><b><span style='font-size:13.0pt;line-height:110%;font-family:"DejaVu Serif",serif'>B</span></b><b><span
style='font-size:10.5pt;line-height:110%;font-family:"DejaVu Serif",serif'>YTES</span></b></p>

<h6 style='margin-left:16.4pt'><span style='font-size:13.0pt;line-height:110%'>I</span>NSTEAD
OF <span style='font-size:13.0pt;line-height:110%'>S</span>TRINGS</h6>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>Bytes. Strings. What a pain. Why can’t <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>httplib2
</span>“just” do the conversion for you? Well, it’s complicated, because the
rules for determining the character encoding are specific to what kind of
resource you’re requesting. How could <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>httplib2 </span>know what kind of resource
you’re requesting? It’s usually listed in the</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.65pt;margin-left:16.4pt'><span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>Content-Type </span><span style='font-size:9.5pt;
line-height:154%'>HTTP </span>header, but that’s an optional feature of <span
style='font-size:9.5pt;line-height:154%'>HTTP </span>and not all <span
style='font-size:9.5pt;line-height:154%'>HTTP </span>servers include it. If
that header is not included in the <span style='font-size:9.5pt;line-height:
154%'>HTTP </span>response, it’s left up to the client to guess. (This is
commonly called “content sniffing,” and it’s never perfect.)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.1in;margin-left:16.4pt;line-height:107%'>If you know what sort of resource
you’re expecting (an <span style='font-size:9.5pt;line-height:107%'>XML </span>document
in this case), perhaps you could</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.55pt;margin-left:16.4pt'>“just” pass the returned <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>bytes </span>object to
the <u><span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>xml.etree.ElementTree.parse()
</span>function</u>. That’ll work as long as the <span style='font-size:9.5pt;
line-height:154%'>XML </span>document includes information on its own character
encoding (as this one does), but that’s an optional feature and not all <span
style='font-size:9.5pt;line-height:154%'>XML </span>documents do that. If an <span
style='font-size:9.5pt;line-height:154%'>XML </span>document doesn’t include
encoding information, the client is supposed to look at the enclosing transport
— <i>i.e. </i>the <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>Content-Type </span><span style='font-size:9.5pt;line-height:
154%'>HTTP </span>header, which can include a <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>charset </span>parameter.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
2.0pt;margin-left:16.4pt'><img width=150 height=1
src="Dive%20Into%20Python%203_files/image051.jpg" align=left hspace=12>But it’s
worse than that. Now character encoding information can be in two places:
within the <span style='font-size:9.5pt;line-height:154%'>XML </span>document
itself, and within the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>Content-Type </span><span style='font-size:9.5pt;
line-height:154%'>HTTP </span>header. If the information is in <i>both </i>places,
which one wins? According to <a href="http://www.ietf.org/rfc/rfc3023.txt"><span
style='color:black'>RFC </span></a><a href="http://www.ietf.org/rfc/rfc3023.txt"><span
style='color:black'>3023</span></a><u> </u>(I swear I am not making this up),
if the media type given in the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>Content-</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.0pt;margin-bottom:
20.4pt;margin-left:17.15pt;line-height:162%'><span style='font-size:10.0pt;
line-height:162%;font-family:"Liberation Mono"'>Type </span><span
style='font-size:9.5pt;line-height:162%'>HTTP </span>header is <span
style='font-size:10.0pt;line-height:162%;font-family:"Liberation Mono"'>application/xml</span>,
<span style='font-size:10.0pt;line-height:162%;font-family:"Liberation Mono"'>application/xml-dtd</span>,
<span style='font-size:10.0pt;line-height:162%;font-family:"Liberation Mono"'>application/
xml-external-parsed-entity</span>, or any one of the subtypes of <span
style='font-size:10.0pt;line-height:162%;font-family:"Liberation Mono"'>application/xml
</span>such as <span style='font-size:10.0pt;line-height:162%;font-family:"Liberation Mono"'>application/atom+xml
</span>or <span style='font-size:10.0pt;line-height:162%;font-family:"Liberation Mono"'>application/rss+xml
</span>or even <span style='font-size:10.0pt;line-height:162%;font-family:"Liberation Mono"'>application/
rdf+xml</span>, then the encoding is</p>

<p class=MsoNormal style='margin-top:0in;margin-right:65.6pt;margin-bottom:
6.45pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>the encoding
given in the <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>charset
</span>parameter of the <span style='font-size:10.0pt;line-height:107%;
font-family:"Liberation Mono"'>Content-Type </span><span style='font-size:9.5pt;
line-height:107%'>HTTP </span>header, or</p>

<p class=MsoNormal style='margin-top:0in;margin-right:65.6pt;margin-bottom:
21.9pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>the encoding given in the <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>encoding </span>attribute of the <span
style='font-size:9.5pt;line-height:154%'>XML </span>declaration within the
document, or 3. <span style='font-size:9.5pt;line-height:154%'>UTF</span>-8</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>On the other hand, if the media type given in the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>Content-Type
</span><span style='font-size:9.5pt;line-height:154%'>HTTP </span>header is <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>text/xml</span>,
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>text/xmlexternal-parsed-entity</span>,
or a subtype like <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>text/AnythingAtAll+xml</span>, then the encoding attribute
of the</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'><span style='font-size:9.5pt;
line-height:107%'>XML </span>declaration within the document is ignored
completely, and the encoding is</p>

<p class=MsoNormal style='margin-top:0in;margin-right:15.25pt;margin-bottom:
8.45pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>the encoding
given in the charset parameter of the <span style='font-size:10.0pt;line-height:
107%;font-family:"Liberation Mono"'>Content-Type </span><span style='font-size:
9.5pt;line-height:107%'>HTTP </span>header, or</p>

<p class=MsoNormal style='margin-top:0in;margin-right:15.25pt;margin-bottom:
26.85pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:110%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>us-ascii</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.55pt;margin-left:16.4pt'>And that’s just for <span style='font-size:9.5pt;
line-height:154%'>XML </span>documents. For <span style='font-size:9.5pt;
line-height:154%'>HTML </span>documents, web browsers have constructed such <a
href="http://www.adambarth.com/papers/2009/barth-caballero-song.pdf"><span
style='color:black'>byzantine </span></a><a
href="http://www.adambarth.com/papers/2009/barth-caballero-song.pdf"><span
style='color:black'>rules</span></a><u> </u><a
href="http://www.adambarth.com/papers/2009/barth-caballero-song.pdf"><span
style='color:black'>for</span></a><u> </u><a
href="http://www.adambarth.com/papers/2009/barth-caballero-song.pdf"><span
style='color:black'>content-sniffing</span></a><u> </u>[<span style='font-size:
9.5pt;line-height:154%'>PDF</span>] that <a
href="http://www.google.com/search?q=barth+content-type+processing+model"><span
style='color:black'>we’re</span></a><u> </u><a
href="http://www.google.com/search?q=barth+content-type+processing+model"><span
style='color:black'>still</span></a><u> </u><a
href="http://www.google.com/search?q=barth+content-type+processing+model"><span
style='color:black'>trying</span></a><u> </u><a
href="http://www.google.com/search?q=barth+content-type+processing+model"><span
style='color:black'>to</span></a><u> </u><a
href="http://www.google.com/search?q=barth+content-type+processing+model"><span
style='color:black'>figure</span></a><u> </u><a
href="http://www.google.com/search?q=barth+content-type+processing+model"><span
style='color:black'>them</span></a><u> </u><a
href="http://www.google.com/search?q=barth+content-type+processing+model"><span
style='color:black'>all</span></a><u> </u><a
href="http://www.google.com/search?q=barth+content-type+processing+model"><span
style='color:black'>out</span></a>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:28.1pt;
margin-left:17.15pt;line-height:110%'>“<a
href="http://code.google.com/p/httplib2/source/checkout"><span
style='color:black'>Patches</span></a><u> </u><a
href="http://code.google.com/p/httplib2/source/checkout"><span
style='color:black'>welcome</span></a>.”</p>

<p class=MsoHeading7 style='margin-top:0in;margin-right:0in;margin-bottom:27.15pt;
margin-left:16.4pt'><span style='font-size:13.0pt;line-height:110%'>14.5.2. H</span>OW
<span style='font-size:13.0pt;line-height:110%;font-family:"Liberation Mono";
font-weight:normal'>httplib2 </span><span style='font-size:13.0pt;line-height:
110%'>H</span>ANDLES <span style='font-size:13.0pt;line-height:110%'>C</span>ACHING</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.05pt;margin-left:16.4pt'>Remember in the previous section when I said you
should always create an <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>httplib2.Http </span>object with a directory
name? Caching is the reason.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'># continued from the previous example</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.75pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>response2,
content2 = h.request('http://diveintopython3.org/examples/feed.xml') </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>response2.status                                                            </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.55pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>200</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;line-height:
185%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>content2[:52] </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314; </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>b&quot;&lt;?xml
version='1.0' encoding='utf-8'?&gt;\r\n&lt;feed xmlns=&quot;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>len(content2)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>3070</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>This shouldn’t be terribly surprising. It’s the same thing you did last
time, except you’re putting the result into two new variables.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.05pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The <span
style='font-size:9.5pt;line-height:107%'>HTTP </span><span style='font-size:
10.0pt;line-height:107%;font-family:"Liberation Mono"'>status </span>is once
again <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>200</span>,
just like last time.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.45pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The downloaded content is the same as last time, too.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>So… who cares? Quit your Python
interactive shell and relaunch it with a new session, and I’ll show you.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:308.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'># NOT continued from previous
example! # Please exit out of the interactive shell # and launch a new one.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>import
httplib2</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.8pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>httplib2.debuglevel = 1                                                     </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.9pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>h = httplib2.Http('.cache')                                                 </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>response,
content = h.request('http://diveintopython3.org/examples/feed.xml') </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>len(content)                                                                </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.55pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>3070</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>response.status                                                             </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9316;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.6pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>200</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>response.fromcache                                                          </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9317;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.35pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>True</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.15pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:155%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Let’s turn on
debugging and see <u>what’s on the wire</u>. This is the <span
style='font-size:10.0pt;line-height:155%;font-family:"Liberation Mono"'>httplib2
</span>equivalent of turning on debugging in <span style='font-size:10.0pt;
line-height:155%;font-family:"Liberation Mono"'>http.client</span>. <span
style='font-size:10.0pt;line-height:155%;font-family:"Liberation Mono"'>httplib2
</span>will print all the data being sent to the server and some key
information being sent back.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.1pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Create an <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>httplib2.Http
</span>object with the same directory name as before.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Request the same <span style='font-size:9.5pt;line-height:154%'>URL </span>as
before. <i>Nothing appears to happen. </i>More precisely, nothing gets sent to
the server, and nothing gets returned from the server. There is absolutely no
network activity whatsoever.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.15pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Yet we did
“receive” some data — in fact, we received all of it.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.3pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>5.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>We also
“received” an <span style='font-size:9.5pt;line-height:107%'>HTTP </span>status
code indicating that the “request” was successful.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>6.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Here’s the rub: this “response” was generated from <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>httplib2</span>’s
local cache. That directory name you passed in when you created the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>httplib2.Http
</span>object — that directory holds <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>httplib2</span>’s cache of all the
operations it’s ever performed.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:283.05pt;margin-bottom:
.25pt;margin-left:75.95pt;text-indent:-29.3pt;line-height:185%'><span
style='font-size:24.0pt;line-height:185%;font-family:"Calibri",sans-serif'>&#9758;
</span>If you want to turn on <span style='font-size:10.0pt;line-height:185%;
font-family:"Liberation Mono"'>httplib2 </span>debugging, you need to set a
module-level constant</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
41.55pt;margin-left:76.4pt'><img width=298 height=1
src="Dive%20Into%20Python%203_files/image033.gif" align=left hspace=12>(<span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>httplib2.debuglevel</span>),
then create a new <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>httplib2.Http </span>object. If you want to turn off
debugging, you need to change the same module-level constant, then create a new
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>httplib2.Http
</span>object.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>You previously requested the data at this <span
style='font-size:9.5pt;line-height:154%'>URL</span>. That request was
successful (<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>status:
200</span>). That response included not only the feed data, but also a set of <u>caching
headers </u>that told anyone who was listening that they could cache this
resource for up to 24 hours (<span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>Cache-</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.8pt;margin-left:16.4pt'><span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>Control: max-age=86400</span>, which is 24 hours
measured in seconds). <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>httplib2 </span>understand and respects those
caching headers, and it stored the previous response in the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>.cache </span>directory
(which you passed in when you create the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>Http </span>object). That cache
hasn’t expired yet, so the second time you request the data at this <span
style='font-size:9.5pt;line-height:154%'>URL</span>, <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>httplib2 </span>simply
returns the cached result without ever hitting the network.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.5pt;margin-left:16.4pt'>I say “simply,” but obviously there is a lot of
complexity hidden behind that simplicity. <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>httplib2 </span>handles <span
style='font-size:9.5pt;line-height:154%'>HTTP </span>caching <i>automatically </i>and
<i>by default</i>. If for some reason you need to know whether a response came
from the cache, you can check <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>response.fromcache</span>. Otherwise, it Just
Works.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>Now, suppose you have data cached, but you want to
bypass the cache and re-request it from the remote server. Browsers sometimes
do this if the user specifically requests it. For example, pressing <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>F5 </span>refreshes
the current page, but pressing <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>Ctrl+F5 </span>bypasses the cache and
re-requests the current page from the remote server. You might think “oh, I’ll
just delete the data from my local cache, then request it again.” You could do
that, but remember that there may be more parties involved than just you and
the remote server. What about those intermediate proxy servers? They’re
completely beyond your control, and they may still have that data cached, and
will happily return it to you because (as far as they are concerned) their
cache is still valid.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.05pt;margin-left:16.4pt'>Instead of manipulating your local cache and hoping
for the best, you should use the features of <span style='font-size:9.5pt;
line-height:154%'>HTTP </span>to ensure that your request actually reaches the
remote server.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'># continued from the previous example</span></p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:24.3pt;
margin-bottom:12.7pt;margin-left:.5pt;text-align:center;line-height:110%'><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>response2, content2 =
h.request('http://diveintopython3.org/examples/feed.xml',</span></p>

<p class=MsoNormal style='margin:0in;text-indent:0in;line-height:110%'><span
style='font-size:11.0pt;line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>...      </span><span style='font-size:10.0pt;line-height:110%;
font-family:"Liberation Mono"'>headers={'cache-control':'no-cache'}) </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=390
 style='width:292.8pt;margin-left:38.15pt;border-collapse:collapse'>
 <tr style='height:207.3pt'>
  <td width=376 valign=top style='width:282.05pt;padding:0in 0in 0in 0in;
  height:207.3pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:48.05pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:185%'><span style='font-size:
  10.0pt;line-height:185%;font-family:"Liberation Mono"'>connect:
  (diveintopython3.org, 80) send: b'GET /examples/feed.xml HTTP/1.1 Host:
  diveintopython3.org</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:48.05pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:185%'><span style='font-size:
  10.0pt;line-height:185%;font-family:"Liberation Mono"'>user-agent:
  Python-httplib2/$Rev: 259 $ accept-encoding: deflate, gzip cache-control:
  no-cache' reply: 'HTTP/1.1 200 OK' …further debugging information omitted…</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>response2.status</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>200</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:207.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9313;</span></p>
  </td>
 </tr>
 <tr style='height:43.5pt'>
  <td width=376 valign=top style='width:282.05pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>response2.fromcache</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>False</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9314;</span></p>
  </td>
 </tr>
 <tr style='height:18.3pt'>
  <td width=376 valign=bottom style='width:282.05pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono";
  color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
  107%;font-family:"Liberation Mono"'>print(dict(response2.items()))</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9315;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>{'status': '200',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:152.45pt;margin-bottom:
0in;margin-left:44.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>'content-length': '3070',
'content-location': 'http://diveintopython3.org/examples/feed.xml',
'accept-ranges': 'bytes', 'expires': 'Wed, 03 Jun 2009 00:40:26 GMT',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'vary': 'Accept-Encoding',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:260.45pt;margin-bottom:
0in;margin-left:44.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>'server': 'Apache',
'last-modified': 'Sun, 31 May 2009 22:51:11 GMT', 'connection': 'close',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:344.45pt;margin-bottom:
0in;margin-left:44.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>'-content-encoding': 'gzip',
'etag': '&quot;bfe-255ef5c0&quot;',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'cache-control': 'max-age=86400',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:224.45pt;margin-bottom:
8.25pt;margin-left:44.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>'date': 'Tue, 02 Jun 2009
00:40:26 GMT', 'content-type': 'application/xml'}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span><span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>httplib2
</span>allows you to add arbitrary <span style='font-size:9.5pt;line-height:
154%'>HTTP </span>headers to any outgoing request. In order to bypass <i>all </i>caches
(not just your local disk cache, but also any caching proxies between you and
the remote server), add a <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>nocache </span>header in the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>headers
</span>dictionary.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Now you see <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>httplib2 </span>initiating a network request. <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>httplib2
</span>understands and respects caching headers <i>in both directions </i>— as
part of the incoming response <i>and as part of the outgoing request</i>. It
noticed that you added the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>no-cache </span>header, so it bypassed its local
cache altogether and then had no choice but to hit the network to request the
data.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>This response was <i>not </i>generated from your local cache. You knew
that, of course, because you saw the debugging information on the outgoing
request. But it’s nice to have that programmatically verified.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
22.0pt;margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The request succeeded; you downloaded the entire feed again from the
remote server. Of course, the server also sent back a full complement of <span
style='font-size:9.5pt;line-height:154%'>HTTP </span>headers along with the
feed data. That includes caching headers, which <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>httplib2 </span>uses to update
its local cache, in the hopes of avoiding network access the <i>next </i>time
you request this feed. Everything about <span style='font-size:9.5pt;
line-height:154%'>HTTP </span>caching is designed to maximize cache hits and
minimize network access. Even though you bypassed the cache this time, the
remote server would really appreciate it if you would cache the result for next
time.</p>

<p class=MsoHeading8 style='margin-left:16.4pt'><b><span style='font-family:
"DejaVu Serif",serif'>14.5.3. H</span></b><b><span style='font-size:10.5pt;
line-height:122%;font-family:"DejaVu Serif",serif'>OW </span></b>httplib2 <b><span
style='font-family:"DejaVu Serif",serif'>H</span></b><b><span style='font-size:
10.5pt;line-height:122%;font-family:"DejaVu Serif",serif'>ANDLES </span></b>Last-Modified
<b><span style='font-size:10.5pt;line-height:122%;font-family:"DejaVu Serif",serif'>AND
</span></b>ETag <b><span style='font-family:"DejaVu Serif",serif'>H</span></b><b><span
style='font-size:10.5pt;line-height:122%;font-family:"DejaVu Serif",serif'>EADERS</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.15pt;margin-left:16.4pt'>The <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>Cache-Control </span>and <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>Expires </span><u>caching
headers </u>are called <i>freshness indicators</i>. They tell caches in no
uncertain terms that you can completely avoid all network access until the
cache expires. And that’s exactly the behavior you saw <u>in the previous
section</u>: given a freshness indicator, <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>httplib2 </span><i>does not
generate a single byte of network activity </i>to serve up cached data (unless
you explicitly <u>bypass the cache</u>, of course).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>But what about the case where the data <i>might </i>have
changed, but hasn’t? <span style='font-size:9.5pt;line-height:154%'>HTTP </span>defines
<u><span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>Last-Modified
</span></u>and <u><span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>Etag </span></u>headers for this purpose. These headers are
called <i>validators</i>. If the local cache is no longer fresh, a client can
send the validators with the next request to see if the data has actually
changed. If the data hasn’t changed, the server sends back a <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>304 </span>status
code <i>and no data</i>. So there’s still a round-trip over the network, but
you end up downloading fewer bytes.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>import
httplib2</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>httplib2.debuglevel
= 1</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>h =
httplib2.Http('.cache')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:153.65pt;margin-bottom:
4.15pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>response,
content = h.request('http://diveintopython3.org/') </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312; </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>connect:
(diveintopython3.org, 80) send: b'GET / HTTP/1.1 Host: diveintopython3.org
accept-encoding: deflate, gzip user-agent: Python-httplib2/$Rev: 259 $' reply:
'HTTP/1.1 200 OK'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>print(dict(response.items()))                                 </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>{'-content-encoding': 'gzip',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:326.45pt;margin-bottom:
0in;margin-left:44.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>'accept-ranges': 'bytes',
'connection': 'close',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:254.45pt;margin-bottom:
0in;margin-left:44.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>'content-length': '6657',
'content-location': 'http://diveintopython3.org/', 'content-type': 'text/html',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'date': 'Tue, 02 Jun 2009 03:26:54 GMT',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.5pt;
margin-left:44.65pt;line-height:110%;background:gainsboro'><b><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>'etag':
'&quot;7f806d-1a01-9fb97900&quot;', 'last-modified': 'Tue, 02 Jun 2009 02:51:48
GMT',</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'server': 'Apache',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'status': '200',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.5pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'vary': 'Accept-Encoding,User-Agent'}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>len(content)                                                  </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.2pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>6657</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Instead of the feed, this time we’re going to download the site’s home
page, which is <span style='font-size:9.5pt;line-height:154%'>HTML</span>.
Since this is the first time you’ve ever requested this page, <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>httplib2
</span>has little to work with, and it sends out a minimum of headers with the
request.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The response contains a multitude of <span style='font-size:9.5pt;
line-height:154%'>HTTP </span>headers… but no caching information. However, it
does include both an <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>ETag </span>and <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>Last-Modified </span>header.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>At the time I constructed this example, this page was 6657 bytes. It’s
probably changed since then, but don’t worry about it.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'># continued from the previous example</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:153.65pt;margin-bottom:
4.2pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>response,
content = h.request('http://diveintopython3.org/') </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312; </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>connect:
(diveintopython3.org, 80) send: b'GET / HTTP/1.1 Host: diveintopython3.org</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:153.65pt;margin-bottom:
4.35pt;margin-left:37.9pt;line-height:183%'><span style='font-size:10.0pt;
line-height:183%;font-family:"Liberation Mono"'>if-none-match:
&quot;7f806d-1a01-9fb97900&quot;     </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9313; </span><span style='font-size:10.0pt;line-height:183%;
font-family:"Liberation Mono"'>if-modified-since: Tue, 02 Jun 2009 02:51:48 GMT      </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314; </span><span
style='font-size:10.0pt;line-height:183%;font-family:"Liberation Mono"'>accept-encoding:
deflate, gzip user-agent: Python-httplib2/$Rev: 259 $'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.75pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>reply:
'HTTP/1.1 304 Not Modified'                                </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>response.fromcache                                            </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9316;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.55pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>True</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>response.status                                               </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9317;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>200</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>response.dict['status']                                       </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9318;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.5pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'304'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>len(content)                                                  </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9319;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.2pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>6657</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
7.15pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>You request the
same page again, with the same <span style='font-size:10.0pt;line-height:107%;
font-family:"Liberation Mono"'>Http </span>object (and the same local cache).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
7.3pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>httplib2
</span>sends the <span style='font-size:10.0pt;line-height:107%;font-family:
"Liberation Mono"'>ETag </span>validator back to the server in the <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>If-None-Match
</span>header.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
5.95pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>httplib2
</span>also sends the <span style='font-size:10.0pt;line-height:107%;
font-family:"Liberation Mono"'>Last-Modified </span>validator back to the
server in the <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>If-Modified-Since
</span>header.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The server looked at these validators, looked at the page you requested,
and determined that the page has not changed since you last requested it, so it
sends back a <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>304
</span>status code <i>and no data</i>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.15pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>5.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Back on the
client, <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>httplib2
</span>notices the <span style='font-size:10.0pt;line-height:107%;font-family:
"Liberation Mono"'>304 </span>status code and loads the content of the page
from its cache.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>6.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>This might be a bit confusing. There are really <i>two </i>status codes
— <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>304
</span>(returned from the server this time, which caused <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>httplib2
</span>to look in its cache), and <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>200 </span>(returned from the server <i>last
time</i>, and stored in <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>httplib2</span>’s cache along with the page
data). <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>response.status
</span>returns the status from the cache.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>7.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>If you want the raw status code returned from the server, you can get
that by looking in <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>response.dict</span>, which is a dictionary of the actual
headers returned from the server.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>8.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>However, you still get the data in the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>content </span>variable.
Generally, you don’t need to know why a response was served from the cache.
(You may not even care that it was served from the cache at all, and that’s
fine too. <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>httplib2
</span>is smart enough to let you act dumb.) By the time the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>request()
</span>method returns to the caller, <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>httplib2 </span>has already updated its
cache and returned the data to you.</p>

<p class=MsoHeading7 style='margin-top:0in;margin-right:0in;margin-bottom:26.95pt;
margin-left:16.4pt'><span style='font-size:13.0pt;line-height:110%'>14.5.4. H</span>OW
<span style='font-size:13.0pt;line-height:110%;font-family:"Liberation Mono";
font-weight:normal'>http2lib </span><span style='font-size:13.0pt;line-height:
110%'>H</span>ANDLES <span style='font-size:13.0pt;line-height:110%'>C</span>OMPRESSION</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'><span style='font-size:9.5pt;line-height:154%'>HTTP </span>supports
<u>several types of compression</u>; the two most common types are gzip and
deflate. <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>httplib2
</span>supports both of these.           <span style='font-size:11.0pt;
line-height:154%;font-family:"Calibri",sans-serif'><img border=0 width=298
height=450 src="Dive%20Into%20Python%203_files/image052.gif"></span><br
clear=all style='page-break-before:always'>
</p>

<p class=MsoNormal style='margin-top:0in;margin-right:176.45pt;margin-bottom:
4.15pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>response,
content = h.request('http://diveintopython3.org/') connect:
(diveintopython3.org, 80) send: b'GET / HTTP/1.1 Host: diveintopython3.org</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>accept-encoding:
deflate, gzip                          </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:284.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>user-agent:
Python-httplib2/$Rev: 259 $' reply: 'HTTP/1.1 200 OK'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>print(dict(response.items()))</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>{'-content-encoding':
'gzip',                           </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:326.45pt;margin-bottom:
0in;margin-left:44.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>'accept-ranges': 'bytes',
'connection': 'close',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:254.45pt;margin-bottom:
0in;margin-left:44.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>'content-length': '6657',
'content-location': 'http://diveintopython3.org/', 'content-type': 'text/html',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:260.45pt;margin-bottom:
0in;margin-left:44.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>'date': 'Tue, 02 Jun 2009
03:26:54 GMT', 'etag': '&quot;7f806d-1a01-9fb97900&quot;', 'last-modified':
'Tue, 02 Jun 2009 02:51:48 GMT',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'server': 'Apache',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'status': '304',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.85pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'vary': 'Accept-Encoding,User-Agent'}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Every time <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>httplib2 </span>sends a request, it includes an <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>Accept-Encoding
</span>header to tell the server that it can handle either <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>deflate
</span>or <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>gzip
</span>compression.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.95pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>In this case, the server has responded with a gzip-compressed payload.
By the time the <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>request() </span>method returns, <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>httplib2 </span>has
already decompressed the body of the response and placed it in the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>content
</span>variable. If you’re curious about whether or not the response was
compressed, you can check <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>response['-contentencoding']</span>; otherwise,
don’t worry about it.</p>

<p class=MsoHeading7 style='margin-top:0in;margin-right:0in;margin-bottom:26.8pt;
margin-left:16.4pt'><span style='font-size:13.0pt;line-height:110%'>14.5.5. H</span>OW
<span style='font-size:13.0pt;line-height:110%;font-family:"Liberation Mono";
font-weight:normal'>httplib2 </span><span style='font-size:13.0pt;line-height:
110%'>H</span>ANDLES <span style='font-size:13.0pt;line-height:110%'>R</span>EDIRECTS</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'><span style='font-size:9.5pt;line-height:154%'>HTTP </span>defines
<u>two kinds of redirects</u>: temporary and permanent. There’s nothing special
to do with temporary redirects except follow them, which <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>httplib2
</span>does automatically.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>import
httplib2</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>httplib2.debuglevel
= 1</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>h =
httplib2.Http('.cache')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:4.2pt;
margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;line-height:
185%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>response,
content = h.request('http://diveintopython3.org/examples/feed-302.xml') </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312; </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>connect:
(diveintopython3.org, 80)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>send:
b'GET /examples/feed-302.xml HTTP/1.1                                     </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:314.45pt;margin-bottom:
4.15pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>Host: diveintopython3.org
accept-encoding: deflate, gzip user-agent: Python-httplib2/$Rev: 259 $'</span></p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:12.6pt;
margin-bottom:0in;margin-left:23.65pt;text-align:center;line-height:180%'><span
style='font-size:10.0pt;line-height:180%;font-family:"Liberation Mono"'>reply:
'HTTP/1.1 302 Found'     </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9314; </span><span style='font-size:10.0pt;line-height:180%;
font-family:"Liberation Mono"'>send: b'GET /examples/feed.xml HTTP/1.1 </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:314.45pt;margin-bottom:
22.65pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>Host: diveintopython3.org
accept-encoding: deflate, gzip user-agent: Python-httplib2/$Rev: 259 $' reply:
'HTTP/1.1 200 OK'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>There is no feed
at this <span style='font-size:9.5pt;line-height:107%'>URL</span>. I’ve set up
my server to issue a temporary redirect to the correct address.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.55pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>There’s the
request.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>And there’s the response: <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>302 Found</span>. Not shown here, this
response also includes a <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>Location </span>header that points to the real <span
style='font-size:9.5pt;line-height:154%'>URL</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.5pt;margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span><span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>httplib2
</span>immediately turns around and “follows” the redirect by issuing another
request for the <span style='font-size:9.5pt;line-height:154%'>URL </span>given
in the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>Location
</span>header: <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>http://diveintopython3.org/examples/feed.xml</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>“Following” a redirect is nothing more than this
example shows. <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>httplib2
</span>sends a request for the <span style='font-size:9.5pt;line-height:154%'>URL
</span>you asked for. The server comes back with a response that says “No no,
look over there instead.” <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>httplib2 </span>sends another request for the
new <span style='font-size:9.5pt;line-height:154%'>URL</span>.</p>

</div>

<span style='font-size:12.0pt;line-height:154%;font-family:"Gill Sans MT",sans-serif;
color:black'><br clear=all style='page-break-before:always'>
</span>

<div class=WordSection24>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                            </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>response                                                          </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>{'status': '200',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'content-length': '3070',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'content-location':
'http://diveintopython3.org/examples/feed.xml', </span><span style='font-family:
"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:280.85pt;margin-bottom:
0in;margin-left:44.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>'accept-ranges': 'bytes',
'expires': 'Thu, 04 Jun 2009 02:21:41 GMT',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'vary': 'Accept-Encoding',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:244.85pt;margin-bottom:
0in;margin-left:44.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>'server': 'Apache',
'last-modified': 'Wed, 03 Jun 2009 02:20:15 GMT',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'connection': 'close',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                    </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>'-content-encoding':
'gzip',                                         </span><span style='font-family:
"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'etag': '&quot;bfe-4cbbf5c0&quot;',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                    </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>'cache-control':
'max-age=86400',                                    </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'date': 'Wed, 03 Jun 2009 02:21:41 GMT',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.7pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'content-type': 'application/xml'}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
8.0pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>response
</span>you get back from this single call to the <span style='font-size:10.0pt;
line-height:107%;font-family:"Liberation Mono"'>request() </span>method is the
response from the final</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.5pt;
margin-left:16.4pt;line-height:110%'><span style='font-size:9.5pt;line-height:
110%'>URL</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span><span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>httplib2
</span>adds the final <span style='font-size:9.5pt;line-height:154%'>URL </span>to
the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>response
</span>dictionary, as <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>content-location</span>. This is not a header
that came from the server; it’s specific to <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>httplib2</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Apropos of
nothing, this feed is <u>compressed</u>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.8pt;margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>And cacheable. (This is important, as you’ll see in a minute.)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:15.4pt;margin-bottom:
.25pt;margin-left:16.4pt'>The <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>response </span>you get back gives you
information about the <i>final </i><span style='font-size:9.5pt;line-height:
154%'>URL</span>. What if you want more information about the intermediate <span
style='font-size:9.5pt;line-height:154%'>URL</span>s, the ones that eventually
redirected to the final <span style='font-size:9.5pt;line-height:154%'>URL</span>?
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>httplib2
</span>lets you do that, too.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                            </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>response.previous                                                     </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>{'status': '302',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:112.85pt;margin-bottom:
0in;margin-left:44.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>'content-length': '228',
'content-location': 'http://diveintopython3.org/examples/feed-302.xml',
'expires': 'Thu, 04 Jun 2009 02:21:41 GMT', 'server': 'Apache',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:184.85pt;margin-bottom:
0in;margin-left:44.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>'connection': 'close',
'location': 'http://diveintopython3.org/examples/feed.xml', 'cache-control':
'max-age=86400',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'date': 'Wed, 03 Jun 2009 02:21:41 GMT',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'content-type': 'text/html;
charset=iso-8859-1'}</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=606
 style='width:454.8pt;margin-left:38.15pt;border-collapse:collapse'>
 <tr style='height:81.3pt'>
  <td width=592 valign=top style='width:444.05pt;padding:0in 0in 0in 0in;
  height:81.3pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>type(response)</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:264.05pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>&lt;class
  'httplib2.Response'&gt; </span><span style='font-size:10.0pt;line-height:
  107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>type(response.previous)
  &lt;class 'httplib2.Response'&gt;</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:81.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9313;</span></p>
  </td>
 </tr>
 <tr style='height:18.3pt'>
  <td width=592 valign=bottom style='width:444.05pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono";
  color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
  107%;font-family:"Liberation Mono"'>response.previous.previous</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9314;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:1.95in;margin-bottom:
31.9pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;</span>&nbsp;</p>

<p class=MsoNormal style='margin-top:0in;margin-right:4.3pt;margin-bottom:1.55pt;
margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>response.previous
</span>attribute holds a reference to the previous response object that <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>httplib2
</span>followed to get to the current response object.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:4.3pt;margin-bottom:6.6pt;
margin-left:16.65pt;text-indent:-16.65pt;line-height:110%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Both <span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>response
</span>and <span style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>response.previous
</span>are <span style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>httplib2.Response
</span>objects.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:4.3pt;margin-bottom:20.8pt;
margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>That means you can check <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>response.previous.previous </span>to follow the
redirect chain backwards even further. (Scenario: one <span style='font-size:
9.5pt;line-height:154%'>URL </span>redirects to a second <span
style='font-size:9.5pt;line-height:154%'>URL </span>which redirects to a third <span
style='font-size:9.5pt;line-height:154%'>URL</span>. It could happen!) In this
case, we’ve already reached the beginning of the redirect chain, so the
attribute is <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>None</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>What happens if you request the same
<span style='font-size:9.5pt;line-height:107%'>URL </span>again?</p>

<p class=MsoNormal align=right style='margin-top:0in;margin-right:-.75pt;
margin-bottom:5.65pt;margin-left:.5pt;text-align:right;line-height:110%'><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>response2,
content2 = h.request('http://diveintopython3.org/examples/feed-302.xml') </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>connect: (diveintopython3.org, 80)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>send:
b'GET /examples/feed-302.xml HTTP/1.1                                     </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:298.85pt;margin-bottom:
4.15pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>Host: diveintopython3.org
accept-encoding: deflate, gzip user-agent: Python-httplib2/$Rev: 259 $'</span></p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:29.65pt;text-align:center;line-height:179%'><span
style='font-size:10.0pt;line-height:179%;font-family:"Liberation Mono"'>reply:
'HTTP/1.1 302 Found'    </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9314; </span><span style='font-size:10.0pt;line-height:179%;
font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:179%;font-family:"Liberation Mono"'>content2
== content     </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.85pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>True</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.6pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Same <span
style='font-size:9.5pt;line-height:107%'>URL</span>, same <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>httplib2.Http
</span>object (and therefore the same cache).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.15pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>302 </span>response
was not cached, so <span style='font-size:10.0pt;line-height:107%;font-family:
"Liberation Mono"'>httplib2 </span>sends another request for the same <span
style='font-size:9.5pt;line-height:107%'>URL</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Once again, the server responds with a <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>302</span>. But notice what <i>didn’t
</i>happen: there wasn’t ever a second request for the final <span
style='font-size:9.5pt;line-height:154%'>URL</span>, <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>http://diveintopython3.org/examples/feed.xml</span>.
That response was cached</p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.25pt;margin-bottom:
.25pt;margin-left:16.4pt'>(remember the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>Cache-Control </span>header
that you saw in the previous example). Once <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>httplib2 </span>received the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>302
Found </span>code, <i>it checked its cache before issuing another request</i>.
The cache contained a fresh copy of <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>http://diveintopython3.org/examples/feed.xml</span>,
so there was no need to re-request it.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.85pt;margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>By the time the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>request() </span>method returns, it has read the
feed data from the cache and returned it. Of course, it’s the same as the data
you received last time.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.6pt;margin-left:16.4pt'>In other words, you don’t have to do anything
special for temporary redirects. <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>httplib2 </span>will follow them
automatically, and the fact that one <span style='font-size:9.5pt;line-height:
154%'>URL </span>redirects to another has no bearing on <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>httplib2</span>’s
support for compression, caching, <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>ETags</span>, or any of the other features
of <span style='font-size:9.5pt;line-height:154%'>HTTP</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>Permanent redirects are just as
simple.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=777
 style='width:583.0pt;border-collapse:collapse'>
 <tr style='height:123.3pt'>
  <td width=747 valign=top style='width:560.25pt;padding:0in 0in 0in 0in;
  height:123.3pt'>
  <p class=MsoNormal align=right style='margin-top:0in;margin-right:12.1pt;
  margin-bottom:8.75pt;margin-left:0in;text-align:right;text-indent:0in;
  line-height:107%'><span style='font-size:10.0pt;line-height:107%;font-family:
  "Liberation Mono"'>response, content =
  h.request('http://diveintopython3.org/examples/feed-301.xml')</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:264.1pt;margin-bottom:
  0in;margin-left:38.15pt;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>connect:
  (diveintopython3.org, 80) send: b'GET /examples/feed-301.xml HTTP/1.1 Host:
  diveintopython3.org accept-encoding: deflate, gzip user-agent:
  Python-httplib2/$Rev: 259 $'</span></p>
  </td>
  <td width=30 valign=top style='width:22.75pt;padding:0in 0in 0in 0in;
  height:123.3pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>
  </td>
 </tr>
 <tr style='height:22.5pt'>
  <td width=747 valign=top style='width:560.25pt;padding:0in 0in 0in 0in;
  height:22.5pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
  margin-left:38.15pt;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>reply: 'HTTP/1.1 301
  Moved Permanently'</span></p>
  </td>
  <td width=30 valign=top style='width:22.75pt;padding:0in 0in 0in 0in;
  height:22.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>
  </td>
 </tr>
 <tr style='height:253.5pt'>
  <td width=747 valign=top style='width:560.25pt;padding:0in 0in 0in 0in;
  height:253.5pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:38.15pt;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>response.fromcache</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.4pt;
  margin-left:38.15pt;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>True</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.8pt;
  margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
  style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Once again,
  this <span style='font-size:9.5pt;line-height:107%'>URL </span>doesn’t really
  exist. I’ve set up my server to issue a permanent redirect to</p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.95pt;
  margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>http://diveintopython3.org/examples/feed.xml</span>.</p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.3pt;
  margin-left:16.65pt;text-indent:-16.65pt;line-height:152%'>2.<span
  style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>And here it
  is: status code <span style='font-size:10.0pt;line-height:152%;font-family:
  "Liberation Mono"'>301</span>. But again, notice what <i>didn’t </i>happen:
  there was no request to the redirect <span style='font-size:9.5pt;line-height:
  152%'>URL</span>. Why not? Because it’s already cached locally.</p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:27.0pt;
  margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>3.<span
  style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>httplib2
  </span>“followed” the redirect right into its cache.</p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:25.45pt;
  margin-left:16.65pt;text-indent:0in;line-height:107%'>But wait! There’s more!</p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
  margin-left:38.15pt;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'># continued from the
  previous example</span></p>
  </td>
  <td width=30 valign=top style='width:22.75pt;padding:0in 0in 0in 0in;
  height:253.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>
  </td>
 </tr>
 <tr style='height:22.5pt'>
  <td width=747 valign=top style='width:560.25pt;padding:0in 0in 0in 0in;
  height:22.5pt'>
  <p class=MsoNormal align=right style='margin-top:0in;margin-right:.1pt;
  margin-bottom:0in;margin-left:0in;text-align:right;text-indent:0in;
  line-height:107%'><span style='font-size:10.0pt;line-height:107%;font-family:
  "Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>response2, content2 =
  h.request('http://diveintopython3.org/examples/feed-301.xml')</span></p>
  </td>
  <td width=30 valign=top style='width:22.75pt;padding:0in 0in 0in 0in;
  height:22.5pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
  margin-left:12.0pt;text-indent:0in;line-height:107%'><span style='font-family:
  "DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>
  </td>
 </tr>
 <tr style='height:43.5pt'>
  <td width=747 valign=top style='width:560.25pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:38.15pt;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>response2.fromcache</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
  margin-left:38.15pt;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>True</span></p>
  </td>
  <td width=30 valign=top style='width:22.75pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
  margin-left:12.0pt;text-indent:0in;line-height:107%'><span style='font-family:
  "DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>
  </td>
 </tr>
 <tr style='height:18.3pt'>
  <td width=747 valign=bottom style='width:560.25pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
  margin-left:38.15pt;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>content2
  == content</span></p>
  </td>
  <td width=30 valign=top style='width:22.75pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
  margin-left:12.0pt;text-indent:0in;line-height:107%'><span style='font-family:
  "DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.35pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>True</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Here’s the difference between temporary and permanent redirects: once <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>httplib2
</span>follows a permanent redirect, all further requests for that <span
style='font-size:9.5pt;line-height:154%'>URL </span>will transparently be
rewritten to the target <span style='font-size:9.5pt;line-height:154%'>URL </span><i>without
hitting the network for the original </i><i><span style='font-size:9.5pt;
line-height:154%'>URL</span></i>. Remember, debugging is still turned on, yet
there is no output of network activity whatsoever.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Yep, this
response was retrieved from the local cache.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
22.3pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Yep, you got the entire feed (from the cache).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'><span style='font-size:9.5pt;
line-height:107%'>HTTP</span>. It works.</p>

</div>

<span style='font-size:12.0pt;line-height:154%;font-family:"Gill Sans MT",sans-serif;
color:black'><br clear=all style='page-break-before:always'>
</span>

<div class=WordSection25>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:33.45pt;
margin-bottom:31.75pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:17.4pt;margin-left:
16.4pt;line-height:110%'><span style='font-size:18.0pt;line-height:110%'>14.6.
B</span>EYOND <span style='font-size:18.0pt;line-height:110%'>HTTP GET</span></h4>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.85pt;margin-left:16.4pt'><span style='font-size:9.5pt;line-height:154%'>HTTP
</span>web services are not limited to <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>GET </span>requests. What if
you want to create something new? Whenever you post a comment on a discussion
forum, update your weblog, publish your status on a microblogging service like <a
href="http://twitter.com/"><span style='color:black'>Twitter</span></a><u> </u>or
<a href="http://identi.ca/"><span style='color:black'>Identi.ca</span></a>,
you’re probably already using <span style='font-size:9.5pt;line-height:154%'>HTTP
</span><span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>POST</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
9.75pt;margin-left:16.4pt;line-height:107%'>Both Twitter and Identi.ca both
offer a simple <span style='font-size:9.5pt;line-height:107%'>HTTP</span>-based
<span style='font-size:9.5pt;line-height:107%'>API </span>for publishing and
updating your status in 140 characters or less. Let’s look at <a
href="http://laconi.ca/trac/wiki/TwitterCompatibleAPI"><span style='color:black'>Identi.ca’s</span></a><u>
</u><a href="http://laconi.ca/trac/wiki/TwitterCompatibleAPI"><span
style='font-size:9.5pt;line-height:107%;color:black'>API</span></a><u><span
style='font-size:9.5pt;line-height:107%'> </span></u><a
href="http://laconi.ca/trac/wiki/TwitterCompatibleAPI"><span style='color:black'>documentation</span></a><u>
</u>for updating your status:</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=675
 style='width:506.25pt;margin-left:39.5pt;border-collapse:collapse'>
 <tr style='height:375.75pt'>
  <td width=675 valign=bottom style='width:506.25pt;border:solid black 1.0pt;
  padding:0in 5.75pt 15.9pt 21.4pt;height:375.75pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.35pt;
  margin-left:0in;text-indent:0in;line-height:107%'><b>Identi.ca </b><b><span
  style='font-size:9.5pt;line-height:107%'>REST API </span>Method:
  statuses/update</b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.7pt;
  margin-left:0in;text-indent:0in;line-height:107%'>Updates the authenticating
  user’s status. Requires the <span style='font-size:10.0pt;line-height:107%;
  font-family:"Liberation Mono"'>status </span>parameter specified below.</p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:27.0pt;
  margin-left:0in;text-indent:0in;line-height:107%'>Request must be a <span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>POST</span>.</p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.85pt;
  margin-left:0in;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.5pt;line-height:107%'>URL</span></b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:20.75pt;
  margin-left:22.5pt;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>https://identi.ca/api/statuses/update.format</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:351.1pt;margin-bottom:
  10.25pt;margin-left:22.5pt;text-indent:-22.5pt;line-height:167%'><b>Formats </b><span
  style='font-size:10.0pt;line-height:167%;font-family:"Liberation Mono"'>xml</span>,
  <span style='font-size:10.0pt;line-height:167%;font-family:"Liberation Mono"'>json</span>,
  <span style='font-size:10.0pt;line-height:167%;font-family:"Liberation Mono"'>rss</span>,
  <span style='font-size:10.0pt;line-height:167%;font-family:"Liberation Mono"'>atom</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.0pt;
  margin-left:0in;text-indent:0in;line-height:107%'><b><span style='font-size:
  9.5pt;line-height:107%'>HTTP </span>Method(s)</b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:20.75pt;
  margin-left:22.5pt;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>POST</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.0pt;
  margin-left:0in;text-indent:0in;line-height:107%'><b>Requires Authentication</b></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:17.85pt;
  margin-left:22.5pt;text-indent:0in;line-height:107%'>true</p>
  <p class=MsoNormal style='margin-top:0in;margin-right:71.15pt;margin-bottom:
  0in;margin-left:22.5pt;text-indent:-22.5pt;line-height:107%'><b>Parameters </b><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>status</span>.
  Required. The text of your status update. <span style='font-size:9.5pt;
  line-height:107%'>URL</span>-encode as necessary.</p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.25pt;margin-left:16.4pt'>How does this work? To publish a new message on
Identi.ca, you need to issue an <span style='font-size:9.5pt;line-height:154%'>HTTP
</span><span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>POST
</span>request to <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>http://identi.ca/api/statuses/update.<i>format</i></span>.
(The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>format
</span>bit is not part of the <span style='font-size:9.5pt;line-height:154%'>URL</span>;
you replace it with the data format you want the server to return in response
to your request. So if you want a response in <span style='font-size:9.5pt;
line-height:154%'>XML</span>, you would post the request to <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>https://identi.ca/api/statuses/update.xml</span>.)
The request needs to include a parameter called <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>status</span>, which contains
the text of your status update. And the request needs to be authenticated.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>Authenticated? Sure. To update your status on
Identi.ca, you need to prove who you are. Identi.ca is not a wiki; only you can
update your own status. Identi.ca uses <a
href="http://en.wikipedia.org/wiki/Basic_access_authentication"><span
style='font-size:9.5pt;line-height:154%;color:black'>HTTP</span></a><u><span
style='font-size:9.5pt;line-height:154%'> </span></u><a
href="http://en.wikipedia.org/wiki/Basic_access_authentication"><span
style='color:black'>Basic</span></a><u> </u><a
href="http://en.wikipedia.org/wiki/Basic_access_authentication"><span
style='color:black'>Authentication</span></a><u> </u>(<i>a.k.a. </i><a
href="http://www.ietf.org/rfc/rfc2617.txt"><span style='color:black'>RFC</span></a><u>
</u><a href="http://www.ietf.org/rfc/rfc2617.txt"><span style='color:black'>2617</span></a>)
over</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.8pt;margin-left:16.4pt'><span style='font-size:9.5pt;line-height:154%'>SSL </span>to
provide secure but easy-to-use authentication. <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>httplib2 </span>supports both <span
style='font-size:9.5pt;line-height:154%'>SSL </span>and <span style='font-size:
9.5pt;line-height:154%'>HTTP </span>Basic Authentication, so this part is easy.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
23.2pt;margin-left:16.4pt'>A <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>POST </span>request is different from a <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>GET </span>request,
because it includes a <i>payload</i>. The payload is the data you want to send
to the server. The one piece of data that this <span style='font-size:9.5pt;
line-height:154%'>API </span>method <i>requires </i>is <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>status</span>, and it
should be <i><span style='font-size:9.5pt;line-height:154%'>URL</span>-encoded</i>.
This is a very simple serialization format that takes a set of key-value pairs
(<i>i.e. </i>a <u>dictionary</u>) and transforms it into a string.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.9pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>from urllib.parse import urlencode              </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>data =
{'status': 'Test update from Python 3'} </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>urlencode(data)                                 </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:32.05pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'status=Test+update+from+Python+3'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.3pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Python comes
with a utility function to <span style='font-size:9.5pt;line-height:107%'>URL</span>-encode
a dictionary: <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>urllib.parse.urlencode()</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>This is the sort of dictionary that the Identi.ca <span
style='font-size:9.5pt;line-height:154%'>API </span>is looking for. It contains
one key, <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>status</span>,
whose value is the text of a single status update.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>This is what the <span style='font-size:9.5pt;line-height:154%'>URL</span>-encoded
string looks like. This is the <i>payload </i>that will be sent “on the wire”
to the Identi.ca <span style='font-size:9.5pt;line-height:154%'>API </span>server
in your <span style='font-size:9.5pt;line-height:154%'>HTTP </span><span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>POST </span>request.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>from
urllib.parse import urlencode</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>import
httplib2</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>httplib2.debuglevel
= 1</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>h =
httplib2.Http('.cache')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>data =
{'status': 'Test update from Python 3'}</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>h.add_credentials('diveintomark',
'MY_SECRET_PASSWORD', 'identi.ca')    </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.4pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>resp,
content = h.request('https://identi.ca/api/statuses/update.xml',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.75pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>...     </span><span style='font-size:10.0pt;line-height:110%;
font-family:"Liberation Mono"'>'POST',                                                             </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.9pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>...     </span><span style='font-size:10.0pt;line-height:110%;
font-family:"Liberation Mono"'>urlencode(data),                                                    </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:28.55pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>...     </span><span style='font-size:10.0pt;line-height:110%;
font-family:"Liberation Mono"'>headers={'Content-Type':
'application/x-www-form-urlencoded'})      </span><span style='font-family:
"DejaVu Sans",sans-serif;color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>This is how <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>httplib2 </span>handles authentication. Store your username
and password with the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>add_credentials() </span>method. When <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>httplib2
</span>tries to issue the request, the server will respond with a <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>401
Unauthorized </span>status code, and it will list which authentication methods
it supports (in the <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>WWW-</span></p>

<p class=MsoNormal align=right style='margin-top:0in;margin-right:38.6pt;
margin-bottom:7.65pt;margin-left:.5pt;text-align:right;line-height:110%'><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>Authenticate
</span>header). <span style='font-size:10.0pt;line-height:110%;font-family:
"Liberation Mono"'>httplib2 </span>will automatically construct an <span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>Authorization
</span>header and re-request the</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.5pt;
margin-left:16.4pt;line-height:110%'><span style='font-size:9.5pt;line-height:
110%'>URL</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.2pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The second
parameter is the type of <span style='font-size:9.5pt;line-height:107%'>HTTP </span>request,
in this case <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>POST</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The third parameter is the <i>payload </i>to send to the server. We’re
sending the <span style='font-size:9.5pt;line-height:154%'>URL</span>-encoded
dictionary with a status message.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
48.55pt;margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Finally, we need to tell the server that the payload is <span
style='font-size:9.5pt;line-height:154%'>URL</span>-encoded data.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:85.2pt;margin-bottom:
41.25pt;margin-left:75.95pt;text-indent:-29.3pt'><span style='font-size:24.0pt;
line-height:154%;font-family:"Calibri",sans-serif'>&#9758; </span>The third
parameter to the <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>add_credentials() </span>method is the domain in which the
credentials are valid. You should always specify this! If you leave out the
domain and later reuse the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>httplib2.Http </span>object on a different
authenticated site, <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>httplib2 </span>might end up leaking one site’s username and
password to the other site.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>This is what goes over the wire:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:284.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'># continued from the previous
example send: b'POST /api/statuses/update.xml HTTP/1.1 Host: identi.ca</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:320.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>Accept-Encoding: identity
Content-Length: 32</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:212.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:277%'><span style='font-size:10.0pt;
line-height:277%;font-family:"Liberation Mono"'>content-type:
application/x-www-form-urlencoded user-agent: Python-httplib2/$Rev: 259 $
status=Test+update+from+Python+3'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:171.65pt;margin-bottom:
0in;margin-left:37.9pt;line-height:180%'><span style='font-size:10.0pt;
line-height:180%;font-family:"Liberation Mono"'>reply: 'HTTP/1.1 401
Unauthorized'  </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9312; </span><span style='font-size:10.0pt;line-height:180%;
font-family:"Liberation Mono"'>send: b'POST /api/statuses/update.xml HTTP/1.1   </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>Host: identi.ca</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:320.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>Accept-Encoding: identity
Content-Length: 32</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>content-type:
application/x-www-form-urlencoded</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:135.65pt;margin-bottom:
0in;margin-left:37.9pt;line-height:277%'><span style='font-size:10.0pt;
line-height:277%;font-family:"Liberation Mono"'>authorization: Basic
SECRET_HASH_CONSTRUCTED_BY_HTTPLIB2 </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9314; </span><span style='font-size:10.0pt;line-height:277%;
font-family:"Liberation Mono"'>user-agent: Python-httplib2/$Rev: 259 $
status=Test+update+from+Python+3'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.0pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>reply:
'HTTP/1.1 200 OK'                                  </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>After the first request, the server responds with a <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>401
Unauthorized </span>status code. <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>httplib2 </span>will never send
authentication headers unless the server explicitly asks for them. This is how
the server asks for them.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.7pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>httplib2
</span>immediately turns around and requests the same <span style='font-size:
9.5pt;line-height:107%'>URL </span>a second time.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>This time, it
includes the username and password that you added with the <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>add_credentials()
</span>method.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.5pt;margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>It worked!</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>What does the server send back after a successful
request? That depends entirely on the web service <span style='font-size:9.5pt;
line-height:154%'>API</span>. In some protocols (like the <a
href="http://www.ietf.org/rfc/rfc5023.txt"><span style='color:black'>Atom</span></a><u>
</u><a href="http://www.ietf.org/rfc/rfc5023.txt"><span style='color:black'>Publishing</span></a><u>
</u><a href="http://www.ietf.org/rfc/rfc5023.txt"><span style='color:black'>Protocol</span></a>),
the server sends back a <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>201 Created </span>status code and the location
of the newly created resource in the <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>Location </span>header. Identi.ca sends
back a <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>200
OK </span>and an <span style='font-size:9.5pt;line-height:154%'>XML </span>document
containing information about the newly created resource.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'># continued from the previous example</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=518
 style='width:5.4in;margin-left:38.15pt;border-collapse:collapse'>
 <tr style='height:60.3pt'>
  <td width=504 valign=top style='width:378.05pt;padding:0in 0in 0in 0in;
  height:60.3pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>print(content.decode('utf-8'))</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:102.05pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>&lt;?xml
  version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;status&gt;</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:60.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9312;</span></p>
  </td>
 </tr>
 <tr style='height:18.3pt'>
  <td width=504 valign=bottom style='width:378.05pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
  margin-left:6.0pt;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>&lt;text&gt;Test
  update from Python 3&lt;/text&gt;</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9313;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;truncated&gt;false&lt;/truncated&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:44.65pt;line-height:185%'><span style='font-size:10.0pt;line-height:
185%;font-family:"Liberation Mono"'>&lt;created_at&gt;Wed Jun 10 03:53:46 +0000
2009&lt;/created_at&gt;
&lt;in_reply_to_status_id&gt;&lt;/in_reply_to_status_id&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.55pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;source&gt;api&lt;/source&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                    </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>&lt;id&gt;5131472&lt;/id&gt;                                              </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:248.45pt;margin-bottom:
0in;margin-left:44.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>&lt;in_reply_to_user_id&gt;&lt;/in_reply_to_user_id&gt;
&lt;in_reply_to_screen_name&gt;&lt;/in_reply_to_screen_name&gt;
&lt;favorited&gt;false&lt;/favorited&gt; &lt;user&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;id&gt;3212&lt;/id&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;name&gt;Mark Pilgrim&lt;/name&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;screen_name&gt;diveintomark&lt;/screen_name&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;location&gt;27502, US&lt;/location&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:50.65pt;line-height:185%'><span style='font-size:10.0pt;line-height:
185%;font-family:"Liberation Mono"'>&lt;description&gt;tech writer, husband,
father&lt;/description&gt;
&lt;profile_image_url&gt;http://avatar.identi.ca/3212-48-20081216000626.png&lt;/profile_image_url&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:170.45pt;margin-bottom:
0in;margin-left:50.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>&lt;url&gt;http://diveintomark.org/&lt;/url&gt;
&lt;protected&gt;false&lt;/protected&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:56.45pt;margin-bottom:
0in;margin-left:50.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>&lt;followers_count&gt;329&lt;/followers_count&gt;
&lt;profile_background_color&gt;&lt;/profile_background_color&gt;
&lt;profile_text_color&gt;&lt;/profile_text_color&gt;
&lt;profile_link_color&gt;&lt;/profile_link_color&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:50.65pt;line-height:185%'><span style='font-size:10.0pt;line-height:
185%;font-family:"Liberation Mono"'>&lt;profile_sidebar_fill_color&gt;&lt;/profile_sidebar_fill_color&gt;
&lt;profile_sidebar_border_color&gt;&lt;/profile_sidebar_border_color&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:218.45pt;margin-bottom:
0in;margin-left:50.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>&lt;friends_count&gt;2&lt;/friends_count&gt;
&lt;created_at&gt;Wed Jul 02 22:03:58 +0000 2008&lt;/created_at&gt;
&lt;favourites_count&gt;30768&lt;/favourites_count&gt;
&lt;utc_offset&gt;0&lt;/utc_offset&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;time_zone&gt;UTC&lt;/time_zone&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;profile_background_image_url&gt;&lt;/profile_background_image_url&gt;
&lt;profile_background_tile&gt;false&lt;/profile_background_tile&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:164.45pt;margin-bottom:
0in;margin-left:50.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>&lt;statuses_count&gt;122&lt;/statuses_count&gt;
&lt;following&gt;false&lt;/following&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:290.45pt;margin-bottom:
0in;margin-left:37.4pt;text-indent:12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>&lt;notifications&gt;false&lt;/notifications&gt;
&lt;/user&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.35pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;/status&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.15pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:155%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Remember, the
data returned by <span style='font-size:10.0pt;line-height:155%;font-family:
"Liberation Mono"'>httplib2 </span>is always <u>bytes</u>, not a string. To
convert it to a string, you need to decode it using the proper character
encoding. Identi.ca’s <span style='font-size:9.5pt;line-height:155%'>API </span>always
returns results in <span style='font-size:9.5pt;line-height:155%'>UTF</span>-8,
so that part is easy.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.05pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>There’s the text
of the status message we just published.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.5pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>There’s the unique identifier for the new status message. Identi.ca uses
this to construct a <span style='font-size:9.5pt;line-height:154%'>URL </span>for
viewing the message on the web.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=738 height=501 src="Dive%20Into%20Python%203_files/image053.gif"></span></p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:33.45pt;
margin-bottom:31.7pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:17.4pt;margin-left:
16.4pt;line-height:110%'><span style='font-size:18.0pt;line-height:110%'>14.7.
B</span>EYOND <span style='font-size:18.0pt;line-height:110%'>HTTP POST</span></h4>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
18.95pt;margin-left:16.4pt'><span style='font-size:9.5pt;line-height:154%'>HTTP
</span>isn’t limited to <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>GET </span>and <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>POST</span>. Those are
certainly the most common types of requests, especially in web browsers. But
web service <span style='font-size:9.5pt;line-height:154%'>API</span>s can go
beyond <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>GET
</span>and <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>POST</span>,
and <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>httplib2
</span>is ready.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'># continued from the previous example</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>from
xml.etree import ElementTree as etree</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.85pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>tree = etree.fromstring(content)                                          </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.65pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>status_id = tree.findtext('id')                                           </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>status_id</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.75pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'5131472'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.9pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>url =
'https://identi.ca/api/statuses/destroy/{0}.xml'.format(status_id) </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:28.55pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>resp, deleted_content = h.request(url,
'DELETE')                          </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.4pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The server
returned <span style='font-size:9.5pt;line-height:107%'>XML</span>, right? You
know <u>how to parse </u><u><span style='font-size:9.5pt;line-height:107%'>XML</span></u>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>findtext()
</span>method finds the first instance of the given expression and extracts its
text content. In this case, we’re just looking for an <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>&lt;id&gt; </span>element.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Based on the text content of the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>&lt;id&gt; </span>element, we
can construct a <span style='font-size:9.5pt;line-height:154%'>URL </span>to
delete the status message we just published.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.3in;margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>To delete a message, you simply issue an <span style='font-size:9.5pt;
line-height:154%'>HTTP </span><span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>DELETE </span>request to that <span
style='font-size:9.5pt;line-height:154%'>URL</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>This is what goes over the wire:</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=518
 style='width:5.4in;margin-left:38.15pt;border-collapse:collapse'>
 <tr style='height:123.3pt'>
  <td width=504 valign=top style='width:378.05pt;padding:0in 0in 0in 0in;
  height:123.3pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:36.05pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:185%'><span style='font-size:
  10.0pt;line-height:185%;font-family:"Liberation Mono"'>send: b'DELETE
  /api/statuses/destroy/5131472.xml HTTP/1.1 Host: identi.ca Accept-Encoding:
  identity</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>user-agent:
  Python-httplib2/$Rev: 259 $</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>'</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:123.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9312;</span></p>
  </td>
 </tr>
 <tr style='height:22.5pt'>
  <td width=504 valign=top style='width:378.05pt;padding:0in 0in 0in 0in;
  height:22.5pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>reply:
  'HTTP/1.1 401 Unauthorized'</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:22.5pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9313;</span></p>
  </td>
 </tr>
 <tr style='height:64.5pt'>
  <td width=504 valign=top style='width:378.05pt;padding:0in 0in 0in 0in;
  height:64.5pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:6.05pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:185%'><span style='font-size:
  10.0pt;line-height:185%;font-family:"Liberation Mono"'>send: b'DELETE
  /api/statuses/destroy/5131472.xml HTTP/1.1 Host: identi.ca</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>Accept-Encoding:
  identity</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:64.5pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9314;</span></p>
  </td>
 </tr>
 <tr style='height:85.5pt'>
  <td width=504 valign=top style='width:378.05pt;padding:0in 0in 0in 0in;
  height:85.5pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:21.0pt;
  margin-left:0in;text-indent:0in;line-height:185%'><span style='font-size:
  10.0pt;line-height:185%;font-family:"Liberation Mono"'>authorization: Basic
  SECRET_HASH_CONSTRUCTED_BY_HTTPLIB2 user-agent: Python-httplib2/$Rev: 259 $</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>'</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:85.5pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9315;</span></p>
  </td>
 </tr>
 <tr style='height:18.3pt'>
  <td width=504 valign=bottom style='width:378.05pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>reply:
  'HTTP/1.1 200 OK'</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9316;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>resp.status</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>200</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>“Delete this
status message.”</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>“I’m sorry,
Dave, I’m afraid I can’t do that.”</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
5.95pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>“Unauthorized<span
style='font-family:"Calibri",sans-serif'>&#8253; </span>Hmmph. Delete this
status message, <i>please</i>…</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>…and here’s my
username and password.”</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.45pt;margin-left:16.65pt;text-indent:-16.65pt'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>“Consider it done!”</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>And just like that, poof, it’s gone.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:45.55pt;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=738 height=449 id="Group 728848"
src="Dive%20Into%20Python%203_files/image054.gif"></span></p>

<p class=MsoNormal align=right style='margin-top:0in;margin-right:293.25pt;
margin-bottom:33.0pt;margin-left:.5pt;text-align:right;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h5 style='margin-top:0in;margin-right:0in;margin-bottom:19.9pt;margin-left:
16.4pt'><span style='font-size:18.0pt;line-height:112%'>14.8. F</span>URTHER <span
style='font-size:18.0pt;line-height:112%'>R</span>EADING</h5>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:27.85pt;
margin-left:17.15pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>httplib2</span>:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://code.google.com/p/httplib2/"><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:black'>httplib2</span></a><u><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'> </span></u><a
href="http://code.google.com/p/httplib2/"><span style='color:black'>project</span></a><u>
</u><a href="http://code.google.com/p/httplib2/"><span style='color:black'>page</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://code.google.com/p/httplib2/wiki/ExamplesPython3"><span
style='color:black'>More</span></a><u> </u><a
href="http://code.google.com/p/httplib2/wiki/ExamplesPython3"><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:black'>httplib2</span></a><u><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'> </span></u><a
href="http://code.google.com/p/httplib2/wiki/ExamplesPython3"><span
style='color:black'>code</span></a><u> </u><a
href="http://code.google.com/p/httplib2/wiki/ExamplesPython3"><span
style='color:black'>examples</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://www.xml.com/pub/a/2006/02/01/doing-http-caching-right-introducing-httplib2.html"><span
style='color:black'>Doing</span></a><u> </u><a
href="http://www.xml.com/pub/a/2006/02/01/doing-http-caching-right-introducing-httplib2.html"><span
style='font-size:9.5pt;line-height:110%;color:black'>HTTP</span></a><u><span
style='font-size:9.5pt;line-height:110%'> </span></u><a
href="http://www.xml.com/pub/a/2006/02/01/doing-http-caching-right-introducing-httplib2.html"><span
style='color:black'>Caching</span></a><u> </u><a
href="http://www.xml.com/pub/a/2006/02/01/doing-http-caching-right-introducing-httplib2.html"><span
style='color:black'>Right:</span></a><u> </u><a
href="http://www.xml.com/pub/a/2006/02/01/doing-http-caching-right-introducing-httplib2.html"><span
style='color:black'>Introducing</span></a><u> </u><a
href="http://www.xml.com/pub/a/2006/02/01/doing-http-caching-right-introducing-httplib2.html"><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:black'>httplib2</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:15.9pt;text-indent:-12.25pt;line-height:307%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://www.xml.com/pub/a/2006/03/29/httplib2-http-persistence-and-authentication.html"><span
style='font-size:10.0pt;line-height:307%;font-family:"Liberation Mono";
color:black'>httplib2</span></a><a
href="http://www.xml.com/pub/a/2006/03/29/httplib2-http-persistence-and-authentication.html"><span
style='color:black'>:</span></a><u> </u><a
href="http://www.xml.com/pub/a/2006/03/29/httplib2-http-persistence-and-authentication.html"><span
style='font-size:9.5pt;line-height:307%;color:black'>HTTP</span></a><u><span
style='font-size:9.5pt;line-height:307%'> </span></u><a
href="http://www.xml.com/pub/a/2006/03/29/httplib2-http-persistence-and-authentication.html"><span
style='color:black'>Persistence</span></a><u> </u><a
href="http://www.xml.com/pub/a/2006/03/29/httplib2-http-persistence-and-authentication.html"><span
style='color:black'>and</span></a><u> </u><a
href="http://www.xml.com/pub/a/2006/03/29/httplib2-http-persistence-and-authentication.html"><span
style='color:black'>Authentication </span></a><span style='font-size:9.5pt;
line-height:307%'>HTTP </span>caching:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.25pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:107%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://www.mnot.net/cache_docs/"><span style='font-size:9.5pt;line-height:
107%;color:black'>HTTP</span></a><u><span style='font-size:9.5pt;line-height:
107%'> </span></u><a href="http://www.mnot.net/cache_docs/"><span
style='color:black'>Caching</span></a><u> </u><a
href="http://www.mnot.net/cache_docs/"><span style='color:black'>Tutorial</span></a><u>
</u>by Mark Nottingham</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://code.google.com/p/doctype/wiki/ArticleHttpCaching"><span
style='color:black'>How</span></a><u> </u><a
href="http://code.google.com/p/doctype/wiki/ArticleHttpCaching"><span
style='color:black'>to</span></a><u> </u><a
href="http://code.google.com/p/doctype/wiki/ArticleHttpCaching"><span
style='color:black'>control</span></a><u> </u><a
href="http://code.google.com/p/doctype/wiki/ArticleHttpCaching"><span
style='color:black'>caching</span></a><u> </u><a
href="http://code.google.com/p/doctype/wiki/ArticleHttpCaching"><span
style='color:black'>with</span></a><u> </u><a
href="http://code.google.com/p/doctype/wiki/ArticleHttpCaching"><span
style='font-size:9.5pt;line-height:110%;color:black'>HTTP</span></a><u><span
style='font-size:9.5pt;line-height:110%'> </span></u><a
href="http://code.google.com/p/doctype/wiki/ArticleHttpCaching"><span
style='color:black'>headers</span></a><u> </u>on Google Doctype</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:27.75pt;
margin-left:16.4pt;line-height:110%'><span style='font-size:9.5pt;line-height:
110%'>RFC</span>s:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://www.ietf.org/rfc/rfc2616.txt"><span style='color:black'>RFC</span></a><u>
</u><a href="http://www.ietf.org/rfc/rfc2616.txt"><span style='color:black'>2616:</span></a><u>
</u><a href="http://www.ietf.org/rfc/rfc2616.txt"><span style='font-size:9.5pt;
line-height:110%;color:black'>HTTP</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://www.ietf.org/rfc/rfc2617.txt"><span style='color:black'>RFC</span></a><u>
</u><a href="http://www.ietf.org/rfc/rfc2617.txt"><span style='color:black'>2617:</span></a><u>
</u><a href="http://www.ietf.org/rfc/rfc2617.txt"><span style='font-size:9.5pt;
line-height:110%;color:black'>HTTP</span></a><u><span style='font-size:9.5pt;
line-height:110%'> </span></u><a href="http://www.ietf.org/rfc/rfc2617.txt"><span
style='color:black'>Basic</span></a><u> </u><a
href="http://www.ietf.org/rfc/rfc2617.txt"><span style='color:black'>Authentication</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://www.ietf.org/rfc/rfc1951.txt"><span style='color:black'>RFC</span></a><u>
</u><a href="http://www.ietf.org/rfc/rfc1951.txt"><span style='color:black'>1951:</span></a><u>
</u><a href="http://www.ietf.org/rfc/rfc1951.txt"><span style='color:black'>deflate</span></a><u>
</u><a href="http://www.ietf.org/rfc/rfc1951.txt"><span style='color:black'>compression</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://www.ietf.org/rfc/rfc1952.txt"><span style='color:black'>RFC</span></a><u>
</u><a href="http://www.ietf.org/rfc/rfc1952.txt"><span style='color:black'>1952:</span></a><u>
</u><a href="http://www.ietf.org/rfc/rfc1952.txt"><span style='color:black'>gzip</span></a><u>
</u><a href="http://www.ietf.org/rfc/rfc1952.txt"><span style='color:black'>compression</span></a><br
clear=all style='page-break-before:always'>
</p>

<h3 style='margin-top:0in;margin-right:22.2pt;margin-bottom:0in;margin-left:
16.4pt;line-height:139%'><span style='font-size:24.0pt;line-height:139%'>C</span><span
style='font-size:19.0pt;line-height:139%'>HAPTER </span><span style='font-size:
24.0pt;line-height:139%'>15. C</span><span style='font-size:19.0pt;line-height:
139%'>ASE </span><span style='font-size:24.0pt;line-height:139%'>S</span><span
style='font-size:19.0pt;line-height:139%'>TUDY</span><span style='font-size:
24.0pt;line-height:139%'>: P</span><span style='font-size:19.0pt;line-height:
139%'>ORTING </span><span style='font-size:24.0pt;line-height:139%;font-family:
"Liberation Mono";font-weight:normal'>chardet </span><span style='font-size:
19.0pt;line-height:139%'>TO </span><span style='font-size:24.0pt;line-height:
139%'>P</span><span style='font-size:19.0pt;line-height:139%'>YTHON </span><span
style='font-size:24.0pt;line-height:139%'>3</span></h3>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:39.95pt;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=736 height=4 id="Group 728947"
src="Dive%20Into%20Python%203_files/image001.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.25in;margin-bottom:65.35pt;
margin-left:366.5pt;text-indent:-31.2pt;line-height:160%'><span
style='font-size:13.0pt;line-height:160%;font-family:"Calibri",sans-serif'>&#10077;
</span><i>Words, words. They’re all we have to go on. </i><span
style='font-size:13.0pt;line-height:160%;font-family:"Calibri",sans-serif'>&#10078;
</span><i>— </i><a href="http://www.imdb.com/title/tt0100519/quotes"><i><span
style='color:black'>Rosencrantz</span></i></a><i><u> </u></i><a
href="http://www.imdb.com/title/tt0100519/quotes"><i><span style='color:black'>and</span></i></a><i><u>
</u></i><a href="http://www.imdb.com/title/tt0100519/quotes"><i><span
style='color:black'>Guildenstern</span></i></a><i><u> </u></i><a
href="http://www.imdb.com/title/tt0100519/quotes"><i><span style='color:black'>are</span></i></a><i><u>
</u></i><a href="http://www.imdb.com/title/tt0100519/quotes"><i><span
style='color:black'>Dead</span></i></a></p>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:65.85pt;margin-left:
16.4pt;line-height:110%'><span style='font-size:18.0pt;line-height:110%'>15.1.
D</span>IVING <span style='font-size:18.0pt;line-height:110%'>I</span>N</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.35pt;margin-left:16.4pt'><span style='font-size:48.0pt;line-height:154%;
font-family:"DejaVu Serif",serif;color:#888888'>Q </span>uestion: what’s the #1
cause of gibberish text on the web, in your inbox, and across every computer
system ever written? It’s character encoding. In <u>Chapter 3</u>, I talked
about the history of character encoding and the creation of Unicode, the “one
encoding to rule them all.” I’d love it if I never had to see a gibberish
character on a web page again, because all authoring systems stored accurate
encoding information, all transfer protocols were Unicode-aware, and every
system that handled text maintained perfect fidelity when converting between
encodings.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.45pt;margin-left:16.4pt'>I’d also like a pony.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.45pt;margin-left:16.4pt'>A Unicode pony.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.45pt;margin-left:16.4pt'>A Unipony, as it were.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
46.55pt;margin-left:16.4pt'>I’ll settle for character encoding auto-detection.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:33.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:17.35pt;
margin-left:16.4pt;line-height:112%'><b><span style='font-size:18.0pt;
line-height:112%;font-family:"DejaVu Serif",serif'>15.2. W</span></b><b><span
style='font-size:14.5pt;line-height:112%;font-family:"DejaVu Serif",serif'>HAT
IS </span></b><b><span style='font-size:18.0pt;line-height:112%;font-family:
"DejaVu Serif",serif'>C</span></b><b><span style='font-size:14.5pt;line-height:
112%;font-family:"DejaVu Serif",serif'>HARACTER </span></b><b><span
style='font-size:18.0pt;line-height:112%;font-family:"DejaVu Serif",serif'>E</span></b><b><span
style='font-size:14.5pt;line-height:112%;font-family:"DejaVu Serif",serif'>NCODING
</span></b><b><span style='font-size:18.0pt;line-height:112%;font-family:"DejaVu Serif",serif'>A</span></b><b><span
style='font-size:14.5pt;line-height:112%;font-family:"DejaVu Serif",serif'>UTO</span></b><b><span
style='font-size:18.0pt;line-height:112%;font-family:"DejaVu Serif",serif'>-D</span></b><b><span
style='font-size:14.5pt;line-height:112%;font-family:"DejaVu Serif",serif'>ETECTION</span></b><b><span
style='font-size:18.0pt;line-height:112%;font-family:"DejaVu Serif",serif'>?</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
22.0pt;margin-left:16.4pt'>It means taking a sequence of bytes in an unknown
character encoding, and attempting to determine the encoding so you can read
the text. It’s like cracking a code when you don’t have the decryption key.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:25.25pt;
margin-left:16.4pt;line-height:110%'><b><span style='font-size:13.0pt;
line-height:110%;font-family:"DejaVu Serif",serif'>15.2.1. I</span></b><b><span
style='font-size:10.5pt;line-height:110%;font-family:"DejaVu Serif",serif'>SN</span></b><b><span
style='font-size:13.0pt;line-height:110%;font-family:"DejaVu Serif",serif'>’</span></b><b><span
style='font-size:10.5pt;line-height:110%;font-family:"DejaVu Serif",serif'>T </span></b><b><span
style='font-size:13.0pt;line-height:110%;font-family:"DejaVu Serif",serif'>T</span></b><b><span
style='font-size:10.5pt;line-height:110%;font-family:"DejaVu Serif",serif'>HAT </span></b><b><span
style='font-size:13.0pt;line-height:110%;font-family:"DejaVu Serif",serif'>I</span></b><b><span
style='font-size:10.5pt;line-height:110%;font-family:"DejaVu Serif",serif'>MPOSSIBLE</span></b><b><span
style='font-size:13.0pt;line-height:110%;font-family:"DejaVu Serif",serif'>?</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:34.4pt;margin-bottom:
20.55pt;margin-left:16.4pt'>In general, yes. However, some encodings are
optimized for specific languages, and languages are not random. Some character
sequences pop up all the time, while other sequences make no sense. A person
fluent in English who opens a newspaper and finds “txzqJv 2!dasd0a QqdKjvz”
will instantly recognize that that isn’t English (even though it is composed
entirely of English letters). By studying lots of “typical” text, a computer
algorithm can simulate this kind of fluency and make an educated guess about a
text’s language.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
22.0pt;margin-left:16.4pt'>In other words, encoding detection is really
language detection, combined with knowledge of which languages tend to use
which character encodings.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:25.25pt;
margin-left:16.4pt;line-height:110%'><b><span style='font-size:13.0pt;
line-height:110%;font-family:"DejaVu Serif",serif'>15.2.2. D</span></b><b><span
style='font-size:10.5pt;line-height:110%;font-family:"DejaVu Serif",serif'>OES </span></b><b><span
style='font-size:13.0pt;line-height:110%;font-family:"DejaVu Serif",serif'>S</span></b><b><span
style='font-size:10.5pt;line-height:110%;font-family:"DejaVu Serif",serif'>UCH </span></b><b><span
style='font-size:13.0pt;line-height:110%;font-family:"DejaVu Serif",serif'>A</span></b><b><span
style='font-size:10.5pt;line-height:110%;font-family:"DejaVu Serif",serif'>N </span></b><b><span
style='font-size:13.0pt;line-height:110%;font-family:"DejaVu Serif",serif'>A</span></b><b><span
style='font-size:10.5pt;line-height:110%;font-family:"DejaVu Serif",serif'>LGORITHM
</span></b><b><span style='font-size:13.0pt;line-height:110%;font-family:"DejaVu Serif",serif'>E</span></b><b><span
style='font-size:10.5pt;line-height:110%;font-family:"DejaVu Serif",serif'>XIST</span></b><b><span
style='font-size:13.0pt;line-height:110%;font-family:"DejaVu Serif",serif'>?</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
45.65pt;margin-left:16.4pt'>As it turns out, yes. All major browsers have
character encoding auto-detection, because the web is full of pages that have
no encoding information whatsoever. <a
href="http://lxr.mozilla.org/seamonkey/source/extensions/universalchardet/src/base/"><span
style='color:black'>Mozilla</span></a><u> </u><a
href="http://lxr.mozilla.org/seamonkey/source/extensions/universalchardet/src/base/"><span
style='color:black'>Firefox</span></a><u> </u><a
href="http://lxr.mozilla.org/seamonkey/source/extensions/universalchardet/src/base/"><span
style='color:black'>contains</span></a><u> </u><a
href="http://lxr.mozilla.org/seamonkey/source/extensions/universalchardet/src/base/"><span
style='color:black'>an</span></a><u> </u><a
href="http://lxr.mozilla.org/seamonkey/source/extensions/universalchardet/src/base/"><span
style='color:black'>encoding</span></a><u> </u><a
href="http://lxr.mozilla.org/seamonkey/source/extensions/universalchardet/src/base/"><span
style='color:black'>auto-detection </span></a><a
href="http://lxr.mozilla.org/seamonkey/source/extensions/universalchardet/src/base/"><span
style='color:black'>library</span></a><u> </u>which is open source. <a
href="http://chardet.feedparser.org/"><span style='color:black'>I</span></a><u>
</u><a href="http://chardet.feedparser.org/"><span style='color:black'>ported</span></a><u>
</u><a href="http://chardet.feedparser.org/"><span style='color:black'>the</span></a><u>
</u><a href="http://chardet.feedparser.org/"><span style='color:black'>library</span></a><u>
</u><a href="http://chardet.feedparser.org/"><span style='color:black'>to</span></a><u>
</u><a href="http://chardet.feedparser.org/"><span style='color:black'>Python</span></a><u>
</u><a href="http://chardet.feedparser.org/"><span style='color:black'>2</span></a><u>
</u>and dubbed it the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>chardet </span>module. This chapter will take
you step-by-step through the process of porting the <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>chardet </span>module
from Python 2 to Python 3.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:33.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h5 style='margin-top:0in;margin-right:0in;margin-bottom:19.5pt;margin-left:
16.4pt'><span style='font-size:18.0pt;line-height:112%'>15.3. I</span>NTRODUCING
<span style='font-size:18.0pt;line-height:112%'>T</span>HE <span
style='font-size:18.0pt;line-height:112%;font-family:"Liberation Mono";
font-weight:normal'>chardet </span><span style='font-size:18.0pt;line-height:
112%'>M</span>ODULE</h5>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>Before we set off porting the code, it would help if
you understood how the code worked! This is a brief guide to navigating the
code itself. The <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>chardet </span>library is too large to include inline here,
but you can <a href="http://chardet.feedparser.org/download/"><span
style='color:black'>download</span></a><u> </u><a
href="http://chardet.feedparser.org/download/"><span style='color:black'>it</span></a><u>
</u><a href="http://chardet.feedparser.org/download/"><span style='color:black'>from</span></a><u>
</u><a href="http://chardet.feedparser.org/download/"><span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono";color:black'>chardet.feedparser.org</span></a>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'><img width=298 height=1
src="Dive%20Into%20Python%203_files/image033.gif" align=left hspace=12>The main
entry point for the detection algorithm is <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>universaldetector.py</span>,
which has one class, <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>UniversalDetector</span>. (You might think the main entry
point is the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>detect
</span>function in <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>chardet/__init__.py</span>, but that’s really just a
convenience function that creates a <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>UniversalDetector </span>object, calls it,
and returns its</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.3pt;margin-left:16.4pt'>result.)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.65pt;margin-left:16.4pt'>There are 5 categories of encodings that <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>UniversalDetector
</span>handles:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span><span style='font-size:9.5pt;line-height:154%'>UTF</span>-<span
style='font-size:9.5pt;line-height:154%'>N </span>with a Byte Order Mark (<span
style='font-size:9.5pt;line-height:154%'>BOM</span>). This includes <span
style='font-size:9.5pt;line-height:154%'>UTF</span>-8, both Big-Endian and
Little-Endian variants of <span style='font-size:9.5pt;line-height:154%'>UTF</span>-16,
and all 4 byte-order variants of <span style='font-size:9.5pt;line-height:154%'>UTF</span>-32.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Escaped encodings, which are entirely 7-bit <span style='font-size:9.5pt;
line-height:154%'>ASCII </span>compatible, where non-<span style='font-size:
9.5pt;line-height:154%'>ASCII </span>characters start with an escape sequence.
Examples: <span style='font-size:9.5pt;line-height:154%'>ISO</span>-2022-<span
style='font-size:9.5pt;line-height:154%'>JP </span>(Japanese) and</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.1pt;margin-left:16.4pt;line-height:107%'><span style='font-size:9.5pt;
line-height:107%'>HZ</span>-<span style='font-size:9.5pt;line-height:107%'>GB</span>-2312
(Chinese).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Multi-byte encodings, where each character is represented by a variable
number of bytes. Examples: <span style='font-size:9.5pt;line-height:154%'>BIG</span>5
(Chinese), <span style='font-size:9.5pt;line-height:154%'>SHIFT</span>_<span
style='font-size:9.5pt;line-height:154%'>JIS </span>(Japanese), <span
style='font-size:9.5pt;line-height:154%'>EUC</span>-<span style='font-size:
9.5pt;line-height:154%'>KR </span>(Korean), and <span style='font-size:9.5pt;
line-height:154%'>UTF</span>-8 without a <span style='font-size:9.5pt;
line-height:154%'>BOM</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.7pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Single-byte
encodings, where each character is represented by one byte. Examples: <span
style='font-size:9.5pt;line-height:107%'>KOI</span>8-<span style='font-size:
9.5pt;line-height:107%'>R </span>(Russian),</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.4pt;margin-left:16.4pt;line-height:107%'><span style='font-size:9.5pt;
line-height:107%'>WINDOWS</span>-1255 (Hebrew), and <span style='font-size:
9.5pt;line-height:107%'>TIS</span>-620 (Thai).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.85pt;margin-left:16.65pt;text-indent:-16.65pt'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span><span style='font-size:9.5pt;line-height:154%'>WINDOWS</span>-1252,
which is used primarily on Microsoft Windows by middle managers who wouldn’t
know a character encoding from a hole in the ground.</p>

<h6 style='margin-left:16.4pt'><span style='font-size:13.0pt;line-height:110%'>15.3.1.
</span>UTF<span style='font-size:13.0pt;line-height:110%'>-</span>N <span
style='font-size:13.0pt;line-height:110%'>W</span>ITH <span style='font-size:
13.0pt;line-height:110%'>A </span>BOM</h6>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.3pt;margin-left:16.4pt;line-height:107%'>If the text starts with a <span
style='font-size:9.5pt;line-height:107%'>BOM</span>, we can reasonably assume
that the text is encoded in <span style='font-size:9.5pt;line-height:107%'>UTF</span>-8,
<span style='font-size:9.5pt;line-height:107%'>UTF</span>-16, or</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'><span style='font-size:9.5pt;line-height:154%'>UTF</span>-32.
(The <span style='font-size:9.5pt;line-height:154%'>BOM </span>will tell us
exactly which one; that’s what it’s for.) This is handled inline in <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>UniversalDetector</span>,
which returns the result immediately without any further processing.</p>

<h6 style='margin-left:16.4pt'><span style='font-size:13.0pt;line-height:110%'>15.3.2.
E</span>SCAPED <span style='font-size:13.0pt;line-height:110%'>E</span>NCODINGS</h6>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
7.65pt;margin-left:16.4pt;line-height:107%'>If the text contains a recognizable
escape sequence that might indicate an escaped encoding,</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:27.55pt;
margin-left:17.15pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>UniversalDetector </span>creates an <span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>EscCharSetProber
</span>(defined in <span style='font-size:10.0pt;line-height:110%;font-family:
"Liberation Mono"'>escprober.py</span>) and feeds it the text.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.1in;margin-left:16.4pt;line-height:107%'><span style='font-size:10.0pt;
line-height:107%;font-family:"Liberation Mono"'>EscCharSetProber </span>creates
a series of state machines, based on models of <span style='font-size:9.5pt;
line-height:107%'>HZ</span>-<span style='font-size:9.5pt;line-height:107%'>GB</span>-2312,
<span style='font-size:9.5pt;line-height:107%'>ISO</span>-2022-<span
style='font-size:9.5pt;line-height:107%'>CN</span>,</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'><span style='font-size:9.5pt;line-height:154%'>ISO</span>-2022-<span
style='font-size:9.5pt;line-height:154%'>JP</span>, and <span style='font-size:
9.5pt;line-height:154%'>ISO</span>-2022-<span style='font-size:9.5pt;
line-height:154%'>KR </span>(defined in <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>escsm.py</span>). <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>EscCharSetProber
</span>feeds the text to each of these state machines, one byte at a time. If
any state machine ends up uniquely identifying the encoding,</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.95pt;margin-left:16.4pt'><span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>EscCharSetProber </span>immediately returns the
positive result to <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>UniversalDetector</span>, which returns it to the caller. If
any state machine hits an illegal sequence, it is dropped and processing
continues with the other state machines.</p>

<h6 style='margin-left:16.4pt'><span style='font-size:13.0pt;line-height:110%'>15.3.3.
M</span>ULTI<span style='font-size:13.0pt;line-height:110%'>-B</span>YTE <span
style='font-size:13.0pt;line-height:110%'>E</span>NCODINGS</h6>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.4pt;margin-left:16.4pt'>Assuming no <span style='font-size:9.5pt;line-height:
154%'>BOM</span>, <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>UniversalDetector </span>checks whether the text contains
any high-bit characters. If so, it creates a series of “probers” for detecting
multi-byte encodings, single-byte encodings, and as a last resort, <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>windows-1252</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>The multi-byte encoding prober, <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>MBCSGroupProber
</span>(defined in <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>mbcsgroupprober.py</span>), is really just a shell that
manages a group of other probers, one for each multi-byte encoding: <span
style='font-size:9.5pt;line-height:154%'>BIG</span>5, <span style='font-size:
9.5pt;line-height:154%'>GB</span>2312, <span style='font-size:9.5pt;line-height:
154%'>EUC</span>-<span style='font-size:9.5pt;line-height:154%'>TW</span>, <span
style='font-size:9.5pt;line-height:154%'>EUC</span>-</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'><span style='font-size:9.5pt;line-height:154%'>KR</span>,
<span style='font-size:9.5pt;line-height:154%'>EUC</span>-<span
style='font-size:9.5pt;line-height:154%'>JP</span>, <span style='font-size:
9.5pt;line-height:154%'>SHIFT</span>_<span style='font-size:9.5pt;line-height:
154%'>JIS</span>, and <span style='font-size:9.5pt;line-height:154%'>UTF</span>-8.
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>MBCSGroupProber
</span>feeds the text to each of these encoding-specific probers and checks the
results. If a prober reports that it has found an illegal byte sequence, it is
dropped from further processing (so that, for instance, any subsequent calls to
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>UniversalDetector</span>.<span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>feed() </span>will
skip that prober). If a prober reports that it is reasonably confident that it
has detected the encoding,</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
22.25pt;margin-left:16.4pt'><span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>MBCSGroupProber </span>reports this positive
result to <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>UniversalDetector</span>,
which reports the result to the caller.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>Most of the multi-byte encoding probers are inherited
from <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>MultiByteCharSetProber
</span>(defined in <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>mbcharsetprober.py</span>), and simply hook up the
appropriate state machine and distribution analyzer and let</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'><span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>MultiByteCharSetProber </span>do the rest of the
work. <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>MultiByteCharSetProber
</span>runs the text through the encoding-specific state machine, one byte at a
time, to look for byte sequences that would indicate a conclusive positive or
negative result. At the same time, <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>MultiByteCharSetProber </span>feeds the
text to an encoding-specific distribution analyzer.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
1.35pt;margin-left:16.4pt'>The distribution analyzers (each defined in <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>chardistribution.py</span>)
use language-specific models of which characters are used most frequently. Once
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>MultiByteCharSetProber
</span>has fed enough text to the distribution analyzer, it calculates a
confidence rating based on the number of frequently-used characters, the total
number of characters, and a language-specific distribution ratio. If the
confidence is high enough,</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.55pt;margin-left:16.4pt'><span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>MultiByteCharSetProber </span>returns the result
to <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>MBCSGroupProber</span>,
which returns it to <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>UniversalDetector</span>, which returns it to the caller.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.7pt;margin-left:16.4pt'>The case of Japanese is more difficult.
Single-character distribution analysis is not always sufficient to distinguish
between <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>EUC-JP
</span>and <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>SHIFT_JIS</span>,
so the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>SJISProber
</span>(defined in <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>sjisprober.py</span>) also uses 2-character distribution
analysis. <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>SJISContextAnalysis
</span>and <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>EUCJPContextAnalysis
</span>(both defined in <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>jpcntx.py </span>and both inheriting from a
common <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>JapaneseContextAnalysis
</span>class) check the frequency of Hiragana syllabary characters within the
text. Once enough text has been processed, they return a confidence level to <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>SJISProber</span>,
which checks both analyzers and returns the higher confidence level to <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>MBCSGroupProber</span>.</p>

<h6 style='margin-left:16.4pt'><span style='font-size:13.0pt;line-height:110%'>15.3.4.
S</span>INGLE<span style='font-size:13.0pt;line-height:110%'>-B</span>YTE <span
style='font-size:13.0pt;line-height:110%'>E</span>NCODINGS</h6>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
7.3pt;margin-left:16.4pt;line-height:107%'>The single-byte encoding prober, <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>SBCSGroupProber</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
2.25pt;margin-left:16.4pt'><img width=298 height=1
src="Dive%20Into%20Python%203_files/image033.gif" align=left hspace=12>(defined
in <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>sbcsgroupprober.py</span>),
is also just a shell that manages a group of other probers, one for each
combination of single-byte encoding and language:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.0pt;margin-bottom:
.5pt;margin-left:17.15pt;line-height:162%'><span style='font-size:10.0pt;
line-height:162%;font-family:"Liberation Mono"'>windows-1251</span>, <span
style='font-size:10.0pt;line-height:162%;font-family:"Liberation Mono"'>KOI8-R</span>,
<span style='font-size:10.0pt;line-height:162%;font-family:"Liberation Mono"'>ISO-8859-5</span>,
<span style='font-size:10.0pt;line-height:162%;font-family:"Liberation Mono"'>MacCyrillic</span>,
<span style='font-size:10.0pt;line-height:162%;font-family:"Liberation Mono"'>IBM855</span>,
and <span style='font-size:10.0pt;line-height:162%;font-family:"Liberation Mono"'>IBM866
</span>(Russian); <span style='font-size:10.0pt;line-height:162%;font-family:
"Liberation Mono"'>ISO-8859-7 </span>and <span style='font-size:10.0pt;
line-height:162%;font-family:"Liberation Mono"'>windows-1253 </span>(Greek); <span
style='font-size:10.0pt;line-height:162%;font-family:"Liberation Mono"'>ISO-8859-5
</span>and <span style='font-size:10.0pt;line-height:162%;font-family:"Liberation Mono"'>windows-1251
</span>(Bulgarian); <span style='font-size:10.0pt;line-height:162%;font-family:
"Liberation Mono"'>ISO-8859-2 </span>and <span style='font-size:10.0pt;
line-height:162%;font-family:"Liberation Mono"'>windows-1250 </span>(Hungarian);</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.0pt;margin-bottom:
22.1pt;margin-left:17.15pt;line-height:150%'><span style='font-size:10.0pt;
line-height:150%;font-family:"Liberation Mono"'>TIS-620 </span>(Thai); <span
style='font-size:10.0pt;line-height:150%;font-family:"Liberation Mono"'>windows-1255
</span>and <span style='font-size:10.0pt;line-height:150%;font-family:"Liberation Mono"'>ISO-8859-8
</span>(Hebrew).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.05pt;margin-left:16.4pt'><span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>SBCSGroupProber </span>feeds the text to each of
these encoding+language-specific probers and checks the results. These probers
are all implemented as a single class, <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>SingleByteCharSetProber </span>(defined
in <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>sbcharsetprober.py</span>),
which takes a language model as an argument. The language model defines how
frequently different 2-character sequences appear in typical text. <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>SingleByteCharSetProber
</span>processes the text and tallies the most frequently used 2-character
sequences. Once enough text has been processed, it calculates a confidence
level based on the number of frequently-used sequences, the total number of
characters, and a language-specific distribution ratio.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.45pt;margin-left:16.4pt'>Hebrew is handled as a special case. If the text
appears to be Hebrew based on 2-character distribution analysis, <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>HebrewProber
</span>(defined in <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>hebrewprober.py</span>) tries to distinguish between Visual
Hebrew (where the source text actually stored “backwards” line-by-line, and
then displayed verbatim so it can be read from right to left) and Logical
Hebrew (where the source text is stored in reading order and then rendered
right-to-left by the client). Because certain characters are encoded
differently based on whether they appear in the middle of or at the end of a
word, we can make a reasonable guess about direction of the source text, and
return the appropriate encoding (<span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>windows-1255 </span>for Logical Hebrew, or <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>ISO-8859-8
</span>for Visual Hebrew).</p>

<p class=MsoHeading7 style='margin-top:0in;margin-right:0in;margin-bottom:.35in;
margin-left:16.4pt;line-height:122%'><span style='font-size:13.0pt;line-height:
122%'>15.3.5. </span><span style='font-size:13.0pt;line-height:122%;font-family:
"Liberation Mono";font-weight:normal'>windows-1252</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
45.6pt;margin-left:16.4pt'>If <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>UniversalDetector </span>detects a high-bit
character in the text, but none of the other multi-byte or singlebyte encoding
probers return a confident result, it creates a <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>Latin1Prober </span>(defined in
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>latin1prober.py</span>)
to try to detect English text in a <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>windows-1252 </span>encoding. This
detection is inherently unreliable, because English letters are encoded in the
same way in many different encodings. The only way to distinguish <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>windows-1252
</span>is through commonly used symbols like smart quotes, curly apostrophes,
copyright symbols, and the like. <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>Latin1Prober </span>automatically reduces
its confidence rating to allow more accurate probers to win if at all possible.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:33.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h5 style='margin-top:0in;margin-right:0in;margin-bottom:19.6pt;margin-left:
16.4pt'><span style='font-size:18.0pt;line-height:112%'>15.4. R</span>UNNING <span
style='font-size:18.0pt;line-height:112%;font-family:"Liberation Mono";
font-weight:normal'>2to3</span></h5>

<p class=MsoNormal style='margin-top:0in;margin-right:44.05pt;margin-bottom:
21.15pt;margin-left:16.4pt'>We’re going to migrate the <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>chardet </span>module
from Python 2 to Python 3. Python 3 comes with a utility script called <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>2to3</span>,
which takes your actual Python 2 source code as input and auto-converts as much
as it can to Python 3. In some cases this is easy — a function was renamed or
moved to a different module — but in other cases it can get pretty complex. To
get a sense of all that it <i>can </i>do, refer to the appendix, <u>Porting
code to Python 3 with </u><u><span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>2to3</span></u>. In this chapter, we’ll start by
running <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>2to3
</span>on the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>chardet
</span>package, but as you’ll see, there will still be a lot of work to do
after the automated tools have performed their magic.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>The main <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>chardet </span>package is split across
several different files, all in the same directory. The <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>2to3 </span>script makes
it easy to convert multiple files at once: just pass a directory as a command
line argument, and <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>2to3 </span>will convert each of the files in turn.<br
clear=all style='page-break-before:always'>
</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>C:\home\chardet&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>python
c:\Python30\Tools\Scripts\2to3.py -w chardet\</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:176.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>RefactoringTool: Skipping
implicit fixer: buffer RefactoringTool: Skipping implicit fixer: idioms</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:242.45pt;margin-bottom:
21.0pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>RefactoringTool: Skipping
implicit fixer: set_literal RefactoringTool: Skipping implicit fixer: ws_comma
--- chardet\__init__.py (original) +++ chardet\__init__.py (refactored) @@
-18,7 +18,7 @@ __version__ = &quot;1.0.1&quot;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def detect(aBuf):</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=707
 style='width:530.45pt;margin-left:38.15pt;border-collapse:collapse'>
 <tr style='height:21.55pt'>
  <td width=707 style='width:530.45pt;background:#FF8877;padding:0in 5.75pt 0in 0in;
  height:21.55pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>-   
  import universaldetector</span></p>
  </td>
 </tr>
 <tr style='height:21.55pt'>
  <td width=707 style='width:530.45pt;background:#99FF99;padding:0in 5.75pt 0in 0in;
  height:21.55pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>+   
  from . import universaldetector</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:68.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>u = universaldetector.UniversalDetector()</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:68.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>u.reset()</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:68.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>u.feed(aBuf)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:326.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>--- chardet\big5prober.py
(original) +++ chardet\big5prober.py (refactored)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>@@ -25,10 +25,10 @@</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:140.45pt;margin-bottom:
13.35pt;margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono"'># 02110-1301  USA
######################### END LICENSE BLOCK #########################</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=707
 style='width:530.45pt;margin-left:38.15pt;border-collapse:collapse'>
 <tr style='height:86.15pt'>
  <td width=707 style='width:530.45pt;background:#FF8877;padding:0in 5.75pt 0in 0in;
  height:86.15pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.3pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>-from mbcharsetprober
  import MultiByteCharSetProber</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:194.7pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:190%'><span style='font-size:
  10.0pt;line-height:190%;font-family:"Liberation Mono"'>-from
  codingstatemachine import CodingStateMachine -from chardistribution import
  Big5DistributionAnalysis</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>-from
  mbcssm import Big5SMModel</span></p>
  </td>
 </tr>
 <tr style='height:86.15pt'>
  <td width=707 style='width:530.45pt;background:#99FF99;padding:0in 5.75pt 0in 0in;
  height:86.15pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.3pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>+from .mbcharsetprober
  import MultiByteCharSetProber</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:188.7pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:190%'><span style='font-size:
  10.0pt;line-height:190%;font-family:"Liberation Mono"'>+from
  .codingstatemachine import CodingStateMachine +from .chardistribution import
  Big5DistributionAnalysis</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>+from
  .mbcssm import Big5SMModel</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:290.45pt;margin-bottom:
0in;margin-left:68.15pt;text-indent:-24.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>class
Big5Prober(MultiByteCharSetProber): def __init__(self):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>--- chardet\chardistribution.py (original)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>+++ chardet\chardistribution.py
(refactored)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>@@ -25,12 +25,12 @@</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:140.45pt;margin-bottom:
13.35pt;margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono"'># 02110-1301  USA
######################### END LICENSE BLOCK #########################</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=707
 style='width:530.45pt;margin-left:38.15pt;border-collapse:collapse'>
 <tr style='height:129.25pt'>
  <td width=707 style='width:530.45pt;background:#FF8877;padding:0in 0in 0in 0in;
  height:129.25pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.3pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>-import constants</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:-33.55pt;margin-bottom:
  9.3pt;margin-left:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>-from
  euctwfreq import EUCTWCharToFreqOrder, EUCTW_TABLE_SIZE,
  EUCTW_TYPICAL_DISTRIBUTION_RATI</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:-33.55pt;margin-bottom:
  9.3pt;margin-left:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>-from
  euckrfreq import EUCKRCharToFreqOrder, EUCKR_TABLE_SIZE,
  EUCKR_TYPICAL_DISTRIBUTION_RATI</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:-33.55pt;margin-bottom:
  9.3pt;margin-left:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>-from
  gb2312freq import GB2312CharToFreqOrder, GB2312_TABLE_SIZE,
  GB2312_TYPICAL_DISTRIBUTION_</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:-15.55pt;margin-bottom:
  9.3pt;margin-left:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>-from
  big5freq import Big5CharToFreqOrder, BIG5_TABLE_SIZE,
  BIG5_TYPICAL_DISTRIBUTION_RATIO</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>-from
  jisfreq import JISCharToFreqOrder, JIS_TABLE_SIZE,
  JIS_TYPICAL_DISTRIBUTION_RATIO</span></p>
  </td>
 </tr>
 <tr style='height:129.25pt'>
  <td width=707 style='width:530.45pt;background:#99FF99;padding:0in 0in 0in 0in;
  height:129.25pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.3pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>+from . import
  constants</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:-33.55pt;margin-bottom:
  9.3pt;margin-left:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>+from
  .euctwfreq import EUCTWCharToFreqOrder, EUCTW_TABLE_SIZE,
  EUCTW_TYPICAL_DISTRIBUTION_RAT</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:-33.55pt;margin-bottom:
  9.3pt;margin-left:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>+from
  .euckrfreq import EUCKRCharToFreqOrder, EUCKR_TABLE_SIZE,
  EUCKR_TYPICAL_DISTRIBUTION_RAT</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:-33.55pt;margin-bottom:
  9.3pt;margin-left:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>+from
  .gb2312freq import GB2312CharToFreqOrder, GB2312_TABLE_SIZE,
  GB2312_TYPICAL_DISTRIBUTION</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:-21.55pt;margin-bottom:
  9.3pt;margin-left:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>+from
  .big5freq import Big5CharToFreqOrder, BIG5_TABLE_SIZE,
  BIG5_TYPICAL_DISTRIBUTION_RATIO</span></p>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-size:10.0pt;line-height:
  107%;font-family:"Liberation Mono"'>+from .jisfreq import JISCharToFreqOrder,
  JIS_TABLE_SIZE, JIS_TYPICAL_DISTRIBUTION_RATIO</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>ENOUGH_DATA_THRESHOLD = 1024</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:458.45pt;margin-bottom:
0in;margin-left:37.4pt;text-indent:6.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>SURE_YES
= 0.99 .</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.5pt;
margin-left:37.9pt;line-height:110%;background:gainsboro'><b><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>. (it
goes on like this for a while)</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:212.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>RefactoringTool: Files that
were modified: RefactoringTool: chardet\__init__.py</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>RefactoringTool: chardet\big5prober.py</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>RefactoringTool:
chardet\chardistribution.py</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>RefactoringTool:
chardet\charsetgroupprober.py</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:188.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>RefactoringTool:
chardet\codingstatemachine.py RefactoringTool: chardet\constants.py</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:242.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>RefactoringTool:
chardet\escprober.py RefactoringTool: chardet\escsm.py RefactoringTool:
chardet\eucjpprober.py RefactoringTool: chardet\euckrprober.py RefactoringTool:
chardet\euctwprober.py</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>RefactoringTool: chardet\gb2312prober.py</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:224.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>RefactoringTool:
chardet\hebrewprober.py RefactoringTool: chardet\jpcntx.py</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>RefactoringTool:
chardet\langbulgarianmodel.py</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:194.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>RefactoringTool:
chardet\langcyrillicmodel.py RefactoringTool: chardet\langgreekmodel.py</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>RefactoringTool: chardet\langhebrewmodel.py</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>RefactoringTool:
chardet\langhungarianmodel.py</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:218.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>RefactoringTool:
chardet\langthaimodel.py RefactoringTool: chardet\latin1prober.py</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>RefactoringTool: chardet\mbcharsetprober.py</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:206.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>RefactoringTool:
chardet\mbcsgroupprober.py RefactoringTool: chardet\mbcssm.py</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>RefactoringTool: chardet\sbcharsetprober.py</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:206.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>RefactoringTool:
chardet\sbcsgroupprober.py RefactoringTool: chardet\sjisprober.py</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>RefactoringTool:
chardet\universaldetector.py</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.8pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>RefactoringTool: chardet\utf8prober.py</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>Now run the <span style='font-size:
10.0pt;line-height:107%;font-family:"Liberation Mono"'>2to3 </span>script on
the testing harness, <span style='font-size:10.0pt;line-height:107%;font-family:
"Liberation Mono"'>test.py</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>C:\home\chardet&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>python
c:\Python30\Tools\Scripts\2to3.py -w test.py</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:176.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>RefactoringTool: Skipping
implicit fixer: buffer RefactoringTool: Skipping implicit fixer: idioms</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:242.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>RefactoringTool: Skipping
implicit fixer: set_literal RefactoringTool: Skipping implicit fixer: ws_comma
--- test.py (original)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>+++ test.py (refactored)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:440.45pt;margin-bottom:
0in;margin-left:43.4pt;text-indent:-6.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>@@ -4,7
+4,7 @@ count = 0</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:362.45pt;margin-bottom:
0in;margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono"'>u = UniversalDetector() for f
in glob.glob(sys.argv[1]):</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=707
 style='width:530.45pt;margin-left:38.15pt;border-collapse:collapse'>
 <tr style='height:21.55pt'>
  <td width=707 style='width:530.45pt;background:#FF8877;padding:0in 5.75pt 0in 0in;
  height:21.55pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>-   
  print f.ljust(60),</span></p>
  </td>
 </tr>
 <tr style='height:21.55pt'>
  <td width=707 style='width:530.45pt;background:#99FF99;padding:0in 5.75pt 0in 0in;
  height:21.55pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>+   
  print(f.ljust(60), end=' ')</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:374.45pt;margin-bottom:
0in;margin-left:68.7pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>u.reset() for line in file(f,
'rb'):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:92.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>u.feed(line)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>@@ -12,8 +12,8 @@</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:398.45pt;margin-bottom:
0in;margin-left:68.7pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono"'>u.close() result = u.result if
result['encoding']:</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=707
 style='width:530.45pt;margin-left:38.15pt;border-collapse:collapse'>
 <tr style='height:21.55pt'>
  <td width=707 style='width:530.45pt;background:#FF8877;padding:0in 5.75pt 0in 0in;
  height:21.55pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>-       
  print result['encoding'], 'with confidence', result['confidence']</span></p>
  </td>
 </tr>
 <tr style='height:21.55pt'>
  <td width=707 style='width:530.45pt;background:#99FF99;padding:0in 5.75pt 0in 0in;
  height:21.55pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>+       
  print(result['encoding'], 'with confidence', result['confidence'])</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:68.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>else:</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=707
 style='width:530.45pt;margin-left:38.15pt;border-collapse:collapse'>
 <tr style='height:21.55pt'>
  <td width=707 style='width:530.45pt;background:#FF8877;padding:0in 5.75pt 0in 0in;
  height:21.55pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>-       
  print '******** no result'</span></p>
  </td>
 </tr>
 <tr style='height:21.55pt'>
  <td width=707 style='width:530.45pt;background:#99FF99;padding:0in 5.75pt 0in 0in;
  height:21.55pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>+       
  print('******** no result')</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:68.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>count += 1</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=707
 style='width:530.45pt;margin-left:38.15pt;border-collapse:collapse'>
 <tr style='height:21.55pt'>
  <td width=707 style='width:530.45pt;background:#FF8877;padding:0in 5.75pt 0in 0in;
  height:21.55pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>-print
  count, 'tests'</span></p>
  </td>
 </tr>
 <tr style='height:21.55pt'>
  <td width=707 style='width:530.45pt;background:#99FF99;padding:0in 5.75pt 0in 0in;
  height:21.55pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>+print(count,
  'tests')</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>RefactoringTool: Files that were modified:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>RefactoringTool: test.py</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>Well, that wasn’t so hard. Just a few imports and
print statements to convert. Speaking of which, what <i>was </i>the problem
with all those import statements? To answer that, you need to understand how
the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>chardet
</span>module is split into multiple files.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:33.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h5 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>15.5.
A S</span>HORT <span style='font-size:18.0pt;line-height:112%'>D</span>IGRESSION
<span style='font-size:18.0pt;line-height:112%'>I</span>NTO <span
style='font-size:18.0pt;line-height:112%'>M</span>ULTI<span style='font-size:
18.0pt;line-height:112%'>-F</span>ILE <span style='font-size:18.0pt;line-height:
112%'>M</span>ODULES</h5>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.4pt;margin-left:16.4pt'><span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>chardet </span>is a <i>multi-file module</i>. I
could have chosen to put all the code in one file (named <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>chardet.py</span>),
but I didn’t. Instead, I made a directory (named <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>chardet</span>), then I made an
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__init__.py
</span>file in that directory. <i>If Python sees an </i><span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>__init__.py </span><i>file
in a directory, it assumes that all of the files in that directory are part of
the same module. </i>The module’s name is the name of the directory. Files
within the directory can reference other files within the same directory, or
even within subdirectories. (More on that in a minute.) But the entire
collection of files is presented to other Python code as a single module — as
if all the functions and classes were in a single <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>.py </span>file.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
47.4pt;margin-left:16.4pt'>What goes in the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>__init__.py </span>file?
Nothing. Everything. Something in between. The <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>__init__.py </span>file doesn’t
need to define anything; it can literally be an empty file. Or you can use it
to define your main entry point functions. Or you put all your functions in it.
Or all but one.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:47.15pt;line-height:107%'><span style='font-size:24.0pt;
line-height:107%;font-family:"Calibri",sans-serif'>&#9758; </span>A directory
with an <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>__init__.py
</span>file is always treated as a multi-file module.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:.45in;
margin-bottom:42.75pt;margin-left:.5pt;text-align:center;line-height:151%'>Without
an <span style='font-size:10.0pt;line-height:151%;font-family:"Liberation Mono"'>__init__.py
</span>file, a directory is just a directory of unrelated <span
style='font-size:10.0pt;line-height:151%;font-family:"Liberation Mono"'>.py </span>files.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.9pt;margin-left:16.4pt'>Let’s see how that works in practice.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.5pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>import
chardet</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>dir(chardet)             </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>['__builtins__', '__doc__', '__file__',
'__name__',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.4pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'__package__', '__path__', '__version__',
'detect']</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>chardet                  </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&lt;module 'chardet' from
'C:\Python31\lib\site-packages\chardet\__init__.py'&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.3pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Other than the
usual class attributes, the only thing in the <span style='font-size:10.0pt;
line-height:107%;font-family:"Liberation Mono"'>chardet </span>module is a <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>detect()
</span>function.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Here’s your first clue that the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>chardet </span>module is more
than just a file: the “module” is listed as the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>__init__.py </span>file within
the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>chardet/
</span>directory.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
12.8pt;margin-left:16.4pt;line-height:107%'>Let’s take a peek in that <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>__init__.py
</span>file.</p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=390
 style='width:292.8pt;margin-left:38.15pt;border-collapse:collapse'>
 <tr style='height:18.3pt'>
  <td width=376 valign=top style='width:282.05pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>def
  detect(aBuf):</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9312;</span></p>
  </td>
 </tr>
 <tr style='height:18.3pt'>
  <td width=376 valign=bottom style='width:282.05pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
  margin-left:24.0pt;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>from . import
  universaldetector</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9313;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>u = universaldetector.UniversalDetector()</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>u.reset()</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>u.feed(aBuf)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:446.45pt;margin-bottom:
23.45pt;margin-left:62.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>u.close() return u.result</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.9pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>__init__.py
</span>file defines the <span style='font-size:10.0pt;line-height:107%;
font-family:"Liberation Mono"'>detect() </span>function, which is the main
entry point into the <span style='font-size:10.0pt;line-height:107%;font-family:
"Liberation Mono"'>chardet </span>library.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.85pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>But the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>detect()
</span>function hardly has any code! In fact, all it really does is import the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>universaldetector
</span>module and start using it. But where is <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>universaldetector </span>defined?</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.95pt;margin-left:16.4pt'>The answer lies in that odd-looking <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>import </span>statement:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>from . import universaldetector</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.85pt;margin-left:16.4pt'>Translated into English, that means “import the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>universaldetector
</span>module; that’s in the same directory I am,” where “I” is the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>chardet/__init__.py
</span>file. This is called a <i>relative import</i>. It’s a way for the files
within a multi-file module to reference each other, without worrying about
naming conflicts with other modules you may have installed in <u>your import
search path</u>. This <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>import </span>statement will <i>only </i>look
for the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>universaldetector
</span>module within the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>chardet/ </span>directory itself.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
44.3pt;margin-left:16.4pt'>These two concepts — <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>__init__.py </span>and relative
imports — mean that you can break up your module into as many pieces as you
like. The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>chardet
</span>module comprises 36 <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>.py </span>files — 36! Yet all you need to do to
start using it is <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>import chardet</span>, then you can call the main <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>chardet.detect()
</span>function. Unbeknownst to your code, the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>detect() </span>function is
actually defined in the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>chardet/__init__.py </span>file. Also
unbeknownst to you, the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>detect() </span>function uses a relative import
to reference a class defined in <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>chardet/ universaldetector.py</span>, which in
turn uses relative imports on five other files, all contained in the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>chardet/
</span>directory.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:21.75pt;
margin-left:46.4pt;line-height:107%'><span style='font-size:24.0pt;line-height:
107%;font-family:"Calibri",sans-serif'>&#9758;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:92.05pt;margin-bottom:
45.7pt;margin-left:76.4pt'>If you ever find yourself writing a large library in
Python (or more likely, when you realize that your small library has grown into
a large one), take the time to refactor it into a multi-file module. It’s one
of the many things Python is good at, so take advantage of it.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:33.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h5 style='margin-top:0in;margin-right:0in;margin-bottom:21.05pt;margin-left:
16.4pt'><span style='font-size:18.0pt;line-height:112%'>15.6. F</span>IXING <span
style='font-size:18.0pt;line-height:112%'>W</span>HAT <span style='font-size:
18.0pt;line-height:112%;font-family:"Liberation Mono";font-weight:normal'>2to3 </span><span
style='font-size:18.0pt;line-height:112%'>C</span>AN<span style='font-size:
18.0pt;line-height:112%'>’</span>T</h5>

<h6 style='margin-top:0in;margin-right:0in;margin-bottom:26.75pt;margin-left:
16.4pt'><span style='font-size:13.0pt;line-height:110%'>15.6.1. </span><span
style='font-size:13.0pt;line-height:110%;font-family:"Liberation Mono";
font-weight:normal'>False </span>IS INVALID SYNTAX</h6>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
18.9pt;margin-left:16.4pt'><img width=298 height=1
src="Dive%20Into%20Python%203_files/image033.gif" align=left hspace=12>Now for
the real test: running the test harness against the test suite. Since the test
suite is designed to cover all the possible code paths, it’s a good way to test
our ported code to make sure there aren’t any bugs lurking anywhere.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>C:\home\chardet&gt;
</span><span style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>python
test.py tests\*\* </span><span style='font-size:10.0pt;line-height:185%;
font-family:"Liberation Mono";color:#880000'>Traceback (most recent call last):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
90.25pt;margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>File
&quot;test.py&quot;, line 1, in &lt;module&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>from
chardet.universaldetector import UniversalDetector</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:134.45pt;margin-bottom:
0in;margin-left:62.15pt;text-indent:-12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
color:#880000'>File &quot;C:\home\chardet\chardet\universaldetector.py&quot;,
line 51 self.done = constants.False</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:218.7pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>^</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>SyntaxError:
invalid syntax</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
18.95pt;margin-left:16.4pt'>Hmm, a small snag. In Python 3, <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>False </span>is
a reserved word, so you can’t use it as a variable name. Let’s look at <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>constants.py
</span>to see where it’s defined. Here’s the original version from <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>constants.py</span>,
before the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>2to3
</span>script changed it:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:338.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>import __builtin__ if not
hasattr(__builtin__, 'False'):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>False = 0</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:458.45pt;margin-bottom:
0in;margin-left:37.4pt;text-indent:24.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>True =
1 else:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>False = __builtin__.False</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>True = __builtin__.True</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.7pt;margin-left:16.4pt'>This piece of code is designed to allow this library
to run under older versions of Python 2. Prior to Python 2.3, Python had no
built-in <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>bool
</span>type. This code detects the absence of the built-in constants <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>True </span>and
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>False</span>,
and defines them if necessary.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
22.35pt;margin-left:16.4pt'>However, Python 3 will always have a <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>bool </span>type,
so this entire code snippet is unnecessary. The simplest solution is to replace
all instances of <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>constants.True </span>and <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>constants.False </span>with <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>True </span>and
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>False</span>,
respectively, then delete this dead code from <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>constants.py</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:25.1pt;
margin-left:17.15pt;line-height:110%'>So this line in <span style='font-size:
10.0pt;line-height:110%;font-family:"Liberation Mono"'>universaldetector.py</span>:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>self.done = constants.False</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.75pt;margin-left:16.4pt'>Becomes</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>self.done = False</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
22.95pt;margin-left:16.4pt'>Ah, wasn’t that satisfying? The code is shorter and
more readable already.</p>

<h6 style='margin-top:0in;margin-right:0in;margin-bottom:27.15pt;margin-left:
16.4pt'><span style='font-size:13.0pt;line-height:110%'>15.6.2. N</span>O
MODULE NAMED <span style='font-size:13.0pt;line-height:110%;font-family:"Liberation Mono";
font-weight:normal'>constants</span></h6>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>Time to run <span style='font-size:
10.0pt;line-height:107%;font-family:"Liberation Mono"'>test.py </span>again and
see how far it gets.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:260.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>C:\home\chardet&gt;
</span><span style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>python
test.py tests\*\* </span><span style='font-size:10.0pt;line-height:185%;
font-family:"Liberation Mono";color:#880000'>Traceback (most recent call last):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:206.45pt;margin-bottom:
0in;margin-left:62.15pt;text-indent:-12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
color:#880000'>File &quot;test.py&quot;, line 1, in &lt;module&gt; from
chardet.universaldetector import UniversalDetector</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:74.45pt;margin-bottom:
0in;margin-left:62.15pt;text-indent:-12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
color:#880000'>File &quot;C:\home\chardet\chardet\universaldetector.py&quot;,
line 29, in &lt;module&gt; import constants, sys</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
31.7pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>ImportError: No
module named constants</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:34.1pt;margin-bottom:
20.35pt;margin-left:16.4pt'>What’s that you say? No module named <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>constants</span>?
Of course there’s a module named <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>constants</span>. It’s right there, in <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>chardet/constants.py</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.0pt;margin-left:16.4pt'>Remember when the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>2to3 </span>script fixed up all
those import statements? This library has a lot of relative imports — that is, <u>modules
that import other modules within the same library </u>— but <i>the logic behind
relative imports has changed in Python 3</i>. In Python 2, you could just <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>import
constants </span>and it would look in the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>chardet/ </span>directory
first. In Python 3, <a href="http://www.python.org/dev/peps/pep-0328/"><span
style='color:black'>all</span></a><u> </u><a
href="http://www.python.org/dev/peps/pep-0328/"><span style='color:black'>import</span></a><u>
</u><a href="http://www.python.org/dev/peps/pep-0328/"><span style='color:black'>statements</span></a><u>
</u><a href="http://www.python.org/dev/peps/pep-0328/"><span style='color:black'>are</span></a><u>
</u><a href="http://www.python.org/dev/peps/pep-0328/"><span style='color:black'>absolute</span></a><u>
</u><a href="http://www.python.org/dev/peps/pep-0328/"><span style='color:black'>by</span></a><u>
</u><a href="http://www.python.org/dev/peps/pep-0328/"><span style='color:black'>default</span></a>.
If you want to do a relative import in Python 3, you need to be explicit about
it:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.2pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>from . import constants</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.6pt;margin-left:16.4pt'>But wait. Wasn’t the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>2to3 </span>script supposed to
take care of these for you? Well, it did, but this particular import statement
combines two different types of imports into one line: a relative import of the
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>constants
</span>module within the library, and an absolute import of the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>sys </span>module
that is pre-installed in the Python standard library. In Python 2, you could
combine these into one import statement. In Python 3, you can’t, and the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>2to3 </span>script
is not smart enough to split the import statement into two.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.9pt;margin-left:16.4pt'>The solution is to split the import statement
manually. So this two-in-one import:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>import constants, sys</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.9pt;margin-left:16.4pt'>Needs to become two separate imports:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:386.45pt;margin-bottom:
8.25pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>from . import constants import
sys</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.5pt;margin-left:16.4pt'>There are variations of this problem scattered
throughout the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>chardet
</span>library. In some places it’s “<span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>import constants, sys</span>”; in other
places, it’s “<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>import
constants, re</span>”. The fix is the same: manually split the import statement
into two lines, one for the relative import, the other for the absolute import.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
23.25pt;margin-left:16.4pt'>Onward!</p>

<h6 style='margin-left:16.4pt'><span style='font-size:13.0pt;line-height:110%'>15.6.3.
N</span>AME <span style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
font-weight:normal'>'file' </span>IS NOT DEFINED</h6>

<p class=MsoNormal style='margin-top:0in;margin-right:293.85pt;margin-bottom:
19.05pt;margin-left:16.4pt'>And here we go again, running <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>test.py
</span>to try to execute our test cases…</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.0pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><img width=301 height=1
src="Dive%20Into%20Python%203_files/image036.gif" align=left hspace=12><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
color:#666677'>C:\home\chardet&gt; </span><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>python test.py tests\*\*
tests\ascii\howto.diveintomark.org.xml </span><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#880000'>Traceback (most
recent call last):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
0in;margin-left:62.15pt;text-indent:-12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
color:#880000'>File &quot;test.py&quot;, line 9, in &lt;module&gt; for line in
file(f, 'rb'):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
31.05pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>NameError: name
'file' is not defined</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.55pt;margin-left:16.4pt'>This one surprised me, because I’ve been using this
idiom as long as I can remember. In Python 2, the global <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>file() </span>function
was an alias for the <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>open() </span>function, which was the standard way of <u>opening
text files for reading</u>. In Python 3, the global <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>file() </span>function
no longer exists, but the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>open() </span>function still exists.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
18.9pt;margin-left:16.4pt'>Thus, the simplest solution to the problem of the
missing <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>file()
</span>is to call the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>open() </span>function instead:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>for line in open(f, 'rb'):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>And that’s all I have to say about
that.</p>

<h6 style='margin-left:16.4pt'><span style='font-size:13.0pt;line-height:110%'>15.6.4.
C</span>AN<span style='font-size:13.0pt;line-height:110%'>’</span>T USE A
STRING PATTERN ON A BYTES<span style='font-size:13.0pt;line-height:110%'>-</span>LIKE
OBJECT</h6>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.9pt;margin-left:16.4pt'>Now things are starting to get interesting. And by
“interesting,” I mean “confusing as all hell.”</p>

<p class=MsoNormal style='margin-top:0in;margin-right:278.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>C:\home\chardet&gt;
</span><span style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>python
test.py tests\*\* tests\ascii\howto.diveintomark.org.xml </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
color:#880000'>Traceback (most recent call last):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>File
&quot;test.py&quot;, line 10, in &lt;module&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>u.feed(line)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
0in;margin-left:62.15pt;text-indent:-12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
color:#880000'>File &quot;C:\home\chardet\chardet\universaldetector.py&quot;,
line 98, in feed if self._highBitDetector.search(aBuf):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
32.15pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>TypeError: can't
use a string pattern on a bytes-like object</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
18.6pt;margin-left:16.4pt'>To debug this, let’s see what <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>self._highBitDetector
</span>is. It’s defined in the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>__init__ </span>method of the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>UniversalDetector
</span>class:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>class UniversalDetector:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def __init__(self):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.2pt;
margin-left:86.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>self._highBitDetector =
re.compile(r'[\x80-\xFF]')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.6pt;margin-left:16.4pt'>This pre-compiles a regular expression designed to
find non-<span style='font-size:9.5pt;line-height:154%'>ASCII </span>characters
in the range 128–255 (0x80–0xFF). Wait, that’s not quite right; I need to be
more precise with my terminology. This pattern is designed to find non-<span
style='font-size:9.5pt;line-height:154%'>ASCII </span><i>bytes </i>in the range
128-255.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.45pt;margin-left:16.4pt'>And therein lies the problem.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.1pt;margin-left:16.4pt;line-height:107%'>In Python 2, a string was an array
of bytes whose character encoding was tracked separately. If you wanted</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.05pt;margin-left:16.4pt;line-height:107%'>Python 2 to keep track of the
character encoding, you had to use a Unicode string (<span style='font-size:
10.0pt;line-height:107%;font-family:"Liberation Mono"'>u''</span>) instead. But
in</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>Python 3, a string is always what Python 2 called a
Unicode string — that is, an array of Unicode characters (of possibly varying
byte lengths). Since this regular expression is defined by a string pattern, it
can only be used to search a string — again, an array of characters. But what
we’re searching is not a string, it’s a byte array. Looking at the traceback,
this error occurred in <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>universaldetector.py</span>:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def feed(self, aBuf):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:524.45pt;margin-bottom:
0in;margin-left:62.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>. .</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>if self._mInputState == ePureAscii:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:32.05pt;
margin-left:86.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>if self._highBitDetector.search(aBuf):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
18.95pt;margin-left:16.4pt'>And what is <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>aBuf</span>? Let’s backtrack
further to a place that calls <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>UniversalDetector.feed()</span>. One place that
calls it is the test harness, <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>test.py</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:416.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>u = UniversalDetector() .</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:548.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>. .</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>for line in open(f, 'rb'):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>u.feed(line)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
8.0pt;margin-left:16.4pt;line-height:107%'>And here we find our answer: in the</p>

<p class=MsoNormal style='margin-top:0in;margin-right:208.7pt;margin-bottom:
.25pt;margin-left:16.4pt'><img width=300 height=1
src="Dive%20Into%20Python%203_files/image047.gif" align=left hspace=12><span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>UniversalDetector.feed()
</span>method, <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>aBuf
</span>is a line read from a file on disk. Look carefully at the parameters
used to open the file: <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>'rb'</span>. <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>'r' </span>is for “read”; OK,
big deal, we’re reading the file. Ah, but <u><span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>'b' </span>is for “binary.” </u>Without
the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>'b'
</span>flag, this <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>for </span>loop would read the file, line by line, and
convert each line into a string — an array of Unicode characters — according to
the system default character encoding. But with the <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>'b' </span>flag, this <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>for </span>loop
reads the file, line by line, and stores each line exactly as it appears in the
file, as an array of bytes. That byte array gets passed to <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>UniversalDetector.feed()</span>,
and eventually gets passed to the pre-compiled regular expression, <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>self._highBitDetector</span>,
to search for high-bit… characters. But we don’t have characters; we have
bytes. Oops.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:294.4pt;margin-bottom:
20.55pt;margin-left:16.4pt'>What we need this regular expression to search is
not an array of characters, but an array of bytes.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'><img width=298 height=1
src="Dive%20Into%20Python%203_files/image033.gif" align=left hspace=12>Once you
realize that, the solution is not difficult. Regular expressions defined with
strings can search strings. Regular expressions defined with byte arrays can
search byte arrays. To define a byte array pattern, we simply change the type
of the argument we use to define the regular expression to a byte array. (There
is one other case of this same problem, on the very next</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.75pt;margin-left:16.4pt'>line.)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>class UniversalDetector:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:74.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def __init__(self):</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=707
 style='width:530.45pt;margin-left:38.15pt;border-collapse:collapse'>
 <tr style='height:43.1pt'>
  <td width=707 style='width:530.45pt;background:#FF8877;padding:0in 5.75pt 0in 0in;
  height:43.1pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.3pt;
  margin-left:60.0pt;text-indent:-60.0pt;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>-<span
  style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='font-size:10.0pt;line-height:107%;font-family:
  "Liberation Mono"'>self._highBitDetector = re.compile(r'[\x80-\xFF]')</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
  margin-left:60.0pt;text-indent:-60.0pt;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>-<span
  style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='font-size:10.0pt;line-height:107%;font-family:
  "Liberation Mono"'>self._escDetector = re.compile(r'(\033|~{)')</span></p>
  </td>
 </tr>
 <tr style='height:43.1pt'>
  <td width=707 style='width:530.45pt;background:#99FF99;padding:0in 5.75pt 0in 0in;
  height:43.1pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.3pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>+        
  self._highBitDetector = re.compile(b'[\x80-\xFF]')</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>+        
  self._escDetector = re.compile(b'(\033|~{)')</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:272.45pt;margin-bottom:
22.6pt;margin-left:98.7pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>self._mEscCharSetProber = None
self._mCharSetProbers = [] self.reset()</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>Searching the entire codebase for other uses of the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>re </span>module
turns up two more instances, in <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>charsetprober.py</span>. Again, the code is
defining regular expressions as strings but executing them on <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>aBuf</span>,
which is a byte array. The solution is the same: define the regular expression
patterns as byte arrays.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>class CharSetProber:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:74.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:302.45pt;margin-bottom:
0in;margin-left:74.7pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono"'>. . def
filter_high_bit_only(self, aBuf):</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=707
 style='width:530.45pt;margin-left:38.15pt;border-collapse:collapse'>
 <tr style='height:21.55pt'>
  <td width=707 style='width:530.45pt;background:#FF8877;padding:0in 5.75pt 0in 0in;
  height:21.55pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>-        
  aBuf = re.sub(r'([\x00-\x7F])+', ' ', aBuf)</span></p>
  </td>
 </tr>
 <tr style='height:21.55pt'>
  <td width=707 style='width:530.45pt;background:#99FF99;padding:0in 5.75pt 0in 0in;
  height:21.55pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>+        
  aBuf = re.sub(b'([\x00-\x7F])+', b' ', aBuf)</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:98.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>return aBuf</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:74.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def filter_without_english_letters(self,
aBuf):</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=707
 style='width:530.45pt;margin-left:38.15pt;border-collapse:collapse'>
 <tr style='height:21.55pt'>
  <td width=707 style='width:530.45pt;background:#FF8877;padding:0in 5.75pt 0in 0in;
  height:21.55pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>-        
  aBuf = re.sub(r'([A-Za-z])+', ' ', aBuf)</span></p>
  </td>
 </tr>
 <tr style='height:21.55pt'>
  <td width=707 style='width:530.45pt;background:#99FF99;padding:0in 5.75pt 0in 0in;
  height:21.55pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>+        
  aBuf = re.sub(b'([A-Za-z])+', b' ', aBuf)</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:32.05pt;
margin-left:98.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>return aBuf</span></p>

<h6 style='margin-top:0in;margin-right:0in;margin-bottom:26.75pt;margin-left:
16.4pt'><span style='font-size:13.0pt;line-height:110%'>15.6.5. C</span>AN<span
style='font-size:13.0pt;line-height:110%'>'</span>T CONVERT <span
style='font-size:13.0pt;line-height:110%;font-family:"Liberation Mono";
font-weight:normal'>'bytes' </span>OBJECT TO <span style='font-size:13.0pt;
line-height:110%;font-family:"Liberation Mono";font-weight:normal'>str </span>IMPLICITLY</h6>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.9pt;margin-left:16.4pt'>Curiouser and curiouser…</p>

<p class=MsoNormal style='margin-top:0in;margin-right:278.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>C:\home\chardet&gt;
</span><span style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>python
test.py tests\*\* tests\ascii\howto.diveintomark.org.xml </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
color:#880000'>Traceback (most recent call last):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>File
&quot;test.py&quot;, line 10, in &lt;module&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>u.feed(line)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:-3.55pt;margin-bottom:
0in;margin-left:62.15pt;text-indent:-12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
color:#880000'>File &quot;C:\home\chardet\chardet\universaldetector.py&quot;,
line 100, in feed elif (self._mInputState == ePureAscii) and
self._escDetector.search(self._mLastChar + aBuf</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
31.35pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>TypeError: Can't
convert 'bytes' object to str implicitly</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
18.9pt;margin-left:16.4pt'>There’s an unfortunate clash of coding style and
Python interpreter here. The <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>TypeError </span>could be anywhere on that line,
but the traceback doesn’t tell you exactly where it is. It could be in the
first conditional or the second, and the traceback would look the same. To
narrow it down, you should split the line in half, like this:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:56.45pt;margin-bottom:
8.25pt;margin-left:61.4pt;text-indent:-24.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>elif
(self._mInputState == ePureAscii) and \
self._escDetector.search(self._mLastChar + aBuf):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.9pt;margin-left:16.4pt'>And re-run the test:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:278.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>C:\home\chardet&gt;
</span><span style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>python
test.py tests\*\* tests\ascii\howto.diveintomark.org.xml </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
color:#880000'>Traceback (most recent call last):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>File
&quot;test.py&quot;, line 10, in &lt;module&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>u.feed(line)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
0in;margin-left:62.15pt;text-indent:-12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
color:#880000'>File &quot;C:\home\chardet\chardet\universaldetector.py&quot;,
line 101, in feed self._escDetector.search(self._mLastChar + aBuf):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
32.1pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>TypeError: Can't
convert 'bytes' object to str implicitly</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.1pt;margin-left:16.4pt'>Aha! The problem was not in the first conditional (<span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>self._mInputState
== ePureAscii</span>) but in the second one. So what could cause a <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>TypeError
</span>there? Perhaps you’re thinking that the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>search() </span>method is
expecting a value of a different type, but that wouldn’t generate this
traceback. Python functions can take any value; if you pass the right number of
arguments, the function will execute. It may <i>crash </i>if you pass it a
value of a different type than it’s expecting, but if that happened, the
traceback would point to somewhere inside the function. But this traceback says
it never got as far as calling the <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>search() </span>method. So the problem must
be in that <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>+
</span>operation, as it’s trying to construct the value that it will eventually
pass to the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>search()
</span>method.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>We know from <u>previous debugging </u>that <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>aBuf </span>is
a byte array. So what is <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>self._mLastChar</span>? It’s an instance
variable, defined in the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>reset() </span>method, which is actually called
from the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__init__()
</span>method.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>class UniversalDetector:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def __init__(self):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:206.45pt;margin-bottom:
0in;margin-left:86.7pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>self._highBitDetector =
re.compile(b'[\x80-\xFF]') self._escDetector = re.compile(b'(\033|~{)')
self._mEscCharSetProber = None self._mCharSetProbers = []</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:86.7pt;line-height:110%;background:gainsboro'><b><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>self.reset()</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:206.45pt;margin-bottom:
0in;margin-left:86.15pt;text-indent:-24.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>def
reset(self): self.result = {'encoding': None, 'confidence': 0.0} self.done =
False self._mStart = True self._mGotData = False self._mInputState = ePureAscii</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.75pt;
margin-left:86.7pt;line-height:110%;background:gainsboro'><b><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>self._mLastChar
= ''</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.4pt;margin-left:16.4pt'>And now we have our answer. Do you see it? <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>self._mLastChar
</span>is a string, but <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>aBuf </span>is a byte array. And you can’t
concatenate a string to a byte array — not even a zero-length string.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.05pt;margin-left:16.4pt'>So what is <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>self._mLastChar </span>anyway?
In the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>feed()
</span>method, just a few lines down from where the trackback occurred.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>if self._mInputState == ePureAscii:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>if self._highBitDetector.search(aBuf):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:86.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>self._mInputState = eHighbyte</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>elif (self._mInputState == ePureAscii) and
\</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:110.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>self._escDetector.search(self._mLastChar +
aBuf):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:86.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>self._mInputState = eEscAscii</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.25pt;
margin-left:37.9pt;line-height:110%;background:gainsboro'><b><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>self._mLastChar
= aBuf[-1]</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
18.4pt;margin-left:16.4pt'>The calling function calls this <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>feed() </span>method
over and over again with a few bytes at a time. The method processes the bytes
it was given (passed in as <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>aBuf</span>), then stores the last byte in <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>self._mLastChar
</span>in case it’s needed during the next call. (In a multi-byte encoding, the
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>feed()
</span>method might get called with half of a character, then called again with
the other half.) But because <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>aBuf </span>is now a byte array instead of a
string, <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>self._mLastChar
</span>needs to be a byte array as well. Thus:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def reset(self):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:74.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:512.45pt;margin-bottom:
0in;margin-left:74.7pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono"'>. .</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=707
 style='width:530.45pt;margin-left:38.15pt;border-collapse:collapse'>
 <tr style='height:21.55pt'>
  <td width=707 style='width:530.45pt;background:#FF8877;padding:0in 5.75pt 0in 0in;
  height:21.55pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>-    
  self._mLastChar = ''</span></p>
  </td>
 </tr>
 <tr style='height:21.55pt'>
  <td width=707 style='width:530.45pt;background:#99FF99;padding:0in 5.75pt 0in 0in;
  height:21.55pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>+    
  self._mLastChar = b''</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.05pt;margin-left:16.4pt'>Searching the entire codebase for “<span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>mLastChar</span>”
turns up a similar problem in <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>mbcharsetprober.py</span>, but instead of
tracking the last character, it tracks the last <i>two </i>characters. The <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>MultiByteCharSetProber
</span>class uses a list of 1-character strings to track the last two
characters. In Python 3, it needs to use a list of integers, because it’s not
really tracking characters, it’s tracking bytes. (Bytes are just integers from <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>0-255</span>.)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>class
MultiByteCharSetProber(CharSetProber):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:74.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def __init__(self):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:206.45pt;margin-bottom:
0in;margin-left:98.7pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono"'>CharSetProber.__init__(self)
self._mDistributionAnalyzer = None self._mCodingSM = None</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=707
 style='width:530.45pt;margin-left:38.15pt;border-collapse:collapse'>
 <tr style='height:21.55pt'>
  <td width=707 style='width:530.45pt;background:#FF8877;padding:0in 5.75pt 0in 0in;
  height:21.55pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>-        
  self._mLastChar = ['\x00', '\x00']</span></p>
  </td>
 </tr>
 <tr style='height:21.55pt'>
  <td width=707 style='width:530.45pt;background:#99FF99;padding:0in 5.75pt 0in 0in;
  height:21.55pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>+        
  self._mLastChar = [0, 0]</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:74.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def reset(self):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:338.45pt;margin-bottom:
0in;margin-left:98.7pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>CharSetProber.reset(self) if
self._mCodingSM:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:314.45pt;margin-bottom:
0in;margin-left:98.2pt;text-indent:24.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>self._mCodingSM.reset()
if self._mDistributionAnalyzer:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:122.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>self._mDistributionAnalyzer.reset()</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=707
 style='width:530.45pt;margin-left:38.15pt;border-collapse:collapse'>
 <tr style='height:21.55pt'>
  <td width=707 style='width:530.45pt;background:#FF8877;padding:0in 5.75pt 0in 0in;
  height:21.55pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>-        
  self._mLastChar = ['\x00', '\x00']</span></p>
  </td>
 </tr>
 <tr style='height:21.55pt'>
  <td width=707 style='width:530.45pt;background:#99FF99;padding:0in 5.75pt 0in 0in;
  height:21.55pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>+        
  self._mLastChar = [0, 0]</span></p>
  </td>
 </tr>
</table>

<h6 style='margin-top:0in;margin-right:0in;margin-bottom:26.75pt;margin-left:
16.4pt'><span style='font-size:13.0pt;line-height:110%'>15.6.6. U</span>NSUPPORTED
OPERAND TYPE<span style='font-size:13.0pt;line-height:110%'>(</span>S<span
style='font-size:13.0pt;line-height:110%'>) </span>FOR <span style='font-size:
13.0pt;line-height:110%'>+: </span><span style='font-size:13.0pt;line-height:
110%;font-family:"Liberation Mono";font-weight:normal'>'int' </span>AND <span
style='font-size:13.0pt;line-height:110%;font-family:"Liberation Mono";
font-weight:normal'>'bytes'</span></h6>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.9pt;margin-left:16.4pt'>I have good news, and I have bad news. The good news
is we’re making progress…</p>

<p class=MsoNormal style='margin-top:0in;margin-right:278.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>C:\home\chardet&gt;
</span><span style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>python
test.py tests\*\* tests\ascii\howto.diveintomark.org.xml </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
color:#880000'>Traceback (most recent call last):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>File
&quot;test.py&quot;, line 10, in &lt;module&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>u.feed(line)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
0in;margin-left:62.15pt;text-indent:-12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
color:#880000'>File &quot;C:\home\chardet\chardet\universaldetector.py&quot;,
line 101, in feed self._escDetector.search(self._mLastChar + aBuf):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
31.05pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>TypeError:
unsupported operand type(s) for +: 'int' and 'bytes'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.45pt;margin-left:16.4pt'>…The bad news is it doesn’t always feel like
progress.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:33.85pt;margin-bottom:
20.5pt;margin-left:16.4pt'>But this is progress! Really! Even though the
traceback calls out the same line of code, it’s a different error than it used
to be. Progress! So what’s the problem now? The last time I checked, this line
of code didn’t try to concatenate an <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>int </span>with a byte array (<span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>bytes</span>).
In fact, you just spent a lot of time <u>ensuring that </u><u><span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>self._mLastChar
</span>was a byte array</u>. How did it turn into an <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>int</span>?</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.9pt;margin-left:16.4pt'>The answer lies not in the previous lines of code,
but in the following lines.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>if self._mInputState == ePureAscii:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>if self._highBitDetector.search(aBuf):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:86.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>self._mInputState = eHighbyte</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>elif (self._mInputState == ePureAscii) and
\</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:110.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>self._escDetector.search(self._mLastChar +
aBuf):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:86.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>self._mInputState = eEscAscii</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:37.9pt;line-height:110%;background:gainsboro'><b><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>self._mLastChar
= aBuf[-1]</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
23.1pt;margin-left:16.4pt'><img width=298 height=1
src="Dive%20Into%20Python%203_files/image033.gif" align=left hspace=12>This
error doesn’t occur the first time the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>feed() </span>method gets
called; it occurs the <i>second time</i>, after <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>self._mLastChar </span>has been
set to the last byte of <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>aBuf</span>. Well, what’s the problem with that?
Getting a single element from a byte array yields an integer, not a byte array.
To see the difference, follow me to the interactive shell:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>aBuf = b'\xEF\xBB\xBF'         </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.0pt;margin-bottom:
8.25pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>len(aBuf)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.0pt;margin-bottom:
8.25pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono"'>3</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.0pt;margin-bottom:
12.45pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>mLastChar
= aBuf[-1]</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>mLastChar                      </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.0pt;margin-bottom:
12.55pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono"'>191</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>type(mLastChar)                </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.0pt;margin-bottom:
12.6pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono"'>&lt;class 'int'&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>mLastChar + aBuf               </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>Traceback (most
recent call last):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:182.45pt;margin-bottom:
0in;margin-left:37.4pt;text-indent:12.0pt;line-height:110%'><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#880000'>File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;
TypeError: unsupported operand type(s) for +: 'int' and 'bytes'</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=294
 style='width:220.8pt;margin-left:38.15pt;border-collapse:collapse'>
 <tr style='height:60.3pt'>
  <td width=280 valign=top style='width:210.05pt;padding:0in 0in 0in 0in;
  height:60.3pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>mLastChar
  = aBuf[-1:]</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:90.05pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt;
  </span><span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>mLastChar
  b'\xbf'</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:60.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9316;</span></p>
  </td>
 </tr>
 <tr style='height:18.3pt'>
  <td width=280 valign=bottom style='width:210.05pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono";
  color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
  107%;font-family:"Liberation Mono"'>mLastChar + aBuf</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9317;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>b'\xbf\xef\xbb\xbf'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Define a byte
array of length 3.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The last element
of the byte array is 191.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>That’s an
integer.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
1.95pt;margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Concatenating an integer with a byte array doesn’t work. You’ve now
replicated the error you just found in <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>universaldetector.py</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Ah, here’s the fix. Instead of taking the last element of the byte
array, use <u>list slicing </u>to create a new byte array containing just the
last element. That is, start with the last element and continue the slice until
the end of the byte array. Now <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>mLastChar </span>is a byte array of length 1.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
22.35pt;margin-left:16.65pt;text-indent:-16.65pt'>6.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Concatenating a byte array of length 1 with a byte array of length 3
returns a new byte array of length 4.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
18.85pt;margin-left:16.4pt'>So, to ensure that the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>feed() </span>method in <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>universaldetector.py
</span>continues to work no matter how often it’s called, you need to <u>initialize
</u><u><span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>self._mLastChar
</span>as a 0-length byte array</u>, then <i>make sure it stays a byte array</i>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:122.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>self._escDetector.search(self._mLastChar +
aBuf):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.35pt;
margin-left:98.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>self._mInputState = eEscAscii</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=707
 style='width:530.45pt;margin-left:38.15pt;border-collapse:collapse'>
 <tr style='height:21.55pt'>
  <td width=707 style='width:530.45pt;background:#FF8877;padding:0in 5.75pt 0in 0in;
  height:21.55pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>-
  self._mLastChar = aBuf[-1]</span></p>
  </td>
 </tr>
 <tr style='height:21.55pt'>
  <td width=707 style='width:530.45pt;background:#99FF99;padding:0in 5.75pt 0in 0in;
  height:21.55pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>+
  self._mLastChar = aBuf[-1:]</span></p>
  </td>
 </tr>
</table>

<h6 style='margin-top:0in;margin-right:0in;margin-bottom:26.85pt;margin-left:
16.4pt'><span style='font-size:13.0pt;line-height:110%'>15.6.7. </span><span
style='font-size:13.0pt;line-height:110%;font-family:"Liberation Mono";
font-weight:normal'>ord() </span>EXPECTED STRING OF LENGTH <span
style='font-size:13.0pt;line-height:110%'>1, </span>BUT <span style='font-size:
13.0pt;line-height:110%;font-family:"Liberation Mono";font-weight:normal'>int </span>FOUND</h6>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.9pt;margin-left:16.4pt'>Tired yet? You’re almost there…</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>C:\home\chardet&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>python
test.py tests\*\*</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:44.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>tests\ascii\howto.diveintomark.org.xml                      
ascii with confidence 1.0 tests\Big5\0804.blogspot.com.xml </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
color:#880000'>Traceback (most recent call last):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>File
&quot;test.py&quot;, line 10, in &lt;module&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>u.feed(line)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
0in;margin-left:62.15pt;text-indent:-12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
color:#880000'>File &quot;C:\home\chardet\chardet\universaldetector.py&quot;,
line 116, in feed if prober.feed(aBuf) == constants.eFoundIt:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
0in;margin-left:62.15pt;text-indent:-12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
color:#880000'>File &quot;C:\home\chardet\chardet\charsetgroupprober.py&quot;,
line 60, in feed st = prober.feed(aBuf)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
0in;margin-left:62.15pt;text-indent:-12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
color:#880000'>File &quot;C:\home\chardet\chardet\utf8prober.py&quot;, line 53,
in feed codingState = self._mCodingSM.next_state(c)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:50.45pt;margin-bottom:
0in;margin-left:62.15pt;text-indent:-12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
color:#880000'>File &quot;C:\home\chardet\chardet\codingstatemachine.py&quot;,
line 43, in next_state byteCls = self._mModel['classTable'][ord(c)]</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>TypeError: ord()
expected string of length 1, but int found</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
18.9pt;margin-left:16.4pt'>OK, so <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>c </span>is an <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>int</span>, but the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>ord() </span>function
was expecting a 1-character string. Fair enough. Where is <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>c </span>defined?</p>

<p class=MsoNormal style='margin-top:0in;margin-right:404.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'># codingstatemachine.py def
next_state(self, c):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:260.45pt;margin-bottom:
22.55pt;margin-left:62.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'># for each byte we get its
class # if it is first byte, we also get byte length byteCls =
self._mModel['classTable'][ord(c)]</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.9pt;margin-left:16.4pt'>That’s no help; it’s just passed into the function.
Let’s pop the stack.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:434.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'># utf8prober.py def feed(self,
aBuf):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>for c in aBuf:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.25pt;
margin-left:86.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>codingState = self._mCodingSM.next_state(c)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.55pt;margin-left:16.4pt'>Do you see it? In Python 2, <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>aBuf </span>was a
string, so <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>c
</span>was a 1-character string. (That’s what you get when you iterate over a
string — all the characters, one by one.) But now, <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>aBuf </span>is a byte array, so
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>c
</span>is an <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>int</span>,
not a 1-character string. In other words, there’s no need to call the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>ord() </span>function
because <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>c
</span>is already an <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>int</span>!</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.75pt;margin-left:16.4pt'>Thus:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def next_state(self, c):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:74.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'># for each byte we get its class</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:74.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'># if it is first byte, we also get byte
length</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=707
 style='width:530.45pt;margin-left:38.15pt;border-collapse:collapse'>
 <tr style='height:21.55pt'>
  <td width=707 style='width:530.45pt;background:#FF8877;padding:0in 5.75pt 0in 0in;
  height:21.55pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>-    
  byteCls = self._mModel['classTable'][ord(c)]</span></p>
  </td>
 </tr>
 <tr style='height:21.55pt'>
  <td width=707 style='width:530.45pt;background:#99FF99;padding:0in 5.75pt 0in 0in;
  height:21.55pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>+    
  byteCls = self._mModel['classTable'][c]</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
1.8pt;margin-left:16.4pt'>Searching the entire codebase for instances of “<span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>ord(c)</span>”
uncovers similar problems in <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>sbcharsetprober.py</span>…</p>

<p class=MsoNormal style='margin-top:0in;margin-right:422.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'># sbcharsetprober.py def
feed(self, aBuf):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>if not self._mModel['keepEnglishLetter']:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:224.45pt;margin-bottom:
0in;margin-left:62.15pt;text-indent:24.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>aBuf =
self.filter_without_english_letters(aBuf) aLen = len(aBuf) if not aLen: return
self.get_state() for c in aBuf:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:33.0pt;
margin-left:86.7pt;line-height:110%;background:gainsboro'><b><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>order =
self._mModel['charToOrderMap'][ord(c)]</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:25.1pt;
margin-left:17.15pt;line-height:110%'>…and <span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono"'>latin1prober.py</span>…</p>

<p class=MsoNormal style='margin-top:0in;margin-right:266.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'># latin1prober.py def
feed(self, aBuf): aBuf = self.filter_with_english_letters(aBuf) for c in aBuf:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.25pt;
margin-left:86.7pt;line-height:110%;background:gainsboro'><b><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>charClass
= Latin1_CharToClass[ord(c)]</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'><span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>c </span>is iterating over <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>aBuf</span>,
which means it is an integer, not a 1-character string. The solution is the
same: change <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>ord(c)
</span>to just plain <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>c</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:410.45pt;margin-bottom:
0in;margin-left:50.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'># sbcharsetprober.py def
feed(self, aBuf):</span></p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:204.3pt;
margin-bottom:8.5pt;margin-left:.5pt;text-align:center;line-height:110%'><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>if not
self._mModel['keepEnglishLetter']:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:212.45pt;margin-bottom:
0in;margin-left:74.2pt;text-indent:24.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>aBuf =
self.filter_without_english_letters(aBuf) aLen = len(aBuf) if not aLen: return
self.get_state()</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:74.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>for c in aBuf:</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=707
 style='width:530.45pt;margin-left:38.15pt;border-collapse:collapse'>
 <tr style='height:21.55pt'>
  <td width=707 style='width:530.45pt;background:#FF8877;padding:0in 5.75pt 0in 0in;
  height:21.55pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>-        
  order = self._mModel['charToOrderMap'][ord(c)]</span></p>
  </td>
 </tr>
 <tr style='height:21.55pt'>
  <td width=707 style='width:530.45pt;background:#99FF99;padding:0in 5.75pt 0in 0in;
  height:21.55pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>+        
  order = self._mModel['charToOrderMap'][c]</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:254.45pt;margin-bottom:
0in;margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono"'># latin1prober.py def
feed(self, aBuf): aBuf = self.filter_with_english_letters(aBuf) for c in aBuf:</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=707
 style='width:530.45pt;margin-left:38.15pt;border-collapse:collapse'>
 <tr style='height:21.55pt'>
  <td width=707 style='width:530.45pt;background:#FF8877;padding:0in 5.75pt 0in 0in;
  height:21.55pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>-        
  charClass = Latin1_CharToClass[ord(c)]</span></p>
  </td>
 </tr>
 <tr style='height:21.55pt'>
  <td width=707 style='width:530.45pt;background:#99FF99;padding:0in 5.75pt 0in 0in;
  height:21.55pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>+        
  charClass = Latin1_CharToClass[c]</span></p>
  </td>
 </tr>
</table>

<h6 style='margin-top:0in;margin-right:0in;margin-bottom:26.6pt;margin-left:
16.4pt'><span style='font-size:13.0pt;line-height:110%'>15.6.8. U</span>NORDERABLE
TYPES<span style='font-size:13.0pt;line-height:110%'>: </span><span
style='font-size:13.0pt;line-height:110%;font-family:"Liberation Mono";
font-weight:normal'>int() </span><span style='font-size:13.0pt;line-height:
110%'>&gt;= </span><span style='font-size:13.0pt;line-height:110%;font-family:
"Liberation Mono";font-weight:normal'>str()</span></h6>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>Let’s go again.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>C:\home\chardet&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>python
test.py tests\*\*</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:44.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>tests\ascii\howto.diveintomark.org.xml                      
ascii with confidence 1.0 tests\Big5\0804.blogspot.com.xml </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
color:#880000'>Traceback (most recent call last):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>File
&quot;test.py&quot;, line 10, in &lt;module&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>u.feed(line)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
0in;margin-left:62.15pt;text-indent:-12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
color:#880000'>File &quot;C:\home\chardet\chardet\universaldetector.py&quot;,
line 116, in feed if prober.feed(aBuf) == constants.eFoundIt:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
0in;margin-left:62.15pt;text-indent:-12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
color:#880000'>File &quot;C:\home\chardet\chardet\charsetgroupprober.py&quot;,
line 60, in feed st = prober.feed(aBuf)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
0in;margin-left:62.15pt;text-indent:-12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
color:#880000'>File &quot;C:\home\chardet\chardet\sjisprober.py&quot;, line 68,
in feed self._mContextAnalyzer.feed(self._mLastChar[2 - charLen :], charLen)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:158.45pt;margin-bottom:
0in;margin-left:62.15pt;text-indent:-12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
color:#880000'>File &quot;C:\home\chardet\chardet\jpcntx.py&quot;, line 145, in
feed order, charLen = self.get_order(aBuf[i:i+2])</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:152.45pt;margin-bottom:
0in;margin-left:62.15pt;text-indent:-12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
color:#880000'>File &quot;C:\home\chardet\chardet\jpcntx.py&quot;, line 176, in
get_order if ((aStr[0] &gt;= '\x81') and (aStr[0] &lt;= '\x9F')) or \</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
31.05pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>TypeError:
unorderable types: int() &gt;= str()</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.05pt;margin-left:16.4pt'>So what’s this all about? “Unorderable types”? Once
again, the difference between byte arrays and strings is rearing its ugly head.
Take a look at the code:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>class
SJISContextAnalysis(JapaneseContextAnalysis):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def get_order(self, aStr):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:290.45pt;margin-bottom:
0in;margin-left:86.7pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>if not aStr: return -1, 1 #
find out current char's byte length</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.5pt;
margin-left:86.7pt;line-height:110%;background:gainsboro'><b><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>if
((aStr[0] &gt;= '\x81') and (aStr[0] &lt;= '\x9F')) or \</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:218.45pt;margin-bottom:
0in;margin-left:86.2pt;text-indent:.25in;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>((aStr[0]
&gt;= '\xE0') and (aStr[0] &lt;= '\xFC')): charLen = 2 else:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.35pt;
margin-left:110.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>charLen = 1</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>And where does <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>aStr </span>come
from? Let’s pop the stack:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def feed(self, aBuf, aLen):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:368.45pt;margin-bottom:
0in;margin-left:62.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>. . i =
self._mNeedToSkipCharNum while i &lt; aLen:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.2pt;
margin-left:86.7pt;line-height:110%;background:gainsboro'><b><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>order,
charLen = self.get_order(aBuf[i:i+2])</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.65pt;margin-left:16.4pt'>Oh look, it’s our old friend, <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>aBuf</span>.
As you might have guessed from every other issue we’ve encountered in this
chapter, <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>aBuf
</span>is a byte array. Here, the <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>feed() </span>method isn’t just passing it
on wholesale; it’s slicing it. But as you saw <u>earlier in this chapter</u>,
slicing a byte array returns a byte array, so the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>aStr </span>parameter that gets
passed to the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>get_order()
</span>method is still a byte array.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.8pt;margin-left:16.4pt'>And what is this code trying to do with <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>aStr</span>?
It’s taking the first element of the byte array and comparing it to a string of
length 1. In Python 2, that worked, because <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>aStr </span>and <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>aBuf </span>were
strings, and <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>aStr[0]
</span>would be a string, and you can compare strings for inequality. But in
Python 3, <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>aStr
</span>and <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>aBuf
</span>are byte arrays, <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>aStr[0] </span>is an integer, and you can’t
compare integers and strings for inequality without explicitly coercing one of
them.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>In this case, there’s no need to make the code more
complicated by adding an explicit coercion. <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>aStr[0] </span>yields an
integer; the things you’re comparing to are all constants. Let’s change them
from 1-character strings to integers. And while we’re at it, let’s change <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>aStr </span>to
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>aBuf</span>,
since it’s not actually a string.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>class
SJISContextAnalysis(JapaneseContextAnalysis):</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=707
 style='width:530.45pt;margin-left:38.15pt;border-collapse:collapse'>
 <tr style='height:43.1pt'>
  <td width=707 style='width:530.45pt;background:#FF8877;padding:0in 5.75pt 0in 0in;
  height:43.1pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.3pt;
  margin-left:42.0pt;text-indent:-42.0pt;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>-<span
  style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='font-size:10.0pt;line-height:107%;font-family:
  "Liberation Mono"'>def get_order(self, aStr):</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
  margin-left:42.0pt;text-indent:-42.0pt;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>-<span
  style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='font-size:10.0pt;line-height:107%;font-family:
  "Liberation Mono"'>if not aStr: return -1, 1</span></p>
  </td>
 </tr>
 <tr style='height:43.1pt'>
  <td width=707 style='width:530.45pt;background:#99FF99;padding:0in 5.75pt 0in 0in;
  height:43.1pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.3pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>+     def
  get_order(self, aBuf):</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>+     
  if not aBuf: return -1, 1</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:98.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'># find out current char's byte length</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=707
 style='width:530.45pt;margin-left:38.15pt;border-collapse:collapse'>
 <tr style='height:43.1pt'>
  <td width=707 style='width:530.45pt;background:#FF8877;padding:0in 5.75pt 0in 0in;
  height:43.1pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:140.7pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>-         if ((aStr[0]
  &gt;= '\x81') and (aStr[0] &lt;= '\x9F')) or \ -            ((aBuf[0] &gt;=
  '\xE0') and (aBuf[0] &lt;= '\xFC')):</span></p>
  </td>
 </tr>
 <tr style='height:43.1pt'>
  <td width=707 style='width:530.45pt;background:#99FF99;padding:0in 5.75pt 0in 0in;
  height:43.1pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:164.7pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>+         if ((aBuf[0]
  &gt;= 0x81) and (aBuf[0] &lt;= 0x9F)) or \ +            ((aBuf[0] &gt;= 0xE0)
  and (aBuf[0] &lt;= 0xFC)):</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:410.45pt;margin-bottom:
21.0pt;margin-left:98.2pt;text-indent:24.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>charLen
= 2 else: charLen = 1</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:98.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'># return its order if it is hiragana</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=707
 style='width:530.45pt;margin-left:38.15pt;border-collapse:collapse'>
 <tr style='height:107.7pt'>
  <td width=707 style='width:530.45pt;background:#FF8877;padding:0in 5.75pt 0in 0in;
  height:107.7pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.3pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>-<span
  style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='font-size:10.0pt;line-height:107%;font-family:
  "Liberation Mono"'>if len(aStr) &gt; 1:</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.3pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>-<span
  style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='font-size:10.0pt;line-height:107%;font-family:
  "Liberation Mono"'>if (aStr[0] == '\202') and \</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:190%'><span
  style='font-size:10.0pt;line-height:190%;font-family:"Liberation Mono"'>-<span
  style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='font-size:10.0pt;line-height:190%;font-family:
  "Liberation Mono"'>(aStr[1] &gt;= '\x9F') and \-                (aStr[1]
  &lt;= '\xF1'):</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>-<span
  style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='font-size:10.0pt;line-height:107%;font-family:
  "Liberation Mono"'>return ord(aStr[1]) - 0x9F, charLen</span></p>
  </td>
 </tr>
 <tr style='height:107.7pt'>
  <td width=707 style='width:530.45pt;background:#99FF99;padding:0in 5.75pt 0in 0in;
  height:107.7pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.3pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>+      if len(aBuf)
  &gt; 1:</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.3pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>+             if
  (aBuf[0] == 202) and \</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:278.7pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:190%'><span style='font-size:
  10.0pt;line-height:190%;font-family:"Liberation Mono"'>+               
  (aBuf[1] &gt;= 0x9F) and \ +                (aBuf[1] &lt;= 0xF1):</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>+               
  return aBuf[1] - 0x9F, charLen</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:98.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>return -1, charLen</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>class
EUCJPContextAnalysis(JapaneseContextAnalysis):</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=707
 style='width:530.45pt;margin-left:38.15pt;border-collapse:collapse'>
 <tr style='height:43.1pt'>
  <td width=707 style='width:530.45pt;background:#FF8877;padding:0in 5.75pt 0in 0in;
  height:43.1pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.3pt;
  margin-left:42.0pt;text-indent:-42.0pt;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>-<span
  style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='font-size:10.0pt;line-height:107%;font-family:
  "Liberation Mono"'>def get_order(self, aStr):</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
  margin-left:42.0pt;text-indent:-42.0pt;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>-<span
  style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='font-size:10.0pt;line-height:107%;font-family:
  "Liberation Mono"'>if not aStr: return -1, 1</span></p>
  </td>
 </tr>
 <tr style='height:43.1pt'>
  <td width=707 style='width:530.45pt;background:#99FF99;padding:0in 5.75pt 0in 0in;
  height:43.1pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.3pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>+     def
  get_order(self, aBuf):</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>+     
  if not aBuf: return -1, 1</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:98.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'># find out current char's byte length</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=707
 style='width:530.45pt;margin-left:38.15pt;border-collapse:collapse'>
 <tr style='height:43.1pt'>
  <td width=707 style='width:530.45pt;background:#FF8877;padding:0in 5.75pt 0in 0in;
  height:43.1pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:176.7pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>-         if (aStr[0]
  == '\x8E') or \ -           ((aStr[0] &gt;= '\xA1') and (aStr[0] &lt;=
  '\xFE')):</span></p>
  </td>
 </tr>
 <tr style='height:43.1pt'>
  <td width=707 style='width:530.45pt;background:#99FF99;padding:0in 5.75pt 0in 0in;
  height:43.1pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:200.7pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>+         if (aBuf[0]
  == 0x8E) or \ +           ((aBuf[0] &gt;= 0xA1) and (aBuf[0] &lt;= 0xFE)):</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:122.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>charLen = 2</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=707
 style='width:530.45pt;margin-left:38.15pt;border-collapse:collapse'>
 <tr style='height:21.55pt'>
  <td width=707 style='width:530.45pt;background:#FF8877;padding:0in 5.75pt 0in 0in;
  height:21.55pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>-        
  elif aStr[0] == '\x8F':</span></p>
  </td>
 </tr>
 <tr style='height:21.55pt'>
  <td width=707 style='width:530.45pt;background:#99FF99;padding:0in 5.75pt 0in 0in;
  height:21.55pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>+        
  elif aBuf[0] == 0x8F:</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:380.45pt;margin-bottom:
0in;margin-left:98.2pt;text-indent:24.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>charLen
= 3 else:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:122.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>charLen = 1</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:86.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'># return its order if it is hiragana</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=707
 style='width:530.45pt;margin-left:38.15pt;border-collapse:collapse'>
 <tr style='height:107.7pt'>
  <td width=707 style='width:530.45pt;background:#FF8877;padding:0in 5.75pt 0in 0in;
  height:107.7pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.3pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>-<span
  style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='font-size:10.0pt;line-height:107%;font-family:
  "Liberation Mono"'>if len(aStr) &gt; 1:</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.3pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>-<span
  style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='font-size:10.0pt;line-height:107%;font-family:
  "Liberation Mono"'>if (aStr[0] == '\xA4') and \</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:190%'><span
  style='font-size:10.0pt;line-height:190%;font-family:"Liberation Mono"'>-<span
  style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='font-size:10.0pt;line-height:190%;font-family:
  "Liberation Mono"'>(aStr[1] &gt;= '\xA1') and \-              (aStr[1] &lt;=
  '\xF3'):</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>-<span
  style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><span style='font-size:10.0pt;line-height:107%;font-family:
  "Liberation Mono"'>return ord(aStr[1]) - 0xA1, charLen</span></p>
  </td>
 </tr>
 <tr style='height:107.7pt'>
  <td width=707 style='width:530.45pt;background:#99FF99;padding:0in 5.75pt 0in 0in;
  height:107.7pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.3pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>+    if len(aBuf) &gt;
  1:</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.3pt;
  margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>+           if
  (aBuf[0] == 0xA4) and \</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:290.7pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:190%'><span style='font-size:
  10.0pt;line-height:190%;font-family:"Liberation Mono"'>+             
  (aBuf[1] &gt;= 0xA1) and \ +              (aBuf[1] &lt;= 0xF3):</span></p>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>+              
  return aBuf[1] - 0xA1, charLen</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.25pt;
margin-left:86.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>return -1, charLen</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
1.8pt;margin-left:16.4pt'>Searching the entire codebase for occurrences of the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>ord() </span>function
uncovers the same problem in <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>chardistribution.py </span>(specifically, in the
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>EUCTWDistributionAnalysis</span>,
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>EUCKRDistributionAnalysis</span>,</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:21.0pt;
margin-left:17.15pt;line-height:161%'><span style='font-size:10.0pt;line-height:
161%;font-family:"Liberation Mono"'>GB2312DistributionAnalysis</span>, <span
style='font-size:10.0pt;line-height:161%;font-family:"Liberation Mono"'>Big5DistributionAnalysis</span>,
<span style='font-size:10.0pt;line-height:161%;font-family:"Liberation Mono"'>SJISDistributionAnalysis</span>,
and <span style='font-size:10.0pt;line-height:161%;font-family:"Liberation Mono"'>EUCJPDistributionAnalysis
</span>classes. In each case, the fix is similar to the change we made to the <span
style='font-size:10.0pt;line-height:161%;font-family:"Liberation Mono"'>EUCJPContextAnalysis
</span>and <span style='font-size:10.0pt;line-height:161%;font-family:"Liberation Mono"'>SJISContextAnalysis
</span>classes in <span style='font-size:10.0pt;line-height:161%;font-family:
"Liberation Mono"'>jpcntx.py</span>.</p>

<h6 style='margin-top:0in;margin-right:0in;margin-bottom:26.75pt;margin-left:
16.4pt'><span style='font-size:13.0pt;line-height:110%'>15.6.9. G</span>LOBAL
NAME <span style='font-size:13.0pt;line-height:110%;font-family:"Liberation Mono";
font-weight:normal'>'reduce' </span>IS NOT DEFINED</h6>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>Once more into the breach…</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>C:\home\chardet&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>python
test.py tests\*\*</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:44.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>tests\ascii\howto.diveintomark.org.xml                      
ascii with confidence 1.0 tests\Big5\0804.blogspot.com.xml </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
color:#880000'>Traceback (most recent call last):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>File
&quot;test.py&quot;, line 12, in &lt;module&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>u.close()</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
0in;margin-left:62.15pt;text-indent:-12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
color:#880000'>File &quot;C:\home\chardet\chardet\universaldetector.py&quot;,
line 141, in close proberConfidence = prober.get_confidence()</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:68.45pt;margin-bottom:
0in;margin-left:62.15pt;text-indent:-12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
color:#880000'>File &quot;C:\home\chardet\chardet\latin1prober.py&quot;, line
126, in get_confidence total = reduce(operator.add, self._mFreqCounter)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
31.35pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>NameError: global
name 'reduce' is not defined</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
18.95pt;margin-left:16.4pt'>According to the official <a
href="http://docs.python.org/3.0/whatsnew/3.0.html#builtins"><span
style='color:black'>What’s</span></a><u> </u><a
href="http://docs.python.org/3.0/whatsnew/3.0.html#builtins"><span
style='color:black'>New</span></a><u> </u><a
href="http://docs.python.org/3.0/whatsnew/3.0.html#builtins"><span
style='color:black'>In</span></a><u> </u><a
href="http://docs.python.org/3.0/whatsnew/3.0.html#builtins"><span
style='color:black'>Python</span></a><u> </u><a
href="http://docs.python.org/3.0/whatsnew/3.0.html#builtins"><span
style='color:black'>3.0</span></a><u> </u>guide, the <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>reduce() </span>function
has been moved out of the global namespace and into the <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>functools </span>module.
Quoting the guide: “Use <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>functools.reduce() </span>if you really need it;
however, 99 percent of the time an explicit <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>for </span>loop is more
readable.” You can read more about the decision from Guido van Rossum’s weblog:
<a href="http://www.artima.com/weblogs/viewpost.jsp?thread=98196"><span
style='color:black'>The</span></a><u> </u><a
href="http://www.artima.com/weblogs/viewpost.jsp?thread=98196"><span
style='color:black'>fate</span></a><u> </u><a
href="http://www.artima.com/weblogs/viewpost.jsp?thread=98196"><span
style='color:black'>of</span></a><u> </u><a
href="http://www.artima.com/weblogs/viewpost.jsp?thread=98196"><span
style='color:black'>reduce()</span></a><u> </u><a
href="http://www.artima.com/weblogs/viewpost.jsp?thread=98196"><span
style='color:black'>in</span></a><u> </u><a
href="http://www.artima.com/weblogs/viewpost.jsp?thread=98196"><span
style='color:black'>Python</span></a><u> </u><a
href="http://www.artima.com/weblogs/viewpost.jsp?thread=98196"><span
style='color:black'>3000</span></a>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def get_confidence(self):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>if self.get_state() == constants.eNotMe:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:86.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>return 0.01</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.35pt;
margin-left:62.65pt;line-height:110%;background:gainsboro'><b><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>total =
reduce(operator.add, self._mFreqCounter)</span></b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.8pt;margin-left:16.4pt'>The <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>reduce() </span>function takes two arguments — a
function and a list (strictly speaking, any iterable object will do) — and
applies the function cumulatively to each item of the list. In other words,
this is a fancy and roundabout way of adding up all the items in a list and
returning the result.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>This monstrosity was so common that
Python added a global <span style='font-size:10.0pt;line-height:107%;
font-family:"Liberation Mono"'>sum() </span>function.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def get_confidence(self):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:74.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>if self.get_state() == constants.eNotMe:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:13.35pt;
margin-left:98.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>return 0.01</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=707
 style='width:530.45pt;margin-left:38.15pt;border-collapse:collapse'>
 <tr style='height:21.55pt'>
  <td width=707 style='width:530.45pt;background:#FF8877;padding:0in 5.75pt 0in 0in;
  height:21.55pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>-    
  total = reduce(operator.add, self._mFreqCounter)</span></p>
  </td>
 </tr>
 <tr style='height:21.55pt'>
  <td width=707 style='width:530.45pt;background:#99FF99;padding:0in 5.75pt 0in 0in;
  height:21.55pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>+    
  total = sum(self._mFreqCounter)</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
18.9pt;margin-left:16.4pt'>Since you’re no longer using the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>operator
</span>module, you can remove that <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>import </span>from the top of the file as
well.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:284.45pt;margin-bottom:
.25pt;margin-left:50.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>from .charsetprober import
CharSetProber from . import constants</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.3pt;
margin-left:37.9pt;line-height:110%;background:#FF8877'><span style='font-size:
10.0pt;line-height:110%;font-family:"Liberation Mono"'>- import operator</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>I CAN HAZ TESTZ?<br clear=all
style='page-break-before:always'>
</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>C:\home\chardet&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>python
test.py tests\*\*</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:26.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>tests\ascii\howto.diveintomark.org.xml                      
ascii with confidence 1.0
tests\Big5\0804.blogspot.com.xml                             Big5 with
confidence 0.99 tests\Big5\blog.worren.net.xml                              
Big5 with confidence 0.99
tests\Big5\carbonxiv.blogspot.com.xml                        Big5 with
confidence 0.99 tests\Big5\catshadow.blogspot.com.xml                       
Big5 with confidence 0.99
tests\Big5\coolloud.org.tw.xml                               Big5 with confidence
0.99 tests\Big5\digitalwall.com.xml                               Big5 with
confidence 0.99 tests\Big5\ebao.us.xml                                      
Big5 with confidence 0.99
tests\Big5\fudesign.blogspot.com.xml                         Big5 with
confidence 0.99 tests\Big5\kafkatseng.blogspot.com.xml                      
Big5 with confidence 0.99
tests\Big5\ke207.blogspot.com.xml                            Big5 with
confidence 0.99 tests\Big5\leavesth.blogspot.com.xml                         Big5
with confidence 0.99
tests\Big5\letterlego.blogspot.com.xml                       Big5 with
confidence 0.99 tests\Big5\linyijen.blogspot.com.xml                        
Big5 with confidence 0.99
tests\Big5\marilynwu.blogspot.com.xml                        Big5 with
confidence 0.99 tests\Big5\myblog.pchome.com.tw.xml                         
Big5 with confidence 0.99
tests\Big5\oui-design.com.xml                                Big5 with
confidence 0.99 tests\Big5\sanwenji.blogspot.com.xml                         Big5
with confidence 0.99
tests\Big5\sinica.edu.tw.xml                                 Big5 with
confidence 0.99 tests\Big5\sylvia1976.blogspot.com.xml                      
Big5 with confidence 0.99 tests\Big5\tlkkuo.blogspot.com.xml                          
Big5 with confidence 0.99
tests\Big5\tw.blog.xubg.com.xml                              Big5 with
confidence 0.99 tests\Big5\unoriginalblog.com.xml                           
Big5 with confidence 0.99 tests\Big5\upsaid.com.xml                                    Big5
with confidence 0.99
tests\Big5\willythecop.blogspot.com.xml                      Big5 with
confidence 0.99 tests\Big5\ytc.blogspot.com.xml                             
Big5 with confidence 0.99 tests\EUC-JP\aivy.co.jp.xml                                 
EUC-JP with confidence 0.99
tests\EUC-JP\akaname.main.jp.xml                             EUC-JP with
confidence 0.99 tests\EUC-JP\arclamp.jp.xml                                 
EUC-JP with confidence 0.99 .</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>316 tests</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
46.55pt;margin-left:16.4pt'>Holy crap, it actually works! <a
href="http://www.hampsterdance.com/"><i><span style='color:black'>/me</span></i></a><i><u>
</u></i><a href="http://www.hampsterdance.com/"><i><span style='color:black'>does</span></i></a><i><u>
</u></i><a href="http://www.hampsterdance.com/"><i><span style='color:black'>a</span></i></a><i><u>
</u></i><a href="http://www.hampsterdance.com/"><i><span style='color:black'>little</span></i></a><i><u>
</u></i><a href="http://www.hampsterdance.com/"><i><span style='color:black'>dance</span></i></a></p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:33.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h5 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>15.7.
S</span>UMMARY</h5>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.45pt;margin-left:16.4pt'>What have we learned?</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Porting any non-trivial amount of code from Python 2 to Python 3 is
going to be a pain. There’s no way around it. It’s hard.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <u>automated </u><u><span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>2to3 </span>tool </u>is helpful as far as it
goes, but it will only do the easy parts — function renames, module renames,
syntax changes. It’s an impressive piece of engineering, but in the end it’s
just an intelligent search-and-replace bot.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The #1 porting problem in this library was the difference between
strings and bytes. In this case that seems obvious, since the whole point of
the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>chardet
</span>library is to convert a stream of bytes into a string. But “a stream of
bytes” comes up more often than you might think. Reading a file in “binary”
mode? You’ll get a stream of bytes. Fetching a web page? Calling a web <span
style='font-size:9.5pt;line-height:154%'>API</span>? They return a stream of
bytes, too.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span><i>You </i>need to understand your program. Thoroughly. Preferably
because you wrote it, but at the very least, you need to be comfortable with
all its quirks and musty corners. The bugs are everywhere.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Test cases are essential. Don’t port anything without them. The <i>only </i>reason
I have any confidence that <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>chardet </span>works in Python 3 is that I
started with a test suite that exercised all major code paths. If you don’t
have any tests, write some tests before you start porting to Python 3. If you
have a few tests, write more. If you have a lot of tests, then the real fun can
begin.</p>

<h3 style='margin-top:0in;margin-right:22.2pt;margin-bottom:0in;margin-left:
16.4pt;line-height:107%'><span style='font-size:24.0pt;line-height:107%'>C</span><span
style='font-size:19.0pt;line-height:107%'>HAPTER </span><span style='font-size:
24.0pt;line-height:107%'>16. P</span><span style='font-size:19.0pt;line-height:
107%'>ACKAGING </span><span style='font-size:24.0pt;line-height:107%'>P</span><span
style='font-size:19.0pt;line-height:107%'>YTHON </span><span style='font-size:
24.0pt;line-height:107%'>L</span><span style='font-size:19.0pt;line-height:
107%'>IBRARIES</span></h3>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:39.95pt;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=736 height=4 id="Group 740157"
src="Dive%20Into%20Python%203_files/image001.gif"></span></p>

<p class=MsoNormal align=right style='margin-top:0in;margin-right:29.3pt;
margin-bottom:65.45pt;margin-left:255.85pt;text-align:right;line-height:160%'><span
style='font-size:13.0pt;line-height:160%;font-family:"Calibri",sans-serif'>&#10077;
</span><i>You’ll find the shame is like the pain; you only feel it once. </i><span
style='font-size:13.0pt;line-height:160%;font-family:"Calibri",sans-serif'>&#10078;
</span><i>— Marquise de Merteuil, </i><a
href="http://www.imdb.com/title/tt0094947/quotes"><i><span style='color:black'>Dangerous</span></i></a><i><u>
</u></i><a href="http://www.imdb.com/title/tt0094947/quotes"><i><span
style='color:black'>Liaisons</span></i></a></p>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:66.3pt;margin-left:
16.4pt;line-height:110%'><span style='font-size:18.0pt;line-height:110%'>16.1.
D</span>IVING <span style='font-size:18.0pt;line-height:110%'>I</span>N</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.55pt;margin-left:16.4pt'><span style='font-size:48.0pt;line-height:154%;
font-family:"DejaVu Serif",serif;color:#888888'>R </span>eal artists ship. Or
so says Steve Jobs. Do you want to release a Python script, library, framework,
or application? Excellent. The world needs more Python code. Python 3 comes
with a packaging framework called Distutils. Distutils is many things: a build
tool (for you), an installation tool (for your users), a package metadata
format (for search engines), and more. It integrates with the <a
href="http://pypi.python.org/"><span style='color:black'>Python</span></a><u> </u><a
href="http://pypi.python.org/"><span style='color:black'>Package</span></a><u> </u><a
href="http://pypi.python.org/"><span style='color:black'>Index</span></a><u> </u>(“PyPI”),
a central repository for open source Python libraries.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.05pt;margin-left:16.4pt'>All of these facets of Distutils center around the <i>setup
script</i>, traditionally called <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>setup.py</span>. In fact, you’ve already
seen several Distutils setup scripts in this book. You used Distutils to
install <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>httplib2
</span>in <u>HTTP Web Services </u>and again to install <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>chardet </span>in <u>Case
Study: Porting </u><u><span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>chardet </span>to Python 3</u>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>In this chapter, you’ll learn how the setup scripts
for <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>chardet
</span>and <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>httplib2
</span>work, and you’ll step through the process of releasing your own Python
software.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:368.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'># chardet's setup.py from
distutils.core import setup setup( name = &quot;chardet&quot;, packages =
[&quot;chardet&quot;], version = &quot;1.0.2&quot;,</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:236.45pt;margin-bottom:
0in;margin-left:62.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>description = &quot;Universal
encoding detector&quot;, author = &quot;Mark Pilgrim&quot;,</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:284.45pt;margin-bottom:
0in;margin-left:62.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>author_email =
&quot;mark@diveintomark.org&quot;, url =
&quot;http://chardet.feedparser.org/&quot;,</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:44.45pt;margin-bottom:
0in;margin-left:62.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>download_url =
&quot;http://chardet.feedparser.org/download/python3-chardet-1.0.1.tgz&quot;,
keywords = [&quot;encoding&quot;, &quot;i18n&quot;, &quot;xml&quot;],
classifiers = [</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:86.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&quot;Programming Language :: Python&quot;,</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:212.45pt;margin-bottom:
0in;margin-left:86.7pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>&quot;Programming Language ::
Python :: 3&quot;, &quot;Development Status :: 4 - Beta&quot;,</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:86.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&quot;Environment :: Other
Environment&quot;,</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:26.45pt;margin-bottom:
0in;margin-left:86.7pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>&quot;Intended Audience ::
Developers&quot;, &quot;License :: OSI Approved :: GNU Library or Lesser
General Public License (LGPL)&quot;,</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:134.45pt;margin-bottom:
0in;margin-left:86.7pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>&quot;Operating System :: OS
Independent&quot;, &quot;Topic :: Software Development :: Libraries :: Python
Modules&quot;, &quot;Topic :: Text Processing :: Linguistic&quot;,</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:398.45pt;margin-bottom:
0in;margin-left:62.15pt;text-indent:24.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>],
long_description = &quot;&quot;&quot;\</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
21.0pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>Universal character encoding
detector -------------------------------------</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>Detects</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:110.45pt;margin-bottom:
0in;margin-left:56.15pt;text-indent:-12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>-<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>ASCII,
UTF-8, UTF-16 (2 variants), UTF-32 (4 variants) - Big5, GB2312, EUC-TW,
HZ-GB-2312, ISO-2022-CN (Traditional and Simplified Chinese) - EUC-JP,
SHIFT_JIS, ISO-2022-JP (Japanese)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:110.45pt;margin-bottom:
8.25pt;margin-left:56.15pt;text-indent:-12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>-<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>EUC-KR,
ISO-2022-KR (Korean) - KOI8-R, MacCyrillic, IBM855, IBM866, ISO-8859-5,
windows-1251 (Cyrillic) - ISO-8859-2, windows-1250 (Hungarian)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:110.45pt;margin-bottom:
0in;margin-left:56.15pt;text-indent:-12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>-<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>ISO-8859-5,
windows-1251 (Bulgarian) - windows-1252 (English)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:110.45pt;margin-bottom:
0in;margin-left:56.15pt;text-indent:-12.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>-<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>ISO-8859-7,
windows-1253 (Greek) - ISO-8859-8, windows-1255 (Visual and Logical Hebrew)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:110.45pt;margin-bottom:
29.5pt;margin-left:56.15pt;text-indent:-12.0pt;line-height:110%'><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>-<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>TIS-620
(Thai)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>This version requires Python 3 or later; a
Python 2 version is available separately.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>&quot;&quot;&quot;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:58.05pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:68.8pt;margin-bottom:
45.3pt;margin-left:75.95pt;text-indent:-29.3pt'><span style='font-size:24.0pt;
line-height:154%;font-family:"Calibri",sans-serif'>&#9758; </span><span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>chardet
</span>and <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>httplib2
</span>are open source, but there’s no requirement that you release your own
Python libraries under any particular license. The process described in this
chapter will work for any Python software, regardless of license.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:33.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h5 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>16.2.
T</span>HINGS <span style='font-size:18.0pt;line-height:112%'>D</span>ISTUTILS <span
style='font-size:18.0pt;line-height:112%'>C</span>AN<span style='font-size:
18.0pt;line-height:112%'>’</span>T <span style='font-size:18.0pt;line-height:
112%'>D</span>O <span style='font-size:18.0pt;line-height:112%'>F</span>OR <span
style='font-size:18.0pt;line-height:112%'>Y</span>OU</h5>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.4pt;line-height:107%'>Releasing your first Python package
is a daunting process. (Releasing your second one is a little easier.)</p>

<p class=MsoNormal align=right style='margin-top:0in;margin-right:35.25pt;
margin-bottom:26.7pt;margin-left:.5pt;text-align:right;line-height:110%'>Distutils
tries to automate as much of it as possible, but there are some things you
simply must do yourself.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-12.25pt'>• <b>Choose a license</b>. This
is a complicated topic, fraught with politics and peril. If you wish to release
your software as open source, I humbly offer five pieces of advice:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Don’t write your
own license.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Don’t write your
own license.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.3pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Don’t write your
own license.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.05pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>It doesn’t need
to be <span style='font-size:9.5pt;line-height:107%'>GPL</span>, but <a
href="http://www.dwheeler.com/essays/gpl-compatible.html"><span
style='color:black'>it</span></a><u> </u><a
href="http://www.dwheeler.com/essays/gpl-compatible.html"><span
style='color:black'>needs</span></a><u> </u><a
href="http://www.dwheeler.com/essays/gpl-compatible.html"><span
style='color:black'>to</span></a><u> </u><a
href="http://www.dwheeler.com/essays/gpl-compatible.html"><span
style='color:black'>be</span></a><u> </u><a
href="http://www.dwheeler.com/essays/gpl-compatible.html"><span
style='font-size:9.5pt;line-height:107%;color:black'>GPL</span></a><a
href="http://www.dwheeler.com/essays/gpl-compatible.html"><span
style='color:black'>-compatible</span></a>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>5.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Don’t write your
own license.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-12.25pt;line-height:107%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><b>Classify your
software </b>using the PyPI classification system. I’ll explain what this means
later in this chapter.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-12.25pt'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span><b>Write a “read me” file</b>. Don’t skimp on this. At a minimum, it
should give your users an overview of what your software does and how to
install it.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:33.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h5 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>16.3.
D</span>IRECTORY <span style='font-size:18.0pt;line-height:112%'>S</span>TRUCTURE</h5>

<p class=MsoNormal align=right style='margin-top:0in;margin-right:36.15pt;
margin-bottom:.15pt;margin-left:.5pt;text-align:right;line-height:110%'>To
start packaging your Python software, you need to get your files and
directories in order. The <span style='font-size:10.0pt;line-height:110%;
font-family:"Liberation Mono"'>httplib2</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=251
 style='width:188.3pt;margin-left:16.65pt;border-collapse:collapse'>
 <tr style='height:27.95pt'>
  <td width=216 valign=top style='width:161.75pt;padding:0in 0in 0in 0in;
  height:27.95pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'>directory
  looks like this:</p>
  </td>
  <td width=35 valign=top style='width:26.55pt;padding:0in 0in 0in 0in;
  height:27.95pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.0pt;
  margin-left:0in;text-indent:0in;line-height:107%'>&nbsp;</p>
  </td>
 </tr>
 <tr style='height:53.35pt'>
  <td width=216 valign=bottom style='width:161.75pt;padding:0in 0in 0in 0in;
  height:53.35pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:80.2pt;margin-bottom:
  0in;margin-left:21.55pt;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>httplib2/
  |</span></p>
  </td>
  <td width=35 valign=top style='width:26.55pt;padding:0in 0in 0in 0in;
  height:53.35pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
  margin-left:15.8pt;text-indent:0in;line-height:107%'><span style='font-family:
  "DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>
  </td>
 </tr>
 <tr style='height:43.5pt'>
  <td width=216 valign=top style='width:161.75pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:21.55pt;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>+--README.txt</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
  margin-left:21.55pt;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>|</span></p>
  </td>
  <td width=35 valign=top style='width:26.55pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
  margin-left:15.8pt;text-indent:0in;line-height:107%'><span style='font-family:
  "DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>
  </td>
 </tr>
 <tr style='height:43.5pt'>
  <td width=216 valign=top style='width:161.75pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.75pt;
  margin-left:21.55pt;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>+--setup.py</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
  margin-left:21.55pt;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>|</span></p>
  </td>
  <td width=35 valign=top style='width:26.55pt;padding:0in 0in 0in 0in;
  height:43.5pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
  margin-left:15.8pt;text-indent:0in;line-height:107%'><span style='font-family:
  "DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>
  </td>
 </tr>
 <tr style='height:18.3pt'>
  <td width=216 valign=bottom style='width:161.75pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
  margin-left:21.55pt;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>+--httplib2/</span></p>
  </td>
  <td width=35 valign=top style='width:26.55pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
  margin-left:15.8pt;text-indent:0in;line-height:107%'><span style='font-family:
  "DejaVu Sans",sans-serif;color:#222222'>&#9315;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:452.45pt;margin-bottom:
0in;margin-left:56.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>| +--__init__.py |</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:56.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>+--iri2uri.py</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.15pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Make a root
directory to hold everything. Give it the same name as your Python module.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>To accomodate Windows users, your “read me” file should include a <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>.txt </span>extension,
and it should use Windows-style carriage returns. Just because <i>you </i>use a
fancy text editor that runs from the command line and includes its own macro
language, that doesn’t mean you need to make life difficult for your users.
(Your users use Notepad. Sad but true.) Even if you’re on Linux or Mac OS X,
your fancy text editor undoubtedly has an option to save files with
Windows-style carriage returns.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Your Distutils setup script should be named <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>setup.py </span>unless you have
a good reason not to. You do not have a good reason not to.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>If your Python software is a single <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>.py </span>file, you should put
it in the root directory along with your “read me” file and your setup script.
But <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>httplib2
</span>is not a single <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>.py </span>file; it’s <u>a multi-file module</u>.
But that’s OK!</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>Just put the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>httplib2 </span>directory in
the root directory, so you have an <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>__init__.py </span>file within an <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>httplib2/
</span>directory within the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>httplib2/ </span>root directory. That’s not a
problem; in fact, it will simplify your packaging process.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.0pt;margin-left:16.4pt'>The <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>chardet </span>directory looks slightly
different. Like <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>httplib2</span>, it’s <u>a multi-file module</u>, so there’s
a <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>chardet/
</span>directory within the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>chardet/ </span>root directory. In addition to
the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>README.txt
</span>file, <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>chardet
</span>has <span style='font-size:9.5pt;line-height:154%'>HTML</span>formatted
documentation in the <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>docs/ </span>directory. The <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>docs/ </span>directory contains
several <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>.html
</span>and <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>.css
</span>files and an <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>images/ </span>subdirectory, which contains several <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>.png </span>and
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>.gif
</span>files. (This will be important later.) Also, in keeping with the
convention for (<span style='font-size:9.5pt;line-height:154%'>L</span>)<span
style='font-size:9.5pt;line-height:154%'>GPL</span>-licensed software, it has a
separate file called <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>COPYING.txt </span>which contains the complete text of the <span
style='font-size:9.5pt;line-height:154%'>LGPL</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:476.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>chardet/ | +--COPYING.txt |</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:482.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>+--setup.py | +--README.txt |</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:458.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>+--docs/ |  | |  +--index.html
|  | |  +--usage.html |  | |  +--images/ ... |</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:458.45pt;margin-bottom:
47.65pt;margin-left:55.4pt;text-indent:-.25in;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>+--chardet/
| +--__init__.py | +--big5freq.py | +--...</span></p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:33.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h5 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>16.4.
W</span>RITING <span style='font-size:18.0pt;line-height:112%'>Y</span>OUR <span
style='font-size:18.0pt;line-height:112%'>S</span>ETUP <span style='font-size:
18.0pt;line-height:112%'>S</span>CRIPT</h5>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.55pt;margin-left:16.4pt'>The Distutils setup script is a Python script. In
theory, it can do anything Python can do. In practice, it should do as little
as possible, in as standard a way as possible. Setup scripts should be boring.
The more exotic your installation process is, the more exotic your bug reports
will be.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.9pt;margin-left:16.4pt'>The first line of every Distutils setup script is
always the same:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.3pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>from distutils.core import setup</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.8pt;margin-left:16.4pt'>This imports the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>setup() </span>function, which
is the main entry point into Distutils. 95% of all Distutils setup scripts
consist of a single call to <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>setup() </span>and nothing else. (I totally just
made up that statistic, but if your Distutils setup script is doing more than
calling the Distutils <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>setup() </span>function, you should have a good
reason. Do you have a good reason? I didn’t think so.)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.6pt;margin-left:16.4pt'>The <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>setup() </span>function <a
href="http://docs.python.org/3.1/distutils/apiref.html#distutils.core.setup"><span
style='color:black'>can</span></a><u> </u><a
href="http://docs.python.org/3.1/distutils/apiref.html#distutils.core.setup"><span
style='color:black'>take</span></a><u> </u><a
href="http://docs.python.org/3.1/distutils/apiref.html#distutils.core.setup"><span
style='color:black'>dozens</span></a><u> </u><a
href="http://docs.python.org/3.1/distutils/apiref.html#distutils.core.setup"><span
style='color:black'>of</span></a><u> </u><a
href="http://docs.python.org/3.1/distutils/apiref.html#distutils.core.setup"><span
style='color:black'>parameters</span></a>. For the sanity of everyone involved,
you must use <u>named arguments </u>for every parameter. This is not merely a
convention; it’s a hard requirement. Your setup script will crash if you try to
call the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>setup()
</span>function with non-named arguments.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.45pt;margin-left:16.4pt'>The following named arguments are required:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-12.25pt;line-height:107%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><b>name</b>, the
name of the package.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-12.25pt;line-height:107%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><b>version</b>,
the version number of the package.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-12.25pt;line-height:107%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><b>author</b>,
your full name.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-12.25pt;line-height:107%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><b>author_email</b>,
your email address.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.4pt;margin-left:16.65pt;text-indent:-12.25pt'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span><b>url</b>, the home page of your project. This can be your <a
href="http://pypi.python.org/"><span style='color:black'>PyPI</span></a><u> </u>package
page if you don’t have a separate project website.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.45pt;margin-left:16.4pt'>Although not required, I recommend that you also
include the following in your setup script:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.1pt;margin-left:16.65pt;text-indent:-12.25pt;line-height:107%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><b>description</b>,
a one-line summary of the project.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-12.25pt'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span><b>long_description</b>, a multi-line string in <a
href="http://docutils.sourceforge.net/rst.html"><span style='color:black'>reStructuredText</span></a><u>
</u><a href="http://docutils.sourceforge.net/rst.html"><span style='color:black'>format</span></a>.
<a href="http://pypi.python.org/"><span style='color:black'>PyPI</span></a><u> </u>converts
this to <span style='font-size:9.5pt;line-height:154%'>HTML </span>and displays
it on your package page.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-12.25pt;line-height:107%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><b>classifiers</b>,
a list of specially-formatted strings described in the next section.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
31.35pt;margin-left:47.15pt'><span style='font-size:24.0pt;line-height:154%;
font-family:"Calibri",sans-serif'>&#9758; </span>Setup script metadata is
defined in <a href="http://www.python.org/dev/peps/pep-0314/"><span
style='font-size:9.5pt;line-height:154%;color:black'>PEP</span></a><u><span
style='font-size:9.5pt;line-height:154%'> </span></u><a
href="http://www.python.org/dev/peps/pep-0314/"><span style='color:black'>314</span></a>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
18.95pt;margin-left:16.4pt'>Now let’s look at the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>chardet </span>setup script. It
has all of these required and recommended parameters, plus one I haven’t
mentioned yet: <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>packages</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:368.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>from distutils.core import
setup setup( name = 'chardet', <b><span style='background:gainsboro'>packages =
['chardet']</span></b>, version = '1.0.2',</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:272.45pt;margin-bottom:
0in;margin-left:62.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>description = 'Universal
encoding detector', author='Mark Pilgrim', ...</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.35pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>The <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>packages </span>parameter highlights an
unfortunate vocabulary overlap in the distribution process. We’ve been talking
about the “package” as the thing you’re building (and potentially listing in
The Python “Package”</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
45.65pt;margin-left:16.4pt'>Index). But that’s not what this <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>packages
</span>parameter refers to. It refers to the fact that the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>chardet
</span>module is <u>a multi-file module</u>, sometimes known as… a “package.”
The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>packages
</span>parameter tells Distutils to include the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>chardet/ </span>directory, its <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__init__.py
</span>file, and all the other <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>.py </span>files that constitute the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>chardet
</span>module. That’s kind of important; all this happy talk about
documentation and metadata is irrelevant if you forget to include the actual
code!</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:33.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h5 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>16.5.
C</span>LASSIFYING <span style='font-size:18.0pt;line-height:112%'>Y</span>OUR <span
style='font-size:18.0pt;line-height:112%'>P</span>ACKAGE</h5>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>The Python Package Index (“PyPI”) contains thousands
of Python libraries. Proper classification metadata will allow people to find
yours more easily. PyPI lets you <a
href="http://pypi.python.org/pypi?:action=browse"><span style='color:black'>browse</span></a><u>
</u><a href="http://pypi.python.org/pypi?:action=browse"><span
style='color:black'>packages</span></a><u> </u><a
href="http://pypi.python.org/pypi?:action=browse"><span style='color:black'>by</span></a><u>
</u><a href="http://pypi.python.org/pypi?:action=browse"><span
style='color:black'>classifier</span></a>. You can even select multiple
classifiers to narrow your search. Classifiers are not invisible metadata that
you can just ignore!</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.55pt;margin-left:16.4pt'>To classify your software, pass a <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>classifiers
</span>parameter to the Distutils <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>setup() </span>function. The <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>classifers
</span>parameter is a list of strings. These strings are <i>not </i>freeform.
All classifier strings should come from <a
href="http://pypi.python.org/pypi?:action=list_classifiers"><span
style='color:black'>this</span></a><u> </u><a
href="http://pypi.python.org/pypi?:action=list_classifiers"><span
style='color:black'>list </span></a><a
href="http://pypi.python.org/pypi?:action=list_classifiers"><span
style='color:black'>on</span></a><u> </u><a
href="http://pypi.python.org/pypi?:action=list_classifiers"><span
style='color:black'>PyPI</span></a>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.4pt;line-height:107%'>Classifiers are optional. You can
write a Distutils setup script without any classifiers at all. <b>Don’t do
that.</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
22.45pt;margin-left:16.4pt'>You should <i>always </i>include at least these
classifiers:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.1in;margin-left:16.65pt;text-indent:-12.25pt;line-height:107%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><b>Programming
Language</b>. In particular, you should include both <span style='font-size:
10.0pt;line-height:107%;font-family:"Liberation Mono"'>&quot;Programming
Language :: Python&quot; </span>and</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'><span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>&quot;Programming Language :: Python :: 3&quot;</span>.
If you do not include these, your package will not show up in <a
href="http://pypi.python.org/pypi?:action=browse&amp;c=533&amp;show=all"><span
style='color:black'>this</span></a><u> </u><a
href="http://pypi.python.org/pypi?:action=browse&amp;c=533&amp;show=all"><span
style='color:black'>list</span></a><u> </u><a
href="http://pypi.python.org/pypi?:action=browse&amp;c=533&amp;show=all"><span
style='color:black'>of</span></a><u> </u><a
href="http://pypi.python.org/pypi?:action=browse&amp;c=533&amp;show=all"><span
style='color:black'>Python</span></a><u> </u><a
href="http://pypi.python.org/pypi?:action=browse&amp;c=533&amp;show=all"><span
style='color:black'>3-compatible</span></a><u> </u><a
href="http://pypi.python.org/pypi?:action=browse&amp;c=533&amp;show=all"><span
style='color:black'>libraries</span></a>, which linked from the sidebar of
every single page of <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>pypi.python.org</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-12.25pt'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span><b>License</b>. This is <i>the absolute first thing I look for </i>when
I’m evaluating third-party libraries. Don’t make me hunt for this vital
information. Don’t include more than one license classifier unless your
software is explicitly available under multiple licenses. (And don’t release
software under multiple licenses unless you’re forced to do so. And don’t force
other people to do so. Licensing is enough of a headache; don’t make it worse.)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
15.3pt;margin-left:16.65pt;text-indent:-12.25pt;line-height:190%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><b>Operating
System</b>. If your software only runs on Windows (or Mac OS X, or Linux), I
want to know sooner rather than later. If your software runs anywhere without
any platform-specific code, use the classifier <span style='font-size:10.0pt;
line-height:190%;font-family:"Liberation Mono"'>&quot;Operating System :: OS
Independent&quot;</span>. Multiple <span style='font-size:10.0pt;line-height:
190%;font-family:"Liberation Mono"'>Operating System </span>classifiers are
only necessary if your software requires specific support for each platform.
(This is not common.) I also recommend that you include the following
classifiers:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.35pt;margin-left:16.65pt;text-indent:-12.25pt;line-height:107%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><b>Development
Status</b>. Is your software beta quality? Alpha quality? Pre-alpha? Pick one.
Be honest.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
8.65pt;margin-left:16.65pt;text-indent:-12.25pt;line-height:107%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><b>Intended
Audience</b>. Who would download your software? The most common choices are <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>Developers</span>,</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.6pt;
margin-left:17.15pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>End Users/Desktop</span>, <span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>Science/Research</span>,
and <span style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>System
Administrators</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-12.25pt'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span><b>Framework</b>. If your software is a plugin for a larger Python
framework like <a href="http://www.djangoproject.com/"><span style='color:black'>Django</span></a><u>
</u>or <a href="http://www.zope.org/"><span style='color:black'>Zope</span></a>,
include the appropriate <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>Framework </span>classifier. If not, omit it.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
28.4pt;margin-left:16.65pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><b>Topic</b>.
There are <a href="http://pypi.python.org/pypi?:action=list_classifiers"><span
style='color:black'>a</span></a><u> </u><a
href="http://pypi.python.org/pypi?:action=list_classifiers"><span
style='color:black'>large</span></a><u> </u><a
href="http://pypi.python.org/pypi?:action=list_classifiers"><span
style='color:black'>number</span></a><u> </u><a
href="http://pypi.python.org/pypi?:action=list_classifiers"><span
style='color:black'>of</span></a><u> </u><a
href="http://pypi.python.org/pypi?:action=list_classifiers"><span
style='color:black'>topics</span></a><u> </u><a
href="http://pypi.python.org/pypi?:action=list_classifiers"><span
style='color:black'>to</span></a><u> </u><a
href="http://pypi.python.org/pypi?:action=list_classifiers"><span
style='color:black'>choose</span></a><u> </u><a
href="http://pypi.python.org/pypi?:action=list_classifiers"><span
style='color:black'>from</span></a>; choose all that apply.</p>

<h6 style='margin-left:16.4pt'><span style='font-size:13.0pt;line-height:110%'>16.5.1.
E</span>XAMPLES OF <span style='font-size:13.0pt;line-height:110%'>G</span>OOD <span
style='font-size:13.0pt;line-height:110%'>P</span>ACKAGE <span
style='font-size:13.0pt;line-height:110%'>C</span>LASSIFIERS</h6>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
1.4pt;margin-left:16.4pt'>By way of example, here are the classifiers for <a
href="http://pypi.python.org/pypi/Django/"><span style='color:black'>Django</span></a>,
a production-ready, cross-platform, <span style='font-size:9.5pt;line-height:
154%'>BSD</span>-licensed web application framework that runs on your web
server. (Django is not yet compatible with Python 3, so the</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:17.15pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>Programming Language :: Python :: 3 </span>classifier
is not listed.)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>Programming Language :: Python</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:302.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>License :: OSI Approved :: BSD
License Operating System :: OS Independent Development Status :: 5 -
Production/Stable Environment :: Web Environment Framework :: Django</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>Intended Audience :: Developers</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:272.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>Topic :: Internet :: WWW/HTTP
Topic :: Internet :: WWW/HTTP :: Dynamic Content</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>Topic :: Internet :: WWW/HTTP :: WSGI</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.3pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>Topic :: Software Development :: Libraries
:: Python Modules</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.0pt;margin-left:16.4pt'>Here are the classifiers for <a
href="http://pypi.python.org/pypi/chardet"><span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono";color:black'>chardet</span></a>,
the character encoding detection library covered in <u>Case Study: Porting </u><u><span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>chardet
</span>to Python 3</u>. <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>chardet </span>is beta quality, cross-platform,
Python 3-compatible, <span style='font-size:9.5pt;line-height:154%'>LGPL</span>-licensed,
and intended for developers to integrate into their own products.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>Programming Language :: Python</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:92.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>Programming Language :: Python
:: 3 License :: OSI Approved :: GNU Library or Lesser General Public License
(LGPL)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:290.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>Operating System :: OS
Independent Development Status :: 4 - Beta</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:320.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>Environment :: Other
Environment Intended Audience :: Developers</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>Topic :: Text Processing :: Linguistic</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.5pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>Topic :: Software Development :: Libraries
:: Python Modules</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>And here are the classifiers for <a
href="http://pypi.python.org/pypi/httplib2"><span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono";color:black'>httplib2</span></a>,
the <span style='font-size:9.5pt;line-height:154%'>HTTP </span>module I
mentioned at the beginning of this chapter. <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>httplib2 </span>is beta
quality, cross-platform, <span style='font-size:9.5pt;line-height:154%'>MIT</span>-licensed,
and intended for Python developers.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>Programming Language :: Python</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>Programming Language :: Python :: 3</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>License :: OSI Approved :: MIT License</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:314.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>Operating System :: OS
Independent Development Status :: 4 - Beta Environment :: Web Environment</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>Intended Audience :: Developers</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>Topic :: Internet :: WWW/HTTP</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:35.5pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>Topic :: Software Development :: Libraries
:: Python Modules</span></p>

<h5 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>16.6.
S</span>PECIFYING <span style='font-size:18.0pt;line-height:112%'>A</span>DDITIONAL
<span style='font-size:18.0pt;line-height:112%'>F</span>ILES <span
style='font-size:18.0pt;line-height:112%'>W</span>ITH <span style='font-size:
18.0pt;line-height:112%'>A M</span>ANIFEST</h5>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
24.05pt;margin-left:16.4pt'>By default, Distutils will include the following
files in your release package:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:15.25pt;margin-bottom:
8.25pt;margin-left:16.65pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>README.txt</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:15.25pt;margin-bottom:
6.1pt;margin-left:16.65pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>setup.py</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:15.25pt;margin-bottom:
6.85pt;margin-left:16.65pt;text-indent:-12.25pt;line-height:107%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>.py </span>files
needed by the multi-file modules listed in the <span style='font-size:10.0pt;
line-height:107%;font-family:"Liberation Mono"'>packages </span>parameter</p>

<p class=MsoNormal style='margin-top:0in;margin-right:15.25pt;margin-bottom:
22.0pt;margin-left:16.65pt;text-indent:-12.25pt'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The individual <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>.py </span>files listed in the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>py_modules
</span>parameter</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.25pt;margin-left:16.4pt'>That will cover <u>all the files in the </u><u><span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>httplib2
</span>project</u>. But for the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>chardet </span>project, we also want to include
the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>COPYING.txt
</span>license file and the entire <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>docs/ </span>directory that contains images
and <span style='font-size:9.5pt;line-height:154%'>HTML </span>files. To tell
Distutils to include these additional files and directories when it builds the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>chardet
</span>release package, you need a <i>manifest file</i>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.05pt;margin-left:16.4pt'>A manifest file is a text file called <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>MANIFEST.in</span>.
Place it in the project’s root directory, next to <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>README.txt </span>and <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>setup.py</span>.
Manifest files are <i>not </i>Python scripts; they are text files that contain
a series of “commands” in a Distutils-defined format. Manifest commands allow
you to include or exclude specific files and directories.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
24.0pt;margin-left:16.4pt'>This is the entire manifest file for the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>chardet
</span>project:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:141.65pt;margin-bottom:
18.75pt;margin-left:37.9pt;line-height:180%'><span style='font-size:10.0pt;
line-height:180%;font-family:"Liberation Mono"'>include COPYING.txt     </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312; </span><span
style='font-size:10.0pt;line-height:180%;font-family:"Liberation Mono"'>recursive-include
docs *.html *.css *.png *.gif </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The first line
is self-explanatory: include the <span style='font-size:10.0pt;line-height:
107%;font-family:"Liberation Mono"'>COPYING.txt </span>file from the project’s
root directory.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.55pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The second line is a bit more complicated. The <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>recursive-include </span>command
takes a directory name and one or more filenames. The filenames aren’t limited
to specific files; they can include wildcards. This line means “See that <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>docs/ </span>directory
in the project’s root directory? Look in there (recursively) for <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>.html</span>,
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>.css</span>,
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>.png</span>,
and <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>.gif
</span>files. I want all of them in my release package.”</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
46.9pt;margin-left:16.4pt'>All manifest commands preserve the directory
structure that you set up in your project directory. That <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>recursive-include
</span>command is not going to put a bunch of <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>.html </span>and <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>.png </span>files
in the root directory of the release package. It’s going to maintain the
existing <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>docs/
</span>directory structure, but only include those files inside that directory
that match the given wildcards. (I didn’t mention it earlier, but the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>chardet
</span>documentation is actually written in <span style='font-size:9.5pt;
line-height:154%'>XML </span>and converted to <span style='font-size:9.5pt;
line-height:154%'>HTML </span>by a separate script. I don’t want to include the
<span style='font-size:9.5pt;line-height:154%'>XML </span>files in the release
package, just the <span style='font-size:9.5pt;line-height:154%'>HTML </span>and
the images.)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:81.85pt;margin-bottom:
36.55pt;margin-left:75.95pt;text-indent:-29.3pt;line-height:189%'><span
style='font-size:24.0pt;line-height:189%;font-family:"Calibri",sans-serif'>&#9758;
</span>Manifest files have their own unique format. See <a
href="http://docs.python.org/3.1/distutils/sourcedist.html#manifest"><span
style='color:black'>Specifying</span></a><u> </u><a
href="http://docs.python.org/3.1/distutils/sourcedist.html#manifest"><span
style='color:black'>the</span></a><u> </u><a
href="http://docs.python.org/3.1/distutils/sourcedist.html#manifest"><span
style='color:black'>files</span></a><u> </u><a
href="http://docs.python.org/3.1/distutils/sourcedist.html#manifest"><span
style='color:black'>to</span></a><u> </u><a
href="http://docs.python.org/3.1/distutils/sourcedist.html#manifest"><span
style='color:black'>distribute</span></a><u> </u>and <a
href="http://docs.python.org/3.1/distutils/commandref.html#sdist-cmd"><span
style='color:black'>the</span></a><u> </u><a
href="http://docs.python.org/3.1/distutils/commandref.html#sdist-cmd"><span
style='color:black'>manifest</span></a><u> </u><a
href="http://docs.python.org/3.1/distutils/commandref.html#sdist-cmd"><span
style='color:black'>template</span></a><u> </u><a
href="http://docs.python.org/3.1/distutils/commandref.html#sdist-cmd"><span
style='color:black'>commands</span></a><u> </u>for details.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
25.15pt;margin-left:16.4pt'>To reiterate: you only need to create a manifest
file if you want to include files that Distutils doesn’t include by default. If
you do need a manifest file, it should only include the files and directories
that Distutils wouldn’t otherwise find on its own.</p>

<h5 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>16.7.
C</span>HECKING <span style='font-size:18.0pt;line-height:112%'>Y</span>OUR <span
style='font-size:18.0pt;line-height:112%'>S</span>ETUP <span style='font-size:
18.0pt;line-height:112%'>S</span>CRIPT FOR <span style='font-size:18.0pt;
line-height:112%'>E</span>RRORS</h5>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.0pt;margin-left:16.4pt'>There’s a lot to keep track of. Distutils comes with
a built-in validation command that checks that all the required metadata is
present in your setup script. For example, if you forget to include the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>version
</span>parameter, Distutils will remind you.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:140.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>c:\Users\pilgrim\chardet&gt;
</span><span style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>c:\python31\python.exe
setup.py check running check</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.5pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>warning: check: missing required meta-data:
version</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>Once you include a <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>version </span>parameter (and
all the other required bits of metadata), the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>check </span>command will look
like this:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:140.45pt;margin-bottom:
47.65pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>c:\Users\pilgrim\chardet&gt;
</span><span style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>c:\python31\python.exe
setup.py check running check</span></p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:33.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h5 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>16.8.
C</span>REATING A <span style='font-size:18.0pt;line-height:112%'>S</span>OURCE
<span style='font-size:18.0pt;line-height:112%'>D</span>ISTRIBUTION</h5>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>Distutils supports building multiple types of release
packages. At a minimum, you should build a “source distribution” that contains
your source code, your Distutils setup script, your “read me” file, and
whatever <u>additional files you want to include</u>. To build a source
distribution, pass the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>sdist </span>command to your Distutils setup
script.<br clear=all style='page-break-before:always'>
</p>

<p class=MsoNormal style='margin-top:0in;margin-right:181.7pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>c:\Users\pilgrim\chardet&gt;
</span><b><span style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
background:gainsboro'>c:\python31\python.exe setup.py sdist </span></b><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>running
sdist running check</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:326.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>reading manifest template
'MANIFEST.in' writing manifest file 'MANIFEST' creating chardet-1.0.2 creating
chardet-1.0.2\chardet creating chardet-1.0.2\docs creating
chardet-1.0.2\docs\images copying files to chardet-1.0.2... copying COPYING
-&gt; chardet-1.0.2 copying README.txt -&gt; chardet-1.0.2 copying setup.py
-&gt; chardet-1.0.2</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:188.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>copying chardet\__init__.py
-&gt; chardet-1.0.2\chardet copying chardet\big5freq.py -&gt;
chardet-1.0.2\chardet ... copying chardet\universaldetector.py -&gt;
chardet-1.0.2\chardet copying chardet\utf8prober.py -&gt; chardet-1.0.2\chardet
copying docs\faq.html -&gt; chardet-1.0.2\docs copying docs\history.html -&gt;
chardet-1.0.2\docs copying docs\how-it-works.html -&gt; chardet-1.0.2\docs
copying docs\index.html -&gt; chardet-1.0.2\docs copying docs\license.html
-&gt; chardet-1.0.2\docs copying docs\supported-encodings.html -&gt; chardet-1.0.2\docs
copying docs\usage.html -&gt; chardet-1.0.2\docs copying
docs\images\caution.png -&gt; chardet-1.0.2\docs\images copying
docs\images\important.png -&gt; chardet-1.0.2\docs\images copying
docs\images\note.png -&gt; chardet-1.0.2\docs\images copying
docs\images\permalink.gif -&gt; chardet-1.0.2\docs\images copying
docs\images\tip.png -&gt; chardet-1.0.2\docs\images copying
docs\images\warning.png -&gt; chardet-1.0.2\docs\images creating dist</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:128.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>creating
'dist\chardet-1.0.2.zip' and adding 'chardet-1.0.2' to it adding
'chardet-1.0.2\COPYING'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:254.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>adding 'chardet-1.0.2\PKG-INFO'
adding 'chardet-1.0.2\README.txt' adding 'chardet-1.0.2\setup.py' adding
'chardet-1.0.2\chardet\big5freq.py' adding
'chardet-1.0.2\chardet\big5prober.py' ... adding
'chardet-1.0.2\chardet\universaldetector.py' adding 'chardet-1.0.2\chardet\utf8prober.py'
adding 'chardet-1.0.2\chardet\__init__.py' adding 'chardet-1.0.2\docs\faq.html'
adding 'chardet-1.0.2\docs\history.html' adding
'chardet-1.0.2\docs\how-it-works.html' adding 'chardet-1.0.2\docs\index.html'
adding 'chardet-1.0.2\docs\license.html'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:248.45pt;margin-bottom:
22.55pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>adding
'chardet-1.0.2\docs\supported-encodings.html' adding
'chardet-1.0.2\docs\usage.html' adding 'chardet-1.0.2\docs\images\caution.png'
adding 'chardet-1.0.2\docs\images\important.png' adding
'chardet-1.0.2\docs\images\note.png' adding 'chardet-1.0.2\docs\images\permalink.gif'
adding 'chardet-1.0.2\docs\images\tip.png' adding
'chardet-1.0.2\docs\images\warning.png' removing 'chardet-1.0.2' (and
everything under it)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
22.25pt;margin-left:16.4pt'>Several things to note here:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.4pt;margin-left:16.65pt;text-indent:-12.25pt;line-height:107%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Distutils
noticed the manifest file (<span style='font-size:10.0pt;line-height:107%;
font-family:"Liberation Mono"'>MANIFEST.in</span>).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-12.25pt'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Distutils successfully parsed the manifest file and added the additional
files we wanted — <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>COPYING.txt </span>and the <span style='font-size:9.5pt;
line-height:154%'>HTML </span>and image files in the <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>docs/ </span>directory.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-12.25pt'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>If you look in your project directory, you’ll see that Distutils created
a <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>dist/
</span>directory. Within the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>dist/ </span>directory the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>.zip </span>file
that you can distribute.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:320.45pt;margin-bottom:
0in;margin-left:43.4pt;text-indent:-6.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
color:#666677'>c:\Users\pilgrim\chardet&gt; </span><b><span style='font-size:
10.0pt;line-height:185%;font-family:"Liberation Mono";background:gainsboro'>dir
dist </span></b><span style='font-size:10.0pt;line-height:185%;font-family:
"Liberation Mono"'>Volume in drive C has no label.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>Volume Serial Number is DED5-B4F8</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>Directory of c:\Users\pilgrim\chardet\dist</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>07/30/2009  06:29 PM   
&lt;DIR&gt;          .</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>07/30/2009  06:29 PM   
&lt;DIR&gt;          ..</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>07/30/2009  06:29 PM           206,440 <b><span
style='background:gainsboro'>chardet-1.0.2.zip</span></b></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:140.2pt;text-indent:-12.0pt;line-height:110%'><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>1<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>File(s)       
206,440 bytes</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:56.15pt;
margin-left:140.2pt;text-indent:-12.0pt;line-height:110%'><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>2<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>Dir(s) 
61,424,635,904 bytes free</span></p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:33.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h5 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>16.9.
C</span>REATING A <span style='font-size:18.0pt;line-height:112%'>G</span>RAPHICAL
<span style='font-size:18.0pt;line-height:112%'>I</span>NSTALLER</h5>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.05pt;margin-left:16.4pt'>In my opinion, every Python library deserves a
graphical installer for Windows users. It’s easy to make (even if you don’t run
Windows yourself), and Windows users appreciate it.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>Distutils can <a
href="http://docs.python.org/3.1/distutils/builtdist.html#creating-windows-installers"><span
style='color:black'>create</span></a><u> </u><a
href="http://docs.python.org/3.1/distutils/builtdist.html#creating-windows-installers"><span
style='color:black'>a</span></a><u> </u><a
href="http://docs.python.org/3.1/distutils/builtdist.html#creating-windows-installers"><span
style='color:black'>graphical</span></a><u> </u><a
href="http://docs.python.org/3.1/distutils/builtdist.html#creating-windows-installers"><span
style='color:black'>Windows</span></a><u> </u><a
href="http://docs.python.org/3.1/distutils/builtdist.html#creating-windows-installers"><span
style='color:black'>installer</span></a><u> </u><a
href="http://docs.python.org/3.1/distutils/builtdist.html#creating-windows-installers"><span
style='color:black'>for</span></a><u> </u><a
href="http://docs.python.org/3.1/distutils/builtdist.html#creating-windows-installers"><span
style='color:black'>you</span></a>, by passing the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>bdist_wininst </span>command to
your Distutils setup script.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:134.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>c:\Users\pilgrim\chardet&gt;
</span><b><span style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
background:gainsboro'>c:\python31\python.exe setup.py bdist_wininst </span></b><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>running
bdist_wininst running build running build_py creating build creating build\lib
creating build\lib\chardet</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:218.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>copying chardet\big5freq.py
-&gt; build\lib\chardet copying chardet\big5prober.py -&gt; build\lib\chardet
... copying chardet\universaldetector.py -&gt; build\lib\chardet copying
chardet\utf8prober.py -&gt; build\lib\chardet copying chardet\__init__.py -&gt;
build\lib\chardet installing to build\bdist.win32\wininst running install_lib
creating build\bdist.win32 creating build\bdist.win32\wininst creating
build\bdist.win32\wininst\PURELIB creating
build\bdist.win32\wininst\PURELIB\chardet</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:14.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>copying
build\lib\chardet\big5freq.py -&gt; build\bdist.win32\wininst\PURELIB\chardet
copying build\lib\chardet\big5prober.py -&gt;
build\bdist.win32\wininst\PURELIB\chardet ... copying
build\lib\chardet\universaldetector.py -&gt; build\bdist.win32\wininst\PURELIB\chardet
copying build\lib\chardet\utf8prober.py -&gt;
build\bdist.win32\wininst\PURELIB\chardet copying build\lib\chardet\__init__.py
-&gt; build\bdist.win32\wininst\PURELIB\chardet running install_egg_info
Writing build\bdist.win32\wininst\PURELIB\chardet-1.0.2-py3.1.egg-info creating
'c:\users\pilgrim\appdata\local\temp\tmp2f4h7e.zip' and adding '.' to it adding
'PURELIB\chardet-1.0.2-py3.1.egg-info' adding 'PURELIB\chardet\big5freq.py'
adding 'PURELIB\chardet\big5prober.py' ...</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:254.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>adding
'PURELIB\chardet\universaldetector.py' adding 'PURELIB\chardet\utf8prober.py'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>adding 'PURELIB\chardet\__init__.py'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:188.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>removing
'build\bdist.win32\wininst' (and everything under it) </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
color:#666677'>c:\Users\pilgrim\chardet&gt; </span><b><span style='font-size:
10.0pt;line-height:185%;font-family:"Liberation Mono";background:gainsboro'>dir
dist </span></b><span style='font-size:10.0pt;line-height:185%;font-family:
"Liberation Mono"'>c:\Users\pilgrim\chardet&gt;dir dist</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>Volume in drive C has no label.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>Volume Serial Number is AADE-E29F</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:44.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>Directory of c:\Users\pilgrim\chardet\dist</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>07/30/2009  10:14 PM   
&lt;DIR&gt;          .</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>07/30/2009  10:14 PM   
&lt;DIR&gt;          ..</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:188.4pt;margin-bottom:
.3pt;margin-left:38.65pt;text-align:justify;text-justify:inter-ideograph;
line-height:182%'><span style='font-size:10.0pt;line-height:182%;font-family:
"Liberation Mono"'>07/30/2009  10:14 PM           371,236 <b><span
style='background:gainsboro'>chardet-1.0.2.win32.exe </span></b>07/30/2009 
06:29 PM           206,440 chardet-1.0.2.zip 2 File(s)        577,676 bytes</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:32.15pt;
margin-left:128.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>2 Dir(s)  61,424,070,656 bytes free</span></p>

<h6 style='margin-left:16.4pt'><span style='font-size:13.0pt;line-height:110%'>16.9.1.
B</span>UILDING <span style='font-size:13.0pt;line-height:110%'>I</span>NSTALLABLE
<span style='font-size:13.0pt;line-height:110%'>P</span>ACKAGES FOR <span
style='font-size:13.0pt;line-height:110%'>O</span>THER <span style='font-size:
13.0pt;line-height:110%'>O</span>PERATING <span style='font-size:13.0pt;
line-height:110%'>S</span>YSTEMS</h6>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.8pt;margin-left:16.4pt'>Distutils can help you <a
href="http://docs.python.org/3.1/distutils/builtdist.html#creating-rpm-packages"><span
style='color:black'>build</span></a><u> </u><a
href="http://docs.python.org/3.1/distutils/builtdist.html#creating-rpm-packages"><span
style='color:black'>installable</span></a><u> </u><a
href="http://docs.python.org/3.1/distutils/builtdist.html#creating-rpm-packages"><span
style='color:black'>packages</span></a><u> </u><a
href="http://docs.python.org/3.1/distutils/builtdist.html#creating-rpm-packages"><span
style='color:black'>for</span></a><u> </u><a
href="http://docs.python.org/3.1/distutils/builtdist.html#creating-rpm-packages"><span
style='color:black'>Linux</span></a><u> </u><a
href="http://docs.python.org/3.1/distutils/builtdist.html#creating-rpm-packages"><span
style='color:black'>users</span></a>. In my opinion, this probably isn’t worth
your time. If you want your software distributed for Linux, your time would be
better spent working with community members who specialize in packaging
software for major Linux distributions.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.55pt;margin-left:16.4pt'>For example, my <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>chardet </span>library is <a
href="http://packages.debian.org/python-chardet"><span style='color:black'>in</span></a><u>
</u><a href="http://packages.debian.org/python-chardet"><span style='color:
black'>the</span></a><u> </u><a href="http://packages.debian.org/python-chardet"><span
style='color:black'>Debian</span></a><u> </u><a
href="http://packages.debian.org/python-chardet"><span style='color:black'>GNU/Linux</span></a><u>
</u><a href="http://packages.debian.org/python-chardet"><span style='color:
black'>repositories</span></a><u> </u>(and therefore <a
href="http://packages.ubuntu.com/python-chardet"><span style='color:black'>in</span></a><u>
</u><a href="http://packages.ubuntu.com/python-chardet"><span style='color:
black'>the</span></a><u> </u><a href="http://packages.ubuntu.com/python-chardet"><span
style='color:black'>Ubuntu </span></a><a
href="http://packages.ubuntu.com/python-chardet"><span style='color:black'>repositories</span></a><u>
</u>as well). I had nothing to do with this; the packages just showed up there
one day. The Debian community has <a
href="http://www.debian.org/doc/packaging-manuals/python-policy/"><span
style='color:black'>their</span></a><u> </u><a
href="http://www.debian.org/doc/packaging-manuals/python-policy/"><span
style='color:black'>own</span></a><u> </u><a
href="http://www.debian.org/doc/packaging-manuals/python-policy/"><span
style='color:black'>policies</span></a><u> </u><a
href="http://www.debian.org/doc/packaging-manuals/python-policy/"><span
style='color:black'>for</span></a><u> </u><a
href="http://www.debian.org/doc/packaging-manuals/python-policy/"><span
style='color:black'>packaging</span></a><u> </u><a
href="http://www.debian.org/doc/packaging-manuals/python-policy/"><span
style='color:black'>Python</span></a><u> </u><a
href="http://www.debian.org/doc/packaging-manuals/python-policy/"><span
style='color:black'>libraries</span></a>, and the Debian <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>python-chardet
</span>package is designed to follow these conventions. And since the package
lives in Debian’s repositories, Debian users will receive security updates
and/or new versions, depending on the system-wide settings they’ve chosen to
manage their own computers.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
46.55pt;margin-left:16.4pt'>The Linux packages that Distutils builds offer none
of these advantages. Your time is better spent elsewhere.</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:33.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h5 style='margin-top:0in;margin-right:16.7pt;margin-bottom:17.35pt;margin-left:
16.4pt'><span style='font-size:18.0pt;line-height:112%'>16.10. A</span>DDING <span
style='font-size:18.0pt;line-height:112%'>Y</span>OUR <span style='font-size:
18.0pt;line-height:112%'>S</span>OFTWARE TO <span style='font-size:18.0pt;
line-height:112%'>T</span>HE <span style='font-size:18.0pt;line-height:112%'>P</span>YTHON
<span style='font-size:18.0pt;line-height:112%'>P</span>ACKAGE <span
style='font-size:18.0pt;line-height:112%'>I</span>NDEX</h5>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.45pt;margin-left:16.4pt'>Uploading software to the Python Package Index is a
three step process.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Register
yourself</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
7.3pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Register your
software</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.4pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Upload the packages you created with <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>setup.py sdist </span>and <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>setup.py
bdist_*</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:33.6pt;margin-bottom:
20.55pt;margin-left:16.4pt'>To register yourself, go to <a
href="http://pypi.python.org/pypi?:action=register_form"><span
style='color:black'>the</span></a><u> </u><a
href="http://pypi.python.org/pypi?:action=register_form"><span
style='color:black'>PyPI</span></a><u> </u><a
href="http://pypi.python.org/pypi?:action=register_form"><span
style='color:black'>user</span></a><u> </u><a
href="http://pypi.python.org/pypi?:action=register_form"><span
style='color:black'>registration</span></a><u> </u><a
href="http://pypi.python.org/pypi?:action=register_form"><span
style='color:black'>page</span></a>. Enter your desired username and password,
provide a valid email address, and click the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>Register </span>button. (If you
have a <span style='font-size:9.5pt;line-height:154%'>PGP </span>or <span
style='font-size:9.5pt;line-height:154%'>GPG </span>key, you can also provide
that. If you don’t have one or don’t know what that means, don’t worry about
it.) Check your email; within a few minutes, you should receive a message from
PyPI with a validation link. Click the link to complete the registration
process.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>Now you need to register your
software with PyPI and upload it. You can do this all in one step.<br
clear=all style='page-break-before:always'>
</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;line-height:
185%;font-family:"Liberation Mono";color:#666677'>c:\Users\pilgrim\chardet&gt; </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>c:\python31\python.exe
setup.py register sdist bdist_wininst upload running register We need to know
who you are, so please choose either:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.15pt;text-indent:-.25in;line-height:110%'><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>use
your existing login,</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.15pt;text-indent:-.25in;line-height:110%'><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>register
as a new user,</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.15pt;text-indent:-.25in;line-height:110%'><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>have
the server generate a new password for you (and email it to you), or</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:10.0pt;
margin-left:62.15pt;text-indent:-.25in;line-height:110%'><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp; </span></span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>quit</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.95in;margin-bottom:
10.0pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#666677'>Your selection
[default 1]: </span><span style='font-size:10.0pt;line-height:110%;font-family:
"Liberation Mono"'>1</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:380.45pt;margin-bottom:
1.5pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono";color:#666677'>Username: </span><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>MarkPilgrim
</span><span style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono";
color:#666677'>Password:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:260.45pt;margin-bottom:
1.0pt;margin-left:37.9pt;line-height:189%'><span style='font-size:10.0pt;
line-height:189%;font-family:"Liberation Mono"'>Registering chardet to
http://pypi.python.org/pypi Server response (200): OK running sdist ... output
trimmed for brevity ...</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:176.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:189%'><span style='font-size:10.0pt;
line-height:189%;font-family:"Liberation Mono"'>running bdist_wininst ...
output trimmed for brevity ... running upload Submitting dist\chardet-1.0.2.zip
to http://pypi.python.org/pypi</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:140.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>Server response (200): OK
Submitting dist\chardet-1.0.2.win32.exe to http://pypi.python.org/pypi</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:170.45pt;margin-bottom:
1.5pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>Server response (200): OK I can
store your PyPI login so future submissions will be faster. (the login will be
stored in c:\home\.pypirc)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.95in;margin-bottom:
31.05pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#666677'>Save your login
(y/N)?</span><span style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>n</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>When you release your project for the first time, Distutils will add
your software to the Python Package Index and give it its own <span
style='font-size:9.5pt;line-height:154%'>URL</span>. Every time after that, it
will simply update the project metadata with any changes you may have made in
your <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>setup.py
</span>parameters. Next, it builds a source distribution (<span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>sdist</span>)
and a Windows installer (<span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>bdist_wininst</span>), then uploads them to PyPI
(<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>upload</span>).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
7.55pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Type <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>1 </span>or
just press <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>ENTER
</span>to select “use your existing login.”</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
2.15pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Enter the username and password you selected on the <a
href="http://pypi.python.org/pypi?:action=register_form"><span
style='color:black'>the</span></a><u> </u><a
href="http://pypi.python.org/pypi?:action=register_form"><span
style='color:black'>PyPI</span></a><u> </u><a
href="http://pypi.python.org/pypi?:action=register_form"><span
style='color:black'>user</span></a><u> </u><a
href="http://pypi.python.org/pypi?:action=register_form"><span
style='color:black'>registration</span></a><u> </u><a
href="http://pypi.python.org/pypi?:action=register_form"><span
style='color:black'>page</span></a>. Distuils will not echo your password; it
will not even echo asterisks in place of characters. Just type your password
and press</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:7.15pt;
margin-left:17.15pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>ENTER</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Distutils
registers your package with the Python Package Index…</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>5.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>…builds your
source distribution…</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>6.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>…builds your
Windows installer…</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>7.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>…and uploads
them both to the Python Package Index.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.55pt;margin-left:16.65pt;text-indent:-16.65pt'>8.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>If you want to automate the process of releasing new versions, you need
to save your PyPI credentials in a local file. This is completely insecure and
completely optional.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.5pt;margin-left:16.4pt'>Congratulations, you now have your own page on the
Python Package Index! The address is <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>http://pypi.python.org/pypi/<i>NAME</i></span>,
where <i>NAME </i>is the string you passed in the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>name </span>parameter in your <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>setup.py
</span>file.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.0pt;margin-left:16.4pt'>If you want to release a new version, just update
your <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>setup.py
</span>with the new version number, then run the same upload command again:</p>

<p class=MsoNormal align=right style='margin-top:0in;margin-right:-.75pt;
margin-bottom:56.15pt;margin-left:.5pt;text-align:right;line-height:110%'><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>c:\Users\pilgrim\chardet&gt; </span><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono"'>c:\python31\python.exe setup.py
register sdist bdist_wininst upload</span></p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:33.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h5 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>16.11.
T</span>HE <span style='font-size:18.0pt;line-height:112%'>M</span>ANY <span
style='font-size:18.0pt;line-height:112%'>P</span>OSSIBLE <span
style='font-size:18.0pt;line-height:112%'>F</span>UTURES OF <span
style='font-size:18.0pt;line-height:112%'>P</span>YTHON <span style='font-size:
18.0pt;line-height:112%'>P</span>ACKAGING</h5>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.55pt;margin-left:16.4pt'>Distutils is not the be-all and end-all of Python
packaging, but as of this writing (August 2009), it’s the only packaging
framework that works in Python 3. There are a number of other frameworks for
Python 2; some focus on installation, others on testing and deployment. Some or
all of these may end up being ported to Python 3 in the future.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.45pt;margin-left:16.4pt'>These frameworks focus on installation:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://pypi.python.org/pypi/setuptools"><span style='color:black'>Setuptools</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://pypi.python.org/pypi/pip"><span style='color:black'>Pip</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:26.7pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://bitbucket.org/tarek/distribute/"><span style='color:black'>Distribute</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>These focus on testing and
deployment:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://pypi.python.org/pypi/virtualenv"><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:black'>virtualenv</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.55pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://pypi.python.org/pypi/zc.buildout"><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:black'>zc.buildout</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://www.blueskyonmars.com/projects/paver/"><span style='color:black'>Paver</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.2pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://fabfile.org/"><span style='color:black'>Fabric</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:51.7pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://www.py2exe.org/"><span style='font-size:10.0pt;line-height:110%;
font-family:"Liberation Mono";color:black'>py2exe</span></a></p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:33.45pt;
margin-bottom:33.15pt;margin-left:20.55pt;text-align:center;line-height:107%'><span
style='font-size:24.0pt;line-height:107%;font-family:"DejaVu Sans",sans-serif;
color:#82B445'>&#8258;</span></p>

<h5 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>16.12.
F</span>URTHER <span style='font-size:18.0pt;line-height:112%'>R</span>EADING</h5>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.45pt;margin-left:16.4pt'>On Distutils:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://docs.python.org/3.1/distutils/"><span style='color:black'>Distributing</span></a><u>
</u><a href="http://docs.python.org/3.1/distutils/"><span style='color:black'>Python</span></a><u>
</u><a href="http://docs.python.org/3.1/distutils/"><span style='color:black'>Modules</span></a><u>
</u><a href="http://docs.python.org/3.1/distutils/"><span style='color:black'>with</span></a><u>
</u><a href="http://docs.python.org/3.1/distutils/"><span style='color:black'>Distutils</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.05pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:107%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://docs.python.org/3.1/distutils/apiref.html#module-distutils.core"><span
style='color:black'>Core</span></a><u> </u><a
href="http://docs.python.org/3.1/distutils/apiref.html#module-distutils.core"><span
style='color:black'>Distutils</span></a><u> </u><a
href="http://docs.python.org/3.1/distutils/apiref.html#module-distutils.core"><span
style='color:black'>functionality</span></a><u> </u>lists all the possible
arguments to the <span style='font-size:10.0pt;line-height:107%;font-family:
"Liberation Mono"'>setup() </span>function</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.95pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://wiki.python.org/moin/Distutils/Cookbook"><span style='color:black'>Distutils</span></a><u>
</u><a href="http://wiki.python.org/moin/Distutils/Cookbook"><span
style='color:black'>Cookbook</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://www.python.org/dev/peps/pep-0370/"><span style='font-size:9.5pt;
line-height:110%;color:black'>PEP</span></a><u><span style='font-size:9.5pt;
line-height:110%'> </span></u><a href="http://www.python.org/dev/peps/pep-0370/"><span
style='color:black'>370:</span></a><u> </u><a
href="http://www.python.org/dev/peps/pep-0370/"><span style='color:black'>Per</span></a><u>
</u><a href="http://www.python.org/dev/peps/pep-0370/"><span style='color:black'>user</span></a><u>
</u><a href="http://www.python.org/dev/peps/pep-0370/"><span style='font-size:
10.0pt;line-height:110%;font-family:"Liberation Mono";color:black'>site-packages</span></a><u><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'> </span></u><a
href="http://www.python.org/dev/peps/pep-0370/"><span style='color:black'>directory</span></a></p>

<p class=MsoNormal style='margin-left:15.9pt;text-indent:-12.25pt;line-height:
300%'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://jessenoller.com/2009/07/19/pep-370-per-user-site-packages-and-environment-stew/"><span
style='font-size:9.5pt;line-height:300%;color:black'>PEP</span></a><u><span
style='font-size:9.5pt;line-height:300%'> </span></u><a
href="http://jessenoller.com/2009/07/19/pep-370-per-user-site-packages-and-environment-stew/"><span
style='color:black'>370</span></a><u> </u><a
href="http://jessenoller.com/2009/07/19/pep-370-per-user-site-packages-and-environment-stew/"><span
style='color:black'>and</span></a><u> </u><a
href="http://jessenoller.com/2009/07/19/pep-370-per-user-site-packages-and-environment-stew/"><span
style='color:black'>“environment</span></a><u> </u><a
href="http://jessenoller.com/2009/07/19/pep-370-per-user-site-packages-and-environment-stew/"><span
style='color:black'>stew” </span></a>On other packaging frameworks:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://groups.google.com/group/django-developers/msg/5407cdb400157259"><span
style='color:black'>The</span></a><u> </u><a
href="http://groups.google.com/group/django-developers/msg/5407cdb400157259"><span
style='color:black'>Python</span></a><u> </u><a
href="http://groups.google.com/group/django-developers/msg/5407cdb400157259"><span
style='color:black'>packaging</span></a><u> </u><a
href="http://groups.google.com/group/django-developers/msg/5407cdb400157259"><span
style='color:black'>ecosystem</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://www.b-list.org/weblog/2008/dec/14/packaging/"><span
style='color:black'>On</span></a><u> </u><a
href="http://www.b-list.org/weblog/2008/dec/14/packaging/"><span
style='color:black'>packaging</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://blog.ianbicking.org/2008/12/14/a-few-corrections-to-on-packaging/"><span
style='color:black'>A</span></a><u> </u><a
href="http://blog.ianbicking.org/2008/12/14/a-few-corrections-to-on-packaging/"><span
style='color:black'>few</span></a><u> </u><a
href="http://blog.ianbicking.org/2008/12/14/a-few-corrections-to-on-packaging/"><span
style='color:black'>corrections</span></a><u> </u><a
href="http://blog.ianbicking.org/2008/12/14/a-few-corrections-to-on-packaging/"><span
style='color:black'>to</span></a><u> </u><a
href="http://blog.ianbicking.org/2008/12/14/a-few-corrections-to-on-packaging/"><span
style='color:black'>“On</span></a><u> </u><a
href="http://blog.ianbicking.org/2008/12/14/a-few-corrections-to-on-packaging/"><span
style='color:black'>packaging”</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://www.b-list.org/weblog/2008/dec/15/pip/"><span style='color:black'>Why</span></a><u>
</u><a href="http://www.b-list.org/weblog/2008/dec/15/pip/"><span
style='color:black'>I</span></a><u> </u><a
href="http://www.b-list.org/weblog/2008/dec/15/pip/"><span style='color:black'>like</span></a><u>
</u><a href="http://www.b-list.org/weblog/2008/dec/15/pip/"><span
style='color:black'>Pip</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://cournape.wordpress.com/2009/04/01/python-packaging-a-few-observations-cabal-for-a-solution/"><span
style='color:black'>Python</span></a><u> </u><a
href="http://cournape.wordpress.com/2009/04/01/python-packaging-a-few-observations-cabal-for-a-solution/"><span
style='color:black'>packaging:</span></a><u> </u><a
href="http://cournape.wordpress.com/2009/04/01/python-packaging-a-few-observations-cabal-for-a-solution/"><span
style='color:black'>a</span></a><u> </u><a
href="http://cournape.wordpress.com/2009/04/01/python-packaging-a-few-observations-cabal-for-a-solution/"><span
style='color:black'>few</span></a><u> </u><a
href="http://cournape.wordpress.com/2009/04/01/python-packaging-a-few-observations-cabal-for-a-solution/"><span
style='color:black'>observations</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://jacobian.org/writing/nobody-expects-python-packaging/"><span
style='color:black'>Nobody</span></a><u> </u><a
href="http://jacobian.org/writing/nobody-expects-python-packaging/"><span
style='color:black'>expects</span></a><u> </u><a
href="http://jacobian.org/writing/nobody-expects-python-packaging/"><span
style='color:black'>Python</span></a><u> </u><a
href="http://jacobian.org/writing/nobody-expects-python-packaging/"><span
style='color:black'>packaging!</span></a></p>

<h3 style='margin-top:0in;margin-right:22.2pt;margin-bottom:2.95pt;margin-left:
16.4pt;line-height:107%'><span style='font-size:24.0pt;line-height:107%'>A</span><span
style='font-size:19.0pt;line-height:107%'>PPENDIX </span><span
style='font-size:24.0pt;line-height:107%'>A. P</span><span style='font-size:
19.0pt;line-height:107%'>ORTING </span><span style='font-size:24.0pt;
line-height:107%'>C</span><span style='font-size:19.0pt;line-height:107%'>ODE
TO </span><span style='font-size:24.0pt;line-height:107%'>P</span><span
style='font-size:19.0pt;line-height:107%'>YTHON </span><span style='font-size:
24.0pt;line-height:107%'>3 </span><span style='font-size:19.0pt;line-height:
107%'>WITH </span><span style='font-size:24.0pt;line-height:107%;font-family:
"Liberation Mono";font-weight:normal'>2to3</span></h3>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:39.95pt;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=736 height=4 id="Group 746174"
src="Dive%20Into%20Python%203_files/image001.gif"></span></p>

<p class=MsoNormal align=right style='margin-top:0in;margin-right:29.3pt;
margin-bottom:65.45pt;margin-left:197.65pt;text-align:right;line-height:160%'><span
style='font-size:13.0pt;line-height:160%;font-family:"Calibri",sans-serif'>&#10077;
</span><i>Life is pleasant. Death is peaceful. It’s the transition that’s
troublesome. </i><span style='font-size:13.0pt;line-height:160%;font-family:
"Calibri",sans-serif'>&#10078; </span><i>— Isaac Asimov (attributed)</i></p>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:66.35pt;margin-left:
16.4pt'><span style='font-size:18.0pt;line-height:112%'>A.1. D</span>IVING <span
style='font-size:18.0pt;line-height:112%'>I</span>N</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:34.5pt;margin-bottom:
24.7pt;margin-left:16.4pt'><span style='font-size:48.0pt;line-height:154%;
font-family:"DejaVu Serif",serif;color:#888888'>S </span>o much has changed
between Python 2 and Python 3, there are vanishingly few programs that will run
unmodified under both. But don’t despair! To help with this transition, Python
3 comes with a utility script called <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>2to3</span>, which takes your actual Python
2 source code as input and auto-converts as much as it can to Python 3. <u>Case
study: porting </u><u><span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>chardet </span>to Python 3 </u>describes how to
run the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>2to3
</span>script, then shows some things it can’t fix automatically. This appendix
documents what it <i>can </i>fix automatically.</p>

<h5 style='margin-top:0in;margin-right:0in;margin-bottom:19.75pt;margin-left:
16.4pt'><span style='font-size:18.0pt;line-height:112%'>A.2. </span><span
style='font-size:18.0pt;line-height:112%;font-family:"Liberation Mono";
font-weight:normal'>print </span>STATEMENT</h5>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
2.85pt;margin-left:16.4pt'>In Python 2, <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>print </span>was a statement.
Whatever you wanted to print simply followed the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>print </span>keyword. In Python
3, <u><span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>print()
</span>is a function</u>. Whatever you want to print, pass it to <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>print()
</span>like any other function.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:25.0pt;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=736 height=175 src="Dive%20Into%20Python%203_files/image055.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.5pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>To print a blank
line, call <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>print()
</span>without any arguments.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.4pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>To print a
single value, call <span style='font-size:10.0pt;line-height:107%;font-family:
"Liberation Mono"'>print() </span>with one argument</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>To print two
values separated by a space, call <span style='font-size:10.0pt;line-height:
107%;font-family:"Liberation Mono"'>print() </span>with two arguments.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>This one is a little tricky. In Python 2, if you ended a <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>print </span>statement
with a comma, it would print the values separated by spaces, then print a
trailing space, then stop without printing a carriage return. In Python</p>

<p class=MsoNormal style='margin-top:0in;margin-right:34.45pt;margin-bottom:
.25pt;margin-left:16.4pt'>3, the way to do this is to pass <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>end=' '
</span>as a keyword argument to the <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>print() </span>function. The <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>end </span>argument
defaults to <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>'\n'
</span>(a carriage return), so overriding it will suppress the carriage return
after printing the other arguments.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
25.4pt;margin-left:16.65pt;text-indent:-16.65pt'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>In Python 2, you could redirect the output to a pipe — like <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>sys.stderr
</span>— by using the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>&gt;&gt;pipe_name </span>syntax. In Python 3,
the way to do this is to pass the pipe in the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>file </span>keyword argument.
The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>file
</span>argument defaults to <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>sys.stdout </span>(standard out), so overriding
it will output to a different pipe instead.</p>

<h4 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>A.3.
U</span>NICODE STRING LITERALS</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.4pt;line-height:107%'>Python 2 had two string types:
Unicode strings and non-Unicode strings. Python 3 has one string type:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.05pt;
margin-left:17.15pt;line-height:110%'><u>Unicode strings</u>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:24.55pt;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=736 height=88 src="Dive%20Into%20Python%203_files/image056.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Unicode string
literals are simply converted into string literals, which, in Python 3, are
always Unicode.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
25.15pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Unicode raw strings (in which Python does not auto-escape backslashes)
are converted to raw strings. In Python 3, raw strings are always Unicode.</p>

<h5 style='margin-top:0in;margin-right:0in;margin-bottom:19.65pt;margin-left:
16.4pt'><span style='font-size:18.0pt;line-height:112%'>A.4. </span><span
style='font-size:18.0pt;line-height:112%;font-family:"Liberation Mono";
font-weight:normal'>unicode() </span>GLOBAL FUNCTION</h5>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
2.85pt;margin-left:16.4pt'>Python 2 had two global functions to coerce objects
into strings: <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>unicode()
</span>to coerce them into Unicode strings, and <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>str() </span>to coerce them
into non-Unicode strings. Python 3 has only one string type, <u>Unicode strings</u>,
so the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>str()
</span>function is all you need. (The <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>unicode() </span>function no longer
exists.)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=736 height=59 src="Dive%20Into%20Python%203_files/image057.gif"></span></p>

<h5 style='margin-top:0in;margin-right:0in;margin-bottom:19.8pt;margin-left:
16.4pt'><span style='font-size:18.0pt;line-height:112%'>A.5. </span><span
style='font-size:18.0pt;line-height:112%;font-family:"Liberation Mono";
font-weight:normal'>long </span>DATA TYPE</h5>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.65pt;margin-left:16.4pt'>Python 2 had separate <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>int </span>and <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>long </span>types
for non-floating-point numbers. An <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>int </span>could not be any larger than <u><span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>sys.maxint</span></u>,
which varied by platform. Longs were defined by appending an <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>L </span>to
the end of the number, and they could be, well, longer than ints. In Python 3, <u>there
is only one integer type</u>, called <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>int</span>, which mostly behaves like the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>long </span>type
in Python 2. Since there are no longer two types, there is no need for special
syntax to distinguish them.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:9.1pt;
margin-left:17.15pt;line-height:110%'>Further reading: <a
href="http://www.python.org/dev/peps/pep-0237/"><span style='font-size:9.5pt;
line-height:110%;color:black'>PEP</span></a><u><span style='font-size:9.5pt;
line-height:110%'> </span></u><a href="http://www.python.org/dev/peps/pep-0237/"><span
style='color:black'>237:</span></a><u> </u><a
href="http://www.python.org/dev/peps/pep-0237/"><span style='color:black'>Unifying</span></a><u>
</u><a href="http://www.python.org/dev/peps/pep-0237/"><span style='color:black'>Long</span></a><u>
</u><a href="http://www.python.org/dev/peps/pep-0237/"><span style='color:black'>Integers</span></a><u>
</u><a href="http://www.python.org/dev/peps/pep-0237/"><span style='color:black'>and</span></a><u>
</u><a href="http://www.python.org/dev/peps/pep-0237/"><span style='color:black'>Integers</span></a>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:24.55pt;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=736 height=175 src="Dive%20Into%20Python%203_files/image058.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Base 10 long
integer literals become base 10 integer literals.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.2pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Base 16 long
integer literals become base 16 integer literals.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>In Python 3, the old <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>long() </span>function no longer exists, since
longs don’t exist. To coerce a variable to an integer, use the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>int() </span>function.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.75pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>To check whether
a variable is an integer, get its type and compare it to <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>int</span>,
not <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>long</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
24.65pt;margin-left:16.65pt;text-indent:-16.65pt'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>You can also use the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>isinstance() </span>function to check data
types; again, use <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>int</span>, not <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>long</span>, to check for integers.</p>

<h4 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>A.6.
&lt;&gt; </span>COMPARISON</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
2.85pt;margin-left:16.4pt'>Python 2 supported <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>&lt;&gt; </span>as a synonym
for <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>!=</span>,
the not-equals comparison operator. Python 3 supports the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>!= </span>operator,
but not <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>&lt;&gt;</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=736 height=88 src="Dive%20Into%20Python%203_files/image059.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>A simple
comparison.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
26.1pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>A more complex comparison between three values.</p>

<h5 style='margin-top:0in;margin-right:0in;margin-bottom:19.75pt;margin-left:
16.4pt'><span style='font-size:18.0pt;line-height:112%'>A.7. </span><span
style='font-size:18.0pt;line-height:112%;font-family:"Liberation Mono";
font-weight:normal'>has_key() </span>DICTIONARY METHOD</h5>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
2.95pt;margin-left:16.4pt'>In Python 2, dictionaries had a <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>has_key()
</span>method to test whether the dictionary had a certain key. In Python 3,
this method no longer exists. Instead, you need to use <u>the </u><u><span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>in </span>operator</u>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:24.55pt;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=737 height=204 src="Dive%20Into%20Python%203_files/image060.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.25pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The simplest
form.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
1.5pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>in
</span>operator takes precedence over the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>or </span>operator, so there is
no need for parentheses around <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>x in a_dictionary </span>or around <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>y in
a_dictionary</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>On the other hand, you <i>do </i>need parentheses around <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>x or y </span>here,
for the same reason — <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>in </span>takes precedence over <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>or</span>.
(Note: this code is completely different from the previous line. Python
interprets <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>x
or y </span>first, which results in either <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>x </span>(if <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>x </span>is
<u>true in a boolean context</u>) or <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>y</span>. Then it takes that singular value
and checks whether it is a key in <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>a_dictionary</span>.)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>+
</span>operator takes precedence over the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>in </span>operator, so this
form technically doesn’t need parentheses around <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>x + y</span>, but <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>2to3 </span>includes
them anyway.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
25.6pt;margin-left:16.65pt;text-indent:-16.65pt'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>This form definitely needs parentheses around <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>y in a_dictionary</span>,
since the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>+
</span>operator takes precedence over the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>in </span>operator.</p>

<h4 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>A.8.
D</span>ICTIONARY METHODS THAT RETURN LISTS</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
3.15pt;margin-left:16.4pt'>In Python 2, many dictionary methods returned lists.
The most frequently used methods were <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>keys()</span>, <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>items()</span>, and <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>values()</span>.
In Python 3, all of these methods return dynamic views. In some contexts, this
is not a problem. If the method’s return value is immediately passed to another
function that iterates through the entire sequence, it makes no difference
whether the actual type is a list or a view. In other contexts, it matters a
great deal. If you were expecting a complete list with individually addressable
elements, your code will choke, because views do not support indexing.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:25.15pt;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=736 height=175 src="Dive%20Into%20Python%203_files/image061.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span><span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>2to3
</span>errs on the side of safety, converting the return value from <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>keys() </span>to
a static list with the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>list() </span>function. This will always work,
but it will be less efficient than using a view. You should examine the
converted code to see if a list is absolutely necessary, or if a view would do.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Another view-to-list conversion, with the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>items() </span>method. <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>2to3 </span>will
do the same thing with the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>values() </span>method.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Python 3 does not support the <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>iterkeys() </span>method anymore. Use <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>keys()</span>,
and if necessary, convert the view to an iterator with the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>iter() </span>function.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span><span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>2to3
</span>recognizes when the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>iterkeys() </span>method is used inside a list
comprehension, and converts it to the <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>keys() </span>method (without wrapping it
in an extra call to <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>iter()</span>). This works because views are iterable.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
25.4pt;margin-left:16.65pt;text-indent:-16.65pt'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span><span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>2to3
</span>recognizes that the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>keys() </span>method is immediately passed to a
function which iterates through an entire sequence, so there is no need to
convert the return value to a list first. The <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>min() </span>function will
happily iterate through the view instead. This applies to <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>min()</span>,
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>max()</span>,
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>sum()</span>,
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>list()</span>,
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>tuple()</span>,
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>set()</span>,
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>sorted()</span>,
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>any()</span>,
and <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>all()</span>.</p>

<h4 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>A.9.
M</span>ODULES THAT HAVE BEEN RENAMED OR REORGANIZED</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:30.7pt;margin-bottom:
10.4pt;margin-left:16.65pt;text-align:justify;text-justify:inter-ideograph;
text-indent:0in;line-height:216%'>Several modules in the Python Standard
Library have been renamed. Several other modules which are related to each
other have been combined or reorganized to make their association more logical.
<b><span style='font-size:13.0pt;line-height:216%;font-family:"DejaVu Serif",serif'>A.9.1.
</span></b><span style='font-size:13.0pt;line-height:216%;font-family:"Liberation Mono"'>http</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
9.4pt;margin-left:16.4pt;line-height:107%'>In Python 3, several related <span
style='font-size:9.5pt;line-height:107%'>HTTP </span>modules have been combined
into a single package, <span style='font-size:10.0pt;line-height:107%;
font-family:"Liberation Mono"'>http</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=736 height=31 src="Dive%20Into%20Python%203_files/image062.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:25.05pt;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=736 height=173 src="Dive%20Into%20Python%203_files/image063.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>http.client
</span>module implements a low-level library that can request <span
style='font-size:9.5pt;line-height:154%'>HTTP </span>resources and interpret <span
style='font-size:9.5pt;line-height:154%'>HTTP </span>responses.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.95pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>http.cookies
</span>module provides a Pythonic interface to browser cookies that are sent in
a <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>Set-Cookie:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.55pt;margin-left:16.4pt;line-height:107%'><span style='font-size:9.5pt;
line-height:107%'>HTTP </span>header.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>http.cookiejar
</span>module manipulates the actual files on disk that popular web browsers
use to store cookies.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
22.25pt;margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>http.server
</span>module provides a basic <span style='font-size:9.5pt;line-height:154%'>HTTP
</span>server.</p>

<h5 style='margin-top:0in;margin-right:0in;margin-bottom:24.8pt;margin-left:
16.4pt;line-height:121%'><span style='font-size:13.0pt;line-height:121%'>A.9.2.
</span><span style='font-size:13.0pt;line-height:121%;font-family:"Liberation Mono";
font-weight:normal'>urllib</span></h5>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
2.85pt;margin-left:16.4pt'>Python 2 had a rat’s nest of overlapping modules to
parse, encode, and fetch <span style='font-size:9.5pt;line-height:154%'>URLS</span>.
In Python 3, these have all been refactored and combined in a single package, <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>urllib</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:25.1pt;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=737 height=288 src="Dive%20Into%20Python%203_files/image064.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The old <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>urllib
</span>module in Python 2 had a variety of functions, including <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>urlopen()
</span>for fetching data and <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>splittype()</span>, <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>splithost()</span>, and <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>splituser()
</span>for splitting a <span style='font-size:9.5pt;line-height:154%'>URL </span>into
its constituent parts. These functions have been reorganized more logically
within the new <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>urllib
</span>package. <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>2to3 </span>will also change all calls to these functions so
they use the new naming scheme.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The old <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>urllib2
</span>module in Python 2 has been folded into the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>urllib </span>package in Python
3. All your <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>urllib2
</span>favorites — the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>build_opener() </span>method, <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>Request
</span>objects, and <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>HTTPBasicAuthHandler </span>and friends — are still
available.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>urllib.parse
</span>module in Python 3 contains all the parsing functions from the old <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>urlparse
</span>module in Python 2.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.3pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:110%'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The <span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>urllib.robotparser
</span>module parses <a href="http://www.robotstxt.org/"><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:black'>robots.txt</span></a><u><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'> </span></u><a
href="http://www.robotstxt.org/"><span style='color:black'>files</span></a>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>FancyURLopener
</span>class, which handles <span style='font-size:9.5pt;line-height:154%'>HTTP
</span>redirects and other status codes, is still available in the new <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>urllib.request
</span>module. The <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>urlencode() </span>function has moved to <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>urllib.parse</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.2pt;margin-left:16.65pt;text-indent:-16.65pt'>6.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>

<table cellpadding=0 cellspacing=0>
 <tr>
  <td width=40 height=0></td>
 </tr>
 <tr>
  <td></td>
  <td><img width=779 height=1 src="Dive%20Into%20Python%203_files/image065.gif"></td>
 </tr>
</table>

<br clear=ALL>
The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>Request
</span>object is still available in <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>urllib.request</span>, but constants like <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>HTTPError
</span>have been moved to <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>urllib.error</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:34.2pt;margin-bottom:
24.55pt;margin-left:16.4pt'>Did I mention that <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>2to3 </span>will rewrite your
function calls too? For example, if your Python 2 code imports the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>urllib </span>module
and calls <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>urllib.urlopen()
</span>to fetch data, <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>2to3 </span>will fix both the import statement
and the function call.</p>

<h5 style='margin-top:23.2pt;margin-right:0in;margin-bottom:25.3pt;margin-left:
16.4pt;line-height:121%'><span style='font-size:13.0pt;line-height:121%'>A.9.3.
</span><span style='font-size:13.0pt;line-height:121%;font-family:"Liberation Mono";
font-weight:normal'>dbm</span></h5>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
2.9pt;margin-left:16.4pt'>All the various <span style='font-size:9.5pt;
line-height:154%'>DBM </span>clones are now in a single package, <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>dbm</span>.
If you need a specific variant like <span style='font-size:9.5pt;line-height:
154%'>GNU DBM</span>, you can import the appropriate module within the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>dbm </span>package.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=736 height=203 src="Dive%20Into%20Python%203_files/image066.gif"></span></p>

<h5 style='margin-top:0in;margin-right:0in;margin-bottom:25.3pt;margin-left:
16.4pt;line-height:121%'><span style='font-size:13.0pt;line-height:121%'>A.9.4.
</span><span style='font-size:13.0pt;line-height:121%;font-family:"Liberation Mono";
font-weight:normal'>xmlrpc</span></h5>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
2.9pt;margin-left:16.4pt'><span style='font-size:9.5pt;line-height:154%'>XML</span>-<span
style='font-size:9.5pt;line-height:154%'>RPC </span>is a lightweight method of
performing remote <span style='font-size:9.5pt;line-height:154%'>RPC </span>calls
over <span style='font-size:9.5pt;line-height:154%'>HTTP</span>. The <span
style='font-size:9.5pt;line-height:154%'>XML</span>-<span style='font-size:
9.5pt;line-height:154%'>RPC </span>client library and several <span
style='font-size:9.5pt;line-height:154%'>XML</span>-<span style='font-size:
9.5pt;line-height:154%'>RPC </span>server implementations are now combined in a
single package, <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>xmlrpc</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:24.3pt;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=736 height=116 src="Dive%20Into%20Python%203_files/image067.gif"></span></p>

<h5 style='margin-top:0in;margin-right:0in;margin-bottom:6.5pt;margin-left:
16.4pt;line-height:110%'><span style='font-size:13.0pt;line-height:110%'>A.9.5.
O</span><span style='font-size:10.5pt;line-height:110%'>THER MODULES</span></h5>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:25.25pt;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=736 height=460 src="Dive%20Into%20Python%203_files/image068.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>A common idiom in Python 2 was to try to import <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>cStringIO as StringIO</span>,
and if that failed, to import <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>StringIO </span>instead. Do not do this in
Python 3; the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>io
</span>module does it for you. It will find the fastest implementation
available and use it automatically.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>A similar idiom was used to import the fastest pickle implementation. Do
not do this in Python 3; the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>pickle </span>module does it for you.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>builtins
</span>module contains the global functions, classes, and constants used
throughout the Python language. Redefining a function in the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>builtins
</span>module will redefine the global function everywhere. That is exactly as
powerful and scary as it sounds.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.3pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>copyreg
</span>module adds pickle support for custom types defined in C.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.45pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>5.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>queue </span>module
implements a multi-producer, multi-consumer queue.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.85pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>6.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>socketserver
</span>module provides generic base classes for implementing different kinds of
socket servers.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.5pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>7.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>configparser
</span>module parses <span style='font-size:9.5pt;line-height:107%'>INI</span>-style
configuration files.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>8.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>reprlib
</span>module reimplements the built-in <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>repr() </span>function, with
additional controls on how long the representations can be before they are
truncated.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
25.3pt;margin-left:16.65pt;text-indent:-16.65pt'>9.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>subprocess
</span>module allows you to spawn processes, connect to their pipes, and obtain
their return codes.</p>

<h4 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>A.10.
R</span>ELATIVE IMPORTS WITHIN A PACKAGE</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.5pt;margin-left:16.4pt'>A package is a group of related modules that
function as a single entity. In Python 2, when modules within a package need to
reference each other, you use <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>import foo </span>or <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>from foo import Bar</span>.
The Python 2 interpreter first searches within the current package to find <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>foo.py</span>,
and then moves on to the other directories in the Python search path (<span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>sys.path</span>).
Python 3 works a bit differently. Instead of searching the current package, it
goes directly to the Python search path. If you want one module within a package
to import another module in the same package, you need to explicitly provide
the relative path between the two modules.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.9pt;margin-left:16.4pt'>Suppose you had this package, with multiple files in
the same directory:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:470.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>chardet/ | +--__init__.py |
+--constants.py</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:428.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>| +--mbcharsetprober.py</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>|</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>+--universaldetector.py</span></p>

<p class=MsoNormal align=right style='margin-top:0in;margin-right:31.0pt;
margin-bottom:.15pt;margin-left:.5pt;text-align:right;line-height:110%'>Now
suppose that <span style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>universaldetector.py
</span>needs to import the entire <span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>constants.py </span>file and one class from</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:24.95pt;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=736 height=167 src="Dive%20Into%20Python%203_files/image069.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:32.25pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>

<table cellpadding=0 cellspacing=0>
 <tr>
  <td width=40 height=0></td>
 </tr>
 <tr>
  <td></td>
  <td><img width=779 height=1 src="Dive%20Into%20Python%203_files/image065.gif"></td>
 </tr>
</table>

<br clear=ALL>
When you need to import an entire module from elsewhere in your package, use
the new <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>from
. import </span>syntax. The period is actually a relative path from this file (<span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>universaldetector.py</span>)
to the file you want to import (<span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>constants.py</span>). In this case, they are in
the same directory, thus the single period. You can also import from the parent
directory (<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>from
.. import anothermodule</span>) or a subdirectory.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:32.25pt;margin-bottom:
24.95pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>To import a specific class or function from another module directly into
your module’s namespace, prefix the target module with a relative path, minus
the trailing slash. In this case, <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>mbcharsetprober.py </span>is in the same
directory as <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>universaldetector.py</span>,
so the path is a single period. You can also import form the parent directory (<span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>from
..anothermodule import AnotherClass</span>) or a subdirectory.</p>

<h5 style='margin-top:0in;margin-right:0in;margin-bottom:19.7pt;margin-left:
16.4pt'><span style='font-size:18.0pt;line-height:112%'>A.11. </span><span
style='font-size:18.0pt;line-height:112%;font-family:"Liberation Mono";
font-weight:normal'>next() </span>ITERATOR METHOD</h5>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt'>In Python 2, iterators had a <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>next() </span>method
which returned the next item in the sequence. That’s still true in Python 3,
but there is now also <u>a global </u><u><span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>next() </span>function </u>that
takes an iterator as an argument.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>In the simplest case, instead of calling an iterator’s <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>next() </span>method,
you now pass the iterator itself to the global <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>next() </span>function.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>If you have a function that returns an iterator, call the function and
pass the result to the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>next() </span>function. (The <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>2to3 </span>script
is smart enough to convert this properly.)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.25pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>If you define
your own class and mean to use it as an iterator, define the <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>__next__()
</span>special method.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>If you define your own class and just happen to have a method named <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>next() </span>that
takes one or more arguments, <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>2to3 </span>will not touch it. This class can
not be used as an iterator, because its <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>next() </span>method takes
arguments.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
25.05pt;margin-left:16.65pt;text-indent:-16.65pt'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>This one is a bit tricky. If you have a local variable named <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>next</span>,
then it takes precedence over the new global <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>next() </span>function. In this
case, you need to call the iterator’s special <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>__next__() </span>method to get
the next item in the sequence. (Alternatively, you could also refactor the code
so the local variable wasn’t named <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>next</span>, but <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>2to3 </span>will not do
that for you automatically.)</p>

<h5 style='margin-top:0in;margin-right:0in;margin-bottom:19.7pt;margin-left:
16.4pt'><span style='font-size:18.0pt;line-height:112%'>A.12. </span><span
style='font-size:18.0pt;line-height:112%;font-family:"Liberation Mono";
font-weight:normal'>filter() </span>GLOBAL FUNCTION</h5>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
2.9pt;margin-left:16.4pt'>In Python 2, the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>filter() </span>function
returned a list, the result of filtering a sequence through a function that
returned <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>True
</span>or <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>False
</span>for each item in the sequence. In Python 3, the <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>filter() </span>function
returns an iterator, not a list.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:25.25pt;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=736 height=203 src="Dive%20Into%20Python%203_files/image070.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>In the most basic case, <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>2to3 </span>will wrap a call to <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>filter()
</span>with a call to <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>list()</span>, which simply iterates through its
argument and returns a real list.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>However, if the call to <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>filter() </span>is <i>already </i>wrapped in <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>list()</span>,
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>2to3
</span>will do nothing, since the fact that <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>filter() </span>is returning an
iterator is irrelevant.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>For the special syntax of <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>filter(None, ...)</span>, <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>2to3 </span>will
transform the call into a semantically equivalent list comprehension.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>In contexts like
<span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>for
</span>loops, which iterate through the entire sequence anyway, no changes are
necessary.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
25.15pt;margin-left:16.65pt;text-indent:-16.65pt'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Again, no changes are necessary, because the list comprehension will
iterate through the entire sequence, and it can do that just as well if <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>filter()
</span>returns an iterator as if it returns a list.</p>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:20.0pt;margin-left:
16.4pt'><span style='font-size:18.0pt;line-height:112%'>A.13. </span><span
style='font-size:18.0pt;line-height:112%;font-family:"Liberation Mono";
font-weight:normal'>map() </span>GLOBAL FUNCTION</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.4pt;line-height:107%'>In much the same way as <u><span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>filter()</span></u>,
the <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>map()
</span>function now returns an iterator. (In Python 2, it returned a</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
9.35pt;margin-left:16.4pt;line-height:107%'>list.)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:25.5pt;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=736 height=203 src="Dive%20Into%20Python%203_files/image071.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.6pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>As with <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>filter()</span>,
in the most basic case, <span style='font-size:10.0pt;line-height:107%;
font-family:"Liberation Mono"'>2to3 </span>will wrap a call to <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>map() </span>with
a call to <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>list()</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
1.85pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>For the special syntax of <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>map(None, ...)</span>, the identity
function, <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>2to3
</span>will convert it to an equivalent call to <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>list()</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.15pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>If the first
argument to <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>map()
</span>is a lambda function, <span style='font-size:10.0pt;line-height:107%;
font-family:"Liberation Mono"'>2to3 </span>will convert it to an equivalent
list comprehension.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.05pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>In contexts like
<span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>for
</span>loops, which iterate through the entire sequence anyway, no changes are
necessary.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
25.1pt;margin-left:16.65pt;text-indent:-16.65pt'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Again, no changes are necessary, because the list comprehension will
iterate through the entire sequence, and it can do that just as well if <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>map() </span>returns
an iterator as if it returns a list.</p>

<h5 style='margin-top:0in;margin-right:0in;margin-bottom:19.7pt;margin-left:
16.4pt'><span style='font-size:18.0pt;line-height:112%'>A.14. </span><span
style='font-size:18.0pt;line-height:112%;font-family:"Liberation Mono";
font-weight:normal'>reduce() </span>GLOBAL FUNCTION</h5>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
2.55pt;margin-left:16.4pt'>In Python 3, the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>reduce() </span>function has
been removed from the global namespace and placed in the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>functools
</span>module.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=736 height=87 src="Dive%20Into%20Python%203_files/image072.gif"></span></p>

<h5 style='margin-top:0in;margin-right:0in;margin-bottom:20.0pt;margin-left:
16.4pt'><span style='font-size:18.0pt;line-height:112%'>A.15. </span><span
style='font-size:18.0pt;line-height:112%;font-family:"Liberation Mono";
font-weight:normal'>apply() </span>GLOBAL FUNCTION</h5>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
2.9pt;margin-left:16.4pt'>Python 2 had a global function called <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>apply()</span>,
which took a function <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>f </span>and a list <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>[a, b, c] </span>and returned <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>f(a, b,
c)</span>. You can accomplish the same thing by calling the function directly
and passing it the list of arguments preceded by an asterisk. In Python 3, the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>apply()
</span>function no longer exists; you must use the asterisk notation.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:24.8pt;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=737 height=202 src="Dive%20Into%20Python%203_files/image073.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>In the simplest form, you can call a function with a list of arguments
(an actual list like <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>[a, b, c]</span>) by prepending the list with an asterisk (<span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>*</span>).
This is exactly equivalent to the old <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>apply() </span>function in Python 2.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>In Python 2, the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>apply() </span>function could actually take
three parameters: a function, a list of arguments, and a dictionary of named
arguments. In Python 3, you can accomplish the same thing by prepending the
list of arguments with an asterisk (<span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>*</span>) and the dictionary of named
arguments with two asterisks (<span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>**</span>).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>+
</span>operator, used here for list concatenation, takes precedence over the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>* </span>operator,
so there is no need for extra parentheses around <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>a_list_of_args + z</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
25.05pt;margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>2to3
</span>script is smart enough to convert complex <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>apply() </span>calls, including
calling functions within imported modules.</p>

<h5 style='margin-top:0in;margin-right:0in;margin-bottom:19.7pt;margin-left:
16.4pt'><span style='font-size:18.0pt;line-height:112%'>A.16. </span><span
style='font-size:18.0pt;line-height:112%;font-family:"Liberation Mono";
font-weight:normal'>intern() </span>GLOBAL FUNCTION</h5>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
2.8pt;margin-left:16.4pt'>In Python 2, you could call the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>intern()
</span>function on a string to intern it as a performance optimization. In
Python 3, the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>intern()
</span>function has been moved to the <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>sys </span>module.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=736 height=59 src="Dive%20Into%20Python%203_files/image074.gif"></span></p>

<h5 style='margin-top:0in;margin-right:0in;margin-bottom:20.05pt;margin-left:
16.4pt'><span style='font-size:18.0pt;line-height:112%'>A.17. </span><span
style='font-size:18.0pt;line-height:112%;font-family:"Liberation Mono";
font-weight:normal'>exec </span>STATEMENT</h5>

<p class=MsoNormal style='margin-top:0in;margin-right:40.1pt;margin-bottom:
2.9pt;margin-left:16.4pt'>Just as <u>the </u><u><span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>print </span>statement </u>became
a function in Python 3, so too has the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>exec </span>statement. The <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>exec() </span>function
takes a string which contains arbitrary Python code and executes it as if it
were just another statement or expression. <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>exec() </span>is like <u><span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>eval()</span></u>,
but even more powerful and evil. The <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>eval() </span>function can only evaluate a
single expression, but <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>exec() </span>can execute multiple statements,
imports, function declarations — essentially an entire Python program in a
string.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:24.9pt;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=737 height=145 src="Dive%20Into%20Python%203_files/image075.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>In the simplest form, the <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>2to3 </span>script simply encloses the
code-as-a-string in parentheses, since <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>exec() </span>is now a function
instead of a statement.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The old <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>exec
</span>statement could take a namespace, a private environment of globals in
which the code-as-astring would be executed. Python 3 can also do this; just
pass the namespace as the second argument to the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>exec() </span>function.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
24.85pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Even fancier, the old <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>exec </span>statement could also take a local
namespace (like the variables defined within a function). In Python 3, the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>exec() </span>function
can do that too.</p>

<h5 style='margin-top:0in;margin-right:0in;margin-bottom:19.65pt;margin-left:
16.4pt'><span style='font-size:18.0pt;line-height:112%'>A.18. </span><span
style='font-size:18.0pt;line-height:112%;font-family:"Liberation Mono";
font-weight:normal'>execfile </span>STATEMENT</h5>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.8pt;margin-left:16.4pt;line-height:107%'>Like the old <u><span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>exec </span>statement</u>,
the old <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>execfile
</span>statement will execute strings as if they were Python code.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
2.95pt;margin-left:16.4pt'>Where <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>exec </span>took a string, <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>execfile
</span>took a filename. In Python 3, the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>execfile </span>statement has
been eliminated. If you really need to take a file of Python code and execute
it (but you’re not willing to simply import it), you can accomplish the same
thing by opening the file, reading its contents, calling the global <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>compile()
</span>function to force the Python interpreter to compile the code, and then
call the new <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>exec()
</span>function.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=737 height=87 src="Dive%20Into%20Python%203_files/image076.gif"></span></p>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:19.75pt;margin-left:
16.4pt'><span style='font-size:18.0pt;line-height:112%'>A.19. </span><span
style='font-size:18.0pt;line-height:112%;font-family:"Liberation Mono";
font-weight:normal'>repr </span>LITERALS <span style='font-size:18.0pt;
line-height:112%'>(</span>BACKTICKS<span style='font-size:18.0pt;line-height:
112%'>)</span></h4>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
2.85pt;margin-left:16.4pt'>In Python 2, there was a special syntax of wrapping
any object in backticks (like <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>`x`</span>) to get a representation of the
object. In Python 3, this capability still exists, but you can no longer use
backticks to get it. Instead, use the global <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>repr() </span>function.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:24.8pt;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=736 height=88 src="Dive%20Into%20Python%203_files/image077.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Remember, <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>x </span>can be anything — a class, a function, a module, a
primitive data type, <i><span style='font-size:13.0pt;line-height:154%;
font-family:"DejaVu Serif",serif'>&amp;</span></i>c. The <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>repr() </span>function
works on everything.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
24.8pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>In Python 2, backticks could be nested, leading to this sort of
confusing (but valid) expression. The <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>2to3 </span>tool is smart enough to convert
this into nested calls to <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>repr()</span>.</p>

<h5 style='margin-top:0in;margin-right:0in;margin-bottom:19.9pt;margin-left:
16.4pt;line-height:107%'><span style='font-size:18.0pt;line-height:107%'>A.20. </span><span
style='font-size:18.0pt;line-height:107%;font-family:"Liberation Mono";
font-weight:normal'>try...except </span>STATEMENT</h5>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
9.35pt;margin-left:16.4pt;line-height:107%'>The syntax for <u>catching
exceptions </u>has changed slightly between Python 2 and Python 3.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=737 height=369 src="Dive%20Into%20Python%203_files/image078.gif"></span></p>

</div>

<span style='font-size:12.0pt;line-height:154%;font-family:"Gill Sans MT",sans-serif;
color:black'><br clear=all style='page-break-before:always'>
</span>

<div class=WordSection26>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:24.65pt;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=736 height=114 src="Dive%20Into%20Python%203_files/image079.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.15pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Instead of a
comma after the exception type, Python 3 uses a new keyword, <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>as</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.05pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>as </span>keyword
also works for catching multiple types of exceptions at once.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>If you catch an exception but don’t actually care about accessing the
exception object itself, the syntax is identical between Python 2 and Python 3.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
47.75pt;margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Similarly, if you use a fallback to catch <i>all </i>exceptions, the
syntax is identical.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:50.5pt;margin-bottom:
45.35pt;margin-left:75.95pt;text-indent:-29.3pt'><span style='font-size:24.0pt;
line-height:154%;font-family:"Calibri",sans-serif'>&#9758; </span>You should
never use a fallback to catch <i>all </i>exceptions when importing modules (or
most other times). Doing so will catch things like <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>KeyboardInterrupt </span>(if
the user pressed <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>Ctrl-C </span>to interrupt the program) and can make it more
difficult to debug errors.</p>

<h6 style='margin-top:0in;margin-right:0in;margin-bottom:19.4pt;margin-left:
16.4pt;line-height:112%'><span style='font-size:18.0pt;line-height:112%'>A.21. </span><span
style='font-size:18.0pt;line-height:112%;font-family:"Liberation Mono";
font-weight:normal'>raise </span><span style='font-size:14.5pt;line-height:
112%'>STATEMENT</span></h6>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
9.35pt;margin-left:16.4pt;line-height:107%'>The syntax for <u>raising your own
exceptions </u>has changed slightly between Python 2 and Python 3.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:24.55pt;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=737 height=175 src="Dive%20Into%20Python%203_files/image080.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:22.35pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>In the simplest
form, raising an exception without a custom error message, the syntax is
unchanged.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:22.35pt;margin-bottom:
.15pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:155%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The change
becomes noticeable when you want to raise an exception with a custom error
message. Python 2 separated the exception class and the message with a comma;
Python 3 passes the error message as a parameter.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:22.35pt;margin-bottom:
6.0pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Python 2
supported a more complex syntax to raise an exception with a custom traceback
(stack trace).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.0pt;margin-left:16.4pt;line-height:107%'>You can do this in Python 3 as well,
but the syntax is quite different.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:22.35pt;margin-bottom:
25.35pt;margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>In Python 2, you could raise an exception with no exception class, just
an error message. In Python 3, this is no longer possible. <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>2to3 </span>will
warn you that it was unable to fix this automatically.</p>

<h6 style='margin-top:0in;margin-right:0in;margin-bottom:20.6pt;margin-left:
16.4pt;line-height:112%'><span style='font-size:18.0pt;line-height:112%'>A.22. </span><span
style='font-size:18.0pt;line-height:112%;font-family:"Liberation Mono";
font-weight:normal'>throw </span><span style='font-size:14.5pt;line-height:
112%'>METHOD ON GENERATORS</span></h6>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:2.95pt;
margin-left:16.4pt'>In Python 2, generators have a <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>throw() </span>method. Calling <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>a_generator.throw()
</span>raises an exception at the point where the generator was paused, then
returns the next value yielded by the generator function. In Python 3, this
functionality is still available, but the syntax is slightly different.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:24.55pt;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=737 height=145 src="Dive%20Into%20Python%203_files/image081.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>In the simplest form, a generator throws an exception without a custom
error message. In this case, the syntax has not changed between Python 2 and
Python 3.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>If the generator throws an exception <i>with </i>a custom error message,
you need to pass the error string to the exception when you create it.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
24.9pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Python 2 also supported throwing an exception with <i>only </i>a custom
error message. Python 3 does not support this, and the <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>2to3 </span>script will
display a warning telling you that you will need to fix this code manually.</p>

<h6 style='margin-top:0in;margin-right:0in;margin-bottom:19.95pt;margin-left:
16.4pt;line-height:112%'><span style='font-size:18.0pt;line-height:112%'>A.23. </span><span
style='font-size:18.0pt;line-height:112%;font-family:"Liberation Mono";
font-weight:normal'>xrange() </span><span style='font-size:14.5pt;line-height:
112%'>GLOBAL FUNCTION</span></h6>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:2.8pt;
margin-left:16.4pt'>In Python 2, there were two ways to get a range of numbers:
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>range()</span>,
which returned a list, and <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>xrange()</span>, which returned an iterator. In
Python 3, <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>range()
</span>returns an iterator, and <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>xrange() </span>doesn’t exist.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=736 height=118 src="Dive%20Into%20Python%203_files/image082.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:25.45pt;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=736 height=60 src="Dive%20Into%20Python%203_files/image083.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.4pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>In the simplest
case, the <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>2to3
</span>script will simply convert <span style='font-size:10.0pt;line-height:
107%;font-family:"Liberation Mono"'>xrange() </span>to <span style='font-size:
10.0pt;line-height:107%;font-family:"Liberation Mono"'>range()</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>If your Python 2 code used <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>range()</span>, the <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>2to3 </span>script does
not know whether you needed a list, or whether an iterator would do. It errs on
the side of caution and coerces the return value into a list by calling the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>list() </span>function.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>If the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>xrange()
</span>function was inside a list comprehension, there is no need to coerce the
result to a list, since the list comprehension will work just fine with an
iterator.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.4pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Similarly, a <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>for </span>loop
will work just fine with an iterator, so there is no need to change anything
here.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
24.7pt;margin-left:16.65pt;text-indent:-16.65pt'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>sum()
</span>function will also work with an iterator, so <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>2to3 </span>makes no
changes here either. Like <u>dictionary methods that return views instead of
lists</u>, this applies to <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>min()</span>, <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>max()</span>, <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>sum()</span>,
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>list()</span>,
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>tuple()</span>,
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>set()</span>,
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>sorted()</span>,
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>any()</span>,
and <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>all()</span>.</p>

<h6 style='margin-top:0in;margin-right:0in;margin-bottom:19.15pt;margin-left:
16.4pt;line-height:112%'><span style='font-size:18.0pt;line-height:112%'>A.24. </span><span
style='font-size:18.0pt;line-height:112%;font-family:"Liberation Mono";
font-weight:normal'>raw_input() </span><span style='font-size:14.5pt;
line-height:112%'>AND </span><span style='font-size:18.0pt;line-height:112%;
font-family:"Liberation Mono";font-weight:normal'>input() </span><span
style='font-size:14.5pt;line-height:112%'>GLOBAL FUNCTIONS</span></h6>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:2.9pt;
margin-left:16.4pt'>Python 2 had two global functions for asking the user for
input on the command line. The first, called <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>input()</span>, expected the
user to enter a Python expression (and returned the result). The second, called
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>raw_input()</span>,
just returned whatever the user typed. This was wildly confusing for beginners
and widely regarded as a “wart” in the language. Python 3 excises this wart by
renaming <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>raw_input()
</span>to <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>input()</span>,
so it works the way everyone naively expects it to work.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:25.75pt;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=736 height=118 src="Dive%20Into%20Python%203_files/image084.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.4pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>In the simplest
form, <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>raw_input()
</span>becomes <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>input()</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>In Python 2, the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>raw_input() </span>function could take a prompt
as a parameter. This has been retained in Python 3.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>If you actually need to ask the user for a Python expression to
evaluate, use the <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>input() </span>function and pass the result to <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>eval()</span>.</p>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:19.55pt;margin-left:
16.4pt'><span style='font-size:18.0pt;line-height:112%'>A.25. </span><span
style='font-size:18.0pt;line-height:112%;font-family:"Liberation Mono";
font-weight:normal'>func_* </span>FUNCTION ATTRIBUTES</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:2.95pt;
margin-left:16.4pt'>In Python 2, code within functions can access special
attributes about the function itself. In Python 3, these special function
attributes have been renamed for consistency with other attributes.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:25.35pt;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=736 height=234 src="Dive%20Into%20Python%203_files/image085.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.35pt;margin-bottom:
6.5pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>__name__
</span>attribute (previously <span style='font-size:10.0pt;line-height:107%;
font-family:"Liberation Mono"'>func_name</span>) contains the function’s name.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.35pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__doc__
</span>attribute (previously <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>func_doc</span>) contains the <i>docstring </i>that
you defined in the function’s source code.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.35pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__defaults__
</span>attribute (previously <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>func_defaults</span>) is a tuple containing
default argument values for those arguments that have default values.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.35pt;margin-bottom:
6.85pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>__dict__
</span>attribute (previously <span style='font-size:10.0pt;line-height:107%;
font-family:"Liberation Mono"'>func_dict</span>) is the namespace supporting
arbitrary function attributes.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.35pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__closure__
</span>attribute (previously <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>func_closure</span>) is a tuple of cells that
contain bindings for the function’s free variables.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.35pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>6.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__globals__
</span>attribute (previously <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>func_globals</span>) is a reference to the
global namespace of the module in which the function was defined.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:1.35pt;margin-bottom:
25.4pt;margin-left:16.65pt;text-indent:-16.65pt'>7.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__code__
</span>attribute (previously <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>func_code</span>) is a code object representing
the compiled function body.</p>

<h5 style='margin-top:0in;margin-right:0in;margin-bottom:19.9pt;margin-left:
16.4pt;line-height:107%'><span style='font-size:18.0pt;line-height:107%'>A.26. </span><span
style='font-size:18.0pt;line-height:107%;font-family:"Liberation Mono";
font-weight:normal'>xreadlines() </span><span style='font-size:18.0pt;
line-height:107%'>I/O </span>METHOD</h5>

<p class=MsoNormal style='margin-top:0in;margin-right:7.3pt;margin-bottom:21.15pt;
margin-left:16.4pt'>In Python 2, file objects had an <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>xreadlines() </span>method
which returned an iterator that would read the file one line at a time. This
was useful in <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>for
</span>loops, among other places. In fact, it was so useful, later versions of
Python 2 added the capability to file objects themselves.</p>

<p class=MsoNormal style='margin-left:16.4pt'>In Python 3, the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>xreadlines()
</span>method no longer exists. <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>2to3 </span>can fix the simple cases, but some
edge cases will require manual intervention.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:25.1pt;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=736 height=88 src="Dive%20Into%20Python%203_files/image086.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.1pt;margin-bottom:.25pt;
margin-left:16.65pt;text-indent:-16.65pt;line-height:151%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>If you used to
call <span style='font-size:10.0pt;line-height:151%;font-family:"Liberation Mono"'>xreadlines()
</span>with no arguments, <span style='font-size:10.0pt;line-height:151%;
font-family:"Liberation Mono"'>2to3 </span>will convert it to just the file
object. In Python 3, this will accomplish the same thing: read the file one
line at a time and execute the body of the <span style='font-size:10.0pt;
line-height:151%;font-family:"Liberation Mono"'>for </span>loop.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.1pt;margin-bottom:.25pt;
margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>If you used to call <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>xreadlines() </span>with an argument (the number
of lines to read at a time), <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>2to3 </span>will not fix it, and your code will
fail with an <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>AttributeError:
'_io.TextIOWrapper' object has no attribute 'xreadlines'</span>. You can
manually change <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>xreadlines() </span>to <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>readlines() </span>to get it to
work in Python 3. (The <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>readlines() </span>method now returns an
iterator, so it is just as efficient as <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>xreadlines() </span>was in
Python 2.) <span style='font-size:42.0pt;line-height:154%;font-family:"DejaVu Sans",sans-serif'>&#9731;</span></p>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:21.4pt;margin-left:
16.4pt'><span style='font-size:18.0pt;line-height:112%'>A.27. </span><span
style='font-size:18.0pt;line-height:112%;font-family:"Liberation Mono";
font-weight:normal'>lambda </span>FUNCTIONS THAT TAKE A TUPLE INSTEAD OF
MULTIPLE PARAMETERS</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:3.9pt;margin-bottom:2.95pt;
margin-left:16.4pt'>In Python 2, you could define anonymous <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>lambda </span>functions
which took multiple parameters by defining the function as taking a tuple with
a specific number of items. In effect, Python 2 would “unpack” the tuple into
named arguments, which you could then reference (by name) within the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>lambda </span>function.
In Python 3, you can still pass a tuple to a <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>lambda </span>function, but the
Python interpreter will not unpack the tuple into named arguments. Instead, you
will need to reference each argument by its positional index.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:24.8pt;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=736 height=175 src="Dive%20Into%20Python%203_files/image087.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:7.3pt;margin-bottom:.25pt;
margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>If you had defined a <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>lambda </span>function that took a tuple of one
item, in Python 3 that would become a <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>lambda </span>with references to <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>x1[0]</span>.
The name <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>x1
</span>is autogenerated by the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>2to3 </span>script, based on the named arguments
in the original tuple.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:7.3pt;margin-bottom:.25pt;
margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>A <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>lambda
</span>function with a two-item tuple <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>(x, y) </span>gets converted to <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>x_y </span>with
positional arguments <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>x_y[0] </span>and <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>x_y[1]</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:7.3pt;margin-bottom:.25pt;
margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>2to3
</span>script can even handle <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>lambda </span>functions with nested tuples of
named arguments. The resulting Python 3 code is a bit unreadable, but it works
the same as the old code did in Python 2.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:7.3pt;margin-bottom:25.35pt;
margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>You can define <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>lambda </span>functions that take multiple
arguments. Without parentheses around the arguments, Python 2 just treats it as
a <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>lambda
</span>function with multiple arguments; within the <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>lambda </span>function,
you simply reference the arguments by name, just like any other function. This
syntax still works in Python 3.</p>

<h4 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>A.28.
S</span>PECIAL METHOD ATTRIBUTES</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:3.9pt;margin-bottom:21.25pt;
margin-left:16.4pt'>In Python 2, class methods can reference the class object
in which they are defined, as well as the method object itself. <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>im_self
</span>is the class instance object; <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>im_func </span>is the function object; <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>im_class
</span>is the class of <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>im_self</span>. In Python 3, these special
method attributes have been renamed to follow the naming conventions of other
attributes.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>           </span><b>Notes    Python
2                                                            Python 3</b></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:26.4pt;
margin-left:70.5pt;text-align:justify;text-justify:inter-ideograph;line-height:
182%'><span style='position:relative;z-index:-1895751680'><span
style='left:0px;position:absolute;left:22px;top:-433775px;width:753px;
height:1px'><img width=753 height=1
src="Dive%20Into%20Python%203_files/image088.gif"></span></span><span
style='font-size:10.0pt;line-height:182%;font-family:"Liberation Mono"'>aClassInstance.aClassMethod.im_func
aClassInstance.aClassMethod.__func__ aClassInstance.aClassMethod.im_self
aClassInstance.aClassMethod.__self__ aClassInstance.aClassMethod.im_class
aClassInstance.aClassMethod.__self__.__class__</span></p>

<h5 style='margin-top:0in;margin-right:0in;margin-bottom:19.25pt;margin-left:
16.4pt'><span style='font-size:18.0pt;line-height:112%'>A.29. </span><span
style='font-size:18.0pt;line-height:112%;font-family:"Liberation Mono";
font-weight:normal'>__nonzero__ </span>SPECIAL METHOD</h5>

<p class=MsoNormal style='margin-left:16.4pt'>In Python 2, you could build your
own classes that could be used in a boolean context. For example, you could
instantiate the class and then use the instance in an <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>if </span>statement. To
do this, you defined a special</p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.9pt;margin-bottom:.25pt;
margin-left:16.4pt'><span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>__nonzero__() </span>method which returned <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>True </span>or
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>False</span>,
and it was called whenever the instance was used in a boolean context. In
Python 3, you can still do this, but the name of the method has changed to</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=736 height=166 src="Dive%20Into%20Python%203_files/image089.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:25.35pt;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=736 height=86 src="Dive%20Into%20Python%203_files/image090.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.05pt;margin-bottom:.25pt;
margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Instead of <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>__nonzero__()</span>, Python 3 calls the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__bool__()
</span>method when evaluating an instance in a boolean context.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.05pt;margin-bottom:24.9pt;
margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>However, if you have a <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>__nonzero__() </span>method that takes
arguments, the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>2to3
</span>tool will assume that you were using it for some other purpose, and it
will not make any changes.</p>

<h4 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>A.30.
O</span>CTAL LITERALS</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
9.35pt;margin-left:16.4pt;line-height:107%'>The syntax for defining base 8
(octal) numbers has changed slightly between Python 2 and Python 3.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:22.25pt;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=736 height=59 src="Dive%20Into%20Python%203_files/image091.gif"></span></p>

<h5 style='margin-top:0in;margin-right:0in;margin-bottom:19.9pt;margin-left:
16.4pt;line-height:107%'><span style='font-size:18.0pt;line-height:107%'>A.31. </span><span
style='font-size:18.0pt;line-height:107%;font-family:"Liberation Mono";
font-weight:normal'>sys.maxint</span></h5>

<p class=MsoNormal style='margin-top:0in;margin-right:1.55pt;margin-bottom:
2.55pt;margin-left:16.4pt'>Due to the <u>integration of the </u><u><span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>long </span>and
</u><u><span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>int
</span>types</u>, the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>sys.maxint </span>constant is no longer
accurate. Because the value may still be useful in determining
platform-specific capabilities, it has been retained but renamed as <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>sys.maxsize</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:26.2pt;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=736 height=88 src="Dive%20Into%20Python%203_files/image092.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.1in;
margin-left:16.65pt;text-indent:-16.65pt;line-height:110%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>maxint </span>becomes
<span style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>maxsize</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.15pt;
margin-left:16.65pt;text-indent:-16.65pt;line-height:110%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Any usage of <span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>sys.maxint
</span>becomes <span style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>sys.maxsize</span>.</p>

<h6 style='margin-top:0in;margin-right:0in;margin-bottom:19.65pt;margin-left:
16.4pt;line-height:112%'><span style='font-size:18.0pt;line-height:112%'>A.32. </span><span
style='font-size:18.0pt;line-height:112%;font-family:"Liberation Mono";
font-weight:normal'>callable() </span><span style='font-size:14.5pt;line-height:
112%'>GLOBAL FUNCTION</span></h6>

<p class=MsoNormal style='margin-left:16.4pt'>In Python 2, you could check
whether an object was callable (like a function) with the global <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>callable()
</span>function. In Python 3, this global function has been eliminated. To
check whether an object is callable, check for the existence of the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__call__()
</span>special method.</p>

</div>

<span style='font-size:12.0pt;line-height:154%;font-family:"Gill Sans MT",sans-serif;
color:black'><br clear=all style='page-break-before:always'>
</span>

<div class=WordSection27>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:28.5pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>         <img border=0
width=1 height=59 id="Group 761094"
src="Dive%20Into%20Python%203_files/image093.gif">                       <img
border=0 width=1 height=59 id="Group 761085"
src="Dive%20Into%20Python%203_files/image093.gif"></span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'> callable(anything)                      </span><span
style='font-size:11.0pt;line-height:110%;font-family:"Calibri",sans-serif'><img
border=0 width=1 height=59 id="Group 761092"
src="Dive%20Into%20Python%203_files/image093.gif"></span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>
hasattr(anything, '__call__')</span></p>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:19.75pt;margin-left:
16.4pt'><span style='font-size:18.0pt;line-height:112%'>A.33. </span><span
style='font-size:18.0pt;line-height:112%;font-family:"Liberation Mono";
font-weight:normal'>zip() </span>GLOBAL FUNCTION</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:2.9pt;
margin-left:16.4pt'>In Python 2, the global <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>zip() </span>function took any
number of sequences and returned a list of tuples. The first tuple contained
the first item from each sequence; the second tuple contained the second item
from each sequence; and so on. In Python 3, <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>zip() </span>returns an
iterator instead of a list.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-3.1pt;margin-bottom:
24.75pt;margin-left:16.65pt;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img
border=0 width=736 height=88 src="Dive%20Into%20Python%203_files/image094.gif"></span></p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>In the simplest
form, you can get the old behavior of the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>zip() </span>function by
wrapping the return value in a call to <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>list()</span>, which will run
through the iterator that <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>zip() </span>returns and return a real list of
the results.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:24.75pt;
margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span><img width=1 height=1 src="Dive%20Into%20Python%203_files/image095.gif"
align=left hspace=12>In contexts that already iterate through all the items of
a sequence (such as this call to the <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>join() </span>method), the iterator that <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>zip() </span>returns
will work just fine. The <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>2to3 </span>script is smart enough to detect
these cases and make no change to your code.</p>

<h5 style='margin-top:0in;margin-right:0in;margin-bottom:19.9pt;margin-left:
16.4pt;line-height:107%'><span style='font-size:18.0pt;line-height:107%'>A.34. </span><span
style='font-size:18.0pt;line-height:107%;font-family:"Liberation Mono";
font-weight:normal'>StandardError </span>EXCEPTION</h5>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
7.85pt;margin-left:16.4pt;line-height:107%'>In Python 2, <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>StandardError
</span>was the base class for all built-in exceptions other than <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>StopIteration</span>,</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:1.9pt;
margin-left:17.15pt;line-height:160%'><span style='font-size:10.0pt;line-height:
160%;font-family:"Liberation Mono"'>GeneratorExit</span>, <span
style='font-size:10.0pt;line-height:160%;font-family:"Liberation Mono"'>KeyboardInterrupt</span>,
and <span style='font-size:10.0pt;line-height:160%;font-family:"Liberation Mono"'>SystemExit</span>.
In Python 3, <span style='font-size:10.0pt;line-height:160%;font-family:"Liberation Mono"'>StandardError
</span>has been eliminated; use <span style='font-size:10.0pt;line-height:160%;
font-family:"Liberation Mono"'>Exception </span>instead.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-3.1pt;margin-bottom:
23.4pt;margin-left:16.65pt;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img
border=0 width=736 height=88 src="Dive%20Into%20Python%203_files/image096.gif"></span></p>

<h6 style='margin-top:0in;margin-right:0in;margin-bottom:19.75pt;margin-left:
16.4pt;line-height:112%'><span style='font-size:18.0pt;line-height:112%'>A.35. </span><span
style='font-size:18.0pt;line-height:112%;font-family:"Liberation Mono";
font-weight:normal'>types </span><span style='font-size:14.5pt;line-height:
112%'>MODULE CONSTANTS</span></h6>

<p class=MsoNormal style='margin-left:16.4pt'>The <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>types </span>module contains a
variety of constants to help you determine the type of an object. In Python 2,
it contained constants for all primitive types like <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>dict </span>and <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>int</span>.
In Python 3, these constants have been eliminated; just use the primitive type
name instead.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-3.1pt;margin-bottom:
46.3pt;margin-left:16.65pt;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img
border=0 width=736 height=581 src="Dive%20Into%20Python%203_files/image097.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:37.6pt;margin-bottom:
45.65pt;margin-left:75.95pt;text-indent:-29.3pt'><span style='font-size:24.0pt;
line-height:154%;font-family:"Calibri",sans-serif'>&#9758; </span><span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>types.StringType
</span>gets mapped to <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>bytes </span>instead of <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>str </span>because a
Python 2 “string” (not a Unicode string, just a regular string) is really just
a sequence of bytes in a particular character encoding.</p>

<h6 style='margin-top:0in;margin-right:0in;margin-bottom:19.65pt;margin-left:
16.4pt;line-height:112%'><span style='font-size:18.0pt;line-height:112%'>A.36. </span><span
style='font-size:18.0pt;line-height:112%;font-family:"Liberation Mono";
font-weight:normal'>isinstance() </span><span style='font-size:14.5pt;
line-height:112%'>GLOBAL FUNCTION</span></h6>

<p class=MsoNormal style='margin-left:16.4pt'>The <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>isinstance() </span>function
checks whether an object is an instance of a particular class or type. In
Python 2, you could pass a tuple of types, and <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>isinstance() </span>would
return <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>True
</span>if the object was any of those types. In Python 3, you can still do
this, but passing the same type twice is deprecated.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:28.1pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>         <img border=0
width=1 height=59 id="Group 761297"
src="Dive%20Into%20Python%203_files/image093.gif">                       <img
border=0 width=1 height=59 id="Group 761295"
src="Dive%20Into%20Python%203_files/image093.gif"></span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'> isinstance(x,
(int, float, int))        </span><span style='font-size:11.0pt;line-height:
110%;font-family:"Calibri",sans-serif'><img border=0 width=1 height=59
id="Group 761296" src="Dive%20Into%20Python%203_files/image093.gif"></span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>
isinstance(x, (int, float))</span></p>

<h5 style='margin-top:0in;margin-right:0in;margin-bottom:19.9pt;margin-left:
16.4pt;line-height:107%'><span style='font-size:18.0pt;line-height:107%'>A.37. </span><span
style='font-size:18.0pt;line-height:107%;font-family:"Liberation Mono";
font-weight:normal'>basestring </span>DATATYPE</h5>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:2.9pt;
margin-left:16.4pt'>Python 2 had two string types: Unicode and non-Unicode. But
there was also another type, <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>basestring</span>. It was an abstract type, a
superclass for both the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>str </span>and <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>unicode </span>types. It
couldn’t be called or instantiated directly, but you could pass it to the
global <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>isinstance()
</span>function to check whether an object was either a Unicode or non-Unicode
string. In Python 3, there is only one string type, so <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>basestring </span>has no
reason to exist.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-3.1pt;margin-bottom:
22.9pt;margin-left:16.65pt;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img
border=0 width=736 height=59 src="Dive%20Into%20Python%203_files/image098.gif"></span></p>

<h5 style='margin-top:0in;margin-right:0in;margin-bottom:19.9pt;margin-left:
16.4pt;line-height:107%'><span style='font-size:18.0pt;line-height:107%'>A.38. </span><span
style='font-size:18.0pt;line-height:107%;font-family:"Liberation Mono";
font-weight:normal'>itertools </span>MODULE</h5>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:2.85pt;
margin-left:16.4pt'><img width=1 height=1
src="Dive%20Into%20Python%203_files/image095.gif" align=left hspace=12>Python
2.3 introduced the <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>itertools </span>module, which defined variants of the
global <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>zip()</span>,
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>map()</span>,
and <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>filter()
</span>functions that returned iterators instead of lists. In Python 3, those
global functions return iterators, so those functions in the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>itertools
</span>module have been eliminated. (There are still <u>lots of useful
functions in the </u><u><span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>itertools </span>module</u>, just not these.)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:-3.1pt;margin-bottom:
25.7pt;margin-left:16.65pt;text-indent:0in;line-height:107%'><span
style='font-size:11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img
border=0 width=736 height=147 src="Dive%20Into%20Python%203_files/image099.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:7.6pt;
margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Instead of <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>itertools.izip()</span>,
just use the global <span style='font-size:10.0pt;line-height:107%;font-family:
"Liberation Mono"'>zip() </span>function.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:8.25pt;
margin-left:16.65pt;text-indent:-16.65pt;line-height:110%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Instead of <span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>itertools.imap()</span>,
just use <span style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>map()</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:5.95pt;
margin-left:16.65pt;text-indent:-16.65pt;line-height:110%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>itertools.ifilter()
</span>becomes <span style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>filter()</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.7pt;margin-bottom:.25pt;
margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>itertools
</span>module still exists in Python 3, it just doesn’t have the functions that
have migrated to the global namespace. The <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>2to3 </span>script is smart
enough to remove the specific imports that no longer exist, while leaving other
imports intact.</p>

</div>

<span style='font-size:12.0pt;line-height:154%;font-family:"Gill Sans MT",sans-serif;
color:black'><br clear=all style='page-break-before:always'>
</span>

<div class=WordSection28>

<h5 style='margin-top:0in;margin-right:0in;margin-bottom:19.9pt;margin-left:
16.4pt;line-height:107%'><span style='font-size:18.0pt;line-height:107%'>A.39. </span><span
style='font-size:18.0pt;line-height:107%;font-family:"Liberation Mono";
font-weight:normal'>sys.exc_type</span><span style='font-size:18.0pt;
line-height:107%'>, </span><span style='font-size:18.0pt;line-height:107%;
font-family:"Liberation Mono";font-weight:normal'>sys.exc_value</span><span
style='font-size:18.0pt;line-height:107%'>, </span><span style='font-size:18.0pt;
line-height:107%;font-family:"Liberation Mono";font-weight:normal'>sys.exc_traceback</span></h5>

<p class=MsoNormal style='margin-left:16.4pt'>Python 2 had three variables in
the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>sys
</span>module that you could access while an exception was being handled: <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>sys.exc_type</span>,
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>sys.exc_value</span>,
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>sys.exc_traceback</span>.
(Actually, these date all the way back to Python 1.) Ever since Python 1.5, these
variables have been deprecated in favor of <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>sys.exc_info</span>, which is a
tuple that contains all three values. In Python 3, these individual variables
have finally gone away; you must use</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:23.7pt;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=736 height=168 src="Dive%20Into%20Python%203_files/image100.gif"></span></p>

<h4 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>A.40.
L</span>IST COMPREHENSIONS OVER TUPLES</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:2.95pt;
margin-left:16.4pt'>In Python 2, if you wanted to code a list comprehension
that iterated over a tuple, you did not need to put parentheses around the
tuple values. In Python 3, explicit parentheses are required.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:23.0pt;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=736 height=59 src="Dive%20Into%20Python%203_files/image101.gif"></span></p>

<h5 style='margin-top:0in;margin-right:0in;margin-bottom:19.9pt;margin-left:
16.4pt;line-height:107%'><span style='font-size:18.0pt;line-height:107%'>A.41. </span><span
style='font-size:18.0pt;line-height:107%;font-family:"Liberation Mono";
font-weight:normal'>os.getcwdu() </span>FUNCTION</h5>

<p class=MsoNormal style='margin-left:16.4pt'>Python 2 had a function named <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>os.getcwd()</span>,
which returned the current working directory as a (nonUnicode) string. Because
modern file systems can handle directory names in any character encoding,
Python</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
2.85pt;margin-left:16.4pt'>2.3 introduced <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>os.getcwdu()</span>. The <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>os.getcwdu()
</span>function returned the current working directory as a Unicode string. In
Python 3, there is <u>only one string type (Unicode)</u>, so <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>os.getcwd()
</span>is all you need.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=736 height=59 src="Dive%20Into%20Python%203_files/image102.gif"></span></p>

<h4 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>A.42.
M</span>ETACLASSES</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:4.25pt;margin-bottom:
2.9pt;margin-left:16.4pt'>In Python 2, you could create metaclasses either by
defining the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>metaclass
</span>argument in the class declaration, or by defining a special class-level <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__metaclass__
</span>attribute. In Python 3, the class-level attribute has been eliminated.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:24.55pt;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=737 height=201 src="Dive%20Into%20Python%203_files/image103.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.0pt;
margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Declaring the
metaclass in the class declaration worked in Python 2, and it still works the
same in Python 3.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.1pt;
margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Declaring the
metaclass in a class attribute worked in Python 2, but doesn’t work in Python
3.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:24.95pt;
margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>2to3
</span>script is smart enough to construct a valid class declaration, even if
the class is inherited from one or more base classes.</p>

<h4 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>A.43.
M</span>ATTERS OF STYLE</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:1.3pt;margin-bottom:22.1pt;
margin-left:16.4pt'>The rest of the “fixes” listed here aren’t really fixes per
se. That is, the things they change are matters of style, not substance. They
work just as well in Python 3 as they do in Python 2, but the developers of
Python have a vested interest in making Python code as uniform as possible. To
that end, there is an <a href="http://www.python.org/dev/peps/pep-0008/"><span
style='color:black'>official </span></a><a
href="http://www.python.org/dev/peps/pep-0008/"><span style='color:black'>Python</span></a><u>
</u><a href="http://www.python.org/dev/peps/pep-0008/"><span style='color:black'>style</span></a><u>
</u><a href="http://www.python.org/dev/peps/pep-0008/"><span style='color:black'>guide</span></a><u>
</u>which outlines — in excruciating detail — all sorts of nitpicky details
that you almost certainly don’t care about. And given that <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>2to3 </span>provides
such a great infrastructure for converting Python code from one thing to
another, the authors took it upon themselves to add a few optional features to
improve the readability of your Python programs.</p>

<h5 style='margin-top:0in;margin-right:0in;margin-bottom:27.3pt;margin-left:
16.4pt;line-height:110%'><span style='font-size:13.0pt;line-height:110%'>A.43.1.
</span><span style='font-size:13.0pt;line-height:110%;font-family:"Liberation Mono";
font-weight:normal'>set() </span><span style='font-size:10.5pt;line-height:
110%'>LITERALS </span><span style='font-size:13.0pt;line-height:110%'>(</span><span
style='font-size:10.5pt;line-height:110%'>EXPLICIT</span><span
style='font-size:13.0pt;line-height:110%'>)</span></h5>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:47.3pt;
margin-left:16.4pt'>In Python 2, the only way to define a literal set in your
code was to call <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>set(a_sequence)</span>. This still works in Python 3, but a
clearer way of doing it is to use the new set literal notation: curly braces.
This works for everything except empty sets, because dictionaries also use
curly braces, so <u><span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>{} </span>is an empty dictionary, not an empty set</u>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
17.85pt;margin-left:75.95pt;text-indent:-29.3pt;line-height:207%'><span
style='font-size:24.0pt;line-height:207%;font-family:"Calibri",sans-serif'>&#9758;
</span>The <span style='font-size:10.0pt;line-height:207%;font-family:"Liberation Mono"'>2to3
</span>script will not fix <span style='font-size:10.0pt;line-height:207%;
font-family:"Liberation Mono"'>set() </span>literals by default. To enable this
fix, specify <span style='font-size:10.0pt;line-height:207%;font-family:"Liberation Mono"'>-f
set_literal </span>on the command line when you call <span style='font-size:
10.0pt;line-height:207%;font-family:"Liberation Mono"'>2to3</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:24.4pt;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=736 height=117 src="Dive%20Into%20Python%203_files/image104.gif"></span></p>

<h5 style='margin-top:0in;margin-right:0in;margin-bottom:26.75pt;margin-left:
16.4pt;line-height:110%'><span style='font-size:13.0pt;line-height:110%'>A.43.2.
</span><span style='font-size:13.0pt;line-height:110%;font-family:"Liberation Mono";
font-weight:normal'>buffer() </span><span style='font-size:10.5pt;line-height:
110%'>GLOBAL FUNCTION </span><span style='font-size:13.0pt;line-height:110%'>(</span><span
style='font-size:10.5pt;line-height:110%'>EXPLICIT</span><span
style='font-size:13.0pt;line-height:110%'>)</span></h5>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:47.4pt;
margin-left:16.4pt'>Python objects implemented in C can export a “buffer
interface,” which allows other Python code to directly read and write a block
of memory. (That is exactly as powerful and scary as it sounds.) In Python 3, <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>buffer()
</span>has been renamed to <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>memoryview()</span>. (It’s a little more
complicated than that, but you can almost certainly ignore the differences.)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:55.4pt;margin-bottom:
19.7pt;margin-left:75.95pt;text-indent:-29.3pt;line-height:194%'><span
style='font-size:24.0pt;line-height:194%;font-family:"Calibri",sans-serif'>&#9758;
</span>The <span style='font-size:10.0pt;line-height:194%;font-family:"Liberation Mono"'>2to3
</span>script will not fix the <span style='font-size:10.0pt;line-height:194%;
font-family:"Liberation Mono"'>buffer() </span>function by default. To enable
this fix, specify <span style='font-size:10.0pt;line-height:194%;font-family:
"Liberation Mono"'>-f buffer </span>on the command line when you call <span
style='font-size:10.0pt;line-height:194%;font-family:"Liberation Mono"'>2to3</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:24.55pt;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=736 height=59 src="Dive%20Into%20Python%203_files/image105.gif"></span></p>

<h5 style='margin-top:0in;margin-right:0in;margin-bottom:25.25pt;margin-left:
16.4pt;line-height:110%'><span style='font-size:13.0pt;line-height:110%'>A.43.3.
W</span><span style='font-size:10.5pt;line-height:110%'>HITESPACE AROUND COMMAS
</span><span style='font-size:13.0pt;line-height:110%'>(</span><span
style='font-size:10.5pt;line-height:110%'>EXPLICIT</span><span
style='font-size:13.0pt;line-height:110%'>)</span></h5>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:46.9pt;
margin-left:16.4pt'>Despite being draconian about whitespace for indenting and
outdenting, Python is actually quite liberal about whitespace in other areas.
Within lists, tuples, sets, and dictionaries, whitespace can appear before and
after commas with no ill effects. However, the Python style guide states that
commas should be preceded by zero spaces and followed by one. Although this is
purely an aesthetic issue (the code works either way, in both Python 2 and
Python 3), the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>2to3
</span>script can optionally fix this for you.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.6pt;margin-left:75.95pt;text-indent:-29.3pt;line-height:195%'><span
style='font-size:24.0pt;line-height:195%;font-family:"Calibri",sans-serif'>&#9758;
</span>The <span style='font-size:10.0pt;line-height:195%;font-family:"Liberation Mono"'>2to3
</span>script will not fix whitespace around commas by default. To enable this
fix, specify <span style='font-size:10.0pt;line-height:195%;font-family:"Liberation Mono"'>-f
wscomma </span>on the command line when you call <span style='font-size:10.0pt;
line-height:195%;font-family:"Liberation Mono"'>2to3</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:24.35pt;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=736 height=88 src="Dive%20Into%20Python%203_files/image106.gif"></span></p>

<h5 style='margin-top:0in;margin-right:0in;margin-bottom:25.25pt;margin-left:
16.4pt;line-height:110%'><span style='font-size:13.0pt;line-height:110%'>A.43.4.
C</span><span style='font-size:10.5pt;line-height:110%'>OMMON IDIOMS </span><span
style='font-size:13.0pt;line-height:110%'>(</span><span style='font-size:10.5pt;
line-height:110%'>EXPLICIT</span><span style='font-size:13.0pt;line-height:
110%'>)</span></h5>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:46.95pt;
margin-left:16.4pt'>There were a number of common idioms built up in the Python
community. Some, like the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>while 1: </span>loop, date back to Python 1.
(Python didn’t have a true boolean type until version 2.3, so developers used <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>1 </span>and
0 instead.) Modern Python programmers should train their brains to use modern
versions of these idioms instead.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
18.1pt;margin-left:75.95pt;text-indent:-29.3pt;line-height:205%'><span
style='font-size:24.0pt;line-height:205%;font-family:"Calibri",sans-serif'>&#9758;
</span>The <span style='font-size:10.0pt;line-height:205%;font-family:"Liberation Mono"'>2to3
</span>script will not fix common idioms by default. To enable this fix,
specify <span style='font-size:10.0pt;line-height:205%;font-family:"Liberation Mono"'>-f
idioms </span>on the command line when you call <span style='font-size:10.0pt;
line-height:205%;font-family:"Liberation Mono"'>2to3</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=736 height=230 src="Dive%20Into%20Python%203_files/image107.gif"></span></p>

<h3 style='margin-top:0in;margin-right:22.2pt;margin-bottom:0in;margin-left:
16.4pt;line-height:107%'><span style='font-size:24.0pt;line-height:107%'>A</span><span
style='font-size:19.0pt;line-height:107%'>PPENDIX </span><span
style='font-size:24.0pt;line-height:107%'>B. S</span><span style='font-size:
19.0pt;line-height:107%'>PECIAL </span><span style='font-size:24.0pt;
line-height:107%'>M</span><span style='font-size:19.0pt;line-height:107%'>ETHOD
</span><span style='font-size:24.0pt;line-height:107%'>N</span><span
style='font-size:19.0pt;line-height:107%'>AMES</span></h3>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:39.95pt;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=736 height=4 id="Group 755091"
src="Dive%20Into%20Python%203_files/image001.gif"></span></p>

<p class=MsoNormal align=right style='margin-top:0in;margin-right:0in;
margin-bottom:65.45pt;margin-left:265.6pt;text-align:right;line-height:160%'><span
style='font-size:13.0pt;line-height:160%;font-family:"Calibri",sans-serif'>&#10077;
</span><i>My specialty is being right when other people are wrong. </i><span
style='font-size:13.0pt;line-height:160%;font-family:"Calibri",sans-serif'>&#10078;
</span><i>— </i><a href="http://en.wikiquote.org/wiki/George_Bernard_Shaw"><i><span
style='color:black'>George</span></i></a><i><u> </u></i><a
href="http://en.wikiquote.org/wiki/George_Bernard_Shaw"><i><span
style='color:black'>Bernard</span></i></a><i><u> </u></i><a
href="http://en.wikiquote.org/wiki/George_Bernard_Shaw"><i><span
style='color:black'>Shaw</span></i></a></p>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:66.45pt;margin-left:
16.4pt'><span style='font-size:18.0pt;line-height:112%'>B.1. D</span>IVING <span
style='font-size:18.0pt;line-height:112%'>I</span>N</h4>

<p class=MsoNormal style='margin-left:16.4pt;line-height:107%'><span
style='font-size:48.0pt;line-height:107%;font-family:"DejaVu Serif",serif;
color:#888888'>T </span>hroughout this book, you’ve seen examples of “special
methods” — certain “magic” methods that</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:24.3pt;
margin-left:16.4pt'>Python invokes when you use certain syntax. Using special
methods, your classes can act like sequences, like dictionaries, like
functions, like iterators, or even like numbers. This appendix serves both as a
reference for the special methods we’ve seen already and a brief introduction
to some of the more esoteric ones.</p>

<h4 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>B.2.
B</span>ASICS</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:2.95pt;
margin-left:16.4pt'>If you’ve read the <u>introduction to classes</u>, you’ve
already seen the most common special method: the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>__init__() </span>method. The
majority of classes I write end up needing some initialization. There are also
a few other basic special methods that are especially useful for debugging your
custom classes.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:24.9pt;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=736 height=232 src="Dive%20Into%20Python%203_files/image108.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__init__()
</span>method is called <i>after </i>the instance is created. If you want to
control the actual creation process, use <u>the </u><u><span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>__new__() </span>method</u>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>By convention,
the <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>__repr__()
</span>method should return a string that is a valid Python expression.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.35pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>__str__()
</span>method is also called when you <span style='font-size:10.0pt;line-height:
107%;font-family:"Liberation Mono"'>print(x)</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.75pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><i>New in Python
3</i>, since the <span style='font-size:10.0pt;line-height:107%;font-family:
"Liberation Mono"'>bytes </span>type was introduced.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
25.0pt;margin-left:16.65pt;text-indent:-16.65pt'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>By convention, <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>format_spec </span>should conform to the <a
href="http://www.python.org/doc/3.1/library/string.html#formatspec"><span
style='color:black'>Format</span></a><u> </u><a
href="http://www.python.org/doc/3.1/library/string.html#formatspec"><span
style='color:black'>Specification</span></a><u> </u><a
href="http://www.python.org/doc/3.1/library/string.html#formatspec"><span
style='color:black'>Mini-Language</span></a>. <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>decimal.py </span>in the Python
standard library provides its own <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>__format__() </span>method.</p>

<h4 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>B.3.
C</span>LASSES <span style='font-size:18.0pt;line-height:112%'>T</span>HAT <span
style='font-size:18.0pt;line-height:112%'>A</span>CT <span style='font-size:
18.0pt;line-height:112%'>L</span>IKE <span style='font-size:18.0pt;line-height:
112%'>I</span>TERATORS</h4>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:3.35pt;
margin-bottom:.25pt;margin-left:.5pt;text-align:center;line-height:107%'>In <u>the
Iterators chapter</u>, you saw how to build an iterator from the ground up
using the <span style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>__iter__()
</span>and</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:24.9pt;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=736 height=253 src="Dive%20Into%20Python%203_files/image109.gif"></span></p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__iter__()
</span>method is called whenever you create a new iterator. It’s a good place
to initialize the iterator with initial values.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.5pt;
margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>__next__()
</span>method is called whenever you retrieve the next value from an iterator.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:20.7pt;
margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__reversed__()
</span>method is uncommon. It takes an existing sequence and returns an
iterator that yields the items in the sequence in reverse order, from last to
first.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
20.0pt;margin-left:16.4pt'>As you saw in <u>the Iterators chapter</u>, a <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>for </span>loop
can act on an iterator. In this loop:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>for x in seq:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.9pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>print(x)</span></p>

<p class=MsoNormal style='margin-left:16.4pt'>Python 3 will call <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>seq.__iter__()
</span>to create an iterator, then call the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>__next__() </span>method on
that iterator to get each value of <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>x</span>. When the <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>__next__() </span>method
raises a <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>StopIteration
</span>exception, the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>for </span>loop ends gracefully.</p>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:0in;margin-left:16.4pt'><span
style='font-size:18.0pt;line-height:112%'>B.4. C</span>OMPUTED <span
style='font-size:18.0pt;line-height:112%'>A</span>TTRIBUTES</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:.35in;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=736 height=287 src="Dive%20Into%20Python%203_files/image110.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.8pt;margin-bottom:.25pt;
margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>If your class defines a <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>__getattribute__() </span>method, Python will
call it on <i>every reference to any attribute or method name </i>(except
special method names, since that would cause an unpleasant infinite loop).</p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.8pt;margin-bottom:.25pt;
margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>If your class defines a <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>__getattr__() </span>method, Python will call it
only after looking for the attribute in all the normal places. If an instance <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>x </span>defines
an attribute <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>color</span>,
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>x.color
</span>will <i>not </i>call</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.55pt;margin-left:16.4pt;line-height:107%'><span style='font-size:10.0pt;
line-height:107%;font-family:"Liberation Mono"'>x.__getattr__('color')</span>;
it will simply return the already-defined value of <span style='font-size:10.0pt;
line-height:107%;font-family:"Liberation Mono"'>x.color</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.8pt;margin-bottom:6.7pt;
margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>__setattr__()
</span>method is called whenever you assign a value to an attribute.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.8pt;margin-bottom:7.35pt;
margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>__delattr__()
</span>method is called whenever you delete an attribute.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.8pt;margin-bottom:.3in;
margin-left:16.65pt;text-indent:-16.65pt'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__dir__()
</span>method is useful if you define a <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>__getattr__() </span>or <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__getattribute__()
</span>method. Normally, calling <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>dir(x) </span>would only list the regular
attributes and methods. If your <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>__getattr__() </span>method handles a <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>color </span>attribute
dynamically, <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>dir(x)
</span>would not list <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>color </span>as one of the available attributes.
Overriding the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__dir__()
</span>method allows you to list <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>color </span>as an available attribute,
which is helpful for other people who wish to use your class without digging
into the internals of it.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.25pt;margin-bottom:
.25pt;margin-left:16.4pt'>The distinction between the <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>__getattr__() </span>and
<span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__getattribute__()
</span>methods is subtle but important. I can explain it with two examples:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>class Dynamo:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.55pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def __getattr__(self, key):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:273.65pt;margin-bottom:
0in;margin-left:110.2pt;text-indent:-24.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>if key
== 'color':    </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9312; </span><span style='font-size:10.0pt;line-height:185%;
font-family:"Liberation Mono"'>return 'PapayaWhip'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.6pt;
margin-left:86.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>else:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:26.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                                                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>raise
AttributeError   </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.45pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>dyn =
Dynamo()</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>dyn.color                      </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'PapayaWhip'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.45pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>dyn.color
= 'LemonChiffon'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>dyn.color                      </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9315;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.8pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'LemonChiffon'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.15pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The attribute name is passed into the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>__getattr__() </span>method as
a string. If the name is <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>'color'</span>, the method returns a value. (In
this case, it’s just a hard-coded string, but you would normally do some sort
of computation and return the result.)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.15pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>If the attribute name is unknown, the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>__getattr__() </span>method
needs to raise an <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>AttributeError </span>exception, otherwise your code will
silently fail when accessing undefined attributes. (Technically, if the method
doesn’t raise an exception or explicitly return a value, it returns <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>None</span>,
the Python null value. This means that <i>all </i>attributes not explicitly
defined will be <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>None</span>, which is almost certainly not what you want.)</p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.15pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>dyn
</span>instance does not have an attribute named <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>color</span>, so the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__getattr__()
</span>method is called to provide a computed value.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:2.15pt;margin-bottom:
21.25pt;margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>After explicitly setting <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>dyn.color</span>, the <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>__getattr__() </span>method
will no longer be called to provide a value for <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>dyn.color</span>, because <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>dyn.color
</span>is already defined on the instance.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>On the other hand, the <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>__getattribute__()
</span>method is absolute and unconditional.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>class SuperDynamo:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def __getattribute__(self, key):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:86.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>if key == 'color':</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:314.45pt;margin-bottom:
0in;margin-left:86.2pt;text-indent:24.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>return
'PapayaWhip' else:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:110.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>raise AttributeError</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.45pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>dyn =
SuperDynamo()</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>dyn.color                      </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'PapayaWhip'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.45pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>dyn.color
= 'LemonChiffon'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>dyn.color                      </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:32.35pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'PapayaWhip'</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:15.25pt;margin-bottom:
6.9pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>__getattribute__()
</span>method is called to provide a value for <span style='font-size:10.0pt;
line-height:107%;font-family:"Liberation Mono"'>dyn.color</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:15.25pt;margin-bottom:
47.65pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Even after explicitly setting <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>dyn.color</span>, the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__getattribute__()
</span>method <i>is still called </i>to provide a value for <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>dyn.color</span>.
If present, the <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>__getattribute__() </span>method <i>is called
unconditionally </i>for every attribute and method lookup, even for attributes
that you explicitly set after creating an instance.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:61.75pt;margin-bottom:
41.95pt;margin-left:75.95pt;text-indent:-29.3pt'><span style='font-size:24.0pt;
line-height:154%;font-family:"Calibri",sans-serif'>&#9758; </span>If your class
defines a <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__getattribute__()
</span>method, you probably also want to define a <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>__setattr__() </span>method and
coordinate between them to keep track of attribute values. Otherwise, any
attributes you set after creating an instance will disappear into a black hole.</p>

<p class=MsoNormal style='margin-left:16.4pt'>You need to be extra careful with
the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__getattribute__()
</span>method, because it is also called when Python looks up a method name on
your class.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>class Rastan:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.6pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def __getattribute__(self, key):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:285.65pt;margin-bottom:
21.3pt;margin-left:62.15pt;text-align:justify;text-justify:inter-ideograph;
text-indent:24.0pt;line-height:182%'><span style='font-size:10.0pt;line-height:
182%;font-family:"Liberation Mono"'>raise AttributeError </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312; </span><span
style='font-size:10.0pt;line-height:182%;font-family:"Liberation Mono"'>def
swim(self): pass</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.5pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>hero =
Rastan()</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:#666677'>&gt;&gt;&gt; </span><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>hero.swim()                        </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9313;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>Traceback (most
recent call last):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>File
&quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
8.5pt;margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>File
&quot;&lt;stdin&gt;&quot;, line 3, in __getattribute__</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:116.45pt;margin-bottom:
32.15pt;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:#880000'>AttributeError</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:15.25pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>This class defines a <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>__getattribute__() </span>method which always
raises an <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>AttributeError
</span>exception. No attribute or method lookups will succeed.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:15.25pt;margin-bottom:
1.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>When you call <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>hero.swim()</span>, Python looks for a <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>swim() </span>method
in the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>Rastan
</span>class. This lookup goes through the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>__getattribute__() </span>method,
<i>because all attribute and method lookups go through the</i></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
25.05pt;margin-left:16.4pt'><span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>__getattribute__() </span><i>method</i>. In this
case, the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__getattribute__()
</span>method raises an <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>AttributeError </span>exception, so the method
lookup fails, so the method call fails.</p>

<h4 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>B.5.
C</span>LASSES <span style='font-size:18.0pt;line-height:112%'>T</span>HAT <span
style='font-size:18.0pt;line-height:112%'>A</span>CT <span style='font-size:
18.0pt;line-height:112%'>L</span>IKE <span style='font-size:18.0pt;line-height:
112%'>F</span>UNCTIONS</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>You can make an instance of a class
callable — exactly like a function is callable — by defining the</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:24.8pt;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=736 height=139 src="Dive%20Into%20Python%203_files/image111.gif"></span></p>

<p class=MsoNormal style='margin-left:16.4pt'>The <a
href="http://docs.python.org/3.1/library/zipfile.html"><span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono";color:black'>zipfile</span></a><u><span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'> </span></u><a
href="http://docs.python.org/3.1/library/zipfile.html"><span style='color:black'>module</span></a><u>
</u>uses this to define a class that can decrypt an encrypted zip file with a
given password. The zip decryption algorithm requires you to store state during
decryption. Defining the decryptor as a class allows you to maintain this state
within a single instance of the decryptor class. The state is initialized in
the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__init__()
</span>method and updated as the file is decrypted. But since the class is also
“callable” like a function, you can pass the instance as the first argument of
the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>map()
</span>function, like so:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:380.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'># excerpt from zipfile.py class
_ZipDecrypter: .</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def __init__(self, pwd):</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=334
 style='width:250.8pt;margin-left:62.15pt;border-collapse:collapse'>
 <tr style='height:112.8pt'>
  <td width=312 valign=top style='width:234.05pt;padding:0in 0in 0in 0in;
  height:112.8pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:66.05pt;margin-bottom:
  0in;margin-left:24.0pt;text-indent:0in;line-height:185%'><span
  style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>self.key0
  = 305419896 self.key1 = 591751049 self.key2 = 878082192 for p in pwd:</span></p>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
  margin-left:48.0pt;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>self._UpdateKeys(p)</span></p>
  </td>
  <td width=22 valign=top style='width:16.75pt;padding:0in 0in 0in 0in;
  height:112.8pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
  margin-left:6.0pt;text-align:justify;text-justify:inter-ideograph;text-indent:
  0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9312;</span></p>
  </td>
 </tr>
 <tr style='height:.4in'>
  <td width=312 valign=bottom style='width:234.05pt;padding:0in 0in 0in 0in;
  height:.4in'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>def
  __call__(self, c):</span></p>
  </td>
  <td width=22 valign=bottom style='width:16.75pt;padding:0in 0in 0in 0in;
  height:.4in'>
  <p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
  margin-left:6.0pt;text-align:justify;text-justify:inter-ideograph;text-indent:
  0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9313;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:326.45pt;margin-bottom:
0in;margin-left:86.7pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>assert isinstance(c, int) k =
self.key2 | 2</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:278.45pt;margin-bottom:
0in;margin-left:86.7pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>c = c ^ (((k * (k^1)) &gt;&gt;
8) &amp; 255) self._UpdateKeys(c) return c</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:518.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono"'>. .</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=358
 style='width:268.8pt;margin-left:38.15pt;border-collapse:collapse'>
 <tr style='height:39.3pt'>
  <td width=344 valign=top style='width:258.05pt;padding:0in 0in 0in 0in;
  height:39.3pt'>
  <p class=MsoNormal style='margin-top:0in;margin-right:90.05pt;margin-bottom:
  0in;margin-left:0in;text-indent:0in;line-height:107%'><span style='font-size:
  10.0pt;line-height:107%;font-family:"Liberation Mono"'>zd =
  _ZipDecrypter(pwd) bytes = zef_file.read(12)</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:39.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9314;</span></p>
  </td>
 </tr>
 <tr style='height:18.3pt'>
  <td width=344 valign=bottom style='width:258.05pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>h =
  list(map(zd, bytes[0:12]))</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9315;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:7.15pt;
margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>_ZipDecryptor
</span>class maintains state in the form of three rotating keys, which are
later updated in the</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.35pt;margin-left:16.4pt;line-height:107%'><span style='font-size:10.0pt;
line-height:107%;font-family:"Liberation Mono"'>_UpdateKeys() </span>method
(not shown here).</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The class
defines a <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__call__()
</span>method, which makes class instances callable like functions. In this
case, the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__call__()
</span>method decrypts a single byte of the zip file, then updates the rotating
keys based on the byte that was decrypted.</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>zd </span>is
an instance of the <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>_ZipDecryptor </span>class. The <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>pwd </span>variable is passed
to the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__init__()
</span>method, where it is stored and used to update the rotating keys for the
first time.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:25.0pt;
margin-left:16.65pt;text-indent:-16.65pt'>4.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Given the first 12 bytes of a zip file, decrypt them by mapping the
bytes to <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>zd</span>,
in effect “calling” <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>zd </span>12 times, which invokes the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__call__()
</span>method 12 times, which updates its internal state and returns a
resulting byte 12 times.</p>

<h4 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>B.6.
C</span>LASSES <span style='font-size:18.0pt;line-height:112%'>T</span>HAT <span
style='font-size:18.0pt;line-height:112%'>A</span>CT <span style='font-size:
18.0pt;line-height:112%'>L</span>IKE <span style='font-size:18.0pt;line-height:
112%'>S</span>EQUENCES</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:2.95pt;
margin-left:16.4pt'>If your class acts as a container for a set of values —
that is, if it makes sense to ask whether your class “contains” a value — then
it should probably define the following special methods that make it act like a
sequence.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:25.1pt;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=737 height=117 src="Dive%20Into%20Python%203_files/image112.gif"></span></p>

<p class=MsoNormal style='margin-left:16.4pt'>The <a
href="http://docs.python.org/3.1/library/cgi.html"><span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono";color:black'>cgi</span></a><u><span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'> </span></u><a
href="http://docs.python.org/3.1/library/cgi.html"><span style='color:black'>module</span></a><u>
</u>uses these methods in its <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>FieldStorage </span>class, which represents all
of the form fields or query parameters submitted to a dynamic web page.<br
clear=all style='page-break-before:always'>
</p>

<p class=MsoNormal style='margin-top:0in;margin-right:134.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'># A script which responds to
http://example.com/search?q=cgi import cgi</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.5pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>fs = cgi.FieldStorage()</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                 </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>if 'q'
in fs:                                               </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.5pt;
margin-left:50.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>do_search()</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:212.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'># An excerpt from cgi.py that
explains how that works class FieldStorage: .</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:147.65pt;margin-bottom:
0in;margin-left:86.15pt;text-indent:-24.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>def
__contains__(self, key):    </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9313; </span><span style='font-size:10.0pt;line-height:185%;
font-family:"Liberation Mono"'>if self.list is None:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.7pt;
margin-left:110.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>raise TypeError('not indexable')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:30.7pt;
margin-left:86.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>return any(item.name == key for item in
self.list) </span><span style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:123.65pt;margin-bottom:
19.1pt;margin-left:86.15pt;text-indent:-24.0pt;line-height:180%'><span
style='font-size:10.0pt;line-height:180%;font-family:"Liberation Mono"'>def
__len__(self):  </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9315; </span><span style='font-size:10.0pt;line-height:180%;
font-family:"Liberation Mono"'>return len(self.keys())     </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9316;</span></p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Once you create
an instance of the <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>cgi.FieldStorage </span>class, you can use the “<span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>in</span>”
operator to check whether a particular parameter was included in the query
string.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.95pt;
margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>2.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>__contains__()
</span>method is the magic that makes this work.</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>When you say <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>if 'q'
in fs</span>, Python looks for the <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>__contains__() </span>method on the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>fs </span>object,
which is defined in <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>cgi.py</span>. The value <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>'q' </span>is passed into the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__contains__()
</span>method as the <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>key </span>argument.</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>4.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The same <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>FieldStorage
</span>class also supports returning its length, so you can say <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>len(fs)
</span>and it will call the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>__len__() </span>method on the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>FieldStorage
</span>class to return the number of query parameters that it identified.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:25.05pt;
margin-left:16.65pt;text-indent:-16.65pt'>5.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>self.keys()
</span>method checks whether <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>self.list is None</span>, so the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__len__
</span>method doesn’t need to duplicate this error checking.</p>

<h4 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>B.7.
C</span>LASSES <span style='font-size:18.0pt;line-height:112%'>T</span>HAT <span
style='font-size:18.0pt;line-height:112%'>A</span>CT <span style='font-size:
18.0pt;line-height:112%'>L</span>IKE <span style='font-size:18.0pt;line-height:
112%'>D</span>ICTIONARIES</h4>

<p class=MsoNormal style='margin-left:16.4pt'>Extending the previous section a
bit, you can define classes that not only respond to the “<span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>in</span>”
operator and the <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>len() </span>function, but they act like full-blown
dictionaries, returning values based on keys.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:25.1pt;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=737 height=175 src="Dive%20Into%20Python%203_files/image113.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:19.05pt;
margin-left:16.4pt'>The <u><span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>FieldStorage </span>class </u>from the <a
href="http://docs.python.org/3.1/library/cgi.html"><span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono";color:black'>cgi</span></a><u><span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'> </span></u><a
href="http://docs.python.org/3.1/library/cgi.html"><span style='color:black'>module</span></a><u>
</u>also defines these special methods, which means you can do things like
this:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:134.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'># A script which responds to
http://example.com/search?q=cgi import cgi</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:380.45pt;margin-bottom:
4.05pt;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>fs = cgi.FieldStorage() if 'q'
in fs:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:26.7pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                      </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>do_search(fs['q'])                              </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9312;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:242.45pt;margin-bottom:
0in;margin-left:37.9pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'># An excerpt from cgi.py that
shows how it works class FieldStorage: .</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.65pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>.</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:207.65pt;margin-bottom:
0in;margin-left:86.15pt;text-indent:-24.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>def
__getitem__(self, key):     </span><span style='font-family:"DejaVu Sans",sans-serif;
color:#222222'>&#9313; </span><span style='font-size:10.0pt;line-height:185%;
font-family:"Liberation Mono"'>if self.list is None:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:110.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>raise TypeError('not indexable')</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:350.45pt;margin-bottom:
0in;margin-left:86.7pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>found = [] for item in
self.list:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:212.45pt;margin-bottom:
0in;margin-left:86.2pt;text-indent:24.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>if
item.name == key: found.append(item) if not found:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:332.45pt;margin-bottom:
0in;margin-left:86.2pt;text-indent:24.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>raise
KeyError(key) if len(found) == 1:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:338.45pt;margin-bottom:
0in;margin-left:86.2pt;text-indent:24.0pt;line-height:185%'><span
style='font-size:10.0pt;line-height:185%;font-family:"Liberation Mono"'>return
found[0] else:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:110.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>return found</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:15.25pt;margin-bottom:
6.95pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>The <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>fs </span>object
is an instance of <span style='font-size:10.0pt;line-height:107%;font-family:
"Liberation Mono"'>cgi.FieldStorage</span>, but you can still evaluate
expressions like <span style='font-size:10.0pt;line-height:107%;font-family:
"Liberation Mono"'>fs['q']</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:15.25pt;margin-bottom:
24.9pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span><span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>fs['q']
</span>invokes the <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>__getitem__() </span>method with the <span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono"'>key </span>parameter set
to <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>'q'</span>.
It then looks up in its internally maintained list of query parameters (<span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>self.list</span>)
for an item whose <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>.name </span>matches the given key.</p>

<h4 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>B.8.
C</span>LASSES <span style='font-size:18.0pt;line-height:112%'>T</span>HAT <span
style='font-size:18.0pt;line-height:112%'>A</span>CT <span style='font-size:
18.0pt;line-height:112%'>L</span>IKE <span style='font-size:18.0pt;line-height:
112%'>N</span>UMBERS</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:19.05pt;
margin-left:16.4pt'>Using the appropriate special methods, you can define your
own classes that act like numbers. That is, you can add them, subtract them,
and perform other mathematical operations on them. This is how fractions are
implemented — the <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>Fraction </span>class implements these special methods, then
you can do things like this:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>from
fractions import Fraction</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>x =
Fraction(1, 3)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>x / 3</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.05pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>Fraction(1, 9)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
9.35pt;margin-left:16.4pt;line-height:107%'>Here is the comprehensive list of
special methods you need to implement a number-like class.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=736 height=435 src="Dive%20Into%20Python%203_files/image114.gif"></span></p>

<p class=MsoNormal align=center style='margin-left:.5pt;text-align:center;
line-height:151%'>That’s all well and good if <span style='font-size:10.0pt;
line-height:151%;font-family:"Liberation Mono"'>x </span>is an instance of a
class that implements those methods. But what if it doesn’t implement one of
them? Or worse, what if it implements it, but it can’t handle certain kinds of
arguments?</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
19.9pt;margin-left:16.4pt'>For example:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>from
fractions import Fraction</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>x =
Fraction(1, 3)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono";color:#666677'>&gt;&gt;&gt; </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>1 / x</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:31.35pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>Fraction(3, 1)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:20.5pt;
margin-left:16.4pt'>This is <i>not </i>a case of taking a <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>Fraction
</span>and dividing it by an integer (as in the previous example). That case
was straightforward: <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>x / 3 </span>calls <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>x.__truediv__(3)</span>, and the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__truediv__()
</span>method of the <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>Fraction </span>class handles all the math. But integers
don’t “know” how to do arithmetic operations with fractions. So why does this
example work?</p>

<p class=MsoNormal style='margin-top:0in;margin-right:.5pt;margin-bottom:20.9pt;
margin-left:16.4pt'>There is a second set of arithmetic special methods with <i>reflected
operands</i>. Given an arithmetic operation that takes two operands (<i>e.g. </i><span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>x / y</span>),
there are two ways to go about it:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
6.35pt;margin-left:16.65pt;text-indent:-16.65pt;line-height:107%'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Tell <span
style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>x </span>to
divide itself by <span style='font-size:10.0pt;line-height:107%;font-family:
"Liberation Mono"'>y</span>, or</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.65pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>Tell <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>y
</span>to divide itself into <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>x</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:2.95pt;
margin-left:16.4pt'>The set of special methods above take the first approach:
given <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>x
/ y</span>, they provide a way for <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>x </span>to say “I know how to divide
myself by <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>y</span>.”
The following set of special methods tackle the second approach: they provide a
way for <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>y
</span>to say “I know how to be the denominator and divide myself into <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>x</span>.”</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=736 height=291 src="Dive%20Into%20Python%203_files/image115.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:24.7pt;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=736 height=147 src="Dive%20Into%20Python%203_files/image116.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
2.95pt;margin-left:16.4pt'>But wait! There’s more! If you’re doing “in-place”
operations, like <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>x /= 3</span>, there are even more special methods you can
define.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:24.55pt;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=736 height=406 src="Dive%20Into%20Python%203_files/image117.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:4.9pt;margin-bottom:21.65pt;
margin-left:16.4pt'>Note: for the most part, the in-place operation methods are
not required. If you don’t define an in-place method for a particular
operation, Python will try the methods. For example, to execute the expression <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>x /= y</span>,
Python will:</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>1.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Try calling <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>x.__itruediv__(y)</span>.
If this method is defined and returns a value other than <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>NotImplemented</span>,
we’re done.</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt;line-height:
151%'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Try
calling <span style='font-size:10.0pt;line-height:151%;font-family:"Liberation Mono"'>x.__truediv__(y)</span>.
If this method is defined and returns a value other than <span
style='font-size:10.0pt;line-height:151%;font-family:"Liberation Mono"'>NotImplemented</span>,
the old value of <span style='font-size:10.0pt;line-height:151%;font-family:
"Liberation Mono"'>x </span>is discarded and replaced with the return value,
just as if you had done <span style='font-size:10.0pt;line-height:151%;
font-family:"Liberation Mono"'>x = x / y </span>instead.</p>

<p class=MsoNormal style='margin-left:16.65pt;text-indent:-16.65pt'>3.<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span>Try calling <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>y.__rtruediv__(x)</span>.
If this method is defined and returns a value other than <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>NotImplemented</span>,
the old value of <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>x </span>is discarded and replaced with the return value.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:20.55pt;
margin-left:16.4pt'>So you only need to define in-place methods like the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__itruediv__()
</span>method if you want to do some special optimization for in-place
operands. Otherwise Python will essentially reformulate the in-place operand to
use a regular operand + a variable assignment.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
2.95pt;margin-left:16.4pt'>There are also a few “unary” mathematical operations
you can perform on number-like objects by themselves.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:23.15pt;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=736 height=520 src="Dive%20Into%20Python%203_files/image118.gif"></span></p>

<h4 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>B.9.
C</span>LASSES <span style='font-size:18.0pt;line-height:112%'>T</span>HAT <span
style='font-size:18.0pt;line-height:112%'>C</span>AN <span style='font-size:
18.0pt;line-height:112%'>B</span>E <span style='font-size:18.0pt;line-height:
112%'>C</span>OMPARED</h4>

<p class=MsoNormal style='margin-left:16.4pt'>I broke this section out from the
previous one because comparisons are not strictly the purview of numbers. Many
datatypes can be compared — strings, lists, even dictionaries. If you’re
creating your own class and it makes sense to compare your objects to other
objects, you can use the following special methods to implement comparisons.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:45.95pt;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=737 height=261 src="Dive%20Into%20Python%203_files/image119.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:59.7pt;margin-bottom:
45.6pt;margin-left:75.95pt;text-indent:-29.3pt'><span style='font-size:24.0pt;
line-height:154%;font-family:"Calibri",sans-serif'>&#9758; </span>If you define
a <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__lt__()
</span>method but no <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>__gt__() </span>method, Python will use the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__lt__()
</span>method with operands swapped. However, Python will not combine methods.
For example, if you define a <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>__lt__() </span>method and a <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__eq__()
</span>method and try to test whether <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>x &lt;= y</span>, Python will not call <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__lt__()
</span>and <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__eq__()
</span>in sequence. It will only call the <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>__le__() </span>method.</p>

<h4 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>B.10.
C</span>LASSES <span style='font-size:18.0pt;line-height:112%'>T</span>HAT <span
style='font-size:18.0pt;line-height:112%'>C</span>AN <span style='font-size:
18.0pt;line-height:112%'>B</span>E <span style='font-size:18.0pt;line-height:
112%'>S</span>ERIALIZED</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:4.3pt;margin-bottom:2.95pt;
margin-left:16.4pt'>Python supports <u>serializing and unserializing arbitrary
objects</u>. (Most Python references call this process “pickling” and
“unpickling.”) This can be useful for saving state to a file and restoring it
later. All of the <u>native datatypes </u>support pickling already. If you
create a custom class that you want to be able to pickle, read up on <a
href="http://docs.python.org/3.1/library/pickle.html"><span style='color:black'>the</span></a><u>
</u><a href="http://docs.python.org/3.1/library/pickle.html"><span
style='color:black'>pickle</span></a><u> </u><a
href="http://docs.python.org/3.1/library/pickle.html"><span style='color:black'>protocol</span></a><u>
</u>to see when and how the following special methods are called.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=737 height=232 src="Dive%20Into%20Python%203_files/image120.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:24.55pt;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=736 height=143 src="Dive%20Into%20Python%203_files/image121.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.8pt;margin-bottom:24.8pt;
margin-left:16.4pt'>* To recreate a serialized object, Python needs to create a
new object that looks like the serialized object, then set the values of all
the attributes on the new object. The <span style='font-size:10.0pt;line-height:
154%;font-family:"Liberation Mono"'>__getnewargs__() </span>method controls how
the object is created, then the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>__setstate__() </span>method controls how the
attribute values are restored.</p>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:19.9pt;margin-left:
16.4pt'><span style='font-size:18.0pt;line-height:112%'>B.11. C</span>LASSES <span
style='font-size:18.0pt;line-height:112%'>T</span>HAT <span style='font-size:
18.0pt;line-height:112%'>C</span>AN <span style='font-size:18.0pt;line-height:
112%'>B</span>E <span style='font-size:18.0pt;line-height:112%'>U</span>SED IN
A <span style='font-size:18.0pt;line-height:112%;font-family:"Liberation Mono";
font-weight:normal'>with </span><span style='font-size:18.0pt;line-height:112%'>B</span>LOCK</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:2.95pt;
margin-left:16.4pt'>A <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>with </span>block defines a <a
href="http://www.python.org/doc/3.1/library/stdtypes.html#typecontextmanager"><span
style='color:black'>runtime</span></a><u> </u><a
href="http://www.python.org/doc/3.1/library/stdtypes.html#typecontextmanager"><span
style='color:black'>context</span></a>; you “enter” the context when you
execute the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>with
</span>statement, and you “exit” the context after you execute the last
statement in the block.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=736 height=224 src="Dive%20Into%20Python%203_files/image122.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'># excerpt from io.py:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def _checkClosed(self, msg=None):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:206.45pt;margin-bottom:
0in;margin-left:62.65pt;line-height:185%'><span style='font-size:10.0pt;
line-height:185%;font-family:"Liberation Mono"'>'''Internal: raise an
ValueError if file is closed ''' if self.closed:</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:86.7pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>raise ValueError('I/O operation on closed
file.'</span></p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:207.45pt;
margin-bottom:29.5pt;margin-left:159.7pt;text-align:center;line-height:110%'><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>if msg
is None else msg)</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def __enter__(self):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'''Context management protocol.  Returns
self.'''</span></p>

<table class=TableGrid border=0 cellspacing=0 cellpadding=0 width=422
 style='width:4.4in;margin-left:62.15pt;border-collapse:collapse'>
 <tr style='height:18.3pt'>
  <td width=408 valign=top style='width:306.05pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>self._checkClosed()</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9312;</span></p>
  </td>
 </tr>
 <tr style='height:18.3pt'>
  <td width=408 valign=bottom style='width:306.05pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-indent:0in;line-height:107%'><span
  style='font-size:10.0pt;line-height:107%;font-family:"Liberation Mono"'>return
  self</span></p>
  </td>
  <td width=14 valign=top style='width:10.75pt;padding:0in 0in 0in 0in;
  height:18.3pt'>
  <p class=MsoNormal style='margin:0in;text-align:justify;text-justify:inter-ideograph;
  text-indent:0in;line-height:107%'><span style='font-family:"DejaVu Sans",sans-serif;
  color:#222222'>&#9313;</span></p>
  </td>
 </tr>
</table>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:8.25pt;
margin-left:37.9pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>def __exit__(self, *args):</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:12.45pt;
margin-left:62.65pt;line-height:110%'><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'>'''Context management protocol.  Calls
close()'''</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:29.35pt;
margin-left:0in;text-indent:0in;line-height:110%'><span style='font-size:11.0pt;
line-height:110%;font-family:"Calibri",sans-serif'>                            </span><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'>self.close()                                       </span><span
style='font-family:"DejaVu Sans",sans-serif;color:#222222'>&#9314;</span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.25pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The file object defines both an <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>__enter__() </span>and an <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__exit__()
</span>method. The <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>__enter__() </span>method checks that the file is open; if
it’s not, the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>_checkClosed()
</span>method raises an exception.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.25pt;margin-bottom:
.25pt;margin-left:16.65pt;text-indent:-16.65pt'>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>The <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__enter__()
</span>method should almost always return <span style='font-size:10.0pt;
line-height:154%;font-family:"Liberation Mono"'>self </span>— this is the
object that the <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>with </span>block will use to dispatch properties and
methods.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:3.25pt;margin-bottom:
.65in;margin-left:16.65pt;text-indent:-16.65pt'>3.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;
</span>After the <span style='font-size:10.0pt;line-height:154%;font-family:
"Liberation Mono"'>with </span>block, the file object automatically closes.
How? In the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__exit__()
</span>method, it calls <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>self.close()</span>.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:60.05pt;margin-bottom:
41.1pt;margin-left:75.95pt;text-indent:-29.3pt'><span style='font-size:24.0pt;
line-height:154%;font-family:"Calibri",sans-serif'>&#9758; </span>The <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__exit__()
</span>method will always be called, even if an exception is raised inside the <span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>with </span>block.
In fact, if an exception is raised, the exception information will be passed to
the <span style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'>__exit__()
</span>method. See <a
href="http://www.python.org/doc/3.1/reference/datamodel.html#with-statement-context-managers"><span
style='color:black'>With</span></a><u> </u><a
href="http://www.python.org/doc/3.1/reference/datamodel.html#with-statement-context-managers"><span
style='color:black'>Statement</span></a><u> </u><a
href="http://www.python.org/doc/3.1/reference/datamodel.html#with-statement-context-managers"><span
style='color:black'>Context</span></a><u> </u><a
href="http://www.python.org/doc/3.1/reference/datamodel.html#with-statement-context-managers"><span
style='color:black'>Managers</span></a><u> </u>for more details.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:17.15pt;line-height:110%'>For more on context managers, see <u>Closing
Files Automatically </u>and <u>Redirecting Standard Output</u>.</p>

<h4 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>B.12.
R</span>EALLY <span style='font-size:18.0pt;line-height:112%'>E</span>SOTERIC <span
style='font-size:18.0pt;line-height:112%'>S</span>TUFF</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:2.95pt;
margin-left:16.4pt'>If you know what you’re doing, you can gain almost complete
control over how classes are compared, how attributes are defined, and what
kinds of classes are considered subclasses of your class.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:24.85pt;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=737 height=572 src="Dive%20Into%20Python%203_files/image123.gif"></span></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:24.85pt;
margin-left:16.4pt'><sup><span style='font-size:15.5pt;line-height:154%'>* </span></sup>Exactly
when Python calls the <span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'>__del__() </span>special method <a
href="http://www.python.org/doc/3.1/reference/datamodel.html#object.__del__"><span
style='color:black'>is</span></a><u> </u><a
href="http://www.python.org/doc/3.1/reference/datamodel.html#object.__del__"><span
style='color:black'>incredibly</span></a><u> </u><a
href="http://www.python.org/doc/3.1/reference/datamodel.html#object.__del__"><span
style='color:black'>complicated</span></a>. To fully understand it, you need to
know how <a
href="http://www.python.org/doc/3.1/reference/datamodel.html#objects-values-and-types"><span
style='color:black'>Python</span></a><u> </u><a
href="http://www.python.org/doc/3.1/reference/datamodel.html#objects-values-and-types"><span
style='color:black'>keeps</span></a><u> </u><a
href="http://www.python.org/doc/3.1/reference/datamodel.html#objects-values-and-types"><span
style='color:black'>track</span></a><u> </u><a
href="http://www.python.org/doc/3.1/reference/datamodel.html#objects-values-and-types"><span
style='color:black'>of</span></a><u> </u><a
href="http://www.python.org/doc/3.1/reference/datamodel.html#objects-values-and-types"><span
style='color:black'>objects</span></a><u> </u><a
href="http://www.python.org/doc/3.1/reference/datamodel.html#objects-values-and-types"><span
style='color:black'>in</span></a><u> </u><a
href="http://www.python.org/doc/3.1/reference/datamodel.html#objects-values-and-types"><span
style='color:black'>memory</span></a>. Here’s a good article on <a
href="http://www.electricmonk.nl/log/2008/07/07/python-destructor-and-garbage-collection-notes/"><span
style='color:black'>Python</span></a><u> </u><a
href="http://www.electricmonk.nl/log/2008/07/07/python-destructor-and-garbage-collection-notes/"><span
style='color:black'>garbage </span></a><a
href="http://www.electricmonk.nl/log/2008/07/07/python-destructor-and-garbage-collection-notes/"><span
style='color:black'>collection</span></a><u> </u><a
href="http://www.electricmonk.nl/log/2008/07/07/python-destructor-and-garbage-collection-notes/"><span
style='color:black'>and</span></a><u> </u><a
href="http://www.electricmonk.nl/log/2008/07/07/python-destructor-and-garbage-collection-notes/"><span
style='color:black'>class</span></a><u> </u><a
href="http://www.electricmonk.nl/log/2008/07/07/python-destructor-and-garbage-collection-notes/"><span
style='color:black'>destructors</span></a>. You should also read about <a
href="http://mindtrove.info/articles/python-weak-references/"><span
style='color:black'>weak</span></a><u> </u><a
href="http://mindtrove.info/articles/python-weak-references/"><span
style='color:black'>references</span></a>, the <a
href="http://docs.python.org/3.1/library/weakref.html"><span style='font-size:
10.0pt;line-height:154%;font-family:"Liberation Mono";color:black'>weakref</span></a><u><span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono"'> </span></u><a
href="http://docs.python.org/3.1/library/weakref.html"><span style='color:black'>module</span></a>,
and probably the <a href="http://www.python.org/doc/3.1/library/gc.html"><span
style='font-size:10.0pt;line-height:154%;font-family:"Liberation Mono";
color:black'>gc</span></a><u><span style='font-size:10.0pt;line-height:154%;
font-family:"Liberation Mono"'> </span></u><a
href="http://www.python.org/doc/3.1/library/gc.html"><span style='color:black'>module</span></a><u>
</u>for good measure.</p>

<h4 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>B.13.
F</span>URTHER <span style='font-size:18.0pt;line-height:112%'>R</span>EADING</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
.25pt;margin-left:16.4pt;line-height:107%'>Modules mentioned in this appendix:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.55pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://docs.python.org/3.1/library/zipfile.html"><span style='font-size:
10.0pt;line-height:110%;font-family:"Liberation Mono";color:black'>zipfile</span></a><u><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'> </span></u><a
href="http://docs.python.org/3.1/library/zipfile.html"><span style='color:black'>module</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:7.45pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://docs.python.org/3.1/library/cgi.html"><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono";color:black'>cgi</span></a><u><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'> </span></u><a
href="http://docs.python.org/3.1/library/cgi.html"><span style='color:black'>module</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.55pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://www.python.org/doc/3.1/library/collections.html"><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:black'>collections</span></a><u><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'> </span></u><a
href="http://www.python.org/doc/3.1/library/collections.html"><span
style='color:black'>module</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:7.0pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://docs.python.org/3.1/library/math.html"><span style='font-size:
10.0pt;line-height:110%;font-family:"Liberation Mono";color:black'>math</span></a><u><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'> </span></u><a
href="http://docs.python.org/3.1/library/math.html"><span style='color:black'>module</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.55pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://docs.python.org/3.1/library/pickle.html"><span style='font-size:
10.0pt;line-height:110%;font-family:"Liberation Mono";color:black'>pickle</span></a><u><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'> </span></u><a
href="http://docs.python.org/3.1/library/pickle.html"><span style='color:black'>module</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://docs.python.org/3.1/library/copy.html"><span style='font-size:
10.0pt;line-height:110%;font-family:"Liberation Mono";color:black'>copy</span></a><u><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'> </span></u><a
href="http://docs.python.org/3.1/library/copy.html"><span style='color:black'>module</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:0in;
margin-left:15.9pt;text-indent:-12.25pt;line-height:300%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://docs.python.org/3.1/library/abc.html"><span style='font-size:10.0pt;
line-height:300%;font-family:"Liberation Mono";color:black'>abc</span></a><u><span
style='font-size:10.0pt;line-height:300%;font-family:"Liberation Mono"'> </span></u><a
href="http://docs.python.org/3.1/library/abc.html"><span style='color:black'>(“Abstract</span></a><u>
</u><a href="http://docs.python.org/3.1/library/abc.html"><span
style='color:black'>Base</span></a><u> </u><a
href="http://docs.python.org/3.1/library/abc.html"><span style='color:black'>Classes”)</span></a><u>
</u><a href="http://docs.python.org/3.1/library/abc.html"><span
style='color:black'>module </span></a>Other light reading:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://www.python.org/doc/3.1/library/string.html#formatspec"><span
style='color:black'>Format</span></a><u> </u><a
href="http://www.python.org/doc/3.1/library/string.html#formatspec"><span
style='color:black'>Specification</span></a><u> </u><a
href="http://www.python.org/doc/3.1/library/string.html#formatspec"><span
style='color:black'>Mini-Language</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://www.python.org/doc/3.1/reference/datamodel.html"><span
style='color:black'>Python</span></a><u> </u><a
href="http://www.python.org/doc/3.1/reference/datamodel.html"><span
style='color:black'>data</span></a><u> </u><a
href="http://www.python.org/doc/3.1/reference/datamodel.html"><span
style='color:black'>model</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://www.python.org/doc/3.1/library/stdtypes.html"><span
style='color:black'>Built-in</span></a><u> </u><a
href="http://www.python.org/doc/3.1/library/stdtypes.html"><span
style='color:black'>types</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://www.python.org/dev/peps/pep-0357/"><span style='font-size:9.5pt;
line-height:110%;color:black'>PEP</span></a><u><span style='font-size:9.5pt;
line-height:110%'> </span></u><a href="http://www.python.org/dev/peps/pep-0357/"><span
style='color:black'>357:</span></a><u> </u><a
href="http://www.python.org/dev/peps/pep-0357/"><span style='color:black'>Allowing</span></a><u>
</u><a href="http://www.python.org/dev/peps/pep-0357/"><span style='color:black'>Any</span></a><u>
</u><a href="http://www.python.org/dev/peps/pep-0357/"><span style='color:black'>Object</span></a><u>
</u><a href="http://www.python.org/dev/peps/pep-0357/"><span style='color:black'>to</span></a><u>
</u><a href="http://www.python.org/dev/peps/pep-0357/"><span style='color:black'>be</span></a><u>
</u><a href="http://www.python.org/dev/peps/pep-0357/"><span style='color:black'>Used</span></a><u>
</u><a href="http://www.python.org/dev/peps/pep-0357/"><span style='color:black'>for</span></a><u>
</u><a href="http://www.python.org/dev/peps/pep-0357/"><span style='color:black'>Slicing</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://www.python.org/dev/peps/pep-3119/"><span style='font-size:9.5pt;
line-height:110%;color:black'>PEP</span></a><u><span style='font-size:9.5pt;
line-height:110%'> </span></u><a href="http://www.python.org/dev/peps/pep-3119/"><span
style='color:black'>3119:</span></a><u> </u><a
href="http://www.python.org/dev/peps/pep-3119/"><span style='color:black'>Introducing</span></a><u>
</u><a href="http://www.python.org/dev/peps/pep-3119/"><span style='color:black'>Abstract</span></a><u>
</u><a href="http://www.python.org/dev/peps/pep-3119/"><span style='color:black'>Base</span></a><u>
</u><a href="http://www.python.org/dev/peps/pep-3119/"><span style='color:black'>Classes</span></a><br
clear=all style='page-break-before:always'>
</p>

<h3 style='margin-top:0in;margin-right:22.2pt;margin-bottom:0in;margin-left:
16.4pt;line-height:107%'><span style='font-size:24.0pt;line-height:107%'>A</span><span
style='font-size:19.0pt;line-height:107%'>PPENDIX </span><span
style='font-size:24.0pt;line-height:107%'>C. W</span><span style='font-size:
19.0pt;line-height:107%'>HERE </span><span style='font-size:24.0pt;line-height:
107%'>T</span><span style='font-size:19.0pt;line-height:107%'>O </span><span
style='font-size:24.0pt;line-height:107%'>G</span><span style='font-size:19.0pt;
line-height:107%'>O </span><span style='font-size:24.0pt;line-height:107%'>F</span><span
style='font-size:19.0pt;line-height:107%'>ROM </span><span style='font-size:
24.0pt;line-height:107%'>H</span><span style='font-size:19.0pt;line-height:
107%'>ERE</span></h3>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:39.95pt;
margin-left:16.65pt;text-indent:0in;line-height:107%'><span style='font-size:
11.0pt;line-height:107%;font-family:"Calibri",sans-serif'><img border=0
width=736 height=4 id="Group 768130"
src="Dive%20Into%20Python%203_files/image001.gif"></span></p>

<p class=MsoNormal align=right style='margin-top:0in;margin-right:0in;
margin-bottom:65.45pt;margin-left:245.95pt;text-align:right;line-height:160%'><span
style='font-size:13.0pt;line-height:160%;font-family:"Calibri",sans-serif'>&#10077;
</span><i>Go forth on your path, as it exists only through your walking. </i><span
style='font-size:13.0pt;line-height:160%;font-family:"Calibri",sans-serif'>&#10078;
</span><i>— St. Augustine of Hippo (attributed)</i></p>

<h4 style='margin-top:0in;margin-right:0in;margin-bottom:66.0pt;margin-left:
16.4pt'><span style='font-size:18.0pt;line-height:112%'>C.1. T</span>HINGS TO <span
style='font-size:18.0pt;line-height:112%'>R</span>EAD</h4>

<p class=MsoNormal style='margin-left:16.4pt;line-height:107%'><span
style='font-size:48.0pt;line-height:107%;font-family:"DejaVu Serif",serif;
color:#888888'>U </span>nfortunately, I can not write cover every facet of
Python 3 in this book. Fortunately, there are many</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.45pt;margin-left:16.4pt'>wonderful, freely available tutorials available
elsewhere.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.3pt;margin-left:16.4pt'>Decorators:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://programmingbits.pythonblogs.com/27_programmingbits/archive/50_function_decorators.html"><span
style='color:black'>Function</span></a><u> </u><a
href="http://programmingbits.pythonblogs.com/27_programmingbits/archive/50_function_decorators.html"><span
style='color:black'>Decorators</span></a><u> </u>by Ariel Ortiz</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://programmingbits.pythonblogs.com/27_programmingbits/archive/51_more_on_function_decorators.html"><span
style='color:black'>More</span></a><u> </u><a
href="http://programmingbits.pythonblogs.com/27_programmingbits/archive/51_more_on_function_decorators.html"><span
style='color:black'>on</span></a><u> </u><a
href="http://programmingbits.pythonblogs.com/27_programmingbits/archive/51_more_on_function_decorators.html"><span
style='color:black'>Function</span></a><u> </u><a
href="http://programmingbits.pythonblogs.com/27_programmingbits/archive/51_more_on_function_decorators.html"><span
style='color:black'>Decorators</span></a><u> </u>by Ariel Ortiz</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://www.ibm.com/developerworks/linux/library/l-cpdecor.html"><span
style='color:black'>Charming</span></a><u> </u><a
href="http://www.ibm.com/developerworks/linux/library/l-cpdecor.html"><span
style='color:black'>Python:</span></a><u> </u><a
href="http://www.ibm.com/developerworks/linux/library/l-cpdecor.html"><span
style='color:black'>Decorators</span></a><u> </u><a
href="http://www.ibm.com/developerworks/linux/library/l-cpdecor.html"><span
style='color:black'>make</span></a><u> </u><a
href="http://www.ibm.com/developerworks/linux/library/l-cpdecor.html"><span
style='color:black'>magic</span></a><u> </u><a
href="http://www.ibm.com/developerworks/linux/library/l-cpdecor.html"><span
style='color:black'>easy</span></a><u> </u>by David Mertz</p>

<p class=MsoNormal style='margin-left:15.9pt;text-indent:-12.25pt;line-height:
300%'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://docs.python.org/reference/compound_stmts.html#function"><span
style='color:black'>Function</span></a><u> </u><a
href="http://docs.python.org/reference/compound_stmts.html#function"><span
style='color:black'>Definitions</span></a><u> </u>in the official Python
documentation Properties:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://adam.gomaa.us/blog/2008/aug/11/the-python-property-builtin/"><span
style='color:black'>The</span></a><u> </u><a
href="http://adam.gomaa.us/blog/2008/aug/11/the-python-property-builtin/"><span
style='color:black'>Python</span></a><u> </u><a
href="http://adam.gomaa.us/blog/2008/aug/11/the-python-property-builtin/"><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:black'>property</span></a><u><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'> </span></u><a
href="http://adam.gomaa.us/blog/2008/aug/11/the-python-property-builtin/"><span
style='color:black'>builtin</span></a><u> </u>by Adam Gomaa</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://tomayko.com/writings/getters-setters-fuxors"><span
style='color:black'>Getters/Setters/Fuxors</span></a><u> </u>by Ryan Tomayko</p>

<p class=MsoNormal style='margin-left:15.9pt;text-indent:-12.25pt;line-height:
300%'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://docs.python.org/library/functions.html#property"><span
style='font-size:10.0pt;line-height:300%;font-family:"Liberation Mono";
color:black'>property()</span></a><u><span style='font-size:10.0pt;line-height:
300%;font-family:"Liberation Mono"'> </span></u><a
href="http://docs.python.org/library/functions.html#property"><span
style='color:black'>function</span></a><u> </u>in the official Python
documentation Descriptors:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://users.rcn.com/python/download/Descriptor.htm"><span
style='color:black'>How-To</span></a><u> </u><a
href="http://users.rcn.com/python/download/Descriptor.htm"><span
style='color:black'>Guide</span></a><u> </u><a
href="http://users.rcn.com/python/download/Descriptor.htm"><span
style='color:black'>For</span></a><u> </u><a
href="http://users.rcn.com/python/download/Descriptor.htm"><span
style='color:black'>Descriptors</span></a><u> </u>by Raymond Hettinger</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://www.ibm.com/developerworks/linux/library/l-python-elegance-2.html"><span
style='color:black'>Charming</span></a><u> </u><a
href="http://www.ibm.com/developerworks/linux/library/l-python-elegance-2.html"><span
style='color:black'>Python:</span></a><u> </u><a
href="http://www.ibm.com/developerworks/linux/library/l-python-elegance-2.html"><span
style='color:black'>Python</span></a><u> </u><a
href="http://www.ibm.com/developerworks/linux/library/l-python-elegance-2.html"><span
style='color:black'>elegance</span></a><u> </u><a
href="http://www.ibm.com/developerworks/linux/library/l-python-elegance-2.html"><span
style='color:black'>and</span></a><u> </u><a
href="http://www.ibm.com/developerworks/linux/library/l-python-elegance-2.html"><span
style='color:black'>warts,</span></a><u> </u><a
href="http://www.ibm.com/developerworks/linux/library/l-python-elegance-2.html"><span
style='color:black'>Part</span></a><u> </u><a
href="http://www.ibm.com/developerworks/linux/library/l-python-elegance-2.html"><span
style='color:black'>2</span></a><u> </u>by David Mertz</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.0pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:107%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://www.informit.com/articles/printerfriendly.aspx?p=1309289"><span
style='color:black'>Python</span></a><u> </u><a
href="http://www.informit.com/articles/printerfriendly.aspx?p=1309289"><span
style='color:black'>Descriptors</span></a><u> </u>by Mark Summerfield</p>

<p class=MsoNormal style='margin-left:15.9pt;text-indent:-12.25pt;line-height:
107%'>•<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://docs.python.org/3.1/reference/datamodel.html#invoking-descriptors"><span
style='color:black'>Invoking</span></a><u> </u><a
href="http://docs.python.org/3.1/reference/datamodel.html#invoking-descriptors"><span
style='color:black'>Descriptors</span></a><u> </u>in the official Python
documentation</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
22.1pt;margin-left:16.4pt'>Threading <i><span style='font-size:13.0pt;
line-height:154%;font-family:"DejaVu Serif",serif'>&amp; </span></i>multiprocessing:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.55pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://docs.python.org/3.1/library/threading.html"><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:black'>threading</span></a><u><span style='font-size:10.0pt;line-height:
110%;font-family:"Liberation Mono"'> </span></u><a
href="http://docs.python.org/3.1/library/threading.html"><span
style='color:black'>module</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:7.65pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://www.doughellmann.com/PyMOTW/threading/"><span style='font-size:
10.0pt;line-height:110%;font-family:"Liberation Mono";color:black'>threading</span></a><u><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono"'> </span></u><a
href="http://www.doughellmann.com/PyMOTW/threading/"><span style='color:black'>—</span></a><u>
</u><a href="http://www.doughellmann.com/PyMOTW/threading/"><span
style='color:black'>Manage</span></a><u> </u><a
href="http://www.doughellmann.com/PyMOTW/threading/"><span style='color:black'>concurrent</span></a><u>
</u><a href="http://www.doughellmann.com/PyMOTW/threading/"><span
style='color:black'>threads</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.55pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://docs.python.org/3.1/library/multiprocessing.html"><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:black'>multiprocessing</span></a><u><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono"'> </span></u><a
href="http://docs.python.org/3.1/library/multiprocessing.html"><span
style='color:black'>module</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://www.doughellmann.com/PyMOTW/multiprocessing/"><span
style='font-size:10.0pt;line-height:110%;font-family:"Liberation Mono";
color:black'>multiprocessing</span></a><u><span style='font-size:10.0pt;
line-height:110%;font-family:"Liberation Mono"'> </span></u><a
href="http://www.doughellmann.com/PyMOTW/multiprocessing/"><span
style='color:black'>—</span></a><u> </u><a
href="http://www.doughellmann.com/PyMOTW/multiprocessing/"><span
style='color:black'>Manage</span></a><u> </u><a
href="http://www.doughellmann.com/PyMOTW/multiprocessing/"><span
style='color:black'>processes</span></a><u> </u><a
href="http://www.doughellmann.com/PyMOTW/multiprocessing/"><span
style='color:black'>like</span></a><u> </u><a
href="http://www.doughellmann.com/PyMOTW/multiprocessing/"><span
style='color:black'>threads</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://jessenoller.com/2009/02/01/python-threads-and-the-global-interpreter-lock/"><span
style='color:black'>Python</span></a><u> </u><a
href="http://jessenoller.com/2009/02/01/python-threads-and-the-global-interpreter-lock/"><span
style='color:black'>threads</span></a><u> </u><a
href="http://jessenoller.com/2009/02/01/python-threads-and-the-global-interpreter-lock/"><span
style='color:black'>and</span></a><u> </u><a
href="http://jessenoller.com/2009/02/01/python-threads-and-the-global-interpreter-lock/"><span
style='color:black'>the</span></a><u> </u><a
href="http://jessenoller.com/2009/02/01/python-threads-and-the-global-interpreter-lock/"><span
style='color:black'>Global</span></a><u> </u><a
href="http://jessenoller.com/2009/02/01/python-threads-and-the-global-interpreter-lock/"><span
style='color:black'>Interpreter</span></a><u> </u><a
href="http://jessenoller.com/2009/02/01/python-threads-and-the-global-interpreter-lock/"><span
style='color:black'>Lock</span></a><u> </u>by Jesse Noller</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:26.7pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://blip.tv/file/2232410"><span style='color:black'>Inside</span></a><u>
</u><a href="http://blip.tv/file/2232410"><span style='color:black'>the</span></a><u>
</u><a href="http://blip.tv/file/2232410"><span style='color:black'>Python</span></a><u>
</u><a href="http://blip.tv/file/2232410"><span style='font-size:9.5pt;
line-height:110%;color:black'>GIL</span></a><u><span style='font-size:9.5pt;
line-height:110%'> </span></u><a href="http://blip.tv/file/2232410"><span
style='color:black'>(video)</span></a><u> </u>by David Beazley</p>

<p class=MsoNormal style='margin-top:0in;margin-right:30.5pt;margin-bottom:
21.3pt;margin-left:16.4pt'>Metaclasses:</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:6.0pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:107%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://www.ibm.com/developerworks/linux/library/l-pymeta.html"><span
style='color:black'>Metaclass</span></a><u> </u><a
href="http://www.ibm.com/developerworks/linux/library/l-pymeta.html"><span
style='color:black'>programming</span></a><u> </u><a
href="http://www.ibm.com/developerworks/linux/library/l-pymeta.html"><span
style='color:black'>in</span></a><u> </u><a
href="http://www.ibm.com/developerworks/linux/library/l-pymeta.html"><span
style='color:black'>Python</span></a><u> </u>by David Mertz and Michele
Simionato</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://www.ibm.com/developerworks/linux/library/l-pymeta2/"><span
style='color:black'>Metaclass</span></a><u> </u><a
href="http://www.ibm.com/developerworks/linux/library/l-pymeta2/"><span
style='color:black'>programming</span></a><u> </u><a
href="http://www.ibm.com/developerworks/linux/library/l-pymeta2/"><span
style='color:black'>in</span></a><u> </u><a
href="http://www.ibm.com/developerworks/linux/library/l-pymeta2/"><span
style='color:black'>Python,</span></a><u> </u><a
href="http://www.ibm.com/developerworks/linux/library/l-pymeta2/"><span
style='color:black'>Part</span></a><u> </u><a
href="http://www.ibm.com/developerworks/linux/library/l-pymeta2/"><span
style='color:black'>2</span></a><u> </u>by David Mertz and Michele Simionato</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:26.7pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://www.ibm.com/developerworks/linux/library/l-pymeta3.html"><span
style='color:black'>Metaclass</span></a><u> </u><a
href="http://www.ibm.com/developerworks/linux/library/l-pymeta3.html"><span
style='color:black'>programming</span></a><u> </u><a
href="http://www.ibm.com/developerworks/linux/library/l-pymeta3.html"><span
style='color:black'>in</span></a><u> </u><a
href="http://www.ibm.com/developerworks/linux/library/l-pymeta3.html"><span
style='color:black'>Python,</span></a><u> </u><a
href="http://www.ibm.com/developerworks/linux/library/l-pymeta3.html"><span
style='color:black'>Part</span></a><u> </u><a
href="http://www.ibm.com/developerworks/linux/library/l-pymeta3.html"><span
style='color:black'>3</span></a><u> </u>by David Mertz and Michele Simionato</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:24.95pt;
margin-left:16.4pt'>In addition, Doug Hellman’s <a
href="http://www.doughellmann.com/PyMOTW/contents.html"><span style='color:
black'>Python</span></a><u> </u><a
href="http://www.doughellmann.com/PyMOTW/contents.html"><span style='color:
black'>Module</span></a><u> </u><a
href="http://www.doughellmann.com/PyMOTW/contents.html"><span style='color:
black'>of</span></a><u> </u><a
href="http://www.doughellmann.com/PyMOTW/contents.html"><span style='color:
black'>the</span></a><u> </u><a
href="http://www.doughellmann.com/PyMOTW/contents.html"><span style='color:
black'>Week</span></a><u> </u>is a fantastic guide to many of the modules in
the Python standard library.</p>

<h4 style='margin-left:16.4pt'><span style='font-size:18.0pt;line-height:112%'>C.2.
W</span>HERE <span style='font-size:18.0pt;line-height:112%'>T</span>O <span
style='font-size:18.0pt;line-height:112%'>L</span>OOK <span style='font-size:
18.0pt;line-height:112%'>F</span>OR <span style='font-size:18.0pt;line-height:
112%'>P</span>YTHON <span style='font-size:18.0pt;line-height:112%'>3-C</span>OMPATIBLE
<span style='font-size:18.0pt;line-height:112%'>C</span>ODE</h4>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:20.55pt;
margin-left:16.4pt'>As Python 3 is relatively new, there is a dearth of
compatible libraries. Here are some of the places to look for code that works
with Python 3.</p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://pypi.python.org/pypi?:action=browse&amp;c=533&amp;show=all"><span
style='color:black'>Python</span></a><u> </u><a
href="http://pypi.python.org/pypi?:action=browse&amp;c=533&amp;show=all"><span
style='color:black'>Package</span></a><u> </u><a
href="http://pypi.python.org/pypi?:action=browse&amp;c=533&amp;show=all"><span
style='color:black'>Index:</span></a><u> </u><a
href="http://pypi.python.org/pypi?:action=browse&amp;c=533&amp;show=all"><span
style='color:black'>list</span></a><u> </u><a
href="http://pypi.python.org/pypi?:action=browse&amp;c=533&amp;show=all"><span
style='color:black'>of</span></a><u> </u><a
href="http://pypi.python.org/pypi?:action=browse&amp;c=533&amp;show=all"><span
style='color:black'>Python</span></a><u> </u><a
href="http://pypi.python.org/pypi?:action=browse&amp;c=533&amp;show=all"><span
style='color:black'>3</span></a><u> </u><a
href="http://pypi.python.org/pypi?:action=browse&amp;c=533&amp;show=all"><span
style='color:black'>packages</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://code.activestate.com/recipes/langs/python/tags/python3/"><span
style='color:black'>Python</span></a><u> </u><a
href="http://code.activestate.com/recipes/langs/python/tags/python3/"><span
style='color:black'>Cookbook:</span></a><u> </u><a
href="http://code.activestate.com/recipes/langs/python/tags/python3/"><span
style='color:black'>list</span></a><u> </u><a
href="http://code.activestate.com/recipes/langs/python/tags/python3/"><span
style='color:black'>of</span></a><u> </u><a
href="http://code.activestate.com/recipes/langs/python/tags/python3/"><span
style='color:black'>recipes</span></a><u> </u><a
href="http://code.activestate.com/recipes/langs/python/tags/python3/"><span
style='color:black'>tagged</span></a><u> </u><a
href="http://code.activestate.com/recipes/langs/python/tags/python3/"><span
style='color:black'>“python3”</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://code.google.com/hosting/search?q=label:python3"><span
style='color:black'>Google</span></a><u> </u><a
href="http://code.google.com/hosting/search?q=label:python3"><span
style='color:black'>Project</span></a><u> </u><a
href="http://code.google.com/hosting/search?q=label:python3"><span
style='color:black'>Hosting:</span></a><u> </u><a
href="http://code.google.com/hosting/search?q=label:python3"><span
style='color:black'>list</span></a><u> </u><a
href="http://code.google.com/hosting/search?q=label:python3"><span
style='color:black'>of</span></a><u> </u><a
href="http://code.google.com/hosting/search?q=label:python3"><span
style='color:black'>projects</span></a><u> </u><a
href="http://code.google.com/hosting/search?q=label:python3"><span
style='color:black'>tagged</span></a><u> </u><a
href="http://code.google.com/hosting/search?q=label:python3"><span
style='color:black'>“python3”</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:5.9pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:110%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://sourceforge.net/search/?words=%22python+3%22"><span
style='color:black'>SourceForge:</span></a><u> </u><a
href="http://sourceforge.net/search/?words=%22python+3%22"><span
style='color:black'>list</span></a><u> </u><a
href="http://sourceforge.net/search/?words=%22python+3%22"><span
style='color:black'>of</span></a><u> </u><a
href="http://sourceforge.net/search/?words=%22python+3%22"><span
style='color:black'>projects</span></a><u> </u><a
href="http://sourceforge.net/search/?words=%22python+3%22"><span
style='color:black'>matching</span></a><u> </u><a
href="http://sourceforge.net/search/?words=%22python+3%22"><span
style='color:black'>“Python</span></a><u> </u><a
href="http://sourceforge.net/search/?words=%22python+3%22"><span
style='color:black'>3”</span></a></p>

<p class=MsoNormal style='margin-top:0in;margin-right:0in;margin-bottom:20.85pt;
margin-left:15.9pt;text-indent:-12.25pt;line-height:150%'>•<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp; </span><a
href="http://github.com/search?type=Repositories&amp;language=python&amp;q=python3"><span
style='color:black'>GitHub:</span></a><u> </u><a
href="http://github.com/search?type=Repositories&amp;language=python&amp;q=python3"><span
style='color:black'>list</span></a><u> </u><a
href="http://github.com/search?type=Repositories&amp;language=python&amp;q=python3"><span
style='color:black'>of</span></a><u> </u><a
href="http://github.com/search?type=Repositories&amp;language=python&amp;q=python3"><span
style='color:black'>projects</span></a><u> </u><a
href="http://github.com/search?type=Repositories&amp;language=python&amp;q=python3"><span
style='color:black'>matching</span></a><u> </u><a
href="http://github.com/search?type=Repositories&amp;language=python&amp;q=python3"><span
style='color:black'>“python3”</span></a><u> </u>(also, <a
href="http://github.com/search?type=Repositories&amp;language=python&amp;q=python+3"><span
style='color:black'>list</span></a><u> </u><a
href="http://github.com/search?type=Repositories&amp;language=python&amp;q=python+3"><span
style='color:black'>of</span></a><u> </u><a
href="http://github.com/search?type=Repositories&amp;language=python&amp;q=python+3"><span
style='color:black'>projects</span></a><u> </u><a
href="http://github.com/search?type=Repositories&amp;language=python&amp;q=python+3"><span
style='color:black'>matching</span></a><u> </u><a
href="http://github.com/search?type=Repositories&amp;language=python&amp;q=python+3"><span
style='color:black'>“python</span></a><u> </u><a
href="http://github.com/search?type=Repositories&amp;language=python&amp;q=python+3"><span
style='color:black'>3”</span></a>) •        <a
href="http://bitbucket.org/repo/all/?name=python3"><span style='color:black'>BitBucket:</span></a><u>
</u><a href="http://bitbucket.org/repo/all/?name=python3"><span
style='color:black'>list</span></a><u> </u><a
href="http://bitbucket.org/repo/all/?name=python3"><span style='color:black'>of</span></a><u>
</u><a href="http://bitbucket.org/repo/all/?name=python3"><span
style='color:black'>projects</span></a><u> </u><a
href="http://bitbucket.org/repo/all/?name=python3"><span style='color:black'>matching</span></a><u>
</u><a href="http://bitbucket.org/repo/all/?name=python3"><span
style='color:black'>“python3”</span></a><u> </u>(and <a
href="http://bitbucket.org/repo/all/?name=python+3"><span style='color:black'>those</span></a><u>
</u><a href="http://bitbucket.org/repo/all/?name=python+3"><span
style='color:black'>matching</span></a><u> </u><a
href="http://bitbucket.org/repo/all/?name=python+3"><span style='color:black'>“python</span></a><u>
</u><a href="http://bitbucket.org/repo/all/?name=python+3"><span
style='color:black'>3”</span></a>)</p>

<p class=MsoNormal align=center style='margin-top:0in;margin-right:0in;
margin-bottom:0in;margin-left:16.6pt;text-align:center;text-indent:0in;
line-height:107%'><span style='font-size:10.0pt;line-height:107%'>© 2001–9 </span><a
href="http://diveintopython3.org/about.html"><span style='font-size:10.0pt;
line-height:107%;color:black'>Mark</span></a><u><span style='font-size:10.0pt;
line-height:107%'> </span></u><a href="http://diveintopython3.org/about.html"><span
style='font-size:10.0pt;line-height:107%;color:black'>Pilgrim</span></a></p>

</div>

</body>

</html>
